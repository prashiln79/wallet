import{$ as Rc,A as Zo,B as Sr,C as ax,D as Gn,E as la,F as ox,G as sx,H as cx,I as lx,J as dx,K as mx,L as gx,M as ux,N as gr,O as ma,P as px,Q as fx,R as hx,S as xx,T as Dc,U as Fc,V as im,W as rm,X as Cx,Y as am,Z as om,_ as sm,a as Z0,aa as cm,b as V_,ba as lm,c as U_,ca as dm,d as z_,da as Ox,e as Vt,ea as wx,f as mr,fa as Sx,g as Ec,ga as kx,h as j_,ha as Tx,i as $_,ia as Ex,j as Y_,ja as Ix,k as Ru,ka as Ax,l as W_,la as Dx,m as ca,ma as Fx,n as tm,na as Ll,o as G_,oa as mm,p as H_,pa as Rx,q as q_,qa as Lx,r as K_,ra as Vx,s as J_,sa as Ux,t as ex,ta as qt,u as tx,ua as ga,v as un,va as Xt,w as Nr,wa as jx,x as nx,xa as $x,y as ix,ya as Yx,z as Ko,za as Wx}from"./chunk-AX5RLGN6.js";import{a as li,b as B0,c as N0,d as Yo,e as vc,f as L0,g as Wo,h as bc,i as V0,j as yc,k as Go,l as U0,m as z0,n as j0,o as Fl,p as o_,q as Z_,r as Q_,s as qr,t as Vr,u as Bu,v as _x,w as zx}from"./chunk-6CHK2FAS.js";import{$ as q1,$a as c_,$b as oa,$c as X0,A as Jn,Aa as $o,Ab as ei,Ad as Qe,B as Wn,Ba as b0,Bb as cr,Bd as Ua,C as Ui,Ca as y0,Cb as M_,Cd as Br,D as mc,Da as M0,E as xi,Ea as P0,Eb as Gr,Ed as L_,F as j1,Fa as O0,Fb as zi,Fd as ni,Ga as w0,Gb as H0,Gd as Mi,H as Ci,Ha as e_,Hb as Dt,Hd as Pi,I as gc,Ia as S0,Ib as P_,Id as xn,J as uc,Ja as t_,Jb as di,K as pc,Ka as Xi,Kb as Va,Kd as Q0,L as zo,La as k0,Lb as O_,Ld as J0,M as jo,Ma as T0,Mb as Iu,Md as em,N as fc,Na as xc,Nb as Au,O as hc,Oa as n_,Ob as Du,Od as Hr,P as vi,Pa as E0,Pb as Nl,Pd as za,Qa as aa,Qb as Rr,R as $1,Ra as i_,Rb as Fn,Rd as Tn,S as Ht,Sa as I0,Sd as X_,T as Y1,Ta as Cc,Tb as Fu,Tc as yi,Td as Ic,U as W1,Ua as A0,V as St,Va as D0,W as Tt,Wa as F0,Wc as Jt,Wd as Lr,X as ku,Xa as r_,Xc as D_,Xd as ja,Y as l0,Ya as R0,Yb as w_,Yc as q0,Yd as nm,Z as G1,Za as a_,Zb as lr,Zc as F_,Zd as rx,_ as H1,_a as s_,_b as Lt,_c as gn,_d as $a,a as E1,aa as Tu,ab as l_,ac as bi,ae as Oi,b as I1,ba as X1,bb as d_,bc as S_,c as A1,ca as K1,cb as $0,cc as qo,ce as wi,d as D1,da as pt,db as Y0,dc as Xo,e as i0,ea as bo,eb as Mc,ec as Ut,f as F1,fa as d0,fb as Rl,fc as ti,fe as da,g as r0,gb as W0,gc as k_,h as R1,hb as Pc,hc as T_,he as Ac,i as B1,ia as Z1,ib as Bl,ic as E_,ie as Ya,j as N1,ja as Ie,jb as Eu,jc as I_,je as Wa,k as a0,ka as ra,kb as Ho,kc as mi,ke as Ga,l as L1,la as Fr,lb as m_,lc as A_,m as o0,ma as m0,mb as g_,me as ji,n as nn,na as g0,nb as u_,ne as vx,o as s0,oa as u0,ob as p_,od as R_,oe as bx,p as V1,pa as Q1,pb as f_,pe as yx,q as Al,qa as p0,qb as G0,qe as Mx,r as U1,ra as f0,rb as h_,re as Qo,s as z1,sa as J1,sb as __,se as Px,t as Nt,ta as h0,tb as x_,ua as _c,ub as C_,ue as Bx,v as tt,va as _0,vb as v_,vc as dr,vd as B_,ve as Nx,w as At,wa as x0,wb as xt,wc as Oc,x as Yn,xa as C0,xb as b_,xd as ft,y as c0,ya as v0,yb as y_,yd as sa,z as dc,za as Dl,zd as N_}from"./chunk-3LIRFCEH.js";import{f as Gx,g as Vl,h as gm,m as Hx,n as um,p as qx,u as Xx}from"./chunk-UUMJWLTP.js";import{$ as n1,$b as s,Aa as ir,Ac as st,Ad as dt,Ba as bs,Bb as wu,Bc as ct,Cb as Dr,Cc as lt,Cd as Vi,Da as lc,Dc as v1,Dd as sr,E as yu,Ec as ia,Ed as _i,Fc as b1,Fd as T1,G as Bi,Gc as ka,Gd as Vo,Hc as Ta,Hd as La,I as vt,Ia as Xd,Ic as y1,J as e1,Ja as R,Jc as M1,K as El,Ka as B,Kc as P1,Kd as Uo,La as Ii,Lc as ce,M as tr,Ma as na,Mc as xe,Na as m1,Nc as ht,Oc as O1,P as t1,Pa as g1,Pb as N,Pd as K0,Qa as u1,Qb as Wr,Qd as wc,R as cc,Rb as P,Sb as wt,Sd as Sc,Ta as Ou,Tb as ze,Td as kc,Ua as _o,Ub as jt,Va as xo,Vd as Tc,Wb as we,Xa as _n,Xb as _1,Xc as w1,Yb as rr,Zb as Ge,_b as He,a as Ri,aa as i1,ab as Kd,ac as c,ba as r1,bb as Il,bc as re,c as tn,cc as Co,cd as S1,da as a1,dc as vo,dd as k1,ea as o1,f as Bt,fa as wr,fc as ue,g as on,ga as yt,h as ho,ia as Mu,ic as F,j as Xh,ja as s1,k as Kh,ka as c1,kc as v,l as Zh,la as l1,lc as x1,mc as e0,n as Qh,na as d1,nc as Sa,oa as ut,ob as Zd,oc as Su,p as Dn,pa as nr,pc as ar,q as gt,qb as p1,qc as Ni,r as Na,ra as wa,rb as Qd,rc as Li,rd as t0,ta as De,tb as u,u as Jh,ua as ta,ub as Y,uc as bn,v as We,vb as f1,vc as d,w as Or,wa as Pu,wc as L,wd as n0,x as Gt,xb as h1,xc as ne,yc as $t,yd as $n,za as Re,zb as Jd,zc as C1,zd as or}from"./chunk-Y6PCACYE.js";import{a as oe,b as le,c as Hh,d as oc,e as sc,f as qh,h as Yr,i as bt,k as me}from"./chunk-LKDXID24.js";var Xr=qh((ju,Yc)=>{"use strict";(function(e,i){typeof ju=="object"&&typeof Yc<"u"?Yc.exports=i():typeof define=="function"&&define.amd?define(i):e.moment=i()})(ju,function(){"use strict";var e;function i(){return e.apply(null,arguments)}function n(p){e=p}function t(p){return p instanceof Array||Object.prototype.toString.call(p)==="[object Array]"}function r(p){return p!=null&&Object.prototype.toString.call(p)==="[object Object]"}function a(p,_){return Object.prototype.hasOwnProperty.call(p,_)}function o(p){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(p).length===0;var _;for(_ in p)if(a(p,_))return!1;return!0}function l(p){return p===void 0}function m(p){return typeof p=="number"||Object.prototype.toString.call(p)==="[object Number]"}function g(p){return p instanceof Date||Object.prototype.toString.call(p)==="[object Date]"}function f(p,_){var M=[],O,D=p.length;for(O=0;O<D;++O)M.push(_(p[O],O));return M}function h(p,_){for(var M in _)a(_,M)&&(p[M]=_[M]);return a(_,"toString")&&(p.toString=_.toString),a(_,"valueOf")&&(p.valueOf=_.valueOf),p}function x(p,_,M,O){return Ph(p,_,M,O,!0).utc()}function C(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function y(p){return p._pf==null&&(p._pf=C()),p._pf}var b;Array.prototype.some?b=Array.prototype.some:b=function(p){var _=Object(this),M=_.length>>>0,O;for(O=0;O<M;O++)if(O in _&&p.call(this,_[O],O,_))return!0;return!1};function w(p){var _=null,M=!1,O=p._d&&!isNaN(p._d.getTime());if(O&&(_=y(p),M=b.call(_.parsedDateParts,function(D){return D!=null}),O=_.overflow<0&&!_.empty&&!_.invalidEra&&!_.invalidMonth&&!_.invalidWeekday&&!_.weekdayMismatch&&!_.nullInput&&!_.invalidFormat&&!_.userInvalidated&&(!_.meridiem||_.meridiem&&M),p._strict&&(O=O&&_.charsLeftOver===0&&_.unusedTokens.length===0&&_.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(p))p._isValid=O;else return O;return p._isValid}function A(p){var _=x(NaN);return p!=null?h(y(_),p):y(_).userInvalidated=!0,_}var E=i.momentProperties=[],I=!1;function K(p,_){var M,O,D,ie=E.length;if(l(_._isAMomentObject)||(p._isAMomentObject=_._isAMomentObject),l(_._i)||(p._i=_._i),l(_._f)||(p._f=_._f),l(_._l)||(p._l=_._l),l(_._strict)||(p._strict=_._strict),l(_._tzm)||(p._tzm=_._tzm),l(_._isUTC)||(p._isUTC=_._isUTC),l(_._offset)||(p._offset=_._offset),l(_._pf)||(p._pf=y(_)),l(_._locale)||(p._locale=_._locale),ie>0)for(M=0;M<ie;M++)O=E[M],D=_[O],l(D)||(p[O]=D);return p}function Z(p){K(this,p),this._d=new Date(p._d!=null?p._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),I===!1&&(I=!0,i.updateOffset(this),I=!1)}function k(p){return p instanceof Z||p!=null&&p._isAMomentObject!=null}function S(p){i.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+p)}function V(p,_){var M=!0;return h(function(){if(i.deprecationHandler!=null&&i.deprecationHandler(null,p),M){var O=[],D,ie,ye,it=arguments.length;for(ie=0;ie<it;ie++){if(D="",typeof arguments[ie]=="object"){D+=`
[`+ie+"] ";for(ye in arguments[0])a(arguments[0],ye)&&(D+=ye+": "+arguments[0][ye]+", ");D=D.slice(0,-2)}else D=arguments[ie];O.push(D)}S(p+`
Arguments: `+Array.prototype.slice.call(O).join("")+`
`+new Error().stack),M=!1}return _.apply(this,arguments)},_)}var W={};function Q(p,_){i.deprecationHandler!=null&&i.deprecationHandler(p,_),W[p]||(S(_),W[p]=!0)}i.suppressDeprecationWarnings=!1,i.deprecationHandler=null;function se(p){return typeof Function<"u"&&p instanceof Function||Object.prototype.toString.call(p)==="[object Function]"}function ae(p){var _,M;for(M in p)a(p,M)&&(_=p[M],se(_)?this[M]=_:this["_"+M]=_);this._config=p,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ke(p,_){var M=h({},p),O;for(O in _)a(_,O)&&(r(p[O])&&r(_[O])?(M[O]={},h(M[O],p[O]),h(M[O],_[O])):_[O]!=null?M[O]=_[O]:delete M[O]);for(O in p)a(p,O)&&!a(_,O)&&r(p[O])&&(M[O]=h({},M[O]));return M}function Ne(p){p!=null&&this.set(p)}var Ce;Object.keys?Ce=Object.keys:Ce=function(p){var _,M=[];for(_ in p)a(p,_)&&M.push(_);return M};var Ve={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Oe(p,_,M){var O=this._calendar[p]||this._calendar.sameElse;return se(O)?O.call(_,M):O}function Ze(p,_,M){var O=""+Math.abs(p),D=_-O.length,ie=p>=0;return(ie?M?"+":"":"-")+Math.pow(10,Math.max(0,D)).toString().substr(1)+O}var Se=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Fe=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,de={},X={};function te(p,_,M,O){var D=O;typeof O=="string"&&(D=function(){return this[O]()}),p&&(X[p]=D),_&&(X[_[0]]=function(){return Ze(D.apply(this,arguments),_[1],_[2])}),M&&(X[M]=function(){return this.localeData().ordinal(D.apply(this,arguments),p)})}function J(p){return p.match(/\[[\s\S]/)?p.replace(/^\[|\]$/g,""):p.replace(/\\/g,"")}function ee(p){var _=p.match(Se),M,O;for(M=0,O=_.length;M<O;M++)X[_[M]]?_[M]=X[_[M]]:_[M]=J(_[M]);return function(D){var ie="",ye;for(ye=0;ye<O;ye++)ie+=se(_[ye])?_[ye].call(D,p):_[ye];return ie}}function ge(p,_){return p.isValid()?(_=Te(_,p.localeData()),de[_]=de[_]||ee(_),de[_](p)):p.localeData().invalidDate()}function Te(p,_){var M=5;function O(D){return _.longDateFormat(D)||D}for(Fe.lastIndex=0;M>=0&&Fe.test(p);)p=p.replace(Fe,O),Fe.lastIndex=0,M-=1;return p}var Ee={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Pe(p){var _=this._longDateFormat[p],M=this._longDateFormat[p.toUpperCase()];return _||!M?_:(this._longDateFormat[p]=M.match(Se).map(function(O){return O==="MMMM"||O==="MM"||O==="DD"||O==="dddd"?O.slice(1):O}).join(""),this._longDateFormat[p])}var ve="Invalid date";function ot(){return this._invalidDate}var H="%d",mt=/\d{1,2}/;function Je(p){return this._ordinal.replace("%d",p)}var Ot={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function nt(p,_,M,O){var D=this._relativeTime[M];return se(D)?D(p,_,M,O):D.replace(/%d/i,p)}function Be(p,_){var M=this._relativeTime[p>0?"future":"past"];return se(M)?M(_):M.replace(/%s/i,_)}var Ft={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ln(p){return typeof p=="string"?Ft[p]||Ft[p.toLowerCase()]:void 0}function In(p){var _={},M,O;for(O in p)a(p,O)&&(M=ln(O),M&&(_[M]=p[O]));return _}var qi={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Un(p){var _=[],M;for(M in p)a(p,M)&&_.push({unit:M,priority:qi[M]});return _.sort(function(O,D){return O.priority-D.priority}),_}var Zn=/\d/,Et=/\d\d/,Sn=/\d{3}/,Qn=/\d{4}/,Er=/[+-]?\d{6}/,Rt=/\d\d?/,hi=/\d\d\d\d?/,Ct=/\d\d\d\d\d\d?/,dn=/\d{1,3}/,Ei=/\d{1,4}/,zn=/[+-]?\d{1,6}/,Ir=/\d+/,fs=/[+-]?\d+/,nu=/Z|[+-]\d\d:?\d\d/gi,Qs=/Z|[+-]\d\d(?::?\d\d)?/gi,Nd=/[+-]?\d+(\.\d{1,3})?/,Ro=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,so=/^[1-9]\d?/,bl=/^([1-9]\d|\d)/,Js;Js={};function et(p,_,M){Js[p]=se(_)?_:function(O,D){return O&&M?M:_}}function iu(p,_){return a(Js,p)?Js[p](_._strict,_._locale):new RegExp(ru(p))}function ru(p){return ya(p.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(_,M,O,D,ie){return M||O||D||ie}))}function ya(p){return p.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ar(p){return p<0?Math.ceil(p)||0:Math.floor(p)}function Qt(p){var _=+p,M=0;return _!==0&&isFinite(_)&&(M=Ar(_)),M}var yl={};function hn(p,_){var M,O=_,D;for(typeof p=="string"&&(p=[p]),m(_)&&(O=function(ie,ye){ye[_]=Qt(ie)}),D=p.length,M=0;M<D;M++)yl[p[M]]=O}function hs(p,_){hn(p,function(M,O,D,ie){D._w=D._w||{},_(M,D._w,D,ie)})}function Ml(p,_,M){_!=null&&a(yl,p)&&yl[p](_,M._a,M,p)}function ec(p){return p%4===0&&p%100!==0||p%400===0}var Fi=0,Ma=1,T=2,j=3,U=4,z=5,G=6,q=7,pe=8;te("Y",0,0,function(){var p=this.year();return p<=9999?Ze(p,4):"+"+p}),te(0,["YY",2],0,function(){return this.year()%100}),te(0,["YYYY",4],0,"year"),te(0,["YYYYY",5],0,"year"),te(0,["YYYYYY",6,!0],0,"year"),et("Y",fs),et("YY",Rt,Et),et("YYYY",Ei,Qn),et("YYYYY",zn,Er),et("YYYYYY",zn,Er),hn(["YYYYY","YYYYYY"],Fi),hn("YYYY",function(p,_){_[Fi]=p.length===2?i.parseTwoDigitYear(p):Qt(p)}),hn("YY",function(p,_){_[Fi]=i.parseTwoDigitYear(p)}),hn("Y",function(p,_){_[Fi]=parseInt(p,10)});function be(p){return ec(p)?366:365}i.parseTwoDigitYear=function(p){return Qt(p)+(Qt(p)>68?1900:2e3)};var fe=_e("FullYear",!0);function he(){return ec(this.year())}function _e(p,_){return function(M){return M!=null?(je(this,p,M),i.updateOffset(this,_),this):Le(this,p)}}function Le(p,_){if(!p.isValid())return NaN;var M=p._d,O=p._isUTC;switch(_){case"Milliseconds":return O?M.getUTCMilliseconds():M.getMilliseconds();case"Seconds":return O?M.getUTCSeconds():M.getSeconds();case"Minutes":return O?M.getUTCMinutes():M.getMinutes();case"Hours":return O?M.getUTCHours():M.getHours();case"Date":return O?M.getUTCDate():M.getDate();case"Day":return O?M.getUTCDay():M.getDay();case"Month":return O?M.getUTCMonth():M.getMonth();case"FullYear":return O?M.getUTCFullYear():M.getFullYear();default:return NaN}}function je(p,_,M){var O,D,ie,ye,it;if(!(!p.isValid()||isNaN(M))){switch(O=p._d,D=p._isUTC,_){case"Milliseconds":return void(D?O.setUTCMilliseconds(M):O.setMilliseconds(M));case"Seconds":return void(D?O.setUTCSeconds(M):O.setSeconds(M));case"Minutes":return void(D?O.setUTCMinutes(M):O.setMinutes(M));case"Hours":return void(D?O.setUTCHours(M):O.setHours(M));case"Date":return void(D?O.setUTCDate(M):O.setDate(M));case"FullYear":break;default:return}ie=M,ye=p.month(),it=p.date(),it=it===29&&ye===1&&!ec(ie)?28:it,D?O.setUTCFullYear(ie,ye,it):O.setFullYear(ie,ye,it)}}function rt(p){return p=ln(p),se(this[p])?this[p]():this}function $e(p,_){if(typeof p=="object"){p=In(p);var M=Un(p),O,D=M.length;for(O=0;O<D;O++)this[M[O].unit](p[M[O].unit])}else if(p=ln(p),se(this[p]))return this[p](_);return this}function Ke(p,_){return(p%_+_)%_}var at;Array.prototype.indexOf?at=Array.prototype.indexOf:at=function(p){var _;for(_=0;_<this.length;++_)if(this[_]===p)return _;return-1};function vn(p,_){if(isNaN(p)||isNaN(_))return NaN;var M=Ke(_,12);return p+=(_-M)/12,M===1?ec(p)?29:28:31-M%7%2}te("M",["MM",2],"Mo",function(){return this.month()+1}),te("MMM",0,0,function(p){return this.localeData().monthsShort(this,p)}),te("MMMM",0,0,function(p){return this.localeData().months(this,p)}),et("M",Rt,so),et("MM",Rt,Et),et("MMM",function(p,_){return _.monthsShortRegex(p)}),et("MMMM",function(p,_){return _.monthsRegex(p)}),hn(["M","MM"],function(p,_){_[Ma]=Qt(p)-1}),hn(["MMM","MMMM"],function(p,_,M,O){var D=M._locale.monthsParse(p,O,M._strict);D!=null?_[Ma]=D:y(M).invalidMonth=p});var Ji="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Hn="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),er=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,_s=Ro,xs=Ro;function co(p,_){return p?t(this._months)?this._months[p.month()]:this._months[(this._months.isFormat||er).test(_)?"format":"standalone"][p.month()]:t(this._months)?this._months:this._months.standalone}function Pl(p,_){return p?t(this._monthsShort)?this._monthsShort[p.month()]:this._monthsShort[er.test(_)?"format":"standalone"][p.month()]:t(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Pa(p,_,M){var O,D,ie,ye=p.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],O=0;O<12;++O)ie=x([2e3,O]),this._shortMonthsParse[O]=this.monthsShort(ie,"").toLocaleLowerCase(),this._longMonthsParse[O]=this.months(ie,"").toLocaleLowerCase();return M?_==="MMM"?(D=at.call(this._shortMonthsParse,ye),D!==-1?D:null):(D=at.call(this._longMonthsParse,ye),D!==-1?D:null):_==="MMM"?(D=at.call(this._shortMonthsParse,ye),D!==-1?D:(D=at.call(this._longMonthsParse,ye),D!==-1?D:null)):(D=at.call(this._longMonthsParse,ye),D!==-1?D:(D=at.call(this._shortMonthsParse,ye),D!==-1?D:null))}function tP(p,_,M){var O,D,ie;if(this._monthsParseExact)return Pa.call(this,p,_,M);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),O=0;O<12;O++){if(D=x([2e3,O]),M&&!this._longMonthsParse[O]&&(this._longMonthsParse[O]=new RegExp("^"+this.months(D,"").replace(".","")+"$","i"),this._shortMonthsParse[O]=new RegExp("^"+this.monthsShort(D,"").replace(".","")+"$","i")),!M&&!this._monthsParse[O]&&(ie="^"+this.months(D,"")+"|^"+this.monthsShort(D,""),this._monthsParse[O]=new RegExp(ie.replace(".",""),"i")),M&&_==="MMMM"&&this._longMonthsParse[O].test(p))return O;if(M&&_==="MMM"&&this._shortMonthsParse[O].test(p))return O;if(!M&&this._monthsParse[O].test(p))return O}}function gh(p,_){if(!p.isValid())return p;if(typeof _=="string"){if(/^\d+$/.test(_))_=Qt(_);else if(_=p.localeData().monthsParse(_),!m(_))return p}var M=_,O=p.date();return O=O<29?O:Math.min(O,vn(p.year(),M)),p._isUTC?p._d.setUTCMonth(M,O):p._d.setMonth(M,O),p}function uh(p){return p!=null?(gh(this,p),i.updateOffset(this,!0),this):Le(this,"Month")}function nP(){return vn(this.year(),this.month())}function iP(p){return this._monthsParseExact?(a(this,"_monthsRegex")||ph.call(this),p?this._monthsShortStrictRegex:this._monthsShortRegex):(a(this,"_monthsShortRegex")||(this._monthsShortRegex=_s),this._monthsShortStrictRegex&&p?this._monthsShortStrictRegex:this._monthsShortRegex)}function rP(p){return this._monthsParseExact?(a(this,"_monthsRegex")||ph.call(this),p?this._monthsStrictRegex:this._monthsRegex):(a(this,"_monthsRegex")||(this._monthsRegex=xs),this._monthsStrictRegex&&p?this._monthsStrictRegex:this._monthsRegex)}function ph(){function p(It,rn){return rn.length-It.length}var _=[],M=[],O=[],D,ie,ye,it;for(D=0;D<12;D++)ie=x([2e3,D]),ye=ya(this.monthsShort(ie,"")),it=ya(this.months(ie,"")),_.push(ye),M.push(it),O.push(it),O.push(ye);_.sort(p),M.sort(p),O.sort(p),this._monthsRegex=new RegExp("^("+O.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+M.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+_.join("|")+")","i")}function aP(p,_,M,O,D,ie,ye){var it;return p<100&&p>=0?(it=new Date(p+400,_,M,O,D,ie,ye),isFinite(it.getFullYear())&&it.setFullYear(p)):it=new Date(p,_,M,O,D,ie,ye),it}function Ol(p){var _,M;return p<100&&p>=0?(M=Array.prototype.slice.call(arguments),M[0]=p+400,_=new Date(Date.UTC.apply(null,M)),isFinite(_.getUTCFullYear())&&_.setUTCFullYear(p)):_=new Date(Date.UTC.apply(null,arguments)),_}function Ld(p,_,M){var O=7+_-M,D=(7+Ol(p,0,O).getUTCDay()-_)%7;return-D+O-1}function fh(p,_,M,O,D){var ie=(7+M-O)%7,ye=Ld(p,O,D),it=1+7*(_-1)+ie+ye,It,rn;return it<=0?(It=p-1,rn=be(It)+it):it>be(p)?(It=p+1,rn=it-be(p)):(It=p,rn=it),{year:It,dayOfYear:rn}}function wl(p,_,M){var O=Ld(p.year(),_,M),D=Math.floor((p.dayOfYear()-O-1)/7)+1,ie,ye;return D<1?(ye=p.year()-1,ie=D+lo(ye,_,M)):D>lo(p.year(),_,M)?(ie=D-lo(p.year(),_,M),ye=p.year()+1):(ye=p.year(),ie=D),{week:ie,year:ye}}function lo(p,_,M){var O=Ld(p,_,M),D=Ld(p+1,_,M);return(be(p)-O+D)/7}te("w",["ww",2],"wo","week"),te("W",["WW",2],"Wo","isoWeek"),et("w",Rt,so),et("ww",Rt,Et),et("W",Rt,so),et("WW",Rt,Et),hs(["w","ww","W","WW"],function(p,_,M,O){_[O.substr(0,1)]=Qt(p)});function oP(p){return wl(p,this._week.dow,this._week.doy).week}var sP={dow:0,doy:6};function cP(){return this._week.dow}function lP(){return this._week.doy}function dP(p){var _=this.localeData().week(this);return p==null?_:this.add((p-_)*7,"d")}function mP(p){var _=wl(this,1,4).week;return p==null?_:this.add((p-_)*7,"d")}te("d",0,"do","day"),te("dd",0,0,function(p){return this.localeData().weekdaysMin(this,p)}),te("ddd",0,0,function(p){return this.localeData().weekdaysShort(this,p)}),te("dddd",0,0,function(p){return this.localeData().weekdays(this,p)}),te("e",0,0,"weekday"),te("E",0,0,"isoWeekday"),et("d",Rt),et("e",Rt),et("E",Rt),et("dd",function(p,_){return _.weekdaysMinRegex(p)}),et("ddd",function(p,_){return _.weekdaysShortRegex(p)}),et("dddd",function(p,_){return _.weekdaysRegex(p)}),hs(["dd","ddd","dddd"],function(p,_,M,O){var D=M._locale.weekdaysParse(p,O,M._strict);D!=null?_.d=D:y(M).invalidWeekday=p}),hs(["d","e","E"],function(p,_,M,O){_[O]=Qt(p)});function gP(p,_){return typeof p!="string"?p:isNaN(p)?(p=_.weekdaysParse(p),typeof p=="number"?p:null):parseInt(p,10)}function uP(p,_){return typeof p=="string"?_.weekdaysParse(p)%7||7:isNaN(p)?null:p}function au(p,_){return p.slice(_,7).concat(p.slice(0,_))}var pP="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),hh="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),fP="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),hP=Ro,_P=Ro,xP=Ro;function CP(p,_){var M=t(this._weekdays)?this._weekdays:this._weekdays[p&&p!==!0&&this._weekdays.isFormat.test(_)?"format":"standalone"];return p===!0?au(M,this._week.dow):p?M[p.day()]:M}function vP(p){return p===!0?au(this._weekdaysShort,this._week.dow):p?this._weekdaysShort[p.day()]:this._weekdaysShort}function bP(p){return p===!0?au(this._weekdaysMin,this._week.dow):p?this._weekdaysMin[p.day()]:this._weekdaysMin}function yP(p,_,M){var O,D,ie,ye=p.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],O=0;O<7;++O)ie=x([2e3,1]).day(O),this._minWeekdaysParse[O]=this.weekdaysMin(ie,"").toLocaleLowerCase(),this._shortWeekdaysParse[O]=this.weekdaysShort(ie,"").toLocaleLowerCase(),this._weekdaysParse[O]=this.weekdays(ie,"").toLocaleLowerCase();return M?_==="dddd"?(D=at.call(this._weekdaysParse,ye),D!==-1?D:null):_==="ddd"?(D=at.call(this._shortWeekdaysParse,ye),D!==-1?D:null):(D=at.call(this._minWeekdaysParse,ye),D!==-1?D:null):_==="dddd"?(D=at.call(this._weekdaysParse,ye),D!==-1||(D=at.call(this._shortWeekdaysParse,ye),D!==-1)?D:(D=at.call(this._minWeekdaysParse,ye),D!==-1?D:null)):_==="ddd"?(D=at.call(this._shortWeekdaysParse,ye),D!==-1||(D=at.call(this._weekdaysParse,ye),D!==-1)?D:(D=at.call(this._minWeekdaysParse,ye),D!==-1?D:null)):(D=at.call(this._minWeekdaysParse,ye),D!==-1||(D=at.call(this._weekdaysParse,ye),D!==-1)?D:(D=at.call(this._shortWeekdaysParse,ye),D!==-1?D:null))}function MP(p,_,M){var O,D,ie;if(this._weekdaysParseExact)return yP.call(this,p,_,M);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),O=0;O<7;O++){if(D=x([2e3,1]).day(O),M&&!this._fullWeekdaysParse[O]&&(this._fullWeekdaysParse[O]=new RegExp("^"+this.weekdays(D,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[O]=new RegExp("^"+this.weekdaysShort(D,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[O]=new RegExp("^"+this.weekdaysMin(D,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[O]||(ie="^"+this.weekdays(D,"")+"|^"+this.weekdaysShort(D,"")+"|^"+this.weekdaysMin(D,""),this._weekdaysParse[O]=new RegExp(ie.replace(".",""),"i")),M&&_==="dddd"&&this._fullWeekdaysParse[O].test(p))return O;if(M&&_==="ddd"&&this._shortWeekdaysParse[O].test(p))return O;if(M&&_==="dd"&&this._minWeekdaysParse[O].test(p))return O;if(!M&&this._weekdaysParse[O].test(p))return O}}function PP(p){if(!this.isValid())return p!=null?this:NaN;var _=Le(this,"Day");return p!=null?(p=gP(p,this.localeData()),this.add(p-_,"d")):_}function OP(p){if(!this.isValid())return p!=null?this:NaN;var _=(this.day()+7-this.localeData()._week.dow)%7;return p==null?_:this.add(p-_,"d")}function wP(p){if(!this.isValid())return p!=null?this:NaN;if(p!=null){var _=uP(p,this.localeData());return this.day(this.day()%7?_:_-7)}else return this.day()||7}function SP(p){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||ou.call(this),p?this._weekdaysStrictRegex:this._weekdaysRegex):(a(this,"_weekdaysRegex")||(this._weekdaysRegex=hP),this._weekdaysStrictRegex&&p?this._weekdaysStrictRegex:this._weekdaysRegex)}function kP(p){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||ou.call(this),p?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(a(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=_P),this._weekdaysShortStrictRegex&&p?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function TP(p){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||ou.call(this),p?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(a(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=xP),this._weekdaysMinStrictRegex&&p?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function ou(){function p(Pr,fo){return fo.length-Pr.length}var _=[],M=[],O=[],D=[],ie,ye,it,It,rn;for(ie=0;ie<7;ie++)ye=x([2e3,1]).day(ie),it=ya(this.weekdaysMin(ye,"")),It=ya(this.weekdaysShort(ye,"")),rn=ya(this.weekdays(ye,"")),_.push(it),M.push(It),O.push(rn),D.push(it),D.push(It),D.push(rn);_.sort(p),M.sort(p),O.sort(p),D.sort(p),this._weekdaysRegex=new RegExp("^("+D.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+O.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+M.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+_.join("|")+")","i")}function su(){return this.hours()%12||12}function EP(){return this.hours()||24}te("H",["HH",2],0,"hour"),te("h",["hh",2],0,su),te("k",["kk",2],0,EP),te("hmm",0,0,function(){return""+su.apply(this)+Ze(this.minutes(),2)}),te("hmmss",0,0,function(){return""+su.apply(this)+Ze(this.minutes(),2)+Ze(this.seconds(),2)}),te("Hmm",0,0,function(){return""+this.hours()+Ze(this.minutes(),2)}),te("Hmmss",0,0,function(){return""+this.hours()+Ze(this.minutes(),2)+Ze(this.seconds(),2)});function _h(p,_){te(p,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),_)})}_h("a",!0),_h("A",!1);function xh(p,_){return _._meridiemParse}et("a",xh),et("A",xh),et("H",Rt,bl),et("h",Rt,so),et("k",Rt,so),et("HH",Rt,Et),et("hh",Rt,Et),et("kk",Rt,Et),et("hmm",hi),et("hmmss",Ct),et("Hmm",hi),et("Hmmss",Ct),hn(["H","HH"],j),hn(["k","kk"],function(p,_,M){var O=Qt(p);_[j]=O===24?0:O}),hn(["a","A"],function(p,_,M){M._isPm=M._locale.isPM(p),M._meridiem=p}),hn(["h","hh"],function(p,_,M){_[j]=Qt(p),y(M).bigHour=!0}),hn("hmm",function(p,_,M){var O=p.length-2;_[j]=Qt(p.substr(0,O)),_[U]=Qt(p.substr(O)),y(M).bigHour=!0}),hn("hmmss",function(p,_,M){var O=p.length-4,D=p.length-2;_[j]=Qt(p.substr(0,O)),_[U]=Qt(p.substr(O,2)),_[z]=Qt(p.substr(D)),y(M).bigHour=!0}),hn("Hmm",function(p,_,M){var O=p.length-2;_[j]=Qt(p.substr(0,O)),_[U]=Qt(p.substr(O))}),hn("Hmmss",function(p,_,M){var O=p.length-4,D=p.length-2;_[j]=Qt(p.substr(0,O)),_[U]=Qt(p.substr(O,2)),_[z]=Qt(p.substr(D))});function IP(p){return(p+"").toLowerCase().charAt(0)==="p"}var AP=/[ap]\.?m?\.?/i,DP=_e("Hours",!0);function FP(p,_,M){return p>11?M?"pm":"PM":M?"am":"AM"}var Ch={calendar:Ve,longDateFormat:Ee,invalidDate:ve,ordinal:H,dayOfMonthOrdinalParse:mt,relativeTime:Ot,months:Ji,monthsShort:Hn,week:sP,weekdays:pP,weekdaysMin:fP,weekdaysShort:hh,meridiemParse:AP},jn={},Sl={},kl;function RP(p,_){var M,O=Math.min(p.length,_.length);for(M=0;M<O;M+=1)if(p[M]!==_[M])return M;return O}function vh(p){return p&&p.toLowerCase().replace("_","-")}function BP(p){for(var _=0,M,O,D,ie;_<p.length;){for(ie=vh(p[_]).split("-"),M=ie.length,O=vh(p[_+1]),O=O?O.split("-"):null;M>0;){if(D=Vd(ie.slice(0,M).join("-")),D)return D;if(O&&O.length>=M&&RP(ie,O)>=M-1)break;M--}_++}return kl}function NP(p){return!!(p&&p.match("^[^/\\\\]*$"))}function Vd(p){var _=null,M;if(jn[p]===void 0&&typeof Yc<"u"&&Yc&&Yc.exports&&NP(p))try{_=kl._abbr,M=Hh,M("./locale/"+p),Bo(_)}catch{jn[p]=null}return jn[p]}function Bo(p,_){var M;return p&&(l(_)?M=mo(p):M=cu(p,_),M?kl=M:typeof console<"u"&&console.warn&&console.warn("Locale "+p+" not found. Did you forget to load it?")),kl._abbr}function cu(p,_){if(_!==null){var M,O=Ch;if(_.abbr=p,jn[p]!=null)Q("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),O=jn[p]._config;else if(_.parentLocale!=null)if(jn[_.parentLocale]!=null)O=jn[_.parentLocale]._config;else if(M=Vd(_.parentLocale),M!=null)O=M._config;else return Sl[_.parentLocale]||(Sl[_.parentLocale]=[]),Sl[_.parentLocale].push({name:p,config:_}),null;return jn[p]=new Ne(ke(O,_)),Sl[p]&&Sl[p].forEach(function(D){cu(D.name,D.config)}),Bo(p),jn[p]}else return delete jn[p],null}function LP(p,_){if(_!=null){var M,O,D=Ch;jn[p]!=null&&jn[p].parentLocale!=null?jn[p].set(ke(jn[p]._config,_)):(O=Vd(p),O!=null&&(D=O._config),_=ke(D,_),O==null&&(_.abbr=p),M=new Ne(_),M.parentLocale=jn[p],jn[p]=M),Bo(p)}else jn[p]!=null&&(jn[p].parentLocale!=null?(jn[p]=jn[p].parentLocale,p===Bo()&&Bo(p)):jn[p]!=null&&delete jn[p]);return jn[p]}function mo(p){var _;if(p&&p._locale&&p._locale._abbr&&(p=p._locale._abbr),!p)return kl;if(!t(p)){if(_=Vd(p),_)return _;p=[p]}return BP(p)}function VP(){return Ce(jn)}function lu(p){var _,M=p._a;return M&&y(p).overflow===-2&&(_=M[Ma]<0||M[Ma]>11?Ma:M[T]<1||M[T]>vn(M[Fi],M[Ma])?T:M[j]<0||M[j]>24||M[j]===24&&(M[U]!==0||M[z]!==0||M[G]!==0)?j:M[U]<0||M[U]>59?U:M[z]<0||M[z]>59?z:M[G]<0||M[G]>999?G:-1,y(p)._overflowDayOfYear&&(_<Fi||_>T)&&(_=T),y(p)._overflowWeeks&&_===-1&&(_=q),y(p)._overflowWeekday&&_===-1&&(_=pe),y(p).overflow=_),p}var UP=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,zP=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,jP=/Z|[+-]\d\d(?::?\d\d)?/,Ud=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],du=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],$P=/^\/?Date\((-?\d+)/i,YP=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,WP={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function bh(p){var _,M,O=p._i,D=UP.exec(O)||zP.exec(O),ie,ye,it,It,rn=Ud.length,Pr=du.length;if(D){for(y(p).iso=!0,_=0,M=rn;_<M;_++)if(Ud[_][1].exec(D[1])){ye=Ud[_][0],ie=Ud[_][2]!==!1;break}if(ye==null){p._isValid=!1;return}if(D[3]){for(_=0,M=Pr;_<M;_++)if(du[_][1].exec(D[3])){it=(D[2]||" ")+du[_][0];break}if(it==null){p._isValid=!1;return}}if(!ie&&it!=null){p._isValid=!1;return}if(D[4])if(jP.exec(D[4]))It="Z";else{p._isValid=!1;return}p._f=ye+(it||"")+(It||""),gu(p)}else p._isValid=!1}function GP(p,_,M,O,D,ie){var ye=[HP(p),Hn.indexOf(_),parseInt(M,10),parseInt(O,10),parseInt(D,10)];return ie&&ye.push(parseInt(ie,10)),ye}function HP(p){var _=parseInt(p,10);return _<=49?2e3+_:_<=999?1900+_:_}function qP(p){return p.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function XP(p,_,M){if(p){var O=hh.indexOf(p),D=new Date(_[0],_[1],_[2]).getDay();if(O!==D)return y(M).weekdayMismatch=!0,M._isValid=!1,!1}return!0}function KP(p,_,M){if(p)return WP[p];if(_)return 0;var O=parseInt(M,10),D=O%100,ie=(O-D)/100;return ie*60+D}function yh(p){var _=YP.exec(qP(p._i)),M;if(_){if(M=GP(_[4],_[3],_[2],_[5],_[6],_[7]),!XP(_[1],M,p))return;p._a=M,p._tzm=KP(_[8],_[9],_[10]),p._d=Ol.apply(null,p._a),p._d.setUTCMinutes(p._d.getUTCMinutes()-p._tzm),y(p).rfc2822=!0}else p._isValid=!1}function ZP(p){var _=$P.exec(p._i);if(_!==null){p._d=new Date(+_[1]);return}if(bh(p),p._isValid===!1)delete p._isValid;else return;if(yh(p),p._isValid===!1)delete p._isValid;else return;p._strict?p._isValid=!1:i.createFromInputFallback(p)}i.createFromInputFallback=V("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(p){p._d=new Date(p._i+(p._useUTC?" UTC":""))});function tc(p,_,M){return p!=null?p:_!=null?_:M}function QP(p){var _=new Date(i.now());return p._useUTC?[_.getUTCFullYear(),_.getUTCMonth(),_.getUTCDate()]:[_.getFullYear(),_.getMonth(),_.getDate()]}function mu(p){var _,M,O=[],D,ie,ye;if(!p._d){for(D=QP(p),p._w&&p._a[T]==null&&p._a[Ma]==null&&JP(p),p._dayOfYear!=null&&(ye=tc(p._a[Fi],D[Fi]),(p._dayOfYear>be(ye)||p._dayOfYear===0)&&(y(p)._overflowDayOfYear=!0),M=Ol(ye,0,p._dayOfYear),p._a[Ma]=M.getUTCMonth(),p._a[T]=M.getUTCDate()),_=0;_<3&&p._a[_]==null;++_)p._a[_]=O[_]=D[_];for(;_<7;_++)p._a[_]=O[_]=p._a[_]==null?_===2?1:0:p._a[_];p._a[j]===24&&p._a[U]===0&&p._a[z]===0&&p._a[G]===0&&(p._nextDay=!0,p._a[j]=0),p._d=(p._useUTC?Ol:aP).apply(null,O),ie=p._useUTC?p._d.getUTCDay():p._d.getDay(),p._tzm!=null&&p._d.setUTCMinutes(p._d.getUTCMinutes()-p._tzm),p._nextDay&&(p._a[j]=24),p._w&&typeof p._w.d<"u"&&p._w.d!==ie&&(y(p).weekdayMismatch=!0)}}function JP(p){var _,M,O,D,ie,ye,it,It,rn;_=p._w,_.GG!=null||_.W!=null||_.E!=null?(ie=1,ye=4,M=tc(_.GG,p._a[Fi],wl(An(),1,4).year),O=tc(_.W,1),D=tc(_.E,1),(D<1||D>7)&&(It=!0)):(ie=p._locale._week.dow,ye=p._locale._week.doy,rn=wl(An(),ie,ye),M=tc(_.gg,p._a[Fi],rn.year),O=tc(_.w,rn.week),_.d!=null?(D=_.d,(D<0||D>6)&&(It=!0)):_.e!=null?(D=_.e+ie,(_.e<0||_.e>6)&&(It=!0)):D=ie),O<1||O>lo(M,ie,ye)?y(p)._overflowWeeks=!0:It!=null?y(p)._overflowWeekday=!0:(it=fh(M,O,D,ie,ye),p._a[Fi]=it.year,p._dayOfYear=it.dayOfYear)}i.ISO_8601=function(){},i.RFC_2822=function(){};function gu(p){if(p._f===i.ISO_8601){bh(p);return}if(p._f===i.RFC_2822){yh(p);return}p._a=[],y(p).empty=!0;var _=""+p._i,M,O,D,ie,ye,it=_.length,It=0,rn,Pr;for(D=Te(p._f,p._locale).match(Se)||[],Pr=D.length,M=0;M<Pr;M++)ie=D[M],O=(_.match(iu(ie,p))||[])[0],O&&(ye=_.substr(0,_.indexOf(O)),ye.length>0&&y(p).unusedInput.push(ye),_=_.slice(_.indexOf(O)+O.length),It+=O.length),X[ie]?(O?y(p).empty=!1:y(p).unusedTokens.push(ie),Ml(ie,O,p)):p._strict&&!O&&y(p).unusedTokens.push(ie);y(p).charsLeftOver=it-It,_.length>0&&y(p).unusedInput.push(_),p._a[j]<=12&&y(p).bigHour===!0&&p._a[j]>0&&(y(p).bigHour=void 0),y(p).parsedDateParts=p._a.slice(0),y(p).meridiem=p._meridiem,p._a[j]=eO(p._locale,p._a[j],p._meridiem),rn=y(p).era,rn!==null&&(p._a[Fi]=p._locale.erasConvertYear(rn,p._a[Fi])),mu(p),lu(p)}function eO(p,_,M){var O;return M==null?_:p.meridiemHour!=null?p.meridiemHour(_,M):(p.isPM!=null&&(O=p.isPM(M),O&&_<12&&(_+=12),!O&&_===12&&(_=0)),_)}function tO(p){var _,M,O,D,ie,ye,it=!1,It=p._f.length;if(It===0){y(p).invalidFormat=!0,p._d=new Date(NaN);return}for(D=0;D<It;D++)ie=0,ye=!1,_=K({},p),p._useUTC!=null&&(_._useUTC=p._useUTC),_._f=p._f[D],gu(_),w(_)&&(ye=!0),ie+=y(_).charsLeftOver,ie+=y(_).unusedTokens.length*10,y(_).score=ie,it?ie<O&&(O=ie,M=_):(O==null||ie<O||ye)&&(O=ie,M=_,ye&&(it=!0));h(p,M||_)}function nO(p){if(!p._d){var _=In(p._i),M=_.day===void 0?_.date:_.day;p._a=f([_.year,_.month,M,_.hour,_.minute,_.second,_.millisecond],function(O){return O&&parseInt(O,10)}),mu(p)}}function iO(p){var _=new Z(lu(Mh(p)));return _._nextDay&&(_.add(1,"d"),_._nextDay=void 0),_}function Mh(p){var _=p._i,M=p._f;return p._locale=p._locale||mo(p._l),_===null||M===void 0&&_===""?A({nullInput:!0}):(typeof _=="string"&&(p._i=_=p._locale.preparse(_)),k(_)?new Z(lu(_)):(g(_)?p._d=_:t(M)?tO(p):M?gu(p):rO(p),w(p)||(p._d=null),p))}function rO(p){var _=p._i;l(_)?p._d=new Date(i.now()):g(_)?p._d=new Date(_.valueOf()):typeof _=="string"?ZP(p):t(_)?(p._a=f(_.slice(0),function(M){return parseInt(M,10)}),mu(p)):r(_)?nO(p):m(_)?p._d=new Date(_):i.createFromInputFallback(p)}function Ph(p,_,M,O,D){var ie={};return(_===!0||_===!1)&&(O=_,_=void 0),(M===!0||M===!1)&&(O=M,M=void 0),(r(p)&&o(p)||t(p)&&p.length===0)&&(p=void 0),ie._isAMomentObject=!0,ie._useUTC=ie._isUTC=D,ie._l=M,ie._i=p,ie._f=_,ie._strict=O,iO(ie)}function An(p,_,M,O){return Ph(p,_,M,O,!1)}var aO=V("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var p=An.apply(null,arguments);return this.isValid()&&p.isValid()?p<this?this:p:A()}),oO=V("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var p=An.apply(null,arguments);return this.isValid()&&p.isValid()?p>this?this:p:A()});function Oh(p,_){var M,O;if(_.length===1&&t(_[0])&&(_=_[0]),!_.length)return An();for(M=_[0],O=1;O<_.length;++O)(!_[O].isValid()||_[O][p](M))&&(M=_[O]);return M}function sO(){var p=[].slice.call(arguments,0);return Oh("isBefore",p)}function cO(){var p=[].slice.call(arguments,0);return Oh("isAfter",p)}var lO=function(){return Date.now?Date.now():+new Date},Tl=["year","quarter","month","week","day","hour","minute","second","millisecond"];function dO(p){var _,M=!1,O,D=Tl.length;for(_ in p)if(a(p,_)&&!(at.call(Tl,_)!==-1&&(p[_]==null||!isNaN(p[_]))))return!1;for(O=0;O<D;++O)if(p[Tl[O]]){if(M)return!1;parseFloat(p[Tl[O]])!==Qt(p[Tl[O]])&&(M=!0)}return!0}function mO(){return this._isValid}function gO(){return Oa(NaN)}function zd(p){var _=In(p),M=_.year||0,O=_.quarter||0,D=_.month||0,ie=_.week||_.isoWeek||0,ye=_.day||0,it=_.hour||0,It=_.minute||0,rn=_.second||0,Pr=_.millisecond||0;this._isValid=dO(_),this._milliseconds=+Pr+rn*1e3+It*6e4+it*1e3*60*60,this._days=+ye+ie*7,this._months=+D+O*3+M*12,this._data={},this._locale=mo(),this._bubble()}function jd(p){return p instanceof zd}function uu(p){return p<0?Math.round(-1*p)*-1:Math.round(p)}function uO(p,_,M){var O=Math.min(p.length,_.length),D=Math.abs(p.length-_.length),ie=0,ye;for(ye=0;ye<O;ye++)(M&&p[ye]!==_[ye]||!M&&Qt(p[ye])!==Qt(_[ye]))&&ie++;return ie+D}function wh(p,_){te(p,0,0,function(){var M=this.utcOffset(),O="+";return M<0&&(M=-M,O="-"),O+Ze(~~(M/60),2)+_+Ze(~~M%60,2)})}wh("Z",":"),wh("ZZ",""),et("Z",Qs),et("ZZ",Qs),hn(["Z","ZZ"],function(p,_,M){M._useUTC=!0,M._tzm=pu(Qs,p)});var pO=/([\+\-]|\d\d)/gi;function pu(p,_){var M=(_||"").match(p),O,D,ie;return M===null?null:(O=M[M.length-1]||[],D=(O+"").match(pO)||["-",0,0],ie=+(D[1]*60)+Qt(D[2]),ie===0?0:D[0]==="+"?ie:-ie)}function fu(p,_){var M,O;return _._isUTC?(M=_.clone(),O=(k(p)||g(p)?p.valueOf():An(p).valueOf())-M.valueOf(),M._d.setTime(M._d.valueOf()+O),i.updateOffset(M,!1),M):An(p).local()}function hu(p){return-Math.round(p._d.getTimezoneOffset())}i.updateOffset=function(){};function fO(p,_,M){var O=this._offset||0,D;if(!this.isValid())return p!=null?this:NaN;if(p!=null){if(typeof p=="string"){if(p=pu(Qs,p),p===null)return this}else Math.abs(p)<16&&!M&&(p=p*60);return!this._isUTC&&_&&(D=hu(this)),this._offset=p,this._isUTC=!0,D!=null&&this.add(D,"m"),O!==p&&(!_||this._changeInProgress?Eh(this,Oa(p-O,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,i.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?O:hu(this)}function hO(p,_){return p!=null?(typeof p!="string"&&(p=-p),this.utcOffset(p,_),this):-this.utcOffset()}function _O(p){return this.utcOffset(0,p)}function xO(p){return this._isUTC&&(this.utcOffset(0,p),this._isUTC=!1,p&&this.subtract(hu(this),"m")),this}function CO(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var p=pu(nu,this._i);p!=null?this.utcOffset(p):this.utcOffset(0,!0)}return this}function vO(p){return this.isValid()?(p=p?An(p).utcOffset():0,(this.utcOffset()-p)%60===0):!1}function bO(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function yO(){if(!l(this._isDSTShifted))return this._isDSTShifted;var p={},_;return K(p,this),p=Mh(p),p._a?(_=p._isUTC?x(p._a):An(p._a),this._isDSTShifted=this.isValid()&&uO(p._a,_.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function MO(){return this.isValid()?!this._isUTC:!1}function PO(){return this.isValid()?this._isUTC:!1}function Sh(){return this.isValid()?this._isUTC&&this._offset===0:!1}var OO=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,wO=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Oa(p,_){var M=p,O=null,D,ie,ye;return jd(p)?M={ms:p._milliseconds,d:p._days,M:p._months}:m(p)||!isNaN(+p)?(M={},_?M[_]=+p:M.milliseconds=+p):(O=OO.exec(p))?(D=O[1]==="-"?-1:1,M={y:0,d:Qt(O[T])*D,h:Qt(O[j])*D,m:Qt(O[U])*D,s:Qt(O[z])*D,ms:Qt(uu(O[G]*1e3))*D}):(O=wO.exec(p))?(D=O[1]==="-"?-1:1,M={y:Cs(O[2],D),M:Cs(O[3],D),w:Cs(O[4],D),d:Cs(O[5],D),h:Cs(O[6],D),m:Cs(O[7],D),s:Cs(O[8],D)}):M==null?M={}:typeof M=="object"&&("from"in M||"to"in M)&&(ye=SO(An(M.from),An(M.to)),M={},M.ms=ye.milliseconds,M.M=ye.months),ie=new zd(M),jd(p)&&a(p,"_locale")&&(ie._locale=p._locale),jd(p)&&a(p,"_isValid")&&(ie._isValid=p._isValid),ie}Oa.fn=zd.prototype,Oa.invalid=gO;function Cs(p,_){var M=p&&parseFloat(p.replace(",","."));return(isNaN(M)?0:M)*_}function kh(p,_){var M={};return M.months=_.month()-p.month()+(_.year()-p.year())*12,p.clone().add(M.months,"M").isAfter(_)&&--M.months,M.milliseconds=+_-+p.clone().add(M.months,"M"),M}function SO(p,_){var M;return p.isValid()&&_.isValid()?(_=fu(_,p),p.isBefore(_)?M=kh(p,_):(M=kh(_,p),M.milliseconds=-M.milliseconds,M.months=-M.months),M):{milliseconds:0,months:0}}function Th(p,_){return function(M,O){var D,ie;return O!==null&&!isNaN(+O)&&(Q(_,"moment()."+_+"(period, number) is deprecated. Please use moment()."+_+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),ie=M,M=O,O=ie),D=Oa(M,O),Eh(this,D,p),this}}function Eh(p,_,M,O){var D=_._milliseconds,ie=uu(_._days),ye=uu(_._months);p.isValid()&&(O=O==null?!0:O,ye&&gh(p,Le(p,"Month")+ye*M),ie&&je(p,"Date",Le(p,"Date")+ie*M),D&&p._d.setTime(p._d.valueOf()+D*M),O&&i.updateOffset(p,ie||ye))}var kO=Th(1,"add"),TO=Th(-1,"subtract");function Ih(p){return typeof p=="string"||p instanceof String}function EO(p){return k(p)||g(p)||Ih(p)||m(p)||AO(p)||IO(p)||p===null||p===void 0}function IO(p){var _=r(p)&&!o(p),M=!1,O=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],D,ie,ye=O.length;for(D=0;D<ye;D+=1)ie=O[D],M=M||a(p,ie);return _&&M}function AO(p){var _=t(p),M=!1;return _&&(M=p.filter(function(O){return!m(O)&&Ih(p)}).length===0),_&&M}function DO(p){var _=r(p)&&!o(p),M=!1,O=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],D,ie;for(D=0;D<O.length;D+=1)ie=O[D],M=M||a(p,ie);return _&&M}function FO(p,_){var M=p.diff(_,"days",!0);return M<-6?"sameElse":M<-1?"lastWeek":M<0?"lastDay":M<1?"sameDay":M<2?"nextDay":M<7?"nextWeek":"sameElse"}function RO(p,_){arguments.length===1&&(arguments[0]?EO(arguments[0])?(p=arguments[0],_=void 0):DO(arguments[0])&&(_=arguments[0],p=void 0):(p=void 0,_=void 0));var M=p||An(),O=fu(M,this).startOf("day"),D=i.calendarFormat(this,O)||"sameElse",ie=_&&(se(_[D])?_[D].call(this,M):_[D]);return this.format(ie||this.localeData().calendar(D,this,An(M)))}function BO(){return new Z(this)}function NO(p,_){var M=k(p)?p:An(p);return this.isValid()&&M.isValid()?(_=ln(_)||"millisecond",_==="millisecond"?this.valueOf()>M.valueOf():M.valueOf()<this.clone().startOf(_).valueOf()):!1}function LO(p,_){var M=k(p)?p:An(p);return this.isValid()&&M.isValid()?(_=ln(_)||"millisecond",_==="millisecond"?this.valueOf()<M.valueOf():this.clone().endOf(_).valueOf()<M.valueOf()):!1}function VO(p,_,M,O){var D=k(p)?p:An(p),ie=k(_)?_:An(_);return this.isValid()&&D.isValid()&&ie.isValid()?(O=O||"()",(O[0]==="("?this.isAfter(D,M):!this.isBefore(D,M))&&(O[1]===")"?this.isBefore(ie,M):!this.isAfter(ie,M))):!1}function UO(p,_){var M=k(p)?p:An(p),O;return this.isValid()&&M.isValid()?(_=ln(_)||"millisecond",_==="millisecond"?this.valueOf()===M.valueOf():(O=M.valueOf(),this.clone().startOf(_).valueOf()<=O&&O<=this.clone().endOf(_).valueOf())):!1}function zO(p,_){return this.isSame(p,_)||this.isAfter(p,_)}function jO(p,_){return this.isSame(p,_)||this.isBefore(p,_)}function $O(p,_,M){var O,D,ie;if(!this.isValid())return NaN;if(O=fu(p,this),!O.isValid())return NaN;switch(D=(O.utcOffset()-this.utcOffset())*6e4,_=ln(_),_){case"year":ie=$d(this,O)/12;break;case"month":ie=$d(this,O);break;case"quarter":ie=$d(this,O)/3;break;case"second":ie=(this-O)/1e3;break;case"minute":ie=(this-O)/6e4;break;case"hour":ie=(this-O)/36e5;break;case"day":ie=(this-O-D)/864e5;break;case"week":ie=(this-O-D)/6048e5;break;default:ie=this-O}return M?ie:Ar(ie)}function $d(p,_){if(p.date()<_.date())return-$d(_,p);var M=(_.year()-p.year())*12+(_.month()-p.month()),O=p.clone().add(M,"months"),D,ie;return _-O<0?(D=p.clone().add(M-1,"months"),ie=(_-O)/(O-D)):(D=p.clone().add(M+1,"months"),ie=(_-O)/(D-O)),-(M+ie)||0}i.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",i.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function YO(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function WO(p){if(!this.isValid())return null;var _=p!==!0,M=_?this.clone().utc():this;return M.year()<0||M.year()>9999?ge(M,_?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):se(Date.prototype.toISOString)?_?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",ge(M,"Z")):ge(M,_?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function GO(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var p="moment",_="",M,O,D,ie;return this.isLocal()||(p=this.utcOffset()===0?"moment.utc":"moment.parseZone",_="Z"),M="["+p+'("]',O=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",D="-MM-DD[T]HH:mm:ss.SSS",ie=_+'[")]',this.format(M+O+D+ie)}function HO(p){p||(p=this.isUtc()?i.defaultFormatUtc:i.defaultFormat);var _=ge(this,p);return this.localeData().postformat(_)}function qO(p,_){return this.isValid()&&(k(p)&&p.isValid()||An(p).isValid())?Oa({to:this,from:p}).locale(this.locale()).humanize(!_):this.localeData().invalidDate()}function XO(p){return this.from(An(),p)}function KO(p,_){return this.isValid()&&(k(p)&&p.isValid()||An(p).isValid())?Oa({from:this,to:p}).locale(this.locale()).humanize(!_):this.localeData().invalidDate()}function ZO(p){return this.to(An(),p)}function Ah(p){var _;return p===void 0?this._locale._abbr:(_=mo(p),_!=null&&(this._locale=_),this)}var Dh=V("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(p){return p===void 0?this.localeData():this.locale(p)});function Fh(){return this._locale}var Yd=1e3,nc=60*Yd,Wd=60*nc,Rh=(365*400+97)*24*Wd;function ic(p,_){return(p%_+_)%_}function Bh(p,_,M){return p<100&&p>=0?new Date(p+400,_,M)-Rh:new Date(p,_,M).valueOf()}function Nh(p,_,M){return p<100&&p>=0?Date.UTC(p+400,_,M)-Rh:Date.UTC(p,_,M)}function QO(p){var _,M;if(p=ln(p),p===void 0||p==="millisecond"||!this.isValid())return this;switch(M=this._isUTC?Nh:Bh,p){case"year":_=M(this.year(),0,1);break;case"quarter":_=M(this.year(),this.month()-this.month()%3,1);break;case"month":_=M(this.year(),this.month(),1);break;case"week":_=M(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":_=M(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":_=M(this.year(),this.month(),this.date());break;case"hour":_=this._d.valueOf(),_-=ic(_+(this._isUTC?0:this.utcOffset()*nc),Wd);break;case"minute":_=this._d.valueOf(),_-=ic(_,nc);break;case"second":_=this._d.valueOf(),_-=ic(_,Yd);break}return this._d.setTime(_),i.updateOffset(this,!0),this}function JO(p){var _,M;if(p=ln(p),p===void 0||p==="millisecond"||!this.isValid())return this;switch(M=this._isUTC?Nh:Bh,p){case"year":_=M(this.year()+1,0,1)-1;break;case"quarter":_=M(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":_=M(this.year(),this.month()+1,1)-1;break;case"week":_=M(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":_=M(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":_=M(this.year(),this.month(),this.date()+1)-1;break;case"hour":_=this._d.valueOf(),_+=Wd-ic(_+(this._isUTC?0:this.utcOffset()*nc),Wd)-1;break;case"minute":_=this._d.valueOf(),_+=nc-ic(_,nc)-1;break;case"second":_=this._d.valueOf(),_+=Yd-ic(_,Yd)-1;break}return this._d.setTime(_),i.updateOffset(this,!0),this}function ew(){return this._d.valueOf()-(this._offset||0)*6e4}function tw(){return Math.floor(this.valueOf()/1e3)}function nw(){return new Date(this.valueOf())}function iw(){var p=this;return[p.year(),p.month(),p.date(),p.hour(),p.minute(),p.second(),p.millisecond()]}function rw(){var p=this;return{years:p.year(),months:p.month(),date:p.date(),hours:p.hours(),minutes:p.minutes(),seconds:p.seconds(),milliseconds:p.milliseconds()}}function aw(){return this.isValid()?this.toISOString():null}function ow(){return w(this)}function sw(){return h({},y(this))}function cw(){return y(this).overflow}function lw(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}te("N",0,0,"eraAbbr"),te("NN",0,0,"eraAbbr"),te("NNN",0,0,"eraAbbr"),te("NNNN",0,0,"eraName"),te("NNNNN",0,0,"eraNarrow"),te("y",["y",1],"yo","eraYear"),te("y",["yy",2],0,"eraYear"),te("y",["yyy",3],0,"eraYear"),te("y",["yyyy",4],0,"eraYear"),et("N",_u),et("NN",_u),et("NNN",_u),et("NNNN",vw),et("NNNNN",bw),hn(["N","NN","NNN","NNNN","NNNNN"],function(p,_,M,O){var D=M._locale.erasParse(p,O,M._strict);D?y(M).era=D:y(M).invalidEra=p}),et("y",Ir),et("yy",Ir),et("yyy",Ir),et("yyyy",Ir),et("yo",yw),hn(["y","yy","yyy","yyyy"],Fi),hn(["yo"],function(p,_,M,O){var D;M._locale._eraYearOrdinalRegex&&(D=p.match(M._locale._eraYearOrdinalRegex)),M._locale.eraYearOrdinalParse?_[Fi]=M._locale.eraYearOrdinalParse(p,D):_[Fi]=parseInt(p,10)});function dw(p,_){var M,O,D,ie=this._eras||mo("en")._eras;for(M=0,O=ie.length;M<O;++M){switch(typeof ie[M].since){case"string":D=i(ie[M].since).startOf("day"),ie[M].since=D.valueOf();break}switch(typeof ie[M].until){case"undefined":ie[M].until=1/0;break;case"string":D=i(ie[M].until).startOf("day").valueOf(),ie[M].until=D.valueOf();break}}return ie}function mw(p,_,M){var O,D,ie=this.eras(),ye,it,It;for(p=p.toUpperCase(),O=0,D=ie.length;O<D;++O)if(ye=ie[O].name.toUpperCase(),it=ie[O].abbr.toUpperCase(),It=ie[O].narrow.toUpperCase(),M)switch(_){case"N":case"NN":case"NNN":if(it===p)return ie[O];break;case"NNNN":if(ye===p)return ie[O];break;case"NNNNN":if(It===p)return ie[O];break}else if([ye,it,It].indexOf(p)>=0)return ie[O]}function gw(p,_){var M=p.since<=p.until?1:-1;return _===void 0?i(p.since).year():i(p.since).year()+(_-p.offset)*M}function uw(){var p,_,M,O=this.localeData().eras();for(p=0,_=O.length;p<_;++p)if(M=this.clone().startOf("day").valueOf(),O[p].since<=M&&M<=O[p].until||O[p].until<=M&&M<=O[p].since)return O[p].name;return""}function pw(){var p,_,M,O=this.localeData().eras();for(p=0,_=O.length;p<_;++p)if(M=this.clone().startOf("day").valueOf(),O[p].since<=M&&M<=O[p].until||O[p].until<=M&&M<=O[p].since)return O[p].narrow;return""}function fw(){var p,_,M,O=this.localeData().eras();for(p=0,_=O.length;p<_;++p)if(M=this.clone().startOf("day").valueOf(),O[p].since<=M&&M<=O[p].until||O[p].until<=M&&M<=O[p].since)return O[p].abbr;return""}function hw(){var p,_,M,O,D=this.localeData().eras();for(p=0,_=D.length;p<_;++p)if(M=D[p].since<=D[p].until?1:-1,O=this.clone().startOf("day").valueOf(),D[p].since<=O&&O<=D[p].until||D[p].until<=O&&O<=D[p].since)return(this.year()-i(D[p].since).year())*M+D[p].offset;return this.year()}function _w(p){return a(this,"_erasNameRegex")||xu.call(this),p?this._erasNameRegex:this._erasRegex}function xw(p){return a(this,"_erasAbbrRegex")||xu.call(this),p?this._erasAbbrRegex:this._erasRegex}function Cw(p){return a(this,"_erasNarrowRegex")||xu.call(this),p?this._erasNarrowRegex:this._erasRegex}function _u(p,_){return _.erasAbbrRegex(p)}function vw(p,_){return _.erasNameRegex(p)}function bw(p,_){return _.erasNarrowRegex(p)}function yw(p,_){return _._eraYearOrdinalRegex||Ir}function xu(){var p=[],_=[],M=[],O=[],D,ie,ye,it,It,rn=this.eras();for(D=0,ie=rn.length;D<ie;++D)ye=ya(rn[D].name),it=ya(rn[D].abbr),It=ya(rn[D].narrow),_.push(ye),p.push(it),M.push(It),O.push(ye),O.push(it),O.push(It);this._erasRegex=new RegExp("^("+O.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+_.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+p.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+M.join("|")+")","i")}te(0,["gg",2],0,function(){return this.weekYear()%100}),te(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Gd(p,_){te(0,[p,p.length],0,_)}Gd("gggg","weekYear"),Gd("ggggg","weekYear"),Gd("GGGG","isoWeekYear"),Gd("GGGGG","isoWeekYear"),et("G",fs),et("g",fs),et("GG",Rt,Et),et("gg",Rt,Et),et("GGGG",Ei,Qn),et("gggg",Ei,Qn),et("GGGGG",zn,Er),et("ggggg",zn,Er),hs(["gggg","ggggg","GGGG","GGGGG"],function(p,_,M,O){_[O.substr(0,2)]=Qt(p)}),hs(["gg","GG"],function(p,_,M,O){_[O]=i.parseTwoDigitYear(p)});function Mw(p){return Lh.call(this,p,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Pw(p){return Lh.call(this,p,this.isoWeek(),this.isoWeekday(),1,4)}function Ow(){return lo(this.year(),1,4)}function ww(){return lo(this.isoWeekYear(),1,4)}function Sw(){var p=this.localeData()._week;return lo(this.year(),p.dow,p.doy)}function kw(){var p=this.localeData()._week;return lo(this.weekYear(),p.dow,p.doy)}function Lh(p,_,M,O,D){var ie;return p==null?wl(this,O,D).year:(ie=lo(p,O,D),_>ie&&(_=ie),Tw.call(this,p,_,M,O,D))}function Tw(p,_,M,O,D){var ie=fh(p,_,M,O,D),ye=Ol(ie.year,0,ie.dayOfYear);return this.year(ye.getUTCFullYear()),this.month(ye.getUTCMonth()),this.date(ye.getUTCDate()),this}te("Q",0,"Qo","quarter"),et("Q",Zn),hn("Q",function(p,_){_[Ma]=(Qt(p)-1)*3});function Ew(p){return p==null?Math.ceil((this.month()+1)/3):this.month((p-1)*3+this.month()%3)}te("D",["DD",2],"Do","date"),et("D",Rt,so),et("DD",Rt,Et),et("Do",function(p,_){return p?_._dayOfMonthOrdinalParse||_._ordinalParse:_._dayOfMonthOrdinalParseLenient}),hn(["D","DD"],T),hn("Do",function(p,_){_[T]=Qt(p.match(Rt)[0])});var Vh=_e("Date",!0);te("DDD",["DDDD",3],"DDDo","dayOfYear"),et("DDD",dn),et("DDDD",Sn),hn(["DDD","DDDD"],function(p,_,M){M._dayOfYear=Qt(p)});function Iw(p){var _=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return p==null?_:this.add(p-_,"d")}te("m",["mm",2],0,"minute"),et("m",Rt,bl),et("mm",Rt,Et),hn(["m","mm"],U);var Aw=_e("Minutes",!1);te("s",["ss",2],0,"second"),et("s",Rt,bl),et("ss",Rt,Et),hn(["s","ss"],z);var Dw=_e("Seconds",!1);te("S",0,0,function(){return~~(this.millisecond()/100)}),te(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),te(0,["SSS",3],0,"millisecond"),te(0,["SSSS",4],0,function(){return this.millisecond()*10}),te(0,["SSSSS",5],0,function(){return this.millisecond()*100}),te(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),te(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),te(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),te(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),et("S",dn,Zn),et("SS",dn,Et),et("SSS",dn,Sn);var No,Uh;for(No="SSSS";No.length<=9;No+="S")et(No,Ir);function Fw(p,_){_[G]=Qt(("0."+p)*1e3)}for(No="S";No.length<=9;No+="S")hn(No,Fw);Uh=_e("Milliseconds",!1),te("z",0,0,"zoneAbbr"),te("zz",0,0,"zoneName");function Rw(){return this._isUTC?"UTC":""}function Bw(){return this._isUTC?"Coordinated Universal Time":""}var Ue=Z.prototype;Ue.add=kO,Ue.calendar=RO,Ue.clone=BO,Ue.diff=$O,Ue.endOf=JO,Ue.format=HO,Ue.from=qO,Ue.fromNow=XO,Ue.to=KO,Ue.toNow=ZO,Ue.get=rt,Ue.invalidAt=cw,Ue.isAfter=NO,Ue.isBefore=LO,Ue.isBetween=VO,Ue.isSame=UO,Ue.isSameOrAfter=zO,Ue.isSameOrBefore=jO,Ue.isValid=ow,Ue.lang=Dh,Ue.locale=Ah,Ue.localeData=Fh,Ue.max=oO,Ue.min=aO,Ue.parsingFlags=sw,Ue.set=$e,Ue.startOf=QO,Ue.subtract=TO,Ue.toArray=iw,Ue.toObject=rw,Ue.toDate=nw,Ue.toISOString=WO,Ue.inspect=GO,typeof Symbol<"u"&&Symbol.for!=null&&(Ue[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Ue.toJSON=aw,Ue.toString=YO,Ue.unix=tw,Ue.valueOf=ew,Ue.creationData=lw,Ue.eraName=uw,Ue.eraNarrow=pw,Ue.eraAbbr=fw,Ue.eraYear=hw,Ue.year=fe,Ue.isLeapYear=he,Ue.weekYear=Mw,Ue.isoWeekYear=Pw,Ue.quarter=Ue.quarters=Ew,Ue.month=uh,Ue.daysInMonth=nP,Ue.week=Ue.weeks=dP,Ue.isoWeek=Ue.isoWeeks=mP,Ue.weeksInYear=Sw,Ue.weeksInWeekYear=kw,Ue.isoWeeksInYear=Ow,Ue.isoWeeksInISOWeekYear=ww,Ue.date=Vh,Ue.day=Ue.days=PP,Ue.weekday=OP,Ue.isoWeekday=wP,Ue.dayOfYear=Iw,Ue.hour=Ue.hours=DP,Ue.minute=Ue.minutes=Aw,Ue.second=Ue.seconds=Dw,Ue.millisecond=Ue.milliseconds=Uh,Ue.utcOffset=fO,Ue.utc=_O,Ue.local=xO,Ue.parseZone=CO,Ue.hasAlignedHourOffset=vO,Ue.isDST=bO,Ue.isLocal=MO,Ue.isUtcOffset=PO,Ue.isUtc=Sh,Ue.isUTC=Sh,Ue.zoneAbbr=Rw,Ue.zoneName=Bw,Ue.dates=V("dates accessor is deprecated. Use date instead.",Vh),Ue.months=V("months accessor is deprecated. Use month instead",uh),Ue.years=V("years accessor is deprecated. Use year instead",fe),Ue.zone=V("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",hO),Ue.isDSTShifted=V("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",yO);function Nw(p){return An(p*1e3)}function Lw(){return An.apply(null,arguments).parseZone()}function zh(p){return p}var mn=Ne.prototype;mn.calendar=Oe,mn.longDateFormat=Pe,mn.invalidDate=ot,mn.ordinal=Je,mn.preparse=zh,mn.postformat=zh,mn.relativeTime=nt,mn.pastFuture=Be,mn.set=ae,mn.eras=dw,mn.erasParse=mw,mn.erasConvertYear=gw,mn.erasAbbrRegex=xw,mn.erasNameRegex=_w,mn.erasNarrowRegex=Cw,mn.months=co,mn.monthsShort=Pl,mn.monthsParse=tP,mn.monthsRegex=rP,mn.monthsShortRegex=iP,mn.week=oP,mn.firstDayOfYear=lP,mn.firstDayOfWeek=cP,mn.weekdays=CP,mn.weekdaysMin=bP,mn.weekdaysShort=vP,mn.weekdaysParse=MP,mn.weekdaysRegex=SP,mn.weekdaysShortRegex=kP,mn.weekdaysMinRegex=TP,mn.isPM=IP,mn.meridiem=FP;function Hd(p,_,M,O){var D=mo(),ie=x().set(O,_);return D[M](ie,p)}function jh(p,_,M){if(m(p)&&(_=p,p=void 0),p=p||"",_!=null)return Hd(p,_,M,"month");var O,D=[];for(O=0;O<12;O++)D[O]=Hd(p,O,M,"month");return D}function Cu(p,_,M,O){typeof p=="boolean"?(m(_)&&(M=_,_=void 0),_=_||""):(_=p,M=_,p=!1,m(_)&&(M=_,_=void 0),_=_||"");var D=mo(),ie=p?D._week.dow:0,ye,it=[];if(M!=null)return Hd(_,(M+ie)%7,O,"day");for(ye=0;ye<7;ye++)it[ye]=Hd(_,(ye+ie)%7,O,"day");return it}function Vw(p,_){return jh(p,_,"months")}function Uw(p,_){return jh(p,_,"monthsShort")}function zw(p,_,M){return Cu(p,_,M,"weekdays")}function jw(p,_,M){return Cu(p,_,M,"weekdaysShort")}function $w(p,_,M){return Cu(p,_,M,"weekdaysMin")}Bo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(p){var _=p%10,M=Qt(p%100/10)===1?"th":_===1?"st":_===2?"nd":_===3?"rd":"th";return p+M}}),i.lang=V("moment.lang is deprecated. Use moment.locale instead.",Bo),i.langData=V("moment.langData is deprecated. Use moment.localeData instead.",mo);var go=Math.abs;function Yw(){var p=this._data;return this._milliseconds=go(this._milliseconds),this._days=go(this._days),this._months=go(this._months),p.milliseconds=go(p.milliseconds),p.seconds=go(p.seconds),p.minutes=go(p.minutes),p.hours=go(p.hours),p.months=go(p.months),p.years=go(p.years),this}function $h(p,_,M,O){var D=Oa(_,M);return p._milliseconds+=O*D._milliseconds,p._days+=O*D._days,p._months+=O*D._months,p._bubble()}function Ww(p,_){return $h(this,p,_,1)}function Gw(p,_){return $h(this,p,_,-1)}function Yh(p){return p<0?Math.floor(p):Math.ceil(p)}function Hw(){var p=this._milliseconds,_=this._days,M=this._months,O=this._data,D,ie,ye,it,It;return p>=0&&_>=0&&M>=0||p<=0&&_<=0&&M<=0||(p+=Yh(vu(M)+_)*864e5,_=0,M=0),O.milliseconds=p%1e3,D=Ar(p/1e3),O.seconds=D%60,ie=Ar(D/60),O.minutes=ie%60,ye=Ar(ie/60),O.hours=ye%24,_+=Ar(ye/24),It=Ar(Wh(_)),M+=It,_-=Yh(vu(It)),it=Ar(M/12),M%=12,O.days=_,O.months=M,O.years=it,this}function Wh(p){return p*4800/146097}function vu(p){return p*146097/4800}function qw(p){if(!this.isValid())return NaN;var _,M,O=this._milliseconds;if(p=ln(p),p==="month"||p==="quarter"||p==="year")switch(_=this._days+O/864e5,M=this._months+Wh(_),p){case"month":return M;case"quarter":return M/3;case"year":return M/12}else switch(_=this._days+Math.round(vu(this._months)),p){case"week":return _/7+O/6048e5;case"day":return _+O/864e5;case"hour":return _*24+O/36e5;case"minute":return _*1440+O/6e4;case"second":return _*86400+O/1e3;case"millisecond":return Math.floor(_*864e5)+O;default:throw new Error("Unknown unit "+p)}}function uo(p){return function(){return this.as(p)}}var Gh=uo("ms"),Xw=uo("s"),Kw=uo("m"),Zw=uo("h"),Qw=uo("d"),Jw=uo("w"),eS=uo("M"),tS=uo("Q"),nS=uo("y"),iS=Gh;function rS(){return Oa(this)}function aS(p){return p=ln(p),this.isValid()?this[p+"s"]():NaN}function vs(p){return function(){return this.isValid()?this._data[p]:NaN}}var oS=vs("milliseconds"),sS=vs("seconds"),cS=vs("minutes"),lS=vs("hours"),dS=vs("days"),mS=vs("months"),gS=vs("years");function uS(){return Ar(this.days()/7)}var po=Math.round,rc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function pS(p,_,M,O,D){return D.relativeTime(_||1,!!M,p,O)}function fS(p,_,M,O){var D=Oa(p).abs(),ie=po(D.as("s")),ye=po(D.as("m")),it=po(D.as("h")),It=po(D.as("d")),rn=po(D.as("M")),Pr=po(D.as("w")),fo=po(D.as("y")),Lo=ie<=M.ss&&["s",ie]||ie<M.s&&["ss",ie]||ye<=1&&["m"]||ye<M.m&&["mm",ye]||it<=1&&["h"]||it<M.h&&["hh",it]||It<=1&&["d"]||It<M.d&&["dd",It];return M.w!=null&&(Lo=Lo||Pr<=1&&["w"]||Pr<M.w&&["ww",Pr]),Lo=Lo||rn<=1&&["M"]||rn<M.M&&["MM",rn]||fo<=1&&["y"]||["yy",fo],Lo[2]=_,Lo[3]=+p>0,Lo[4]=O,pS.apply(null,Lo)}function hS(p){return p===void 0?po:typeof p=="function"?(po=p,!0):!1}function _S(p,_){return rc[p]===void 0?!1:_===void 0?rc[p]:(rc[p]=_,p==="s"&&(rc.ss=_-1),!0)}function xS(p,_){if(!this.isValid())return this.localeData().invalidDate();var M=!1,O=rc,D,ie;return typeof p=="object"&&(_=p,p=!1),typeof p=="boolean"&&(M=p),typeof _=="object"&&(O=Object.assign({},rc,_),_.s!=null&&_.ss==null&&(O.ss=_.s-1)),D=this.localeData(),ie=fS(this,!M,O,D),M&&(ie=D.pastFuture(+this,ie)),D.postformat(ie)}var bu=Math.abs;function ac(p){return(p>0)-(p<0)||+p}function qd(){if(!this.isValid())return this.localeData().invalidDate();var p=bu(this._milliseconds)/1e3,_=bu(this._days),M=bu(this._months),O,D,ie,ye,it=this.asSeconds(),It,rn,Pr,fo;return it?(O=Ar(p/60),D=Ar(O/60),p%=60,O%=60,ie=Ar(M/12),M%=12,ye=p?p.toFixed(3).replace(/\.?0+$/,""):"",It=it<0?"-":"",rn=ac(this._months)!==ac(it)?"-":"",Pr=ac(this._days)!==ac(it)?"-":"",fo=ac(this._milliseconds)!==ac(it)?"-":"",It+"P"+(ie?rn+ie+"Y":"")+(M?rn+M+"M":"")+(_?Pr+_+"D":"")+(D||O||p?"T":"")+(D?fo+D+"H":"")+(O?fo+O+"M":"")+(p?fo+ye+"S":"")):"P0D"}var an=zd.prototype;an.isValid=mO,an.abs=Yw,an.add=Ww,an.subtract=Gw,an.as=qw,an.asMilliseconds=Gh,an.asSeconds=Xw,an.asMinutes=Kw,an.asHours=Zw,an.asDays=Qw,an.asWeeks=Jw,an.asMonths=eS,an.asQuarters=tS,an.asYears=nS,an.valueOf=iS,an._bubble=Hw,an.clone=rS,an.get=aS,an.milliseconds=oS,an.seconds=sS,an.minutes=cS,an.hours=lS,an.days=dS,an.weeks=uS,an.months=mS,an.years=gS,an.humanize=xS,an.toISOString=qd,an.toString=qd,an.toJSON=qd,an.locale=Ah,an.localeData=Fh,an.toIsoString=V("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",qd),an.lang=Dh,te("X",0,0,"unix"),te("x",0,0,"valueOf"),et("x",fs),et("X",Nd),hn("X",function(p,_,M){M._d=new Date(parseFloat(p)*1e3)}),hn("x",function(p,_,M){M._d=new Date(Qt(p))});return i.version="2.30.1",n(An),i.fn=Ue,i.min=sO,i.max=cO,i.now=lO,i.utc=x,i.unix=Nw,i.months=Vw,i.isDate=g,i.locale=Bo,i.invalid=A,i.duration=Oa,i.isMoment=k,i.weekdays=zw,i.parseZone=Lw,i.localeData=mo,i.isDuration=jd,i.monthsShort=Uw,i.weekdaysMin=$w,i.defineLocale=cu,i.updateLocale=LP,i.locales=VP,i.weekdaysShort=jw,i.normalizeUnits=ln,i.relativeTimeRounding=hS,i.relativeTimeThreshold=_S,i.calendarFormat=FO,i.prototype=Ue,i.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},i})});var lM=qh((Hf,qf)=>{"use strict";((e,i)=>{typeof define=="function"&&define.amd?define([],i):typeof qf=="object"&&typeof Hf<"u"?qf.exports=i():e.Papa=i()})(Hf,function e(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},n,t=!i.document&&!!i.postMessage,r=i.IS_PAPA_WORKER||!1,a={},o=0,l={};function m(k){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(S){var V=I(S);V.chunkSize=parseInt(V.chunkSize),S.step||S.chunk||(V.chunkSize=null),this._handle=new C(V),(this._handle.streamer=this)._config=V}).call(this,k),this.parseChunk=function(S,V){var W=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<W){let se=this._config.newline;se||(Q=this._config.quoteChar||'"',se=this._handle.guessLineEndings(S,Q)),S=[...S.split(se).slice(W)].join(se)}this.isFirstChunk&&Z(this._config.beforeFirstChunk)&&(Q=this._config.beforeFirstChunk(S))!==void 0&&(S=Q),this.isFirstChunk=!1,this._halted=!1;var W=this._partialLine+S,Q=(this._partialLine="",this._handle.parse(W,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(S=Q.meta.cursor,W=(this._finished||(this._partialLine=W.substring(S-this._baseIndex),this._baseIndex=S),Q&&Q.data&&(this._rowCount+=Q.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),r)i.postMessage({results:Q,workerId:l.WORKER_ID,finished:W});else if(Z(this._config.chunk)&&!V){if(this._config.chunk(Q,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=Q=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(Q.data),this._completeResults.errors=this._completeResults.errors.concat(Q.errors),this._completeResults.meta=Q.meta),this._completed||!W||!Z(this._config.complete)||Q&&Q.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),W||Q&&Q.meta.paused||this._nextChunk(),Q}this._halted=!0},this._sendError=function(S){Z(this._config.error)?this._config.error(S):r&&this._config.error&&i.postMessage({workerId:l.WORKER_ID,error:S,finished:!1})}}function g(k){var S;(k=k||{}).chunkSize||(k.chunkSize=l.RemoteChunkSize),m.call(this,k),this._nextChunk=t?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(V){this._input=V,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(S=new XMLHttpRequest,this._config.withCredentials&&(S.withCredentials=this._config.withCredentials),t||(S.onload=K(this._chunkLoaded,this),S.onerror=K(this._chunkError,this)),S.open(this._config.downloadRequestBody?"POST":"GET",this._input,!t),this._config.downloadRequestHeaders){var V,W=this._config.downloadRequestHeaders;for(V in W)S.setRequestHeader(V,W[V])}var Q;this._config.chunkSize&&(Q=this._start+this._config.chunkSize-1,S.setRequestHeader("Range","bytes="+this._start+"-"+Q));try{S.send(this._config.downloadRequestBody)}catch(se){this._chunkError(se.message)}t&&S.status===0&&this._chunkError()}},this._chunkLoaded=function(){S.readyState===4&&(S.status<200||400<=S.status?this._chunkError():(this._start+=this._config.chunkSize||S.responseText.length,this._finished=!this._config.chunkSize||this._start>=(V=>(V=V.getResponseHeader("Content-Range"))!==null?parseInt(V.substring(V.lastIndexOf("/")+1)):-1)(S),this.parseChunk(S.responseText)))},this._chunkError=function(V){V=S.statusText||V,this._sendError(new Error(V))}}function f(k){(k=k||{}).chunkSize||(k.chunkSize=l.LocalChunkSize),m.call(this,k);var S,V,W=typeof FileReader<"u";this.stream=function(Q){this._input=Q,V=Q.slice||Q.webkitSlice||Q.mozSlice,W?((S=new FileReader).onload=K(this._chunkLoaded,this),S.onerror=K(this._chunkError,this)):S=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var Q=this._input,se=(this._config.chunkSize&&(se=Math.min(this._start+this._config.chunkSize,this._input.size),Q=V.call(Q,this._start,se)),S.readAsText(Q,this._config.encoding));W||this._chunkLoaded({target:{result:se}})},this._chunkLoaded=function(Q){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(Q.target.result)},this._chunkError=function(){this._sendError(S.error)}}function h(k){var S;m.call(this,k=k||{}),this.stream=function(V){return S=V,this._nextChunk()},this._nextChunk=function(){var V,W;if(!this._finished)return V=this._config.chunkSize,S=V?(W=S.substring(0,V),S.substring(V)):(W=S,""),this._finished=!S,this.parseChunk(W)}}function x(k){m.call(this,k=k||{});var S=[],V=!0,W=!1;this.pause=function(){m.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){m.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(Q){this._input=Q,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){W&&S.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),S.length?this.parseChunk(S.shift()):V=!0},this._streamData=K(function(Q){try{S.push(typeof Q=="string"?Q:Q.toString(this._config.encoding)),V&&(V=!1,this._checkIsFinished(),this.parseChunk(S.shift()))}catch(se){this._streamError(se)}},this),this._streamError=K(function(Q){this._streamCleanUp(),this._sendError(Q)},this),this._streamEnd=K(function(){this._streamCleanUp(),W=!0,this._streamData("")},this),this._streamCleanUp=K(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function C(k){var S,V,W,Q,se=Math.pow(2,53),ae=-se,ke=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Ne=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Ce=this,Ve=0,Oe=0,Ze=!1,Se=!1,Fe=[],de={data:[],errors:[],meta:{}};function X(ge){return k.skipEmptyLines==="greedy"?ge.join("").trim()==="":ge.length===1&&ge[0].length===0}function te(){if(de&&W&&(ee("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),W=!1),k.skipEmptyLines&&(de.data=de.data.filter(function(ve){return!X(ve)})),J()){let ve=function(ot,H){Z(k.transformHeader)&&(ot=k.transformHeader(ot,H)),Fe.push(ot)};var Pe=ve;if(de)if(Array.isArray(de.data[0])){for(var ge=0;J()&&ge<de.data.length;ge++)de.data[ge].forEach(ve);de.data.splice(0,1)}else de.data.forEach(ve)}function Te(ve,ot){for(var H=k.header?{}:[],mt=0;mt<ve.length;mt++){var Je=mt,Ot=ve[mt],Ot=((nt,Be)=>(Ft=>(k.dynamicTypingFunction&&k.dynamicTyping[Ft]===void 0&&(k.dynamicTyping[Ft]=k.dynamicTypingFunction(Ft)),(k.dynamicTyping[Ft]||k.dynamicTyping)===!0))(nt)?Be==="true"||Be==="TRUE"||Be!=="false"&&Be!=="FALSE"&&((Ft=>{if(ke.test(Ft)&&(Ft=parseFloat(Ft),ae<Ft&&Ft<se))return 1})(Be)?parseFloat(Be):Ne.test(Be)?new Date(Be):Be===""?null:Be):Be)(Je=k.header?mt>=Fe.length?"__parsed_extra":Fe[mt]:Je,Ot=k.transform?k.transform(Ot,Je):Ot);Je==="__parsed_extra"?(H[Je]=H[Je]||[],H[Je].push(Ot)):H[Je]=Ot}return k.header&&(mt>Fe.length?ee("FieldMismatch","TooManyFields","Too many fields: expected "+Fe.length+" fields but parsed "+mt,Oe+ot):mt<Fe.length&&ee("FieldMismatch","TooFewFields","Too few fields: expected "+Fe.length+" fields but parsed "+mt,Oe+ot)),H}var Ee;de&&(k.header||k.dynamicTyping||k.transform)&&(Ee=1,!de.data.length||Array.isArray(de.data[0])?(de.data=de.data.map(Te),Ee=de.data.length):de.data=Te(de.data,0),k.header&&de.meta&&(de.meta.fields=Fe),Oe+=Ee)}function J(){return k.header&&Fe.length===0}function ee(ge,Te,Ee,Pe){ge={type:ge,code:Te,message:Ee},Pe!==void 0&&(ge.row=Pe),de.errors.push(ge)}Z(k.step)&&(Q=k.step,k.step=function(ge){de=ge,J()?te():(te(),de.data.length!==0&&(Ve+=ge.data.length,k.preview&&Ve>k.preview?V.abort():(de.data=de.data[0],Q(de,Ce))))}),this.parse=function(ge,Te,Ee){var Pe=k.quoteChar||'"',Pe=(k.newline||(k.newline=this.guessLineEndings(ge,Pe)),W=!1,k.delimiter?Z(k.delimiter)&&(k.delimiter=k.delimiter(ge),de.meta.delimiter=k.delimiter):((Pe=((ve,ot,H,mt,Je)=>{var Ot,nt,Be,Ft;Je=Je||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var ln=0;ln<Je.length;ln++){for(var In,qi=Je[ln],Un=0,Zn=0,Et=0,Sn=(Be=void 0,new b({comments:mt,delimiter:qi,newline:ot,preview:10}).parse(ve)),Qn=0;Qn<Sn.data.length;Qn++)H&&X(Sn.data[Qn])?Et++:(In=Sn.data[Qn].length,Zn+=In,Be===void 0?Be=In:0<In&&(Un+=Math.abs(In-Be),Be=In));0<Sn.data.length&&(Zn/=Sn.data.length-Et),(nt===void 0||Un<=nt)&&(Ft===void 0||Ft<Zn)&&1.99<Zn&&(nt=Un,Ot=qi,Ft=Zn)}return{successful:!!(k.delimiter=Ot),bestDelimiter:Ot}})(ge,k.newline,k.skipEmptyLines,k.comments,k.delimitersToGuess)).successful?k.delimiter=Pe.bestDelimiter:(W=!0,k.delimiter=l.DefaultDelimiter),de.meta.delimiter=k.delimiter),I(k));return k.preview&&k.header&&Pe.preview++,S=ge,V=new b(Pe),de=V.parse(S,Te,Ee),te(),Ze?{meta:{paused:!0}}:de||{meta:{paused:!1}}},this.paused=function(){return Ze},this.pause=function(){Ze=!0,V.abort(),S=Z(k.chunk)?"":S.substring(V.getCharIndex())},this.resume=function(){Ce.streamer._halted?(Ze=!1,Ce.streamer.parseChunk(S,!0)):setTimeout(Ce.resume,3)},this.aborted=function(){return Se},this.abort=function(){Se=!0,V.abort(),de.meta.aborted=!0,Z(k.complete)&&k.complete(de),S=""},this.guessLineEndings=function(ve,Pe){ve=ve.substring(0,1048576);var Pe=new RegExp(y(Pe)+"([^]*?)"+y(Pe),"gm"),Ee=(ve=ve.replace(Pe,"")).split("\r"),Pe=ve.split(`
`),ve=1<Pe.length&&Pe[0].length<Ee[0].length;if(Ee.length===1||ve)return`
`;for(var ot=0,H=0;H<Ee.length;H++)Ee[H][0]===`
`&&ot++;return ot>=Ee.length/2?`\r
`:"\r"}}function y(k){return k.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(k){var S=(k=k||{}).delimiter,V=k.newline,W=k.comments,Q=k.step,se=k.preview,ae=k.fastMode,ke=null,Ne=!1,Ce=k.quoteChar==null?'"':k.quoteChar,Ve=Ce;if(k.escapeChar!==void 0&&(Ve=k.escapeChar),(typeof S!="string"||-1<l.BAD_DELIMITERS.indexOf(S))&&(S=","),W===S)throw new Error("Comment character same as delimiter");W===!0?W="#":(typeof W!="string"||-1<l.BAD_DELIMITERS.indexOf(W))&&(W=!1),V!==`
`&&V!=="\r"&&V!==`\r
`&&(V=`
`);var Oe=0,Ze=!1;this.parse=function(Se,Fe,de){if(typeof Se!="string")throw new Error("Input must be a string");var X=Se.length,te=S.length,J=V.length,ee=W.length,ge=Z(Q),Te=[],Ee=[],Pe=[],ve=Oe=0;if(!Se)return Un();if(ae||ae!==!1&&Se.indexOf(Ce)===-1){for(var ot=Se.split(V),H=0;H<ot.length;H++){if(Pe=ot[H],Oe+=Pe.length,H!==ot.length-1)Oe+=V.length;else if(de)return Un();if(!W||Pe.substring(0,ee)!==W){if(ge){if(Te=[],Ft(Pe.split(S)),Zn(),Ze)return Un()}else Ft(Pe.split(S));if(se&&se<=H)return Te=Te.slice(0,se),Un(!0)}}return Un()}for(var mt=Se.indexOf(S,Oe),Je=Se.indexOf(V,Oe),Ot=new RegExp(y(Ve)+y(Ce),"g"),nt=Se.indexOf(Ce,Oe);;)if(Se[Oe]===Ce)for(nt=Oe,Oe++;;){if((nt=Se.indexOf(Ce,nt+1))===-1)return de||Ee.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Te.length,index:Oe}),In();if(nt===X-1)return In(Se.substring(Oe,nt).replace(Ot,Ce));if(Ce===Ve&&Se[nt+1]===Ve)nt++;else if(Ce===Ve||nt===0||Se[nt-1]!==Ve){mt!==-1&&mt<nt+1&&(mt=Se.indexOf(S,nt+1));var Be=ln((Je=Je!==-1&&Je<nt+1?Se.indexOf(V,nt+1):Je)===-1?mt:Math.min(mt,Je));if(Se.substr(nt+1+Be,te)===S){Pe.push(Se.substring(Oe,nt).replace(Ot,Ce)),Se[Oe=nt+1+Be+te]!==Ce&&(nt=Se.indexOf(Ce,Oe)),mt=Se.indexOf(S,Oe),Je=Se.indexOf(V,Oe);break}if(Be=ln(Je),Se.substring(nt+1+Be,nt+1+Be+J)===V){if(Pe.push(Se.substring(Oe,nt).replace(Ot,Ce)),qi(nt+1+Be+J),mt=Se.indexOf(S,Oe),nt=Se.indexOf(Ce,Oe),ge&&(Zn(),Ze))return Un();if(se&&Te.length>=se)return Un(!0);break}Ee.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Te.length,index:Oe}),nt++}}else if(W&&Pe.length===0&&Se.substring(Oe,Oe+ee)===W){if(Je===-1)return Un();Oe=Je+J,Je=Se.indexOf(V,Oe),mt=Se.indexOf(S,Oe)}else if(mt!==-1&&(mt<Je||Je===-1))Pe.push(Se.substring(Oe,mt)),Oe=mt+te,mt=Se.indexOf(S,Oe);else{if(Je===-1)break;if(Pe.push(Se.substring(Oe,Je)),qi(Je+J),ge&&(Zn(),Ze))return Un();if(se&&Te.length>=se)return Un(!0)}return In();function Ft(Et){Te.push(Et),ve=Oe}function ln(Et){var Sn=0;return Sn=Et!==-1&&(Et=Se.substring(nt+1,Et))&&Et.trim()===""?Et.length:Sn}function In(Et){return de||(Et===void 0&&(Et=Se.substring(Oe)),Pe.push(Et),Oe=X,Ft(Pe),ge&&Zn()),Un()}function qi(Et){Oe=Et,Ft(Pe),Pe=[],Je=Se.indexOf(V,Oe)}function Un(Et){if(k.header&&!Fe&&Te.length&&!Ne){var Sn=Te[0],Qn=Object.create(null),Er=new Set(Sn);let Rt=!1;for(let hi=0;hi<Sn.length;hi++){let Ct=Sn[hi];if(Qn[Ct=Z(k.transformHeader)?k.transformHeader(Ct,hi):Ct]){let dn,Ei=Qn[Ct];for(;dn=Ct+"_"+Ei,Ei++,Er.has(dn););Er.add(dn),Sn[hi]=dn,Qn[Ct]++,Rt=!0,(ke=ke===null?{}:ke)[dn]=Ct}else Qn[Ct]=1,Sn[hi]=Ct;Er.add(Ct)}Rt&&console.warn("Duplicate headers found and renamed."),Ne=!0}return{data:Te,errors:Ee,meta:{delimiter:S,linebreak:V,aborted:Ze,truncated:!!Et,cursor:ve+(Fe||0),renamedHeaders:ke}}}function Zn(){Q(Un()),Te=[],Ee=[]}},this.abort=function(){Ze=!0},this.getCharIndex=function(){return Oe}}function w(k){var S=k.data,V=a[S.workerId],W=!1;if(S.error)V.userError(S.error,S.file);else if(S.results&&S.results.data){var Q={abort:function(){W=!0,A(S.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:E,resume:E};if(Z(V.userStep)){for(var se=0;se<S.results.data.length&&(V.userStep({data:S.results.data[se],errors:S.results.errors,meta:S.results.meta},Q),!W);se++);delete S.results}else Z(V.userChunk)&&(V.userChunk(S.results,Q,S.file),delete S.results)}S.finished&&!W&&A(S.workerId,S.results)}function A(k,S){var V=a[k];Z(V.userComplete)&&V.userComplete(S),V.terminate(),delete a[k]}function E(){throw new Error("Not implemented.")}function I(k){if(typeof k!="object"||k===null)return k;var S,V=Array.isArray(k)?[]:{};for(S in k)V[S]=I(k[S]);return V}function K(k,S){return function(){k.apply(S,arguments)}}function Z(k){return typeof k=="function"}return l.parse=function(k,S){var V=(S=S||{}).dynamicTyping||!1;if(Z(V)&&(S.dynamicTypingFunction=V,V={}),S.dynamicTyping=V,S.transform=!!Z(S.transform)&&S.transform,!S.worker||!l.WORKERS_SUPPORTED)return V=null,l.NODE_STREAM_INPUT,typeof k=="string"?(k=(W=>W.charCodeAt(0)!==65279?W:W.slice(1))(k),V=new(S.download?g:h)(S)):k.readable===!0&&Z(k.read)&&Z(k.on)?V=new x(S):(i.File&&k instanceof File||k instanceof Object)&&(V=new f(S)),V.stream(k);(V=(()=>{var W;return!!l.WORKERS_SUPPORTED&&(W=(()=>{var Q=i.URL||i.webkitURL||null,se=e.toString();return l.BLOB_URL||(l.BLOB_URL=Q.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",se,")();"],{type:"text/javascript"})))})(),(W=new i.Worker(W)).onmessage=w,W.id=o++,a[W.id]=W)})()).userStep=S.step,V.userChunk=S.chunk,V.userComplete=S.complete,V.userError=S.error,S.step=Z(S.step),S.chunk=Z(S.chunk),S.complete=Z(S.complete),S.error=Z(S.error),delete S.worker,V.postMessage({input:k,config:S,workerId:V.id})},l.unparse=function(k,S){var V=!1,W=!0,Q=",",se=`\r
`,ae='"',ke=ae+ae,Ne=!1,Ce=null,Ve=!1,Oe=((()=>{if(typeof S=="object"){if(typeof S.delimiter!="string"||l.BAD_DELIMITERS.filter(function(Fe){return S.delimiter.indexOf(Fe)!==-1}).length||(Q=S.delimiter),typeof S.quotes!="boolean"&&typeof S.quotes!="function"&&!Array.isArray(S.quotes)||(V=S.quotes),typeof S.skipEmptyLines!="boolean"&&typeof S.skipEmptyLines!="string"||(Ne=S.skipEmptyLines),typeof S.newline=="string"&&(se=S.newline),typeof S.quoteChar=="string"&&(ae=S.quoteChar),typeof S.header=="boolean"&&(W=S.header),Array.isArray(S.columns)){if(S.columns.length===0)throw new Error("Option columns is empty");Ce=S.columns}S.escapeChar!==void 0&&(ke=S.escapeChar+ae),S.escapeFormulae instanceof RegExp?Ve=S.escapeFormulae:typeof S.escapeFormulae=="boolean"&&S.escapeFormulae&&(Ve=/^[=+\-@\t\r].*$/)}})(),new RegExp(y(ae),"g"));if(typeof k=="string"&&(k=JSON.parse(k)),Array.isArray(k)){if(!k.length||Array.isArray(k[0]))return Ze(null,k,Ne);if(typeof k[0]=="object")return Ze(Ce||Object.keys(k[0]),k,Ne)}else if(typeof k=="object")return typeof k.data=="string"&&(k.data=JSON.parse(k.data)),Array.isArray(k.data)&&(k.fields||(k.fields=k.meta&&k.meta.fields||Ce),k.fields||(k.fields=Array.isArray(k.data[0])?k.fields:typeof k.data[0]=="object"?Object.keys(k.data[0]):[]),Array.isArray(k.data[0])||typeof k.data[0]=="object"||(k.data=[k.data])),Ze(k.fields||[],k.data||[],Ne);throw new Error("Unable to serialize unrecognized input");function Ze(Fe,de,X){var te="",J=(typeof Fe=="string"&&(Fe=JSON.parse(Fe)),typeof de=="string"&&(de=JSON.parse(de)),Array.isArray(Fe)&&0<Fe.length),ee=!Array.isArray(de[0]);if(J&&W){for(var ge=0;ge<Fe.length;ge++)0<ge&&(te+=Q),te+=Se(Fe[ge],ge);0<de.length&&(te+=se)}for(var Te=0;Te<de.length;Te++){var Ee=(J?Fe:de[Te]).length,Pe=!1,ve=J?Object.keys(de[Te]).length===0:de[Te].length===0;if(X&&!J&&(Pe=X==="greedy"?de[Te].join("").trim()==="":de[Te].length===1&&de[Te][0].length===0),X==="greedy"&&J){for(var ot=[],H=0;H<Ee;H++){var mt=ee?Fe[H]:H;ot.push(de[Te][mt])}Pe=ot.join("").trim()===""}if(!Pe){for(var Je=0;Je<Ee;Je++){0<Je&&!ve&&(te+=Q);var Ot=J&&ee?Fe[Je]:Je;te+=Se(de[Te][Ot],Je)}Te<de.length-1&&(!X||0<Ee&&!ve)&&(te+=se)}}return te}function Se(Fe,de){var X,te;return Fe==null?"":Fe.constructor===Date?JSON.stringify(Fe).slice(1,25):(te=!1,Ve&&typeof Fe=="string"&&Ve.test(Fe)&&(Fe="'"+Fe,te=!0),X=Fe.toString().replace(Oe,ke),(te=te||V===!0||typeof V=="function"&&V(Fe,de)||Array.isArray(V)&&V[de]||((J,ee)=>{for(var ge=0;ge<ee.length;ge++)if(-1<J.indexOf(ee[ge]))return!0;return!1})(X,l.BAD_DELIMITERS)||-1<X.indexOf(Q)||X.charAt(0)===" "||X.charAt(X.length-1)===" ")?ae+X+ae:X)}},l.RECORD_SEP="",l.UNIT_SEP="",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!t&&!!i.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=b,l.ParserHandle=C,l.NetworkStreamer=g,l.FileStreamer=f,l.StringStreamer=h,l.ReadableStreamStreamer=x,i.jQuery&&((n=i.jQuery).fn.parse=function(k){var S=k.config||{},V=[];return this.each(function(se){if(!(n(this).prop("tagName").toUpperCase()==="INPUT"&&n(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var ae=0;ae<this.files.length;ae++)V.push({file:this.files[ae],inputElem:this,instanceConfig:n.extend({},S)})}),W(),this;function W(){if(V.length===0)Z(k.complete)&&k.complete();else{var se,ae,ke,Ne,Ce=V[0];if(Z(k.before)){var Ve=k.before(Ce.file,Ce.inputElem);if(typeof Ve=="object"){if(Ve.action==="abort")return se="AbortError",ae=Ce.file,ke=Ce.inputElem,Ne=Ve.reason,void(Z(k.error)&&k.error({name:se},ae,ke,Ne));if(Ve.action==="skip")return void Q();typeof Ve.config=="object"&&(Ce.instanceConfig=n.extend(Ce.instanceConfig,Ve.config))}else if(Ve==="skip")return void Q()}var Oe=Ce.instanceConfig.complete;Ce.instanceConfig.complete=function(Ze){Z(Oe)&&Oe(Ze,Ce.file,Ce.inputElem),Q()},l.parse(Ce.file,Ce.instanceConfig)}}function Q(){V.splice(0,1),W()}}),r&&(i.onmessage=function(k){k=k.data,l.WORKER_ID===void 0&&k&&(l.WORKER_ID=k.workerId),typeof k.input=="string"?i.postMessage({workerId:l.WORKER_ID,results:l.parse(k.input,k.config),finished:!0}):(i.File&&k.input instanceof File||k.input instanceof Object)&&(k=l.parse(k.input,k.config))&&i.postMessage({workerId:l.WORKER_ID,results:k,finished:!0})}),(g.prototype=Object.create(m.prototype)).constructor=g,(f.prototype=Object.create(m.prototype)).constructor=f,(h.prototype=Object.create(h.prototype)).constructor=h,(x.prototype=Object.create(m.prototype)).constructor=x,l})});var Ha=St("[Budgets] Load Budgets",Tt()),pm=St("[Budgets] Load Budgets Success",Tt()),fm=St("[Budgets] Load Budgets Failure",Tt()),ys=St("[Budgets] Create Budget",Tt()),hm=St("[Budgets] Create Budget Success",Tt()),_m=St("[Budgets] Create Budget Failure",Tt()),Bc=St("[Budgets] Update Budget",Tt()),xm=St("[Budgets] Update Budget Success",Tt()),Cm=St("[Budgets] Update Budget Failure",Tt()),Nc=St("[Budgets] Delete Budget",Tt()),vm=St("[Budgets] Delete Budget Success",Tt()),bm=St("[Budgets] Delete Budget Failure",Tt()),Lc=St("[Budgets] Update Spent",Tt()),ym=St("[Budgets] Update Spent Success",Tt()),Mm=St("[Budgets] Update Spent Failure",Tt());var qa=St("[Goals] Load Goals",Tt()),Pm=St("[Goals] Load Goals Success",Tt()),Om=St("[Goals] Load Goals Failure",Tt()),Vc=St("[Goals] Create Goal",Tt()),wm=St("[Goals] Create Goal Success",Tt()),Sm=St("[Goals] Create Goal Failure",Tt()),km=St("[Goals] Update Goal",Tt()),Tm=St("[Goals] Update Goal Success",Tt()),Em=St("[Goals] Update Goal Failure",Tt()),Uc=St("[Goals] Delete Goal",Tt()),Im=St("[Goals] Delete Goal Success",Tt()),Am=St("[Goals] Delete Goal Failure",Tt()),zc=St("[Goals] Update Current Amount",Tt()),Dm=St("[Goals] Update Current Amount Success",Tt()),Fm=St("[Goals] Update Current Amount Failure",Tt());var Xa=St("[Profile] Load Profile",Tt()),Rm=St("[Profile] Load Profile Success",Tt()),Bm=St("[Profile] Load Profile Failure",Tt()),jc=St("[Profile] Update Profile",Tt()),Nm=St("[Profile] Update Profile Success",Tt()),Lm=St("[Profile] Update Profile Failure",Tt()),Vm=St("[Profile] Create Profile",Tt()),Um=St("[Profile] Create Profile Success",Tt()),zm=St("[Profile] Create Profile Failure",Tt()),jm=St("[Profile] Delete Profile",Tt()),$m=St("[Profile] Delete Profile Success"),Ym=St("[Profile] Delete Profile Failure",Tt()),yo=St("[Profile] Update Preferences",Tt()),Wm=St("[Profile] Update Preferences Success",Tt()),Gm=St("[Profile] Update Preferences Failure",Tt());var Rn=function(e){return e.LOGIN_ATTEMPT="LOGIN_ATTEMPT",e.LOGIN_SUCCESS="LOGIN_SUCCESS",e.LOGIN_FAILED="LOGIN_FAILED",e.LOGOUT="LOGOUT",e.PASSWORD_CHANGE="PASSWORD_CHANGE",e.PASSWORD_RESET="PASSWORD_RESET",e.SUSPICIOUS_ACTIVITY="SUSPICIOUS_ACTIVITY",e.RATE_LIMIT_EXCEEDED="RATE_LIMIT_EXCEEDED",e.UNAUTHORIZED_ACCESS="UNAUTHORIZED_ACCESS",e.SESSION_EXPIRED="SESSION_EXPIRED",e.ACCOUNT_LOCKED="ACCOUNT_LOCKED",e.ACCOUNT_UNLOCKED="ACCOUNT_UNLOCKED",e.FORCE_LOGOUT="FORCE_LOGOUT",e.SECURITY_ALERT="SECURITY_ALERT",e}(Rn||{}),Bn=function(e){return e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.CRITICAL="critical",e}(Bn||{}),Kx=(()=>{let i=class i{constructor(t,r,a){this.router=t,this.userService=r,this.notificationService=a,this.securityEvents=new on([]),this.securityStatus=new on(null),this.securityConfig={SESSION_TIMEOUT:30*60*1e3,MAX_LOGIN_ATTEMPTS:5,LOCKOUT_DURATION:15*60*1e3,PASSWORD_MIN_LENGTH:8,REQUIRE_EMAIL_VERIFICATION:!0,ENABLE_TWO_FACTOR:!1,ENABLE_RATE_LIMITING:!0,ENABLE_AUDIT_LOGGING:!0,ENABLE_SECURITY_HEADERS:!0,ALLOWED_ORIGINS:["localhost","127.0.0.1","yourdomain.com"],BLOCKED_IPS:[]},this.securityEvents$=this.securityEvents.asObservable(),this.securityStatus$=this.securityStatus.asObservable(),this.initializeSecurityMonitoring()}initializeSecurityMonitoring(){this.userService.userAuth$.subscribe(t=>{this.updateSecurityStatus()}),setInterval(()=>{},6e4),this.monitorSuspiciousActivity()}logSecurityEvent(t,r,a={},o){let l={id:this.generateEventId(),type:t,level:r,userId:o,timestamp:new Date,details:a,userAgent:navigator.userAgent,ipAddress:this.getClientIP(),location:window.location.href,resolved:!1},m=this.securityEvents.value;m.push(l),m.length>1e3&&m.shift(),this.securityEvents.next(m),r===Bn.CRITICAL&&this.handleCriticalSecurityEvent(l),console.log("Security Event:",l)}handleCriticalSecurityEvent(t){switch(t.type){case Rn.SUSPICIOUS_ACTIVITY:this.notificationService.error("Suspicious activity detected. Please review your account.");break;case Rn.UNAUTHORIZED_ACCESS:this.forceLogout("Unauthorized access detected");break;case Rn.ACCOUNT_LOCKED:this.notificationService.warning("Account locked due to multiple failed login attempts.");break;case Rn.SECURITY_ALERT:this.notificationService.error("Security alert: Please review your account immediately.");break}}updateSecurityStatus(){let t=this.userService.userAuth$.value,r=this.userService.getSecurityStatus(),a={isAuthenticated:!!t,sessionActive:(r==null?void 0:r.sessionActive)||!1,sessionAge:(r==null?void 0:r.sessionAge)||0,loginAttempts:(r==null?void 0:r.loginAttempts)||0,isAccountLocked:(r==null?void 0:r.isLocked)||!1,isEmailVerified:(r==null?void 0:r.isEmailVerified)||!1,twoFactorEnabled:!1,lastLoginTime:r!=null&&r.lastLogin?new Date(r.lastLogin):void 0,securityLevel:this.calculateSecurityLevel(r),recentSecurityEvents:this.getRecentSecurityEvents()};this.securityStatus.next(a)}calculateSecurityLevel(t){if(!t)return Bn.LOW;let r=0;return t.isEmailVerified&&(r+=2),t.isLocked||(r+=1),t.loginAttempts<2&&(r+=1),t.sessionActive&&(r+=1),r>=4?Bn.HIGH:r>=2?Bn.MEDIUM:Bn.LOW}getRecentSecurityEvents(){let t=this.securityEvents.value,r=new Date(Date.now()-60*60*1e3);return t.filter(a=>a.timestamp>r)}performSecurityChecks(){let t=this.userService.userAuth$.value;if(!t)return;let r=this.userService.getSecurityStatus();r&&!r.sessionActive&&(this.logSecurityEvent(Rn.SESSION_EXPIRED,Bn.HIGH,{userId:t.uid},t.uid),this.forceLogout("Session expired")),this.detectSuspiciousActivityPatterns()}detectSuspiciousActivityPatterns(){let t=this.getRecentSecurityEvents(),r=this.userService.userAuth$.value;if(!r)return;let a=t.filter(l=>l.type===Rn.LOGIN_FAILED&&l.userId===r.uid);a.length>=3&&this.logSecurityEvent(Rn.SUSPICIOUS_ACTIVITY,Bn.HIGH,{reason:"multiple_failed_logins",count:a.length},r.uid);let o=t.filter(l=>l.timestamp>new Date(Date.now()-5*60*1e3));o.length>10&&this.logSecurityEvent(Rn.SUSPICIOUS_ACTIVITY,Bn.MEDIUM,{reason:"rapid_activity",count:o.length})}monitorSuspiciousActivity(){let t=0,r=Date.now();this.router.events.subscribe(()=>{let a=Date.now();a-r<1e3?(t++,t>10&&this.logSecurityEvent(Rn.SUSPICIOUS_ACTIVITY,Bn.MEDIUM,{reason:"rapid_navigation",count:t})):t=0,r=a})}forceLogout(t){this.logSecurityEvent(Rn.FORCE_LOGOUT,Bn.CRITICAL,{reason:t}),this.userService.forceLogout(t)}validateSecurityConfig(){let t=[];return this.securityConfig.PASSWORD_MIN_LENGTH<8&&t.push("Password minimum length should be at least 8 characters"),this.securityConfig.SESSION_TIMEOUT<5*60*1e3&&t.push("Session timeout should be at least 5 minutes"),this.securityConfig.MAX_LOGIN_ATTEMPTS<3&&t.push("Maximum login attempts should be at least 3"),t.length>0?(console.warn("Security configuration issues:",t),!1):!0}getSecurityConfig(){return oe({},this.securityConfig)}updateSecurityConfig(t){Object.assign(this.securityConfig,t),this.logSecurityEvent(Rn.SECURITY_ALERT,Bn.MEDIUM,{reason:"config_updated",updates:t})}getSecurityEventsByType(t){return this.securityEvents.value.filter(r=>r.type===t)}getSecurityEventsByLevel(t){return this.securityEvents.value.filter(r=>r.level===t)}resolveSecurityEvent(t){let r=this.securityEvents.value,a=r.findIndex(o=>o.id===t);a!==-1&&(r[a].resolved=!0,this.securityEvents.next(r))}clearResolvedEvents(){let t=this.securityEvents.value.filter(r=>!r.resolved);this.securityEvents.next(t)}generateEventId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}getClientIP(){return"client-side"}isOriginAllowed(t){return this.securityConfig.ALLOWED_ORIGINS.some(r=>t.includes(r))}isIPBlocked(t){return this.securityConfig.BLOCKED_IPS.includes(t)}blockIP(t,r){this.securityConfig.BLOCKED_IPS.includes(t)||(this.securityConfig.BLOCKED_IPS.push(t),this.logSecurityEvent(Rn.SECURITY_ALERT,Bn.HIGH,{reason:r,ip:t}))}unblockIP(t){let r=this.securityConfig.BLOCKED_IPS.indexOf(t);r!==-1&&(this.securityConfig.BLOCKED_IPS.splice(r,1),this.logSecurityEvent(Rn.SECURITY_ALERT,Bn.MEDIUM,{reason:"ip_unblocked",ip:t}))}};i.\u0275fac=function(r){return new(r||i)(De(nn),De(ni),De(ft))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var bS=(e,i,n,t)=>({"bg-red-500":e,"bg-yellow-500":i,"bg-blue-500":n,"bg-green-500":t});function yS(e,i){if(e&1&&(s(0,"p",41),d(1),c()),e&2){let n=v(2);u(),ne(" Time remaining: ",n.getLockoutTimeRemaining()," minutes ")}}function MS(e,i){if(e&1&&(s(0,"div",36)(1,"div",37),Ii(),s(2,"svg",38),re(3,"path",39),c(),na(),s(4,"span",40),d(5,"Account Temporarily Locked"),c()(),s(6,"p",41),d(7,"Too many failed login attempts. Please try again later."),c(),N(8,yS,2,1,"p",42),c()),e&2){let n=v();u(8),P("ngIf",n.lockoutTimeRemaining>0)}}function PS(e,i){if(e&1&&(s(0,"div",43)(1,"div",37),Ii(),s(2,"svg",38),re(3,"path",44),c(),na(),s(4,"span",40),d(5,"Login Attempts"),c()(),s(6,"p",41),d(7),c()()),e&2){let n=v();u(7),$t(" Failed attempts: ",n.loginAttempts," / ",n.maxLoginAttempts," ")}}function OS(e,i){e&1&&(s(0,"span"),d(1),ce(2,"translate"),c()),e&2&&(u(),L(xe(2,1,"emailRequired")))}function wS(e,i){e&1&&(s(0,"span"),d(1,"Please enter a valid email address"),c())}function SS(e,i){e&1&&(s(0,"span"),d(1,"Disposable email addresses are not allowed"),c())}function kS(e,i){if(e&1&&(s(0,"div",45),N(1,OS,3,3,"span",15)(2,wS,2,0,"span",15)(3,SS,2,0,"span",15),c()),e&2){let n,t,r,a=v();u(),P("ngIf",(n=a.signInForm.get("email"))==null||n.errors==null?null:n.errors.required),u(),P("ngIf",(t=a.signInForm.get("email"))==null||t.errors==null?null:t.errors.email),u(),P("ngIf",(r=a.signInForm.get("email"))==null||r.errors==null?null:r.errors.disposableEmail)}}function TS(e,i){e&1&&(s(0,"span"),d(1,"Full name is required"),c())}function ES(e,i){e&1&&(s(0,"span"),d(1,"Name must be at least 2 characters long"),c())}function IS(e,i){if(e&1&&(s(0,"div",45),N(1,TS,2,0,"span",15)(2,ES,2,0,"span",15),c()),e&2){let n,t,r=v(2);u(),P("ngIf",(n=r.signInForm.get("name"))==null||n.errors==null?null:n.errors.required),u(),P("ngIf",(t=r.signInForm.get("name"))==null||t.errors==null?null:t.errors.minLength)}}function AS(e,i){if(e&1&&(s(0,"div")(1,"label",46),d(2,"Full Name"),c(),re(3,"input",47),N(4,IS,3,2,"div",14),c()),e&2){let n,t=v();u(3),Wr("data-security-level",t.securityLevel),u(),P("ngIf",((n=t.signInForm.get("name"))==null?null:n.invalid)&&((n=t.signInForm.get("name"))==null?null:n.touched))}}function DS(e,i){e&1&&(s(0,"a",48),d(1,"Forget Password?"),c())}function FS(e,i){e&1&&(Ii(),s(0,"svg",49),re(1,"path",50)(2,"path",51),c())}function RS(e,i){e&1&&(Ii(),s(0,"svg",49),re(1,"path",52),c())}function BS(e,i){e&1&&(s(0,"span"),d(1,"Password must be at least 8 characters with uppercase, lowercase, number, and special character"),c())}function NS(e,i){if(e&1&&(s(0,"div",53)(1,"div",54)(2,"span"),d(3,"Password strength:"),c(),s(4,"span"),d(5),c()(),s(6,"div",55),re(7,"div",56),c(),s(8,"div",57),N(9,BS,2,0,"span",15),c()()),e&2){let n=v();u(4),jt(n.getPasswordStrengthColor()),u(),L(n.getPasswordStrengthText()),u(2),wt("width",n.passwordStrength/4*100,"%"),P("ngClass",P1(7,bS,n.passwordStrength<=1,n.passwordStrength===2,n.passwordStrength===3,n.passwordStrength>=4)),u(2),P("ngIf",n.passwordStrength<3)}}function LS(e,i){e&1&&(s(0,"span"),d(1),ce(2,"translate"),c()),e&2&&(u(),L(xe(2,1,"passwordRequired")))}function VS(e,i){e&1&&(s(0,"span"),d(1,"Password must be at least 8 characters long"),c())}function US(e,i){e&1&&(s(0,"span"),d(1,"Password must contain uppercase, lowercase, number, and special character"),c())}function zS(e,i){if(e&1&&(s(0,"div",45),N(1,LS,3,3,"span",15)(2,VS,2,0,"span",15)(3,US,2,0,"span",15),c()),e&2){let n,t,r,a=v();u(),P("ngIf",(n=a.signInForm.get("password"))==null||n.errors==null?null:n.errors.required),u(),P("ngIf",(t=a.signInForm.get("password"))==null||t.errors==null?null:t.errors.minLength),u(),P("ngIf",(r=a.signInForm.get("password"))==null||r.errors==null?null:r.errors.passwordStrength)}}function jS(e,i){e&1&&(Ii(),s(0,"svg",49),re(1,"path",50)(2,"path",51),c())}function $S(e,i){e&1&&(Ii(),s(0,"svg",49),re(1,"path",52),c())}function YS(e,i){e&1&&(s(0,"span"),d(1),ce(2,"translate"),c()),e&2&&(u(),ne("",xe(2,1,"confirmPassword")," is required"))}function WS(e,i){e&1&&(s(0,"span"),d(1,"Passwords do not match"),c())}function GS(e,i){if(e&1&&(s(0,"div",45),N(1,YS,3,3,"span",15)(2,WS,2,0,"span",15),c()),e&2){let n,t,r=v(2);u(),P("ngIf",(n=r.signInForm.get("confirmPassword"))==null||n.errors==null?null:n.errors.required),u(),P("ngIf",(t=r.signInForm.get("confirmPassword"))==null||t.errors==null?null:t.errors.notMatch)}}function HS(e,i){if(e&1){let n=ue();s(0,"div")(1,"label",58),d(2),ce(3,"translate"),c(),s(4,"div",19),re(5,"input",59),s(6,"button",21),F("click",function(){R(n);let r=v();return B(r.toggleConfirmPasswordVisibility())}),N(7,jS,3,0,"svg",22)(8,$S,2,0,"svg",22),c()(),N(9,GS,3,2,"div",14),c()}if(e&2){let n,t=v();u(2),L(xe(3,6,"confirmPassword")),u(3),P("type",t.showConfirmPassword?"text":"password"),Wr("data-security-level",t.securityLevel),u(2),P("ngIf",!t.showConfirmPassword),u(),P("ngIf",t.showConfirmPassword),u(),P("ngIf",((n=t.signInForm.get("confirmPassword"))==null?null:n.invalid)&&((n=t.signInForm.get("confirmPassword"))==null?null:n.touched))}}function qS(e,i){e&1&&re(0,"mat-spinner",60)}function XS(e,i){if(e&1&&(s(0,"span"),d(1),ce(2,"translate"),ce(3,"translate"),c()),e&2){let n=v();u(),L(n.isSignInPage?xe(2,1,"signIn"):xe(3,3,"signUp"))}}function KS(e,i){if(e&1&&(s(0,"span"),d(1),c()),e&2){let n=v();u(),L(n.isSignInPage?"Signing in...":"Creating account...")}}function ZS(e,i){e&1&&(Ii(),s(0,"svg",61),re(1,"path",62)(2,"path",63)(3,"path",64)(4,"path",65),c())}function QS(e,i){e&1&&re(0,"mat-spinner",66)}function JS(e,i){e&1&&(s(0,"div",67)(1,"div",37),Ii(),s(2,"svg",68),re(3,"path",69)(4,"path",70),c(),na(),s(5,"span",71),d(6,"Security"),c()(),s(7,"p",72),d(8," Enterprise-grade encryption and secure authentication protect your data. "),c()())}var Vu=(()=>{let i=class i{constructor(t,r,a,o,l,m,g,f){this.fb=t,this.router=r,this.route=a,this.userService=o,this.notificationService=l,this.securityService=m,this.validationService=g,this.store=f,this.isSignInPage=!0,this.isLoading=!1,this.isAccountLocked=!1,this.lockoutTimeRemaining=0,this.loginAttempts=0,this.maxLoginAttempts=5,this.showPassword=!1,this.showConfirmPassword=!1,this.passwordStrength=0,this.securityLevel="moderate",this.showSecurityNotice=!1,this.destroy$=new Bt,this.loginAttemptCount=0,this.lastLoginAttempt=0,this.rateLimitWindow=6e4,this.maxAttemptsPerWindow=3,this.initializeForm(),this._setIsSignInPage(this.router.url.includes("/sign-in")),this.checkQueryParams()}ngOnInit(){this.setupFormValidation(),this.checkSecurityStatus(),this.startSecurityMonitoring(),setTimeout(()=>{this.showSecurityNotice=!0},100)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeForm(){this.signInForm=this.fb.group({email:["",[...this.validationService.getProfileEmailValidators(),this.emailDomainValidator.bind(this)]],password:["",[...this.validationService.getAuthPasswordValidators(),this.passwordStrengthValidator.bind(this)]]})}setupFormValidation(){var t,r;(t=this.signInForm.get("password"))==null||t.valueChanges.pipe(yt(this.destroy$),El(300),cc()).subscribe(a=>{this.passwordStrength=this.calculatePasswordStrength(a)}),(r=this.signInForm.get("email"))==null||r.valueChanges.pipe(yt(this.destroy$),El(500),cc()).subscribe(a=>{this.monitorEmailInput(a)})}checkQueryParams(){this.route.queryParams.subscribe(t=>{t.error&&this.handleSecurityError(t.error,t.message),t.session==="expired"&&this.notificationService.warning("Your session has expired. Please sign in again."),t.cacheUpdate==="true"&&this.notificationService.info("Application updated. Please sign in again.")})}checkSecurityStatus(){let t=this.userService.getSecurityStatus();t&&(this.isAccountLocked=t.isLocked,this.loginAttempts=t.loginAttempts,this.maxLoginAttempts=t.remainingAttempts+t.loginAttempts,this.isAccountLocked&&this.calculateLockoutTime())}startSecurityMonitoring(){setInterval(()=>{this.checkSecurityStatus()},1e4)}onSignIn(){return me(this,null,function*(){var a,o;if(!this.signInForm.valid){this.notificationService.error("Please fill all required fields correctly"),this.markFormGroupTouched();return}if(this.isRateLimited()){this.notificationService.error("Too many login attempts. Please wait before trying again.");return}if(this.isAccountLocked){this.notificationService.error(`Account is temporarily locked. Please try again in ${Math.ceil(this.lockoutTimeRemaining/6e4)} minutes.`);return}let t=(a=this.signInForm.get("email"))==null?void 0:a.value,r=(o=this.signInForm.get("password"))==null?void 0:o.value;this.securityService.logSecurityEvent(Rn.LOGIN_ATTEMPT,Bn.MEDIUM,{email:t,timestamp:new Date().toISOString()});try{this.isLoading=!0,this.loginAttemptCount++,this.lastLoginAttempt=Date.now(),yield this.userService.signIn(t,r),this.securityService.logSecurityEvent(Rn.LOGIN_SUCCESS,Bn.LOW,{email:t,timestamp:new Date().toISOString()}),this.notificationService.success("Successfully signed in!"),yield this.loadUserData(),this.router.navigate(["/dashboard"])}catch(l){this.handleSignInError(l,t)}finally{this.isLoading=!1}})}onSignUp(){return me(this,null,function*(){var o,l,m,g,f,h;if(!this.signInForm.valid){this.notificationService.error("Please fill all required fields correctly"),this.markFormGroupTouched();return}if(this.passwordStrength<3){this.notificationService.error("Password is too weak. Please choose a stronger password.");return}if(((o=this.signInForm.get("password"))==null?void 0:o.value)!==((l=this.signInForm.get("confirmPassword"))==null?void 0:l.value)){this.notificationService.error("Passwords do not match"),(m=this.signInForm.get("confirmPassword"))==null||m.setErrors({notMatch:!0});return}let t=(g=this.signInForm.get("email"))==null?void 0:g.value,r=(f=this.signInForm.get("password"))==null?void 0:f.value,a=((h=this.signInForm.get("name"))==null?void 0:h.value)||"User";this.securityService.logSecurityEvent(Rn.SECURITY_ALERT,Bn.MEDIUM,{type:"registration_attempt",email:t,timestamp:new Date().toISOString()});try{this.isLoading=!0,yield this.userService.signUp(t,r,a),this.securityService.logSecurityEvent(Rn.SECURITY_ALERT,Bn.LOW,{type:"registration_success",email:t,timestamp:new Date().toISOString()}),this.notificationService.success("Account created successfully! Please check your email for verification."),this._setIsSignInPage(!0)}catch(x){this.handleSignUpError(x,t)}finally{this.isLoading=!1}})}signInWithGoogle(){return me(this,null,function*(){if(this.isRateLimited()){this.notificationService.error("Too many sign-in attempts. Please wait before trying again.");return}try{this.isLoading=!0,this.securityService.logSecurityEvent(Rn.LOGIN_ATTEMPT,Bn.MEDIUM,{method:"google",timestamp:new Date().toISOString()}),yield this.userService.signInWithGoogle(),this.securityService.logSecurityEvent(Rn.LOGIN_SUCCESS,Bn.LOW,{method:"google",timestamp:new Date().toISOString()}),this.notificationService.success("Successfully signed in with Google!"),yield this.loadUserData(),this.router.navigate(["/dashboard"])}catch(t){this.handleGoogleSignInError(t)}finally{this.isLoading=!1}})}loadUserData(){return me(this,null,function*(){try{let t=this.userService.userAuth$.value;if(!(t!=null&&t.uid)){console.warn("No user ID available for loading data");return}yield Promise.all([this.store.dispatch(li({userId:t.uid})),this.store.dispatch(Xi({userId:t.uid})),this.store.dispatch(Fr({userId:t.uid})),this.store.dispatch(Ha({userId:t.uid})),this.store.dispatch(qa({userId:t.uid})),this.store.dispatch(Xa({userId:t.uid}))])}catch(t){console.error("Error loading user data:",t)}})}handleSignInError(t,r){switch(console.error("Sign-in error:",t),this.securityService.logSecurityEvent(Rn.LOGIN_FAILED,Bn.HIGH,{email:r,error:t.message||"Unknown error",timestamp:new Date().toISOString()}),t.code){case"auth/user-not-found":this.notificationService.error("No account found with this email address.");break;case"auth/wrong-password":this.notificationService.error("Incorrect password. Please try again.");break;case"auth/too-many-requests":this.notificationService.error("Too many failed attempts. Please try again later."),this.isAccountLocked=!0;break;case"auth/user-disabled":this.notificationService.error("This account has been disabled. Please contact support.");break;case"auth/invalid-email":this.notificationService.error("Invalid email address format.");break;default:this.notificationService.error(t.message||"Sign-in failed. Please try again.")}}handleSignUpError(t,r){switch(console.error("Sign-up error:",t),this.securityService.logSecurityEvent(Rn.SECURITY_ALERT,Bn.HIGH,{type:"registration_failed",email:r,error:t.message||"Unknown error",timestamp:new Date().toISOString()}),t.code){case"auth/email-already-in-use":this.notificationService.error("An account with this email already exists.");break;case"auth/weak-password":this.notificationService.error("Password is too weak. Please choose a stronger password.");break;case"auth/invalid-email":this.notificationService.error("Invalid email address format.");break;default:this.notificationService.error(t.message||"Registration failed. Please try again.")}}handleGoogleSignInError(t){console.error("Google sign-in error:",t),this.securityService.logSecurityEvent(Rn.LOGIN_FAILED,Bn.MEDIUM,{method:"google",error:t.message||"Unknown error",timestamp:new Date().toISOString()}),t.code==="auth/popup-closed-by-user"?this.notificationService.error("Sign-in was cancelled. Please try again."):t.code==="auth/popup-blocked"?this.notificationService.error("Popup was blocked. Please allow popups for this site and try again."):t.code==="auth/cancelled-popup-request"?this.notificationService.error("Sign-in request was cancelled. Please try again."):this.notificationService.error("Google sign-in failed. Please try again or use email sign-in.")}handleSecurityError(t,r){switch(t){case"unauthorized":this.notificationService.error("Session expired. Please sign in again.");break;case"insufficient_permissions":this.notificationService.error("You do not have permission to access that page.");break;case"security_error":this.notificationService.error(r||"A security error occurred.");break;case"auth_failed":this.notificationService.error("Authentication failed. Please try again.");break;default:this.notificationService.error("An error occurred. Please try again.")}}isRateLimited(){let r=Date.now()-this.lastLoginAttempt;return r<this.rateLimitWindow&&this.loginAttemptCount>=this.maxAttemptsPerWindow?!0:(r>=this.rateLimitWindow&&(this.loginAttemptCount=0),!1)}calculateLockoutTime(){let t=this.userService.getSecurityStatus();if(t&&t.lockoutTime){let r=Date.now();this.lockoutTimeRemaining=Math.max(0,t.lockoutTime-r)}}calculatePasswordStrength(t){if(!t)return 0;let r=0;return t.length>=8&&r++,/[a-z]/.test(t)&&r++,/[A-Z]/.test(t)&&r++,/[0-9]/.test(t)&&r++,/[^A-Za-z0-9]/.test(t)&&r++,Math.min(r,4)}monitorEmailInput(t){if(!t)return;[/test/i,/admin/i,/root/i,/temp/i,/fake/i].some(a=>a.test(t))&&this.securityService.logSecurityEvent(Rn.SUSPICIOUS_ACTIVITY,Bn.MEDIUM,{type:"suspicious_email",email:t,timestamp:new Date().toISOString()})}emailDomainValidator(t){if(!t.value)return null;let r=t.value.toLowerCase(),a=["tempmail.org","10minutemail.com","guerrillamail.com","mailinator.com","throwaway.email","temp-mail.org"],o=r.split("@")[1];return a.includes(o)?{disposableEmail:!0}:null}passwordStrengthValidator(t){if(!t.value)return null;let r=t.value,a=8,o=/[A-Z]/.test(r),l=/[a-z]/.test(r),m=/\d/.test(r),g=/[!@#$%^&*(),.?":{}|<>]/.test(r);return r.length<a?{minLength:{requiredLength:a,actualLength:r.length}}:!o||!l||!m||!g?{passwordStrength:!0}:null}markFormGroupTouched(){Object.keys(this.signInForm.controls).forEach(t=>{let r=this.signInForm.get(t);r==null||r.markAsTouched()})}togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}getPasswordStrengthText(){switch(this.passwordStrength){case 0:return"Very Weak";case 1:return"Weak";case 2:return"Fair";case 3:return"Good";case 4:return"Strong";default:return"Very Weak"}}getPasswordStrengthColor(){switch(this.passwordStrength){case 0:return"text-red-500";case 1:return"text-orange-500";case 2:return"text-yellow-500";case 3:return"text-blue-500";case 4:return"text-green-500";default:return"text-red-500"}}getLockoutTimeRemaining(){return Math.ceil(this.lockoutTimeRemaining/6e4)}gotoPage(){this._setIsSignInPage(!this.isSignInPage)}_setIsSignInPage(t){this.isSignInPage=t,this.isSignInPage?(this.signInForm.removeControl("confirmPassword"),this.signInForm.removeControl("name")):(this.signInForm.addControl("confirmPassword",this.fb.control("",[tt.required])),this.signInForm.addControl("name",this.fb.control("",[tt.required,tt.minLength(2)])))}};i.\u0275fac=function(r){return new(r||i)(Y(vi),Y(nn),Y(L1),Y(ni),Y(ft),Y(Kx),Y(sa),Y(pt))},i.\u0275cmp=Re({type:i,selectors:[["app-sign-in"]],decls:56,vars:39,consts:[[1,"flex","items-center","min-h-screen","bg-blue-100","p-4"],[1,"flex","w-full","max-w-sm","mx-auto","bg-white","rounded-lg","shadow-lg","dark:bg-gray-800","lg:max-w-4xl","min-h-[600px]","max-h-[90vh]","overflow-hidden"],[1,"hidden","bg-cover","lg:flex","lg:w-1/2","items-center","bg-blue-50"],[1,"bg"],[1,"w-full","px-4","py-6","md:px-6","lg:w-1/2","lg:px-8","overflow-y-auto"],[1,"flex","justify-center","mx-auto"],["src","assets/images/logo.svg","alt","Logo","loading","eager",1,"w-auto","h-16","md:h-20"],[1,"mt-3","text-lg","md:text-xl","text-center","text-gray-600","dark:text-gray-200"],["class","mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg",4,"ngIf"],["class","mt-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded-lg",4,"ngIf"],["appSecurity","moderate",1,"form-container","mt-6",3,"formGroup"],[1,"space-y-4"],["for","LoggingEmailAddress",1,"block","mb-2","text-sm","font-medium","text-gray-600","dark:text-gray-200"],["id","LoggingEmailAddress","formControlName","email","type","email","autocomplete","email",1,"block","w-full","px-4","py-2","text-gray-700","bg-white","border","rounded-lg","dark:bg-gray-800","dark:text-gray-300","dark:border-gray-600","focus:border-blue-400","focus:ring-opacity-40","dark:focus:border-blue-300","focus:outline-none","focus:ring","focus:ring-blue-300"],["class","text-red-500 text-sm mt-1",4,"ngIf"],[4,"ngIf"],[1,"flex","justify-between","items-center","mb-2"],["for","loggingPassword",1,"block","text-sm","font-medium","text-gray-600","dark:text-gray-200"],["class","text-xs text-gray-500 dark:text-gray-300 hover:underline",4,"ngIf"],[1,"relative"],["id","loggingPassword","formControlName","password","autocomplete","current-password",1,"block","w-full","px-4","py-2","pr-10","text-gray-700","bg-white","border","rounded-lg","dark:bg-gray-800","dark:text-gray-300","dark:border-gray-600","focus:border-blue-400","focus:ring-opacity-40","dark:focus:border-blue-300","focus:outline-none","focus:ring","focus:ring-blue-300",3,"type"],["type","button",1,"absolute","inset-y-0","right-0","pr-3","flex","items-center","text-gray-400","hover:text-gray-600",3,"click"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","mt-2",4,"ngIf"],[1,"mt-6","space-y-4"],[1,"w-full","px-6","py-3","text-sm","font-medium","tracking-wide","text-white","capitalize","transition-colors","duration-300","transform","bg-primary","rounded-lg","hover:bg-primary800","focus:outline-none","focus:ring","focus:ring-gray-300","focus:ring-opacity-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-center"],["diameter","20","class","mr-2",4,"ngIf"],["type","button",1,"w-full","px-6","py-3","text-sm","font-medium","tracking-wide","text-gray-600","capitalize","transition-colors","duration-300","transform","border","border-gray-300","rounded-lg","hover:bg-gray-50","dark:border-gray-600","dark:text-gray-200","dark:hover:bg-gray-700","focus:outline-none","focus:ring","focus:ring-gray-300","focus:ring-opacity-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","w-5 h-5 mr-2 flex-shrink-0","viewBox","0 0 40 40",4,"ngIf"],["diameter","20","class","mr-2 text-blue-500",4,"ngIf"],[1,"whitespace-nowrap"],[1,"flex","items-center","justify-between","mt-6"],[1,"w-1/5","border-b","dark:border-gray-600","md:w-1/4"],[1,"text-xs","text-gray-500","uppercase","dark:text-gray-400","hover:underline","cursor-pointer",3,"click"],["class","mt-4 p-2 bg-gray-50 border border-gray-200 rounded-md security-notice",4,"ngIf"],[1,"mt-4","p-3","bg-red-100","border","border-red-400","text-red-700","rounded-lg"],[1,"flex","items-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","mr-2","flex-shrink-0"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"font-medium"],[1,"mt-1","text-sm"],["class","mt-1 text-sm",4,"ngIf"],[1,"mt-4","p-3","bg-yellow-100","border","border-yellow-400","text-yellow-700","rounded-lg"],["fill-rule","evenodd","d","M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"text-red-500","text-sm","mt-1"],["for","userName",1,"block","mb-2","text-sm","font-medium","text-gray-600","dark:text-gray-200"],["id","userName","formControlName","name","type","text","autocomplete","name",1,"block","w-full","px-4","py-2","text-gray-700","bg-white","border","rounded-lg","dark:bg-gray-800","dark:text-gray-300","dark:border-gray-600","focus:border-blue-400","focus:ring-opacity-40","dark:focus:border-blue-300","focus:outline-none","focus:ring","focus:ring-blue-300"],[1,"text-xs","text-gray-500","dark:text-gray-300","hover:underline"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"],[1,"mt-2"],[1,"flex","items-center","justify-between","text-sm"],[1,"mt-1","w-full","bg-gray-200","rounded-full","h-2"],[1,"h-2","rounded-full","transition-all","duration-300",3,"ngClass"],[1,"mt-1","text-xs","text-gray-500"],["for","confirmPassword",1,"block","mb-2","text-sm","font-medium","text-gray-600","dark:text-gray-200"],["id","confirmPassword","formControlName","confirmPassword","autocomplete","new-password",1,"block","w-full","px-4","py-2","pr-10","text-gray-700","bg-white","border","rounded-lg","dark:bg-gray-800","dark:text-gray-300","dark:border-gray-600","focus:border-blue-400","focus:ring-opacity-40","dark:focus:border-blue-300","focus:outline-none","focus:ring","focus:ring-blue-300",3,"type"],["diameter","20",1,"mr-2"],["viewBox","0 0 40 40",1,"w-5","h-5","mr-2","flex-shrink-0"],["d","M36.3425 16.7358H35V16.6667H20V23.3333H29.4192C28.045 27.2142 24.3525 30 20 30C14.4775 30 10 25.5225 10 20C10 14.4775 14.4775 9.99999 20 9.99999C22.5492 9.99999 24.8683 10.9617 26.6342 12.5325L31.3483 7.81833C28.3717 5.04416 24.39 3.33333 20 3.33333C10.7958 3.33333 3.33335 10.7958 3.33335 20C3.33335 29.2042 10.7958 36.6667 20 36.6667C29.2042 36.6667 36.6667 29.2042 36.6667 20C36.6667 18.8825 36.5517 17.7917 36.3425 16.7358Z","fill","#FFC107"],["d","M5.25497 12.2425L10.7308 16.2583C12.2125 12.59 15.8008 9.99999 20 9.99999C22.5491 9.99999 24.8683 10.9617 26.6341 12.5325L31.3483 7.81833C28.3716 5.04416 24.39 3.33333 20 3.33333C13.5983 3.33333 8.04663 6.94749 5.25497 12.2425Z","fill","#FF3D00"],["d","M20 36.6667C24.305 36.6667 28.2167 35.0192 31.1742 32.34L26.0159 27.975C24.3425 29.2425 22.2625 30 20 30C15.665 30 11.9842 27.2359 10.5975 23.3784L5.16254 27.5659C7.92087 32.9634 13.5225 36.6667 20 36.6667Z","fill","#4CAF50"],["d","M36.3425 16.7358H35V16.6667H20V23.3333H29.4192C28.7592 25.1975 27.56 26.805 26.0133 27.9758C26.0142 27.975 26.015 27.975 26.0158 27.9742L31.1742 32.3392C30.8092 32.6708 36.6667 28.3333 36.6667 20C36.6667 18.8825 36.5517 17.7917 36.3425 16.7358Z","fill","#1976D2"],["diameter","20",1,"mr-2","text-blue-500"],[1,"mt-4","p-2","bg-gray-50","border","border-gray-200","rounded-md","security-notice"],["fill","currentColor","viewBox","0 0 16 16",1,"w-3","h-3","mr-1.5","text-gray-500","flex-shrink-0"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0-1A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"],["d","M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"],[1,"text-xs","text-gray-600","font-medium"],[1,"mt-0.5","text-xs","text-gray-500"]],template:function(r,a){if(r&1&&(s(0,"section",0)(1,"div",1)(2,"div",2),re(3,"div",3),c(),s(4,"div",4)(5,"div",5),re(6,"img",6),c(),s(7,"p",7),d(8),ce(9,"translate"),c(),N(10,MS,9,1,"div",8)(11,PS,8,2,"div",9),s(12,"form",10)(13,"div",11)(14,"div")(15,"label",12),d(16),ce(17,"translate"),c(),re(18,"input",13),N(19,kS,4,3,"div",14),c(),N(20,AS,5,2,"div",15),s(21,"div")(22,"div",16)(23,"label",17),d(24),ce(25,"translate"),c(),N(26,DS,2,0,"a",18),c(),s(27,"div",19),re(28,"input",20),s(29,"button",21),F("click",function(){return a.togglePasswordVisibility()}),N(30,FS,3,0,"svg",22)(31,RS,2,0,"svg",22),c()(),N(32,NS,10,12,"div",23)(33,zS,4,3,"div",14),c(),N(34,HS,10,8,"div",15),c(),s(35,"div",24)(36,"button",25),F("click",function(){return a.isSignInPage?a.onSignIn():a.onSignUp()}),s(37,"div",26),N(38,qS,1,0,"mat-spinner",27)(39,XS,4,5,"span",15)(40,KS,2,1,"span",15),c()(),s(41,"button",28),F("click",function(){return a.signInWithGoogle()}),s(42,"div",26),N(43,ZS,5,0,"svg",29)(44,QS,1,0,"mat-spinner",30),s(45,"span",31),d(46),ce(47,"translate"),c()()()(),s(48,"div",32),re(49,"span",33),s(50,"a",34),F("click",function(){return a.gotoPage()}),d(51),ce(52,"translate"),ce(53,"translate"),c(),re(54,"span",33),c(),N(55,JS,9,0,"div",35),c()()()()),r&2){let o,l,m;u(8),ne(" ",xe(9,27,"welcomeBack")," "),u(2),P("ngIf",a.isAccountLocked),u(),P("ngIf",!a.isAccountLocked&&a.loginAttempts>0),u(),P("formGroup",a.signInForm),u(4),ne(" ",xe(17,29,"email")," Address "),u(2),Wr("data-security-level",a.securityLevel),u(),P("ngIf",((o=a.signInForm.get("email"))==null?null:o.invalid)&&((o=a.signInForm.get("email"))==null?null:o.touched)),u(),P("ngIf",!a.isSignInPage),u(4),L(xe(25,31,"password")),u(2),P("ngIf",a.isSignInPage),u(2),P("type",a.showPassword?"text":"password"),Wr("data-security-level",a.securityLevel),u(2),P("ngIf",!a.showPassword),u(),P("ngIf",a.showPassword),u(),P("ngIf",!a.isSignInPage&&((l=a.signInForm.get("password"))==null?null:l.value)),u(),P("ngIf",((m=a.signInForm.get("password"))==null?null:m.invalid)&&((m=a.signInForm.get("password"))==null?null:m.touched)),u(),P("ngIf",!a.isSignInPage),u(2),P("disabled",a.isLoading||a.isAccountLocked||a.signInForm.invalid),u(2),P("ngIf",a.isLoading),u(),P("ngIf",!a.isLoading),u(),P("ngIf",a.isLoading),u(),P("disabled",a.isLoading||a.isAccountLocked),u(2),P("ngIf",!a.isLoading),u(),P("ngIf",a.isLoading),u(2),L(a.isLoading?"Signing in...":xe(47,33,"signIn")+" with Google"),u(5),ne("or ",a.isSignInPage?xe(52,35,"signUp"):xe(53,37,"signIn"),""),u(4),P("ngIf",a.showSecurityNotice)}},dependencies:[$n,dt,Wn,Nt,At,Yn,xi,Ci,Br,Z0],styles:['.bg[_ngcontent-%COMP%]{background-image:url("./media/sign-in-TAB6YH4B.png");background-size:contain;background-repeat:no-repeat;background-position:center;height:100%;width:100%;min-height:400px}.security-notice[_ngcontent-%COMP%]{opacity:0;transform:translateY(10px);animation:_ngcontent-%COMP%_fadeInUp .3s ease-out forwards}@keyframes _ngcontent-%COMP%_fadeInUp{to{opacity:1;transform:translateY(0)}}.form-container[_ngcontent-%COMP%]{will-change:transform;contain:layout style paint}@media (max-width: 768px){.bg[_ngcontent-%COMP%]{min-height:300px}}@media (max-width: 480px){.bg[_ngcontent-%COMP%]{min-height:250px}}']});let e=i;return e})();var Qx=(()=>{let i=class i{constructor(t,r,a,o,l){this.dialog=t,this.store=r,this.splitwiseService=a,this.userService=o,this.dateService=l}checkAndShowInvitations(){return me(this,null,function*(){try{let t=yield this.userService.getCurrentUser();if(!(t!=null&&t.uid))return;let r=yield this.splitwiseService.getUserInvitations(t.uid).toPromise();if(r&&r.length>0){let a=r.filter(o=>!this.isInvitationExpired(o));a.length>0&&this.showInvitationPopup(a)}}catch(t){console.error("Error checking invitations:",t)}})}showInvitationPopup(t){if(!t||t.length===0)return;let r=this.dialog.open(Hr,{data:{title:"Invitations",message:`You have invitations to Splitwise Groups - ${t.map(a=>a.groupName).join(", ")}. Please accept or decline them.`,confirmText:"Accept",cancelText:"Decline",type:"warning"}});r.afterClosed().subscribe(()=>{r.componentInstance.data.confirmText==="Accept"?this.store.dispatch(U_({invitationId:t[0].id})):r.componentInstance.data.confirmText==="Decline"&&this.store.dispatch(z_({invitationId:t[0].id}))})}isInvitationExpired(t){if(!t.expiresAt)return!1;let r=null;return t.expiresAt instanceof Date?r=t.expiresAt:t.expiresAt.toDate?r=t.expiresAt.toDate():r=this.dateService.toDate(t.expiresAt),r?r<new Date:!1}showInvitationsAfterLogin(){return me(this,null,function*(){setTimeout(()=>{this.checkAndShowInvitations()},1e3)})}};i.\u0275fac=function(r){return new(r||i)(De(xn),De(pt),De(Ec),De(ni),De(Vt))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var qm=(()=>{let i=class i{constructor(t,r){this.firestore=t,this.auth=r,this.isOnlineSubject=new on(!0),this.isOnline$=this.isOnlineSubject.asObservable()}getCurrentUserId(){var t;return((t=this.auth.currentUser)==null?void 0:t.uid)||null}isAuthenticated(){return!!this.auth.currentUser}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}getCollectionRef(t){let r=this.getCurrentUserId();if(!r)throw new Error(ti.AUTH.SESSION_EXPIRED);return Gr(this.firestore,`users/${r}/${t}`)}getDocumentRef(t,r){let a=this.getCurrentUserId();if(!a)throw new Error(ti.AUTH.SESSION_EXPIRED);return Dt(this.firestore,`users/${a}/${t}/${r}`)}handleError(t,r){console.error(`Error in ${r}:`,t);let a=ti.NETWORK.SERVER_ERROR;if(t.code)switch(t.code){case"auth/user-not-found":a=ti.AUTH.USER_NOT_FOUND;break;case"auth/wrong-password":a=ti.AUTH.INVALID_CREDENTIALS;break;case"auth/email-already-in-use":a=ti.AUTH.EMAIL_ALREADY_EXISTS;break;case"auth/weak-password":a=ti.AUTH.WEAK_PASSWORD;break;case"permission-denied":a=ti.PERMISSION.ACCESS_DENIED;break;case"unavailable":a=ti.NETWORK.CONNECTION_ERROR;break;default:a=t.message||ti.NETWORK.SERVER_ERROR}return Na(()=>new Error(a))}validateRequiredFields(t,r){let a=r.filter(o=>!t[o]);if(a.length>0)throw new Error(`${ti.VALIDATION.REQUIRED_FIELD}: ${a.join(", ")}`)}validateAmount(t){if(t<Ut.VALIDATION.MIN_AMOUNT||t>Ut.VALIDATION.MAX_AMOUNT)throw new Error(ti.VALIDATION.INVALID_AMOUNT)}validateStringLength(t,r,a,o){if(t.length<r)throw new Error(`${ti.VALIDATION.MIN_LENGTH.replace("{min}",r.toString())} for ${o}`);if(t.length>a)throw new Error(`${ti.VALIDATION.MAX_LENGTH.replace("{max}",a.toString())} for ${o}`)}addSyncStatus(t,r=bi.SYNCED){return le(oe({},t),{syncStatus:r,lastSyncedAt:Nl()})}addMetadata(t,r){return le(oe({},t),{createdAt:Nl(),updatedAt:Nl(),createdBy:r,updatedBy:r})}updateMetadata(t,r){return le(oe({},t),{updatedAt:Nl(),updatedBy:r})}cacheData(t,r){try{let a={data:r,timestamp:Date.now(),expiry:Date.now()+Ut.OFFLINE.CACHE_EXPIRY};localStorage.setItem(t,JSON.stringify(a))}catch(a){console.error("Failed to cache data:",a)}}getCachedData(t){try{let r=localStorage.getItem(t);if(!r)return null;let a=JSON.parse(r);return Date.now()>a.expiry?(localStorage.removeItem(t),null):a.data}catch(r){return console.error("Failed to get cached data:",r),null}}clearCachedData(t){try{localStorage.removeItem(t)}catch(r){console.error("Failed to clear cached data:",r)}}debounce(t,r=Ut.PERFORMANCE.DEBOUNCE_DELAY){let a;return(...o)=>{clearTimeout(a),a=setTimeout(()=>t(...o),r)}}throttle(t,r=Ut.PERFORMANCE.THROTTLE_DELAY){let a=0;return(...o)=>{let l=Date.now();l-a>=r&&(a=l,t(...o))}}formatCurrency(t,r="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:r}).format(t)}formatDate(t,r="MM/dd/yyyy"){let a={year:"numeric",month:"2-digit",day:"2-digit"};return new Intl.DateTimeFormat("en-US",a).format(t)}isDataExpired(t,r=Ut.OFFLINE.CACHE_EXPIRY){return Date.now()-t>r}retryOperation(o){return me(this,arguments,function*(t,r=Ut.OFFLINE.MAX_RETRY_ATTEMPTS,a=1e3){let l;for(let m=0;m<=r;m++)try{return yield t()}catch(g){if(l=g,m===r)throw g;let f=a*Math.pow(2,m);yield new Promise(h=>setTimeout(h,f))}throw l})}};i.\u0275fac=function(r){return new(r||i)(De(cr),De(xt))},i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})();var $c=(()=>{let i=class i{constructor(t,r){this.firestore=t,this.auth=r}createAccount(t,r){return new tn(a=>{let o=this.generateAccountId(),l=le(oe({accountId:o,userId:t},r),{createdAt:new Date,isActive:!0}),m=Dt(this.firestore,`users/${t}/accounts/${o}`);Rr(m,l).then(()=>{a.next(o),a.complete()}).catch(g=>{a.error(g)})})}getAccounts(t){let r=Gr(this.firestore,`users/${t}/accounts`);return new tn(a=>{Va(r).then(o=>{let l=[];o.forEach(m=>{l.push(m.data())}),a.next(l)})})}getAccount(t,r){return new tn(a=>{let o=Dt(this.firestore,`users/${t}/accounts/${r}`);di(o).then(l=>{l.exists()?a.next(l.data()):a.next(void 0),a.complete()}).catch(l=>{a.error(l)})})}updateAccount(t,r,a){return new tn(o=>{let l=Dt(this.firestore,`users/${t}/accounts/${r}`),m=le(oe({},a),{updatedAt:new Date});Fn(l,m).then(()=>{o.next(),o.complete()}).catch(g=>{o.error(g)})})}deleteAccount(t,r){return new tn(a=>{let o=Dt(this.firestore,`users/${t}/accounts/${r}`);zi(o).then(()=>{a.next(),a.complete()}).catch(l=>{a.error(l)})})}updateAccountBalanceForTransaction(t,r,a,o,l){return new tn(m=>{me(this,null,function*(){try{let f=Dt(this.firestore,`users/${t}/accounts/${r}`),h=yield di(f);if(!h.exists()){m.error("Account not found");return}let x=h.data(),C=0,y=0;switch(a){case"create":l&&(C=l.type==="income"?l.amount:-l.amount,x.type==="loan"&&l.type==="expense"&&(y=-l.amount));break;case"update":if(o&&l){let w=o.type==="income"?o.amount:-o.amount;if(C=(l.type==="income"?l.amount:-l.amount)-w,x.type==="loan"){let E=o.type==="expense"?-o.amount:0;y=(l.type==="expense"?-l.amount:0)-E}}break;case"delete":o&&(C=o.type==="income"?-o.amount:o.amount,x.type==="loan"&&o.type==="expense"&&(y=o.amount));break}let b={balance:(x.balance||0)+C,updatedAt:new Date};if(x.type==="loan"&&x.loanDetails&&y!==0){let w=x.loanDetails.remainingBalance||0,A=Math.max(0,w+y);b["loanDetails.remainingBalance"]=A}yield Fn(f,b),m.next(b.balance),m.complete()}catch(f){m.error(f)}})})}updateAccountBalanceForTransactions(t,r){return new tn(a=>{me(this,null,function*(){try{let l=Fu(this.firestore),m=new Map,g=new Map;r.forEach(f=>{let h=m.get(f.accountId)||0,x=f.type==="income"?f.amount:-f.amount;if(m.set(f.accountId,h+x),f.type==="expense"){let C=g.get(f.accountId)||0;g.set(f.accountId,C+f.amount)}});for(let[f,h]of m){let x=Dt(this.firestore,`users/${t}/accounts/${f}`),C=yield di(x);if(C.exists()){let y=C.data(),w={balance:(y.balance||0)+h,updatedAt:new Date};if(y.type==="loan"&&y.loanDetails){let A=g.get(f)||0;if(A>0){let E=y.loanDetails.remainingBalance||0,I=Math.max(0,E-A);w["loanDetails.remainingBalance"]=I}}l.update(x,w)}}yield l.commit(),a.next(),a.complete()}catch(l){a.error(l)}})})}updateAccountBalanceForAccountTransfer(t,r,a,o){return new tn(l=>{me(this,null,function*(){try{let g=Fu(this.firestore),f=Dt(this.firestore,`users/${t}/accounts/${r}`),h=Dt(this.firestore,`users/${t}/accounts/${a}`),[x,C]=yield Promise.all([di(f),di(h)]);if(!x.exists()||!C.exists()){l.error("One or both accounts not found");return}let y=x.data(),b=C.data(),w=o.type==="income"?o.amount:-o.amount,A={balance:(y.balance||0)-w,updatedAt:new Date};if(y.type==="loan"&&y.loanDetails&&o.type==="expense"){let K=(y.loanDetails.remainingBalance||0)+o.amount;A["loanDetails.remainingBalance"]=K}let E={balance:(b.balance||0)+w,updatedAt:new Date};if(b.type==="loan"&&b.loanDetails&&o.type==="expense"){let I=b.loanDetails.remainingBalance||0,K=Math.max(0,I-o.amount);E["loanDetails.remainingBalance"]=K}g.update(f,A),g.update(h,E),yield g.commit(),l.next(),l.complete()}catch(g){l.error(g)}})})}generateAccountId(){return"acc_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}};i.\u0275fac=function(r){return new(r||i)(De(cr),De(xt))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var Ka=(()=>{let i=class i extends qm{constructor(t,r,a,o,l,m,g){super(t,r),this.dateService=a,this.store=o,this.accountsService=l,this.splitwiseService=m,this.commonSyncService=g,this.transactionsSubject=new on([])}createTransaction(t,r){return new tn(a=>{let o=this.generateId(),l=le(oe({},r),{id:o,date:this.dateService.toDate(r.date),syncStatus:this.commonSyncService.isCurrentlyOnline()?"synced":"pending"});me(this,null,function*(){try{if(this.commonSyncService.isCurrentlyOnline())try{let g=Dt(this.firestore,`users/${t}/transactions/${o}`);yield Rr(g,l),r.isSplitTransaction&&r.splitGroupId&&(yield this.createSplitTransaction(r.splitGroupId,r,g.id,t)),this.store.dispatch($o({userId:t,accountId:r.accountId,transactionType:"create",newTransaction:l})),this.store.dispatch(vc({transaction:l})),this.updateTransactionCache(t,"create",l),a.next(),a.complete()}catch(g){console.error("Failed to create transaction online:",g),yield this.addToSyncQueue("create",l),this.store.dispatch(vc({transaction:l})),this.updateTransactionCache(t,"create",l),a.next(),a.complete()}else yield this.addToSyncQueue("create",l),this.store.dispatch(vc({transaction:l})),this.updateTransactionCache(t,"create",l),a.next(),a.complete()}catch(g){console.error("Error in createTransaction:",g),a.error(g)}})})}updateTransaction(t,r,a){return new tn(o=>{me(this,null,function*(){try{let m=le(oe({},a),{updatedAt:new Date,updatedBy:t,syncStatus:this.commonSyncService.isCurrentlyOnline()?"synced":"pending"});if(this.commonSyncService.isCurrentlyOnline())try{let g=Dt(this.firestore,`users/${t}/transactions/${r}`);yield Fn(g,m),(a.amount||a.accountId)&&this.store.dispatch($o({userId:t,accountId:a.accountId||"",transactionType:"update",oldTransaction:{id:r},newTransaction:m})),this.store.dispatch(bc({transaction:oe({id:r},m)})),this.updateTransactionCache(t,"update",oe({id:r},m)),o.next(),o.complete()}catch(g){console.error("Failed to update transaction online:",g),yield this.addToSyncQueue("update",oe({id:r},m)),this.store.dispatch(bc({transaction:oe({id:r},m)})),this.updateTransactionCache(t,"update",oe({id:r},m)),o.next(),o.complete()}else yield this.addToSyncQueue("update",oe({id:r},m)),this.store.dispatch(bc({transaction:oe({id:r},m)})),this.updateTransactionCache(t,"update",oe({id:r},m)),o.next(),o.complete()}catch(m){o.error(m)}})})}deleteTransaction(t,r){return new tn(a=>{let o=Dt(this.firestore,`users/${t}/transactions/${r}`);di(o).then(l=>{let m=l.exists()?oe({id:l.id},l.data()):null;this.commonSyncService.isCurrentlyOnline()?zi(o).then(()=>{m&&(this.store.dispatch($o({userId:t,accountId:m.accountId,transactionType:"delete",oldTransaction:m})),m.isSplitTransaction&&this.splitwiseService.deleteSplitTransaction(m.id,t).catch(g=>{console.error("Failed to delete split transaction:",g)})),this.store.dispatch(Go({transactionId:r})),this.updateTransactionCache(t,"delete",{id:r}),a.next(),a.complete()}).catch(g=>{console.error("Failed to delete transaction online:",g),this.addToSyncQueue("delete",{id:r}).then(()=>{this.store.dispatch(Go({transactionId:r})),this.updateTransactionCache(t,"delete",{id:r}),a.next(),a.complete()}).catch(f=>{console.error("Failed to add to sync queue:",f),a.error(f)})}):this.addToSyncQueue("delete",{id:r}).then(()=>{this.store.dispatch(Go({transactionId:r})),this.updateTransactionCache(t,"delete",{id:r}),a.next(),a.complete()}).catch(g=>{console.error("Failed to add to sync queue:",g),a.error(g)})}).catch(l=>{console.error("Failed to get transaction for deletion:",l),a.error(l)})})}getTransactions(t){let r=Du(Gr(this.firestore,`users/${t}/transactions`),Au("date","desc"));return new tn(a=>{let o=Iu(r,l=>{let m=[];if(l.forEach(g=>{let f=oe({id:g.id},g.data());m.push(f)}),!this.commonSyncService.isCurrentlyOnline()){let g=this.getCachedTransactions(t),f=g.map(C=>C.id),h=m.map(C=>C.id),x=g.filter(C=>C.id&&!h.includes(C.id));m.push(...x)}this.cacheTransactions(t,m),this.transactionsSubject.next(m),a.next(m)},l=>{if(console.error("Failed to fetch transactions:",l),this.commonSyncService.isCurrentlyOnline())a.next([]);else{let m=this.getCachedTransactions(t);this.transactionsSubject.next(m),a.next(m)}});return()=>o()})}getTransaction(t,r){return new tn(a=>{me(this,null,function*(){try{let l=Dt(this.firestore,`users/${t}/transactions/${r}`),m=yield di(l);if(m.exists()){let g=oe({id:m.id},m.data());a.next(g)}else a.next(void 0);a.complete()}catch(l){a.error(l)}})})}getSyncStatus(){let t=this.commonSyncService.syncStatus;return{count:t.pendingItems,hasPendingOperations:t.pendingItems>0}}forceSync(){return me(this,null,function*(){yield this.commonSyncService.manualSync()})}getRecurringTransactions(t){let r=Du(Gr(this.firestore,`users/${t}/transactions`),Au("date","desc"));return new tn(a=>{let o=Iu(r,l=>{let m=[];l.forEach(f=>{let h=oe({id:f.id},f.data());m.push(h)});let g=m.filter(f=>f.isRecurring===!0);a.next(g)},l=>{console.error("Failed to fetch recurring transactions:",l),a.next([])});return()=>o()})}getDueRecurringTransactions(t){return this.getRecurringTransactions(t).pipe(We(r=>{let a=new Date;return a.setHours(0,0,0,0),r.filter(o=>{if(!o.nextOccurrence)return!1;let l=o.nextOccurrence instanceof Date?o.nextOccurrence:this.dateService.toDate(o.nextOccurrence);return l==null||l.setHours(0,0,0,0),l&&l<=a})}))}processRecurringTransaction(t,r){return new tn(a=>{me(this,null,function*(){try{let l=le(oe({},r),{date:new Date,nextOccurrence:void 0,isRecurring:!1,recurringInterval:void 0,recurringEndDate:void 0,createdAt:new Date,updatedAt:new Date,createdBy:t,updatedBy:t,syncStatus:bi.SYNCED,isPending:!1,lastSyncedAt:new Date});if(yield this.createTransaction(t,l).toPromise(),r.recurringInterval&&r.nextOccurrence){let m=this.calculateNextOccurrence(r.recurringInterval,r.nextOccurrence),g={nextOccurrence:m,updatedAt:new Date,updatedBy:t};r.recurringEndDate&&m>r.recurringEndDate&&(g.isRecurring=!1,g.recurringInterval=void 0,g.recurringEndDate=void 0),yield this.updateTransaction(t,r.id,g).toPromise()}a.next(),a.complete()}catch(l){console.error("Failed to process recurring transaction:",l),a.error(l)}})})}calculateNextOccurrence(t,r){let a=r instanceof Date?r:r.toDate(),o=new Date(a);switch(t){case oa.DAILY:o.setDate(o.getDate()+1);break;case oa.WEEKLY:o.setDate(o.getDate()+7);break;case oa.MONTHLY:o.setMonth(o.getMonth()+1);break;case oa.YEARLY:o.setFullYear(o.getFullYear()+1);break;default:o.setDate(o.getDate()+1)}return o}createSplitTransaction(t,r,a,o){return me(this,null,function*(){try{let l={groupId:t,originalTransactionId:a,amount:r.amount,splits:r.splits||[]};yield this.splitwiseService.createSplitTransaction(l,o).toPromise()}catch(l){console.error("Failed to create split transaction:",l)}})}addToSyncQueue(t,r){return me(this,null,function*(){let a={id:this.generateId(),type:"transaction",operation:t,data:r,maxRetries:3},o=yield this.commonSyncService.registerSyncItem(a);o.success||console.error("Failed to register transaction for sync:",o.errors)})}getCachedTransactions(t){try{let r=localStorage.getItem(`transactions-cache-${t}`);if(r)return JSON.parse(r).filter(o=>o&&o.id)}catch(r){console.error("Error loading cached transactions:",r)}return[]}cacheTransactions(t,r){try{localStorage.setItem(`transactions-cache-${t}`,JSON.stringify(r))}catch(a){console.error("Error caching transactions:",a)}}updateTransactionCache(t,r,a){try{let o=this.getCachedTransactions(t);switch(r){case"create":a&&o.push(a);break;case"update":if(a){let l=o.findIndex(m=>m.id===a.id);l!==-1&&(o[l]=a)}break;case"delete":if(a){let l=o.findIndex(m=>m.id===a.id);l!==-1&&o.splice(l,1)}break}this.cacheTransactions(t,o)}catch(o){console.error("Error updating transaction cache:",o)}}isFirebaseValidationError(t){var r,a;return t&&(t.code==="permission-denied"||t.code==="unavailable"||t.code==="invalid-argument"||((r=t.message)==null?void 0:r.includes("permission"))||((a=t.message)==null?void 0:a.includes("validation")))}};i.\u0275fac=function(r){return new(r||i)(De(cr),De(xt),De(Vt),De(pt),De($c),De(Ec),De(qr))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var Jx=(()=>{let i=class i{constructor(t,r,a,o){this.transactionsService=t,this.userService=r,this.notificationService=a,this.dialog=o}checkDueRecurringTransactions(){var r;let t=(r=this.userService.userAuth$.value)==null?void 0:r.uid;return t?this.transactionsService.getDueRecurringTransactions(t).pipe(wr(a=>a.length===0?gt(void 0):this.showRecurringTransactionConfirmation(a))):gt(void 0)}showRecurringTransactionConfirmation(t){return new tn(r=>{this.dialog.open(K_,{width:"400px",data:{transactions:t},disableClose:!0}).afterClosed().subscribe(o=>{o&&o.action==="confirm"?this.processConfirmedTransactions(o.transactions).subscribe({next:()=>{this.notificationService.success("Recurring transactions processed successfully"),r.next(),r.complete()},error:l=>{this.notificationService.error("Failed to process recurring transactions"),r.error(l)}}):(r.next(),r.complete())})})}processConfirmedTransactions(t){var a;let r=(a=this.userService.userAuth$.value)==null?void 0:a.uid;return r?new tn(o=>{let l=0,m=t.length,g=()=>{if(l>=m){o.next(),o.complete();return}let f=t[l];this.transactionsService.processRecurringTransaction(r,f).subscribe({next:()=>{l++,g()},error:h=>{console.error(`Failed to process transaction ${f.id}:`,h),l++,g()}})};g()}):gt(void 0)}getRecurringTransactions(t){return this.transactionsService.getRecurringTransactions(t)}getRecurringTransactionsSummary(t){return this.transactionsService.getRecurringTransactions(t).pipe(We(r=>{let a=new Date;a.setHours(0,0,0,0);let o=r.filter(m=>{if(!m.nextOccurrence)return!1;let g=m.nextOccurrence instanceof Date?m.nextOccurrence:m.nextOccurrence.toDate();return g.setHours(0,0,0,0),g<=a}).length,l=r.filter(m=>{if(!m.nextOccurrence)return!1;let g=m.nextOccurrence instanceof Date?m.nextOccurrence:m.nextOccurrence.toDate();return g.setHours(0,0,0,0),g>a}).length;return{total:r.length,due:o,upcoming:l}}))}};i.\u0275fac=function(r){return new(r||i)(De(Ka),De(ni),De(ft),De(xn))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var n3=[{label:"Navigation",icon:"navigation",order:1,isExpanded:!0,isCollapsible:!0,children:[{label:"dashboard",route:"/dashboard/home",icon:"dashboard",order:1},{label:"accounts",route:"/dashboard/accounts",icon:"account_balance",order:2},{label:"transactions",route:"/dashboard/transactions",icon:"receipt_long",order:3},{label:"categories",route:"/dashboard/category",icon:"category",order:4},{label:"budgets",route:"/dashboard/budgets",icon:"pie_chart",order:5},{label:"reports",route:"/dashboard/reports",icon:"analytics",order:7}]},{label:"Tools",icon:"build",order:2,isExpanded:!0,isCollapsible:!0,children:[{label:"tax",route:"/dashboard/tax",icon:"calculate",order:3,isPremium:!0},{label:"Splitwise",route:"/dashboard/splitwise",icon:"group",order:4,isPremium:!0},{label:"Google Sheets",route:"/dashboard/google-sheets",icon:"table_chart",order:5,isPremium:!0},{label:"OpenAI Integration",route:"/dashboard/openai-interaction",icon:"smart_toy",order:6,isPremium:!0}]},{label:"Account",icon:"person",order:3,isExpanded:!0,isCollapsible:!0,children:[{label:"Profile",route:"/dashboard/profile",icon:"account_circle",order:1},{label:"Notifications",route:"/dashboard/notifications",icon:"notifications",order:3},{label:"Feedback",route:"/dashboard/feedback",icon:"feedback",order:4}]},{label:"Admin",icon:"admin_panel_settings",order:4,isExpanded:!1,isCollapsible:!0,children:[{label:"admin_panel",route:"/admin",icon:"admin_panel_settings",order:1}]}],eC=()=>n3.sort((e,i)=>e.order-i.order);var i3=["drawer"],r3=(e,i)=>i.label,a3=(e,i)=>i.route;function o3(e,i){if(e&1&&(s(0,"mat-icon",32),d(1," expand_more "),c()),e&2){let n=v(2).$implicit;ze("rotate-180",!n.isExpanded)}}function s3(e,i){if(e&1){let n=ue();s(0,"div",27),F("click",function(){R(n);let r=v().$implicit,a=v();return B(a.toggleSection(r))}),s(1,"div",28)(2,"mat-icon",29),d(3),c(),s(4,"h6",30),d(5),c()(),N(6,o3,2,2,"mat-icon",31),c()}if(e&2){let n=v().$implicit;ze("cursor-pointer",n.isCollapsible)("cursor-default",!n.isCollapsible)("hover:bg-blue-50",n.isCollapsible),u(3),L(n.icon),u(2),L(n.label),u(),P("ngIf",n.isCollapsible)}}function c3(e,i){e&1&&(s(0,"div",38)(1,"mat-icon",39),d(2,"star"),c()())}function l3(e,i){if(e&1){let n=ue();s(0,"a",33),F("click",function(){R(n),v(2);let r=bn(2);return B(r.toggle())}),re(1,"div",34),s(2,"mat-icon",35),d(3),c(),s(4,"span",36),d(5),ce(6,"translate"),c(),N(7,c3,3,0,"div",37),c()}if(e&2){let n=i.$implicit,t=v(2);P("routerLink",n.route),u(),ze("opacity-100",t.router.isActive(n.route,!1)),u(2),L(n.icon),u(2),L(xe(6,6,n.label)),u(2),P("ngIf",n.isPremium)}}function d3(e,i){e&1&&re(0,"div",40)}function m3(e,i){if(e&1&&(s(0,"div",12),N(1,s3,7,9,"div",23),s(2,"div",24),Ge(3,l3,8,8,"a",25,a3),c(),N(5,d3,1,0,"div",26),c()),e&2){let n=i.$implicit,t=v();u(),P("ngIf",n.label=="Admin"&&t.isAdmin),u(),ze("max-h-0",!n.isExpanded)("max-h-96",n.isExpanded)("opacity-0",!n.isExpanded)("opacity-100",n.isExpanded),u(),He(n.children),u(2),P("ngIf",n!==t.navigationSections[t.navigationSections.length-1])}}var tC=(()=>{let i=class i{constructor(t,r,a,o){this.auth=t,this.router=r,this.elementRef=a,this.userService=o,this.isAdmin=!1,this.navigationSections=[],this.navigationSections=eC()}ngOnInit(){this.isAdmin=this.userService.isAdmin}toggleSection(t){t.isCollapsible&&(t.isExpanded=!t.isExpanded)}ngAfterViewInit(){document.addEventListener("click",this.handleDocumentClick.bind(this))}handleKeyDown(t){t.key==="Escape"&&this.drawer&&this.drawer.opened&&this.drawer.close()}handleDocumentClick(t){if(this.drawer&&this.drawer.opened){let r=t.target;this.elementRef.nativeElement.contains(r)||r.closest('button[aria-label="Open sidebar"]')||this.drawer.close()}}logout(){return me(this,null,function*(){yield this.auth.signOut(),this.router.navigate(["/sign-in"],{queryParams:{loggedOut:"true"}})})}isPremiumRoute(t){return["/dashboard/google-sheets","/dashboard/reports","/dashboard/tax","/dashboard/goals","/dashboard/budgets"].includes(t)}};i.\u0275fac=function(r){return new(r||i)(Y(xt),Y(nn),Y(xo),Y(ni))},i.\u0275cmp=Re({type:i,selectors:[["side-bar"]],viewQuery:function(r,a){if(r&1&&ar(i3,5),r&2){let o;Ni(o=Li())&&(a.drawer=o.first)}},hostBindings:function(r,a){r&1&&F("keydown",function(l){return a.handleKeyDown(l)},!1,Qd)},decls:38,vars:7,consts:[["drawer",""],[1,"example-container","!z-[999]","h-screen"],[1,"!fixed","bg-white","shadow-2xl","w-72","border-r","border-gray-100","backdrop-blur-sm",3,"mode"],[1,"h-full","flex","flex-col","overflow-auto"],[1,"flex","items-center","justify-between","p-5","border-b","border-gray-100","bg-gradient-to-r","from-gray-50","to-white"],[1,"flex","items-center","gap-3"],["routerLink","/dashboard",1,"w-8","h-8","bg-gradient-to-br","bg-primary","rounded-lg","flex","items-center","justify-center","cursor-pointer"],[1,"text-[2rem]","!h-[33px]","!w-[33px]"],[1,"text-lg","font-semibold","text-gray-900"],["mat-icon-button","","routerLink","/dashboard","aria-label","Close sidebar",1,"text-gray-400","hover:text-gray-600","hover:bg-gray-50","rounded-lg","transition-colors",3,"click"],["mat-icon-button","","aria-label","Close sidebar",1,"text-gray-400","hover:text-gray-600","hover:bg-gray-50","rounded-lg","transition-colors",3,"click"],[1,"flex-1","p-4"],[1,"mb-6"],[1,"p-5","border-t","border-gray-100","bg-gradient-to-r","from-white","to-gray-50"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-2"],[1,"text-gray-400","text-sm"],[1,"text-xs","text-gray-500"],["mat-icon-button","","matTooltip","Logout",1,"text-gray-400","hover:text-red-600","hover:bg-red-50","rounded-lg","transition-colors",3,"click"],[1,"text-sm"],[1,"!overflow-hidden"],["aria-label","Open sidebar",1,"flex","items-center","gap-2","px-3","py-2","rounded-lg","hover:bg-gray-200","transition-colors",3,"click"],[1,"text-gray-600"],["class","flex items-center justify-between mb-3 cursor-pointer hover:bg-gray-50 rounded-lg p-2.5 transition-all duration-200 group",3,"cursor-pointer","cursor-default","hover:bg-blue-50","click",4,"ngIf"],[1,"space-y-1","overflow-hidden","transition-all","duration-300","ease-in-out"],["routerLinkActive","bg-blue-50 text-blue-700 border-r-2 border-blue-600 shadow-sm",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-lg","hover:bg-gray-50","hover:shadow-sm","transition-all","duration-200","group","relative",3,"routerLink"],["class","mt-6 pt-4 border-t border-gray-100",4,"ngIf"],[1,"flex","items-center","justify-between","mb-3","cursor-pointer","hover:bg-gray-50","rounded-lg","p-2.5","transition-all","duration-200","group",3,"click"],[1,"flex","items-center","gap-2.5"],[1,"text-gray-500","text-[1.5rem]","group-hover:text-blue-600","transition-colors","relative","top-[-7px]"],[1,"text-xs","font-semibold","text-gray-600","uppercase","tracking-wider","group-hover:text-blue-700","transition-colors"],["class","text-gray-400 text-sm transition-all duration-200 group-hover:text-blue-600",3,"rotate-180",4,"ngIf"],[1,"text-gray-400","text-sm","transition-all","duration-200","group-hover:text-blue-600"],["routerLinkActive","bg-blue-50 text-blue-700 border-r-2 border-blue-600 shadow-sm",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-lg","hover:bg-gray-50","hover:shadow-sm","transition-all","duration-200","group","relative",3,"click","routerLink"],[1,"absolute","left-0","top-1/2","transform","-translate-y-1/2","w-1","h-6","bg-blue-600","rounded-r-full","opacity-0","transition-opacity","duration-200"],[1,"text-gray-400","group-hover:text-blue-600","transition-colors","text-lg","ml-1"],[1,"font-medium","text-sm","text-gray-700","group-hover:text-blue-700","transition-colors"],["class","ml-auto",4,"ngIf"],[1,"ml-auto"],[1,"text-yellow-500","text-sm"],[1,"mt-6","pt-4","border-t","border-gray-100"]],template:function(r,a){if(r&1){let o=ue();s(0,"mat-drawer-container",1)(1,"mat-drawer",2,0)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"mat-icon",7),d(8,"account_balance_wallet"),c()(),s(9,"span",8),d(10),ce(11,"translate"),c()(),s(12,"div",5)(13,"button",9),F("click",function(){R(o);let m=bn(2);return B(m.toggle())}),s(14,"mat-icon"),d(15,"home"),c()(),s(16,"button",10),F("click",function(){R(o);let m=bn(2);return B(m.toggle())}),s(17,"mat-icon"),d(18,"close"),c()()()(),s(19,"nav",11),Ge(20,m3,6,10,"div",12,r3),c(),s(22,"div",13)(23,"div",14)(24,"div",15)(25,"mat-icon",16),d(26,"settings"),c(),s(27,"span",17),d(28),ce(29,"translate"),c()(),s(30,"button",18),F("click",function(){return R(o),B(a.logout())}),s(31,"mat-icon",19),d(32,"logout"),c()()()()()(),s(33,"mat-drawer-content",20)(34,"div")(35,"button",21),F("click",function(){R(o);let m=bn(2);return B(m.toggle())}),s(36,"mat-icon",22),d(37,"menu"),c()()()()()}r&2&&(u(),P("mode","over"),u(9),L(xe(11,3,"moneyManager")),u(10),He(a.navigationSections),u(8),L(xe(29,5,"settings")))},dependencies:[dt,s0,V1,gn,Qe,ex,tx,J_,Tn,Z0],styles:[".full-height[_ngcontent-%COMP%]{height:100vh}.color-ball[_ngcontent-%COMP%]{height:3rem;width:3rem;font-size:clamp(2.5rem,6vw,4rem)}"]});let e=i;return e})();var nC=(()=>{let i=class i{constructor(t){this.elementRef=t,this.clickOutside=new _n}onClick(t){this.elementRef.nativeElement.contains(t)||this.clickOutside.emit()}};i.\u0275fac=function(r){return new(r||i)(Y(xo))},i.\u0275dir=bs({type:i,selectors:[["","clickOutside",""]],hostBindings:function(r,a){r&1&&F("click",function(l){return a.onClick(l.target)},!1,Qd)},outputs:{clickOutside:"clickOutside"}});let e=i;return e})();function p3(e,i){if(e&1&&re(0,"img",6),e&2){let n=v();Sa("src",n.user.photoURL,Zd)}}function f3(e,i){if(e&1&&(s(0,"span",7),d(1),ce(2,"titlecase"),c()),e&2){let n=v();u(),L(xe(2,1,n.user.displayName?n.user.displayName:"User"))}}function h3(e,i){if(e&1&&(Ii(),s(0,"svg",8),re(1,"path",9),c()),e&2){let n=v();ze("rotate-180",n.isOpen)}}function _3(e,i){if(e&1){let n=ue();s(0,"div",10)(1,"div",11)(2,"button",12),F("click",function(){R(n);let r=v();return B(r.viewProfile())}),Ii(),s(3,"svg",13),re(4,"path",14)(5,"path",15),c(),na(),s(6,"span"),d(7,"View Profile"),c()(),s(8,"button",12),F("click",function(){R(n);let r=v();return B(r.openSettings())}),Ii(),s(9,"svg",13),re(10,"path",16),c(),na(),s(11,"span"),d(12,"Settings"),c()(),s(13,"button",12),F("click",function(){R(n);let r=v();return B(r.openCacheManager())}),Ii(),s(14,"svg",13),re(15,"path",17),c(),na(),s(16,"span"),d(17,"Cache Management"),c()(),s(18,"button",12),F("click",function(){R(n);let r=v();return B(r.shareApp())}),s(19,"mat-icon",18),d(20,"share"),c(),s(21,"span"),d(22,"Share App"),c()(),s(23,"button",12),F("click",function(){R(n);let r=v();return B(r.openHelp())}),Ii(),s(24,"svg",13),re(25,"path",19),c(),na(),s(26,"span"),d(27,"Help"),c()()(),re(28,"div",20),s(29,"div",11)(30,"button",21),F("click",function(r){R(n);let a=v();return B(a.signOut(r))}),Ii(),s(31,"svg",13),re(32,"path",22),c(),na(),s(33,"span"),d(34,"Sign Out"),c()()()()}e&2&&P("@slideDown",void 0)}var iC=(()=>{let i=class i{constructor(t,r,a,o,l){this.userService=t,this.notificationService=r,this.router=a,this.breakpointObserver=o,this.splitwiseService=l,this.isOpen=!1,this.isMobile=!1,this.user={displayName:"",photoURL:""},this.breakpointObserver.observe(Oc.Handset).subscribe(m=>{this.isMobile=m.matches})}ngOnInit(){this.userService.userAuth$.pipe(tr(1)).subscribe(t=>{this.user={displayName:t==null?void 0:t.displayName,photoURL:t==null?void 0:t.photoURL}})}toggle(t){t&&t.stopPropagation(),console.log("toggling"),this.isOpen=!this.isOpen}close(){this.isOpen=!1}viewProfile(){console.log("View profile clicked"),this.router.navigate(["/dashboard/profile"]),this.close()}openSettings(){console.log("Settings clicked"),this.notificationService.info("Settings feature coming soon"),this.close()}openCacheManager(){console.log("Cache management clicked"),this.notificationService.info("Opening cache management"),this.showCacheManagerDialog(),this.close()}showCacheManagerDialog(){let t=document.createElement("div");t.className="fixed inset-0 z-[9999] bg-black bg-opacity-50 flex items-center justify-center p-4",t.innerHTML=`
      <div class="bg-white rounded-lg shadow-xl max-w-md w-full max-h-[80vh] overflow-y-auto">
        <div class="p-6">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-gray-900">Cache Management</h3>
            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          
          <div class="space-y-4">
            <!-- Clear Cache Button -->
            <button 
              onclick="clearAppCache()"
              class="w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
              </svg>
              <span>Clear Cache</span>
            </button>

            <!-- Force Update Button -->
            <button 
              onclick="forceAppUpdate()"
              class="w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
              </svg>
              <span>Force Update</span>
            </button>

            <!-- App Info -->
            <div class="p-3 bg-gray-50 rounded-lg">
              <h4 class="font-medium text-gray-900 mb-2">App Information</h4>
              <div class="space-y-1">
                <div class="flex justify-between">
                  <span class="text-sm text-gray-600">Version:</span>
                  <span class="text-sm font-medium">${new Date().toISOString().split("T")[0]}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm text-gray-600">Last Updated:</span>
                  <span class="text-sm font-medium">${new Date(localStorage.getItem("app-version")||new Date().toISOString().split("T")[0]).toLocaleDateString()}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    `,window.clearAppCache=()=>me(this,null,function*(){try{if("caches"in window){let r=yield caches.keys();yield Promise.all(r.map(a=>caches.delete(a)))}"indexedDB"in window&&(yield indexedDB.databases()).forEach(a=>{a.name&&indexedDB.deleteDatabase(a.name)}),this.notificationService.success("Cache cleared successfully!"),t.remove()}catch(r){console.error("Failed to clear cache:",r),this.notificationService.error("Failed to clear cache. Please try again.")}}),window.forceAppUpdate=()=>{localStorage.setItem("app-version",new Date().toISOString().split("T")[0]),this.notificationService.info("App update initiated"),window.location.reload()},document.body.appendChild(t),t.addEventListener("click",r=>{r.target===t&&t.remove()})}openHelp(){console.log("Help clicked"),this.notificationService.info("Help feature coming soon"),this.close()}signOut(t){return me(this,null,function*(){console.log("signing out");try{yield this.userService.signOut(),this.notificationService.success("Signed out successfully"),t.stopPropagation(),this.close()}catch(r){console.error("Error signing out:",r),this.notificationService.error("Failed to sign out")}})}shareApp(){this.splitwiseService.sharePWA(),this.close()}};i.\u0275fac=function(r){return new(r||i)(Y(ni),Y(ft),Y(nn),Y(dr),Y(Ec))},i.\u0275cmp=Re({type:i,selectors:[["app-user"]],decls:6,vars:4,consts:[[1,"relative","inline-block",3,"clickOutside"],["type","button",1,"relative","z-10","flex","items-center","p-2","text-sm","text-gray-600","bg-transparent","border","border-transparent","rounded-md","focus:border-blue-500","focus:ring-opacity-40","dark:focus:ring-opacity-40","focus:ring-blue-300","dark:focus:ring-blue-400","focus:ring","dark:text-white","dark:bg-gray-800","focus:outline-none","hover:bg-gray-100","dark:hover:bg-gray-700","transition-colors",3,"click"],["class","flex-shrink-0 object-cover mx-1 rounded-full w-9 h-9 border-2 border-gray-200 dark:border-gray-600","alt","avatar",3,"src",4,"ngIf"],["class","mx-1 truncate max-w-100",4,"ngIf"],["class","w-5 h-5 mx-1 transition-transform duration-200","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",3,"rotate-180",4,"ngIf"],["class","absolute right-0 z-20 w-64 py-2 mt-2 overflow-hidden origin-top-right bg-white rounded-lg shadow-xl dark:bg-gray-800 border border-gray-200 dark:border-gray-700",4,"ngIf"],["alt","avatar",1,"flex-shrink-0","object-cover","mx-1","rounded-full","w-9","h-9","border-2","border-gray-200","dark:border-gray-600",3,"src"],[1,"mx-1","truncate","max-w-100"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"w-5","h-5","mx-1","transition-transform","duration-200"],["d","M12 15.713L18.01 9.70299L16.597 8.28799L12 12.888L7.40399 8.28799L5.98999 9.70199L12 15.713Z","fill","currentColor"],[1,"absolute","right-0","z-20","w-64","py-2","mt-2","overflow-hidden","origin-top-right","bg-white","rounded-lg","shadow-xl","dark:bg-gray-800","border","border-gray-200","dark:border-gray-700"],[1,"py-1"],[1,"flex","items-center","w-full","px-4","py-2","text-sm","text-gray-600","capitalize","transition-colors","duration-200","dark:text-gray-300","hover:bg-gray-100","dark:hover:bg-gray-700","dark:hover:text-white","focus:outline-none","focus:bg-gray-100","dark:focus:bg-gray-700",3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"w-4","h-4","mr-3"],["d","M7 8C7 5.23858 9.23858 3 12 3C14.7614 3 17 5.23858 17 8C17 10.7614 14.7614 13 12 13C9.23858 13 7 10.7614 7 8ZM12 11C13.6569 11 15 9.65685 15 8C15 6.34315 13.6569 5 12 5C10.3431 5 9 6.34315 9 8C9 9.65685 10.3431 11 12 11Z","fill","currentColor"],["d","M6.34315 16.3431C4.84285 17.8434 4 19.8783 4 22H6C6 20.4087 6.63214 18.8826 7.75736 17.7574C8.88258 16.6321 10.4087 16 12 16C13.5913 16 15.1174 16.6321 16.2426 17.7574C17.3679 18.8826 18 20.4087 18 22H20C20 19.8783 19.1571 17.8434 17.6569 16.3431C16.1566 14.8429 14.1217 14 12 14C9.87827 14 7.84344 14.8429 6.34315 16.3431Z","fill","currentColor"],["d","M13.8199 22H10.1799C9.71003 22 9.30347 21.673 9.20292 21.214L8.79592 19.33C8.25297 19.0921 7.73814 18.7946 7.26092 18.443L5.42392 19.028C4.97592 19.1709 4.48891 18.9823 4.25392 18.575L2.42992 15.424C2.19751 15.0165 2.27758 14.5025 2.62292 14.185L4.04792 12.885C3.98312 12.2961 3.98312 11.7019 4.04792 11.113L2.62292 9.816C2.27707 9.49837 2.19697 8.98372 2.42992 8.576L4.24992 5.423C4.48491 5.0157 4.97192 4.82714 5.41992 4.97L7.25692 5.555C7.50098 5.37416 7.75505 5.20722 8.01792 5.055C8.27026 4.91269 8.52995 4.78385 8.79592 4.669L9.20392 2.787C9.30399 2.32797 9.71011 2.00049 10.1799 2H13.8199C14.2897 2.00049 14.6958 2.32797 14.7959 2.787L15.2079 4.67C15.4887 4.79352 15.7622 4.93308 16.0269 5.088C16.2739 5.23081 16.5126 5.38739 16.7419 5.557L18.5799 4.972C19.0276 4.82967 19.514 5.01816 19.7489 5.425L21.5689 8.578C21.8013 8.98548 21.7213 9.49951 21.3759 9.817L19.9509 11.117C20.0157 11.7059 20.0157 12.3001 19.9509 12.889L21.3759 14.189C21.7213 14.5065 21.8013 15.0205 21.5689 15.428L19.7489 18.581C19.514 18.9878 19.0276 19.1763 18.5799 19.034L16.7419 18.449C16.5093 18.6203 16.2677 18.7789 16.0179 18.924C15.7557 19.0759 15.4853 19.2131 15.2079 19.335L14.7959 21.214C14.6954 21.6726 14.2894 21.9996 13.8199 22ZM7.61992 16.229L8.43992 16.829C8.62477 16.9652 8.81743 17.0904 9.01692 17.204C9.20462 17.3127 9.39788 17.4115 9.59592 17.5L10.5289 17.909L10.9859 20H13.0159L13.4729 17.908L14.4059 17.499C14.8132 17.3194 15.1998 17.0961 15.5589 16.833L16.3799 16.233L18.4209 16.883L19.4359 15.125L17.8529 13.682L17.9649 12.67C18.0141 12.2274 18.0141 11.7806 17.9649 11.338L17.8529 10.326L19.4369 8.88L18.4209 7.121L16.3799 7.771L15.5589 7.171C15.1997 6.90671 14.8132 6.68175 14.4059 6.5L13.4729 6.091L13.0159 4H10.9859L10.5269 6.092L9.59592 6.5C9.39772 6.58704 9.20444 6.68486 9.01692 6.793C8.81866 6.90633 8.62701 7.03086 8.44292 7.166L7.62192 7.766L5.58192 7.116L4.56492 8.88L6.14792 10.321L6.03592 11.334C5.98672 11.7766 5.98672 12.2234 6.03592 12.666L6.14792 13.678L4.56492 15.121L5.57992 16.879L7.61992 16.229ZM11.9959 16C9.78678 16 7.99592 14.2091 7.99592 12C7.99592 9.79086 9.78678 8 11.9959 8C14.2051 8 15.9959 9.79086 15.9959 12C15.9932 14.208 14.2039 15.9972 11.9959 16ZM11.9959 10C10.9033 10.0011 10.0138 10.8788 9.99815 11.9713C9.98249 13.0638 10.8465 13.9667 11.9386 13.9991C13.0307 14.0315 13.9468 13.1815 13.9959 12.09V12.49V12C13.9959 10.8954 13.1005 10 11.9959 10Z","fill","currentColor"],["d","M19 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V5C21 3.89543 20.1046 3 19 3ZM19 19H5V5H19V19ZM17 13H7V11H17V13ZM13 17H7V15H13V17ZM7 9V7H17V9H7Z","fill","currentColor"],[1,"text-sm","mr-1"],["d","M12 22C6.47967 21.9939 2.00606 17.5203 2 12V11.8C2.10993 6.30452 6.63459 1.92794 12.1307 2.00087C17.6268 2.07379 22.0337 6.56887 21.9978 12.0653C21.9619 17.5618 17.4966 21.9989 12 22ZM11.984 20H12C16.4167 19.9956 19.9942 16.4127 19.992 11.996C19.9898 7.57928 16.4087 3.99999 11.992 3.99999C7.57528 3.99999 3.99421 7.57928 3.992 11.996C3.98979 16.4127 7.56729 19.9956 11.984 20ZM13 18H11V16H13V18ZM13 15H11C10.9684 13.6977 11.6461 12.4808 12.77 11.822C13.43 11.316 14 10.88 14 9.99999C14 8.89542 13.1046 7.99999 12 7.99999C10.8954 7.99999 10 8.89542 10 9.99999H8V9.90999C8.01608 8.48093 8.79333 7.16899 10.039 6.46839C11.2846 5.76778 12.8094 5.78493 14.039 6.51339C15.2685 7.24184 16.0161 8.57093 16 9.99999C15.9284 11.079 15.3497 12.0602 14.44 12.645C13.6177 13.1612 13.0847 14.0328 13 15Z","fill","currentColor"],[1,"border-t","border-gray-100","dark:border-gray-700","my-1"],[1,"flex","items-center","w-full","px-4","py-2","text-sm","text-red-600","capitalize","transition-colors","duration-200","dark:text-red-400","hover:bg-red-50","dark:hover:bg-red-900/20","focus:outline-none","focus:bg-red-50","dark:focus:bg-red-900/20",3,"click"],["d","M19 21H10C8.89543 21 8 20.1046 8 19V15H10V19H19V5H10V9H8V5C8 3.89543 8.89543 3 10 3H19C20.1046 3 21 3.89543 21 5V19C21 20.1046 20.1046 21 19 21ZM12 16V13H3V11H12V8L17 12L12 16Z","fill","currentColor"]],template:function(r,a){r&1&&(s(0,"div",0),F("clickOutside",function(){return a.close()}),s(1,"button",1),F("click",function(l){return a.toggle(l)}),N(2,p3,1,1,"img",2)(3,f3,3,3,"span",3)(4,h3,2,2,"svg",4),c(),N(5,_3,35,1,"div",5),c()),r&2&&(u(2),P("ngIf",a.user==null?null:a.user.photoURL),u(),P("ngIf",!a.isMobile||!(a.user!=null&&a.user.photoURL)),u(),P("ngIf",!a.isMobile),u(),P("ngIf",a.isOpen))},dependencies:[dt,Qe,nC,sr],data:{animation:[K0("slideDown",[kc("void",Sc({opacity:0,transform:"translateY(-10px) scale(0.95)"})),kc("*",Sc({opacity:1,transform:"translateY(0) scale(1)"})),Tc("void => *",[wc("200ms ease-out")]),Tc("* => void",[wc("150ms ease-in")])])]}});let e=i;return e})();var rC=(()=>{let i=class i{};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=Re({type:i,selectors:[["app-header"]],decls:3,vars:0,consts:[[1,"header","flex","justify-between","p-2"]],template:function(r,a){r&1&&(s(0,"header",0),re(1,"side-bar")(2,"app-user"),c())},dependencies:[tC,iC]});let e=i;return e})();var Wu=Yr(Xr());function v3(e,i){if(e&1){let n=ue();s(0,"mat-list-item",7),F("click",function(){let r=R(n).$implicit,a=v();return B(a.selectCategory(r))}),s(1,"div",8)(2,"div",9)(3,"mat-icon",10),d(4),c()(),s(5,"div",11)(6,"span",12),d(7),c(),s(8,"span",13),d(9),ce(10,"titlecase"),c()(),s(11,"mat-icon",14),d(12,"arrow_forward_ios"),c()()()}if(e&2){let n=i.$implicit,t=v();ze("selected",t.selectedCategory===n),u(3),wt("color",n.color),u(),ne(" ",n.icon," "),u(3),L(n.name),u(2),L(xe(10,7,n.type))}}function b3(e,i){e&1&&(s(0,"div",15)(1,"mat-icon",16),d(2,"category"),c(),s(3,"p"),d(4,"No categories available"),c()())}var Xm=(()=>{let i=class i{constructor(t,r){this.dialogRef=t,this.data=r,this.selectedCategory=null}ngOnInit(){}selectCategory(t){this.selectedCategory=t,this.dialogRef.close(t)}onCancel(){this.dialogRef.close(null)}trackByCategory(t,r){return r.id||t.toString()}};i.\u0275fac=function(r){return new(r||i)(Y(Mi),Y(Pi))},i.\u0275cmp=Re({type:i,selectors:[["app-parent-category-selector-dialog"]],decls:9,vars:6,consts:[[3,"closeButtonClick","title","showCloseButton"],[1,"dialog-message"],[1,"categories-container"],[1,"categories-list"],[1,"category-list"],["class","category-item",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","no-categories",4,"ngIf"],[1,"category-item",3,"click"],[1,"category-info"],[1,"category-icon-wrapper"],[1,"category-icon"],[1,"category-details"],[1,"category-name"],[1,"category-type"],[1,"select-icon"],[1,"no-categories"],[1,"no-categories-icon"]],template:function(r,a){r&1&&(s(0,"app-common-header",0),F("closeButtonClick",function(){return a.onCancel()}),c(),s(1,"app-common-body-content")(2,"p",1),d(3),c(),s(4,"div",2)(5,"div",3)(6,"mat-list",4),N(7,v3,13,9,"mat-list-item",5),c()(),N(8,b3,5,0,"div",6),c()()),r&2&&(P("title",a.data.title)("showCloseButton",!0),u(3),L(a.data.message),u(4),P("ngForOf",a.data.categories)("ngForTrackBy",a.trackByCategory),u(),P("ngIf",(a.data==null||a.data.categories==null?null:a.data.categories.length)===0))},dependencies:[or,dt,nx,ix,Qe,Ko,Zo,sr],styles:[".parent-category-dialog[_ngcontent-%COMP%]{min-width:320px;max-width:90vw;width:100%;border-radius:12px;overflow:hidden;box-shadow:0 4px 20px #0000001a}@media (max-width: 599px){.parent-category-dialog[_ngcontent-%COMP%]{min-width:280px;max-width:95vw}}@media (min-width: 600px) and (max-width: 959px){.parent-category-dialog[_ngcontent-%COMP%]{min-width:400px;max-width:500px}}@media (min-width: 960px){.parent-category-dialog[_ngcontent-%COMP%]{min-width:450px;max-width:550px}}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px 16px;border-bottom:1px solid #e0e0e0;background:linear-gradient(135deg,#f8f9fa,#fff)}@media (max-width: 599px){.dialog-header[_ngcontent-%COMP%]{padding:16px 20px 12px}}.dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:#333}@media (max-width: 599px){.dialog-title[_ngcontent-%COMP%]{font-size:1.25rem}}.close-button[_ngcontent-%COMP%]{color:#666;transition:all .2s ease}.close-button[_ngcontent-%COMP%]:hover{color:#333;background-color:#0000000a;transform:scale(1.1)}.close-button[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 2px #1976d233}.dialog-content[_ngcontent-%COMP%]{padding:20px 24px}@media (max-width: 599px){.dialog-content[_ngcontent-%COMP%]{padding:16px 20px}}.dialog-message[_ngcontent-%COMP%]{margin:0 0 20px;color:#666;font-size:.95rem;line-height:1.5}@media (max-width: 599px){.dialog-message[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:16px}}.categories-container[_ngcontent-%COMP%]{position:relative}.categories-list[_ngcontent-%COMP%]{max-height:350px;overflow-y:auto}@media (max-width: 599px){.categories-list[_ngcontent-%COMP%]{max-height:300px}}.categories-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.categories-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.categories-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.categories-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.category-list[_ngcontent-%COMP%]{padding:0}.category-item[_ngcontent-%COMP%]{cursor:pointer;border-radius:12px;margin-bottom:8px;transition:all .2s ease;border:1px solid transparent}.category-item[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;border-color:#e9ecef;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.category-item.selected[_ngcontent-%COMP%]{background-color:#1976d214;border-color:#1976d2}.category-item.selected[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{color:#1976d2;font-weight:600}.category-item.selected[_ngcontent-%COMP%]   .select-icon[_ngcontent-%COMP%]{color:#1976d2;transform:translate(2px)}.category-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}@media (max-width: 599px){.category-item[_ngcontent-%COMP%]{margin-bottom:6px}}.category-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;width:100%;padding:4px 0}@media (max-width: 599px){.category-info[_ngcontent-%COMP%]{gap:12px}}.category-icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;background-color:#0000000a;flex-shrink:0}@media (max-width: 599px){.category-icon-wrapper[_ngcontent-%COMP%]{width:36px;height:36px}}.category-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}@media (max-width: 599px){.category-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}}.category-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;min-width:0}.category-name[_ngcontent-%COMP%]{font-weight:500;font-size:1rem;color:#333;margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width: 599px){.category-name[_ngcontent-%COMP%]{font-size:.95rem}}.category-type[_ngcontent-%COMP%]{color:#666;font-size:.8rem;text-transform:uppercase;letter-spacing:.5px;font-weight:500}@media (max-width: 599px){.category-type[_ngcontent-%COMP%]{font-size:.75rem}}.select-icon[_ngcontent-%COMP%]{color:#ccc;font-size:16px;transition:all .2s ease;flex-shrink:0}@media (max-width: 599px){.select-icon[_ngcontent-%COMP%]{font-size:14px}}.no-categories[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;text-align:center;color:#666}@media (max-width: 599px){.no-categories[_ngcontent-%COMP%]{padding:30px 16px}}.no-categories-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;opacity:.5}@media (max-width: 599px){.no-categories-icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px;margin-bottom:12px}}.no-categories[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1rem}@media (max-width: 599px){.no-categories[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem}}.dialog-actions[_ngcontent-%COMP%]{padding:16px 24px 20px;justify-content:flex-end;border-top:1px solid #e0e0e0;background-color:#fafafa}@media (max-width: 599px){.dialog-actions[_ngcontent-%COMP%]{padding:12px 20px 16px}}.cancel-button[_ngcontent-%COMP%]{min-width:80px;font-weight:500;border-radius:6px;transition:all .2s ease}.cancel-button[_ngcontent-%COMP%]:hover{background-color:#0000000a}@media (max-width: 599px){.cancel-button[_ngcontent-%COMP%]{min-width:70px;font-size:.9rem}}"]});let e=i;return e})();var Za=(()=>{let i=class i{constructor(t,r,a,o,l){this.firestore=t,this.store=r,this.dialog=a,this.notificationService=o,this.hapticFeedback=l,this.categories={},this.store.select(un).subscribe(m=>{m.forEach(g=>{g.id&&(this.categories[g.id]=g)})})}getUserCategoriesCollection(t){return Gr(this.firestore,`users/${t}/categories`)}getCategories(t){let r=this.getUserCategoriesCollection(t);return new tn(a=>{Va(r).then(o=>{let l=[];o.forEach(m=>{let g=m.data(),f={id:m.id,name:g==null?void 0:g.name,type:g==null?void 0:g.type,icon:(g==null?void 0:g.icon)||"category",color:(g==null?void 0:g.color)||"#46777f",createdAt:g==null?void 0:g.createdAt,budget:(g==null?void 0:g.budget)||null,parentCategoryId:(g==null?void 0:g.parentCategoryId)||null,isSubCategory:(g==null?void 0:g.isSubCategory)||!1,subCategories:(g==null?void 0:g.subCategories)||[]};l.push(f)}),a.next(l),a.complete()}).catch(o=>{a.error(o)})})}createCategory(t,r,a,o,l){return new tn(m=>{let g=this.generateCategoryId(),f=Dt(this.firestore,`users/${t}/categories/${g}`);Rr(f,{name:r,type:a,icon:o,color:l,createdAt:Date.now()}).then(()=>{m.next(g),m.complete()}).catch(h=>{m.error(h)})})}updateCategory(t,r,a,o,l,m,g,f,h){return new tn(x=>{let C=Dt(this.firestore,`users/${t}/categories/${r}`);di(C).then(y=>{if(y.exists()){let b=y.data(),w={name:a,type:o,icon:l,color:m};if(g&&(w.budget=g),f!==void 0)if(f==null){if(b.parentCategoryId){let A=this.categories[b.parentCategoryId];if(A&&A.subCategories){let E=A.subCategories.filter(I=>I!==r);Fn(Dt(this.firestore,`users/${t}/categories/${b.parentCategoryId}`),{subCategories:E})}}w.parentCategoryId=H0()}else{if(b.parentCategoryId&&b.parentCategoryId!==f){let E=this.categories[b.parentCategoryId];if(E&&E.subCategories){let I=E.subCategories.filter(K=>K!==r);Fn(Dt(this.firestore,`users/${t}/categories/${b.parentCategoryId}`),{subCategories:I})}}let A=this.categories[f];if(A){let E=[...A.subCategories||[],r];Fn(Dt(this.firestore,`users/${t}/categories/${f}`),{subCategories:E})}w.parentCategoryId=f}h!==void 0&&(w.isSubCategory=h),Fn(C,w).then(()=>{x.next(),x.complete()}).catch(A=>{x.error(A)})}else x.error(new Error("Category not found"))}).catch(y=>{x.error(y)})})}deleteCategory(t,r){return new tn(a=>{let o=Dt(this.firestore,`users/${t}/categories/${r}`);di(o).then(l=>{if(l.exists()){let m=l.data();if(m.isSubCategory&&m.parentCategoryId){let g=this.categories[m.parentCategoryId];if(g&&g.subCategories){let f=g.subCategories.filter(h=>h!==r);Fn(Dt(this.firestore,`users/${t}/categories/${m.parentCategoryId}`),{subCategories:f}).then(()=>{zi(o).then(()=>{a.next(),a.complete()}).catch(h=>{a.error(h)})}).catch(h=>{a.error(h)})}else zi(o).then(()=>{a.next(),a.complete()}).catch(f=>{a.error(f)})}else if(m.subCategories&&m.subCategories.length>0){let g=m.subCategories.map(f=>zi(Dt(this.firestore,`users/${t}/categories/${f}`)));Promise.all(g).then(()=>{zi(o).then(()=>{a.next(),a.complete()}).catch(f=>{a.error(f)})}).catch(f=>{a.error(f)})}else zi(o).then(()=>{a.next(),a.complete()}).catch(g=>{a.error(g)})}else a.next(),a.complete()}).catch(l=>{a.error(l)})})}getCategoryNameById(t){var r;return((r=this.categories[t])==null?void 0:r.name)||""}removeFromParentCategory(t,r){return new tn(a=>{let o=Dt(this.firestore,`users/${t}/categories/${r}`);di(o).then(l=>{if(l.exists()){let m=l.data();if(m.parentCategoryId){let g=this.categories[m.parentCategoryId];if(g&&g.subCategories){let f=g.subCategories.filter(h=>h!==r);Fn(Dt(this.firestore,`users/${t}/categories/${m.parentCategoryId}`),{subCategories:f}).then(()=>{Fn(o,{parentCategoryId:H0(),isSubCategory:!1}).then(()=>{a.next(),a.complete()}).catch(h=>{a.error(h)})}).catch(h=>{a.error(h)})}else Fn(o,{parentCategoryId:H0(),isSubCategory:!1}).then(()=>{a.next(),a.complete()}).catch(f=>{a.error(f)})}else a.next(),a.complete()}else a.error(new Error("Category not found"))}).catch(l=>{a.error(l)})})}getCategoryWithSubCategories(t,r){return new tn(a=>{this.getCategories(t).subscribe(o=>{a.next(o.find(l=>l.id===r)||null),a.complete()},o=>{a.error(o)})})}hasSubCategories(t){let r=this.categories[t];return(r==null?void 0:r.subCategories)&&r.subCategories.length>0||!1}getSubCategoriesCount(t){var a;let r=this.categories[t];return((a=r==null?void 0:r.subCategories)==null?void 0:a.length)||0}openParentCategorySelectorDialog(t){return new tn(r=>{try{let o=Object.values(this.categories).filter(m=>m.id!==t.id&&!m.isSubCategory&&!m.parentCategoryId);this.dialog.open(Xm,{width:"500px",maxWidth:"90vw",data:{title:"Select Parent Category",message:`Select a parent category for "${t.name}"`,categories:o},disableClose:!1}).afterClosed().subscribe(m=>{r.next(m),r.complete()})}catch(a){console.error("Error opening parent category selector dialog:",a),r.error(a)}})}generateCategoryId(){return"cat_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}performDelete(t,r){this.dialog.open(Hr,{width:"400px",data:{title:"Delete Category",message:`Are you sure you want to delete "${t.name}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",confirmColor:"warn"}}).afterClosed().subscribe(o=>{if(o){if(!t.id){this.notificationService.error("Category ID not found");return}this.store.dispatch(Cc({userId:r,categoryId:t.id})),this.notificationService.success("Category deleted successfully"),this.hapticFeedback.successVibration()}})}};i.\u0275fac=function(r){return new(r||i)(De(cr),De(pt),De(xn),De(ft),De(mr))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var Gu=(e,i)=>i.value;function y3(e,i){e&1&&(s(0,"p",6),d(1,"Account name is required"),c())}function M3(e,i){e&1&&(s(0,"p",6),d(1,"Account name must be less than 50 characters"),c())}function P3(e,i){if(e&1&&(s(0,"mat-option",10),d(1),c()),e&2){let n=i.$implicit;P("value",n.value),u(),L(n.label)}}function O3(e,i){e&1&&(s(0,"mat-error"),d(1,"Account type is required"),c())}function w3(e,i){if(e&1&&(s(0,"p",12),d(1),c()),e&2){let n=v();u(),L(n.getBalanceError())}}function S3(e,i){e&1&&(s(0,"p",12),d(1,"Lender name is required"),c())}function k3(e,i){if(e&1&&(s(0,"p",12),d(1),c()),e&2){let n=v(2);u(),L(n.getLoanAmountError())}}function T3(e,i){if(e&1&&(s(0,"p",12),d(1),c()),e&2){let n=v(2);u(),L(n.getInterestRateError())}}function E3(e,i){if(e&1&&(s(0,"p",12),d(1),c()),e&2){let n=v(2);u(),L(n.getDurationError())}}function I3(e,i){if(e&1&&(s(0,"div",38)(1,"span",39),d(2),ce(3,"currency"),c(),s(4,"mat-icon",17),d(5,"calculate"),c()(),s(6,"p",33),d(7," Calculated using loan amortization formula "),c()),e&2){let n=v(2);u(2),ne(" ",xe(3,1,n.getCalculatedMonthlyPayment())," ")}}function A3(e,i){e&1&&(re(0,"input",40),s(1,"p",33),d(2," Enter your actual monthly payment amount "),c())}function D3(e,i){if(e&1&&(s(0,"mat-option",10),d(1),c()),e&2){let n=i.$implicit;P("value",n.value),u(),L(n.label)}}function F3(e,i){if(e&1&&(s(0,"mat-option",10),d(1),c()),e&2){let n=i.$implicit;P("value",n.value),u(),L(n.label)}}function R3(e,i){if(e&1){let n=ue();s(0,"div",13)(1,"h4",16)(2,"mat-icon",17),d(3,"account_balance_wallet"),c(),d(4," Loan Details "),c(),s(5,"div",18)(6,"label",3),d(7," Lender Name * "),c(),re(8,"input",19),N(9,S3,2,0,"p",12),c(),s(10,"div",18)(11,"label",3),d(12," Loan Amount * "),c(),re(13,"input",20),N(14,k3,2,1,"p",12),c(),s(15,"div",18)(16,"label",3),d(17," Annual Interest Rate (%) * "),c(),re(18,"input",21),N(19,T3,2,1,"p",12),c(),s(20,"div",18)(21,"label",3),d(22," Loan Start Date * "),c(),re(23,"input",22),c(),s(24,"div",18)(25,"label",3),d(26," Loan Duration (months) * "),c(),re(27,"input",23),N(28,E3,2,1,"p",12),c(),s(29,"div",18)(30,"label",3),d(31," Monthly Payment Amount "),c(),s(32,"div",24)(33,"label",25),re(34,"input",26),s(35,"span",27),d(36," Use calculated payment amount "),c()()(),N(37,I3,8,3)(38,A3,3,0),c(),s(39,"div",18)(40,"label",3),d(41," Repayment Frequency * "),c(),s(42,"mat-form-field",8)(43,"mat-label"),d(44,"Select frequency"),c(),s(45,"mat-select",28),Ge(46,D3,2,2,"mat-option",10,Gu),c()()(),s(48,"div",18)(49,"label",3),d(50," Loan Status * "),c(),s(51,"mat-form-field",8)(52,"mat-label"),d(53,"Select status"),c(),s(54,"mat-select",29),Ge(55,F3,2,2,"mat-option",10,Gu),c()()(),s(57,"div",18)(58,"label",3),d(59," Calculated Remaining Balance "),c(),s(60,"div",30),re(61,"input",31),s(62,"button",32),F("click",function(){R(n);let r=v();return B(r.updateRemainingBalance())}),d(63," Recalculate "),c()(),s(64,"p",33),d(65," Automatically calculated based on time elapsed since loan start date "),c()(),s(66,"div",18)(67,"label",3),d(68," Next Payment Due Date * "),c(),re(69,"input",34),c(),s(70,"div",18)(71,"label",25),re(72,"input",35),s(73,"span",27),d(74," Show payment reminders "),c()()(),s(75,"div",18)(76,"label",25),re(77,"input",36),s(78,"span",27),d(79," Create recurring transaction for loan payments "),c()(),s(80,"p",37),d(81," Automatically creates a recurring transaction for monthly loan payments "),c()()()}if(e&2){let n,t,r,a=v();u(9),we((n=a.accountForm.get("lenderName"))!=null&&n.hasError("required")&&((n=a.accountForm.get("lenderName"))!=null&&n.touched)?9:-1),u(5),we(a.getLoanAmountError()?14:-1),u(5),we(a.getInterestRateError()?19:-1),u(9),we(a.getDurationError()?28:-1),u(9),we((t=a.accountForm.get("useCalculatedPayment"))!=null&&t.value?37:-1),u(),we((r=a.accountForm.get("useCalculatedPayment"))!=null&&r.value?-1:38),u(8),He(a.repaymentFrequencies),u(9),He(a.loanStatuses)}}function B3(e,i){e&1&&(s(0,"p",12),d(1,"Due date is required"),c())}function N3(e,i){e&1&&(s(0,"p",12),d(1,"Due date must be between 1 and 31"),c())}function L3(e,i){e&1&&(s(0,"p",12),d(1,"Billing cycle start is required"),c())}function V3(e,i){e&1&&(s(0,"p",12),d(1,"Billing cycle start must be between 1 and 31"),c())}function U3(e,i){if(e&1&&(s(0,"div",14)(1,"h4",41)(2,"mat-icon",42),d(3,"credit_card"),c(),d(4," Credit Card Details "),c(),s(5,"div",18)(6,"label",3),d(7," Payment Due Date (Day of Month) * "),c(),re(8,"input",43),N(9,B3,2,0,"p",12)(10,N3,2,0,"p",12),c(),s(11,"div",18)(12,"label",3),d(13," Billing Cycle Start (Day of Month) * "),c(),re(14,"input",44),N(15,L3,2,0,"p",12)(16,V3,2,0,"p",12),c(),s(17,"div",18)(18,"label",3),d(19," Credit Limit "),c(),re(20,"input",45),s(21,"p",33),d(22," Optional: Set your credit limit for tracking "),c()(),s(23,"div",18)(24,"label",3),d(25," Minimum Payment "),c(),re(26,"input",46),s(27,"p",33),d(28," Optional: Set your typical minimum payment amount "),c()(),s(29,"div",18)(30,"label",25),re(31,"input",47),s(32,"span",27),d(33," Show payment reminders "),c()()()()),e&2){let n,t,r,a,o=v();u(9),we((n=o.accountForm.get("dueDate"))!=null&&n.hasError("required")&&((n=o.accountForm.get("dueDate"))!=null&&n.touched)?9:-1),u(),we((t=o.accountForm.get("dueDate"))!=null&&t.hasError("min")||(t=o.accountForm.get("dueDate"))!=null&&t.hasError("max")?10:-1),u(5),we((r=o.accountForm.get("billingCycleStart"))!=null&&r.hasError("required")&&((r=o.accountForm.get("billingCycleStart"))!=null&&r.touched)?15:-1),u(),we((a=o.accountForm.get("billingCycleStart"))!=null&&a.hasError("min")||(a=o.accountForm.get("billingCycleStart"))!=null&&a.hasError("max")?16:-1)}}var Wl=(()=>{let i=class i{constructor(t,r,a,o,l,m,g,f,h,x,C){var y,b,w,A,E,I,K,Z,k,S,V;this.dialogData=t,this.fb=r,this.dialogRef=a,this.auth=o,this.notificationService=l,this.hapticFeedback=m,this.validationService=g,this.store=f,this.transactionsService=h,this.categoryService=x,this.accountsService=C,this.isSubmitting=!1,this.accountTypes=[{value:lr.BANK,label:"Bank Account (Checking/Savings)"},{value:lr.CASH,label:"Cash"},{value:lr.CREDIT,label:"Credit Card"},{value:lr.LOAN,label:"Loan"},{value:lr.INVESTMENT,label:"Investment"}],this.repaymentFrequencies=[{value:"monthly",label:"Monthly"},{value:"weekly",label:"Weekly"}],this.loanStatuses=[{value:"active",label:"Active"},{value:"closed",label:"Closed"},{value:"defaulted",label:"Defaulted"}],this.accountForm=this.fb.group({name:["",this.validationService.getAccountNameValidators()],type:["bank",tt.required],balance:[0,this.validationService.getAccountBalanceValidators()],description:[""],lenderName:[""],loanAmount:[0,this.validationService.getLoanAmountValidators()],interestRate:[0,this.validationService.getInterestRateValidators()],startDate:[new Date],durationMonths:[12,this.validationService.getDurationMonthsValidators()],repaymentFrequency:["monthly"],status:["active"],remainingBalance:[0,[tt.min(0)]],nextDueDate:[new Date],showReminder:[!0],useCalculatedPayment:[!0],customMonthlyPayment:[0,[tt.min(0)]],createRecurringTransaction:[!0],dueDate:[15,[tt.required,tt.min(1),tt.max(31)]],billingCycleStart:[1,[tt.required,tt.min(1),tt.max(31)]],creditLimit:[0,[tt.min(0)]],minimumPayment:[0,[tt.min(0)]],creditCardShowReminder:[!0]}),this.dialogData&&(this.accountForm.patchValue(oe(oe({name:this.dialogData.name,type:this.dialogData.type,balance:this.dialogData.balance||0,description:this.dialogData.description},this.dialogData.loanDetails&&{lenderName:this.dialogData.loanDetails.lenderName,loanAmount:this.dialogData.loanDetails.loanAmount,interestRate:this.dialogData.loanDetails.interestRate,startDate:this.dialogData.loanDetails.startDate,durationMonths:this.dialogData.loanDetails.durationMonths,repaymentFrequency:this.dialogData.loanDetails.repaymentFrequency,status:this.dialogData.loanDetails.status,remainingBalance:this.dialogData.loanDetails.remainingBalance,nextDueDate:this.dialogData.loanDetails.nextDueDate,showReminder:this.dialogData.loanDetails.showReminder,useCalculatedPayment:!0,customMonthlyPayment:this.dialogData.loanDetails.monthlyPayment||0,createRecurringTransaction:!0}),this.dialogData.creditCardDetails&&{dueDate:this.dialogData.creditCardDetails.dueDate,billingCycleStart:this.dialogData.creditCardDetails.billingCycleStart,creditLimit:this.dialogData.creditCardDetails.creditLimit,minimumPayment:this.dialogData.creditCardDetails.minimumPayment,creditCardShowReminder:this.dialogData.creditCardDetails.showReminder})),setTimeout(()=>{this.updateRemainingBalance()},100),(y=this.accountForm.get("loanAmount"))==null||y.valueChanges.subscribe(W=>{var Q;((Q=this.accountForm.get("type"))==null?void 0:Q.value)==="loan"&&this.accountForm.patchValue({balance:-W},{emitEvent:!1})}),(b=this.accountForm.get("type"))==null||b.valueChanges.subscribe(W=>{let Q=this.accountForm.get("lenderName"),se=this.accountForm.get("loanAmount"),ae=this.accountForm.get("interestRate"),ke=this.accountForm.get("durationMonths"),Ne=this.accountForm.get("nextDueDate"),Ce=this.accountForm.get("dueDate"),Ve=this.accountForm.get("billingCycleStart"),Oe=this.accountForm.get("creditLimit"),Ze=this.accountForm.get("minimumPayment");W==="loan"?(Q==null||Q.setValidators([tt.required]),se==null||se.setValidators([tt.required,...this.validationService.getLoanAmountValidators()]),ae==null||ae.setValidators([tt.required,...this.validationService.getInterestRateValidators()]),ke==null||ke.setValidators([tt.required,...this.validationService.getDurationMonthsValidators()]),Ne==null||Ne.setValidators([tt.required]),Ce==null||Ce.clearValidators(),Ve==null||Ve.clearValidators(),Oe==null||Oe.clearValidators(),Ze==null||Ze.clearValidators()):W==="credit"?(Q==null||Q.clearValidators(),se==null||se.clearValidators(),ae==null||ae.clearValidators(),ke==null||ke.clearValidators(),Ne==null||Ne.clearValidators(),Ce==null||Ce.setValidators([tt.required,tt.min(1),tt.max(31)]),Ve==null||Ve.setValidators([tt.required,tt.min(1),tt.max(31)]),Oe==null||Oe.setValidators([tt.min(0)]),Ze==null||Ze.setValidators([tt.min(0)])):(Q==null||Q.clearValidators(),se==null||se.clearValidators(),ae==null||ae.clearValidators(),ke==null||ke.clearValidators(),Ne==null||Ne.clearValidators(),Ce==null||Ce.clearValidators(),Ve==null||Ve.clearValidators(),Oe==null||Oe.clearValidators(),Ze==null||Ze.clearValidators()),Q==null||Q.updateValueAndValidity(),se==null||se.updateValueAndValidity(),ae==null||ae.updateValueAndValidity(),ke==null||ke.updateValueAndValidity(),Ne==null||Ne.updateValueAndValidity(),Ce==null||Ce.updateValueAndValidity(),Ve==null||Ve.updateValueAndValidity(),Oe==null||Oe.updateValueAndValidity(),Ze==null||Ze.updateValueAndValidity()}),(w=this.accountForm.get("loanAmount"))==null||w.valueChanges.subscribe(()=>{this.updateRemainingBalance()}),(A=this.accountForm.get("startDate"))==null||A.valueChanges.subscribe(()=>{this.updateRemainingBalance()}),(E=this.accountForm.get("interestRate"))==null||E.valueChanges.subscribe(()=>{this.updateRemainingBalance()}),(I=this.accountForm.get("durationMonths"))==null||I.valueChanges.subscribe(()=>{this.updateRemainingBalance()}),(K=this.accountForm.get("repaymentFrequency"))==null||K.valueChanges.subscribe(()=>{this.updateRemainingBalance()}),(Z=this.accountForm.get("useCalculatedPayment"))==null||Z.valueChanges.subscribe(W=>{if(W){let Q=this.getCalculatedMonthlyPayment();this.accountForm.patchValue({customMonthlyPayment:Q},{emitEvent:!1})}}),(k=this.accountForm.get("loanAmount"))==null||k.valueChanges.subscribe(()=>{var W;if((W=this.accountForm.get("useCalculatedPayment"))!=null&&W.value){let Q=this.getCalculatedMonthlyPayment();this.accountForm.patchValue({customMonthlyPayment:Q},{emitEvent:!1})}}),(S=this.accountForm.get("interestRate"))==null||S.valueChanges.subscribe(()=>{var W;if((W=this.accountForm.get("useCalculatedPayment"))!=null&&W.value){let Q=this.getCalculatedMonthlyPayment();this.accountForm.patchValue({customMonthlyPayment:Q},{emitEvent:!1})}}),(V=this.accountForm.get("durationMonths"))==null||V.valueChanges.subscribe(()=>{var W;if((W=this.accountForm.get("useCalculatedPayment"))!=null&&W.value){let Q=this.getCalculatedMonthlyPayment();this.accountForm.patchValue({customMonthlyPayment:Q},{emitEvent:!1})}}))}ngOnInit(){var t,r;this.userId=(t=this.auth.currentUser)==null?void 0:t.uid,!this.dialogData&&((r=this.accountForm.get("type"))==null?void 0:r.value)==="loan"&&this.updateRemainingBalance()}onSubmit(){return me(this,null,function*(){var t,r,a;if(this.accountForm.valid&&!this.isSubmitting){this.isSubmitting=!0;try{let o=this.accountForm.value,l=o.type==="loan",m={name:o.name.trim(),type:o.type,balance:Number(o.balance)||0,description:o.description||""};if(l&&(m.loanDetails={lenderName:o.lenderName.trim(),loanAmount:Number(o.loanAmount)||0,interestRate:Number(o.interestRate)||0,startDate:o.startDate,durationMonths:Number(o.durationMonths)||12,repaymentFrequency:o.repaymentFrequency,status:o.status,remainingBalance:Number(o.remainingBalance)+this.getCalculatedMonthlyPayment()||0,nextDueDate:o.nextDueDate,showReminder:o.showReminder}),o.type==="credit"&&(m.creditCardDetails={dueDate:Number(o.dueDate)||15,billingCycleStart:Number(o.billingCycleStart)||1,creditLimit:Number(o.creditLimit)||0,minimumPayment:Number(o.minimumPayment)||0,showReminder:o.creditCardShowReminder}),(t=this.dialogData)!=null&&t.accountId)yield this.accountsService.updateAccount(this.userId,this.dialogData.accountId,m).toPromise(),this.notificationService.success("Account updated successfully");else{let g=yield this.accountsService.createAccount(this.userId,m).toPromise();l&&m.loanDetails&&((r=this.accountForm.get("createRecurringTransaction"))!=null&&r.value)&&g&&this.createLoanPaymentRecurringTransactionAfterAccountCreation(m,g),l&&((a=this.accountForm.get("createRecurringTransaction"))!=null&&a.value)?this.notificationService.success("Loan account created successfully! A recurring transaction for loan payments has been set up."):l?this.notificationService.success("Loan account created successfully!"):this.notificationService.success("Account added successfully"),this.hapticFeedback.successVibration()}this.dialogRef.close(!0)}catch(o){this.notificationService.error("Failed to save account"),console.error("Error saving account:",o)}finally{this.isSubmitting=!1}}})}onClose(){this.dialogRef.close()}getNameError(){let t=this.accountForm.get("name");return t?this.validationService.getAccountNameError(t):""}getBalanceError(){let t=this.accountForm.get("balance");return t?this.validationService.getAccountBalanceError(t):""}isLoanAccount(){var t;return((t=this.accountForm.get("type"))==null?void 0:t.value)==="loan"}isCreditCardAccount(){var t;return((t=this.accountForm.get("type"))==null?void 0:t.value)==="credit"}getLoanAmountError(){let t=this.accountForm.get("loanAmount");return t?this.validationService.getLoanAmountError(t):""}getInterestRateError(){let t=this.accountForm.get("interestRate");return t?this.validationService.getInterestRateError(t):""}getDurationError(){let t=this.accountForm.get("durationMonths");return t?this.validationService.getDurationError(t):""}getCalculatedMonthlyPayment(){var l,m,g,f,h;if(!this.isLoanAccount())return 0;if(!((l=this.accountForm.get("useCalculatedPayment"))==null?void 0:l.value))return((m=this.accountForm.get("customMonthlyPayment"))==null?void 0:m.value)||0;let r=((g=this.accountForm.get("loanAmount"))==null?void 0:g.value)||0,a=((f=this.accountForm.get("interestRate"))==null?void 0:f.value)||0,o=((h=this.accountForm.get("durationMonths"))==null?void 0:h.value)||12;return this.calculateMonthlyPayment(r,a,o)}getCurrentRemainingBalance(){var t;return((t=this.accountForm.get("remainingBalance"))==null?void 0:t.value)||0}updateRemainingBalance(){var m,g,f,h;if(!this.isLoanAccount())return;let t=((m=this.accountForm.get("loanAmount"))==null?void 0:m.value)||0,r=(g=this.accountForm.get("startDate"))==null?void 0:g.value,a=((f=this.accountForm.get("durationMonths"))==null?void 0:f.value)||12,o=((h=this.accountForm.get("repaymentFrequency"))==null?void 0:h.value)||"monthly";if(console.log("Updating remaining balance:",{loanAmount:t,startDate:r,durationMonths:a,repaymentFrequency:o}),!r||t<=0){this.accountForm.patchValue({remainingBalance:t},{emitEvent:!1}),console.log("Setting remaining balance to loan amount:",t);return}let l=this.calculateRemainingBalance(t,r,a,o);console.log("Calculated remaining balance:",l),this.accountForm.patchValue({remainingBalance:l,balance:-l},{emitEvent:!1})}calculateRemainingBalance(t,r,a,o){var b;let l=new Date,m=new Date(r),g=Math.round((0,Wu.default)(l).diff((0,Wu.default)(m),"months",!0)),f=0;if(o==="weekly"){let w=Math.floor((l.getTime()-m.getTime())/6048e5);f=Math.max(0,w)}else f=Math.max(0,g);let h=((b=this.accountForm.get("interestRate"))==null?void 0:b.value)||0,x=this.calculateMonthlyPayment(t,h,a),C=f*x,y=Math.max(0,t-C);return console.log("Remaining balance calculation details:",{today:l.toISOString(),start:m.toISOString(),monthsElapsed:g,paymentsMade:f,interestRate:h,monthlyPayment:x,totalPaid:C,remainingBalance:y}),Math.round(y*100)/100}findOrCreateLoanPaymentCategory(t){return this.categoryService.getCategories(t).pipe(wr(r=>{let a=r.find(o=>o.name.toLowerCase().includes("loan")&&o.type===Lt.EXPENSE);return a!=null&&a.id?gt(a.id):this.categoryService.createCategory(t,"Loan Payment",Lt.EXPENSE,"account_balance","#ef4444")}))}calculateMonthlyPayment(t,r,a){if(a<=0||r<=0)return t/a;let o=r/(12*100),l=o*Math.pow(1+o,a),m=Math.pow(1+o,a)-1;if(m===0)return t/a;let g=t*(l/m);return Math.round(g*100)/100}createLoanPaymentRecurringTransaction(t,r,a){return this.findOrCreateLoanPaymentCategory(t).pipe(wr(o=>{if(!o)throw new Error("Failed to create loan payment category");let l=this.getCalculatedMonthlyPayment(),m={userId:t,accountId:r,categoryId:o,category:"Loan Payment",payee:a.lenderName,amount:l,type:Lt.EXPENSE,date:new Date,notes:`Monthly payment for ${a.lenderName} loan`,status:Xo.COMPLETED,paymentMethod:qo.BANK_TRANSFER,isRecurring:!0,recurringInterval:a.repaymentFrequency==="weekly"?oa.WEEKLY:oa.MONTHLY,recurringEndDate:this.calculateLoanEndDate(a.startDate,a.durationMonths),nextOccurrence:a.nextDueDate,createdAt:new Date,updatedAt:new Date,createdBy:t,updatedBy:t,syncStatus:"synced",isPending:!1,lastSyncedAt:new Date};return this.transactionsService.createTransaction(t,m)}))}calculateLoanEndDate(t,r){let a=new Date(t);return a.setMonth(a.getMonth()+r),a}createLoanPaymentRecurringTransactionAfterAccountCreation(t,r){this.createLoanPaymentRecurringTransaction(this.userId,r,t.loanDetails).subscribe({next:()=>{this.notificationService.success("Loan payment recurring transaction created successfully")},error:a=>{console.error("Failed to create loan payment recurring transaction:",a),this.notificationService.warning("Account created but failed to create loan payment recurring transaction")}})}};i.\u0275fac=function(r){return new(r||i)(Y(Pi),Y(vi),Y(Mi),Y(xt),Y(ft),Y(mr),Y(sa),Y(pt),Y(Ka),Y(Za),Y($c))},i.\u0275cmp=Re({type:i,selectors:[["app-add-account-dialog"]],decls:30,vars:13,consts:[["addButtonTooltip","Save Account",3,"addButtonClick","closeButtonClick","title","showAddButton","addButtonDisabled","isSubmitting"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"bg-white","dark:bg-gray-800","rounded-lg","p-4","shadow-sm"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],["type","text","formControlName","name","placeholder","e.g., Chase Checking",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"maxlength"],[1,"flex","justify-between","items-center","mt-1"],[1,"text-red-500","text-sm"],[1,"text-xs","text-gray-500"],["appearance","fill",1,"w-full"],["formControlName","type"],[3,"value"],["type","number","formControlName","balance","placeholder","0.00","step","0.01",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"text-red-500","text-sm","mt-1"],[1,"bg-amber-50","dark:bg-amber-900/20","border","border-amber-200","dark:border-amber-800","rounded-lg","p-4"],[1,"bg-blue-50","dark:bg-blue-900/20","border","border-blue-200","dark:border-blue-800","rounded-lg","p-4"],[1,"h-20"],[1,"text-sm","font-semibold","text-amber-800","dark:text-amber-200","mb-4","flex","items-center","gap-2"],[1,"text-amber-600","dark:text-amber-400"],[1,"mb-4"],["type","text","formControlName","lenderName","placeholder","e.g., Bank of America",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],["type","number","formControlName","loanAmount","placeholder","0.00","step","0.01",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],["type","number","formControlName","interestRate","placeholder","5.5","step","0.1",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],["type","date","formControlName","startDate",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],["type","number","formControlName","durationMonths","placeholder","12",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],[1,"mb-3"],[1,"flex","items-center","gap-2"],["type","checkbox","formControlName","useCalculatedPayment",1,"w-4","h-4","text-amber-600","bg-gray-100","border-gray-300","rounded","focus:ring-amber-500","dark:focus:ring-amber-600","dark:ring-offset-gray-800","focus:ring-2","dark:bg-gray-700","dark:border-gray-600"],[1,"text-sm","font-medium","text-gray-700","dark:text-gray-300"],["formControlName","repaymentFrequency"],["formControlName","status"],[1,"flex","gap-2"],["type","number","formControlName","remainingBalance","readonly","",1,"flex-1","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-gray-100","dark:bg-gray-700","text-gray-600","dark:text-gray-400"],["type","button",1,"px-4","py-3","bg-amber-600","text-white","rounded-lg","hover:bg-amber-700","focus:outline-none","focus:ring-2","focus:ring-amber-500",3,"click"],[1,"text-xs","text-gray-500","dark:text-gray-400","mt-1"],["type","date","formControlName","nextDueDate",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],["type","checkbox","formControlName","showReminder",1,"w-4","h-4","text-amber-600","bg-gray-100","border-gray-300","rounded","focus:ring-amber-500","dark:focus:ring-amber-600","dark:ring-offset-gray-800","focus:ring-2","dark:bg-gray-700","dark:border-gray-600"],["type","checkbox","formControlName","createRecurringTransaction",1,"w-4","h-4","text-amber-600","bg-gray-100","border-gray-300","rounded","focus:ring-amber-500","dark:focus:ring-amber-600","dark:ring-offset-gray-800","focus:ring-2","dark:bg-gray-700","dark:border-gray-600"],[1,"text-xs","text-gray-500","dark:text-gray-400","mt-1","ml-6"],[1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-gray-100","dark:bg-gray-700","text-gray-600","dark:text-gray-400","flex","items-center","justify-between"],[1,"text-lg","font-semibold","text-amber-600","dark:text-amber-400"],["type","number","formControlName","customMonthlyPayment","placeholder","0.00","step","0.01",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],[1,"text-sm","font-semibold","text-blue-800","dark:text-blue-200","mb-4","flex","items-center","gap-2"],[1,"text-blue-600","dark:text-blue-400"],["type","number","formControlName","dueDate","placeholder","15","min","1","max","31",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","number","formControlName","billingCycleStart","placeholder","1","min","1","max","31",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","number","formControlName","creditLimit","placeholder","0.00","step","0.01","min","0",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","number","formControlName","minimumPayment","placeholder","0.00","step","0.01","min","0",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","checkbox","formControlName","creditCardShowReminder",1,"w-4","h-4","text-blue-600","bg-gray-100","border-gray-300","rounded","focus:ring-blue-500","dark:focus:ring-blue-600","dark:ring-offset-gray-800","focus:ring-2","dark:bg-gray-700","dark:border-gray-600"]],template:function(r,a){if(r&1&&(s(0,"app-common-header",0),F("addButtonClick",function(){return a.onSubmit()})("closeButtonClick",function(){return a.onClose()}),c(),s(1,"app-common-body-content")(2,"form",1),F("ngSubmit",function(){return a.onSubmit()}),s(3,"div",2)(4,"label",3),d(5," Account Name * "),c(),re(6,"input",4),s(7,"div",5),N(8,y3,2,0,"p",6)(9,M3,2,0,"p",6),s(10,"span",7),d(11),c()()(),s(12,"div",2)(13,"label",3),d(14," Account Type * "),c(),s(15,"mat-form-field",8)(16,"mat-label"),d(17,"Select account type"),c(),s(18,"mat-select",9),Ge(19,P3,2,2,"mat-option",10,Gu),c(),N(21,O3,2,0,"mat-error"),c()(),s(22,"div",2)(23,"label",3),d(24," Initial Balance * "),c(),re(25,"input",11),N(26,w3,2,1,"p",12),c(),N(27,R3,82,6,"div",13)(28,U3,34,4,"div",14),re(29,"div",15),c()()),r&2){let o,l,m,g;P("title",(a.dialogData!=null&&a.dialogData.accountId?"Edit":"Add")+" Account")("showAddButton",!0)("addButtonDisabled",a.accountForm.invalid)("isSubmitting",a.isSubmitting),u(2),P("formGroup",a.accountForm),u(4),P("maxlength",50),u(2),we((o=a.accountForm.get("name"))!=null&&o.hasError("required")&&((o=a.accountForm.get("name"))!=null&&o.touched)?8:-1),u(),we((l=a.accountForm.get("name"))!=null&&l.hasError("maxlength")?9:-1),u(2),ne(" ",((m=a.accountForm.get("name"))==null||m.value==null?null:m.value.length)||0,"/50 "),u(8),He(a.accountTypes),u(2),we((g=a.accountForm.get("type"))!=null&&g.hasError("required")&&((g=a.accountForm.get("type"))!=null&&g.touched)?21:-1),u(5),we(a.getBalanceError()?26:-1),u(),we(a.isLoanAccount()?27:-1),u(),we(a.isCreditCardAccount()?28:-1)}},dependencies:[Wn,Nt,Ui,z1,At,Yn,hc,jo,zo,xi,Ci,Qe,Oi,Lr,ja,wi,yi,Ko,Zo,Sr],styles:["[_nghost-%COMP%]{display:block;max-width:600px;width:100%}mat-form-field[_ngcontent-%COMP%]{width:100%}button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}button[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}button[_ngcontent-%COMP%]:active{transform:translateY(0)}button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.text-red-500[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shake .5s ease-in-out}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}25%{transform:translate(-5px)}75%{transform:translate(5px)}}.text-green-500[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse .5s ease-in-out}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1)}50%{transform:scale(1.05)}to{transform:scale(1)}}*[_ngcontent-%COMP%]{transition:background-color .3s ease,color .3s ease,border-color .3s ease}"]});let e=i;return e})();function z3(e,i){if(e&1){let n=ue();s(0,"button",14),F("click",function(){R(n);let r=v();return B(r.clearSearch())}),s(1,"mat-icon"),d(2,"clear"),c()()}}function j3(e,i){if(e&1){let n=ue();s(0,"div",15)(1,"mat-icon",16),d(2,"search_off"),c(),s(3,"p",17),d(4,"No icons found"),c(),s(5,"button",18),F("click",function(){R(n);let r=v();return B(r.clearSearch())}),d(6," Clear Search "),c()()}}function $3(e,i){if(e&1){let n=ue();s(0,"button",21),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.selectIcon(r))}),s(1,"mat-icon",22),d(2),c(),s(3,"span",23),d(4),c()()}if(e&2){let n=i.$implicit,t=v(2);ze("selected",t.selectedIcon===n),Wr("aria-label","Select "+n+" icon"),u(2),L(n),u(2),L(n)}}function Y3(e,i){if(e&1&&(s(0,"div",19),N(1,$3,5,5,"button",20),c()),e&2){let n=v();u(),P("ngForOf",n.filteredIcons)("ngForTrackBy",n.trackByIcon)}}var aC=(()=>{let i=class i{constructor(t,r){this.dialogRef=t,this.data=r,this.availableIcons=E_,this.searchTerm="",this.filteredIcons=[],this.selectedIcon=r.currentIcon||"category",this.filteredIcons=[...this.availableIcons]}ngOnInit(){this.data.availableIcons&&(this.availableIcons=this.data.availableIcons,this.filteredIcons=[...this.availableIcons])}selectIcon(t){this.selectedIcon=t,this.dialogRef.close(t)}onSearchChange(){this.searchTerm.trim()?this.filteredIcons=this.availableIcons.filter(t=>t.toLowerCase().includes(this.searchTerm.toLowerCase())):this.filteredIcons=[...this.availableIcons]}clearSearch(){this.searchTerm="",this.filteredIcons=[...this.availableIcons]}onCancel(){this.dialogRef.close()}trackByIcon(t,r){return r}};i.\u0275fac=function(r){return new(r||i)(Y(Mi),Y(Pi))},i.\u0275cmp=Re({type:i,selectors:[["app-icon-selector-dialog"]],decls:19,vars:4,consts:[[1,"icon-selector-dialog"],[1,"dialog-header"],[1,"dialog-title"],["mat-icon-button","","aria-label","Close",1,"close-button",3,"click"],[1,"search-container"],[1,"search-input-wrapper"],[1,"search-icon"],["type","text","placeholder","Search icons...","autocomplete","off","spellcheck","false",1,"search-input",3,"ngModelChange","input","ngModel"],["mat-icon-button","","class","clear-search-button","type","button","aria-label","Clear search",3,"click",4,"ngIf"],[1,"icons-container"],["class","no-results",4,"ngIf"],["class","icons-grid",4,"ngIf"],[1,"dialog-actions"],["mat-stroked-button","",1,"cancel-button",3,"click"],["mat-icon-button","","type","button","aria-label","Clear search",1,"clear-search-button",3,"click"],[1,"no-results"],[1,"no-results-icon"],[1,"no-results-text"],["mat-stroked-button","",1,"clear-search-btn",3,"click"],[1,"icons-grid"],["type","button","class","icon-option",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"icon-option",3,"click"],[1,"icon"],[1,"icon-name"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"h2",2),d(3,"Choose Icon"),c(),s(4,"button",3),F("click",function(){return a.onCancel()}),s(5,"mat-icon"),d(6,"close"),c()()(),s(7,"div",4)(8,"div",5)(9,"mat-icon",6),d(10,"search"),c(),s(11,"input",7),lt("ngModelChange",function(l){return ct(a.searchTerm,l)||(a.searchTerm=l),l}),F("input",function(){return a.onSearchChange()}),c(),N(12,z3,3,0,"button",8),c()(),s(13,"div",9),N(14,j3,7,0,"div",10)(15,Y3,2,2,"div",11),c(),s(16,"div",12)(17,"button",13),F("click",function(){return a.onCancel()}),d(18," Cancel "),c()()()),r&2&&(u(11),st("ngModel",a.searchTerm),u(),P("ngIf",a.searchTerm),u(2),P("ngIf",a.filteredIcons&&a.filteredIcons.length===0),u(),P("ngIf",a.filteredIcons&&a.filteredIcons.length>0))},dependencies:[or,dt,Nt,At,Jn,Jt,gn,Qe],styles:[".icon-selector-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:90vh;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 10px 25px #0000001a}@media (max-width: 640px){.icon-selector-dialog[_ngcontent-%COMP%]{height:100vh;max-height:100vh;border-radius:0}}.dialog-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.25rem 1.5rem;border-bottom:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.dialog-header[_ngcontent-%COMP%]{padding:1rem}}.dialog-header[_ngcontent-%COMP%]   .dialog-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1e293b;margin:0}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#64748b;min-width:40px;min-height:40px;border-radius:8px}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#334155;background:#f8fafc}.search-container[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-bottom:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.search-container[_ngcontent-%COMP%]{padding:.75rem 1rem}}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:.75rem;color:#94a3b8;font-size:1.125rem;width:1.125rem;height:1.125rem;pointer-events:none}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:.75rem .75rem .75rem 2.25rem;border:1px solid #e2e8f0;border-radius:8px;font-size:.875rem;background:#f8fafc;transition:all .2s ease;min-height:40px}@media (max-width: 640px){.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{min-height:44px;font-size:16px}}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;background:#fff;box-shadow:0 0 0 3px #3b82f61a}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .clear-search-button[_ngcontent-%COMP%]{position:absolute;right:.5rem;color:#94a3b8;min-width:28px;min-height:28px;border-radius:6px}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .clear-search-button[_ngcontent-%COMP%]:hover{color:#64748b;background:#f1f5f9}.icons-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:1rem 1.5rem;background:#fafafa}@media (max-width: 640px){.icons-container[_ngcontent-%COMP%]{padding:.75rem 1rem}}.icons-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.icons-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.icons-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:2px}.icons-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.icons-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.icons-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .no-results-icon[_ngcontent-%COMP%]{font-size:2.5rem;width:2.5rem;height:2.5rem;color:#94a3b8;margin-bottom:.75rem}.icons-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .no-results-text[_ngcontent-%COMP%]{color:#64748b;font-size:.875rem;margin:0 0 1rem}.icons-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .clear-search-btn[_ngcontent-%COMP%]{min-height:36px;padding:.5rem 1rem;font-size:.875rem}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(72px,1fr));gap:.5rem}@media (min-width: 768px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:.75rem}}@media (max-width: 640px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(64px,1fr));gap:.5rem}}@media (max-width: 480px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(56px,1fr));gap:.5rem}}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:.75rem;border:1px solid #e2e8f0;border-radius:8px;background:#fff;cursor:pointer;transition:all .15s ease;min-height:72px;text-decoration:none}@media (min-width: 768px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{min-height:90px;padding:.75rem .5rem;justify-content:space-between}}@media (max-width: 640px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{min-height:64px;padding:.5rem}}@media (max-width: 480px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{min-height:56px;padding:.5rem}}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#f0f9ff;transform:translateY(-1px);box-shadow:0 2px 8px #3b82f61a}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option.selected[_ngcontent-%COMP%]{border-color:#3b82f6;background:#dbeafe;color:#1d4ed8;transform:translateY(-1px);box-shadow:0 2px 8px #3b82f626}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.75rem;width:1.75rem;height:1.75rem;color:inherit}@media (min-width: 768px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:2rem;width:2rem;height:2rem;margin-bottom:.25rem}}@media (max-width: 640px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem}}@media (max-width: 480px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{display:none;font-size:.75rem;font-weight:500;color:#64748b;text-align:center;word-break:break-word;line-height:1.2;text-transform:capitalize;margin-top:.25rem}@media (min-width: 768px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{display:block}}.icon-option.selected[_ngcontent-%COMP%]   .icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{color:#1d4ed8;font-weight:600}.dialog-actions[_ngcontent-%COMP%]{display:flex;padding:1rem 1.5rem;border-top:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.dialog-actions[_ngcontent-%COMP%]{padding:.75rem 1rem}}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{width:100%;min-height:40px;padding:.75rem 1.5rem;font-weight:500;color:#64748b;border-color:#e2e8f0}@media (max-width: 640px){.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{min-height:44px}}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]:hover{color:#334155;border-color:#cbd5e1;background:#f8fafc}@keyframes _ngcontent-%COMP%_fadeInUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.icon-selector-dialog[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .2s ease-out}"]});let e=i;return e})();function W3(e,i){if(e&1){let n=ue();s(0,"button",14),F("click",function(){R(n);let r=v();return B(r.clearSearch())}),s(1,"mat-icon"),d(2,"clear"),c()()}}function G3(e,i){if(e&1){let n=ue();s(0,"div",15)(1,"mat-icon",16),d(2,"search_off"),c(),s(3,"p",17),d(4,"No colors found"),c(),s(5,"button",18),F("click",function(){R(n);let r=v();return B(r.clearSearch())}),d(6," Clear Search "),c()()}}function H3(e,i){e&1&&(s(0,"mat-icon",23),d(1,"check"),c())}function q3(e,i){if(e&1){let n=ue();s(0,"button",21),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.selectColor(r.value))}),s(1,"span",22),d(2),c(),N(3,H3,2,0,"mat-icon",23),c()}if(e&2){let n=i.$implicit,t=v(2);wt("background-color",n.value),ze("selected",t.selectedColor===n.value),Wr("aria-label","Select "+n.label+" color"),u(2),L(n.label),u(),we(t.selectedColor===n.value?3:-1)}}function X3(e,i){if(e&1&&(s(0,"div",19),Ge(1,q3,4,7,"button",20,rr),c()),e&2){let n=v();u(),He(n.filteredColors)}}var oC=(()=>{let i=class i{constructor(t,r){this.dialogRef=t,this.data=r,this.availableColors=I_,this.searchTerm="",this.filteredColors=[],this.selectedColor=r.currentColor||"#46777f",this.filteredColors=[...this.availableColors]}ngOnInit(){}selectColor(t){this.selectedColor=t,this.dialogRef.close(t)}onSearchChange(){this.searchTerm.trim()?this.filteredColors=this.availableColors.filter(t=>t.label.toLowerCase().includes(this.searchTerm.toLowerCase())):this.filteredColors=[...this.availableColors]}clearSearch(){this.searchTerm="",this.filteredColors=[...this.availableColors]}onCancel(){this.dialogRef.close()}trackByColor(t,r){return r}};i.\u0275fac=function(r){return new(r||i)(Y(Mi),Y(Pi))},i.\u0275cmp=Re({type:i,selectors:[["app-color-selector-dialog"]],decls:19,vars:4,consts:[[1,"color-selector-dialog"],[1,"dialog-header"],[1,"dialog-title"],["mat-icon-button","","aria-label","Close",1,"close-button",3,"click"],[1,"search-container"],[1,"search-input-wrapper"],[1,"search-icon"],["type","text","placeholder","Search colors...","autocomplete","off","spellcheck","false",1,"search-input",3,"ngModelChange","input","ngModel"],["mat-icon-button","","class","clear-search-button","type","button","aria-label","Clear search",3,"click",4,"ngIf"],[1,"colors-container"],["class","no-results",4,"ngIf"],["class","colors-grid",4,"ngIf"],[1,"dialog-actions"],["mat-stroked-button","",1,"cancel-button",3,"click"],["mat-icon-button","","type","button","aria-label","Clear search",1,"clear-search-button",3,"click"],[1,"no-results"],[1,"no-results-icon"],[1,"no-results-text"],["mat-stroked-button","",1,"clear-search-btn",3,"click"],[1,"colors-grid"],["type","button",1,"color-option",3,"selected","background-color"],["type","button",1,"color-option",3,"click"],[1,"color-name"],[1,"check-icon"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"h2",2),d(3,"Choose Color"),c(),s(4,"button",3),F("click",function(){return a.onCancel()}),s(5,"mat-icon"),d(6,"close"),c()()(),s(7,"div",4)(8,"div",5)(9,"mat-icon",6),d(10,"search"),c(),s(11,"input",7),lt("ngModelChange",function(l){return ct(a.searchTerm,l)||(a.searchTerm=l),l}),F("input",function(){return a.onSearchChange()}),c(),N(12,W3,3,0,"button",8),c()(),s(13,"div",9),N(14,G3,7,0,"div",10)(15,X3,3,0,"div",11),c(),s(16,"div",12)(17,"button",13),F("click",function(){return a.onCancel()}),d(18," Cancel "),c()()()),r&2&&(u(11),st("ngModel",a.searchTerm),u(),P("ngIf",a.searchTerm),u(2),P("ngIf",a.filteredColors.length===0),u(),P("ngIf",a.filteredColors.length>0))},dependencies:[dt,Nt,At,Jn,Jt,gn,Qe],styles:[".color-selector-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:90vh;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 10px 25px #0000001a}@media (max-width: 640px){.color-selector-dialog[_ngcontent-%COMP%]{height:100vh;max-height:100vh;border-radius:0}}.dialog-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.25rem 1.5rem;border-bottom:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.dialog-header[_ngcontent-%COMP%]{padding:1rem}}.dialog-header[_ngcontent-%COMP%]   .dialog-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1e293b;margin:0}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#64748b;min-width:40px;min-height:40px;border-radius:8px}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#334155;background:#f8fafc}.search-container[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-bottom:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.search-container[_ngcontent-%COMP%]{padding:.75rem 1rem}}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:.75rem;color:#94a3b8;font-size:1.125rem;width:1.125rem;height:1.125rem;pointer-events:none}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:.75rem .75rem .75rem 2.25rem;border:1px solid #e2e8f0;border-radius:8px;font-size:.875rem;background:#f8fafc;transition:all .2s ease;min-height:40px}@media (max-width: 640px){.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{min-height:44px;font-size:16px}}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;background:#fff;box-shadow:0 0 0 3px #3b82f61a}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .clear-search-button[_ngcontent-%COMP%]{position:absolute;right:.5rem;color:#94a3b8;min-width:28px;min-height:28px;border-radius:6px}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .clear-search-button[_ngcontent-%COMP%]:hover{color:#64748b;background:#f1f5f9}.colors-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:1rem 1.5rem;background:#fafafa}@media (max-width: 640px){.colors-container[_ngcontent-%COMP%]{padding:.75rem 1rem}}.colors-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.colors-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.colors-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:2px}.colors-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.colors-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.colors-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .no-results-icon[_ngcontent-%COMP%]{font-size:2.5rem;width:2.5rem;height:2.5rem;color:#94a3b8;margin-bottom:.75rem}.colors-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .no-results-text[_ngcontent-%COMP%]{color:#64748b;font-size:.875rem;margin:0 0 1rem}.colors-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .clear-search-btn[_ngcontent-%COMP%]{min-height:36px;padding:.5rem 1rem;font-size:.875rem}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(72px,1fr));gap:.5rem}@media (min-width: 768px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:.75rem}}@media (max-width: 640px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(64px,1fr));gap:.5rem}}@media (max-width: 480px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(56px,1fr));gap:.5rem}}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:.75rem;border:1px solid #e2e8f0;border-radius:8px;background:#fff;cursor:pointer;transition:all .15s ease;min-height:72px;position:relative}@media (min-width: 768px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{min-height:90px;padding:.75rem .5rem;justify-content:space-between}}@media (max-width: 640px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{min-height:64px;padding:.5rem}}@media (max-width: 480px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{min-height:56px;padding:.5rem}}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#f0f9ff;transform:translateY(-1px);box-shadow:0 2px 8px #3b82f61a}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option.selected[_ngcontent-%COMP%]{border-color:#3b82f6;transform:translateY(-1px);box-shadow:0 2px 8px #3b82f626}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option.selected[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{opacity:1;transform:scale(1)}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:1.75rem;height:1.75rem;border-radius:50%;border:2px solid white;box-shadow:0 2px 4px #0000001a}@media (min-width: 768px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:2rem;height:2rem;margin-bottom:.25rem}}@media (max-width: 640px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem}}@media (max-width: 480px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:1.25rem;height:1.25rem}}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{display:none;font-size:.75rem;font-weight:500;font-family:Roboto Mono,monospace;color:#64748b;text-align:center;word-break:break-word;line-height:1.2;margin-top:.25rem;background-color:#ffffff80;padding:5px;border-radius:5px}@media (min-width: 768px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{display:block}}.color-option.selected[_ngcontent-%COMP%]   .colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{color:#1d4ed8;font-weight:600}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{position:absolute;top:.25rem;right:.25rem;color:#fff;font-size:.875rem;width:.875rem;height:.875rem;background:#000000b3;border-radius:50%;padding:.125rem;opacity:0;transform:scale(0);transition:all .15s ease}@media (min-width: 768px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}}@media (max-width: 640px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{font-size:.75rem;width:.75rem;height:.75rem}}.dialog-actions[_ngcontent-%COMP%]{display:flex;padding:1rem 1.5rem;border-top:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.dialog-actions[_ngcontent-%COMP%]{padding:.75rem 1rem}}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{width:100%;min-height:40px;padding:.75rem 1.5rem;font-weight:500;color:#64748b;border-color:#e2e8f0}@media (max-width: 640px){.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{min-height:44px}}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]:hover{color:#334155;border-color:#cbd5e1;background:#f8fafc}@keyframes _ngcontent-%COMP%_fadeInUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.color-selector-dialog[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .2s ease-out}"]});let e=i;return e})();function K3(e,i){if(e&1&&(s(0,"p",9),d(1),c()),e&2){let n=v();u(),L(n.getNameError())}}function Z3(e,i){if(e&1&&(s(0,"p",9),d(1),c()),e&2){let n=v();u(),L(n.getTypeError())}}var ks=(()=>{let i=class i{constructor(t,r,a,o,l,m,g,f,h,x,C){this.dialogData=t,this.store=r,this.fb=a,this.dialogRef=o,this.auth=l,this.notificationService=m,this.router=g,this.hapticFeedback=f,this.dialog=h,this.validationService=x,this.ssrService=C,this.isSubmitting=!1,this.userId="",this.allCategories=[],this.categoryForm=this.fb.group({name:["",this.validationService.getCategoryNameValidators()],type:["expense",tt.required],icon:["category",tt.required],color:["#46777f",tt.required]}),this.destroy$=new Bt,this.store.select(un).pipe(yt(this.destroy$)).subscribe(y=>{this.allCategories=y})}ngOnInit(){var t;this.userId=((t=this.auth.currentUser)==null?void 0:t.uid)||"",this.ssrService.isClientSide()&&window.addEventListener("popstate",r=>{this.dialogRef.close(),r.preventDefault()}),this.dialogData&&this.categoryForm.patchValue({name:this.dialogData.category.name,type:this.dialogData.category.type,icon:this.dialogData.category.icon||"category",color:this.dialogData.category.color||"#46777f"})}onSubmit(){return me(this,null,function*(){var t,r;if(this.categoryForm.valid&&!this.isSubmitting&&!this.isCategoryPresent()){this.isSubmitting=!0;try{let a=this.categoryForm.value;(r=(t=this.dialogData)==null?void 0:t.category)!=null&&r.id?(yield this.store.dispatch(aa({userId:this.userId,categoryId:this.dialogData.category.id,name:a.name.trim(),categoryType:a.type,icon:a.icon,color:a.color})),this.notificationService.success("Category updated successfully")):(yield this.store.dispatch(xc({userId:this.userId,name:a.name.trim(),categoryType:a.type,icon:a.icon,color:a.color})),this.notificationService.success("Category added successfully"),this.hapticFeedback.successVibration()),this.dialogRef.close(!0)}catch(a){this.notificationService.error("Failed to save category"),console.error("Error saving category:",a)}finally{this.isSubmitting=!1}}})}onCancel(){this.dialogRef.close(!1)}selectType(t){this.categoryForm.patchValue({type:t})}getNameError(){let t=this.categoryForm.get("name");return t?this.validationService.getAccountNameError(t):""}getTypeError(){let t=this.categoryForm.get("type");return t!=null&&t.hasError("required")?"Category type is required":""}openIconSelectorDialog(){var t;this.dialog.open(aC,{width:"90vw",maxWidth:"500px",height:"80vh",maxHeight:"600px",data:{currentIcon:(t=this.categoryForm.get("icon"))==null?void 0:t.value},disableClose:!1,autoFocus:!1}).afterClosed().subscribe(r=>{r&&(this.categoryForm.patchValue({icon:r}),this.hapticFeedback.lightVibration())})}openColorSelectorDialog(){var r;this.dialog.open(oC,{width:"90vw",maxWidth:"500px",height:"80vh",maxHeight:"600px",data:{currentColor:(r=this.categoryForm.get("color"))==null?void 0:r.value},disableClose:!1,autoFocus:!1}).afterClosed().subscribe(a=>{a&&(this.categoryForm.patchValue({color:a}),this.hapticFeedback.lightVibration())})}isCategoryPresent(){var r,a;let t=this.allCategories.find(o=>{var l;return o.name.trim().toLowerCase()===((l=this.categoryForm.get("name"))==null?void 0:l.value.trim().toLowerCase())});return(a=(r=this.dialogData)==null?void 0:r.category)!=null&&a.id&&(t=this.allCategories.find(o=>{var l,m,g;return o.name.trim().toLowerCase()===((l=this.categoryForm.get("name"))==null?void 0:l.value.trim().toLowerCase())&&o.id!==((g=(m=this.dialogData)==null?void 0:m.category)==null?void 0:g.id)})),t&&this.notificationService.error("Category already exists"),!!t}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};i.\u0275fac=function(r){return new(r||i)(Y(Pi),Y(pt),Y(vi),Y(Mi),Y(xt),Y(ft),Y(nn),Y(mr),Y(xn),Y(sa),Y(Vr))},i.\u0275cmp=Re({type:i,selectors:[["app-mobile-category-add-edit-popup"]],decls:60,vars:24,consts:[[3,"addButtonClick","closeButtonClick","title","isSubmitting","showCloseButton","showAddButton","addButtonTooltip","addButtonDisabled","closeButtonTooltip"],[1,"mobile-content"],[1,"form-container"],[1,"category-form",3,"ngSubmit","formGroup"],[1,"form-field"],[1,"field-label"],[1,"field-icon"],["type","text","formControlName","name","autofocus","","placeholder","e.g., Groceries","autofocus","",1,"form-input"],[1,"field-footer"],[1,"error-message"],[1,"character-count"],[1,"type-selector"],["type","button",1,"type-option",3,"click"],[1,"icon-selector"],["type","button",1,"icon-preview-button",3,"click"],[1,"icon-preview"],[1,"selected-icon"],[1,"icon-name"],[1,"dropdown-icon"],[1,"color-selector"],["type","button",1,"color-preview-button",3,"click"],[1,"color-preview"],[1,"color-swatch"],[1,"color-name"],[1,"bottom-spacing"]],template:function(r,a){if(r&1&&(s(0,"app-common-header",0),F("addButtonClick",function(){return a.onSubmit()})("closeButtonClick",function(){return a.onCancel()}),c(),s(1,"app-common-body-content")(2,"div",1)(3,"div",2)(4,"form",3),F("ngSubmit",function(){return a.onSubmit()}),s(5,"div",4)(6,"label",5)(7,"mat-icon",6),d(8,"label"),c(),d(9," Category Name * "),c(),re(10,"input",7),s(11,"div",8),N(12,K3,2,1,"p",9),s(13,"span",10),d(14),c()()(),s(15,"div",4)(16,"label",5)(17,"mat-icon",6),d(18,"category"),c(),d(19," Category Type * "),c(),s(20,"div",11)(21,"button",12),F("click",function(){return a.selectType("expense")}),s(22,"mat-icon"),d(23,"trending_down"),c(),s(24,"span"),d(25,"Expense"),c()(),s(26,"button",12),F("click",function(){return a.selectType("income")}),s(27,"mat-icon"),d(28,"trending_up"),c(),s(29,"span"),d(30,"Income"),c()()(),N(31,Z3,2,1,"p",9),c(),s(32,"div",4)(33,"label",5)(34,"mat-icon",6),d(35,"emoji_emotions"),c(),d(36," Category Icon * "),c(),s(37,"div",13)(38,"button",14),F("click",function(){return a.openIconSelectorDialog()}),s(39,"div",15)(40,"mat-icon",16),d(41),c(),s(42,"span",17),d(43),c()(),s(44,"mat-icon",18),d(45,"expand_more"),c()()()(),s(46,"div",4)(47,"label",5)(48,"mat-icon",6),d(49,"palette"),c(),d(50," Category Color * "),c(),s(51,"div",19)(52,"button",20),F("click",function(){return a.openColorSelectorDialog()}),s(53,"div",21),re(54,"div",22),s(55,"span",23),d(56),c()(),s(57,"mat-icon",18),d(58,"expand_more"),c()()()(),re(59,"div",24),c()()()()),r&2){let o,l,m,g,f,h,x,C,y,b,w;P("title",!(a.dialogData==null||a.dialogData.category==null)&&a.dialogData.category.id?"Edit":"Add Category")("isSubmitting",a.isSubmitting)("showCloseButton",!0)("showAddButton",!0)("addButtonTooltip",a.isSubmitting?"Saving...":"Save Category")("addButtonDisabled",a.categoryForm.invalid||a.isSubmitting)("closeButtonTooltip",a.isSubmitting?"Saving...":"Close"),u(4),P("formGroup",a.categoryForm),u(8),we(a.getNameError()&&((o=a.categoryForm.get("name"))!=null&&o.touched)?12:-1),u(2),ne(" ",((l=a.categoryForm.get("name"))==null||l.value==null?null:l.value.length)||0,"/50 "),u(7),ze("selected",((m=a.categoryForm.get("type"))==null?null:m.value)==="expense"),u(5),ze("selected",((g=a.categoryForm.get("type"))==null?null:g.value)==="income"),u(5),we(a.getTypeError()&&((f=a.categoryForm.get("type"))!=null&&f.touched)?31:-1),u(7),ze("active",(h=a.categoryForm.get("icon"))==null?null:h.value),u(3),L(((x=a.categoryForm.get("icon"))==null?null:x.value)||"category"),u(2),L(((C=a.categoryForm.get("icon"))==null?null:C.value)||"category"),u(9),ze("active",(y=a.categoryForm.get("color"))==null?null:y.value),u(2),wt("background-color",((b=a.categoryForm.get("color"))==null?null:b.value)||"#005cbb"),u(2),L(((w=a.categoryForm.get("color"))==null?null:w.value)||"#005cbb")}},dependencies:[Wn,Nt,At,Yn,xi,Ci,Qe,Ko,Zo],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:flex;flex-direction:column;height:100vh;background-color:#f9fafb;max-width:100vw;overflow:hidden}.dark   [_nghost-%COMP%]{background-color:#111827}.mobile-header[_ngcontent-%COMP%]{position:sticky;top:0;z-index:20;background:#fff;border-bottom:1px solid #e5e7eb;box-shadow:0 1px 3px #0000001a}.dark[_ngcontent-%COMP%]   .mobile-header[_ngcontent-%COMP%]{background:#1f2937;border-color:#374151}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;min-height:60px}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{padding:.5rem .75rem;min-height:56px}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;flex:1}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{gap:.5rem}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{min-width:44px;min-height:44px;color:#6b7280}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{min-width:40px;min-height:40px}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.dark[_ngcontent-%COMP%]   .mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#9ca3af}.dark[_ngcontent-%COMP%]   .mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{background:#374151;color:#f3f4f6}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .mobile-only[_ngcontent-%COMP%]{display:flex}@media (min-width: 768px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .mobile-only[_ngcontent-%COMP%]{display:none}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .desktop-only[_ngcontent-%COMP%]{display:none}@media (min-width: 768px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .desktop-only[_ngcontent-%COMP%]{display:flex}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .desktop-only[_ngcontent-%COMP%]{display:none}@media (min-width: 768px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .desktop-only[_ngcontent-%COMP%]{display:flex}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .mobile-only[_ngcontent-%COMP%]{display:flex}@media (min-width: 768px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .mobile-only[_ngcontent-%COMP%]{display:none}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1f2937;margin:0}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:1rem}}@media (max-width: 360px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:.875rem}}.dark[_ngcontent-%COMP%]   .mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{color:#f9fafb}.mobile-header[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{min-height:44px;padding:.5rem 1rem;display:flex;align-items:center;gap:.5rem;font-weight:500}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{min-height:40px;padding:.5rem .75rem;font-size:.875rem}}@media (max-width: 360px){.mobile-header[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{padding:.5rem;font-size:.75rem}}.mobile-header[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:disabled{opacity:.6}.mobile-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;background:#f9fafb;-webkit-overflow-scrolling:touch}.dark[_ngcontent-%COMP%]   .mobile-content[_ngcontent-%COMP%]{background:#111827}.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:1rem;max-width:600px;margin:0 auto;margin-bottom:2rem}@media (max-width: 480px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:.75rem}}@media (max-width: 360px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:.5rem}}.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .category-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}@media (max-width: 480px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .category-form[_ngcontent-%COMP%]{gap:1.25rem}}@media (max-width: 360px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .category-form[_ngcontent-%COMP%]{gap:1rem}}.form-field[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.25rem;box-shadow:0 1px 3px #0000001a;border:1px solid #e5e7eb}@media (max-width: 480px){.form-field[_ngcontent-%COMP%]{padding:1rem;border-radius:10px}}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]{padding:.875rem;border-radius:8px}}.dark[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{background:#1f2937;border-color:#374151}.form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.75rem}@media (max-width: 480px){.form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]{font-size:.8rem;margin-bottom:.625rem}}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]{font-size:.75rem;margin-bottom:.5rem}}.dark[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]{color:#f3f4f6}.form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]   .field-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem;color:#6b7280}@media (max-width: 480px){.form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]   .field-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}}.form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem;border:1px solid #d1d5db;border-radius:8px;background:transparent;font-size:16px;min-height:48px;transition:all .2s ease}@media (max-width: 480px){.form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding:.75rem .875rem;min-height:44px;font-size:15px}}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding:.625rem .75rem;min-height:40px;font-size:14px}}.dark[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{border-color:#4b5563;color:#f9fafb}.form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:.5rem}@media (max-width: 480px){.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]{margin-top:.375rem}}.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#dc2626;font-size:.75rem;margin:0}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{font-size:.7rem}}.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]   .character-count[_ngcontent-%COMP%]{color:#6b7280;font-size:.75rem}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]   .character-count[_ngcontent-%COMP%]{font-size:.7rem}}.form-field[_ngcontent-%COMP%]   .field-hint[_ngcontent-%COMP%]{color:#6b7280;font-size:.75rem;margin-top:.25rem;font-style:italic}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]   .field-hint[_ngcontent-%COMP%]{font-size:.7rem}}.type-selector[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}@media (max-width: 480px){.type-selector[_ngcontent-%COMP%]{gap:.5rem}}@media (max-width: 360px){.type-selector[_ngcontent-%COMP%]{gap:.375rem}}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.5rem;padding:1rem;border:2px solid #e5e7eb;border-radius:8px;background:transparent;cursor:pointer;transition:all .2s ease;min-height:80px}@media (max-width: 480px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{padding:.75rem;min-height:70px;gap:.375rem}}@media (max-width: 360px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{padding:.625rem;min-height:60px;gap:.25rem}}.dark[_ngcontent-%COMP%]   .type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{border-color:#4b5563}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#eff6ff}.type-selector[_ngcontent-%COMP%]   .type-option.selected[_ngcontent-%COMP%]{border-color:#3b82f6;background:#dbeafe;color:#1d4ed8}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem}@media (max-width: 480px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}}@media (max-width: 360px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500}@media (max-width: 480px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem}}@media (max-width: 360px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.7rem}}.icon-selector[_ngcontent-%COMP%]{position:relative}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;padding:.875rem 1rem;border:1px solid #d1d5db;border-radius:8px;background:transparent;cursor:pointer;transition:all .2s ease;min-height:48px}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]{padding:.75rem .875rem;min-height:44px}}@media (max-width: 360px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]{padding:.625rem .75rem;min-height:40px}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]{border-color:#4b5563}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button.active[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]{gap:.5rem}}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .selected-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem;color:#3b82f6}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .selected-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{color:#374151;font-family:Roboto Mono,monospace;font-size:.875rem}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 360px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{font-size:.75rem}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{color:#f3f4f6}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .dropdown-icon[_ngcontent-%COMP%]{color:#6b7280;transition:transform .2s ease}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button.active[_ngcontent-%COMP%]   .dropdown-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;z-index:50;margin-top:.25rem;background:#fff;border:1px solid #d1d5db;border-radius:8px;box-shadow:0 10px 25px #00000026;max-height:300px;overflow:hidden;animation:_ngcontent-%COMP%_slideDown .2s ease-out}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]{max-height:250px}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]{background:#1f2937;border-color:#4b5563}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;border-bottom:1px solid #e5e7eb}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]{padding:.625rem .875rem}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]{border-color:#374151}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151;margin:0}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:.8rem}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#f3f4f6}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{min-width:32px;min-height:32px;color:#6b7280}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{min-width:28px;min-height:28px}}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]:hover{background:#f3f4f6}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{color:#9ca3af}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]:hover{background:#374151}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(6,1fr);gap:.5rem;padding:1rem;max-height:250px;overflow-y:auto}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(5,1fr);gap:.375rem;padding:.75rem;max-height:200px}}@media (max-width: 360px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr);gap:.25rem;padding:.625rem}}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:.75rem;border:1px solid #e5e7eb;border-radius:8px;background:transparent;cursor:pointer;transition:all .2s ease;min-height:44px}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{padding:.625rem;min-height:40px}}@media (max-width: 360px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{padding:.5rem;min-height:36px}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{border-color:#4b5563}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#eff6ff;transform:scale(1.05)}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option.selected[_ngcontent-%COMP%]{border-color:#3b82f6;background:#dbeafe;color:#1d4ed8}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}}@media (max-width: 360px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}}.color-selector[_ngcontent-%COMP%]{position:relative}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;padding:.875rem 1rem;border:1px solid #d1d5db;border-radius:8px;background:transparent;cursor:pointer;transition:all .2s ease;min-height:48px}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]{padding:.75rem .875rem;min-height:44px}}@media (max-width: 360px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]{padding:.625rem .75rem;min-height:40px}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]{border-color:#4b5563}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.color-selector[_ngcontent-%COMP%]   .color-preview-button.active[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{gap:.5rem}}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-swatch[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:6px;border:2px solid #e5e7eb;flex-shrink:0}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-swatch[_ngcontent-%COMP%]{width:20px;height:20px}}@media (max-width: 360px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-swatch[_ngcontent-%COMP%]{width:18px;height:18px}}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{color:#374151;font-family:Roboto Mono,monospace;font-size:.875rem}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 360px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{font-size:.75rem}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{color:#f3f4f6}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .dropdown-icon[_ngcontent-%COMP%]{color:#6b7280;transition:transform .2s ease}.color-selector[_ngcontent-%COMP%]   .color-preview-button.active[_ngcontent-%COMP%]   .dropdown-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;z-index:50;margin-top:.25rem;background:#fff;border:1px solid #d1d5db;border-radius:8px;box-shadow:0 10px 25px #00000026;max-height:300px;overflow:hidden;animation:_ngcontent-%COMP%_slideDown .2s ease-out}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]{max-height:250px}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]{background:#1f2937;border-color:#4b5563}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;border-bottom:1px solid #e5e7eb}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]{padding:.625rem .875rem}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]{border-color:#374151}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151;margin:0}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:.8rem}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#f3f4f6}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{min-width:32px;min-height:32px;color:#6b7280}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{min-width:28px;min-height:28px}}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]:hover{background:#f3f4f6}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{color:#9ca3af}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]:hover{background:#374151}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(8,1fr);gap:.5rem;padding:1rem;max-height:250px;overflow-y:auto}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(6,1fr);gap:.375rem;padding:.75rem;max-height:200px}}@media (max-width: 360px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(5,1fr);gap:.25rem;padding:.625rem}}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:.75rem;border:2px solid #e5e7eb;border-radius:8px;cursor:pointer;transition:all .2s ease;min-height:44px;position:relative}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{padding:.625rem;min-height:40px}}@media (max-width: 360px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{padding:.5rem;min-height:36px}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{border-color:#4b5563}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]:hover{border-color:#3b82f6;transform:scale(1.1);box-shadow:0 4px 12px #00000026}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option.selected[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f64d}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option.selected[_ngcontent-%COMP%]:after{content:"\\2713";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-weight:700;font-size:14px;text-shadow:0 1px 2px rgba(0,0,0,.5)}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option.selected[_ngcontent-%COMP%]:after{font-size:12px}}.bottom-spacing[_ngcontent-%COMP%]{height:2rem}@media (max-width: 480px){.bottom-spacing[_ngcontent-%COMP%]{height:1.5rem}}@media (max-width: 360px){.bottom-spacing[_ngcontent-%COMP%]{height:1rem}}.icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar, .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track, .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.dark[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track, .dark[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#374151}.icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.dark[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .dark[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#6b7280}.icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.dark[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .dark[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;padding:1rem;border:2px solid #e5e7eb;border-radius:8px;background:transparent;cursor:pointer;transition:all .2s ease;min-height:48px}@media (max-width: 480px){.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]{padding:.875rem;min-height:44px}}@media (max-width: 360px){.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]{padding:.75rem;min-height:40px}}.dark[_ngcontent-%COMP%]   .budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]{border-color:#4b5563}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#f0f9ff}.dark[_ngcontent-%COMP%]   .budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]:hover{background:#1e3a8a}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button.active[_ngcontent-%COMP%]{border-color:#3b82f6;background:#f0f9ff}.dark[_ngcontent-%COMP%]   .budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button.active[_ngcontent-%COMP%]{background:#1e3a8a}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{color:#6b7280;transition:transform .2s ease}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .toggle-text[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151}@media (max-width: 480px){.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .toggle-text[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 360px){.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .toggle-text[_ngcontent-%COMP%]{font-size:.75rem}}.dark[_ngcontent-%COMP%]   .budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .toggle-text[_ngcontent-%COMP%]{color:#f3f4f6}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .budget-icon[_ngcontent-%COMP%]{color:#3b82f6}.budget-section[_ngcontent-%COMP%]{background:#f8fafc;border-radius:8px;padding:1rem;margin-top:.5rem;border:1px solid #e2e8f0}@media (max-width: 480px){.budget-section[_ngcontent-%COMP%]{padding:.875rem;margin-top:.375rem}}@media (max-width: 360px){.budget-section[_ngcontent-%COMP%]{padding:.75rem;margin-top:.25rem}}.dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]{background:#1e293b;border-color:#334155}.budget-section[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}@media (max-width: 480px){.budget-section[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{gap:.875rem}}@media (max-width: 360px){.budget-section[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{gap:.75rem}}.budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]{width:100%}.budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151}@media (max-width: 480px){.budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 360px){.budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:.75rem}}.dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{color:#f3f4f6}.budget-section[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem;border:1px solid #d1d5db;border-radius:8px;background:transparent;font-size:16px;min-height:48px;transition:all .2s ease}@media (max-width: 480px){.budget-section[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{padding:.75rem .875rem;min-height:44px;font-size:15px}}@media (max-width: 360px){.budget-section[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{padding:.625rem .75rem;min-height:40px;font-size:14px}}.dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{border-color:#4b5563;color:#f9fafb}.budget-section[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}@media (max-width: 480px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:.75rem}.form-field[_ngcontent-%COMP%]{padding:1rem}.type-selector[_ngcontent-%COMP%]{gap:.5rem}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{padding:.75rem;min-height:70px}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem}.budget-section[_ngcontent-%COMP%]{padding:.75rem}.budget-section[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{gap:.75rem}}@media (max-width: 360px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:.5rem}.form-field[_ngcontent-%COMP%]{padding:.875rem}.type-selector[_ngcontent-%COMP%]{gap:.375rem}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{padding:.625rem;min-height:60px}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.7rem}.budget-section[_ngcontent-%COMP%]{padding:.625rem}.budget-section[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{gap:.625rem}}@media (max-height: 500px) and (orientation: landscape){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:.5rem}.form-field[_ngcontent-%COMP%]{padding:.75rem}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{min-height:60px;padding:.5rem}.budget-section[_ngcontent-%COMP%]{padding:.75rem}}@media (-webkit-min-device-pixel-ratio: 2),(min-resolution: 192dpi){.form-field[_ngcontent-%COMP%], .mobile-header[_ngcontent-%COMP%]{box-shadow:0 .5px 1.5px #0000001a}}@media (hover: none) and (pointer: coarse){.type-option[_ngcontent-%COMP%], .icon-option[_ngcontent-%COMP%], .color-option[_ngcontent-%COMP%], .budget-toggle-button[_ngcontent-%COMP%]{min-height:44px}.type-option[_ngcontent-%COMP%]:hover, .icon-option[_ngcontent-%COMP%]:hover, .color-option[_ngcontent-%COMP%]:hover, .budget-toggle-button[_ngcontent-%COMP%]:hover{transform:none}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{min-height:44px}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}']});let e=i;return e})();var Kr=Yr(Xr());var Q3=["searchSelectInput"],J3=["innerSelectSearch"],e4=[[["",8,"mat-select-search-custom-header-content"]],[["","ngxMatSelectSearchClear",""]],[["","ngxMatSelectNoEntriesFound",""]]],t4=[".mat-select-search-custom-header-content","[ngxMatSelectSearchClear]","[ngxMatSelectNoEntriesFound]"];function n4(e,i){if(e&1){let n=ue();s(0,"mat-checkbox",10),F("change",function(r){R(n);let a=v();return B(a._emitSelectAllBooleanToParent(r.checked))}),c()}if(e&2){let n=v();P("color",n.matFormField==null?null:n.matFormField.color)("checked",n.toggleAllCheckboxChecked)("indeterminate",n.toggleAllCheckboxIndeterminate)("matTooltip",n.toggleAllCheckboxTooltipMessage)("matTooltipPosition",n.toggleAllCheckboxTooltipPosition)}}function i4(e,i){e&1&&re(0,"mat-spinner",7)}function r4(e,i){e&1&&e0(0,1)}function a4(e,i){if(e&1&&re(0,"mat-icon",12),e&2){let n=v(2);P("svgIcon",n.closeSvgIcon)}}function o4(e,i){if(e&1&&(s(0,"mat-icon"),d(1),c()),e&2){let n=v(2);u(),ne(" ",n.closeIcon," ")}}function s4(e,i){if(e&1){let n=ue();s(0,"button",11),F("click",function(){R(n);let r=v();return B(r._reset(!0))}),N(1,r4,1,0)(2,a4,1,1,"mat-icon",12)(3,o4,2,1,"mat-icon"),c()}if(e&2){let n=v();u(),we(n.clearIcon?1:n.closeSvgIcon?2:3)}}function c4(e,i){e&1&&e0(0,2)}function l4(e,i){if(e&1&&d(0),e&2){let n=v(2);ne(" ",n.noEntriesFoundLabel," ")}}function d4(e,i){if(e&1&&(s(0,"div",9),N(1,c4,1,0)(2,l4,1,1),c()),e&2){let n=v();u(),we(n.noEntriesFound?1:2)}}var m4=(()=>{let i=class i{};bt(i,"\u0275fac",function(r){return new(r||i)}),bt(i,"\u0275dir",bs({type:i,selectors:[["","ngxMatSelectSearchClear",""]],standalone:!0}));let e=i;return e})(),g4=["ariaLabel","clearSearchInput","closeIcon","closeSvgIcon","disableInitialFocus","disableScrollToActiveOnOptionsChanged","enableClearOnEscapePressed","hideClearSearchButton","noEntriesFoundLabel","placeholderLabel","preventHomeEndKeyPropagation","searching"],u4=new wa("mat-selectsearch-default-options"),p4=(()=>{let i=class i{};bt(i,"\u0275fac",function(r){return new(r||i)}),bt(i,"\u0275dir",bs({type:i,selectors:[["","ngxMatSelectNoEntriesFound",""]],standalone:!0}));let e=i;return e})(),Gl=(()=>{let i=class i{constructor(t,r,a,o,l,m){bt(this,"matSelect");bt(this,"changeDetectorRef");bt(this,"_viewportRuler");bt(this,"matOption");bt(this,"matFormField");bt(this,"placeholderLabel","Suche");bt(this,"type","text");bt(this,"closeIcon","close");bt(this,"closeSvgIcon");bt(this,"noEntriesFoundLabel","Keine Optionen gefunden");bt(this,"clearSearchInput",!0);bt(this,"searching",!1);bt(this,"disableInitialFocus",!1);bt(this,"enableClearOnEscapePressed",!1);bt(this,"preventHomeEndKeyPropagation",!1);bt(this,"disableScrollToActiveOnOptionsChanged",!1);bt(this,"ariaLabel","dropdown search");bt(this,"showToggleAllCheckbox",!1);bt(this,"toggleAllCheckboxChecked",!1);bt(this,"toggleAllCheckboxIndeterminate",!1);bt(this,"toggleAllCheckboxTooltipMessage","");bt(this,"toggleAllCheckboxTooltipPosition","below");bt(this,"hideClearSearchButton",!1);bt(this,"alwaysRestoreSelectedOptionsMulti",!1);bt(this,"recreateValuesArray",!1);bt(this,"toggleAll",new _n);bt(this,"searchSelectInput");bt(this,"innerSelectSearch");bt(this,"clearIcon");bt(this,"noEntriesFound");bt(this,"_lastExternalInputValue");bt(this,"onTouched",()=>{});bt(this,"_options$",new on(null));bt(this,"optionsList$",this._options$.pipe(wr(t=>t?t.changes.pipe(We(r=>r.toArray()),o1(t.toArray())):gt(null))));bt(this,"optionsLength$",this.optionsList$.pipe(We(t=>t?t.length:0)));bt(this,"previousSelectedValues");bt(this,"_formControl",new dc("",{nonNullable:!0}));bt(this,"_showNoEntriesFound$",Or([this._formControl.valueChanges,this.optionsLength$]).pipe(We(([t,r])=>!!(this.noEntriesFoundLabel&&t&&r===this.getOptionsLengthOffset()))));bt(this,"_onDestroy",new Bt);bt(this,"activeDescendant");this.matSelect=t,this.changeDetectorRef=r,this._viewportRuler=a,this.matOption=o,this.matFormField=l,this.applyDefaultOptions(m)}get value(){return this._formControl.value}set _options(t){this._options$.next(t)}get _options(){return this._options$.getValue()}applyDefaultOptions(t){if(t)for(let r of g4)Object.prototype.hasOwnProperty.call(t,r)&&(this[r]=t[r])}ngOnInit(){this.matOption?(this.matOption.disabled=!0,this.matOption._getHostElement().classList.add("contains-mat-select-search"),this.matOption._getHostElement().setAttribute("role","presentation")):console.error("<ngx-mat-select-search> must be placed inside a <mat-option> element"),this.matSelect.openedChange.pipe(t1(1),yt(this._onDestroy)).subscribe(t=>{t?(this.updateInputWidth(),this.disableInitialFocus||this._focus()):this.clearSearchInput&&this._reset()}),this.matSelect.openedChange.pipe(tr(1),wr(()=>{this._options=this.matSelect.options;let t=this._options.toArray()[this.getOptionsLengthOffset()];return this._options.changes.pipe(Mu(()=>{setTimeout(()=>{let r=this._options.toArray(),a=r[this.getOptionsLengthOffset()],o=this.matSelect._keyManager;o&&this.matSelect.panelOpen&&a&&((!t||!this.matSelect.compareWith(t.value,a.value)||!o.activeItem||!r.find(m=>{var g;return this.matSelect.compareWith(m.value,(g=o.activeItem)==null?void 0:g.value)}))&&o.setActiveItem(this.getOptionsLengthOffset()),setTimeout(()=>{this.updateInputWidth()})),t=a})}))})).pipe(yt(this._onDestroy)).subscribe(),this._showNoEntriesFound$.pipe(yt(this._onDestroy)).subscribe(t=>{this.matOption&&(t?this.matOption._getHostElement().classList.add("mat-select-search-no-entries-found"):this.matOption._getHostElement().classList.remove("mat-select-search-no-entries-found"))}),this._viewportRuler.change().pipe(yt(this._onDestroy)).subscribe(()=>{this.matSelect.panelOpen&&this.updateInputWidth()}),this.initMultipleHandling(),this.optionsList$.pipe(yt(this._onDestroy)).subscribe(()=>{this.changeDetectorRef.markForCheck()})}_emitSelectAllBooleanToParent(t){this.toggleAll.emit(t)}ngOnDestroy(){this._onDestroy.next(),this._onDestroy.complete()}_isToggleAllCheckboxVisible(){return this.matSelect.multiple&&this.showToggleAllCheckbox}_handleKeydown(t){(t.key&&t.key.length===1||this.preventHomeEndKeyPropagation&&(t.key==="Home"||t.key==="End"))&&t.stopPropagation(),this.matSelect.multiple&&t.key&&t.key==="Enter"&&setTimeout(()=>this._focus()),this.enableClearOnEscapePressed&&t.key==="Escape"&&this.value&&(this._reset(!0),t.stopPropagation())}_handleKeyup(t){if(t.key==="ArrowUp"||t.key==="ArrowDown"){let r=this.matSelect._getAriaActiveDescendant(),a=this._options.toArray().findIndex(o=>o.id===r);a!==-1&&(this.unselectActiveDescendant(),this.activeDescendant=this._options.toArray()[a]._getHostElement(),this.activeDescendant.setAttribute("aria-selected","true"),this.searchSelectInput.nativeElement.setAttribute("aria-activedescendant",r))}}writeValue(t){this._lastExternalInputValue=t,this._formControl.setValue(t),this.changeDetectorRef.markForCheck()}onBlur(){this.unselectActiveDescendant(),this.onTouched()}registerOnChange(t){this._formControl.valueChanges.pipe(Bi(r=>r!==this._lastExternalInputValue),Mu(()=>this._lastExternalInputValue=void 0),yt(this._onDestroy)).subscribe(t)}registerOnTouched(t){this.onTouched=t}_focus(){if(!this.searchSelectInput||!this.matSelect.panel)return;let t=this.matSelect.panel.nativeElement,r=t.scrollTop;this.searchSelectInput.nativeElement.focus(),t.scrollTop=r}_reset(t){this._formControl.setValue(""),t&&this._focus()}initMultipleHandling(){if(!this.matSelect.ngControl){this.matSelect.multiple&&console.error("the mat-select containing ngx-mat-select-search must have a ngModel or formControl directive when multiple=true");return}this.previousSelectedValues=this.matSelect.ngControl.value,this.matSelect.ngControl.valueChanges&&this.matSelect.ngControl.valueChanges.pipe(yt(this._onDestroy)).subscribe(t=>{let r=!1;if(this.matSelect.multiple&&(this.alwaysRestoreSelectedOptionsMulti||this._formControl.value&&this._formControl.value.length)&&this.previousSelectedValues&&Array.isArray(this.previousSelectedValues)){(!t||!Array.isArray(t))&&(t=[]);let a=this.matSelect.options.map(o=>o.value);this.previousSelectedValues.forEach(o=>{!t.some(l=>this.matSelect.compareWith(l,o))&&!a.some(l=>this.matSelect.compareWith(l,o))&&(this.recreateValuesArray?t=[...t,o]:t.push(o),r=!0)})}this.previousSelectedValues=t,r&&this.matSelect._onChange(t)})}updateInputWidth(){if(!this.innerSelectSearch||!this.innerSelectSearch.nativeElement)return;let t=this.innerSelectSearch.nativeElement,r=null;for(;t&&t.parentElement;)if(t=t.parentElement,t.classList.contains("mat-select-panel")){r=t;break}r&&(this.innerSelectSearch.nativeElement.style.width=r.clientWidth+"px")}getOptionsLengthOffset(){return this.matOption?1:0}unselectActiveDescendant(){var t;(t=this.activeDescendant)==null||t.removeAttribute("aria-selected"),this.searchSelectInput.nativeElement.removeAttribute("aria-activedescendant")}};bt(i,"\u0275fac",function(r){return new(r||i)(Y(wi),Y(k1),Y(R_),Y(yi,8),Y(Oi,8),Y(u4,8))}),bt(i,"\u0275cmp",Re({type:i,selectors:[["ngx-mat-select-search"]],contentQueries:function(r,a,o){if(r&1&&(Su(o,m4,5),Su(o,p4,5)),r&2){let l;Ni(l=Li())&&(a.clearIcon=l.first),Ni(l=Li())&&(a.noEntriesFound=l.first)}},viewQuery:function(r,a){if(r&1&&(ar(Q3,7,xo),ar(J3,7,xo)),r&2){let o;Ni(o=Li())&&(a.searchSelectInput=o.first),Ni(o=Li())&&(a.innerSelectSearch=o.first)}},inputs:{placeholderLabel:"placeholderLabel",type:"type",closeIcon:"closeIcon",closeSvgIcon:"closeSvgIcon",noEntriesFoundLabel:"noEntriesFoundLabel",clearSearchInput:"clearSearchInput",searching:"searching",disableInitialFocus:"disableInitialFocus",enableClearOnEscapePressed:"enableClearOnEscapePressed",preventHomeEndKeyPropagation:"preventHomeEndKeyPropagation",disableScrollToActiveOnOptionsChanged:"disableScrollToActiveOnOptionsChanged",ariaLabel:"ariaLabel",showToggleAllCheckbox:"showToggleAllCheckbox",toggleAllCheckboxChecked:"toggleAllCheckboxChecked",toggleAllCheckboxIndeterminate:"toggleAllCheckboxIndeterminate",toggleAllCheckboxTooltipMessage:"toggleAllCheckboxTooltipMessage",toggleAllCheckboxTooltipPosition:"toggleAllCheckboxTooltipPosition",hideClearSearchButton:"hideClearSearchButton",alwaysRestoreSelectedOptionsMulti:"alwaysRestoreSelectedOptionsMulti",recreateValuesArray:"recreateValuesArray"},outputs:{toggleAll:"toggleAll"},standalone:!0,features:[v1([{provide:U1,useExisting:d1(()=>i),multi:!0}]),ia],ngContentSelectors:t4,decls:13,vars:14,consts:[["innerSelectSearch",""],["searchSelectInput",""],["matInput","",1,"mat-select-search-input","mat-select-search-hidden"],[1,"mat-select-search-inner","mat-typography","mat-datepicker-content","mat-tab-header"],[1,"mat-select-search-inner-row"],["matTooltipClass","ngx-mat-select-search-toggle-all-tooltip",1,"mat-select-search-toggle-all-checkbox",3,"color","checked","indeterminate","matTooltip","matTooltipPosition"],["autocomplete","off",1,"mat-select-search-input",3,"keydown","keyup","blur","type","formControl","placeholder"],["diameter","16",1,"mat-select-search-spinner"],["mat-icon-button","","aria-label","Clear",1,"mat-select-search-clear"],[1,"mat-select-search-no-entries-found"],["matTooltipClass","ngx-mat-select-search-toggle-all-tooltip",1,"mat-select-search-toggle-all-checkbox",3,"change","color","checked","indeterminate","matTooltip","matTooltipPosition"],["mat-icon-button","","aria-label","Clear",1,"mat-select-search-clear",3,"click"],[3,"svgIcon"]],template:function(r,a){if(r&1){let o=ue();x1(e4),re(0,"input",2),s(1,"div",3,0)(3,"div",4),N(4,n4,1,5,"mat-checkbox",5),s(5,"input",6,1),F("keydown",function(m){return R(o),B(a._handleKeydown(m))})("keyup",function(m){return R(o),B(a._handleKeyup(m))})("blur",function(){return R(o),B(a.onBlur())}),c(),N(7,i4,1,0,"mat-spinner",7)(8,s4,4,1,"button",8),e0(9),c(),re(10,"mat-divider"),c(),N(11,d4,3,1,"div",9),ce(12,"async")}r&2&&(u(),ze("mat-select-search-inner-multiple",a.matSelect.multiple)("mat-select-search-inner-toggle-all",a._isToggleAllCheckboxVisible()),u(3),we(a._isToggleAllCheckboxVisible()?4:-1),u(),P("type",a.type)("formControl",a._formControl)("placeholder",a.placeholderLabel),Wr("aria-label",a.ariaLabel),u(2),we(a.searching?7:-1),u(),we(!a.hideClearSearchButton&&a.value&&!a.searching?8:-1),u(3),we(xe(12,12,a._showNoEntriesFound$)?11:-1))},dependencies:[Vi,$1,Nt,At,mc,za,Ic,Tn,Br,Qe,X0,gn],styles:[".mat-select-search-hidden[_ngcontent-%COMP%]{visibility:hidden}.mat-select-search-inner[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;z-index:100;font-size:inherit;box-shadow:none;background-color:var(--mat-sys-surface-container, var(--mat-select-panel-background-color, white))}.mat-select-search-inner.mat-select-search-inner-multiple.mat-select-search-inner-toggle-all[_ngcontent-%COMP%]   .mat-select-search-inner-row[_ngcontent-%COMP%]{display:flex;align-items:center}.mat-select-search-input[_ngcontent-%COMP%]{box-sizing:border-box;width:100%;border:none;font-family:inherit;font-size:inherit;color:currentColor;outline:none;background-color:var(--mat-sys-surface-container, var(--mat-select-panel-background-color, white));padding:0 44px 0 16px;height:47px;line-height:47px}[dir=rtl][_nghost-%COMP%]   .mat-select-search-input[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .mat-select-search-input[_ngcontent-%COMP%]{padding-right:16px;padding-left:44px}.mat-select-search-input[_ngcontent-%COMP%]::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}.mat-select-search-inner-toggle-all[_ngcontent-%COMP%]   .mat-select-search-input[_ngcontent-%COMP%]{padding-left:5px}.mat-select-search-no-entries-found[_ngcontent-%COMP%]{padding-top:8px}.mat-select-search-clear[_ngcontent-%COMP%]{position:absolute;right:4px;top:0}[dir=rtl][_nghost-%COMP%]   .mat-select-search-clear[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .mat-select-search-clear[_ngcontent-%COMP%]{right:auto;left:4px}.mat-select-search-spinner[_ngcontent-%COMP%]{position:absolute;right:16px;top:calc(50% - 8px)}[dir=rtl][_nghost-%COMP%]   .mat-select-search-spinner[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .mat-select-search-spinner[_ngcontent-%COMP%]{right:auto;left:16px}  .mat-mdc-option[aria-disabled=true].contains-mat-select-search{position:sticky;top:-8px;z-index:1;opacity:1;margin-top:-8px;pointer-events:all}  .mat-mdc-option[aria-disabled=true].contains-mat-select-search .mat-icon{margin-right:0;margin-left:0}  .mat-mdc-option[aria-disabled=true].contains-mat-select-search mat-pseudo-checkbox{display:none}  .mat-mdc-option[aria-disabled=true].contains-mat-select-search .mdc-list-item__primary-text{opacity:1}.mat-select-search-toggle-all-checkbox[_ngcontent-%COMP%]{padding-left:5px}[dir=rtl][_nghost-%COMP%]   .mat-select-search-toggle-all-checkbox[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .mat-select-search-toggle-all-checkbox[_ngcontent-%COMP%]{padding-left:0;padding-right:5px}"],changeDetection:0}));let e=i;return e})();var sC=(()=>{let i=class i{};bt(i,"\u0275fac",function(r){return new(r||i)}),bt(i,"\u0275mod",ir({type:i})),bt(i,"\u0275inj",nr({imports:[Gl]}));let e=i;return e})();var f4=["amountInput"],h4=(e,i)=>i.accountId,_4=(e,i)=>i.value,x4=(e,i)=>i.id,C4=(e,i)=>i.categoryId;function v4(e,i){if(e&1&&(s(0,"p",6),d(1),c()),e&2){let n=v();u(),L(n.getAmountError())}}function b4(e,i){e&1&&(s(0,"p",9),d(1,"Description is required"),c())}function y4(e,i){if(e&1){let n=ue();s(0,"button",44),F("click",function(){R(n);let r=v();return B(r.openNewCategoryDialog())}),s(1,"mat-icon",45),d(2,"add"),c(),d(3,"Add "),c()}}function M4(e,i){if(e&1&&(s(0,"mat-option",24),d(1),c()),e&2){let n=i.$implicit;P("value",n.id),u(),ne(" ",n.name," ")}}function P4(e,i){if(e&1&&(s(0,"p",6),d(1),c()),e&2){let n=v();u(),L(n.getDateError())}}function O4(e,i){if(e&1){let n=ue();s(0,"button",44),F("click",function(){R(n);let r=v();return B(r.openNewAccountDialog())}),s(1,"mat-icon",45),d(2,"add"),c(),d(3," Add "),c()}}function w4(e,i){if(e&1&&(s(0,"mat-option",24),d(1),ce(2,"titlecase"),c()),e&2){let n=i.$implicit;P("value",n.accountId),u(),$t("",n.name," (",xe(2,3,n.type),")")}}function S4(e,i){e&1&&(s(0,"mat-error"),d(1,"Account is required"),c())}function k4(e,i){if(e&1&&(s(0,"mat-option",24)(1,"div",34)(2,"mat-icon",45),d(3),c(),s(4,"span"),d(5),c()()()),e&2){let n=i.$implicit;P("value",n.value),u(3),L(n.icon),u(2),L(n.label)}}function T4(e,i){if(e&1&&(s(0,"div",21)(1,"label",4),d(2," Payment Method "),c(),s(3,"mat-form-field",14)(4,"mat-label"),d(5,"Select payment method"),c(),s(6,"mat-select",46)(7,"mat-option",47),d(8,"None"),c(),Ge(9,k4,6,3,"mat-option",24,_4),c()()()),e&2){let n=v();u(6),P("disabled",n.viewMode),u(3),He(n.paymentMethods)}}function E4(e,i){if(e&1&&(s(0,"mat-option",24)(1,"div",49)(2,"span"),d(3),c(),s(4,"span",10),d(5),c()()()),e&2){let n=i.$implicit;P("value",n.id),u(3),L(n.name),u(2),ne("",n.members.length," members")}}function I4(e,i){e&1&&(s(0,"mat-error"),d(1,"Please select a group for split transaction"),c())}function A4(e,i){if(e&1&&(s(0,"div",29)(1,"div")(2,"label",4),d(3," Select Group * "),c(),s(4,"mat-form-field",14)(5,"mat-label"),d(6,"Choose a group to split with"),c(),s(7,"mat-select",48),Ge(8,E4,6,3,"mat-option",24,x4),ce(10,"async"),c(),N(11,I4,2,0,"mat-error"),c()()()),e&2){let n,t=v();u(7),P("disabled",t.viewMode),u(),He(xe(10,2,t.groups$)),u(3),we((n=t.transactionForm.get("splitGroupId"))!=null&&n.hasError("required")&&((n=t.transactionForm.get("splitGroupId"))!=null&&n.touched)?11:-1)}}function D4(e,i){if(e&1&&(s(0,"div",55)(1,"span"),d(2),c(),s(3,"span",60),d(4),c()()),e&2){let n=i.$implicit;u(2),L(n.categoryName),u(2),$t("\u20B9",n.amount.toFixed(2)," (",n.percentage.toFixed(1),"%)")}}function F4(e,i){if(e&1){let n=ue();s(0,"div",29)(1,"div",50)(2,"div",51)(3,"mat-icon",52),d(4,"category"),c(),s(5,"span",53),d(6,"Category Splits"),c()(),s(7,"div",54),Ge(8,D4,5,3,"div",55,C4),s(10,"div",56)(11,"div",57)(12,"span"),d(13,"Total"),c(),s(14,"span"),d(15),c()()()()(),s(16,"div",58)(17,"button",59),F("click",function(){R(n);let r=v();return B(r.openCategorySplitDialog())}),s(18,"mat-icon",45),d(19,"edit"),c(),d(20," Edit Category Splits "),c()()()}if(e&2){let n=v();u(8),He(n.categorySplits),u(7),ne("\u20B9",n.getTotalSplitAmount().toFixed(2),"")}}function R4(e,i){if(e&1&&(s(0,"p"),d(1),c()),e&2){let n,t=v(2);u(),ne("\u2022 Until ",(n=t.transactionForm.get("recurringEndDate"))==null?null:n.value,"")}}function B4(e,i){if(e&1&&(s(0,"div",29)(1,"div")(2,"label",4),d(3," Repeat Every "),c(),s(4,"mat-form-field",14)(5,"mat-label"),d(6,"Select interval"),c(),s(7,"mat-select",61)(8,"mat-option",24),d(9,"Daily"),c(),s(10,"mat-option",24),d(11,"Weekly"),c(),s(12,"mat-option",24),d(13,"Monthly"),c(),s(14,"mat-option",24),d(15,"Yearly"),c()()()(),s(16,"div")(17,"label",4),d(18," Start Date "),c(),re(19,"input",62),c(),s(20,"div")(21,"label",4),d(22," End Date (Optional) "),c(),re(23,"input",63),s(24,"p",64),d(25,"Leave empty for unlimited recurrence"),c()(),s(26,"div",65)(27,"div",51)(28,"mat-icon",66),d(29,"info"),c(),s(30,"span",67),d(31,"Recurring Details"),c()(),s(32,"div",68)(33,"p"),d(34),c(),s(35,"p"),d(36),c(),N(37,R4,2,1,"p"),s(38,"p"),d(39,"\u2022 You'll be notified when each occurrence is due"),c()()()()),e&2){let n,t,r,a=v();u(7),P("disabled",a.viewMode),u(),P("value","daily"),u(2),P("value","weekly"),u(2),P("value","monthly"),u(2),P("value","yearly"),u(5),ze("bg-gray-100",a.viewMode),P("min",a.recurringMinDate)("max",a.recurringMaxDate)("disabled",a.viewMode),u(4),ze("bg-gray-100",a.viewMode),P("min",a.recurringMinDate)("max",a.recurringMaxDate)("disabled",a.viewMode),u(11),ne("\u2022 Transaction will repeat ",((n=a.transactionForm.get("recurringInterval"))==null?null:n.value)||"monthly",""),u(2),ne("\u2022 Starting from ",((t=a.transactionForm.get("recurringStartDate"))==null?null:t.value)||"today",""),u(),we((r=a.transactionForm.get("recurringEndDate"))!=null&&r.value?37:-1)}}function N4(e,i){if(e&1&&(s(0,"span",37),d(1),c()),e&2){let n,t=v();u(),ne(" \u20B9",(((n=t.transactionForm.get("taxAmount"))==null?null:n.value)||0).toFixed(2)," ")}}function L4(e,i){if(e&1&&(s(0,"div",72)(1,"span",70),d(2,"Tax Amount:"),c(),s(3,"span",73),d(4),c()(),s(5,"div",74)(6,"span",75),d(7,"Total Amount:"),c(),s(8,"span",76),d(9),c()()),e&2){let n,t,r=v(2);u(4),ne(" +\u20B9",(((n=r.transactionForm.get("taxAmount"))==null?null:n.value)||0).toFixed(2)," "),u(5),ne(" \u20B9",((((t=r.transactionForm.get("amount"))==null?null:t.value)||0)+(((t=r.transactionForm.get("taxAmount"))==null?null:t.value)||0)).toFixed(2)," ")}}function V4(e,i){if(e&1&&(s(0,"div",39)(1,"div",69)(2,"span",70),d(3,"Transaction Amount:"),c(),s(4,"span",71),d(5),c()(),N(6,L4,10,2),c()),e&2){let n,t,r=v();u(5),ne(" \u20B9",(((n=r.transactionForm.get("amount"))==null?null:n.value)||0).toFixed(2)," "),u(),we((((t=r.transactionForm.get("taxAmount"))==null?null:t.value)||0)>0?6:-1)}}function U4(e,i){e&1&&(s(0,"p",6),d(1,"Tax amount cannot be negative"),c())}function z4(e,i){e&1&&(s(0,"p",9),d(1,"Tax percentage cannot be negative"),c())}function j4(e,i){e&1&&(s(0,"p",9),d(1,"Tax percentage cannot exceed 100%"),c())}function $4(e,i){if(e&1){let n=ue();s(0,"button",78),F("click",function(){R(n);let r=v(2);return B(r.clearTaxFields())}),s(1,"mat-icon",79),d(2,"clear"),c(),d(3," Clear Tax Fields "),c()}}function Y4(e,i){if(e&1&&(s(0,"div",42),N(1,$4,4,0,"button",77),c()),e&2){let n=v();u(),P("ngIf",!n.viewMode)}}var Es=(()=>{let i=class i{constructor(t,r,a,o,l,m,g,f,h,x,C,y,b,w){this.dialogData=t,this.store=r,this.fb=a,this.dialogRef=o,this.auth=l,this.notificationService=m,this.router=g,this.hapticFeedback=f,this.dialog=h,this.loaderService=x,this.dateService=C,this.validationService=y,this.breakpointObserver=b,this.breakpointService=w,this.isSubmitting=!1,this.isMobile=!1,this.paymentMethods=[{value:qo.CREDIT_CARD,label:"Credit Card",icon:"credit_card"},{value:qo.DEBIT_CARD,label:"Debit Card",icon:"credit_card"},{value:qo.BANK_TRANSFER,label:"Bank Transfer",icon:"account_balance"},{value:qo.CASH,label:"Cash",icon:"money"},{value:qo.DIGITAL_WALLET,label:"Digital Wallet",icon:"account_balance_wallet"}],this.editMode=!1,this.viewMode=!1,this.TransactionType=Lt,this.categorySplits=[],this.isCategorySplit=!1,this.categoryFilterCtrl=new dc,this.filteredCategories=new ho(1),this._onDestroy=new Bt,this.recurringMinDate=(0,Kr.default)().add(1,"day").format("YYYY-MM-DD"),this.recurringMaxDate=(0,Kr.default)().add(1,"year").format("YYYY-MM-DD"),this.store.dispatch(V_()),this.groups$=this.store.select(ax),this.categoryList$=this.store.select(un),this.accountList$=this.store.select(ca),this.categoryList$.subscribe(A=>{this.filteredCategories.next(A.slice())}),this.categoryFilterCtrl.valueChanges.pipe(yt(this._onDestroy)).subscribe(()=>{this.filterCategories()}),this.transactionForm=this.fb.group({payee:["",this.validationService.getTransactionPayeeValidators()],amount:["",this.validationService.getTransactionAmountValidators()],date:[(0,Kr.default)().format("YYYY-MM-DD"),tt.required],description:[""],categoryId:[""],categoryName:[""],categoryType:[""],accountId:["",tt.required],taxAmount:[0,[tt.min(0)]],taxPercentage:[0,[tt.min(0),tt.max(100)]],taxes:[[]],paymentMethod:[""],isRecurring:[!1],recurringInterval:[oa.MONTHLY],recurringStartDate:[(0,Kr.default)().format("YYYY-MM-DD")],recurringEndDate:[(0,Kr.default)().add(1,"year").format("YYYY-MM-DD")],recurringAmount:[0],recurringNotes:[""],recurringCategoryId:[""],recurringCategoryName:[""],isSplitTransaction:[!1],splitGroupId:[""],splitAmount:[0],isCategorySplit:[!1]}),this.isMobile=this.breakpointObserver.isMatched("(max-width: 640px)")}ngOnInit(){var t;this.userId=(t=this.auth.currentUser)==null?void 0:t.uid,this.initializeFormData(),window.addEventListener("popstate",r=>{this.dialogRef.close(),r.preventDefault()})}patchTransactionForm(t){var r,a,o;this.transactionForm.patchValue({payee:t.payee||"",amount:t.amount||"",date:t.date?(0,Kr.default)(this.dateService.toDate(t.date)).format("YYYY-MM-DD"):(0,Kr.default)().format("YYYY-MM-DD"),description:t.notes||"",categoryId:t.categoryId||"",categoryName:t.categoryName||"",categoryType:t.categoryType||t.type||"",accountId:t.accountId||"",taxAmount:t.taxAmount||0,taxPercentage:t.taxPercentage||0,taxes:t.taxes||[],paymentMethod:t.paymentMethod||"",isRecurring:t.isRecurring||!1,recurringInterval:t.recurringInterval||oa.MONTHLY,recurringStartDate:t.nextOccurrence?(0,Kr.default)(this.dateService.toDate(t.nextOccurrence)).format("YYYY-MM-DD"):(0,Kr.default)().format("YYYY-MM-DD"),recurringEndDate:t.recurringEndDate?(0,Kr.default)(this.dateService.toDate(t.recurringEndDate)).format("YYYY-MM-DD"):(0,Kr.default)().add(1,"year").format("YYYY-MM-DD")}),(r=this.transactionForm.get("isSplitTransaction"))==null||r.setValue(t.isSplitTransaction||!1),(a=this.transactionForm.get("splitGroupId"))==null||a.setValue(t.splitGroupId||""),(o=this.transactionForm.get("splitAmount"))==null||o.setValue(t.splitAmount||0),this.onCategoryChange(t.categoryId)}initializeFormData(){var t,r,a;((t=this.dialogData)==null?void 0:t.mode)==="view"&&((r=this.dialogData)!=null&&r.transaction)?(this.viewMode=!0,this.editMode=!1,this.patchTransactionForm(this.dialogData.transaction),this.transactionForm.disable()):(a=this.dialogData)!=null&&a.id?(this.editMode=!0,this.patchTransactionForm(this.dialogData)):(this.transactionForm.patchValue({payee:"",amount:"",date:(0,Kr.default)().format("YYYY-MM-DD"),description:"",categoryId:"",categoryName:"",categoryType:"",accountId:"",taxAmount:0,taxPercentage:0,taxes:[],paymentMethod:""}),this.getRecentTransaction())}getRecentTransaction(){this.store.select(gx).pipe(tr(1)).subscribe(t=>{t&&this.transactionForm.patchValue({categoryName:t.category,categoryType:t.type,categoryId:t.categoryId,payee:t.payee,accountId:t.accountId,isSplitTransaction:t.isSplitTransaction,splitGroupId:t.splitGroupId})})}ngAfterViewInit(){this.viewMode||setTimeout(()=>{this.amountInput&&this.amountInput.nativeElement.focus()},200)}onSubmit(){return me(this,null,function*(){var t,r,a;if(!this.viewMode){if(this.transactionForm.markAllAsTouched(),(t=this.transactionForm.get("isSplitTransaction"))!=null&&t.value&&!((r=this.transactionForm.get("splitGroupId"))!=null&&r.value)){this.notificationService.error("Please select a group for split transaction");return}if(this.transactionForm.valid&&!this.isSubmitting){this.isSubmitting=!0;try{this.loaderService.show();let o=this.transactionForm.value,l={payee:o.payee,accountId:o.accountId,amount:parseFloat(o.amount),category:o.categoryName,categoryId:o.categoryId,type:o.categoryType,date:new Date(o.date+" "+this.dateService.now().toDate().toLocaleTimeString()),notes:o.description,taxAmount:o.taxAmount||0,taxPercentage:o.taxPercentage||0,taxes:o.taxes||[],paymentMethod:o.paymentMethod||"",isRecurring:o.isRecurring||!1,recurringInterval:o.recurringInterval||oa.MONTHLY,recurringEndDate:o.recurringEndDate?new Date(o.recurringEndDate):null,nextOccurrence:o.isRecurring?new Date(o.recurringStartDate||o.date):null,status:Xo.COMPLETED,isSplitTransaction:o.isSplitTransaction||!1,splitGroupId:o.splitGroupId||"",isCategorySplit:this.isCategorySplit,categorySplits:this.categorySplits,totalSplitAmount:this.categorySplits.reduce((m,g)=>m+g.amount,0),updatedBy:this.userId,updatedAt:new Date};if((a=this.dialogData)!=null&&a.id)yield this.store.dispatch(Wo({userId:this.userId,transactionId:this.dialogData.id,transaction:l})),this.notificationService.success("Transaction updated successfully");else{let m=yield this.store.dispatch(Yo({userId:this.userId,transaction:le(oe({userId:this.userId},l),{syncStatus:bi.PENDING,createdAt:new Date,updatedAt:new Date,createdBy:this.userId,updatedBy:this.userId})}));this.notificationService.success("Transaction added successfully"),this.hapticFeedback.successVibration()}o.isSplitTransaction&&this.router.navigate(["/dashboard/splitwise/group",o.splitGroupId]),this.dialogRef.close(!0)}catch(o){console.error("Error saving transaction:",o),this.notificationService.error("Failed to save transaction")}finally{this.isSubmitting=!1,this.loaderService.hide()}}}})}onClose(){this.dialogRef.close()}getAmountError(){let t=this.transactionForm.get("amount");return t?this.validationService.getTransactionAmountError(t):""}getDateError(){let t=this.transactionForm.get("date");return t!=null&&t.hasError("required")?"Date is required":""}openNewAccountDialog(){this.dialog.open(Wl,{data:null,disableClose:!0,panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog"})}openEditAccountDialog(t){this.dialog.open(Wl,{data:t,disableClose:!0,panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog"})}openNewCategoryDialog(){this.dialog.open(ks,{data:null,disableClose:!0,panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog"})}onCategoryChange(t){t&&this.categoryList$.pipe(tr(1),We(r=>r.find(a=>a.id===t)),Bi(r=>!!r)).subscribe(r=>{this.transactionForm.patchValue({categoryId:r.id,categoryName:r.name,categoryType:r.type,payee:this.editMode?this.dialogData.payee:r.name})})}onTaxPercentageChange(){var a,o;let t=((a=this.transactionForm.get("amount"))==null?void 0:a.value)||0,r=((o=this.transactionForm.get("taxPercentage"))==null?void 0:o.value)||0;if(t>0&&r>0){let l=t*r/100;this.transactionForm.patchValue({taxAmount:parseFloat(l.toFixed(2))},{emitEvent:!1})}}onTaxAmountChange(){var a,o;let t=((a=this.transactionForm.get("amount"))==null?void 0:a.value)||0,r=((o=this.transactionForm.get("taxAmount"))==null?void 0:o.value)||0;if(t>0&&r>0){let l=r/t*100;this.transactionForm.patchValue({taxPercentage:parseFloat(l.toFixed(2))},{emitEvent:!1})}}onAmountChange(){var a,o;let t=((a=this.transactionForm.get("amount"))==null?void 0:a.value)||0,r=((o=this.transactionForm.get("taxAmount"))==null?void 0:o.value)||0;if(t>0&&r>0){let l=r/t*100;this.transactionForm.patchValue({taxPercentage:parseFloat(l.toFixed(2))},{emitEvent:!1})}}clearTaxFields(){this.transactionForm.patchValue({taxAmount:0,taxPercentage:0,taxes:[]})}toggleSplitTransaction(){var r;let t=this.transactionForm.get("splitGroupId");(r=this.transactionForm.get("isSplitTransaction"))!=null&&r.value?t==null||t.setValidators([tt.required]):(t==null||t.clearValidators(),t==null||t.setValue("")),t==null||t.updateValueAndValidity()}openSplitwise(){this.router.navigate(["/dashboard/splitwise"])}openCategorySplitDialog(){var r,a;this.dialog.open(ux,{width:"600px",maxWidth:"90vw",data:{totalAmount:((r=this.transactionForm.get("amount"))==null?void 0:r.value)||0,existingSplits:this.categorySplits,transactionType:((a=this.transactionForm.get("categoryType"))==null?void 0:a.value)||"expense"}}).afterClosed().subscribe(o=>{o&&(this.categorySplits=o,this.isCategorySplit=!0,this.transactionForm.patchValue({isCategorySplit:!0}),this.notificationService.success("Category splits configured successfully"))})}clearCategorySplits(){this.categorySplits=[],this.isCategorySplit=!1,this.transactionForm.patchValue({isCategorySplit:!1})}getTotalSplitAmount(){return this.categorySplits.reduce((t,r)=>t+r.amount,0)}filterCategories(){this.categoryList$&&this.categoryList$.pipe(tr(1)).subscribe(t=>{let r=this.categoryFilterCtrl.value;if(r)r=r.toLowerCase();else{this.filteredCategories.next(t.slice());return}let a=t.filter(o=>o.name.toLowerCase().indexOf(r)>-1);this.filteredCategories.next(a)})}ngOnDestroy(){this._onDestroy.next(),this._onDestroy.complete()}};i.\u0275fac=function(r){return new(r||i)(Y(Pi),Y(pt),Y(vi),Y(Mi),Y(xt),Y(ft),Y(nn),Y(mr),Y(xn),Y(Ac),Y(Vt),Y(sa),Y(dr),Y(gr))},i.\u0275cmp=Re({type:i,selectors:[["app-mobile-add-transaction"]],viewQuery:function(r,a){if(r&1&&ar(f4,5),r&2){let o;Ni(o=Li())&&(a.amountInput=o.first)}},decls:102,vars:54,consts:[["amountInput",""],["addButtonTooltip","Save Transaction",3,"addButtonClick","closeButtonClick","title","showAddButton","addButtonDisabled","isSubmitting"],[1,"space-y-6",3,"ngSubmit","keydown.enter","formGroup"],[1,"bg-white","dark:bg-gray-800","rounded-lg","p-4","shadow-sm","space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],["type","number","formControlName","amount","placeholder","0.00","step","0.01",1,"w-full","text-2xl","font-bold","text-center","py-3","px-4","border-0","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","rounded-lg",3,"input","disabled"],[1,"text-red-500","text-sm","mt-1"],["type","text","formControlName","payee","placeholder","Enter description",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"maxlength","disabled"],[1,"flex","justify-between","items-center","mt-1"],[1,"text-red-500","text-sm"],[1,"text-xs","text-gray-500"],[1,"flex","items-center","justify-between","mb-2"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","button","class","text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium flex items-center gap-1",3,"click",4,"ngIf"],["appearance","fill",1,"w-full"],["formControlName","categoryId",3,"selectionChange","disabled"],["placeholderLabel","Search categories...","noEntriesFoundLabel","No categories found",3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[1,"relative"],["type","date","formControlName","date",1,"w-full","py-3","px-4","pr-10","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","[&::-webkit-calendar-picker-indicator]:bg-none","[&::-webkit-calendar-picker-indicator]:bg-transparent","[&::-webkit-calendar-picker-indicator]:opacity-0","[&::-webkit-calendar-picker-indicator]:absolute","[&::-webkit-calendar-picker-indicator]:right-0","[&::-webkit-calendar-picker-indicator]:top-0","[&::-webkit-calendar-picker-indicator]:w-full","[&::-webkit-calendar-picker-indicator]:h-full","[&::-webkit-calendar-picker-indicator]:cursor-pointer",3,"disabled"],[1,"absolute","right-3","top-1/2","transform","-translate-y-1/2","text-gray-400","pointer-events-none"],[1,"bg-white","dark:bg-gray-800","rounded-lg","p-4","shadow-sm"],[1,"space-y-2"],["formControlName","accountId",3,"disabled"],[3,"value"],["class","bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm",4,"ngIf"],["formControlName","description","placeholder","Add any additional notes...",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","resize-none",3,"rows","disabled"],[1,"flex","items-center","justify-between","mb-4"],["formControlName","isSplitTransaction",3,"change","disabled"],[1,"space-y-4"],["formControlName","isCategorySplit",3,"change","disabled"],["formControlName","isRecurring",3,"disabled"],[1,"bg-white","dark:bg-gray-800","shadow-sm","border-0"],[1,"px-4","py-3"],[1,"flex","items-center","gap-2"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"text-sm","font-medium","text-gray-700","dark:text-gray-300"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800","dark:bg-blue-900","dark:text-blue-200"],[1,"space-y-4","px-4","pb-4"],[1,"bg-gray-50","dark:bg-gray-700","rounded-lg","p-3"],["type","number","formControlName","taxAmount","placeholder","0.00","step","0.01",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"input","disabled"],["type","number","formControlName","taxPercentage","placeholder","0","step","0.01","min","0","max","100",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"input","disabled"],[1,"pt-2"],[1,"h-20"],["type","button",1,"text-xs","text-blue-600","dark:text-blue-400","hover:text-blue-800","dark:hover:text-blue-300","font-medium","flex","items-center","gap-1",3,"click"],[1,"text-sm"],["formControlName","paymentMethod",3,"disabled"],["value",""],["formControlName","splitGroupId",3,"disabled"],[1,"flex","items-center","justify-between","w-full"],[1,"bg-green-50","dark:bg-green-900/20","rounded-lg","p-3"],[1,"flex","items-center","gap-2","mb-2"],[1,"text-sm","text-green-600","dark:text-green-400"],[1,"text-sm","font-medium","text-green-800","dark:text-green-200"],[1,"text-sm","text-green-700","dark:text-green-300","space-y-1"],[1,"flex","justify-between","items-center"],[1,"border-t","border-green-200","dark:border-green-700","mt-2","pt-2"],[1,"flex","justify-between","items-center","font-medium"],[1,"flex","justify-center"],["type","button",1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","text-blue-600","bg-blue-50","hover:bg-blue-100","dark:text-blue-400","dark:bg-blue-900/20","dark:hover:bg-blue-900/40","rounded-lg","transition-colors","duration-200",3,"click"],[1,"font-medium"],["formControlName","recurringInterval",3,"disabled"],["type","date","formControlName","recurringStartDate",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"min","max","disabled"],["type","date","formControlName","recurringEndDate",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"min","max","disabled"],[1,"text-xs","text-gray-500","mt-1"],[1,"bg-blue-50","dark:bg-blue-900/20","rounded-lg","p-3"],[1,"text-sm","text-blue-600","dark:text-blue-400"],[1,"text-sm","font-medium","text-blue-800","dark:text-blue-200"],[1,"text-sm","text-blue-700","dark:text-blue-300","space-y-1"],[1,"flex","justify-between","items-center","text-sm"],[1,"text-gray-600","dark:text-gray-300"],[1,"font-medium","text-gray-900","dark:text-gray-100"],[1,"flex","justify-between","items-center","text-sm","mt-1"],[1,"font-medium","text-red-600","dark:text-red-400"],[1,"flex","justify-between","items-center","text-sm","mt-2","pt-2","border-t","border-gray-200","dark:border-gray-600"],[1,"font-medium","text-gray-700","dark:text-gray-300"],[1,"font-bold","text-green-600","dark:text-green-400"],["type","button","class","w-full py-2 px-4 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200",3,"click",4,"ngIf"],["type","button",1,"w-full","py-2","px-4","text-sm","text-gray-600","dark:text-gray-400","hover:text-gray-800","dark:hover:text-gray-200","border","border-gray-300","dark:border-gray-600","rounded-lg","hover:bg-gray-50","dark:hover:bg-gray-700","transition-colors","duration-200",3,"click"],[1,"text-sm","mr-2"]],template:function(r,a){if(r&1){let o=ue();s(0,"app-common-header",1),F("addButtonClick",function(){return R(o),B(a.onSubmit())})("closeButtonClick",function(){return R(o),B(a.onClose())}),c(),s(1,"app-common-body-content")(2,"form",2),F("ngSubmit",function(){return R(o),B(a.onSubmit())})("keydown.enter",function(){return R(o),B(!a.viewMode&&a.onSubmit())}),s(3,"div",3)(4,"div")(5,"label",4),d(6," Amount * "),c(),s(7,"input",5,0),F("input",function(){return R(o),B(a.onAmountChange())}),c(),N(9,v4,2,1,"p",6),c(),s(10,"div")(11,"label",4),d(12," Description * "),c(),re(13,"input",7),s(14,"div",8),N(15,b4,2,0,"p",9),s(16,"span",10),d(17),c()()(),s(18,"div")(19,"div",11)(20,"label",12),d(21," Category "),c(),N(22,y4,4,0,"button",13),c(),s(23,"mat-form-field",14)(24,"mat-label"),d(25,"Select a category"),c(),s(26,"mat-select",15),F("selectionChange",function(m){return R(o),B(a.onCategoryChange(m.value))}),s(27,"mat-option"),re(28,"ngx-mat-select-search",16),c(),N(29,M4,2,2,"mat-option",17),ce(30,"async"),c()()(),s(31,"div")(32,"label",4),d(33," Date * "),c(),s(34,"div",18),re(35,"input",19),s(36,"mat-icon",20),d(37," calendar_today "),c()(),N(38,P4,2,1,"p",6),c()(),s(39,"div",21)(40,"div",11)(41,"label",12),d(42," Account * "),c(),N(43,O4,4,0,"button",13),c(),s(44,"div",22)(45,"mat-form-field",14)(46,"mat-label"),d(47,"Select an account"),c(),s(48,"mat-select",23),Ge(49,w4,3,5,"mat-option",24,h4),ce(51,"async"),c(),N(52,S4,2,0,"mat-error"),c()()(),N(53,T4,11,1,"div",25),s(54,"div",21)(55,"label",4),d(56," Notes "),c(),re(57,"textarea",26),c(),s(58,"div",21)(59,"div",27)(60,"label",12),d(61," Split with Group "),c(),s(62,"mat-slide-toggle",28),F("change",function(){return R(o),B(a.toggleSplitTransaction())}),c()(),N(63,A4,12,4,"div",29),c(),s(64,"div",21)(65,"div",27)(66,"label",12),d(67," Split by Category "),c(),s(68,"mat-slide-toggle",30),F("change",function(){let m;return R(o),B((m=a.transactionForm.get("isCategorySplit"))!=null&&m.value?a.openCategorySplitDialog():a.clearCategorySplits())}),c()(),N(69,F4,21,1,"div",29),c(),s(70,"div",21)(71,"div",27)(72,"label",12),d(73," Recurring Transaction "),c(),re(74,"mat-slide-toggle",31),c(),N(75,B4,40,18,"div",29),c(),s(76,"mat-expansion-panel",32)(77,"mat-expansion-panel-header",33)(78,"mat-panel-title",34)(79,"mat-icon",35),d(80,"receipt"),c(),s(81,"span",36),d(82," Tax Information (Optional) "),c(),N(83,N4,2,1,"span",37),c()(),s(84,"div",38),N(85,V4,7,2,"div",39),s(86,"div")(87,"label",4),d(88," Tax Amount "),c(),s(89,"input",40),F("input",function(){return R(o),B(a.onTaxAmountChange())}),c(),N(90,U4,2,0,"p",6),c(),s(91,"div")(92,"label",4),d(93," Tax Percentage (%) "),c(),s(94,"input",41),F("input",function(){return R(o),B(a.onTaxPercentageChange())}),c(),s(95,"div",8),N(96,z4,2,0,"p",9)(97,j4,2,0,"p",9),s(98,"span",10),d(99),c()()(),N(100,Y4,2,1,"div",42),c()(),re(101,"div",43),c()()}if(r&2){let o,l,m,g,f,h,x,C,y,b,w,A,E,I;P("title",a.viewMode?"View":(a.dialogData!=null&&a.dialogData.id?"Edit":"Add")+" Transaction")("showAddButton",!a.viewMode)("addButtonDisabled",a.transactionForm.invalid)("isSubmitting",a.isSubmitting),u(2),P("formGroup",a.transactionForm),u(5),ze("bg-gray-100",a.viewMode),P("disabled",a.viewMode),u(2),we(a.getAmountError()&&((o=a.transactionForm.get("amount"))!=null&&o.touched)?9:-1),u(4),ze("bg-gray-100",a.viewMode),P("maxlength",45)("disabled",a.viewMode),u(2),we((l=a.transactionForm.get("payee"))!=null&&l.hasError("required")&&((l=a.transactionForm.get("payee"))!=null&&l.touched)?15:-1),u(2),ne(" ",((m=a.transactionForm.get("payee"))==null||m.value==null?null:m.value.length)||0,"/45 "),u(5),P("ngIf",!a.viewMode),u(4),P("disabled",a.viewMode),u(2),P("formControl",a.categoryFilterCtrl),u(),P("ngForOf",xe(30,50,a.filteredCategories)),u(6),ze("bg-gray-100",a.viewMode),P("disabled",a.viewMode),u(3),we(a.getDateError()?38:-1),u(5),P("ngIf",!a.viewMode),u(5),P("disabled",a.viewMode),u(),He(xe(51,52,a.accountList$)),u(3),we((g=a.transactionForm.get("accountId"))!=null&&g.hasError("required")&&((g=a.transactionForm.get("accountId"))!=null&&g.touched)?52:-1),u(),P("ngIf",((f=a.transactionForm.get("type"))==null?null:f.value)===a.TransactionType.EXPENSE),u(4),ze("bg-gray-100",a.viewMode),P("rows",3)("disabled",a.viewMode),u(5),P("disabled",a.viewMode),u(),we((h=a.transactionForm.get("isSplitTransaction"))!=null&&h.value?63:-1),u(5),P("disabled",a.viewMode),u(),we(a.isCategorySplit&&a.categorySplits.length>0?69:-1),u(5),P("disabled",a.viewMode),u(),we((x=a.transactionForm.get("isRecurring"))!=null&&x.value?75:-1),u(8),we((((C=a.transactionForm.get("taxAmount"))==null?null:C.value)||0)>0||(((C=a.transactionForm.get("taxPercentage"))==null?null:C.value)||0)>0?83:-1),u(2),we((((y=a.transactionForm.get("amount"))==null?null:y.value)||0)>0?85:-1),u(4),ze("bg-gray-100",a.viewMode),P("disabled",a.viewMode),u(),we((b=a.transactionForm.get("taxAmount"))!=null&&b.hasError("min")&&((b=a.transactionForm.get("taxAmount"))!=null&&b.touched)?90:-1),u(4),ze("bg-gray-100",a.viewMode),P("disabled",a.viewMode),u(2),we((w=a.transactionForm.get("taxPercentage"))!=null&&w.hasError("min")&&((w=a.transactionForm.get("taxPercentage"))!=null&&w.touched)?96:-1),u(),we((A=a.transactionForm.get("taxPercentage"))!=null&&A.hasError("max")&&((A=a.transactionForm.get("taxPercentage"))!=null&&A.touched)?97:-1),u(2),ne(" ",((E=a.transactionForm.get("taxPercentage"))==null?null:E.value)||0,"% "),u(),we((((I=a.transactionForm.get("taxAmount"))==null?null:I.value)||0)>0||(((I=a.transactionForm.get("taxPercentage"))==null?null:I.value)||0)>0?100:-1)}},dependencies:[or,dt,Wn,Nt,Ui,At,Yn,hc,jo,zo,mc,xi,Ci,Qe,Oi,Lr,ja,wi,yi,ma,px,fx,hx,Ko,Zo,Gl,Vi,sr],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100vh;background-color:#f9fafb;font-size:16px}.dark   [_nghost-%COMP%]{background-color:#111827}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{outline:none;transform:scale(1.01);transition:transform .15s ease-out}button[_ngcontent-%COMP%]{transition:transform .15s ease-out,opacity .15s ease-out;will-change:transform}button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px)}button[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield;-webkit-appearance:none;appearance:none}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;margin:0}.overflow-y-auto[_ngcontent-%COMP%]{scroll-behavior:smooth;-webkit-overflow-scrolling:touch;overscroll-behavior:contain}.bg-white[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]{transition:transform .15s ease-out,box-shadow .15s ease-out;will-change:transform}.bg-white[_ngcontent-%COMP%]:hover, .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000014}button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important}.text-red-500[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shake .4s ease-out}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}25%{transform:translate(-3px)}75%{transform:translate(3px)}}.text-green-500[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse .4s ease-out}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1)}50%{transform:scale(1.02)}to{transform:scale(1)}}@media (max-width: 768px){[_nghost-%COMP%]{font-size:16px}button[_ngcontent-%COMP%]{min-height:44px;min-width:44px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font-size:16px;padding:12px 16px;border-radius:8px}.text-2xl[_ngcontent-%COMP%]{font-size:1.75rem;line-height:1.2}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{transform:none}button[_ngcontent-%COMP%]:hover:not(:disabled){transform:none}.bg-white[_ngcontent-%COMP%]:hover, .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]:hover{transform:none}}@media (max-width: 480px){[_nghost-%COMP%]{font-size:16px}.p-4[_ngcontent-%COMP%]{padding:1rem}button[_ngcontent-%COMP%]{min-height:48px;min-width:48px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font-size:16px;padding:14px 16px}}@media (min-width: 769px){button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px)}.bg-white[_ngcontent-%COMP%]:hover, .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000014}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{transform:scale(1.01)}}@media (-webkit-min-device-pixel-ratio: 2),(min-resolution: 192dpi){.bg-white[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%], .bg-white[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]{transform:none!important;transition:none!important}}*[_ngcontent-%COMP%]{transition:background-color .2s ease,color .2s ease,border-color .2s ease}button[_ngcontent-%COMP%]:focus-visible, input[_ngcontent-%COMP%]:focus-visible, select[_ngcontent-%COMP%]:focus-visible, textarea[_ngcontent-%COMP%]:focus-visible{outline:2px solid #3b82f6;outline-offset:2px}"]});let e=i;return e})();var W4=e=>({"lg:pb-0":e});function G4(e,i){if(e&1){let n=ue();s(0,"footer",0)(1,"div",1)(2,"div",2)(3,"button",3),F("click",function(){R(n);let r=v();return B(r.home())}),s(4,"div",4),F("click",function(){R(n);let r=v();return B(r.home())}),s(5,"mat-icon",5),d(6,"home"),c()(),s(7,"span",6),d(8,"Home"),c()(),s(9,"button",3),F("click",function(){R(n);let r=v();return B(r.quickExpense())}),s(10,"div",4),F("click",function(){R(n);let r=v();return B(r.quickExpense())}),s(11,"mat-icon",5),d(12,"trending_down"),c()(),s(13,"span",6),d(14,"Expense"),c()(),s(15,"button",3),F("click",function(){R(n);let r=v();return B(r.addTransaction())}),s(16,"div",7)(17,"mat-icon",8),d(18,"add_circle"),c()(),s(19,"span",9),d(20,"Add"),c()(),s(21,"button",3),F("click",function(){R(n);let r=v();return B(r.navigateTo("/dashboard/category"))}),s(22,"div",4),F("click",function(){R(n);let r=v();return B(r.navigateTo("/dashboard/category"))}),s(23,"mat-icon",5),d(24,"layers"),c()(),s(25,"span",6),d(26,"Category"),c()(),s(27,"button",3),F("click",function(){R(n);let r=v();return B(r.navigateTo("/dashboard/accounts"))}),s(28,"div",4),F("click",function(){R(n);let r=v();return B(r.navigateTo("/dashboard/accounts"))}),s(29,"mat-icon",5),d(30,"account_balance"),c()(),s(31,"span",6),d(32,"Accounts"),c()()()()()}if(e&2){let n=v();u(),P("ngClass",Ta(25,W4,n.breakpointService.device.isDesktop)),u(3),jt(n.isHomeActive()?"bg-primary text-white hover:bg-primary/90":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"),u(),jt(n.isHomeActive()?"text-white":"text-gray-600 dark:text-gray-400"),u(2),jt(n.isHomeActive()?"text-primary dark:text-primary":"text-gray-700 dark:text-gray-300"),u(3),jt(n.isExpenseActive()?"bg-primary text-white hover:bg-primary/90":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"),u(),jt(n.isExpenseActive()?"text-white":"text-gray-600 dark:text-gray-400"),u(2),jt(n.isExpenseActive()?"text-primary dark:text-primary":"text-gray-700 dark:text-gray-300"),u(9),jt(n.isCategoryActive()?"bg-primary text-white hover:bg-primary/90":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"),u(),jt(n.isCategoryActive()?"text-white":"text-gray-600 dark:text-gray-400"),u(2),jt(n.isCategoryActive()?"text-primary dark:text-primary":"text-gray-700 dark:text-gray-300"),u(3),jt(n.isAccountsActive()?"bg-primary text-white hover:bg-primary/90":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"),u(),jt(n.isAccountsActive()?"text-white":"text-gray-600 dark:text-gray-400"),u(2),jt(n.isAccountsActive()?"text-primary dark:text-primary":"text-gray-700 dark:text-gray-300")}}var dC=(()=>{let i=class i{constructor(t,r,a,o,l){this.commonSyncService=t,this.router=r,this._dialog=a,this.hapticFeedback=o,this.breakpointService=l,this.hideFooter=!1,this.hideFooterForRoutes=[]}ngOnInit(){this.routeSubscription=this.router.events.pipe(Bi(t=>t instanceof a0)).subscribe(()=>{this.hideFooter=this.hideFooterForRoutes.includes(this.router.url)})}ngOnDestroy(){var t;(t=this.routeSubscription)==null||t.unsubscribe()}isHomeActive(){return this.router.url==="/dashboard"||this.router.url==="/dashboard/home"}isExpenseActive(){return this.router.url==="/dashboard/transactions"}isReportsActive(){return this.router.url==="/dashboard/reports"}isCategoryActive(){return this.router.url==="/dashboard/category"}isAccountsActive(){return this.router.url==="/dashboard/accounts"}isMoreActive(){return["/dashboard/accounts","/dashboard/budgets","/dashboard/goals","/dashboard/notes","/dashboard/tax","/dashboard/subscription"].includes(this.router.url)}addTransaction(){this._dialog.open(Es,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog"})}home(){this.router.navigate(["/dashboard/home"]),this.hapticFeedback.buttonClick()}quickExpense(){this.router.navigate(["/dashboard/transactions"])}reports(){console.log("Quick transfer clicked"),this.router.navigate(["/dashboard/reports"])}scanReceipt(){console.log("Scan receipt clicked"),alert("Receipt scanning feature coming soon!")}openAddTransactionModal(){console.log("Open add transaction modal clicked"),this.router.navigate(["/dashboard/add-transaction"])}openSettings(){console.log("Settings clicked"),this.router.navigate(["/dashboard/settings"])}openReports(){console.log("Reports clicked"),this.router.navigate(["/dashboard/reports"])}openSearch(){console.log("Search clicked"),alert("Search feature coming soon!")}onMoreMenuClick(){this.hapticFeedback.buttonClick(),console.log("More menu clicked")}navigateTo(t){this.router.navigate([t])}getAppVersion(){return new Date().toISOString().split("T")[0]}getNetworkStatusClass(){let t=this.commonSyncService.getCurrentNetworkStatus();return t.online?t.effectiveType==="4g"?"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-300":t.effectiveType==="3g"?"bg-yellow-100 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300":"bg-gray-100 dark:bg-gray-900/20 text-gray-700 dark:text-gray-300":"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300"}getNetworkIndicatorClass(){let t=this.commonSyncService.getCurrentNetworkStatus();return t.online?t.effectiveType==="4g"?"bg-green-500":t.effectiveType==="3g"?"bg-yellow-500":"bg-gray-500":"bg-red-500"}getNetworkStatusText(){let t=this.commonSyncService.getCurrentNetworkStatus();return t.online?t.effectiveType==="4g"?"4G":t.effectiveType==="3g"?"3G":t.effectiveType==="2g"?"2G":"Online":"Offline"}};i.\u0275fac=function(r){return new(r||i)(Y(qr),Y(nn),Y(xn),Y(mr),Y(gr))},i.\u0275cmp=Re({type:i,selectors:[["app-footer"]],decls:1,vars:1,consts:[[1,"flex-shrink-0","bg-white","dark:bg-gray-800","border-t","border-gray-200","dark:border-gray-700"],[1,"px-2","py-3","lg:px-4","lg:py-2",3,"ngClass"],[1,"grid","grid-cols-5","gap-2","lg:max-w-md","lg:mx-auto","lg:gap-1"],[1,"group","flex","flex-col","items-center","gap-2","lg:gap-1",3,"click"],[1,"w-10","h-10","lg:w-8","lg:h-8","rounded-xl","flex","items-center","justify-center","shadow-md","transition-all","duration-200","hover:scale-105","hover:shadow-lg",3,"click"],[1,"text-lg","lg:text-base","relative","bottom-1"],[1,"text-xs","lg:text-[10px]","font-medium","transition-colors","duration-200"],[1,"w-12","h-12","lg:w-10","lg:h-10","bg-gray-500","rounded-xl","flex","items-center","justify-center","shadow-md","hover:scale-105","hover:shadow-lg","hover:bg-gray-600","transition-all","duration-200"],[1,"text-white","text-lg","lg:text-base","relative","bottom-1"],[1,"text-xs","lg:text-[10px]","font-medium","text-gray-700","dark:text-gray-300"]],template:function(r,a){r&1&&N(0,G4,33,27,"footer",0),r&2&&we(!a.hideFooter||a.breakpointService.device.isMobile||a.breakpointService.device.isTablePortrait?0:-1)},dependencies:[$n,Qe],styles:["[_nghost-%COMP%]{display:block}footer[_ngcontent-%COMP%]{transition:all .3s ease}footer[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #0000001a}.hidden.md\\:flex[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:#fffffff2}.dark[_ngcontent-%COMP%]   .hidden.md\\:flex[_ngcontent-%COMP%]{background:#1f2937f2}.md\\:hidden[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:#fffffffa}.dark[_ngcontent-%COMP%]   .md\\:hidden[_ngcontent-%COMP%]{background:#1f2937fa}.md\\:hidden[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]{box-shadow:0 4px 12px #3b82f64d}.md\\:hidden[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]:hover{box-shadow:0 6px 16px #3b82f666}.md\\:hidden[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]:active{box-shadow:0 2px 8px #3b82f64d}.md\\:hidden[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]{transition:all .2s ease}.md\\:hidden[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.md\\:hidden[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]:active{transform:translateY(0)}.md\\:hidden[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{transition:all .2s ease}.md\\:hidden[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]:hover   .action-icon[_ngcontent-%COMP%]{transform:scale(1.1)}.md\\:hidden[_ngcontent-%COMP%]   .network-status[_ngcontent-%COMP%]{transition:all .3s ease}.md\\:hidden[_ngcontent-%COMP%]   .network-status[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.action-income[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669)}.action-income[_ngcontent-%COMP%]:hover{background:#10b9811a}.action-expense[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626)}.action-expense[_ngcontent-%COMP%]:hover{background:#ef44441a}.action-scan[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#8b5cf6,#7c3aed)}.action-scan[_ngcontent-%COMP%]:hover{background:#8b5cf61a}.action-search[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563)}.action-search[_ngcontent-%COMP%]:hover{background:#6b72801a}.action-more[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563)}.action-more[_ngcontent-%COMP%]:hover{background:#6b72801a}.network-online[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669)}.network-offline[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626)}.network-slow[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b,#d97706)}@media (max-width: 640px){.mobile-footer[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]{padding:.75rem 1.5rem;font-size:.875rem}.mobile-footer[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]{gap:.25rem}.mobile-footer[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{width:2rem;height:2rem}}.dark[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]{border-color:#4b556380}.dark[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]   .network-status[_ngcontent-%COMP%]{background:#4b556333}.dark[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]:hover{background:#4b55631a}@keyframes _ngcontent-%COMP%_networkPulse{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.network-status-changing[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_networkPulse .6s ease-in-out}button[_ngcontent-%COMP%]{transition:all .2s ease}button[_ngcontent-%COMP%]:focus{outline:none;ring:2px;ring-color:rgba(59,130,246,.5)}.footer-button[_ngcontent-%COMP%]{transition:all .2s ease}.footer-button.active[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);box-shadow:0 4px 12px #3b82f64d}.footer-button.active[_ngcontent-%COMP%]   .action-label[_ngcontent-%COMP%]{color:#3b82f6;font-weight:600}.footer-button[_ngcontent-%COMP%]:hover:not(.active)   .action-icon[_ngcontent-%COMP%]{transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-panel[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 8px 32px #0000001f;border:1px solid rgba(0,0,0,.08)}.dark[_ngcontent-%COMP%]   .more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-panel[_ngcontent-%COMP%]{background:#1f2937;border-color:#ffffff1a;box-shadow:0 8px 32px #0000004d}.more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;font-size:14px;font-weight:500;color:#374151;transition:all .2s ease}.dark[_ngcontent-%COMP%]   .more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]{color:#d1d5db}.more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]:hover{background:#3b82f614}.dark[_ngcontent-%COMP%]   .more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]:hover{background:#3b82f626}.more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280;font-size:20px;width:20px;height:20px}.dark[_ngcontent-%COMP%]   .more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#9ca3af}.more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}.menu-item[_ngcontent-%COMP%]{background-color:#ffffff80;border-radius:12px;margin:4px}.menu-item[_ngcontent-%COMP%]:hover{background-color:#ffffff80}"]});let e=i;return e})();var mC=(()=>{let i=class i{constructor(t,r,a,o,l){this.breakpointObserver=t,this.store=r,this.userService=a,this.invitationPopupService=o,this.recurringTransactionService=l,this.isMobile=!1,this.breakpointObserver.observe([Oc.Handset]).subscribe(m=>{this.isMobile=m.matches})}ngOnInit(){var t,r,a,o,l,m;this.store.dispatch(Xa({userId:((t=this.userService.userAuth$.value)==null?void 0:t.uid)||""})),this.store.dispatch(Fr({userId:((r=this.userService.userAuth$.value)==null?void 0:r.uid)||""})),this.store.dispatch(Xi({userId:((a=this.userService.userAuth$.value)==null?void 0:a.uid)||""})),this.store.dispatch(Ha({userId:((o=this.userService.userAuth$.value)==null?void 0:o.uid)||""})),this.store.dispatch(qa({userId:((l=this.userService.userAuth$.value)==null?void 0:l.uid)||""})),this.store.dispatch(li({userId:((m=this.userService.userAuth$.value)==null?void 0:m.uid)||""})),this.invitationPopupService.showInvitationsAfterLogin(),setTimeout(()=>{this.recurringTransactionService.checkDueRecurringTransactions().subscribe()},2e3)}};i.\u0275fac=function(r){return new(r||i)(Y(dr),Y(pt),Y(ni),Y(Qx),Y(Jx))},i.\u0275cmp=Re({type:i,selectors:[["app-dashboard"]],decls:6,vars:0,consts:[[1,"h-[100vh]","flex","flex-col","bg-gray-50"],[1,"flex-1","overflow-y-auto"],[1,"mx-auto","px-4","py-1","lg:py-2"]],template:function(r,a){r&1&&(s(0,"div",0),re(1,"app-header"),s(2,"main",1)(3,"div",2),re(4,"router-outlet"),c()(),re(5,"app-footer"),c())},dependencies:[o0,rC,dC]});let e=i;return e})();var Hc=[{id:"cash_bank",name:"Cash & Bank",icon:"account_balance",emoji:"\u{1F4B0}",color:"#10B981",description:"Savings Account, Checking Account, e-Wallets",accountTypes:[lr.BANK,lr.CASH]},{id:"credit_accounts",name:"Credit Accounts",icon:"credit_card",emoji:"\u{1F4B3}",color:"#F59E0B",description:"Credit Cards, BNPL (Buy Now Pay Later)",accountTypes:[lr.CREDIT]},{id:"liabilities",name:"Liabilities",icon:"trending_down",emoji:"\u{1F4C9}",color:"#EF4444",description:"Personal Loans, Car Loans, Home Loans, Student Loans",accountTypes:[lr.LOAN]},{id:"assets",name:"Assets",icon:"trending_up",emoji:"\u{1F4C8}",color:"#3B82F6",description:"Investment Accounts, Fixed Deposits, Retirement Funds",accountTypes:[lr.INVESTMENT]},{id:"other",name:"Other",icon:"more_horiz",emoji:"\u{1F504}",color:"#8B5CF6",description:"Expense Accounts, Income Accounts, Petty Cash",accountTypes:[]}];function Hu(e){return Hc.find(i=>i.accountTypes.includes(e))}var q4=(e,i)=>i.id;function X4(e,i){if(e&1){let n=ue();s(0,"button",3),F("click",function(){R(n);let r=v();return B(r.onMainButtonClick())}),s(1,"mat-icon"),d(2),c()()}if(e&2){let n=v();P("color",n.effectiveConfig.mainButtonColor)("ngClass",n.getMainButtonClass())("matTooltip",n.effectiveConfig.mainButtonTooltip),u(2),L(n.effectiveConfig.mainButtonIcon)}}function K4(e,i){if(e&1&&(s(0,"div",7),d(1),c()),e&2){let n=v().$implicit;u(),ne(" ",n.label," ")}}function Z4(e,i){if(e&1){let n=ue();s(0,"div",6),N(1,K4,2,1,"div",7),s(2,"button",8),F("click",function(){let r=R(n).$implicit,a=v(3);return B(a.onActionClick(r))}),s(3,"mat-icon",9),d(4),c()()()}if(e&2){let n=i.$implicit,t=v(3);u(),we(t.effectiveConfig.showLabels?1:-1),u(),P("color",n.color)("ngClass",t.getActionButtonClass(n))("matTooltip",n.tooltip)("disabled",n.disabled),u(),ze("animate-spin",n.loading),u(),L(n.icon)}}function Q4(e,i){if(e&1&&(s(0,"div",5),Ge(1,Z4,5,8,"div",6,q4),c()),e&2){let n=v(2);u(),He(n.effectiveConfig.actions)}}function J4(e,i){if(e&1){let n=ue();s(0,"button",3),F("click",function(){R(n);let r=v();return B(r.toggleExpanded())}),s(1,"mat-icon"),d(2),c()(),N(3,Q4,3,0,"div",4)}if(e&2){let n=v();P("color",n.effectiveConfig.mainButtonColor)("ngClass",n.getMainButtonClass())("matTooltip",n.effectiveConfig.mainButtonTooltip),u(2),L(n.mainButtonIcon),u(),P("ngIf",n.isExpanded)}}var ns=(()=>{let i=class i{constructor(){this.config={title:"Quick Actions",mainButtonIcon:"add",mainButtonColor:"primary",mainButtonTooltip:"Quick Actions",showLabels:!1,animations:!0,autoHide:!1,autoHideDelay:3e3,theme:"auto",actions:[{id:"add-transaction",label:"Add Transaction",icon:"receipt",color:"accent",tooltip:"Add Transaction"},{id:"export-report",label:"Export Report",icon:"file_download",color:"warn",tooltip:"Export Report"},{id:"refresh-data",label:"Refresh Data",icon:"refresh",color:"primary",tooltip:"Refresh Data"}]},this.actionClick=new _n,this.mainButtonClick=new _n,this.isExpanded=!1}ngOnInit(){}ngOnDestroy(){this.autoHideTimer&&clearTimeout(this.autoHideTimer)}get effectiveConfig(){var t,r,a,o,l,m,g,f,h;return{title:(t=this.config.title)!=null?t:"Quick Actions",mainButtonIcon:(r=this.config.mainButtonIcon)!=null?r:"add",mainButtonColor:(a=this.config.mainButtonColor)!=null?a:"primary",mainButtonTooltip:(o=this.config.mainButtonTooltip)!=null?o:"Quick Actions",showLabels:(l=this.config.showLabels)!=null?l:!1,animations:(m=this.config.animations)!=null?m:!0,autoHide:(g=this.config.autoHide)!=null?g:!1,autoHideDelay:(f=this.config.autoHideDelay)!=null?f:3e3,theme:(h=this.config.theme)!=null?h:"auto",actions:this.config.actions||[],onActionClick:this.config.onActionClick,onMainButtonClick:this.config.onMainButtonClick}}get animationClass(){return this.effectiveConfig.animations?"fab-animated":""}get mainButtonIcon(){return this.isExpanded?"close":this.effectiveConfig.mainButtonIcon||"add"}toggleExpanded(){this.isExpanded=!this.isExpanded,this.effectiveConfig.onMainButtonClick&&this.effectiveConfig.onMainButtonClick(),this.mainButtonClick.emit(),this.effectiveConfig.autoHide&&this.isExpanded?this.autoHideTimer=setTimeout(()=>{this.isExpanded=!1},this.effectiveConfig.autoHideDelay):this.autoHideTimer&&clearTimeout(this.autoHideTimer)}onActionClick(t){t.disabled||(this.effectiveConfig.onActionClick&&this.effectiveConfig.onActionClick(t),this.actionClick.emit(t))}onMainButtonClick(){this.effectiveConfig.onMainButtonClick&&this.effectiveConfig.onMainButtonClick(),this.mainButtonClick.emit()}getActionButtonClass(t){let r="shadow-lg hover:shadow-xl transition-all duration-300 ease-in-out",a=t.disabled?"opacity-50 cursor-not-allowed":"hover:scale-110",o=t.loading?"animate-spin":"";return`${r} ${a} ${o}`}getMainButtonClass(){let t="shadow-lg hover:shadow-xl transition-all duration-300 ease-in-out",r=this.isExpanded?"rotate-45":"";return`${t} ${r}`}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=Re({type:i,selectors:[["app-quick-actions-fab"]],inputs:{config:"config"},outputs:{actionClick:"actionClick",mainButtonClick:"mainButtonClick"},standalone:!0,features:[ia],decls:4,vars:3,consts:[[1,"quick-actions-fab","fixed","z-50","bottom-28","right-4","md:bottom-6","md:right-6","lg:bottom-32","lg:right-10"],[1,"flex","flex-col","space-y-2","md:space-y-3",3,"ngClass"],["mat-fab","",1,"shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out",3,"color","ngClass","matTooltip"],["mat-fab","",1,"shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out",3,"click","color","ngClass","matTooltip"],["class","flex flex-col space-y-2 md:space-y-3",4,"ngIf"],[1,"flex","flex-col","space-y-2","md:space-y-3"],[1,"flex","items-center","space-x-2","md:space-x-3"],[1,"hidden","sm:block","bg-white","dark:bg-gray-800","px-3","py-2","rounded-lg","shadow-lg","text-sm","font-medium","text-gray-700","dark:text-gray-300","whitespace-nowrap","backdrop-blur-sm","border","border-gray-200","dark:border-gray-700"],["mat-mini-fab","",1,"shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out",3,"click","color","ngClass","matTooltip","disabled"],[1,"text-sm","md:text-base"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1),N(2,X4,3,4,"button",2)(3,J4,4,5),c()()),r&2&&(u(),P("ngClass",a.animationClass),u(),we(a.effectiveConfig.actions.length===0?2:-1),u(),we(a.effectiveConfig.actions.length>0?3:-1))},dependencies:[La,$n,dt,X0,F_,q0,Ua,Qe,X_,Tn],styles:[".quick-actions-fab[_ngcontent-%COMP%]{isolation:isolate;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.quick-actions-fab[_ngcontent-%COMP%]   .fab-animated[_ngcontent-%COMP%]   .mat-fab[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.quick-actions-fab[_ngcontent-%COMP%]   .fab-animated[_ngcontent-%COMP%]   .mat-mini-fab[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .3s ease-out}.quick-actions-fab[_ngcontent-%COMP%]   .fab-animated[_ngcontent-%COMP%]   .mat-mini-fab[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.quick-actions-fab[_ngcontent-%COMP%]   .action-label[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInRight .3s ease-out}.quick-actions-fab[_ngcontent-%COMP%]   .action-label[_ngcontent-%COMP%]:hover{transform:translate(-4px)}.quick-actions-fab[_ngcontent-%COMP%]   .animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.quick-actions-fab[_ngcontent-%COMP%]   .opacity-50[_ngcontent-%COMP%]{opacity:.5}.quick-actions-fab[_ngcontent-%COMP%]   .cursor-not-allowed[_ngcontent-%COMP%]{cursor:not-allowed}@media (max-width: 640px){.quick-actions-fab[_ngcontent-%COMP%]   .mat-fab[_ngcontent-%COMP%]{width:56px!important;height:56px!important}.quick-actions-fab[_ngcontent-%COMP%]   .mat-mini-fab[_ngcontent-%COMP%]{width:40px!important;height:40px!important}}@media (min-width: 641px){.quick-actions-fab[_ngcontent-%COMP%]   .mat-fab[_ngcontent-%COMP%]{width:64px!important;height:64px!important}.quick-actions-fab[_ngcontent-%COMP%]   .mat-mini-fab[_ngcontent-%COMP%]{width:48px!important;height:48px!important}}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(20px) scale(.8)}to{opacity:1;transform:translateY(0) scale(1)}}@keyframes _ngcontent-%COMP%_slideInRight{0%{opacity:0;transform:translate(20px)}to{opacity:1;transform:translate(0)}}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]});let e=i;return e})();var uC=(e,i)=>i.group.id,pC=(e,i)=>i.accountId,nk=(e,i)=>i.id,fC=e=>({"!max-h-[100vh]":e});function ik(e,i){if(e&1){let n=ue();s(0,"div",16)(1,"p",17),d(2),c(),s(3,"button",18),F("click",function(){R(n);let r=v();return B(r.clearError())}),s(4,"mat-icon"),d(5,"close"),c()()()}if(e&2){let n=v();u(2),L(n.errorMessage)}}function rk(e,i){if(e&1){let n=ue();s(0,"mat-icon",19),F("click",function(){R(n);let r=v();return B(r.toggleListViewMode())}),d(1),c()}if(e&2){let n=v();P("matTooltip",n.isListViewMode?"Switch to detailed view":"Switch to list view"),u(),L(n.isListViewMode?"view_list":"list")}}function ak(e,i){if(e&1){let n=ue();s(0,"button",25),F("click",function(){R(n);let r=v(2);return B(r.addAccount())}),s(1,"mat-icon"),d(2,"add"),c(),d(3," Add Account "),c()}}function ok(e,i){if(e&1&&(s(0,"div",20)(1,"div",21)(2,"mat-icon"),d(3,"account_balance"),c()(),s(4,"h3",22),d(5,"No accounts yet"),c(),s(6,"p",23),d(7,"Add your first account to get started"),c(),N(8,ak,4,0,"button",24),c()),e&2){let n=v();u(8),P("ngIf",n.breakpointService.device.isMobile)}}function sk(e,i){if(e&1&&(s(0,"span",34),d(1),ce(2,"currency"),c()),e&2){let n=v().$implicit;u(),ne(" (",xe(2,1,n.totalBalance),") ")}}function ck(e,i){if(e&1){let n=ue();s(0,"div",35)(1,"div",36)(2,"mat-icon",37),d(3),c(),s(4,"div",38)(5,"span",39),d(6),ce(7,"titlecase"),c(),s(8,"span",40),d(9),ce(10,"titlecase"),c(),s(11,"span",41),d(12),ce(13,"currency"),ce(14,"currency"),c()()(),s(15,"div",42)(16,"mat-menu",null,0)(18,"button",43),F("click",function(){let r=R(n).$implicit,a=v(4);return B(a.editAccount(r))}),s(19,"mat-icon"),d(20,"edit"),c(),d(21," Edit"),c(),s(22,"button",44),F("click",function(){let r=R(n).$implicit,a=v(4);return B(a.deleteAccount(r))}),s(23,"mat-icon",45),d(24,"delete"),c(),d(25," Delete"),c()(),s(26,"button",46)(27,"mat-icon"),d(28,"more_vert"),c()()()()}if(e&2){let n,t=i.$implicit,r=bn(17),a=v().$implicit,o=v(3);wt("border-left-color",a.group.color),u(2),wt("color",a.group.color),u(),L(o.getAccountIcon(t.type)),u(3),L(xe(7,11,t.name)),u(3),L(xe(10,13,t.type)),u(2),jt(o.isLoanAccount(t)?"negative":t.balance>=0?"positive":"negative"),u(),ne(" ",o.isLoanAccount(t)?xe(13,15,-(((n=o.getLoanDetails(t))==null?null:n.remainingBalance)||0)):xe(14,17,t.balance)," "),u(14),P("matMenuTriggerFor",r)}}function lk(e,i){if(e&1&&(s(0,"div",30)(1,"span",31),d(2),c(),d(3),N(4,sk,3,3,"span",32),c(),Ge(5,ck,29,19,"div",33,pC)),e&2){let n=i.$implicit,t=v(3);wt("color",n.group.color),u(2),L(n.group.emoji),u(),ne(" ",n.group.name," "),u(),P("ngIf",!t.breakpointService.device.isMobile),u(),He(n.accounts)}}function dk(e,i){if(e&1&&(s(0,"div",29),Ge(1,lk,7,5,null,null,uC),c()),e&2){let n=v().ngIf,t=v();u(),He(t.getGroupedAccounts(n))}}function mk(e,i){if(e&1&&(s(0,"span",55),d(1),c()),e&2){let n=v().$implicit;u(),L(n.group.description)}}function gk(e,i){if(e&1&&(s(0,"div",34)(1,"span",56),d(2,"Total:"),c(),s(3,"span",57),d(4),ce(5,"currency"),c()()),e&2){let n=v().$implicit;u(3),jt(n.totalBalance>=0?"positive":"negative"),u(),ne(" ",xe(5,3,n.totalBalance)," ")}}function uk(e,i){if(e&1&&(s(0,"div",68)(1,"span",78),d(2,"Loan Interest Rate:"),c(),s(3,"span",79),d(4),c()()),e&2){let n,t=v().$implicit,r=v(4);u(4),ne("",(n=r.getLoanDetails(t))==null?null:n.interestRate,"%")}}function pk(e,i){if(e&1&&(s(0,"span",69),d(1),ce(2,"titlecase"),c()),e&2){let n=v().$implicit;u(),L(xe(2,1,n.type))}}function fk(e,i){if(e&1){let n=ue();s(0,"div",80)(1,"button",81),F("click",function(){R(n);let r=v().$implicit,a=v(4);return B(a.toggleAccountExpansion(r))}),s(2,"mat-icon"),d(3),c(),s(4,"span"),d(5),c()()()}if(e&2){let n=v().$implicit,t=v(4);u(3),L((t.expandedAccount==null?null:t.expandedAccount.accountId)===n.accountId?"expand_less":"expand_more"),u(2),L((t.expandedAccount==null?null:t.expandedAccount.accountId)===n.accountId?"Show Less":"Show More")}}function hk(e,i){if(e&1&&(s(0,"div",86)(1,"span",87),d(2,"Description:"),c(),s(3,"span",88),d(4),c()()),e&2){let n=v(2).$implicit;u(4),L(n.description)}}function _k(e,i){if(e&1&&(s(0,"div",86)(1,"span",87),d(2,"Created:"),c(),s(3,"span",88),d(4),ce(5,"date"),c()()),e&2){let n=v(2).$implicit,t=v(4);u(4),L(ht(5,1,t.dateService.toDate(n.createdAt),"shortDate"))}}function xk(e,i){if(e&1&&(s(0,"div",86)(1,"span",87),d(2,"Loan Term:"),c(),s(3,"span",88),d(4),c()()),e&2){let n,t=v(3).$implicit,r=v(4);u(4),ne("",(n=r.getLoanDetails(t))==null?null:n.durationMonths," months")}}function Ck(e,i){if(e&1&&(s(0,"mat-tab",98)(1,"div",85)(2,"div",86)(3,"span",87),d(4,"Lender Name:"),c(),s(5,"span",88),d(6),c()(),s(7,"div",86)(8,"span",87),d(9,"Interest Rate:"),c(),s(10,"span",88),d(11),c()(),s(12,"div",86)(13,"span",87),d(14,"Monthly Interest:"),c(),s(15,"span",99),d(16),ce(17,"currency"),c()(),s(18,"div",86)(19,"span",87),d(20,"Next Due Date:"),c(),s(21,"span",88),d(22),ce(23,"date"),c()(),s(24,"div",86)(25,"span",87),d(26,"Remaining Balance:"),c(),s(27,"span",97),d(28),ce(29,"currency"),c()(),s(30,"div",86)(31,"span",87),d(32,"Monthly Payment:"),c(),s(33,"span",88),d(34),ce(35,"currency"),c()(),N(36,xk,5,1,"div",89),c()()),e&2){let n,t,r,a,o,l,m=v(2).$implicit,g=v(4);u(6),L(((n=g.getLoanDetails(m))==null?null:n.lenderName)||"N/A"),u(5),ne("",(t=g.getLoanDetails(m))==null?null:t.interestRate,"%"),u(5),L(xe(17,7,g.calculateMonthlyInterest(m))),u(6),L(ht(23,9,(r=g.getLoanDetails(m))==null?null:r.nextDueDate,"fullDate")),u(6),L(xe(29,12,-(((a=g.getLoanDetails(m))==null?null:a.remainingBalance)||0))),u(6),L(xe(35,14,(o=g.getLoanDetails(m))==null?null:o.monthlyPayment)),u(2),P("ngIf",(l=g.getLoanDetails(m))==null?null:l.durationMonths)}}function vk(e,i){if(e&1&&(s(0,"div",86)(1,"span",87),d(2,"Credit Limit:"),c(),s(3,"span",88),d(4),ce(5,"currency"),c()()),e&2){let n,t=v(3).$implicit,r=v(4);u(4),L(xe(5,1,(n=r.getCreditCardDetails(t))==null?null:n.creditLimit))}}function bk(e,i){if(e&1&&(s(0,"div",86)(1,"span",87),d(2,"Minimum Payment:"),c(),s(3,"span",88),d(4),ce(5,"currency"),c()()),e&2){let n,t=v(3).$implicit,r=v(4);u(4),L(xe(5,1,(n=r.getCreditCardDetails(t))==null?null:n.minimumPayment))}}function yk(e,i){if(e&1&&(s(0,"mat-tab",100)(1,"div",85)(2,"div",86)(3,"span",87),d(4,"Payment Due Date:"),c(),s(5,"span",88),d(6),c()(),s(7,"div",86)(8,"span",87),d(9,"Billing Cycle Start:"),c(),s(10,"span",88),d(11),c()(),N(12,vk,6,3,"div",89)(13,bk,6,3,"div",89),s(14,"div",86)(15,"span",87),d(16,"Next Due Date:"),c(),s(17,"span",88),d(18),ce(19,"date"),c()(),s(20,"div",86)(21,"span",87),d(22,"Next Billing Date:"),c(),s(23,"span",88),d(24),ce(25,"date"),c()()()()),e&2){let n,t,r,a,o=v(2).$implicit,l=v(4);u(6),$t("",(n=l.getCreditCardDetails(o))==null?null:n.dueDate,"",l.getDaySuffix((n=l.getCreditCardDetails(o))==null?null:n.dueDate)," of each month"),u(5),$t("",(t=l.getCreditCardDetails(o))==null?null:t.billingCycleStart,"",l.getDaySuffix((t=l.getCreditCardDetails(o))==null?null:t.billingCycleStart)," of each month"),u(),P("ngIf",(r=l.getCreditCardDetails(o))==null?null:r.creditLimit),u(),P("ngIf",(a=l.getCreditCardDetails(o))==null?null:a.minimumPayment),u(5),L(ht(19,8,l.calculateNextDueDate(o),"fullDate")),u(6),L(ht(25,11,l.calculateNextBillingDate(o),"fullDate"))}}function Mk(e,i){e&1&&(s(0,"div",101)(1,"mat-icon"),d(2,"receipt_long"),c(),s(3,"p"),d(4,"No recent transactions"),c()())}function Pk(e,i){if(e&1&&(s(0,"div",103)(1,"div",104)(2,"span",105),d(3),c(),s(4,"span",106),d(5),ce(6,"date"),c()(),s(7,"span",107),d(8),ce(9,"currency"),c()()),e&2){let n=i.$implicit;u(3),L(n.description),u(2),L(ht(6,5,n.date,"shortDate")),u(2),jt(n.amount>=0?"positive":"negative"),u(),ne(" ",xe(9,8,n.amount)," ")}}function Ok(e,i){if(e&1&&(s(0,"div",102),Ge(1,Pk,10,10,"div",103,nk),c()),e&2){let n=v(2).$implicit,t=v(4);u(),He(t.getRecentTransactions(n))}}function wk(e,i){if(e&1&&(s(0,"div",82)(1,"mat-tab-group",83)(2,"mat-tab",84)(3,"div",85)(4,"div",86)(5,"span",87),d(6,"Account Name:"),c(),s(7,"span",88),d(8),c()(),s(9,"div",86)(10,"span",87),d(11,"Account Type:"),c(),s(12,"span",88),d(13),ce(14,"titlecase"),c()(),s(15,"div",86)(16,"span",87),d(17,"Current Balance:"),c(),s(18,"span",88),d(19),ce(20,"currency"),ce(21,"currency"),c()(),N(22,hk,5,1,"div",89)(23,_k,6,4,"div",89),c()(),N(24,Ck,37,16,"mat-tab",90)(25,yk,26,14,"mat-tab",91),s(26,"mat-tab",92)(27,"div",85),N(28,Mk,5,0,"div",93)(29,Ok,3,0,"div",94),c()(),s(30,"mat-tab",95)(31,"div",85)(32,"div",86)(33,"span",87),d(34,"Total Transactions:"),c(),s(35,"span",88),d(36),c()(),s(37,"div",86)(38,"span",87),d(39,"Total Deposits:"),c(),s(40,"span",96),d(41),ce(42,"currency"),c()(),s(43,"div",86)(44,"span",87),d(45,"Total Withdrawals:"),c(),s(46,"span",97),d(47),ce(48,"currency"),c()(),s(49,"div",86)(50,"span",87),d(51,"Average Transaction:"),c(),s(52,"span",88),d(53),ce(54,"currency"),c()(),s(55,"div",86)(56,"span",87),d(57,"Largest Transaction:"),c(),s(58,"span",88),d(59),ce(60,"currency"),c()(),s(61,"div",86)(62,"span",87),d(63,"This Month:"),c(),s(64,"span",88),d(65),ce(66,"currency"),c()(),s(67,"div",86)(68,"span",87),d(69,"Last Month:"),c(),s(70,"span",88),d(71),ce(72,"currency"),c()()()()()()),e&2){let n,t,r,a,o,l,m,g,f,h,x=v().$implicit,C=v(4);u(8),L(x.name),u(5),L(xe(14,18,x.type)),u(5),jt(C.isLoanAccount(x)?"negative":x.balance>=0?"positive":"negative"),u(),ne(" ",C.isLoanAccount(x)?xe(20,20,-(((n=C.getLoanDetails(x))==null?null:n.remainingBalance)||0)):xe(21,22,x.balance)," "),u(3),P("ngIf",x.description),u(),P("ngIf",x.createdAt),u(),P("ngIf",C.isLoanAccount(x)),u(),P("ngIf",C.isCreditCardAccount(x)),u(3),P("ngIf",!((t=C.getRecentTransactions(x))!=null&&t.length)),u(),P("ngIf",(r=C.getRecentTransactions(x))==null?null:r.length),u(7),L(((a=C.getAccountStats(x))==null?null:a.totalTransactions)||0),u(5),L(xe(42,24,(o=C.getAccountStats(x))==null?null:o.totalDeposits)),u(6),L(xe(48,26,(l=C.getAccountStats(x))==null?null:l.totalWithdrawals)),u(6),L(xe(54,28,(m=C.getAccountStats(x))==null?null:m.averageTransaction)),u(6),L(xe(60,30,(g=C.getAccountStats(x))==null?null:g.largestTransaction)),u(6),L(xe(66,32,(f=C.getAccountStats(x))==null?null:f.thisMonth)),u(6),L(xe(72,34,(h=C.getAccountStats(x))==null?null:h.lastMonth))}}function Sk(e,i){if(e&1){let n=ue();s(0,"div",58)(1,"div",59)(2,"div",60)(3,"div",61)(4,"div",62)(5,"mat-icon",63),d(6),c()(),s(7,"div",64)(8,"div",65)(9,"h3",66),d(10),ce(11,"titlecase"),c()(),s(12,"div",67),N(13,uk,5,1,"div",68)(14,pk,3,3,"span",69),c(),s(15,"div",70)(16,"span",71),d(17,"Balance:"),c(),s(18,"span",72),d(19),ce(20,"currency"),ce(21,"currency"),c()()()()(),s(22,"div",73)(23,"mat-menu",null,1)(25,"button",74),F("click",function(){let r=R(n).$implicit,a=v(4);return B(a.editAccount(r))}),s(26,"mat-icon"),d(27,"edit"),c(),d(28," Edit"),c(),s(29,"button",75),F("click",function(){let r=R(n).$implicit,a=v(4);return B(a.deleteAccount(r))}),s(30,"mat-icon"),d(31,"delete"),c(),d(32," Delete"),c()(),s(33,"button",46)(34,"mat-icon"),d(35,"more_vert"),c()()()(),N(36,fk,6,2,"div",76)(37,wk,73,36,"div",77),c()}if(e&2){let n,t,r,a=i.$implicit,o=bn(24),l=v(4);jt(l.getBalanceClass(a)),wt("--account-color",(n=l.getAccountGroup(a))==null?null:n.color)("--account-color-secondary",((t=l.getAccountGroup(a))==null?null:t.color)+"80"),ze("expanded",(l.expandedAccount==null?null:l.expandedAccount.accountId)===a.accountId),u(6),L(l.getAccountIcon(a.type)),u(4),L(xe(11,17,a.name)),u(3),we(l.isLoanAccount(a)?13:14),u(5),jt(l.isLoanAccount(a)?"negative":a.balance>=0?"positive":"negative"),u(),ne(" ",l.isLoanAccount(a)?xe(20,19,-(((r=l.getLoanDetails(a))==null?null:r.remainingBalance)||0)):xe(21,21,a.balance)," "),u(14),P("matMenuTriggerFor",o),u(3),P("ngIf",!l.breakpointService.device.isMobile),u(),P("ngIf",(l.expandedAccount==null?null:l.expandedAccount.accountId)===a.accountId)}}function kk(e,i){if(e&1&&(s(0,"div",48)(1,"div",49)(2,"div",50)(3,"span",31),d(4),c(),s(5,"h3",51),d(6),c(),N(7,mk,2,1,"span",52),c(),N(8,gk,6,5,"div",32),c(),s(9,"div",53),Ge(10,Sk,38,23,"div",54,pC),c()()),e&2){let n=i.$implicit,t=v(3);wt("--group-color",n.group.color),u(),wt("--group-color",n.group.color)("--group-color-secondary",n.group.color+"80"),u(3),L(n.group.emoji),u(2),L(n.group.name),u(),P("ngIf",!t.breakpointService.device.isMobile),u(),P("ngIf",!t.breakpointService.device.isMobile),u(2),He(n.accounts)}}function Tk(e,i){if(e&1&&(s(0,"div"),Ge(1,kk,12,10,"div",47,uC),c()),e&2){let n=v().ngIf,t=v();u(),He(t.getGroupedAccounts(n))}}function Ek(e,i){if(e&1&&(s(0,"div",26),N(1,dk,3,0,"div",27)(2,Tk,3,0,"div",28),c()),e&2){let n=v();P("ngClass",Ta(3,fC,n.breakpointService.device.isTablePortrait)),u(),P("ngIf",n.isListViewMode),u(),P("ngIf",!n.isListViewMode)}}var Zm=(()=>{let i=class i{constructor(t,r,a,o,l,m,g,f){this.auth=t,this.router=r,this.dialog=a,this.breakpointObserver=o,this.notificationService=l,this.store=m,this.dateService=g,this.breakpointService=f,this.quickActionsFabConfig={title:"Quick Actions",mainButtonIcon:"add",mainButtonColor:"primary",mainButtonTooltip:"Add Account",actions:[]},this.accounts$=gt([]),this.accounts=[],this.isLoading=!1,this.errorMessage="",this.selectedAccount=null,this.expandedAccount=null,this.isListViewMode=!1,this.userId="",this.destroy$=new Bt,this.breakpointService.device.isMobile&&(this.isListViewMode=!0),this.accounts$=this.store.select(ca)||gt([]),this.isLoading$=this.store.select(tm),this.error$=this.store.select(G_),this.totalBalance$=this.store.select(H_)}ngOnInit(){this.initializeComponent()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeComponent(){return me(this,null,function*(){let t=this.auth.currentUser;if(!t){this.errorMessage="User not authenticated";return}this.userId=t.uid,this.loadUserAccounts()})}loadUserAccounts(){this.store.dispatch(Fr({userId:this.userId})),this.accounts$.pipe(yt(this.destroy$)).subscribe(t=>{this.accounts=t}),this.isLoading$.pipe(yt(this.destroy$)).subscribe(t=>{this.isLoading=t}),this.error$.pipe(yt(this.destroy$)).subscribe(t=>{t&&(this.errorMessage="Failed to load accounts",console.error("Error loading accounts:",t))})}clearError(){this.errorMessage=""}toggleListViewMode(){this.isListViewMode=!this.isListViewMode}trackByAccountId(t,r){return r.accountId}openAccountDialog(t){this.dialog.open(Wl,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog",data:t||null}).afterClosed().subscribe(a=>{a&&this.store.dispatch(Fr({userId:this.userId}))})}editAccount(t){this.openAccountDialog(t)}deleteAccount(t){return me(this,null,function*(){this.dialog.open(Hr,{width:"400px",data:{title:"Delete Account",message:`Are you sure you want to delete "${t.name}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",confirmColor:"warn"}}).afterClosed().subscribe(a=>me(this,null,function*(){if(a)try{this.store.dispatch(_c({userId:this.userId,accountId:t.accountId})),this.notificationService.success("Account deleted successfully")}catch(o){this.notificationService.error("Failed to delete account"),console.error("Error deleting account:",o)}}))})}addAccount(){this.openAccountDialog()}calculateMonthlyInterest(t){if(t.type!=="loan"||!t.loanDetails)return 0;let{interestRate:r,remainingBalance:a}=t.loanDetails;return r/12/100*a}isLoanAccount(t){return t.type==="loan"&&!!t.loanDetails}getLoanDetails(t){return t.loanDetails}isCreditCardAccount(t){return t.type===lr.CREDIT}getCreditCardDetails(t){return t.creditCardDetails}getDaySuffix(t){if(t>=11&&t<=13)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}calculateNextDueDate(t){var g;if(!((g=t.creditCardDetails)!=null&&g.dueDate))return new Date;let r=t.creditCardDetails.dueDate,a=new Date,o=a.getMonth(),l=a.getFullYear(),m=new Date(l,o,r);return m<a&&(m=new Date(l,o+1,r)),m}calculateNextBillingDate(t){var g;if(!((g=t.creditCardDetails)!=null&&g.billingCycleStart))return new Date;let r=t.creditCardDetails.billingCycleStart,a=new Date,o=a.getMonth(),l=a.getFullYear(),m=new Date(l,o,r);return m<a&&(m=new Date(l,o+1,r)),m}onAccountClick(t){var r;((r=this.selectedAccount)==null?void 0:r.accountId)===t.accountId?this.selectedAccount=null:this.selectedAccount=t}getBalanceClass(t){return t.type==="loan"?"loan-account":t.balance>=0?"positive-balance":"negative-balance"}getAccountIcon(t){switch(t){case"bank":return"account_balance";case"cash":return"payments";case"credit":return"credit_card";case"loan":return"account_balance_wallet";default:return"account_balance"}}toggleAccountExpansion(t){var r;((r=this.expandedAccount)==null?void 0:r.accountId)===t.accountId?this.expandedAccount=null:this.expandedAccount=t}getRecentTransactions(t){return[]}getAccountStats(t){return{totalTransactions:0,totalDeposits:0,totalWithdrawals:0,averageTransaction:0,largestTransaction:0,thisMonth:0,lastMonth:0}}getAccountGroups(){return Hc}getAccountGroup(t){return Hu(t.type)}getAccountsByGroup(t,r){let a=Hc.find(o=>o.id===r);return a?t.filter(o=>a.accountTypes.includes(o.type)):[]}getGroupTotalBalance(t,r){return this.getAccountsByGroup(t,r).reduce((o,l)=>{let m=l.balance;return l.type===lr.LOAN&&l.loanDetails&&(m=-(l.loanDetails.remainingBalance||0)),o+m},0)}getGroupedAccounts(t){return Hc.map(r=>{let a=this.getAccountsByGroup(t,r.id),o=this.getGroupTotalBalance(t,r.id);return{group:r,accounts:a,totalBalance:o}}).filter(r=>r.accounts.length>0)}};i.\u0275fac=function(r){return new(r||i)(Y(xt),Y(nn),Y(xn),Y(dr),Y(ft),Y(pt),Y(Vt),Y(gr))},i.\u0275cmp=Re({type:i,selectors:[["user-accounts"]],decls:21,vars:18,consts:[["listMenu","matMenu"],["menu","matMenu"],[3,"mainButtonClick","config"],[1,"accounts-container"],["class","error-message mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center justify-between",4,"ngIf"],[1,"accounts-grid"],[1,"accounts-list",3,"ngClass"],[1,"section-header"],[1,"header-content"],[1,"section-title"],[1,"flex","items-center","gap-2"],[1,"section-subtitle"],[3,"matTooltip","click",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","accounts-grid-list",3,"ngClass",4,"ngIf"],[1,"mt-5"],[1,"error-message","mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg","flex","items-center","justify-between"],[1,"text-red-700","text-sm"],["mat-icon-button","",1,"error-close-button",3,"click"],[3,"click","matTooltip"],[1,"empty-state"],[1,"empty-icon"],[1,"empty-title"],[1,"empty-text"],["mat-raised-button","","color","primary","class","empty-state-button",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"empty-state-button",3,"click"],[1,"accounts-grid-list",3,"ngClass"],["class","list-view-container pt-4",4,"ngIf"],[4,"ngIf"],[1,"list-view-container","pt-4"],[1,"group-header"],[1,"group-emoji"],["class","group-balance",4,"ngIf"],[1,"list-view-item",3,"border-left-color"],[1,"group-balance"],[1,"list-view-item"],[1,"list-view-content"],[1,"list-view-icon"],[1,"list-view-details"],[1,"list-view-name"],[1,"list-view-type"],[1,"list-view-balance"],[1,"list-view-actions"],["mat-menu-item","",1,"action-button","edit-button",3,"click"],["mat-menu-item","",1,"action-button","delete-button",3,"click"],[1,"!text-red-800"],["matIconButton","",3,"matMenuTriggerFor"],[1,"account-group-container",3,"--group-color"],[1,"account-group-container"],[1,"account-group-header"],[1,"group-info"],[1,"group-name"],["class","group-description",4,"ngIf"],[1,"group-accounts-grid"],[1,"account-item",3,"class","expanded","--account-color","--account-color-secondary"],[1,"group-description"],[1,"group-balance-label"],[1,"group-balance-value"],[1,"account-item"],[1,"account-content"],[1,"account-info"],[1,"account-icon-name"],[1,"account-icon-container"],[1,"account-icon"],[1,"account-details"],[1,"account-header"],[1,"account-name"],[1,"account-type-info"],[1,"loan-info"],[1,"account-type"],[1,"account-balance-info"],[1,"balance-label"],[1,"balance-value"],[1,"account-actions"],["mat-menu-item","","matTooltip","Edit account",1,"action-button","edit-button",3,"click"],["mat-menu-item","","matTooltip","Delete account",1,"action-button","delete-button",3,"click"],["class","expand-section",4,"ngIf"],["class","account-details-expanded",4,"ngIf"],[1,"loan-label"],[1,"loan-value"],[1,"expand-section"],["mat-button","",1,"expand-btn",3,"click"],[1,"account-details-expanded"],[1,"details-tabs"],["label","Basic Details"],[1,"tab-content"],[1,"detail-row"],[1,"detail-label"],[1,"detail-value"],["class","detail-row",4,"ngIf"],["label","Loan Details",4,"ngIf"],["label","Credit Card Details",4,"ngIf"],["label","Recent Transactions"],["class","no-transactions",4,"ngIf"],["class","transaction-list",4,"ngIf"],["label","Statistics"],[1,"detail-value","positive"],[1,"detail-value","negative"],["label","Loan Details"],[1,"detail-value","interest-amount"],["label","Credit Card Details"],[1,"no-transactions"],[1,"transaction-list"],[1,"transaction-item"],[1,"transaction-info"],[1,"transaction-description"],[1,"transaction-date"],[1,"transaction-amount"]],template:function(r,a){if(r&1&&(s(0,"app-quick-actions-fab",2),F("mainButtonClick",function(){return a.addAccount()}),c(),s(1,"div",3),N(2,ik,6,1,"div",4),s(3,"div",5)(4,"section",6)(5,"div",7)(6,"div",8)(7,"h2",9),d(8,"Manage Accounts"),c(),s(9,"span",10)(10,"p",11),d(11),ce(12,"async"),ce(13,"async"),c(),N(14,rk,2,2,"mat-icon",12),c()()(),N(15,ok,9,1,"div",13),ce(16,"async"),N(17,Ek,3,5,"div",14),ce(18,"async"),s(19,"div",15),re(20,"app-account-summary-card"),c()()()()),r&2){let o,l;P("config",a.quickActionsFabConfig),u(2),P("ngIf",a.errorMessage),u(2),P("ngClass",Ta(16,fC,a.breakpointService.device.isTablePortrait)),u(7),$t("(",((o=xe(12,8,a.accounts$))==null?null:o.length)||0," account",(((o=xe(13,10,a.accounts$))==null?null:o.length)||0)!==1?"s":"",")"),u(3),P("ngIf",!a.breakpointService.device.isMobile),u(),P("ngIf",((l=xe(16,12,a.accounts$))==null?null:l.length)===0),u(2),P("ngIf",xe(18,14,a.accounts$))}},dependencies:[$n,dt,Jt,gn,Qe,Wa,Ya,Ga,Dc,Fc,Tn,im,ns,Vi,sr,_i,Sr],styles:['@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideDown{0%{transform:translateY(-100%);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:-200% 0}to{background-position:200% 0}}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.accounts-container[_ngcontent-%COMP%]{padding:1rem;background:inherit;overflow:auto}@media (max-width: 640px){.accounts-container[_ngcontent-%COMP%]{padding:.5rem}}.error-message[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease}.error-message[_ngcontent-%COMP%]   .error-close-button[_ngcontent-%COMP%]{color:#dc2626;min-width:44px;min-height:44px}.add-account-btn[_ngcontent-%COMP%]{position:fixed;bottom:8rem;right:1rem;z-index:100;box-shadow:0 4px 12px #00000026;transition:all .2s ease}.add-account-btn[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 6px 16px #0003}.accounts-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;max-width:1200px;margin:0 auto;transition:opacity .3s ease}.accounts-grid.loading[_ngcontent-%COMP%]{opacity:.7;pointer-events:none}@media (min-width: 768px){.accounts-grid[_ngcontent-%COMP%]{gap:2.5rem}}@media (max-width: 640px){.accounts-grid[_ngcontent-%COMP%]{gap:1.5rem}}.account-group-container[_ngcontent-%COMP%]{margin-bottom:2rem;padding:1.5rem;background:#ffffff80;border-radius:5px;border:1px solid rgba(255,255,255,.3);box-shadow:0 4px 20px #0000000d;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);transition:all .3s ease}.account-group-container[_ngcontent-%COMP%]:hover{box-shadow:0 8px 30px #00000014}@media (max-width: 768px){.account-group-container[_ngcontent-%COMP%]{padding:1rem;margin-bottom:1.5rem}}@media (max-width: 480px){.account-group-container[_ngcontent-%COMP%]{padding:.75rem;margin-bottom:1rem}}.group-accounts-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.25rem;margin-top:1rem}@media (min-width: 1200px){.group-accounts-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:1.5rem}}@media (max-width: 768px){.group-accounts-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1rem}}@media (max-width: 640px){.group-accounts-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.875rem}}.account-group-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:4px;margin:0 0 1rem;transition:all .3s ease;position:relative;overflow:hidden}.account-group-header[_ngcontent-%COMP%]   .group-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex:1}.account-group-header[_ngcontent-%COMP%]   .group-info[_ngcontent-%COMP%]   .group-emoji[_ngcontent-%COMP%]{font-size:1.75rem;line-height:1;filter:drop-shadow(0 2px 4px rgba(0,0,0,.1))}.account-group-header[_ngcontent-%COMP%]   .group-info[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:var(--text-primary);margin:0;letter-spacing:-.025em}.account-group-header[_ngcontent-%COMP%]   .group-info[_ngcontent-%COMP%]   .group-description[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-secondary);opacity:.8;font-weight:500}.account-group-header[_ngcontent-%COMP%]   .group-balance[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.5rem 1rem;border-radius:12px;background:#ffffff80;border:1px solid rgba(255,255,255,.3)}.account-group-header[_ngcontent-%COMP%]   .group-balance[_ngcontent-%COMP%]   .group-balance-label[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-secondary);font-weight:600;text-transform:uppercase;letter-spacing:.05em}.account-group-header[_ngcontent-%COMP%]   .group-balance[_ngcontent-%COMP%]   .group-balance-value[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:8px}.account-group-header[_ngcontent-%COMP%]   .group-balance[_ngcontent-%COMP%]   .group-balance-value.positive[_ngcontent-%COMP%]{color:#059669;background:#0596691a;border-color:#0596694d}.account-group-header[_ngcontent-%COMP%]   .group-balance[_ngcontent-%COMP%]   .group-balance-value.negative[_ngcontent-%COMP%]{color:#dc2626;background:#dc26261a;border-color:#dc26264d}.accounts-list[_ngcontent-%COMP%]{width:100%;padding:.2rem}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]{max-height:100vh}}.accounts-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{margin-bottom:2rem;position:relative}.accounts-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;flex:1}.accounts-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:clamp(1.25rem,3vw,2rem);font-weight:600;color:#1f2937;margin:0 0 .25rem;height:35px}.accounts-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{color:#6b7280;font-size:clamp(.75rem,2vw,1rem);margin:0}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem;background:#fff;border-radius:12px;border:2px dashed #d1d5db}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{margin-bottom:1rem}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:clamp(2.5rem,6vw,4rem);width:clamp(2.5rem,6vw,4rem);height:clamp(2.5rem,6vw,4rem);color:#9ca3af}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-title[_ngcontent-%COMP%]{font-size:clamp(1rem,2.5vw,1.5rem);font-weight:500;color:#374151;margin:0 0 .5rem}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-text[_ngcontent-%COMP%]{color:#6b7280;font-size:clamp(.75rem,2vw,1rem);margin:0 0 1.5rem}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-state-button[_ngcontent-%COMP%]{min-height:44px;padding:.75rem 1.5rem;display:inline-flex;align-items:center;gap:.5rem}.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.1rem;scrollbar-width:thin;scrollbar-color:#cbd5e1 #f1f5f9}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]{gap:1.5rem;max-height:60vh;overflow-y:auto}}.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;border:1px solid #e5e7eb;cursor:pointer;transition:all .3s ease;border-left:4px solid transparent;box-shadow:0 2px 8px #0000000a;position:relative;overflow:hidden}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--account-color, #3b82f6),var(--account-color-secondary, #8b5cf6));opacity:0;transition:opacity .3s ease}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]{padding:1.25rem;border-radius:12px}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 12px 40px #0000001f;border-color:#d1d5db}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]:hover:before{opacity:1}.accounts-list[_ngcontent-%COMP%]   .account-item.positive-balance[_ngcontent-%COMP%]{border-left-color:#10b981;--account-color: #10b981;--account-color-secondary: #059669}.accounts-list[_ngcontent-%COMP%]   .account-item.negative-balance[_ngcontent-%COMP%]{border-left-color:#ef4444;--account-color: #ef4444;--account-color-secondary: #dc2626}.accounts-list[_ngcontent-%COMP%]   .account-item.loan-account[_ngcontent-%COMP%]{border-left-color:#f59e0b;--account-color: #f59e0b;--account-color-secondary: #d97706}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem;position:relative}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-content[_ngcontent-%COMP%]{gap:.75rem}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]{padding:0 10px 10px;flex:1}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]{gap:.75rem}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-icon-container[_ngcontent-%COMP%]{width:3rem;height:3rem;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0;background:linear-gradient(135deg,#f3f4f6,#e5e7eb);box-shadow:0 2px 8px #0000001a;transition:all .3s ease}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-icon-container[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;border-radius:10px}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-icon-container[_ngcontent-%COMP%]   .account-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem;color:#6b7280;transition:color .3s ease}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:.625rem}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]{gap:.5rem}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-header[_ngcontent-%COMP%]{gap:.125rem}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-header[_ngcontent-%COMP%]   .account-name[_ngcontent-%COMP%]{padding-top:8px;font-size:clamp(1rem,2.5vw,1.25rem);color:#1f2937;margin:0;line-height:1.2;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:80%}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-header[_ngcontent-%COMP%]   .account-name[_ngcontent-%COMP%]{font-size:1rem}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-type-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-type-info[_ngcontent-%COMP%]   .account-type[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-type-info[_ngcontent-%COMP%]   .loan-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;flex-wrap:wrap}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-type-info[_ngcontent-%COMP%]   .loan-info[_ngcontent-%COMP%]   .loan-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-type-info[_ngcontent-%COMP%]   .loan-info[_ngcontent-%COMP%]   .loan-value[_ngcontent-%COMP%]{font-size:.75rem;color:#dc2626;font-weight:600}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-balance-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;flex-wrap:wrap}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-balance-info[_ngcontent-%COMP%]   .balance-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-balance-info[_ngcontent-%COMP%]   .balance-value[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-balance-info[_ngcontent-%COMP%]   .balance-value.positive[_ngcontent-%COMP%]{color:#10b981}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-balance-info[_ngcontent-%COMP%]   .balance-value.negative[_ngcontent-%COMP%]{color:#ef4444}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-actions[_ngcontent-%COMP%]   .action-button.edit-button[_ngcontent-%COMP%]{color:#3b82f6}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-actions[_ngcontent-%COMP%]   .action-button.edit-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#3b82f6}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-actions[_ngcontent-%COMP%]   .action-button.delete-button[_ngcontent-%COMP%]{color:#dc2626}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-actions[_ngcontent-%COMP%]   .action-button.delete-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#dc2626}.expand-section[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:8px 0;border-top:1px solid #e5e7eb}.expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem}.expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]:hover{color:#374151;background:#f3f4f6}.account-details-expanded[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb;background:#f9fafb;animation:_ngcontent-%COMP%_slideDown .3s ease}.account-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-header{background:#fff;border-bottom:1px solid #e5e7eb}.account-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-label{color:#6b7280;font-weight:500}.account-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-label.mat-mdc-tab-label-active{color:#3b82f6}.account-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-ink-bar{background-color:#3b82f6}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding:16px;background:#fff;min-height:200px}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #f3f4f6}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{font-weight:500;color:#6b7280;font-size:.875rem}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-weight:600;color:#111827;font-size:.875rem}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.positive[_ngcontent-%COMP%]{color:#10b981}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.negative[_ngcontent-%COMP%]{color:#ef4444}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.interest-amount[_ngcontent-%COMP%]{color:#dc2626;font-weight:700}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]{text-align:center;padding:32px 16px;color:#6b7280}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2rem;width:2rem;height:2rem;margin-bottom:8px;opacity:.5}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:#f9fafb;border-radius:6px;transition:background .2s ease}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .transaction-description[_ngcontent-%COMP%]{font-weight:500;color:#111827;font-size:.875rem}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .transaction-date[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount[_ngcontent-%COMP%]{font-weight:600;font-size:.875rem}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount.positive[_ngcontent-%COMP%]{color:#10b981}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount.negative[_ngcontent-%COMP%]{color:#ef4444}@media (max-width: 768px){.accounts-container[_ngcontent-%COMP%]{padding:.5rem}.accounts-grid[_ngcontent-%COMP%]{gap:1rem}}@media (max-width: 480px){.accounts-container[_ngcontent-%COMP%]{padding:.25rem}.account-item[_ngcontent-%COMP%]{padding:.75rem}.account-item[_ngcontent-%COMP%]   .account-content[_ngcontent-%COMP%]{gap:.5rem}.account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]{padding:0 5px 5px}}.list-view-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.list-view-container[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-weight:600;font-size:1rem;margin-bottom:.5rem;padding:.5rem 0;border-bottom:1px solid #e5e7eb}.list-view-container[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .group-emoji[_ngcontent-%COMP%]{font-size:1.25rem}.list-view-container[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .group-balance[_ngcontent-%COMP%]{font-weight:400;font-size:.875rem;color:#6b7280}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem;background:#fff;border:1px solid #e5e7eb;border-left:4px solid;border-radius:8px;transition:all .2s ease;margin-bottom:.5rem}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #0000001a;transform:translateY(-1px)}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex:1}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem;min-width:1.5rem}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-details[_ngcontent-%COMP%]   .list-view-name[_ngcontent-%COMP%]{font-weight:600;font-size:1rem;color:#111827}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-details[_ngcontent-%COMP%]   .list-view-type[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-details[_ngcontent-%COMP%]   .list-view-balance[_ngcontent-%COMP%]{font-weight:600;font-size:.875rem}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-details[_ngcontent-%COMP%]   .list-view-balance.positive[_ngcontent-%COMP%]{color:#10b981}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-details[_ngcontent-%COMP%]   .list-view-balance.negative[_ngcontent-%COMP%]{color:#ef4444}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-actions[_ngcontent-%COMP%]{display:flex;align-items:center}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-actions[_ngcontent-%COMP%]   .action-button.edit-button[_ngcontent-%COMP%]{color:#3b82f6}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-actions[_ngcontent-%COMP%]   .action-button.delete-button[_ngcontent-%COMP%]{color:#ef4444}@media (prefers-color-scheme: dark){.list-view-container[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]{border-bottom-color:#374151;color:#f9fafb}.list-view-container[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .group-balance[_ngcontent-%COMP%]{color:#9ca3af}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]{background:#1f2937;border-color:#374151}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #0000004d}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-details[_ngcontent-%COMP%]   .list-view-name[_ngcontent-%COMP%]{color:#f9fafb}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-details[_ngcontent-%COMP%]   .list-view-type[_ngcontent-%COMP%]{color:#9ca3af}}@media (max-width: 768px){.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]{padding:.75rem}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]{gap:.75rem}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem;min-width:1.25rem}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-details[_ngcontent-%COMP%]   .list-view-name[_ngcontent-%COMP%]{font-size:.875rem}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-details[_ngcontent-%COMP%]   .list-view-type[_ngcontent-%COMP%], .list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-details[_ngcontent-%COMP%]   .list-view-balance[_ngcontent-%COMP%]{font-size:.75rem}}']});let e=i;return e})();var Ku=Yr(Xr());var qc=(()=>{let i=class i{constructor(t,r,a){this.fb=t,this.dateService=r,this.validationService=a}createBudgetForm(){return this.fb.group({hasBudget:[!1],budgetAmount:[0,this.validationService.getBudgetAmountValidators()],budgetPeriod:["monthly",tt.required],budgetStartDate:[new Date,tt.required],budgetEndDate:[null],budgetAlertThreshold:[80,this.validationService.getBudgetThresholdValidators()],budgetAlertEnabled:[!0]})}initializeBudgetForm(t,r){var a,o,l,m,g,f,h,x,C,y;(a=r==null?void 0:r.budget)!=null&&a.hasBudget&&t.patchValue({hasBudget:(o=r.budget)==null?void 0:o.hasBudget,budgetAmount:((l=r.budget)==null?void 0:l.budgetAmount)||0,budgetPeriod:((m=r.budget)==null?void 0:m.budgetPeriod)||"monthly",budgetStartDate:(g=r.budget)!=null&&g.budgetStartDate?this.dateService.toDate((f=r.budget)==null?void 0:f.budgetStartDate):new Date,budgetEndDate:(h=r.budget)!=null&&h.budgetEndDate?this.dateService.toDate((x=r.budget)==null?void 0:x.budgetEndDate):null,budgetAlertThreshold:((C=r.budget)==null?void 0:C.budgetAlertThreshold)||80,budgetAlertEnabled:((y=r.budget)==null?void 0:y.budgetAlertEnabled)!==!1}),this.setupBudgetFormValidation(t)}setupBudgetFormValidation(t){var r,a;(r=t.get("hasBudget"))==null||r.valueChanges.subscribe(o=>{var l,m,g,f,h,x,C,y,b,w,A,E;o?((l=t.get("budgetAmount"))==null||l.enable(),(m=t.get("budgetPeriod"))==null||m.enable(),(g=t.get("budgetStartDate"))==null||g.enable(),(f=t.get("budgetEndDate"))==null||f.enable(),(h=t.get("budgetAlertThreshold"))==null||h.enable(),(x=t.get("budgetAlertEnabled"))==null||x.enable()):((C=t.get("budgetAmount"))==null||C.disable(),(y=t.get("budgetPeriod"))==null||y.disable(),(b=t.get("budgetStartDate"))==null||b.disable(),(w=t.get("budgetEndDate"))==null||w.disable(),(A=t.get("budgetAlertThreshold"))==null||A.disable(),(E=t.get("budgetAlertEnabled"))==null||E.disable())}),(a=t.get("hasBudget"))==null||a.updateValueAndValidity()}getBudgetDataFromForm(t){var a;let r=t.value;return{hasBudget:r.hasBudget||!1,budgetAmount:r.hasBudget&&(r==null?void 0:r.budgetAmount)||0,budgetPeriod:r.hasBudget&&(r==null?void 0:r.budgetPeriod)||"monthly",budgetStartDate:r.hasBudget&&((a=r==null?void 0:r.budgetStartDate)==null?void 0:a.getTime())||null,budgetEndDate:r.hasBudget&&r.budgetEndDate?r.budgetEndDate.getTime():null,budgetAlertThreshold:r.hasBudget&&(r==null?void 0:r.budgetAlertThreshold)||80,budgetAlertEnabled:r.hasBudget&&(r==null?void 0:r.budgetAlertEnabled)||!0}}isBudgetFormValid(t){var r;return(r=t.get("hasBudget"))!=null&&r.value?t.valid:!0}getBudgetPeriods(){return[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}]}formatBudgetAmount(t){return t?t.toLocaleString(Ut.LANGUAGE.DEFAULT,{minimumFractionDigits:2,maximumFractionDigits:2}):"0"}formatBudgetPeriod(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}getBudgetProgressColor(t,r,a){var o;return!((o=t.budget)!=null&&o.hasBudget)||!r?"#6b7280":r>=100?"#ef4444":r>=a?"#f59e0b":r>=60?"#3b82f6":"#10b981"}};i.\u0275fac=function(r){return new(r||i)(De(vi),De(Vt),De(sa))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var hC=(e,i)=>i.id,Ak=()=>[];function Dk(e,i){e&1&&(s(0,"div",39)(1,"mat-icon"),d(2,"receipt_long"),c(),s(3,"p"),d(4,"No recent transactions"),c()())}function Fk(e,i){if(e&1&&(s(0,"div",42)(1,"div",43)(2,"span",44),d(3),c(),s(4,"span",45),d(5),ce(6,"date"),c()(),s(7,"span",46),d(8),ce(9,"currency"),c()()),e&2){let n=i.$implicit,t=v(2);u(3),L(n.payee),u(2),L(ht(6,5,t.dateService.toDate(n.date),"shortDate")),u(2),jt(n.amount>=0?"positive":"negative"),u(),ne(" ",xe(9,8,n.amount)," ")}}function Rk(e,i){if(e&1&&(s(0,"div",40),N(1,Fk,10,10,"div",41),c()),e&2){let n=v();u(),P("ngForOf",n.data.recentTransactions)}}function Bk(e,i){if(e&1&&(s(0,"div",18)(1,"div",19)(2,"mat-icon"),d(3,"account_balance_wallet"),c(),s(4,"h3"),d(5,"Budget Summary"),c()(),s(6,"div",47)(7,"div",48)(8,"span",46),d(9),ce(10,"currency"),c(),s(11,"span",49),d(12),c()(),s(13,"div",50)(14,"div",51),re(15,"div",52),c(),s(16,"div",53)(17,"span",54),d(18),ce(19,"currency"),c(),s(20,"span",55),d(21),c()()(),s(22,"div",56)(23,"div",57)(24,"span",22),d(25,"Remaining"),c(),s(26,"span",23),d(27),ce(28,"currency"),c()()()()()),e&2){let n=v();u(9),L(xe(10,11,n.data.category.budget==null?null:n.data.category.budget.budgetAmount)),u(3),ne("/ ",n.formatBudgetPeriod(n.data.category.budget==null?null:n.data.category.budget.budgetPeriod),""),u(3),wt("width",n.Math.min(n.calculateBudgetProgressPercentage(n.data.category),100),"%")("background-color",n.getBudgetProgressColor(n.data.category)),u(3),ne("",xe(19,13,n.calculateBudgetSpent(n.data.category))," spent"),u(3),ne("",n.calculateBudgetProgressPercentage(n.data.category).toFixed(1),"%"),u(5),jt(n.getRemainingBudgetClass(n.data.category)),u(),ne(" ",xe(28,15,n.calculateBudgetRemaining(n.data.category))," ")}}function Nk(e,i){if(e&1&&(s(0,"div",21)(1,"span",22),d(2,"Transactions"),c(),s(3,"span",23),d(4),c()()),e&2){let n=v();u(4),L(n.data.categoryStats.totalTransactions)}}function Lk(e,i){if(e&1&&(s(0,"div",25),re(1,"app-category-card",58),c()),e&2){let n=i.$implicit,t=v();u(),P("category",n)("isMobile",!0)("recentTransactions",t.data.recentTransactions)("categoryStats",t.data.categoryStats)("allTransactions",t.data.allTransactions)("subCategories",ka(8,Ak))("subCategoryCount",0)("Math",t.Math)}}function Vk(e,i){e&1&&(s(0,"div",28)(1,"span",22),d(2,"Parent Category"),c(),s(3,"span",23)(4,"mat-icon"),d(5,"account_tree"),c(),d(6," Subcategory "),c()())}function Uk(e,i){if(e&1&&(s(0,"div",28)(1,"span",22),d(2,"Start Date"),c(),s(3,"span",23),d(4),ce(5,"date"),c()()),e&2){let n=v(2);u(4),L(ht(5,1,n.dateService.toDate(n.data.category.budget==null?null:n.data.category.budget.budgetStartDate),"shortDate"))}}function zk(e,i){if(e&1&&(s(0,"div",27)(1,"h4"),d(2,"Budget Details"),c(),s(3,"div",28)(4,"span",22),d(5,"Budget Amount"),c(),s(6,"span",23),d(7),ce(8,"currency"),c()(),s(9,"div",28)(10,"span",22),d(11,"Period"),c(),s(12,"span",23),d(13),c()(),N(14,Uk,6,4,"div",30),c()),e&2){let n=v();u(7),L(xe(8,3,n.data.category.budget==null?null:n.data.category.budget.budgetAmount)),u(6),L(n.formatBudgetPeriod(n.data.category.budget==null?null:n.data.category.budget.budgetPeriod)),u(),P("ngIf",n.data.category.budget==null?null:n.data.category.budget.budgetStartDate)}}function jk(e,i){if(e&1&&re(0,"app-category-card",58),e&2){let n=i.$implicit,t=v(2);P("category",n)("isMobile",!0)("recentTransactions",t.data.recentTransactions)("categoryStats",t.data.categoryStats)("allTransactions",t.data.allTransactions)("subCategories",t.data.subCategories)("subCategoryCount",t.data.subCategories.length)("Math",t.Math)}}function $k(e,i){if(e&1&&(s(0,"mat-tab",59)(1,"div",12)(2,"div",60),Ge(3,jk,1,8,"app-category-card",58,hC),c()()()),e&2){let n=v();u(3),He(n.data.subCategories)}}var Qm=(()=>{let i=class i{constructor(t,r,a){this.dialogRef=t,this.data=r,this.dateService=a,this.selectedTabIndex=0,this.Math=Math}ngOnInit(){}onClose(){this.dialogRef.close()}calculateBudgetSpent(t){var m,g;if(!((m=t.budget)!=null&&m.hasBudget)||!((g=t.budget)!=null&&g.budgetAmount))return 0;let r=this.data.allTransactions.filter(f=>f.categoryId===t.id&&f.type===Lt.EXPENSE),a=t.budget.budgetStartDate,o=t.budget.budgetEndDate,l=r;if(a){let f=this.dateService.toDate(a);if(!f)return 0;l=l.filter(h=>{let x=this.dateService.toDate(h.date);return x&&x>=f})}if(o){let f=this.dateService.toDate(o);if(!f)return 0;l=l.filter(h=>{let x=this.dateService.toDate(h.date);return x&&x<=f})}return l.reduce((f,h)=>f+Math.abs(h.amount),0)}calculateBudgetRemaining(t){var a,o;if(!((a=t.budget)!=null&&a.hasBudget)||!((o=t.budget)!=null&&o.budgetAmount))return 0;let r=this.calculateBudgetSpent(t);return Math.max(0,(t.budget.budgetAmount||0)-r)}calculateBudgetProgressPercentage(t){var o,l;if(!((o=t.budget)!=null&&o.hasBudget)||!((l=t.budget)!=null&&l.budgetAmount))return 0;let r=this.calculateBudgetSpent(t),a=t.budget.budgetAmount||0;return a===0?0:r/a*100}getBudgetProgressColor(t){var o;let r=this.calculateBudgetProgressPercentage(t),a=((o=t.budget)==null?void 0:o.budgetAlertThreshold)||80;return r>=100?"#f44336":r>=a?"#ff9800":"#4caf50"}formatBudgetPeriod(t){return t?{daily:"Day",weekly:"Week",monthly:"Month",yearly:"Year"}[t]||t:""}getBudgetStatusClass(t){var o;let r=this.calculateBudgetProgressPercentage(t),a=((o=t.budget)==null?void 0:o.budgetAlertThreshold)||80;return r>=100?"budget-exceeded":r>=a?"budget-warning":"budget-ok"}getRemainingBudgetClass(t){return this.calculateBudgetRemaining(t)<=0?"budget-exceeded":"budget-ok"}calculateTotalSpentPerMonth(t){let r=this.data.allTransactions.filter(l=>l.categoryId===t.id&&l.type===Lt.EXPENSE),a=new Date().getMonth(),o=new Date().getFullYear();return r.filter(l=>{let m=this.dateService.toDate(l.date);return m&&m.getMonth()===a&&m.getFullYear()===o}).reduce((l,m)=>l+Math.abs(m.amount),0)}calculateTotalIncomePerMonth(t){let r=this.data.allTransactions.filter(l=>l.categoryId===t.id&&l.type===Lt.INCOME),a=new Date().getMonth(),o=new Date().getFullYear();return r.filter(l=>{let m=this.dateService.toDate(l.date);return m&&m.getMonth()===a&&m.getFullYear()===o}).reduce((l,m)=>l+m.amount,0)}getSubCategoryStats(t){let r=this.data.allTransactions.filter(C=>C.categoryId===t.id),a=r.length,o=r.filter(C=>C.type===Lt.EXPENSE).reduce((C,y)=>C+Math.abs(y.amount),0),l=a>0?o/a:0,m=r.length>0?Math.max(...r.map(C=>Math.abs(C.amount))):0,g=new Date().getMonth(),f=new Date().getFullYear(),h=r.filter(C=>{let y=this.dateService.toDate(C.date);return y&&y.getMonth()===g&&y.getFullYear()===f}).filter(C=>C.type===Lt.EXPENSE).reduce((C,y)=>C+Math.abs(y.amount),0),x=r.filter(C=>{let y=this.dateService.toDate(C.date);return y&&y.getMonth()===(g-1+12)%12&&y.getFullYear()===f}).filter(C=>C.type===Lt.EXPENSE).reduce((C,y)=>C+Math.abs(y.amount),0);return{totalTransactions:a,totalSpent:o,averageTransaction:l,largestTransaction:m,thisMonth:h,lastMonth:x}}};i.\u0275fac=function(r){return new(r||i)(Y(Mi),Y(Pi),Y(Vt))},i.\u0275cmp=Re({type:i,selectors:[["app-category-details-dialog"]],decls:113,vars:50,consts:[[1,"category-details-dialog"],["mat-fab","","aria-label","Close dialog",1,"floating-close-button",3,"click"],[1,"dialog-header"],[1,"category-header-info"],[1,"category-icon-container"],[1,"category-icon"],[1,"category-title"],[1,"category-type"],["mat-icon-button","",1,"close-button","desktop-close",3,"click"],[1,"dialog-content"],[1,"details-tabs",3,"selectedIndexChange","selectedIndex"],["label","Transactions"],[1,"tab-content"],[1,"transactions-section"],["class","no-transactions",4,"ngIf"],["class","transaction-list",4,"ngIf"],["label","Overview"],["class","summary-card",4,"ngIf"],[1,"summary-card"],[1,"card-header"],[1,"monthly-summary"],[1,"stat-row"],[1,"label"],[1,"value"],["class","stat-row",4,"ngIf"],[1,"mb-2"],["label","Details"],[1,"details-section"],[1,"detail-item"],[1,"color-preview"],["class","detail-item",4,"ngIf"],["class","details-section",4,"ngIf"],["label","Subcategories",4,"ngIf"],["label","Statistics"],[1,"statistics-grid"],[1,"stat-card"],[1,"stat-label"],[1,"stat-value"],[1,"stat-value","negative"],[1,"no-transactions"],[1,"transaction-list"],["class","transaction-item",4,"ngFor","ngForOf"],[1,"transaction-item"],[1,"transaction-info"],[1,"description"],[1,"date"],[1,"amount"],[1,"budget-overview"],[1,"budget-amount"],[1,"period"],[1,"budget-progress"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-info"],[1,"spent"],[1,"percentage"],[1,"budget-stats"],[1,"stat"],[3,"category","isMobile","recentTransactions","categoryStats","allTransactions","subCategories","subCategoryCount","Math"],["label","Subcategories"],[1,"subcategories-list"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"button",1),F("click",function(){return a.onClose()}),s(2,"mat-icon"),d(3,"close"),c()(),s(4,"div",2)(5,"div",3)(6,"div",4)(7,"mat-icon",5),d(8),c()(),s(9,"div",6)(10,"h2"),d(11),c(),s(12,"span",7),d(13),ce(14,"titlecase"),c()()(),s(15,"button",8),F("click",function(){return a.onClose()}),s(16,"mat-icon"),d(17,"close"),c()()(),s(18,"div",9)(19,"mat-tab-group",10),lt("selectedIndexChange",function(l){return ct(a.selectedTabIndex,l)||(a.selectedTabIndex=l),l}),s(20,"mat-tab",11)(21,"div",12)(22,"div",13),N(23,Dk,5,0,"div",14)(24,Rk,2,1,"div",15),c()()(),s(25,"mat-tab",16)(26,"div",12),N(27,Bk,29,17,"div",17),s(28,"div",18)(29,"div",19)(30,"mat-icon"),d(31,"calendar_today"),c(),s(32,"h3"),d(33,"This Month"),c()(),s(34,"div",20)(35,"div",21)(36,"span",22),d(37),c(),s(38,"span",23),d(39),ce(40,"currency"),ce(41,"currency"),c()(),N(42,Nk,5,1,"div",24),c()(),Ge(43,Lk,2,9,"div",25,hC),c()(),s(45,"mat-tab",26)(46,"div",12)(47,"div",27)(48,"div",28)(49,"span",22),d(50,"Category Name"),c(),s(51,"span",23),d(52),c()(),s(53,"div",28)(54,"span",22),d(55,"Type"),c(),s(56,"span",23),d(57),ce(58,"titlecase"),c()(),s(59,"div",28)(60,"span",22),d(61,"Icon"),c(),s(62,"span",23)(63,"mat-icon"),d(64),c(),d(65),c()(),s(66,"div",28)(67,"span",22),d(68,"Color"),c(),s(69,"span",23),re(70,"div",29),d(71),c()(),N(72,Vk,7,0,"div",30),c(),N(73,zk,15,5,"div",31),c()(),N(74,$k,5,0,"mat-tab",32),s(75,"mat-tab",33)(76,"div",12)(77,"div",34)(78,"div",35)(79,"span",36),d(80,"Total Transactions"),c(),s(81,"span",37),d(82),c()(),s(83,"div",35)(84,"span",36),d(85,"Total Spent"),c(),s(86,"span",38),d(87),ce(88,"currency"),c()(),s(89,"div",35)(90,"span",36),d(91,"Average Transaction"),c(),s(92,"span",37),d(93),ce(94,"currency"),c()(),s(95,"div",35)(96,"span",36),d(97,"Largest Transaction"),c(),s(98,"span",38),d(99),ce(100,"currency"),c()(),s(101,"div",35)(102,"span",36),d(103,"This Month"),c(),s(104,"span",38),d(105),ce(106,"currency"),c()(),s(107,"div",35)(108,"span",36),d(109,"Last Month"),c(),s(110,"span",38),d(111),ce(112,"currency"),c()()()()()()()()),r&2&&(u(7),wt("color",a.data.category.color),u(),ne(" ",a.data.category.icon||"category"," "),u(3),L(a.data.category.name),u(2),L(xe(14,32,a.data.category.type)),u(6),st("selectedIndex",a.selectedTabIndex),u(4),P("ngIf",!(a.data.recentTransactions!=null&&a.data.recentTransactions.length)),u(),P("ngIf",a.data.recentTransactions==null?null:a.data.recentTransactions.length),u(3),P("ngIf",a.data.category==null||a.data.category.budget==null?null:a.data.category.budget.hasBudget),u(10),L(a.data.category.type==="expense"?"Spent":"Earned"),u(),jt(a.data.category.type==="expense"?"negative":"positive"),u(),ne(" ",a.data.category.type==="expense"?xe(40,34,a.calculateTotalSpentPerMonth(a.data.category)):xe(41,36,a.calculateTotalIncomePerMonth(a.data.category))," "),u(3),P("ngIf",a.data.categoryStats==null?null:a.data.categoryStats.totalTransactions),u(),He(a.data.subCategories),u(9),L(a.data.category.name),u(5),L(xe(58,38,a.data.category.type)),u(6),wt("color",a.data.category.color),u(),L(a.data.category.icon||"category"),u(),ne(" ",a.data.category.icon||"category"," "),u(5),wt("background-color",a.data.category.color),u(),ne(" ",a.data.category.color," "),u(),P("ngIf",a.data.category.parentCategoryId),u(),P("ngIf",a.data.category==null||a.data.category.budget==null?null:a.data.category.budget.hasBudget),u(),P("ngIf",a.data.subCategories==null?null:a.data.subCategories.length),u(8),L((a.data.categoryStats==null?null:a.data.categoryStats.totalTransactions)||0),u(5),L(xe(88,40,a.data.categoryStats==null?null:a.data.categoryStats.totalSpent)),u(6),L(xe(94,42,a.data.categoryStats==null?null:a.data.categoryStats.averageTransaction)),u(6),L(xe(100,44,a.data.categoryStats==null?null:a.data.categoryStats.largestTransaction)),u(6),L(xe(106,46,a.data.categoryStats==null?null:a.data.categoryStats.thisMonth)),u(6),L(xe(112,48,a.data.categoryStats==null?null:a.data.categoryStats.lastMonth)))},styles:[".category-details-dialog[_ngcontent-%COMP%]{max-width:700px;width:90vw;max-height:85vh;display:flex;flex-direction:column;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 20px 40px #0000001a;position:relative}.category-details-dialog[_ngcontent-%COMP%]   .floating-close-button[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;z-index:1000;background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(0,0,0,.1);box-shadow:0 4px 12px #00000026;width:48px;height:48px;display:none}.category-details-dialog[_ngcontent-%COMP%]   .floating-close-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#64748b;font-size:20px;width:20px;height:20px}.category-details-dialog[_ngcontent-%COMP%]   .floating-close-button[_ngcontent-%COMP%]:hover{background:#fff;transform:scale(1.05)}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:24px 32px;background:linear-gradient(135deg,#f8fafc,#f1f5f9);border-bottom:1px solid #e2e8f0;flex-shrink:0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:16px;background:#fffc;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #0000001a}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 4px;font-size:24px;font-weight:700;color:#1e293b;line-height:1.2}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-title[_ngcontent-%COMP%]   .category-type[_ngcontent-%COMP%]{font-size:14px;color:#64748b;text-transform:capitalize;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#64748b;transition:all .2s ease}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#1e293b;background:#0000000d}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button.desktop-close[_ngcontent-%COMP%]{display:block}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column;min-height:0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;min-height:0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-header{background:#f8fafc;border-bottom:1px solid #e2e8f0;flex-shrink:0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-header .mat-tab-label{color:#64748b;font-weight:500;min-width:120px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-header .mat-tab-label.mat-tab-label-active{color:#3b82f6}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-header .mat-ink-bar{background-color:#3b82f6}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-body-wrapper{flex:1;overflow:hidden}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-body{height:100%;overflow:hidden;display:flex;flex-direction:column}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-body-content{height:100%;overflow:hidden;display:flex;flex-direction:column}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden;padding:24px 32px;min-height:0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:24px;margin-bottom:20px;box-shadow:0 2px 8px #0000000a;transition:all .2s ease}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #00000014;transform:translateY(-1px)}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:20px;width:20px;height:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:8px;margin-bottom:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .period[_ngcontent-%COMP%]{font-size:16px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]{margin-bottom:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background:#f1f5f9;border-radius:4px;overflow:hidden;margin-bottom:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s ease;border-radius:4px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]   .spent[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]   .percentage[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#f8fafc;border-radius:8px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;font-size:16px;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-ok[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-warning[_ngcontent-%COMP%]{color:#d97706}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-exceeded[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f1f5f9}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;font-size:16px;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .value.positive[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .value.negative[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f1f5f9}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500;color:#1e293b;font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600;font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .amount.positive[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .amount.negative[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .more-indicator[_ngcontent-%COMP%]{text-align:center;padding:12px 0;color:#64748b;font-size:14px;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]{margin-bottom:32px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;font-weight:600;color:#1e293b;padding-bottom:8px;border-bottom:2px solid #e2e8f0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 0;border-bottom:1px solid #f1f5f9}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;display:flex;align-items:center;gap:8px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:6px;border:2px solid #e2e8f0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:20px;transition:all .2s ease}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #00000014;transform:translateY(-1px)}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;background:#f8fafc;display:flex;align-items:center;justify-content:center}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;font-size:16px;display:block}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{font-size:12px;color:#64748b;text-transform:capitalize}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;padding:12px;background:#f8fafc;border-radius:8px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;font-size:14px;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.positive[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.negative[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-ok[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-warning[_ngcontent-%COMP%]{color:#d97706}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-exceeded[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#94a3b8}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;opacity:.5}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:#fff;border:1px solid #e2e8f0;border-radius:10px;transition:all .2s ease}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #0000000f}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-size:12px;color:#64748b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:700;font-size:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .amount.positive[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .amount.negative[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:20px;text-align:center;transition:all .2s ease}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #00000014;transform:translateY(-2px)}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{display:block;font-size:12px;color:#64748b;font-weight:500;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{display:block;font-size:24px;font-weight:700;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-value.negative[_ngcontent-%COMP%]{color:#dc2626}.budget-ok[_ngcontent-%COMP%]{color:#059669!important}.budget-warning[_ngcontent-%COMP%]{color:#d97706!important}.budget-exceeded[_ngcontent-%COMP%]{color:#dc2626!important}@media (max-width: 768px){.category-details-dialog[_ngcontent-%COMP%]{width:100vw;height:100vh;max-height:100vh;border-radius:0;margin:0}.category-details-dialog[_ngcontent-%COMP%]   .floating-close-button[_ngcontent-%COMP%]{display:flex!important;align-items:center;justify-content:center}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{padding:60px 20px 16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]{gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]{width:44px;height:44px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;line-height:1.3}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-title[_ngcontent-%COMP%]   .category-type[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button.desktop-close[_ngcontent-%COMP%]{display:none}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-header .mat-tab-label{min-width:80px;font-size:13px;padding:0 12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding:16px 20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{padding:16px;margin-bottom:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{margin-bottom:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:24px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .period[_ngcontent-%COMP%]{font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]{padding:10px 0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]{padding:10px 0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]{margin-bottom:24px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:15px;margin-bottom:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{padding:12px 0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:20px;height:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]{gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]{padding:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]{margin-bottom:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-icon[_ngcontent-%COMP%]{width:36px;height:36px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{font-size:11px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{padding:10px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:11px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]{gap:10px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]{padding:14px 16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-size:11px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{padding:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:11px;margin-bottom:6px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:18px}}@media (min-width: 769px) and (max-width: 1024px){.category-details-dialog[_ngcontent-%COMP%]{width:85vw;max-width:800px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding:20px 28px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{padding:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 1025px){.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}"]});let e=i;return e})();var Yk=(e,i)=>i.value;function Wk(e,i){e&1&&(s(0,"mat-error"),d(1," Budget amount is required "),c())}function Gk(e,i){e&1&&(s(0,"mat-error"),d(1," Budget amount must be greater than 0 "),c())}function Hk(e,i){if(e&1&&(s(0,"div",16)(1,"label",17),d(2,"Budget Amount"),c(),s(3,"mat-form-field",18),re(4,"input",19),N(5,Wk,2,0,"mat-error",20)(6,Gk,2,0,"mat-error",20),c()()),e&2){let n=v();u(5),P("ngIf",n.budgetAmountControl==null?null:n.budgetAmountControl.hasError("required")),u(),P("ngIf",n.budgetAmountControl==null?null:n.budgetAmountControl.hasError("min"))}}function qk(e,i){if(e&1&&(s(0,"mat-option",22),d(1),c()),e&2){let n=i.$implicit;P("value",n.value),u(),ne(" ",n.label," ")}}function Xk(e,i){e&1&&(s(0,"mat-error"),d(1," Budget period is required "),c())}function Kk(e,i){if(e&1&&(s(0,"div",16)(1,"label",17),d(2,"Budget Period"),c(),s(3,"mat-form-field",18)(4,"mat-select",21),Ge(5,qk,2,2,"mat-option",22,Yk),c(),N(7,Xk,2,0,"mat-error",20),c()()),e&2){let n=v();u(5),He(n.budgetPeriods),u(2),P("ngIf",n.budgetPeriodControl==null?null:n.budgetPeriodControl.hasError("required"))}}function Zk(e,i){e&1&&(s(0,"mat-error"),d(1," Start date is required "),c())}function Qk(e,i){if(e&1&&(s(0,"div",16)(1,"label",17),d(2,"Start Date"),c(),s(3,"mat-form-field",18),re(4,"input",23)(5,"mat-datepicker-toggle",24)(6,"mat-datepicker",null,0),N(8,Zk,2,0,"mat-error",20),c()()),e&2){let n,t=bn(7),r=v();u(4),P("matDatepicker",t)("min",r.minDate)("max",r.maxDate),u(),P("for",t),u(3),P("ngIf",(n=r.budgetForm.get("budgetStartDate"))==null?null:n.hasError("required"))}}function Jk(e,i){if(e&1&&(s(0,"div",16)(1,"label",17),d(2,"End Date (Optional)"),c(),s(3,"mat-form-field",18),re(4,"input",25)(5,"mat-datepicker-toggle",24)(6,"mat-datepicker",null,1),c()()),e&2){let n=bn(7),t=v();u(4),P("matDatepicker",n)("min",t.minDate)("max",t.maxDate),u(),P("for",n)}}function eT(e,i){e&1&&(s(0,"mat-error"),d(1," Threshold must be at least 0% "),c())}function tT(e,i){e&1&&(s(0,"mat-error"),d(1," Threshold cannot exceed 100% "),c())}function nT(e,i){if(e&1&&(s(0,"div",16)(1,"label",17),d(2,"Alert Threshold (%)"),c(),s(3,"mat-form-field",18),re(4,"input",26),s(5,"mat-hint"),d(6,"Get notified when you reach this percentage of your budget"),c(),N(7,eT,2,0,"mat-error",20)(8,tT,2,0,"mat-error",20),c()()),e&2){let n,t,r=v();u(7),P("ngIf",(n=r.budgetForm.get("budgetAlertThreshold"))==null?null:n.hasError("min")),u(),P("ngIf",(t=r.budgetForm.get("budgetAlertThreshold"))==null?null:t.hasError("max"))}}function iT(e,i){e&1&&(s(0,"div",16)(1,"mat-slide-toggle",27)(2,"span",28),d(3,"Enable budget alerts"),c()()())}var xC=(()=>{let i=class i{constructor(t,r,a){this.dialogRef=t,this.data=r,this.budgetService=a,this.minDate=new Date,this.maxDate=new Date(new Date().getFullYear()+1,11,31),this.budgetForm=this.budgetService.createBudgetForm(),this.budgetPeriods=this.budgetService.getBudgetPeriods()}ngOnInit(){this.budgetService.initializeBudgetForm(this.budgetForm,this.data.category)}onCancel(){this.dialogRef.close()}onSave(){if(this.budgetService.isBudgetFormValid(this.budgetForm)){let t=this.budgetService.getBudgetDataFromForm(this.budgetForm);this.dialogRef.close(t)}}get isFormValid(){return this.budgetService.isBudgetFormValid(this.budgetForm)}get budgetAmountControl(){return this.budgetForm.get("budgetAmount")}get budgetPeriodControl(){return this.budgetForm.get("budgetPeriod")}};i.\u0275fac=function(r){return new(r||i)(Y(Mi),Y(Pi),Y(qc))},i.\u0275cmp=Re({type:i,selectors:[["app-category-budget-dialog"]],decls:30,vars:11,consts:[["startPicker",""],["endPicker",""],[1,"budget-dialog-container"],[1,"dialog-header"],["mat-dialog-title",""],[1,"header-icon"],["mat-icon-button","",1,"close-button",3,"click"],[1,"dialog-content"],[1,"budget-form",3,"formGroup"],[1,"form-field-toggle"],[1,"toggle-label","text-sm","font-semibold"],["formControlName","hasBudget","color","primary",1,"budget-toggle"],["class","form-field",4,"ngIf"],[1,"dialog-actions"],["mat-button","",1,"cancel-button",3,"click"],["mat-raised-button","","color","primary",1,"save-button",3,"click","disabled"],[1,"form-field"],[1,"field-label"],["appearance","fill",1,"form-input-field"],["matInput","","type","number","formControlName","budgetAmount","placeholder","0.00","step","0.01",1,"form-input"],[4,"ngIf"],["formControlName","budgetPeriod",1,"form-select"],[3,"value"],["matInput","","formControlName","budgetStartDate","placeholder","Choose start date",1,"form-input",3,"matDatepicker","min","max"],["matSuffix","",3,"for"],["matInput","","formControlName","budgetEndDate","placeholder","Choose end date (optional)",1,"form-input",3,"matDatepicker","min","max"],["matInput","","type","number","formControlName","budgetAlertThreshold","placeholder","80",1,"form-input"],["formControlName","budgetAlertEnabled","color","primary",1,"alert-toggle"],[1,"toggle-label"]],template:function(r,a){if(r&1&&(s(0,"div",2)(1,"div",3)(2,"h2",4)(3,"mat-icon",5),d(4,"account_balance_wallet"),c(),d(5),c(),s(6,"button",6),F("click",function(){return a.onCancel()}),s(7,"mat-icon"),d(8,"close"),c()()(),s(9,"mat-dialog-content",7)(10,"form",8)(11,"div",9)(12,"span",10),d(13),c(),re(14,"mat-slide-toggle",11),c(),N(15,Hk,7,2,"div",12)(16,Kk,8,1,"div",12)(17,Qk,9,5,"div",12)(18,Jk,8,4,"div",12)(19,nT,9,2,"div",12)(20,iT,4,0,"div",12),c()(),s(21,"mat-dialog-actions",13)(22,"button",14),F("click",function(){return a.onCancel()}),s(23,"mat-icon"),d(24,"cancel"),c(),d(25," Cancel "),c(),s(26,"button",15),F("click",function(){return a.onSave()}),s(27,"mat-icon"),d(28,"save"),c(),d(29),c()()()),r&2){let o,l,m,g,f,h;u(5),ne(" ",a.data.isEdit?"Edit":"Set"," Budget "),u(5),P("formGroup",a.budgetForm),u(3),ne("Set budget for ",a.data.category.name,""),u(2),P("ngIf",(o=a.budgetForm.get("hasBudget"))==null?null:o.value),u(),P("ngIf",(l=a.budgetForm.get("hasBudget"))==null?null:l.value),u(),P("ngIf",(m=a.budgetForm.get("hasBudget"))==null?null:m.value),u(),P("ngIf",(g=a.budgetForm.get("hasBudget"))==null?null:g.value),u(),P("ngIf",(f=a.budgetForm.get("hasBudget"))==null?null:f.value),u(),P("ngIf",(h=a.budgetForm.get("hasBudget"))==null?null:h.value),u(6),P("disabled",!a.isFormValid),u(3),ne(" ",a.data.isEdit?"Update":"Set"," Budget ")}},dependencies:[dt,Wn,Nt,Ui,At,Yn,xi,Ci,Jt,gn,Qe,am,om,sm,Oi,nm,ja,$a,wi,yi,da,Q0,em,J0,ma],styles:["@media (max-width: 640px){.budget-dialog-container[_ngcontent-%COMP%]{min-width:320px;max-width:100vw}}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 1.5rem 0;border-bottom:1px solid #e5e7eb}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{padding-left:0!important;margin:0;display:flex;align-items:center;gap:.5rem;font-size:1.25rem;font-weight:600;color:#1f2937}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{color:#3b82f6}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#6b7280}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#374151;background-color:#f3f4f6}.dialog-content[_ngcontent-%COMP%]{padding:1.5rem;max-height:70vh;overflow-y:auto}.dialog-content[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]{font-weight:500;color:#374151;font-size:.875rem}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .form-input-field[_ngcontent-%COMP%]{width:100%}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .form-input-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%], .dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .form-input-field[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{font-size:.875rem}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%], .dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]{margin-top:.5rem}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-weight:500;color:#374151;margin-left:.5rem}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;padding:1rem 1.5rem 1.5rem;border-top:1px solid #e5e7eb}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{color:#6b7280}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]:hover{color:#374151;background-color:#f3f4f6}.dialog-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.dialog-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#2563eb}.dialog-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:disabled{background-color:#9ca3af;color:#6b7280}.form-field-toggle[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:baseline}"]});let e=i;return e})();var rT=()=>({round:!0});function aT(e,i){if(e&1&&re(0,"div",34),e&2){let n=v(3);wt("width",n.getTimeProgressPercentage(n.category.budget==null?null:n.category.budget.budgetPeriod),"%")}}function oT(e,i){if(e&1&&(s(0,"span",37),d(1),ce(2,"currency"),c()),e&2){let n=v(4);u(),ne(" Spent: ",ht(2,1,n.calculateBudgetSpent(n.category),ka(4,rT))," ")}}function sT(e,i){if(e&1&&(s(0,"div",35),N(1,oT,3,5,"span",36),c()),e&2){let n=v(3);u(),P("ngIf",!n.isSpendingOnTrack(n.category))}}function cT(e,i){if(e&1&&(s(0,"div",28)(1,"div",29),N(2,aT,1,2,"div",30),re(3,"div",31),c(),s(4,"span",32),d(5),ce(6,"currency"),c(),N(7,sT,2,1,"div",33),c()),e&2){let n=v(2);u(),P("matTooltip",n.getProgressComparisonTooltip(n.category)),u(),P("ngIf",n.category.budget==null?null:n.category.budget.budgetPeriod),u(),wt("width",n.Math.min(n.calculateBudgetProgressPercentage(n.category),100),"%")("background-color",n.getBudgetProgressColor(n.category)),u(2),$t(" ",xe(6,9,n.calculateBudgetSpent(n.category))," (",n.calculateBudgetProgressPercentage(n.category).toFixed(1),"%) "),u(2),P("ngIf",n.category.budget==null?null:n.category.budget.budgetPeriod)}}function lT(e,i){if(e&1&&(s(0,"div",22)(1,"div",23)(2,"span",24),d(3,"Budget:"),c(),s(4,"span",25),d(5),ce(6,"currency"),c(),s(7,"span",26),d(8),c()(),N(9,cT,8,11,"div",27),c()),e&2){let n=v();u(5),L(xe(6,3,n.category.budget==null?null:n.category.budget.budgetAmount)),u(3),ne("/ ",n.getCurrentBudgetPeriodText(n.category.budget==null?null:n.category.budget.budgetPeriod),""),u(),P("ngIf",n.category.budget==null?null:n.category.budget.hasBudget)}}function dT(e,i){if(e&1&&(s(0,"div",38)(1,"span",39),d(2),c(),s(3,"span",40),d(4),ce(5,"currency"),ce(6,"currency"),c()()),e&2){let n=v();u(2),L(n.category.type==="expense"?"Spent:":"Income:"),u(2),L(n.category.type==="expense"?xe(5,2,n.calculateTotalSpentPerMonth(n.category)):xe(6,4,n.calculateTotalIncomePerMonth(n.category)))}}function mT(e,i){if(e&1&&(s(0,"div",38)(1,"span",39),d(2,"Total sub-categories:"),c(),s(3,"span",40),d(4),c()()),e&2){let n=v();u(4),L(n.subCategoryCount)}}function gT(e,i){if(e&1){let n=ue();s(0,"button",41),F("click",function(){R(n);let r=v();return B(r.onOpenBudgetDialog())}),s(1,"mat-icon"),d(2,"account_balance_wallet"),c(),d(3),c()}if(e&2){let n=v();P("matTooltip",n.category.budget!=null&&n.category.budget.hasBudget?"Edit budget":"Set budget"),u(3),ne(" ",n.category.budget!=null&&n.category.budget.hasBudget?"Edit Budget":"Set Budget"," ")}}function uT(e,i){if(e&1){let n=ue();s(0,"button",42),F("click",function(){R(n);let r=v();return B(r.onSelectParentCategory())}),s(1,"mat-icon"),d(2,"account_tree"),c(),d(3," Select Parent Category "),c()}}function pT(e,i){if(e&1){let n=ue();s(0,"button",43),F("click",function(){R(n);let r=v();return B(r.onRemoveFromParentCategory())}),s(1,"mat-icon"),d(2,"account_tree_off"),c(),d(3," Remove from Parent "),c()}}function fT(e,i){if(e&1){let n=ue();s(0,"div",44)(1,"button",45),F("click",function(){R(n);let r=v();return B(r.onOpenDetailsDialog())}),s(2,"mat-icon"),d(3,"expand_more"),c(),s(4,"span"),d(5,"Show More"),c()()()}}var Jm=(()=>{let i=class i{constructor(t,r,a,o,l,m,g,f,h){this.dateService=t,this.dialog=r,this.notificationService=a,this.hapticFeedback=o,this.categoryService=l,this.budgetService=m,this.store=g,this.auth=f,this.breakpointService=h,this.isMobile=!1,this.recentTransactions=[],this.subCategoryCount=0,this.allTransactions=[],this.subCategories=[],this.userId="",this.initializeUserId(),this.subCategoryCount=this.subCategories.length||0}initializeUserId(){return me(this,null,function*(){let t=yield this.auth.currentUser;t&&(this.userId=t.uid)})}calculateBudgetSpent(t){var m,g;if(!((m=t.budget)!=null&&m.hasBudget)||!((g=t.budget)!=null&&g.budgetAmount))return 0;let r=this.allTransactions.filter(f=>f.categoryId===t.id&&f.type===Lt.EXPENSE),{startDate:a,endDate:o}=this.getDynamicBudgetPeriodDates(t.budget.budgetPeriod);return!a||!o?0:r.filter(f=>{let h=this.dateService.toDate(f.date);return h&&h>=a&&h<=o}).reduce((f,h)=>f+Math.abs(h.amount),0)}getDynamicBudgetPeriodDates(t){if(!t)return{startDate:null,endDate:null};let r=new Date,a,o;switch(t){case"daily":a=new Date(r.getFullYear(),r.getMonth(),r.getDate()),o=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999);break;case"weekly":let l=r.getDay(),m=l===0?6:l-1;a=new Date(r.getFullYear(),r.getMonth(),r.getDate()-m),o=new Date(a.getTime()+6*24*60*60*1e3),o.setHours(23,59,59,999);break;case"monthly":a=new Date(r.getFullYear(),r.getMonth(),1),o=new Date(r.getFullYear(),r.getMonth()+1,0,23,59,59,999);break;case"yearly":a=new Date(r.getFullYear(),0,1),o=new Date(r.getFullYear(),11,31,23,59,59,999);break;default:return{startDate:null,endDate:null}}return{startDate:a,endDate:o}}getCurrentBudgetPeriodText(t){if(!t)return"";let{startDate:r,endDate:a}=this.getDynamicBudgetPeriodDates(t);if(!r||!a)return this.formatBudgetPeriod(t);let o=l=>l.toLocaleDateString("en-US",{month:"short",day:"numeric",year:r.getFullYear()!==a.getFullYear()?"numeric":void 0});switch(t){case"daily":return"Day";case"weekly":return"Week";case"monthly":return"Month";case"yearly":return"Year";default:return this.formatBudgetPeriod(t)}}getRemainingDaysInBudgetPeriod(t){if(!t)return 0;let{endDate:r}=this.getDynamicBudgetPeriodDates(t);if(!r)return 0;let a=new Date,o=r.getTime()-a.getTime(),l=Math.ceil(o/(1e3*3600*24));return Math.max(0,l)}getTotalDaysInBudgetPeriod(t){if(!t)return 0;let{startDate:r,endDate:a}=this.getDynamicBudgetPeriodDates(t);if(!r||!a)return 0;let o=a.getTime()-r.getTime(),l=Math.ceil(o/(1e3*3600*24));return Math.max(1,l+1)}getDailyAverageSpending(t){var g;if(!((g=t.budget)!=null&&g.budgetPeriod))return 0;let r=this.calculateBudgetSpent(t),{startDate:a}=this.getDynamicBudgetPeriodDates(t.budget.budgetPeriod);if(!a)return 0;let l=new Date().getTime()-a.getTime(),m=Math.max(1,Math.ceil(l/(1e3*3600*24)));return r/m}getProjectedSpending(t){var o;if(!((o=t.budget)!=null&&o.budgetPeriod))return 0;let r=this.getDailyAverageSpending(t),a=this.getTotalDaysInBudgetPeriod(t.budget.budgetPeriod);return r*a}isSpendingOnTrack(t){var o,l;if(!((o=t.budget)!=null&&o.budgetAmount)||!((l=t.budget)!=null&&l.budgetPeriod))return!0;let r=this.getProjectedSpending(t),a=t.budget.budgetAmount;return r<=a}getTimeProgressPercentage(t){if(!t)return 0;let{startDate:r,endDate:a}=this.getDynamicBudgetPeriodDates(t);if(!r||!a)return 0;let o=new Date,l=a.getTime()-r.getTime(),m=o.getTime()-r.getTime();if(l<=0)return 0;let g=m/l*100;return Math.min(100,Math.max(0,g))}getTimeProgressTooltip(t){if(!t)return"";let{startDate:r,endDate:a}=this.getDynamicBudgetPeriodDates(t);if(!r||!a)return"";let o=this.getTimeProgressPercentage(t),l=this.getRemainingDaysInBudgetPeriod(t),g=this.getTotalDaysInBudgetPeriod(t)-l,f=h=>h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:r.getFullYear()!==a.getFullYear()?"numeric":void 0});return`Time Progress: ${o.toFixed(1)}%
Period: ${f(r)} - ${f(a)}
Elapsed: ${g} days
Remaining: ${l} days`}getProgressComparisonTooltip(t){var f;if(!((f=t.budget)!=null&&f.budgetPeriod))return"";let r=this.calculateBudgetProgressPercentage(t),a=this.getTimeProgressPercentage(t.budget.budgetPeriod),o=this.calculateBudgetSpent(t),l=t.budget.budgetAmount||0,m=this.getRemainingDaysInBudgetPeriod(t.budget.budgetPeriod),g="";return r>a?g="\u26A0\uFE0F Spending  crossed":r<a?g="\u2705 Spending on track":g="\u2696\uFE0F Spending matches time",g}calculateBudgetRemaining(t){var a,o;if(!((a=t.budget)!=null&&a.hasBudget)||!((o=t.budget)!=null&&o.budgetAmount))return 0;let r=this.calculateBudgetSpent(t);return Math.max(0,(t.budget.budgetAmount||0)-r)}calculateBudgetProgressPercentage(t){var o,l;if(!((o=t.budget)!=null&&o.hasBudget)||!((l=t.budget)!=null&&l.budgetAmount))return 0;let r=this.calculateBudgetSpent(t),a=t.budget.budgetAmount||0;return a===0?0:Math.min(100,r/a*100)}calculateTotalSpentPerMonth(t){var l;if(!this.allTransactions||this.allTransactions.length===0)return 0;let r=this.allTransactions.filter(m=>m.categoryId===t.id&&m.type===Lt.EXPENSE);if((l=t.budget)!=null&&l.budgetPeriod){let{startDate:m,endDate:g}=this.getDynamicBudgetPeriodDates(t.budget.budgetPeriod);if(m&&g)return r.filter(h=>{let x=this.dateService.toDate(h.date);return x&&x>=m&&x<=g}).reduce((h,x)=>h+Math.abs(x.amount),0)}let a=new Date().getMonth(),o=new Date().getFullYear();return r.filter(m=>{let g=this.dateService.toDate(m.date);return g?g.getMonth()===a&&g.getFullYear()===o:!1}).reduce((m,g)=>m+Math.abs(g.amount),0)}calculateTotalIncomePerMonth(t){var l;if(!this.allTransactions||this.allTransactions.length===0)return 0;let r=this.allTransactions.filter(m=>m.categoryId===t.id&&m.type===Lt.INCOME);if((l=t.budget)!=null&&l.budgetPeriod){let{startDate:m,endDate:g}=this.getDynamicBudgetPeriodDates(t.budget.budgetPeriod);if(m&&g)return r.filter(h=>{let x=this.dateService.toDate(h.date);return x&&x>=m&&x<=g}).reduce((h,x)=>h+Math.abs(x.amount),0)}let a=new Date().getMonth(),o=new Date().getFullYear();return r.filter(m=>{let g=this.dateService.toDate(m.date);return g?m.amount>0&&g.getMonth()===a&&g.getFullYear()===o:!1}).reduce((m,g)=>m+g.amount,0)}getBudgetProgressColor(t){let r=this.calculateBudgetProgressPercentage(t);return r>=100?"#ef4444":r>=80?"#f59e0b":r>=60?"#3b82f6":"#10b981"}formatBudgetPeriod(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}getBudgetStatusClass(t){let r=this.calculateBudgetProgressPercentage(t);return r>=100?"danger":r>=80?"warning":"safe"}getRemainingBudgetClass(t){return this.calculateBudgetRemaining(t)<0?"danger":"safe"}onEditCategory(){this.isMobile?this.openMobileEditDialog():this.openEditDialog()}onDeleteCategory(){this.categoryService.performDelete(this.category,this.userId)}onOpenBudgetDialog(){this.openBudgetDialog()}onSelectParentCategory(){this.openParentCategorySelectorDialog()}onRemoveFromParentCategory(){this.removeFromParentCategory()}onOpenDetailsDialog(){let t={category:this.category,subCategories:this.subCategories,recentTransactions:this.recentTransactions,categoryStats:this.categoryStats,allTransactions:this.allTransactions};this.dialog.open(Qm,{data:t,width:"90vw",maxWidth:"700px",height:"85vh",maxHeight:"85vh",disableClose:!1,autoFocus:!1,hasBackdrop:!0,backdropClass:"dialog-backdrop",panelClass:"category-details-dialog-panel"})}openMobileEditDialog(){this.dialog.open(ks,{width:"100vw",height:"100vh",maxWidth:"100vw",maxHeight:"100vh",data:{category:oe({},this.category),isEdit:!0},disableClose:!1,autoFocus:!1,hasBackdrop:!0,backdropClass:"dialog-backdrop",panelClass:"mobile-category-dialog-panel"}).afterClosed().subscribe(r=>{r&&(this.notificationService.success("Category updated successfully"),this.hapticFeedback.successVibration())})}openEditDialog(){this.dialog.open(ks,{width:"500px",maxWidth:"90vw",data:{category:oe({},this.category),isEdit:!0},disableClose:!1}).afterClosed().subscribe(r=>{r&&this.notificationService.success("Category updated successfully")})}openBudgetDialog(){var r;this.dialog.open(xC,{width:"500px",maxWidth:"90vw",data:{category:this.category,isEdit:((r=this.category.budget)==null?void 0:r.hasBudget)||!1},disableClose:!1}).afterClosed().subscribe(a=>{a&&this.updateCategoryBudget(a)})}updateCategoryBudget(t){if(!this.category.id){this.notificationService.error("Category ID not found");return}this.store.dispatch(aa({userId:this.userId,categoryId:this.category.id,name:this.category.name,categoryType:this.category.type,icon:this.category.icon,color:this.category.color,budgetData:t})),this.notificationService.success(t.hasBudget?"Budget set successfully for "+this.category.name:"Budget removed from "+this.category.name)}openParentCategorySelectorDialog(){this.categoryService.openParentCategorySelectorDialog(this.category).subscribe(t=>{t&&this.convertToSubCategory(t)})}convertToSubCategory(t){if(!this.category.id||!t.id){this.notificationService.error("Category ID not found");return}this.store.dispatch(aa({userId:this.userId,categoryId:this.category.id,name:this.category.name,categoryType:this.category.type,icon:this.category.icon,color:this.category.color,parentCategoryId:t.id,isSubCategory:!0})),this.notificationService.success(`${this.category.name} is now a sub-category of ${t.name}`)}removeFromParentCategory(){if(!this.category.id){this.notificationService.error("Category ID not found");return}this.store.dispatch(aa({userId:this.userId,categoryId:this.category.id,name:this.category.name,categoryType:this.category.type,icon:this.category.icon,color:this.category.color,parentCategoryId:null,isSubCategory:!1})),this.category.parentCategoryId&&this.notificationService.success(`${this.category.name} is no longer a sub-category`)}};i.\u0275fac=function(r){return new(r||i)(Y(Vt),Y(xn),Y(ft),Y(mr),Y(Za),Y(qc),Y(pt),Y(xt),Y(gr))},i.\u0275cmp=Re({type:i,selectors:[["app-category-card"]],inputs:{category:"category",isMobile:"isMobile",recentTransactions:"recentTransactions",categoryStats:"categoryStats",subCategoryCount:"subCategoryCount",Math:"Math",allTransactions:"allTransactions",subCategories:"subCategories"},decls:35,vars:17,consts:[["menu","matMenu"],[1,"category-item"],[1,"category-content"],[1,"category-info"],[1,"category-icon-name"],[1,"category-icon-container"],[1,"category-icon"],[1,"category-header"],[1,"category-name"],[1,"text-[0.6rem]","text-gray-400","italic"],[1,"category-details"],["class","budget-info",4,"ngIf"],["class","category-spent",4,"ngIf"],[1,"category-actions"],["mat-menu-item","","class","action-button budget-button",3,"matTooltip","click",4,"ngIf"],["mat-menu-item","","matTooltip","Edit category",1,"action-button","edit-button",3,"click"],["mat-menu-item","","class","action-button parent-button","matTooltip","Select parent category",3,"click",4,"ngIf"],["mat-menu-item","","class","action-button remove-parent-button","matTooltip","Remove from parent category",3,"click",4,"ngIf"],["mat-menu-item","","matTooltip","Delete category",1,"action-button","delete-button",3,"click"],[1,"!text-red-800"],["matIconButton","",3,"matMenuTriggerFor"],["class","expand-section",4,"ngIf"],[1,"budget-info"],[1,"budget-amount"],[1,"budget-label"],[1,"budget-value"],[1,"budget-period"],["class","budget-progress",4,"ngIf"],[1,"budget-progress"],["matTooltipPosition","above",1,"progress-bar",3,"matTooltip"],["class","time-progress-bg",3,"width",4,"ngIf"],[1,"spending-progress-fill"],[1,"progress-text"],["class","budget-details",4,"ngIf"],[1,"time-progress-bg"],[1,"budget-details"],["class","budget-detail-item text-red-600",4,"ngIf"],[1,"budget-detail-item","text-red-600"],[1,"category-spent"],[1,"category-spent-label"],[1,"category-spent-value"],["mat-menu-item","",1,"action-button","budget-button",3,"click","matTooltip"],["mat-menu-item","","matTooltip","Select parent category",1,"action-button","parent-button",3,"click"],["mat-menu-item","","matTooltip","Remove from parent category",1,"action-button","remove-parent-button",3,"click"],[1,"expand-section"],["mat-button","",1,"expand-btn",3,"click"]],template:function(r,a){if(r&1){let o=ue();s(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"mat-icon",6),d(6),c()(),s(7,"div",7)(8,"h3",8),d(9),s(10,"span",9),d(11),ce(12,"titlecase"),c()()()(),s(13,"div",10),N(14,lT,10,5,"div",11)(15,dT,7,6,"div",12)(16,mT,5,1,"div",12),c()(),s(17,"div",13)(18,"mat-menu",null,0),N(20,gT,4,2,"button",14),s(21,"button",15),F("click",function(){return R(o),B(a.onEditCategory())}),s(22,"mat-icon"),d(23,"edit"),c(),d(24," Edit "),c(),N(25,uT,4,0,"button",16)(26,pT,4,0,"button",17),s(27,"button",18),F("click",function(){return R(o),B(a.onDeleteCategory())}),s(28,"mat-icon",19),d(29,"delete"),c(),d(30," Delete "),c()(),s(31,"button",20)(32,"mat-icon"),d(33,"more_vert"),c()()()(),N(34,fT,6,0,"div",21),c()}if(r&2){let o=bn(19);wt("border-left-color",a.category.color),u(5),wt("color",a.category.color),u(),L(a.category.icon||"category"),u(3),ne("",a.category.name," "),u(2),ne(" ",xe(12,15,a.category.type),""),u(3),P("ngIf",a.category==null||a.category.budget==null?null:a.category.budget.hasBudget),u(),P("ngIf",!(!(a.category==null||a.category.budget==null)&&a.category.budget.hasBudget)),u(),P("ngIf",a.breakpointService.device.isDesktop&&a.subCategoryCount>0),u(4),P("ngIf",a.category.type==="expense"),u(5),P("ngIf",!a.category.isSubCategory&&!(a.category.subCategories!=null&&a.category.subCategories.length)),u(),P("ngIf",a.category.isSubCategory||a.category.parentCategoryId),u(5),P("matMenuTriggerFor",o),u(3),P("ngIf",!a.isMobile)}},dependencies:[dt,Jt,Qe,Wa,Ya,Ga,Tn,sr,Sr],styles:["@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.category-item[_ngcontent-%COMP%]{width:100%;background:#fff;border-radius:12px;padding:1.25rem;border:1px solid #e5e7eb;cursor:pointer;transition:all .2s ease;border-left:4px solid transparent;min-height:12.6rem}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]{padding:.5rem;border-radius:10px;min-height:inherit}}.category-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a;border-color:#d1d5db}.category-item.expanded[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.category-item[_ngcontent-%COMP%]   .category-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem;position:relative}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-content[_ngcontent-%COMP%]{gap:.75rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]{flex:1;min-width:0;padding-right:3rem}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]{padding-right:1.5rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem;margin-bottom:.75rem}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]{gap:.5rem;margin-bottom:.5rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]{width:2rem;height:2rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem;color:#fff}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem;flex:1;min-width:0}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-header[_ngcontent-%COMP%]{gap:.125rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-header[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:clamp(1rem,2.5vw,1.25rem);font-weight:600;color:#1f2937;margin:0;line-height:1.2;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-header[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:1rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:.5rem}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]{gap:.375rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.375rem;width:100%}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]{gap:.25rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;flex-wrap:wrap}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .budget-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .budget-value[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#1f2937}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .budget-period[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background-color:#e5e7eb;border-radius:4px;overflow:hidden;position:relative}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .time-progress-bg[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background:linear-gradient(90deg,#d1d5db,#9ca3af);border-radius:4px;transition:width .3s ease;opacity:.6;z-index:1}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .spending-progress-fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;transition:width .3s ease;border-radius:4px;z-index:2;box-shadow:0 1px 2px #0000001a}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;display:block;line-height:1.2}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-legend[_ngcontent-%COMP%]{display:flex;gap:.75rem;margin-top:.25rem}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:2px}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color.spending[_ngcontent-%COMP%]{background:linear-gradient(90deg,#3b82f6,#1d4ed8)}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color.time[_ngcontent-%COMP%]{background:linear-gradient(90deg,#d1d5db,#9ca3af)}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-text[_ngcontent-%COMP%]{font-size:.625rem;color:#6b7280;font-weight:500}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .budget-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.125rem;margin-top:.25rem}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .budget-details[_ngcontent-%COMP%]   .budget-detail-item[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280;line-height:1.2}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .budget-details[_ngcontent-%COMP%]   .budget-detail-item.text-red-600[_ngcontent-%COMP%]{color:#dc2626;font-weight:500}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .category-spent[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.25rem;flex-wrap:wrap;padding:.25rem 0}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .category-spent[_ngcontent-%COMP%]   .category-spent-label[_ngcontent-%COMP%]{font-size:.775rem;color:#6b7280;font-weight:500}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .category-spent[_ngcontent-%COMP%]   .category-spent-value[_ngcontent-%COMP%]{font-size:.775rem;font-weight:600;color:#6b7280;position:relative;left:.3rem}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-shrink:0;align-items:flex-start;position:absolute;right:0;top:0}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]{gap:.25rem}}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button[matIconButton][_ngcontent-%COMP%]{min-width:44px;min-height:44px}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button[matIconButton][_ngcontent-%COMP%]{min-width:40px;min-height:40px}}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button[matIconButton][_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.1)}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button[matIconButton][_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{min-width:44px;min-height:44px}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{min-width:40px;min-height:40px}}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.1)}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.budget-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#dbeafe}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.budget-button[_ngcontent-%COMP%]:hover:not(:disabled)   mat-icon[_ngcontent-%COMP%]{color:#2563eb}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.budget-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.edit-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#fef3c7}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.edit-button[_ngcontent-%COMP%]:hover:not(:disabled)   mat-icon[_ngcontent-%COMP%]{color:#d97706}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.edit-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.delete-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#fee2e2}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.delete-button[_ngcontent-%COMP%]:hover:not(:disabled)   mat-icon[_ngcontent-%COMP%]{color:#dc2626}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.delete-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.parent-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#e0e7ff}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.parent-button[_ngcontent-%COMP%]:hover:not(:disabled)   mat-icon[_ngcontent-%COMP%]{color:#6366f1}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.parent-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.remove-parent-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#fef3c7}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.remove-parent-button[_ngcontent-%COMP%]:hover:not(:disabled)   mat-icon[_ngcontent-%COMP%]{color:#f59e0b}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.remove-parent-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.expand-section[_ngcontent-%COMP%]{margin-top:1rem;text-align:center}.expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem;font-weight:500;transition:all .2s ease}.expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]:hover{color:#3b82f6;background:#eff6ff}.expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem;margin-right:.5rem}.category-details-expanded[_ngcontent-%COMP%]{margin-top:1.5rem;border-top:1px solid #e5e7eb;padding-top:1.5rem}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header{border-bottom:1px solid #e5e7eb}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-label{color:#6b7280;font-weight:500;min-width:120px}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-label.mat-mdc-tab-label-active{color:#3b82f6}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-header-pagination{display:none}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-ink-bar{background-color:#3b82f6}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-body-wrapper .mat-mdc-tab-body .mat-mdc-tab-body-content{padding:1rem 0}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 0;border-bottom:1px solid #f3f4f6}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-size:.875rem;color:#1f2937;font-weight:600;display:flex;align-items:center;gap:.5rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.danger[_ngcontent-%COMP%]{color:#dc2626}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.warning[_ngcontent-%COMP%]{color:#f59e0b}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.safe[_ngcontent-%COMP%]{color:#10b981}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.negative[_ngcontent-%COMP%]{color:#dc2626}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:1rem;height:1rem;border-radius:50%;border:1px solid #d1d5db}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-budget-details[_ngcontent-%COMP%]{text-align:center;padding:2rem 1rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-budget-details[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;color:#9ca3af;margin-bottom:1rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-budget-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#374151;margin:0 0 .5rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-budget-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin:0 0 1.5rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]{text-align:center;padding:2rem 1rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2.5rem;width:2.5rem;height:2.5rem;color:#9ca3af;margin-bottom:1rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin:0}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 0;border-bottom:1px solid #f3f4f6}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .transaction-description[_ngcontent-%COMP%]{font-size:.875rem;color:#1f2937;font-weight:500}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .transaction-date[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount.positive[_ngcontent-%COMP%]{color:#10b981}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount.negative[_ngcontent-%COMP%]{color:#dc2626}"]});let e=i;return e})();var eg=(e,i)=>i.id,xT=e=>({"px-10":e}),CT=(e,i)=>({"!max-h-[100vh]":e,"!max-h-[75vh]":i}),vT=e=>({"lg:grid-cols-4":e});function bT(e,i){if(e&1){let n=ue();s(0,"div",15)(1,"p",16),d(2),c(),s(3,"button",17),F("click",function(){R(n);let r=v();return B(r.clearError())}),s(4,"mat-icon"),d(5,"close"),c()()()}if(e&2){let n=v();u(2),L(n.errorMessage)}}function yT(e,i){if(e&1){let n=ue();s(0,"button",23),F("click",function(){R(n);let r=v(2);return B(r.openAddMobileDialog())}),s(1,"mat-icon"),d(2,"add"),c(),d(3," Add Category "),c()}}function MT(e,i){if(e&1&&(s(0,"div",18)(1,"div",19)(2,"mat-icon"),d(3,"local_offer"),c()(),s(4,"h3",20),d(5,"No categories yet"),c(),s(6,"p",21),d(7,"Add your first category to get started"),c(),N(8,yT,4,0,"button",22),c()),e&2){let n=v();u(8),P("ngIf",n.breakpointService.device.isMobile)}}function PT(e,i){if(e&1){let n=ue();s(0,"div",31)(1,"div",32)(2,"mat-icon",33),d(3),c(),s(4,"span",34),d(5),c(),s(6,"span",35),d(7),ce(8,"titlecase"),c()(),s(9,"div",36)(10,"mat-menu",null,0)(12,"button",37),F("click",function(){R(n);let r=v().$implicit,a=v(3);return B(a.openMobileDialog(r))}),s(13,"mat-icon"),d(14,"edit"),c(),d(15," Edit"),c(),s(16,"button",38),F("click",function(){R(n);let r=v().$implicit,a=v(3);return B(a.deleteCategory(r))}),s(17,"mat-icon",39),d(18,"delete"),c(),d(19," Delete"),c()(),s(20,"button",40)(21,"mat-icon"),d(22,"more_vert"),c()()()()}if(e&2){let n=bn(11),t=v().$implicit;wt("border-left-color",t.color),u(2),wt("color",t.color),u(),L(t.icon||"category"),u(2),L(t.name),u(2),L(xe(8,8,t.type)),u(13),P("matMenuTriggerFor",n)}}function OT(e,i){if(e&1){let n=ue();s(0,"div",43)(1,"div",32)(2,"mat-icon",33),d(3),c(),s(4,"span",34),d(5),c(),s(6,"span",35),d(7),ce(8,"titlecase"),c()(),s(9,"div",36)(10,"mat-menu",null,1)(12,"button",37),F("click",function(){let r=R(n).$implicit,a=v(5);return B(a.openMobileDialog(r))}),s(13,"mat-icon"),d(14,"edit"),c(),d(15," Edit"),c(),s(16,"button",38),F("click",function(){let r=R(n).$implicit,a=v(5);return B(a.openMobileDialog(r))}),s(17,"mat-icon",39),d(18,"delete"),c(),d(19," Delete"),c()(),s(20,"button",40)(21,"mat-icon"),d(22,"more_vert"),c()()()()}if(e&2){let n=i.$implicit,t=bn(11);wt("border-left-color",n.color),u(2),wt("color",n.color),u(),L(n.icon||"category"),u(2),L(n.name),u(2),L(xe(8,8,n.type)),u(13),P("matMenuTriggerFor",t)}}function wT(e,i){if(e&1&&(s(0,"div",30)(1,"div",41),d(2,"Sub-categories"),c(),Ge(3,OT,23,10,"div",42,eg),c()),e&2){let n=v().$implicit,t=v(3);u(3),He(t.getSubCategoriesForCategory(n.id))}}function ST(e,i){if(e&1&&N(0,PT,23,10,"div",29)(1,wT,5,0,"div",30),e&2){let n=i.$implicit,t=v(3);we(!n.isSubCategory&&!n.parentCategoryId?0:-1),u(),we(t.getSubCategoriesForCategory(n.id).length>0&&t.breakpointService.device.isMobile?1:-1)}}function kT(e,i){if(e&1&&(s(0,"div",28),Ge(1,ST,2,2,null,null,eg),c()),e&2){let n=v(2);u(),He(n.categories)}}function TT(e,i){if(e&1&&re(0,"app-category-card",45),e&2){let n=v().$implicit,t=v(3);P("category",n)("isMobile",t.breakpointService.device.isMobile)("recentTransactions",t.getRecentTransactions(n))("categoryStats",t.getCategoryStats(n))("allTransactions",t.transactions)("subCategories",t.getSubCategoriesForCategory(n.id))("Math",t.Math)}}function ET(e,i){if(e&1&&re(0,"app-category-card",48),e&2){let n=i.$implicit,t=v(2).$implicit,r=v(3);P("category",n)("isMobile",r.breakpointService.device.isMobile)("recentTransactions",r.getRecentTransactions(n))("categoryStats",r.getCategoryStats(n))("allTransactions",r.transactions)("subCategories",r.getSubCategoriesForCategory(t.id))("subCategoryCount",0)("Math",r.Math)}}function IT(e,i){if(e&1&&(s(0,"div",46)(1,"div",41),d(2,"Sub-categories"),c(),s(3,"div",47),Ge(4,ET,1,8,"app-category-card",48,eg),c()()),e&2){let n=v().$implicit,t=v(3);u(4),He(t.getSubCategoriesForCategory(n.id))}}function AT(e,i){if(e&1&&N(0,TT,1,7,"app-category-card",45)(1,IT,6,0,"div",46),e&2){let n=i.$implicit,t=v(3);we(!n.isSubCategory&&!n.parentCategoryId?0:-1),u(),we(t.getSubCategoriesForCategory(n.id).length>0&&t.breakpointService.device.isMobile?1:-1)}}function DT(e,i){if(e&1&&(s(0,"div",44),Ge(1,AT,2,2,null,null,eg),c()),e&2){let n=v(2);P("ngClass",Ta(1,vT,!n.isChildView)),u(),He(n.categories)}}function FT(e,i){if(e&1&&(s(0,"div",24),re(1,"app-budget-card",25),N(2,kT,3,0,"div",26)(3,DT,3,3,"div",27),c()),e&2){let n=v();P("ngClass",y1(5,CT,n.breakpointService.device.isTablePortrait,!n.isChildView)),u(),P("isHomeView",!1)("isChildView",n.isChildView),u(),P("ngIf",n.isListViewMode),u(),P("ngIf",!n.isListViewMode)}}var tg=(()=>{let i=class i{constructor(t,r,a,o,l,m,g,f,h,x){this.auth=t,this.dialog=r,this.notificationService=a,this.hapticFeedback=o,this.breakpointObserver=l,this.store=m,this.budgetService=g,this.dateService=f,this.breakpointService=h,this.categoryService=x,this.quickActionsFabConfig={title:"Quick Actions",mainButtonIcon:"add",mainButtonColor:"primary",mainButtonTooltip:"Add Category",actions:[]},this.isChildView=!1,this.Math=Math,this.transactions=[],this.isLoading=!1,this.errorMessage="",this.isListViewMode=!1,this.userId="",this.destroy$=new Bt,this.isLoading$=this.store.select(Nr),this.transactions$=this.store.select(Gn)}ngOnInit(){this.initializeComponent(),this.subscribeToStoreData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeComponent(){return me(this,null,function*(){let t=yield this.auth.currentUser;if(!t){this.errorMessage="User not authenticated";return}this.userId=t.uid,this.loadUserCategories(),this.loadUserTransactions(),this.loadUserProfile()})}loadUserCategories(){this.store.dispatch(Xi({userId:this.userId}))}loadUserTransactions(){this.store.dispatch(li({userId:this.userId}))}loadUserProfile(){this.store.dispatch(Xa({userId:this.userId}))}subscribeToStoreData(){this.store.select(un).subscribe(t=>{this.categories=t.sort((r,a)=>{var m,g,f,h,x,C,y,b,w,A,E,I;let o=(g=(m=r.budget)==null?void 0:m.hasBudget)!=null?g:!1,l=(h=(f=a.budget)==null?void 0:f.hasBudget)!=null?h:!1;if(o!==l)return o?-1:1;if(this.breakpointService.device.isDesktop){let K=((C=(x=r.subCategories)==null?void 0:x.length)!=null?C:0)>0,Z=((b=(y=a.subCategories)==null?void 0:y.length)!=null?b:0)>0;if(K!==Z)return K?1:-1}else{let K=((A=(w=r.subCategories)==null?void 0:w.length)!=null?A:0)>0,Z=((I=(E=a.subCategories)==null?void 0:E.length)!=null?I:0)>0;if(K!==Z)return K?-1:1}return r.name.localeCompare(a.name)})}),this.transactions$.pipe(yt(this.destroy$)).subscribe(t=>{this.transactions=t}),this.isLoading$.pipe(yt(this.destroy$)).subscribe(t=>{this.isLoading=t}),this.store.select(Ru).pipe(tr(1)).subscribe(t=>{var r;t&&this.isListViewMode!=t.categoryListViewMode&&(this.isListViewMode=(r=t.categoryListViewMode)!=null?r:!1)})}trackByCategoryId(t,r){return r.id||t}clearError(){this.errorMessage=""}openMobileDialog(t){this.dialog.open(ks,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog",data:{category:t?oe({},t):null,isEdit:!!t,allCategories:this.categories}}).afterClosed().pipe(yt(this.destroy$)).subscribe(a=>{a&&this.loadUserCategories()})}openAddMobileDialog(){this.breakpointService.device.isMobile&&this.hapticFeedback.lightVibration(),this.openMobileDialog()}getSubCategoriesForCategory(t){return this.categories.filter(r=>r.isSubCategory&&r.parentCategoryId===t)}calculateBudgetSpent(t){var m,g;if(!((m=t.budget)!=null&&m.hasBudget)||!((g=t.budget)!=null&&g.budgetAmount))return 0;let r=this.transactions.filter(f=>f.categoryId===t.id&&f.type===Lt.EXPENSE),a=t.budget.budgetStartDate,o=t.budget.budgetEndDate,l=r;if(a){let f=this.dateService.toDate(a);if(!f)return 0;l=l.filter(h=>{let x=this.dateService.toDate(h.date);return x&&x>=f})}if(o){let f=this.dateService.toDate(o);if(!f)return 0;l=l.filter(h=>{let x=this.dateService.toDate(h.date);return x&&x<=f})}return l.reduce((f,h)=>f+Math.abs(h.amount),0)}calculateBudgetProgressPercentage(t){var o,l;if(!((o=t.budget)!=null&&o.hasBudget)||!((l=t.budget)!=null&&l.budgetAmount))return 0;let r=this.calculateBudgetSpent(t),a=t.budget.budgetAmount||0;return a===0?0:Math.min(100,r/a*100)}getBudgetProgressColor(t,r,a){var m;let o=r!=null?r:this.calculateBudgetProgressPercentage(t),l=a!=null?a:((m=t.budget)==null?void 0:m.budgetAlertThreshold)||80;return this.budgetService.getBudgetProgressColor(t,o,l)}formatBudgetPeriod(t){return this.budgetService.formatBudgetPeriod(t)}toggleListViewMode(){this.isListViewMode=!this.isListViewMode,this.store.select(Ru).pipe(yt(this.destroy$)).subscribe(t=>{if(t){let r=le(oe({},t),{categoryListViewMode:this.isListViewMode});this.store.dispatch(yo({userId:this.userId,preferences:r}))}})}getRecentTransactions(t){return!t||!t.name?[]:this.transactions.filter(r=>r.categoryId===t.id&&(0,Ku.default)(this.dateService.toDate(r.date)).isSame((0,Ku.default)(),"month"))}getCategoryStats(t){if(!t||!t.name)return{totalTransactions:0,totalSpent:0,averageTransaction:0,largestTransaction:0,thisMonth:0,lastMonth:0};let r=this.transactions.filter(E=>E.categoryId===t.id);if(r.length===0)return{totalTransactions:0,totalSpent:0,averageTransaction:0,largestTransaction:0,thisMonth:0,lastMonth:0};let a=r.length,o=r.reduce((E,I)=>E+Math.abs(I.amount),0),l=o/a,m=Math.max(...r.map(E=>Math.abs(E.amount))),g=new Date,f=g.getMonth(),h=g.getFullYear(),x=f===0?11:f-1,C=f===0?h-1:h,y=r.filter(E=>{let I=this.dateService.toDate(E.date)||new Date;return I.getMonth()===f&&I.getFullYear()===h}),b=r.filter(E=>{let I=this.dateService.toDate(E.date)||new Date;return I.getMonth()===x&&I.getFullYear()===C}),w=y.reduce((E,I)=>E+Math.abs(I.amount),0),A=b.reduce((E,I)=>E+Math.abs(I.amount),0);return{totalTransactions:a,totalSpent:o,averageTransaction:l,largestTransaction:m,thisMonth:w,lastMonth:A}}getBudgetStatusClass(t,r){var o;if(!((o=t.budget)!=null&&o.hasBudget))return"";let a=r!=null?r:this.calculateBudgetProgressPercentage(t);return a>=90?"danger":a>=75?"warning":"safe"}getRemainingBudgetClass(t,r){var l,m,g;if(!((l=t.budget)!=null&&l.hasBudget))return"";let a=r!=null?r:this.calculateBudgetSpent(t),o=(((m=t.budget)==null?void 0:m.budgetAmount)||0)-a;return o<=0?"danger":o<(((g=t.budget)==null?void 0:g.budgetAmount)||0)*.1?"warning":"safe"}calculateTotalSpentPerMonth(t){return this.transactions.filter(o=>o.categoryId===t.id).reduce((o,l)=>o+Math.abs(l.amount),0)}calculateTotalIncomePerMonth(t){return this.transactions.filter(o=>o.categoryId===t.id).reduce((o,l)=>o+l.amount,0)}deleteCategory(t){this.categoryService.performDelete(t,this.userId)}};i.\u0275fac=function(r){return new(r||i)(Y(xt),Y(xn),Y(ft),Y(mr),Y(dr),Y(pt),Y(qc),Y(Vt),Y(gr),Y(Za))},i.\u0275cmp=Re({type:i,selectors:[["user-category"]],inputs:{isChildView:"isChildView"},decls:16,vars:11,consts:[["listMenu","matMenu"],["subListMenu","matMenu"],[3,"mainButtonClick","config"],[1,"categories-container"],["class","error-message mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center justify-between",4,"ngIf"],[1,"categories-grid",3,"ngClass"],[1,"categories-list"],[1,"section-header"],[1,"header-content"],[1,"section-title"],[1,"flex","items-center","gap-2"],[1,"section-subtitle"],[3,"click","matTooltip"],["class","empty-state",4,"ngIf"],["class","categories-grid-list",3,"ngClass",4,"ngIf"],[1,"error-message","mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg","flex","items-center","justify-between"],[1,"text-red-700","text-sm"],["mat-icon-button","",1,"error-close-button",3,"click"],[1,"empty-state"],[1,"empty-icon"],[1,"empty-title"],[1,"empty-text"],["mat-raised-button","","color","primary","class","empty-state-button",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"empty-state-button",3,"click"],[1,"categories-grid-list",3,"ngClass"],[3,"isHomeView","isChildView"],["class","list-view-container pt-4",4,"ngIf"],["class","grid lg:grid-cols-2 xxl:grid-cols-3 gap-4 lg:my-5 pt-4",3,"ngClass",4,"ngIf"],[1,"list-view-container","pt-4"],[1,"list-view-item",3,"border-left-color"],[1,"sub-category-list-wrapper"],[1,"list-view-item"],[1,"list-view-content"],[1,"list-view-icon"],[1,"list-view-name"],[1,"list-view-type"],[1,"list-view-actions"],["mat-menu-item","",1,"action-button","edit-button",3,"click"],["mat-menu-item","",1,"action-button","delete-button",3,"click"],[1,"!text-red-800"],["matIconButton","",3,"matMenuTriggerFor"],[1,"group-header"],[1,"list-view-item","sub-category-item",3,"border-left-color"],[1,"list-view-item","sub-category-item"],[1,"grid","lg:grid-cols-2","xxl:grid-cols-3","gap-4","lg:my-5","pt-4",3,"ngClass"],[3,"category","isMobile","recentTransactions","categoryStats","allTransactions","subCategories","Math"],[1,"sub-category-wrapper"],[1,"sub-categories-container"],[3,"category","isMobile","recentTransactions","categoryStats","allTransactions","subCategories","subCategoryCount","Math"]],template:function(r,a){r&1&&(s(0,"app-quick-actions-fab",2),F("mainButtonClick",function(){return a.openAddMobileDialog()}),c(),s(1,"div",3),N(2,bT,6,1,"div",4),s(3,"div",5)(4,"section",6)(5,"div",7)(6,"div",8)(7,"h2",9),d(8,"Manage Categories"),c(),s(9,"span",10)(10,"p",11),d(11),c(),s(12,"mat-icon",12),F("click",function(){return a.toggleListViewMode()}),d(13),c()()()(),N(14,MT,9,1,"div",13)(15,FT,4,8,"div",14),c()()()),r&2&&(P("config",a.quickActionsFabConfig),u(2),P("ngIf",a.errorMessage),u(),P("ngClass",Ta(9,xT,!a.breakpointService.device.isMobile)),u(8),$t("(",a.categories.length," categor",a.categories.length!==1?"ies":"y",")"),u(),P("matTooltip",a.isListViewMode?"Switch to detailed view":"Switch to list view"),u(),L(a.isListViewMode?"view_list":"list"),u(),P("ngIf",a.categories&&a.categories.length===0),u(),P("ngIf",a.categories.length>0))},dependencies:[$n,dt,Jt,gn,Qe,Wa,Ya,Ga,Tn,rm,ns,Jm,sr],styles:['@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideDown{0%{transform:translateY(-100%);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:-200% 0}to{background-position:200% 0}}.categories-container[_ngcontent-%COMP%]{background:inherit;overflow:auto;position:relative}@media (max-width: 640px){.categories-container[_ngcontent-%COMP%]{padding:.5rem}}.error-message[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease}.error-message[_ngcontent-%COMP%]   .error-close-button[_ngcontent-%COMP%]{color:#dc2626;min-width:44px;min-height:44px}.loading-indicator[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background:linear-gradient(90deg,#f8fafc,#e2e8f0,#f8fafc);border-bottom:1px solid #e2e8f0;box-shadow:0 2px 4px #0000000d;animation:_ngcontent-%COMP%_slideDown .3s ease-out}.loading-indicator[_ngcontent-%COMP%]   mat-progress-bar[_ngcontent-%COMP%]{height:3px}.loading-indicator[_ngcontent-%COMP%]   mat-progress-bar[_ngcontent-%COMP%]     .mat-progress-bar-fill:after{background:linear-gradient(90deg,#3b82f6,#1d4ed8,#3b82f6);animation:_ngcontent-%COMP%_shimmer 2s ease-in-out infinite}.loading-indicator[_ngcontent-%COMP%]   mat-progress-bar[_ngcontent-%COMP%]     .mat-progress-bar-buffer{background:#3b82f61a}.categories-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;margin:0 auto;transition:opacity .3s ease}.categories-grid.loading[_ngcontent-%COMP%]{opacity:.7;pointer-events:none}@media (min-width: 768px){.categories-grid[_ngcontent-%COMP%]{gap:3rem}}@media (max-width: 640px){.categories-grid[_ngcontent-%COMP%]{gap:1.5rem}}.categories-list[_ngcontent-%COMP%]{width:100%}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{margin-bottom:1.5rem;position:relative;display:flex;justify-content:space-between;align-items:flex-start}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;flex:1}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-left:1rem}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .view-toggle-btn[_ngcontent-%COMP%]{color:#6b7280;transition:color .2s ease}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .view-toggle-btn[_ngcontent-%COMP%]:hover{color:#374151}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .view-toggle-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:clamp(1.25rem,3vw,2rem);font-weight:600;color:#1f2937;margin:0 0 .25rem;height:35px}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{color:#6b7280;font-size:clamp(.75rem,2vw,1rem);margin:0}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .mobile-add-button[_ngcontent-%COMP%]{flex-shrink:0;margin-left:1rem;box-shadow:0 4px 12px #00000026;transition:all .2s ease;min-width:56px;min-height:56px}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .mobile-add-button[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 6px 16px #0003}@media (max-width: 640px){.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .mobile-add-button[_ngcontent-%COMP%]{min-width:48px;min-height:48px}}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem;background:#fff;border-radius:12px;border:2px dashed #d1d5db}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{margin-bottom:1rem}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:clamp(2.5rem,6vw,4rem);width:clamp(2.5rem,6vw,4rem);height:clamp(2.5rem,6vw,4rem);color:#9ca3af}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-title[_ngcontent-%COMP%]{font-size:clamp(1rem,2.5vw,1.5rem);font-weight:500;color:#374151;margin:0 0 .5rem}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-text[_ngcontent-%COMP%]{color:#6b7280;font-size:clamp(.75rem,2vw,1rem);margin:0 0 1.5rem}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-state-button[_ngcontent-%COMP%]{min-height:44px;padding:.75rem 1.5rem;display:inline-flex;align-items:center;gap:.5rem}.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]{max-height:calc(92vh - 250px);overflow-y:auto;scrollbar-width:thin;scrollbar-color:#cbd5e1 #f1f5f9}@media (max-width: 640px){.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]{max-height:100vh;gap:.75rem;padding-bottom:2rem}}.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.categories-list[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]{width:100%}.sub-category-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;margin-top:1.5rem;margin-bottom:.5rem;background:#f8fafc;border:2.8px dashed #d4d5d7;border-radius:12px;padding:1rem;box-shadow:0 1px 3px #0000000d}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]{border-radius:10px;margin-top:0;margin-bottom:1rem0}}.sub-category-wrapper[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]{position:absolute;top:-.75rem;left:1rem;background:#f8fafc;padding:0 .5rem;font-size:.75rem;font-weight:600;color:#6b7280;border:1px solid #e2e8f0;border-radius:6px;z-index:1}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]{font-size:.7rem;padding:0 .375rem;top:-.625rem;left:.75rem}}.sub-category-wrapper[_ngcontent-%COMP%]:before{content:"";position:absolute;left:2rem;top:-1.5rem;width:2px;height:1rem;z-index:0}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]:before{left:1.5rem;top:-.95rem;width:1.5px;height:3.75rem;background:linear-gradient(to bottom,#3b82f6,#d1d5db)}}.sub-category-wrapper[_ngcontent-%COMP%]:after{content:"";position:absolute;left:2rem;top:-.5rem;width:1rem;height:2px;background:#3b82f6;z-index:0}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]:after{left:1.5rem;width:.75rem;height:1.5px}}.sub-category-wrapper[_ngcontent-%COMP%]   .sub-categories-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;margin-top:.5rem;position:relative}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]   .sub-categories-container[_ngcontent-%COMP%]{gap:.5rem}}.sub-category-wrapper[_ngcontent-%COMP%]   .sub-categories-container[_ngcontent-%COMP%]:before{content:"";position:absolute;left:1.5rem;top:0;bottom:0;width:2px;background:linear-gradient(to bottom,#d1d5db,#e5e7eb);z-index:0}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]   .sub-categories-container[_ngcontent-%COMP%]:before{left:1rem;width:1.5px}}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]{width:100%;transform:scale(.98);opacity:.95;transition:all .3s ease;position:relative}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:hover{transform:scale(1);opacity:1;z-index:10;border-left-color:#3b82f6}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(1){transform:scale(1);opacity:1;z-index:3}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(2){transform:scale(.99);opacity:.98;z-index:2}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(3){transform:scale(.98);opacity:.95;z-index:1}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(n+4){transform:scale(.97);opacity:.9}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:before{content:"";position:absolute;left:-.75rem;top:50%;width:8px;height:8px;background:#3b82f6;border:2px solid #f8fafc;border-radius:50%;transform:translateY(-50%);z-index:1;box-shadow:0 1px 3px #0000001a}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:before{left:-.5rem;width:6px;height:6px;border-width:1.5px}}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:after{content:"";position:absolute;left:-.5rem;top:50%;width:.5rem;height:2px;background:#3b82f6;transform:translateY(-50%);z-index:0}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:after{left:-.375rem;width:.375rem;height:1.5px}.sub-category-wrapper[_ngcontent-%COMP%]{gap:.25rem}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]{transform:scale(.99)}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:hover{transform:scale(1)}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(1){transform:scale(1)}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(2){transform:scale(.995)}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(3){transform:scale(.99)}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(n+4){transform:scale(.985)}}.budget-summary-card[_ngcontent-%COMP%]{width:100%;background:#dbfbff4a;border-radius:12px;padding:1.25rem;border:1px solid #e5e7eb;transition:all .2s ease;border-left:4px solid #4d98a4;position:relative;overflow:hidden}@media (max-width: 640px){.budget-summary-card[_ngcontent-%COMP%]{padding:.5rem;border-radius:10px}}.budget-summary-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a;border-color:#d1d5db}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin:.65rem 0 .5rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-header[_ngcontent-%COMP%]   .budget-icon[_ngcontent-%COMP%]{color:#fff;font-size:1.5rem;width:1.5rem;height:1.5rem;--tw-bg-opacity: 1;background-color:rgb(70 119 127 / var(--tw-bg-opacity));border-radius:8px;padding:.5rem;display:flex;align-items:center;justify-content:center;flex-shrink:0}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-header[_ngcontent-%COMP%]   .budget-summary-title[_ngcontent-%COMP%]{font-size:clamp(1rem,2.5vw,1.25rem);font-weight:600;color:#1f2937;margin:0;line-height:1.2}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:1rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:.5rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-value[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#6b7280}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-value.spent[_ngcontent-%COMP%], .budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-value.danger[_ngcontent-%COMP%]{color:#dc2626}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-value.warning[_ngcontent-%COMP%]{color:#f59e0b}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-value.safe[_ngcontent-%COMP%]{color:#10b981}.budget-summary-card[_ngcontent-%COMP%]   .overall-budget-progress[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem;margin-bottom:1rem}.budget-summary-card[_ngcontent-%COMP%]   .overall-budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:6px;background-color:#e5e7eb;border-radius:3px;overflow:hidden}.budget-summary-card[_ngcontent-%COMP%]   .overall-budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s ease;border-radius:3px}.budget-summary-card[_ngcontent-%COMP%]   .overall-budget-progress[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;display:block;line-height:1.2}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:.75rem;border-top:1px solid #e5e7eb}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-footer[_ngcontent-%COMP%]   .budget-categories-count[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.budget-summary-card[_ngcontent-%COMP%]   .expand-section[_ngcontent-%COMP%]{display:flex;justify-content:center;border-top:1px solid #e5e7eb}.budget-summary-card[_ngcontent-%COMP%]   .expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem;display:flex;align-items:center;gap:.5rem;transition:color .2s ease}.budget-summary-card[_ngcontent-%COMP%]   .expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]:hover{color:#3b82f6}.budget-summary-card[_ngcontent-%COMP%]   .expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]{margin-top:1rem;padding-top:1rem;border-top:1px solid #e5e7eb}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header{border-bottom:1px solid #e5e7eb;margin-bottom:1rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header .mat-tab-label{color:#6b7280;font-weight:500;min-width:120px}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header .mat-tab-label.mat-tab-label-active{color:#3b82f6}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header .mat-ink-bar{background-color:#3b82f6}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding:.5rem 0}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.5rem 0;border-bottom:1px solid #f3f4f6}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-size:.875rem;color:#1f2937;font-weight:600;display:flex;align-items:center;gap:.5rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;padding:1rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:.75rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-header[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#1f2937}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:.5rem;margin-bottom:.75rem}@media (max-width: 480px){.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]{grid-template-columns:1fr}}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-value[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#1f2937}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-value.spent[_ngcontent-%COMP%], .budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-value.danger[_ngcontent-%COMP%]{color:#dc2626}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-value.warning[_ngcontent-%COMP%]{color:#f59e0b}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-value.safe[_ngcontent-%COMP%]{color:#10b981}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:6px;background-color:#e5e7eb;border-radius:3px;overflow:hidden}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s ease;border-radius:3px}.no-budget-card[_ngcontent-%COMP%]{width:100%;background:#fff;border-radius:12px;padding:1.25rem;border:1px solid #e5e7eb;transition:all .2s ease;border-left:4px solid #f59e0b;margin-bottom:1rem}@media (max-width: 640px){.no-budget-card[_ngcontent-%COMP%]{padding:.5rem;border-radius:10px}}.no-budget-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a;border-color:#d1d5db}.no-budget-card[_ngcontent-%COMP%]   .no-budget-content[_ngcontent-%COMP%]{display:flex;align-items:center;align-items:flex-start;gap:.75rem}.no-budget-card[_ngcontent-%COMP%]   .no-budget-content[_ngcontent-%COMP%]   .no-budget-icon[_ngcontent-%COMP%]{color:#fff;font-size:1.5rem;width:1.5rem;height:1.5rem;background:#f59e0b;border-radius:12px;padding:.5rem;display:flex;align-items:center;justify-content:center;flex-shrink:0}.no-budget-card[_ngcontent-%COMP%]   .no-budget-content[_ngcontent-%COMP%]   .no-budget-text-content[_ngcontent-%COMP%]{flex:1}.no-budget-card[_ngcontent-%COMP%]   .no-budget-content[_ngcontent-%COMP%]   .no-budget-text-content[_ngcontent-%COMP%]   .no-budget-title[_ngcontent-%COMP%]{font-size:clamp(.8rem,2.5vw,1.25rem);font-weight:600;color:#1f2937;margin:0 0 .25rem;line-height:1.2}.no-budget-card[_ngcontent-%COMP%]   .no-budget-content[_ngcontent-%COMP%]   .no-budget-text-content[_ngcontent-%COMP%]   .no-budget-text[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;margin:0;line-height:1.2}.add-category-btn[_ngcontent-%COMP%]{position:fixed!important;bottom:8rem;right:1rem;z-index:100;box-shadow:0 4px 12px #00000026;transition:all .2s ease}.add-category-btn[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 6px 16px #0003}  .mat-autocomplete-panel{border-radius:8px;box-shadow:0 4px 12px #00000026;border:1px solid #e5e7eb;max-height:200px}  .mat-autocomplete-panel .mat-option{padding:.75rem 1rem;font-size:.875rem;color:#374151;transition:all .2s ease}  .mat-autocomplete-panel .mat-option:hover{background:#f3f4f6}  .mat-autocomplete-panel .mat-option.mat-selected{background:#dbeafe;color:#1d4ed8}.list-view-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:.75rem 1rem;border-left:4px solid;box-shadow:0 1px 3px #0000001a;transition:all .2s ease;display:flex;justify-content:space-between;align-items:center}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;flex:1}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem;flex-shrink:0}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-name[_ngcontent-%COMP%]{font-weight:500;color:#1f2937;font-size:.875rem}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-type[_ngcontent-%COMP%]{color:#6b7280;font-size:.75rem;background:#f3f4f6;padding:.25rem .5rem;border-radius:4px;text-transform:uppercase;letter-spacing:.025em}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-actions[_ngcontent-%COMP%]{display:flex;align-items:center}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#6b7280;transition:color .2s ease}.list-view-container[_ngcontent-%COMP%]   .list-view-item[_ngcontent-%COMP%]   .list-view-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#374151}.list-view-container[_ngcontent-%COMP%]   .list-view-item.sub-category-item[_ngcontent-%COMP%]{margin-left:1rem;background:#f9fafb;border-left-width:3px}.list-view-container[_ngcontent-%COMP%]   .list-view-item.sub-category-item[_ngcontent-%COMP%]   .list-view-content[_ngcontent-%COMP%]   .list-view-name[_ngcontent-%COMP%]{font-size:.8rem}.list-view-container[_ngcontent-%COMP%]   .sub-category-list-wrapper[_ngcontent-%COMP%]{margin-top:.5rem}.list-view-container[_ngcontent-%COMP%]   .sub-category-list-wrapper[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]{font-size:.75rem;font-weight:500;color:#6b7280;margin-bottom:.5rem;padding-left:1rem;text-transform:uppercase;letter-spacing:.025em}']});let e=i;return e})();var BT=(e,i)=>i.category;function NT(e,i){if(e&1&&(s(0,"p",5),d(1),c()),e&2){let n=v();u(),ne(" ",n.effectiveConfig.subtitle," ")}}function LT(e,i){if(e&1&&(s(0,"div",6)(1,"mat-icon",10),d(2),c()()),e&2){let n=v();u(2),ne(" ",n.effectiveConfig.headerIcon||"category"," ")}}function VT(e,i){e&1&&(s(0,"div",7)(1,"div",11),re(2,"div",12),c(),s(3,"p",13),d(4,"Loading category data..."),c()())}function UT(e,i){if(e&1&&(s(0,"div",7)(1,"div",14)(2,"mat-icon",15),d(3,"error"),c()(),s(4,"p",16),d(5),c()()),e&2){let n=v();u(5),L(n.effectiveConfig.error)}}function zT(e,i){if(e&1){let n=ue();s(0,"div",20),F("click",function(){let r=R(n).$implicit,a=v(3);return B(a.onCategoryClick(r))}),s(1,"div",21)(2,"div",22)(3,"mat-icon",23),d(4),c()(),s(5,"div",24)(6,"span",25),d(7),c(),s(8,"div",26),d(9),c()()(),s(10,"span",27),d(11),c()()}if(e&2){let n=i.$implicit,t=v(3);ze("cursor-pointer",t.effectiveConfig.clickable)("cursor-default",!t.effectiveConfig.clickable),u(3),wt("color",n.color),u(),L(n.icon),u(3),L(n.category),u(2),ne("",n.percentage.toFixed(1),"% of total"),u(2),L(t.formatCurrency(n.amount))}}function jT(e,i){if(e&1&&(s(0,"div",17),Ge(1,zT,12,10,"div",19,BT),ce(3,"async"),c()),e&2){let n=v(2);u(),He(xe(3,0,n.topCategories$))}}function $T(e,i){if(e&1&&(s(0,"div",18)(1,"div",28)(2,"mat-icon",29),d(3,"bar_chart"),c()(),s(4,"h4",30),d(5,"No Data Available"),c(),s(6,"p",31),d(7),c()()),e&2){let n=v(2);u(7),L(n.effectiveConfig.emptyStateMessage)}}function YT(e,i){if(e&1&&(s(0,"div",8),N(1,jT,4,2,"div",17),ce(2,"async"),N(3,$T,8,1,"div",18),ce(4,"async"),c()),e&2){let n,t=v();u(),we((n=xe(2,2,t.topCategories$))!=null&&n.length?1:-1),u(2),we(xe(4,4,t.isEmpty)?3:-1)}}function WT(e,i){e&1&&(s(0,"span",34),d(1,"Top Categories"),c())}function GT(e,i){if(e&1&&(s(0,"div",9)(1,"div",32)(2,"span"),d(3),c(),s(4,"div",33),N(5,WT,2,0,"span",34),s(6,"span"),d(7),c()()()()),e&2){let n=v();u(3),L(n.effectiveConfig.footerText||"Last updated"),u(2),we(n.effectiveConfig.showDebugInfo?5:-1),u(2),L(n.getLastUpdatedTime())}}var Xc=(()=>{let i=class i{constructor(t){this.store=t,this.config={title:"Top Spending Categories",subtitle:"Your highest expense areas",currency:"INR",showHeaderIcon:!0,headerIcon:"category",headerIconColor:"purple",showFooter:!1,footerText:"Last updated",cardHeight:"medium",theme:"auto",animations:!0,clickable:!0,loading:!1,error:"",emptyStateMessage:"Add transactions to see category breakdown",showDebugInfo:!1,maxItems:5,period:"monthly",transactionType:"expense"},this.destroy$=new Bt,this.transactions$=this.store.select(Gn),this.categories$=this.store.select(un),this.transactionsLoading$=this.store.select(la),this.categoriesLoading$=this.store.select(Nr),this.isLoading$=Or([this.transactionsLoading$,this.categoriesLoading$]).pipe(We(([r,a])=>r||a)),this.topCategories$=this.calculateTopCategories()}ngOnInit(){}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}calculateTopCategories(){return Or([this.transactions$,this.categories$]).pipe(We(([t,r])=>{let a=new Date,o;switch(this.effectiveConfig.period){case"daily":o=new Date(a.getFullYear(),a.getMonth(),a.getDate());break;case"weekly":let h=a.getDay(),x=h===0?6:h-1;o=new Date(a.getFullYear(),a.getMonth(),a.getDate()-x);break;case"yearly":o=new Date(a.getFullYear(),0,1);break;default:o=new Date(a.getFullYear(),a.getMonth(),1);break}let l=t.filter(h=>{let x=this.convertToDate(h.date),C=x>=o&&x<=a,y=this.effectiveConfig.transactionType==="all"||h.type===(this.effectiveConfig.transactionType==="income"?Lt.INCOME:Lt.EXPENSE);return C&&y}),m=new Map;l.forEach(h=>{let x=r.find(C=>C.id===h.categoryId);if(x){let C=m.get(h.categoryId)||{amount:0,category:x};C.amount+=h.amount,m.set(h.categoryId,C)}});let g=Array.from(m.values()).reduce((h,x)=>h+x.amount,0);return Array.from(m.values()).filter(h=>h.amount>0).map(h=>({category:h.category.name,amount:h.amount,percentage:g>0?h.amount/g*100:0,color:h.category.color||"#6B7280",icon:h.category.icon||"category"})).sort((h,x)=>x.amount-h.amount).slice(0,this.effectiveConfig.maxItems||5)}))}convertToDate(t){return t instanceof Date?t:t!=null&&t.seconds?new Date(t.seconds*1e3):new Date(t)}get effectiveConfig(){var t,r,a,o,l,m,g,f,h,x,C,y,b,w,A,E,I,K,Z;return{title:(t=this.config.title)!=null?t:"Top Spending Categories",subtitle:(r=this.config.subtitle)!=null?r:"Your highest expense areas",currency:(a=this.config.currency)!=null?a:"INR",showHeaderIcon:(o=this.config.showHeaderIcon)!=null?o:!0,headerIcon:(l=this.config.headerIcon)!=null?l:"category",headerIconColor:(m=this.config.headerIconColor)!=null?m:"purple",showFooter:(g=this.config.showFooter)!=null?g:!1,footerText:(f=this.config.footerText)!=null?f:"Last updated",cardHeight:(h=this.config.cardHeight)!=null?h:"medium",theme:(x=this.config.theme)!=null?x:"auto",animations:(C=this.config.animations)!=null?C:!0,clickable:(y=this.config.clickable)!=null?y:!0,loading:(b=this.config.loading)!=null?b:!1,error:(w=this.config.error)!=null?w:"",emptyStateMessage:(A=this.config.emptyStateMessage)!=null?A:"Add transactions to see category breakdown",showDebugInfo:(E=this.config.showDebugInfo)!=null?E:!1,maxItems:(I=this.config.maxItems)!=null?I:5,period:(K=this.config.period)!=null?K:"monthly",transactionType:(Z=this.config.transactionType)!=null?Z:"expense",onCategoryClick:this.config.onCategoryClick,onRefresh:this.config.onRefresh}}get cardHeightClass(){switch(this.effectiveConfig.cardHeight){case"small":return"min-h-20";case"large":return"min-h-32";case"auto":return"min-h-0";default:return"min-h-24"}}get headerIconColorClass(){let t=this.effectiveConfig.headerIconColor||"purple";return`bg-${t}-500/10 text-${t}-600 dark:text-${t}-400`}formatCurrency(t){return new Intl.NumberFormat("en-IN",{style:"currency",currency:this.effectiveConfig.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}onCategoryClick(t){this.effectiveConfig.clickable&&this.effectiveConfig.onCategoryClick&&this.effectiveConfig.onCategoryClick(t)}getLastUpdatedTime(){return new Date().toLocaleString("en-IN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}onRefreshClick(){this.effectiveConfig.onRefresh&&this.effectiveConfig.onRefresh()}get isEmpty(){return this.topCategories$.pipe(We(t=>t.length===0))}get hasError(){return!!(this.effectiveConfig.error&&this.effectiveConfig.error.trim())}};i.\u0275fac=function(r){return new(r||i)(Y(pt))},i.\u0275cmp=Re({type:i,selectors:[["app-top-categories-card"]],inputs:{config:"config"},standalone:!0,features:[ia],decls:14,vars:11,consts:[[1,"top-categories-card","bg-white","dark:bg-gray-800","shadow-lg","border-0","rounded-xl","overflow-hidden","h-full"],[1,"p-4","sm:p-6"],[1,"flex","items-center","justify-between","mb-4","sm:mb-6"],[1,"flex-1","min-w-0"],[1,"text-lg","sm:text-xl","font-semibold","text-gray-900","dark:text-white","truncate"],[1,"text-sm","text-gray-600","dark:text-gray-400","mt-1"],[1,"bg-purple-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-center","py-8"],[1,"space-y-4"],[1,"mt-4","sm:mt-6","pt-4","border-t","border-gray-200","dark:border-gray-700"],[1,"text-purple-600","dark:text-purple-400"],[1,"inline-flex","items-center","justify-center","w-12","h-12","bg-blue-100","dark:bg-blue-900/20","rounded-full","mb-4"],[1,"animate-spin","rounded-full","h-6","w-6","border-b-2","border-blue-600"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"bg-red-100","dark:bg-red-900/20","w-12","h-12","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-red-600","dark:text-red-400"],[1,"text-sm","text-red-600","dark:text-red-400"],[1,"space-y-3"],[1,"text-center","py-8","sm:py-12"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg","hover:bg-gray-100","dark:hover:bg-gray-600","transition-colors",3,"cursor-pointer","cursor-default"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg","hover:bg-gray-100","dark:hover:bg-gray-600","transition-colors",3,"click"],[1,"flex","items-center","space-x-3","min-w-0","flex-1"],[1,"w-8","h-8","rounded-full","flex","items-center","justify-center","flex-shrink-0","bg-gray-100","dark:bg-gray-600"],[1,"text-sm"],[1,"min-w-0","flex-1"],[1,"text-gray-700","dark:text-gray-300","font-medium","truncate","block"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"font-semibold","text-gray-900","dark:text-white","ml-3","text-right"],[1,"bg-gray-100","dark:bg-gray-700","w-16","h-16","sm:w-20","sm:h-20","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-gray-400","text-2xl","sm:text-3xl"],[1,"text-base","sm:text-lg","font-medium","text-gray-900","dark:text-white","mb-2"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","justify-between","text-xs","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","gap-4"],[1,"text-xs","opacity-75"]],template:function(r,a){r&1&&(s(0,"mat-card",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),d(5),c(),N(6,NT,2,1,"p",5),c(),N(7,LT,3,1,"div",6),c(),N(8,VT,5,0,"div",7),ce(9,"async"),N(10,UT,6,1,"div",7)(11,YT,5,6,"div",8),ce(12,"async"),N(13,GT,8,3,"div",9),c()()),r&2&&(u(5),ne(" ",a.effectiveConfig.title," "),u(),we(a.effectiveConfig.subtitle?6:-1),u(),we(a.effectiveConfig.showHeaderIcon!==!1?7:-1),u(),we(xe(9,7,a.isLoading$)?8:-1),u(2),we(a.hasError?10:-1),u(),we(!xe(12,9,a.isLoading$)&&!a.hasError?11:-1),u(2),we(a.effectiveConfig.showFooter?13:-1))},dependencies:[La,Vi,Qo,ji,Ua,Qe],styles:[".top-categories-card[_ngcontent-%COMP%]{transition:all .3s ease}.top-categories-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000001a}.top-categories-card[_ngcontent-%COMP%]   .mat-card[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden}.top-categories-card.dark[_ngcontent-%COMP%]{background-color:#1f2937;color:#f9fafb}.top-categories-card[_ngcontent-%COMP%]   .fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out}.top-categories-card[_ngcontent-%COMP%]   .slide-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@media (max-width: 640px){.top-categories-card[_ngcontent-%COMP%]   .p-4[_ngcontent-%COMP%]{padding:1rem}.top-categories-card[_ngcontent-%COMP%]   .text-lg[_ngcontent-%COMP%]{font-size:1.125rem}.top-categories-card[_ngcontent-%COMP%]   .w-8[_ngcontent-%COMP%]{width:2rem}.top-categories-card[_ngcontent-%COMP%]   .h-8[_ngcontent-%COMP%]{height:2rem}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(10px);opacity:0}to{transform:translateY(0);opacity:1}}.category-item[_ngcontent-%COMP%]{transition:all .2s ease}.category-item[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.dark[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]:hover{background-color:#374151}.icon-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border-radius:50%;background-color:#f3f4f6}.dark[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{background-color:#4b5563}.progress-bar[_ngcontent-%COMP%]{height:4px;border-radius:2px;background-color:#e5e7eb;overflow:hidden}.dark[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{background-color:#4b5563}.progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;background-color:#3b82f6;transition:width .3s ease}"]});let e=i;return e})();var HT=(e,i)=>i.id;function qT(e,i){if(e&1&&(s(0,"p",5),d(1),c()),e&2){let n=v();u(),ne(" ",n.effectiveConfig.subtitle," ")}}function XT(e,i){if(e&1&&(s(0,"div",6)(1,"mat-icon",10),d(2),c()()),e&2){let n=v();u(2),ne(" ",n.effectiveConfig.headerIcon||"schedule"," ")}}function KT(e,i){e&1&&(s(0,"div",7)(1,"div",11),re(2,"div",12),c(),s(3,"p",13),d(4,"Loading recent activity..."),c()())}function ZT(e,i){if(e&1&&(s(0,"div",7)(1,"div",14)(2,"mat-icon",15),d(3,"error"),c()(),s(4,"p",16),d(5),c()()),e&2){let n=v();u(5),L(n.effectiveConfig.error)}}function QT(e,i){if(e&1){let n=ue();s(0,"div",20),F("click",function(){let r=R(n).$implicit,a=v(3);return B(a.onTransactionClick(r))}),s(1,"div",21)(2,"mat-icon",22),d(3),c(),s(4,"div",23)(5,"span",24),d(6),c(),s(7,"div",25),d(8),c()()(),s(9,"div",26)(10,"span",27),d(11),c(),s(12,"div",28),d(13),c()()()}if(e&2){let n=i.$implicit,t=v(3);ze("cursor-pointer",t.effectiveConfig.clickable)("cursor-default",!t.effectiveConfig.clickable),u(2),P("ngClass",t.getTransactionColor(n)),u(),L(t.getTransactionIcon(n)),u(3),L(n.payee),u(2),L(n.category),u(2),P("ngClass",t.getTransactionColor(n)),u(),$t(" ",n.type==="income"?"+":"-","",t.formatCurrency(n.amount)," "),u(2),ne(" ",t.formatDate(n.date)," ")}}function JT(e,i){if(e&1&&(s(0,"div",17),Ge(1,QT,14,12,"div",19,HT),ce(3,"async"),c()),e&2){let n=v(2);u(),He(xe(3,0,n.recentTransactions$))}}function eE(e,i){if(e&1&&(s(0,"div",18)(1,"div",29)(2,"mat-icon",30),d(3,"receipt_long"),c()(),s(4,"h4",31),d(5,"No Recent Transactions"),c(),s(6,"p",32),d(7),c()()),e&2){let n=v(2);u(7),L(n.effectiveConfig.emptyStateMessage)}}function tE(e,i){if(e&1&&(s(0,"div",8),N(1,JT,4,2,"div",17),ce(2,"async"),N(3,eE,8,1,"div",18),ce(4,"async"),c()),e&2){let n,t=v();u(),we((n=xe(2,2,t.recentTransactions$))!=null&&n.length?1:-1),u(2),we(xe(4,4,t.isEmpty)?3:-1)}}function nE(e,i){e&1&&(s(0,"span",35),d(1,"Recent Activity"),c())}function iE(e,i){if(e&1&&(s(0,"div",9)(1,"div",33)(2,"span"),d(3),c(),s(4,"div",34),N(5,nE,2,0,"span",35),s(6,"span"),d(7),c()()()()),e&2){let n=v();u(3),L(n.effectiveConfig.footerText||"Last updated"),u(2),we(n.effectiveConfig.showDebugInfo?5:-1),u(2),L(n.getLastUpdatedTime())}}var Kc=(()=>{let i=class i{constructor(t){this.store=t,this.config={title:"Recent Activity",subtitle:"Latest transactions",currency:"INR",showHeaderIcon:!0,headerIcon:"schedule",headerIconColor:"orange",showFooter:!1,footerText:"Last updated",cardHeight:"medium",theme:"auto",animations:!0,clickable:!0,loading:!1,error:"",emptyStateMessage:"Your recent activity will appear here",showDebugInfo:!1,maxItems:5,period:"monthly",transactionType:"all"},this.destroy$=new Bt,this.transactions$=this.store.select(Gn),this.categories$=this.store.select(un),this.transactionsLoading$=this.store.select(la),this.categoriesLoading$=this.store.select(Nr),this.isLoading$=Or([this.transactionsLoading$,this.categoriesLoading$]).pipe(We(([r,a])=>r||a)),this.recentTransactions$=this.calculateRecentTransactions()}ngOnInit(){}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}calculateRecentTransactions(){return Or([this.transactions$,this.categories$]).pipe(We(([t,r])=>{let a=new Date,o;switch(this.effectiveConfig.period){case"daily":o=new Date(a.getFullYear(),a.getMonth(),a.getDate());break;case"weekly":let g=a.getDay(),f=g===0?6:g-1;o=new Date(a.getFullYear(),a.getMonth(),a.getDate()-f);break;case"yearly":o=new Date(a.getFullYear(),0,1);break;default:o=new Date(a.getFullYear(),a.getMonth(),1);break}return t.filter(g=>{let f=this.convertToDate(g.date),h=f>=o&&f<=a,x=this.effectiveConfig.transactionType==="all"||g.type===(this.effectiveConfig.transactionType==="income"?Lt.INCOME:Lt.EXPENSE);return h&&x}).map(g=>{let f=r.find(h=>h.id===g.categoryId);return{id:g.id||"",payee:g.payee||"Unknown",category:(f==null?void 0:f.name)||"Uncategorized",amount:g.amount,type:g.type===Lt.INCOME?"income":"expense",date:this.convertToDate(g.date),icon:(f==null?void 0:f.icon)||"receipt",color:(f==null?void 0:f.color)||"#6B7280"}}).sort((g,f)=>f.date.getTime()-g.date.getTime()).slice(0,this.effectiveConfig.maxItems||5)}))}convertToDate(t){return t instanceof Date?t:t!=null&&t.seconds?new Date(t.seconds*1e3):new Date(t)}get effectiveConfig(){var t,r,a,o,l,m,g,f,h,x,C,y,b,w,A,E,I,K,Z;return{title:(t=this.config.title)!=null?t:"Recent Activity",subtitle:(r=this.config.subtitle)!=null?r:"Latest transactions",currency:(a=this.config.currency)!=null?a:"INR",showHeaderIcon:(o=this.config.showHeaderIcon)!=null?o:!0,headerIcon:(l=this.config.headerIcon)!=null?l:"schedule",headerIconColor:(m=this.config.headerIconColor)!=null?m:"orange",showFooter:(g=this.config.showFooter)!=null?g:!1,footerText:(f=this.config.footerText)!=null?f:"Last updated",cardHeight:(h=this.config.cardHeight)!=null?h:"medium",theme:(x=this.config.theme)!=null?x:"auto",animations:(C=this.config.animations)!=null?C:!0,clickable:(y=this.config.clickable)!=null?y:!0,loading:(b=this.config.loading)!=null?b:!1,error:(w=this.config.error)!=null?w:"",emptyStateMessage:(A=this.config.emptyStateMessage)!=null?A:"Your recent activity will appear here",showDebugInfo:(E=this.config.showDebugInfo)!=null?E:!1,maxItems:(I=this.config.maxItems)!=null?I:5,period:(K=this.config.period)!=null?K:"monthly",transactionType:(Z=this.config.transactionType)!=null?Z:"all",onTransactionClick:this.config.onTransactionClick,onRefresh:this.config.onRefresh}}get cardHeightClass(){switch(this.effectiveConfig.cardHeight){case"small":return"min-h-20";case"large":return"min-h-32";case"auto":return"min-h-0";default:return"min-h-24"}}get headerIconColorClass(){let t=this.effectiveConfig.headerIconColor||"orange";return`bg-${t}-500/10 text-${t}-600 dark:text-${t}-400`}formatCurrency(t){return new Intl.NumberFormat("en-IN",{style:"currency",currency:this.effectiveConfig.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}getTransactionColor(t){return t.type==="income"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}getTransactionIcon(t){return t.icon}formatDate(t){return t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}onTransactionClick(t){this.effectiveConfig.clickable&&this.effectiveConfig.onTransactionClick&&this.effectiveConfig.onTransactionClick(t)}getLastUpdatedTime(){return new Date().toLocaleString("en-IN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}onRefreshClick(){this.effectiveConfig.onRefresh&&this.effectiveConfig.onRefresh()}get isEmpty(){return this.recentTransactions$.pipe(We(t=>t.length===0))}get hasError(){return!!(this.effectiveConfig.error&&this.effectiveConfig.error.trim())}};i.\u0275fac=function(r){return new(r||i)(Y(pt))},i.\u0275cmp=Re({type:i,selectors:[["app-recent-activity-card"]],inputs:{config:"config"},standalone:!0,features:[ia],decls:14,vars:11,consts:[[1,"recent-activity-card","bg-white","dark:bg-gray-800","shadow-lg","border-0","rounded-xl","overflow-hidden","h-full"],[1,"p-4","sm:p-6"],[1,"flex","items-center","justify-between","mb-4","sm:mb-6"],[1,"flex-1","min-w-0"],[1,"text-lg","sm:text-xl","font-semibold","text-gray-900","dark:text-white","truncate"],[1,"text-sm","text-gray-600","dark:text-gray-400","mt-1"],[1,"bg-orange-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-center","py-8"],[1,"space-y-4"],[1,"mt-4","sm:mt-6","pt-4","border-t","border-gray-200","dark:border-gray-700"],[1,"text-orange-600","dark:text-orange-400"],[1,"inline-flex","items-center","justify-center","w-12","h-12","bg-blue-100","dark:bg-blue-900/20","rounded-full","mb-4"],[1,"animate-spin","rounded-full","h-6","w-6","border-b-2","border-blue-600"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"bg-red-100","dark:bg-red-900/20","w-12","h-12","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-red-600","dark:text-red-400"],[1,"text-sm","text-red-600","dark:text-red-400"],[1,"space-y-3"],[1,"text-center","py-8","sm:py-12"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg","hover:bg-gray-100","dark:hover:bg-gray-600","transition-colors",3,"cursor-pointer","cursor-default"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg","hover:bg-gray-100","dark:hover:bg-gray-600","transition-colors",3,"click"],[1,"flex","items-center","space-x-3","min-w-0","flex-1"],[1,"flex-shrink-0",3,"ngClass"],[1,"min-w-0","flex-1"],[1,"text-gray-700","dark:text-gray-300","font-medium","truncate","block"],[1,"text-xs","text-gray-500","dark:text-gray-400","truncate"],[1,"text-right","ml-3","flex-shrink-0"],[1,"font-semibold","block",3,"ngClass"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"bg-gray-100","dark:bg-gray-700","w-16","h-16","sm:w-20","sm:h-20","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-gray-400","text-2xl","sm:text-3xl"],[1,"text-base","sm:text-lg","font-medium","text-gray-900","dark:text-white","mb-2"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","justify-between","text-xs","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","gap-4"],[1,"text-xs","opacity-75"]],template:function(r,a){r&1&&(s(0,"mat-card",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),d(5),c(),N(6,qT,2,1,"p",5),c(),N(7,XT,3,1,"div",6),c(),N(8,KT,5,0,"div",7),ce(9,"async"),N(10,ZT,6,1,"div",7)(11,tE,5,6,"div",8),ce(12,"async"),N(13,iE,8,3,"div",9),c()()),r&2&&(u(5),ne(" ",a.effectiveConfig.title," "),u(),we(a.effectiveConfig.subtitle?6:-1),u(),we(a.effectiveConfig.showHeaderIcon!==!1?7:-1),u(),we(xe(9,7,a.isLoading$)?8:-1),u(2),we(a.hasError?10:-1),u(),we(!xe(12,9,a.isLoading$)&&!a.hasError?11:-1),u(2),we(a.effectiveConfig.showFooter?13:-1))},dependencies:[La,$n,Vi,Qo,ji,Ua,Qe],styles:[".recent-activity-card[_ngcontent-%COMP%]{transition:all .3s ease}.recent-activity-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000001a}.recent-activity-card[_ngcontent-%COMP%]   .mat-card[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden}.recent-activity-card[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]{transition:all .2s ease}.recent-activity-card[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]:hover{transform:translate(4px)}.recent-activity-card[_ngcontent-%COMP%]   .transactions-list[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.recent-activity-card[_ngcontent-%COMP%]   .transactions-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.recent-activity-card[_ngcontent-%COMP%]   .transactions-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.recent-activity-card[_ngcontent-%COMP%]   .transactions-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#9ca3af80;border-radius:2px}.recent-activity-card[_ngcontent-%COMP%]   .transactions-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3afcc}@media (max-width: 640px){.recent-activity-card[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]{padding:.75rem}.recent-activity-card[_ngcontent-%COMP%]   .transaction-icon[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem}}.dark[_ngcontent-%COMP%]   .recent-activity-card[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]:hover{background-color:#4b5563cc}"]});let e=i;return e})();var rE=(e,i)=>i.month;function aE(e,i){if(e&1&&(s(0,"p",5),d(1),c()),e&2){let n=v();u(),ne(" ",n.effectiveConfig.subtitle," ")}}function oE(e,i){if(e&1&&(s(0,"div",6)(1,"mat-icon",10),d(2),c()()),e&2){let n=v();u(2),ne(" ",n.effectiveConfig.headerIcon||"trending_up"," ")}}function sE(e,i){e&1&&(s(0,"div",7)(1,"div",11),re(2,"div",12),c(),s(3,"p",13),d(4,"Loading monthly trends..."),c()())}function cE(e,i){if(e&1&&(s(0,"div",7)(1,"div",14)(2,"mat-icon",15),d(3,"error"),c()(),s(4,"p",16),d(5),c()()),e&2){let n=v();u(5),L(n.effectiveConfig.error)}}function lE(e,i){if(e&1&&(s(0,"div",22),d(1),c()),e&2){let n=v().$implicit,t=v(3);u(),L(t.formatCurrency(n.income))}}function dE(e,i){if(e&1&&(s(0,"div",23),d(1),c()),e&2){let n=v().$implicit,t=v(3);u(),L(t.formatCurrency(n.expenses))}}function mE(e,i){if(e&1&&(s(0,"div",24),d(1),c()),e&2){let n=v().$implicit,t=v(3);P("ngClass",t.getChangeColor(n.savings)),u(),$t(" ",n.savings>=0?"+":"","",t.formatCurrency(n.savings)," ")}}function gE(e,i){if(e&1&&(s(0,"div",25)(1,"mat-icon",26),d(2),c(),s(3,"span",27),d(4),c()()),e&2){let n=v().$implicit,t=v(3);u(),P("ngClass",t.getChangeColor(n.change)),u(),L(t.getChangeIcon(n.change)),u(),P("ngClass",t.getChangeColor(n.change)),u(),$t(" ",n.change>=0?"+":"","",t.formatCurrency(n.change)," ")}}function uE(e,i){if(e&1){let n=ue();s(0,"div",20),F("click",function(){let r=R(n).$implicit,a=v(3);return B(a.onMonthClick(r))}),s(1,"div",21),d(2),c(),N(3,lE,2,1,"div",22)(4,dE,2,1,"div",23)(5,mE,2,3,"div",24)(6,gE,5,5,"div",25),c()}if(e&2){let n=i.$implicit,t=v(3);ze("cursor-pointer",t.effectiveConfig.clickable)("cursor-default",!t.effectiveConfig.clickable),u(2),L(n.month),u(),we(t.effectiveConfig.showIncome?3:-1),u(),we(t.effectiveConfig.showExpenses?4:-1),u(),we(t.effectiveConfig.showSavings?5:-1),u(),we(t.effectiveConfig.showChange&&n.change!==void 0?6:-1)}}function pE(e,i){if(e&1&&(s(0,"div",17),Ge(1,uE,7,9,"div",19,rE),ce(3,"async"),c()),e&2){let n=v(2);P("ngClass",n.layoutClass),u(),He(xe(3,1,n.monthlyTrends$))}}function fE(e,i){if(e&1&&(s(0,"div",18)(1,"div",28)(2,"mat-icon",29),d(3,"trending_up"),c()(),s(4,"h4",30),d(5,"No Monthly Data"),c(),s(6,"p",31),d(7),c()()),e&2){let n=v(2);u(7),L(n.effectiveConfig.emptyStateMessage)}}function hE(e,i){if(e&1&&(s(0,"div",8),N(1,pE,4,3,"div",17),ce(2,"async"),N(3,fE,8,1,"div",18),ce(4,"async"),c()),e&2){let n,t=v();u(),we((n=xe(2,2,t.monthlyTrends$))!=null&&n.length?1:-1),u(2),we(xe(4,4,t.isEmpty)?3:-1)}}function _E(e,i){e&1&&(s(0,"span",34),d(1,"Monthly Trends"),c())}function xE(e,i){if(e&1&&(s(0,"div",9)(1,"div",32)(2,"span"),d(3),c(),s(4,"div",33),N(5,_E,2,0,"span",34),s(6,"span"),d(7),c()()()()),e&2){let n=v();u(3),L(n.effectiveConfig.footerText||"Last updated"),u(2),we(n.effectiveConfig.showDebugInfo?5:-1),u(2),L(n.getLastUpdatedTime())}}var Zc=(()=>{let i=class i{constructor(t){this.store=t,this.config={title:"Monthly Trends",subtitle:"Compare monthly performance",currency:"INR",showHeaderIcon:!0,headerIcon:"trending_up",headerIconColor:"green",showFooter:!1,footerText:"Last updated",cardHeight:"medium",theme:"auto",animations:!0,clickable:!0,loading:!1,error:"",emptyStateMessage:"Add transactions to see monthly trends",showDebugInfo:!1,maxItems:6,period:"monthly",transactionType:"all",showIncome:!0,showExpenses:!0,showSavings:!0,showChange:!0,layout:"grid"},this.destroy$=new Bt,this.transactions$=this.store.select(Gn),this.categories$=this.store.select(un),this.transactionsLoading$=this.store.select(la),this.categoriesLoading$=this.store.select(Nr),this.isLoading$=Or([this.transactionsLoading$,this.categoriesLoading$]).pipe(We(([r,a])=>r||a)),this.monthlyTrends$=this.calculateMonthlyTrends()}ngOnInit(){}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}calculateMonthlyTrends(){return this.transactions$.pipe(We(t=>{let r=new Date,a=new Map;t.forEach(l=>{let m=this.convertToDate(l.date),g=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}`,f=m.toLocaleDateString("en-US",{month:"short",year:"numeric"});a.has(g)||a.set(g,{income:0,expenses:0,savings:0});let h=a.get(g);l.type===Lt.INCOME?h.income+=l.amount:h.expenses+=l.amount,h.savings=h.income-h.expenses});let o=Array.from(a.entries()).map(([l,m])=>{let[g,f]=l.split("-");return{month:new Date(parseInt(g),parseInt(f)-1).toLocaleDateString("en-US",{month:"short",year:"numeric"}),income:m.income,expenses:m.expenses,savings:m.savings}}).sort((l,m)=>{let g=new Date(l.month);return new Date(m.month).getTime()-g.getTime()}).slice(0,this.effectiveConfig.maxItems||6);if(o.length>1)for(let l=0;l<o.length-1;l++){let m=o[l],g=o[l+1],f=m.savings-g.savings,h=g.savings!==0?f/Math.abs(g.savings)*100:0;m.change=f,m.changePercentage=h}return o}))}convertToDate(t){return t instanceof Date?t:t!=null&&t.seconds?new Date(t.seconds*1e3):new Date(t)}get effectiveConfig(){var t,r,a,o,l,m,g,f,h,x,C,y,b,w,A,E,I,K,Z,k,S,V,W,Q;return{title:(t=this.config.title)!=null?t:"Monthly Trends",subtitle:(r=this.config.subtitle)!=null?r:"Compare monthly performance",currency:(a=this.config.currency)!=null?a:"INR",showHeaderIcon:(o=this.config.showHeaderIcon)!=null?o:!0,headerIcon:(l=this.config.headerIcon)!=null?l:"trending_up",headerIconColor:(m=this.config.headerIconColor)!=null?m:"green",showFooter:(g=this.config.showFooter)!=null?g:!1,footerText:(f=this.config.footerText)!=null?f:"Last updated",cardHeight:(h=this.config.cardHeight)!=null?h:"medium",theme:(x=this.config.theme)!=null?x:"auto",animations:(C=this.config.animations)!=null?C:!0,clickable:(y=this.config.clickable)!=null?y:!0,loading:(b=this.config.loading)!=null?b:!1,error:(w=this.config.error)!=null?w:"",emptyStateMessage:(A=this.config.emptyStateMessage)!=null?A:"Add transactions to see monthly trends",showDebugInfo:(E=this.config.showDebugInfo)!=null?E:!1,maxItems:(I=this.config.maxItems)!=null?I:6,period:(K=this.config.period)!=null?K:"monthly",transactionType:(Z=this.config.transactionType)!=null?Z:"all",showIncome:(k=this.config.showIncome)!=null?k:!0,showExpenses:(S=this.config.showExpenses)!=null?S:!0,showSavings:(V=this.config.showSavings)!=null?V:!0,showChange:(W=this.config.showChange)!=null?W:!0,layout:(Q=this.config.layout)!=null?Q:"grid",onMonthClick:this.config.onMonthClick,onRefresh:this.config.onRefresh}}get cardHeightClass(){switch(this.effectiveConfig.cardHeight){case"small":return"min-h-20";case"large":return"min-h-32";case"auto":return"min-h-0";default:return"min-h-24"}}get headerIconColorClass(){let t=this.effectiveConfig.headerIconColor||"green";return`bg-${t}-500/10 text-${t}-600 dark:text-${t}-400`}get layoutClass(){switch(this.effectiveConfig.layout){case"list":return"grid-cols-1";case"compact":return"grid-cols-3 sm:grid-cols-4 md:grid-cols-6";default:return"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6"}}formatCurrency(t){return new Intl.NumberFormat("en-IN",{style:"currency",currency:this.effectiveConfig.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}getChangeColor(t){return t>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}getChangeIcon(t){return t>=0?"trending_up":"trending_down"}onMonthClick(t){this.effectiveConfig.clickable&&this.effectiveConfig.onMonthClick&&this.effectiveConfig.onMonthClick(t)}getLastUpdatedTime(){return new Date().toLocaleString("en-IN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}onRefreshClick(){this.effectiveConfig.onRefresh&&this.effectiveConfig.onRefresh()}get isEmpty(){return this.monthlyTrends$.pipe(We(t=>t.length===0))}get hasError(){return!!(this.effectiveConfig.error&&this.effectiveConfig.error.trim())}};i.\u0275fac=function(r){return new(r||i)(Y(pt))},i.\u0275cmp=Re({type:i,selectors:[["app-monthly-trends-card"]],inputs:{config:"config"},standalone:!0,features:[ia],decls:14,vars:11,consts:[[1,"monthly-trends-card","bg-white","dark:bg-gray-800","shadow-lg","border-0","rounded-xl","overflow-hidden","h-full"],[1,"p-4","sm:p-6"],[1,"flex","items-center","justify-between","mb-4","sm:mb-6"],[1,"flex-1","min-w-0"],[1,"text-lg","sm:text-xl","font-semibold","text-gray-900","dark:text-white","truncate"],[1,"text-sm","text-gray-600","dark:text-gray-400","mt-1"],[1,"bg-green-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-center","py-8"],[1,"space-y-4"],[1,"mt-4","sm:mt-6","pt-4","border-t","border-gray-200","dark:border-gray-700"],[1,"text-green-600","dark:text-green-400"],[1,"inline-flex","items-center","justify-center","w-12","h-12","bg-blue-100","dark:bg-blue-900/20","rounded-full","mb-4"],[1,"animate-spin","rounded-full","h-6","w-6","border-b-2","border-blue-600"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"bg-red-100","dark:bg-red-900/20","w-12","h-12","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-red-600","dark:text-red-400"],[1,"text-sm","text-red-600","dark:text-red-400"],[1,"grid","gap-3","sm:gap-4",3,"ngClass"],[1,"text-center","py-8","sm:py-12"],[1,"text-center","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg","hover:bg-gray-100","dark:hover:bg-gray-600","transition-colors",3,"cursor-pointer","cursor-default"],[1,"text-center","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg","hover:bg-gray-100","dark:hover:bg-gray-600","transition-colors",3,"click"],[1,"text-xs","sm:text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2","truncate"],[1,"text-sm","sm:text-lg","font-bold","text-green-600","dark:text-green-400","truncate"],[1,"text-xs","sm:text-sm","text-red-600","dark:text-red-400","truncate"],[1,"text-xs","text-gray-500","dark:text-gray-400","mt-1","truncate",3,"ngClass"],[1,"flex","items-center","justify-center","mt-1"],[1,"text-xs",3,"ngClass"],[1,"text-xs","ml-1",3,"ngClass"],[1,"bg-gray-100","dark:bg-gray-700","w-16","h-16","sm:w-20","sm:h-20","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-gray-400","text-2xl","sm:text-3xl"],[1,"text-base","sm:text-lg","font-medium","text-gray-900","dark:text-white","mb-2"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","justify-between","text-xs","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","gap-4"],[1,"text-xs","opacity-75"]],template:function(r,a){r&1&&(s(0,"mat-card",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),d(5),c(),N(6,aE,2,1,"p",5),c(),N(7,oE,3,1,"div",6),c(),N(8,sE,5,0,"div",7),ce(9,"async"),N(10,cE,6,1,"div",7)(11,hE,5,6,"div",8),ce(12,"async"),N(13,xE,8,3,"div",9),c()()),r&2&&(u(5),ne(" ",a.effectiveConfig.title," "),u(),we(a.effectiveConfig.subtitle?6:-1),u(),we(a.effectiveConfig.showHeaderIcon!==!1?7:-1),u(),we(xe(9,7,a.isLoading$)?8:-1),u(2),we(a.hasError?10:-1),u(),we(!xe(12,9,a.isLoading$)&&!a.hasError?11:-1),u(2),we(a.effectiveConfig.showFooter?13:-1))},dependencies:[La,$n,Vi,Qo,ji,Ua,Qe],styles:['.monthly-trends-card[_ngcontent-%COMP%]{transition:all .3s ease}.monthly-trends-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000001a}.monthly-trends-card[_ngcontent-%COMP%]   .mat-card[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden}.monthly-trends-card[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]{transition:all .2s ease}.monthly-trends-card[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.monthly-trends-card[_ngcontent-%COMP%]   .grid.grid-cols-1[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]{padding:1rem}.monthly-trends-card[_ngcontent-%COMP%]   .grid.grid-cols-2[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]{padding:.75rem}.monthly-trends-card[_ngcontent-%COMP%]   .grid.grid-cols-3[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%], .monthly-trends-card[_ngcontent-%COMP%]   .grid.grid-cols-4[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%], .monthly-trends-card[_ngcontent-%COMP%]   .grid.grid-cols-6[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]{padding:.5rem}@media (max-width: 640px){.monthly-trends-card[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]{padding:.75rem}.monthly-trends-card[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{gap:.5rem}}.dark[_ngcontent-%COMP%]   .monthly-trends-card[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]:hover{background-color:#4b5563cc;box-shadow:0 4px 12px #0000004d}.monthly-trends-card[_ngcontent-%COMP%]   .trend-indicator[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.25rem}.monthly-trends-card[_ngcontent-%COMP%]   .trend-indicator.positive[_ngcontent-%COMP%]{color:#10b981}.monthly-trends-card[_ngcontent-%COMP%]   .trend-indicator.negative[_ngcontent-%COMP%]{color:#ef4444}.monthly-trends-card[_ngcontent-%COMP%]   .currency-value[_ngcontent-%COMP%]{font-variant-numeric:tabular-nums;font-feature-settings:"tnum"}']});let e=i;return e})();var CE=(e,i)=>i.category;function vE(e,i){if(e&1&&(s(0,"p",5),d(1),c()),e&2){let n=v();u(),ne(" ",n.effectiveConfig.subtitle," ")}}function bE(e,i){if(e&1&&(s(0,"div",6)(1,"mat-icon",10),d(2),c()()),e&2){let n=v();u(2),ne(" ",n.effectiveConfig.headerIcon||"category"," ")}}function yE(e,i){e&1&&(s(0,"div",7)(1,"div",11),re(2,"div",12),c(),s(3,"p",13),d(4,"Loading category data..."),c()())}function ME(e,i){if(e&1&&(s(0,"div",7)(1,"div",14)(2,"mat-icon",15),d(3,"error"),c()(),s(4,"p",16),d(5),c()()),e&2){let n=v();u(5),L(n.effectiveConfig.error)}}function PE(e,i){if(e&1&&(s(0,"div",26),d(1),c()),e&2){let n=v().$implicit;u(),ne("",n.percentage.toFixed(1),"% of total")}}function OE(e,i){if(e&1&&(s(0,"div",26),d(1),c()),e&2){let n=v().$implicit;u(),ne("",n.count," transactions")}}function wE(e,i){if(e&1&&(s(0,"div",26),d(1),c()),e&2){let n=v().$implicit,t=v(3);u(),ne("Avg: ",t.formatCurrency(n.averageAmount),"")}}function SE(e,i){if(e&1&&(s(0,"div",28),re(1,"div",30),c()),e&2){let n=v().$implicit,t=v(3);u(),wt("width",n.percentage,"%"),P("ngClass",t.getProgressBarColor(n.percentage))}}function kE(e,i){if(e&1){let n=ue();s(0,"div",20),F("click",function(){let r=R(n).$implicit,a=v(3);return B(a.onCategoryClick(r))}),s(1,"div",21)(2,"div",22)(3,"mat-icon",23),d(4),c()(),s(5,"div",24)(6,"span",25),d(7),c(),N(8,PE,2,1,"div",26)(9,OE,2,1,"div",26)(10,wE,2,1,"div",26),c()(),s(11,"div",27),N(12,SE,2,3,"div",28),s(13,"span",29),d(14),c()()()}if(e&2){let n=i.$implicit,t=v(3);ze("cursor-pointer",t.effectiveConfig.clickable)("cursor-default",!t.effectiveConfig.clickable),u(3),wt("color",n.color),u(),L(n.icon),u(3),L(n.category),u(),we(t.effectiveConfig.showPercentage?8:-1),u(),we(t.effectiveConfig.showCount?9:-1),u(),we(t.effectiveConfig.showAverage?10:-1),u(2),we(t.effectiveConfig.showProgressBar?12:-1),u(2),ne(" ",t.formatCurrency(n.amount)," ")}}function TE(e,i){if(e&1&&(s(0,"div",17),Ge(1,kE,15,13,"div",19,CE),ce(3,"async"),c()),e&2){let n=v(2);u(),He(xe(3,0,n.categoryBreakdown$))}}function EE(e,i){if(e&1&&(s(0,"div",18)(1,"div",31)(2,"mat-icon",32),d(3,"category"),c()(),s(4,"h4",33),d(5,"No Categories Found"),c(),s(6,"p",34),d(7),c()()),e&2){let n=v(2);u(7),L(n.effectiveConfig.emptyStateMessage)}}function IE(e,i){if(e&1&&(s(0,"div",8),N(1,TE,4,2,"div",17),ce(2,"async"),N(3,EE,8,1,"div",18),ce(4,"async"),c()),e&2){let n,t=v();u(),we((n=xe(2,2,t.categoryBreakdown$))!=null&&n.length?1:-1),u(2),we(xe(4,4,t.isEmpty)?3:-1)}}function AE(e,i){e&1&&(s(0,"span",37),d(1,"Category Breakdown"),c())}function DE(e,i){if(e&1&&(s(0,"div",9)(1,"div",35)(2,"span"),d(3),c(),s(4,"div",36),N(5,AE,2,0,"span",37),s(6,"span"),d(7),c()()()()),e&2){let n=v();u(3),L(n.effectiveConfig.footerText||"Last updated"),u(2),we(n.effectiveConfig.showDebugInfo?5:-1),u(2),L(n.getLastUpdatedTime())}}var Qc=(()=>{let i=class i{constructor(t){this.store=t,this.config={title:"Category Breakdown",subtitle:"Spending by category",currency:"INR",showHeaderIcon:!0,headerIcon:"category",headerIconColor:"blue",showFooter:!1,footerText:"Last updated",cardHeight:"medium",theme:"auto",animations:!0,clickable:!0,loading:!1,error:"",emptyStateMessage:"Add transactions to see category breakdown",showDebugInfo:!1,maxItems:8,period:"monthly",transactionType:"expense",showProgressBar:!0,showPercentage:!0,showCount:!1,showAverage:!1,layout:"list"},this.destroy$=new Bt,this.transactions$=this.store.select(Gn),this.categories$=this.store.select(un),this.transactionsLoading$=this.store.select(la),this.categoriesLoading$=this.store.select(Nr),this.isLoading$=Or([this.transactionsLoading$,this.categoriesLoading$]).pipe(We(([r,a])=>r||a)),this.categoryBreakdown$=this.calculateCategoryBreakdown()}ngOnInit(){}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}calculateCategoryBreakdown(){return Or([this.transactions$,this.categories$]).pipe(We(([t,r])=>{let a=new Date,o;switch(this.effectiveConfig.period){case"daily":o=new Date(a.getFullYear(),a.getMonth(),a.getDate());break;case"weekly":let h=a.getDay(),x=h===0?6:h-1;o=new Date(a.getFullYear(),a.getMonth(),a.getDate()-x);break;case"yearly":o=new Date(a.getFullYear(),0,1);break;default:o=new Date(a.getFullYear(),a.getMonth(),1);break}let l=t.filter(h=>{let x=this.convertToDate(h.date),C=x>=o&&x<=a,y=this.effectiveConfig.transactionType==="all"||h.type===(this.effectiveConfig.transactionType==="income"?Lt.INCOME:Lt.EXPENSE);return C&&y}),m=new Map;l.forEach(h=>{let x=r.find(C=>C.id===h.categoryId);if(x){let C=m.get(h.categoryId)||{amount:0,count:0,category:x};C.amount+=h.amount,C.count+=1,m.set(h.categoryId,C)}});let g=Array.from(m.values()).reduce((h,x)=>h+x.amount,0);return Array.from(m.values()).filter(h=>h.amount>0).map(h=>({category:h.category.name,amount:h.amount,percentage:g>0?h.amount/g*100:0,icon:h.category.icon||"category",color:h.category.color||"#6B7280",count:h.count,averageAmount:h.count>0?h.amount/h.count:0})).sort((h,x)=>x.amount-h.amount).slice(0,this.effectiveConfig.maxItems||8)}))}convertToDate(t){return t instanceof Date?t:t!=null&&t.seconds?new Date(t.seconds*1e3):new Date(t)}get effectiveConfig(){var t,r,a,o,l,m,g,f,h,x,C,y,b,w,A,E,I,K,Z,k,S,V,W,Q;return{title:(t=this.config.title)!=null?t:"Category Breakdown",subtitle:(r=this.config.subtitle)!=null?r:"Spending by category",currency:(a=this.config.currency)!=null?a:"INR",showHeaderIcon:(o=this.config.showHeaderIcon)!=null?o:!0,headerIcon:(l=this.config.headerIcon)!=null?l:"category",headerIconColor:(m=this.config.headerIconColor)!=null?m:"blue",showFooter:(g=this.config.showFooter)!=null?g:!1,footerText:(f=this.config.footerText)!=null?f:"Last updated",cardHeight:(h=this.config.cardHeight)!=null?h:"medium",theme:(x=this.config.theme)!=null?x:"auto",animations:(C=this.config.animations)!=null?C:!0,clickable:(y=this.config.clickable)!=null?y:!0,loading:(b=this.config.loading)!=null?b:!1,error:(w=this.config.error)!=null?w:"",emptyStateMessage:(A=this.config.emptyStateMessage)!=null?A:"Add transactions to see category breakdown",showDebugInfo:(E=this.config.showDebugInfo)!=null?E:!1,maxItems:(I=this.config.maxItems)!=null?I:8,period:(K=this.config.period)!=null?K:"monthly",transactionType:(Z=this.config.transactionType)!=null?Z:"expense",showProgressBar:(k=this.config.showProgressBar)!=null?k:!0,showPercentage:(S=this.config.showPercentage)!=null?S:!0,showCount:(V=this.config.showCount)!=null?V:!1,showAverage:(W=this.config.showAverage)!=null?W:!1,layout:(Q=this.config.layout)!=null?Q:"list",onCategoryClick:this.config.onCategoryClick,onRefresh:this.config.onRefresh}}get cardHeightClass(){switch(this.effectiveConfig.cardHeight){case"small":return"min-h-20";case"large":return"min-h-32";case"auto":return"min-h-0";default:return"min-h-24"}}get headerIconColorClass(){let t=this.effectiveConfig.headerIconColor||"blue";return`bg-${t}-500/10 text-${t}-600 dark:text-${t}-400`}formatCurrency(t){return new Intl.NumberFormat("en-IN",{style:"currency",currency:this.effectiveConfig.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}getProgressBarColor(t){return t>50?"bg-red-500":t>25?"bg-yellow-500":"bg-blue-500"}onCategoryClick(t){this.effectiveConfig.clickable&&this.effectiveConfig.onCategoryClick&&this.effectiveConfig.onCategoryClick(t)}getLastUpdatedTime(){return new Date().toLocaleString("en-IN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}onRefreshClick(){this.effectiveConfig.onRefresh&&this.effectiveConfig.onRefresh()}get isEmpty(){return this.categoryBreakdown$.pipe(We(t=>t.length===0))}get hasError(){return!!(this.effectiveConfig.error&&this.effectiveConfig.error.trim())}};i.\u0275fac=function(r){return new(r||i)(Y(pt))},i.\u0275cmp=Re({type:i,selectors:[["app-category-breakdown-card"]],inputs:{config:"config"},standalone:!0,features:[ia],decls:14,vars:11,consts:[[1,"category-breakdown-card","bg-white","dark:bg-gray-800","shadow-lg","border-0","rounded-xl","overflow-hidden","h-full"],[1,"p-4","sm:p-6"],[1,"flex","items-center","justify-between","mb-4","sm:mb-6"],[1,"flex-1","min-w-0"],[1,"text-lg","sm:text-xl","font-semibold","text-gray-900","dark:text-white","truncate"],[1,"text-sm","text-gray-600","dark:text-gray-400","mt-1"],[1,"bg-blue-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-center","py-8"],[1,"space-y-4"],[1,"mt-4","sm:mt-6","pt-4","border-t","border-gray-200","dark:border-gray-700"],[1,"text-blue-600","dark:text-blue-400"],[1,"inline-flex","items-center","justify-center","w-12","h-12","bg-blue-100","dark:bg-blue-900/20","rounded-full","mb-4"],[1,"animate-spin","rounded-full","h-6","w-6","border-b-2","border-blue-600"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"bg-red-100","dark:bg-red-900/20","w-12","h-12","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-red-600","dark:text-red-400"],[1,"text-sm","text-red-600","dark:text-red-400"],[1,"space-y-3"],[1,"text-center","py-8","sm:py-12"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg","hover:bg-gray-100","dark:hover:bg-gray-600","transition-colors",3,"cursor-pointer","cursor-default"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg","hover:bg-gray-100","dark:hover:bg-gray-600","transition-colors",3,"click"],[1,"flex","items-center","space-x-3","min-w-0","flex-1"],[1,"w-8","h-8","rounded-full","flex","items-center","justify-center","flex-shrink-0","bg-gray-100","dark:bg-gray-600"],[1,"text-sm"],[1,"min-w-0","flex-1"],[1,"text-gray-700","dark:text-gray-300","font-medium","truncate","block"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","space-x-3","sm:space-x-4","ml-3"],[1,"w-20","sm:w-32","bg-gray-200","dark:bg-gray-600","rounded-full","h-2","flex-shrink-0"],[1,"text-sm","font-medium","text-gray-900","dark:text-white","w-16","sm:w-20","text-right","truncate"],[1,"h-2","rounded-full","transition-all","duration-300",3,"ngClass"],[1,"bg-gray-100","dark:bg-gray-700","w-16","h-16","sm:w-20","sm:h-20","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-gray-400","text-2xl","sm:text-3xl"],[1,"text-base","sm:text-lg","font-medium","text-gray-900","dark:text-white","mb-2"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","justify-between","text-xs","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","gap-4"],[1,"text-xs","opacity-75"]],template:function(r,a){r&1&&(s(0,"mat-card",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),d(5),c(),N(6,vE,2,1,"p",5),c(),N(7,bE,3,1,"div",6),c(),N(8,yE,5,0,"div",7),ce(9,"async"),N(10,ME,6,1,"div",7)(11,IE,5,6,"div",8),ce(12,"async"),N(13,DE,8,3,"div",9),c()()),r&2&&(u(5),ne(" ",a.effectiveConfig.title," "),u(),we(a.effectiveConfig.subtitle?6:-1),u(),we(a.effectiveConfig.showHeaderIcon!==!1?7:-1),u(),we(xe(9,7,a.isLoading$)?8:-1),u(2),we(a.hasError?10:-1),u(),we(!xe(12,9,a.isLoading$)&&!a.hasError?11:-1),u(2),we(a.effectiveConfig.showFooter?13:-1))},dependencies:[La,$n,Vi,Qo,ji,Ua,Qe],styles:['.category-breakdown-card[_ngcontent-%COMP%]{transition:all .3s ease}.category-breakdown-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000001a}.category-breakdown-card[_ngcontent-%COMP%]   .mat-card[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden}.category-breakdown-card[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]{transition:all .2s ease}.category-breakdown-card[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]:hover{transform:translate(4px)}.category-breakdown-card[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{transition:width .6s ease-in-out}.category-breakdown-card[_ngcontent-%COMP%]   .progress-bar.bg-red-500[_ngcontent-%COMP%]{background:linear-gradient(90deg,#ef4444,#dc2626)}.category-breakdown-card[_ngcontent-%COMP%]   .progress-bar.bg-yellow-500[_ngcontent-%COMP%]{background:linear-gradient(90deg,#eab308,#ca8a04)}.category-breakdown-card[_ngcontent-%COMP%]   .progress-bar.bg-blue-500[_ngcontent-%COMP%]{background:linear-gradient(90deg,#3b82f6,#2563eb)}.category-breakdown-card[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{transition:all .2s ease}.category-breakdown-card[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]:hover{transform:scale(1.1)}@media (max-width: 640px){.category-breakdown-card[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]{padding:.75rem}.category-breakdown-card[_ngcontent-%COMP%]   .progress-bar-container[_ngcontent-%COMP%]{width:4rem}}.dark[_ngcontent-%COMP%]   .category-breakdown-card[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]:hover{background-color:#4b5563cc}.dark[_ngcontent-%COMP%]   .category-breakdown-card[_ngcontent-%COMP%]   .progress-bar.bg-red-500[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f87171,#ef4444)}.dark[_ngcontent-%COMP%]   .category-breakdown-card[_ngcontent-%COMP%]   .progress-bar.bg-yellow-500[_ngcontent-%COMP%]{background:linear-gradient(90deg,#fbbf24,#f59e0b)}.dark[_ngcontent-%COMP%]   .category-breakdown-card[_ngcontent-%COMP%]   .progress-bar.bg-blue-500[_ngcontent-%COMP%]{background:linear-gradient(90deg,#60a5fa,#3b82f6)}.category-breakdown-card[_ngcontent-%COMP%]   .percentage-display[_ngcontent-%COMP%]{font-variant-numeric:tabular-nums;font-feature-settings:"tnum"}.category-breakdown-card[_ngcontent-%COMP%]   .amount-display[_ngcontent-%COMP%]{font-variant-numeric:tabular-nums;font-feature-settings:"tnum";font-weight:600}']});let e=i;return e})();var pn=Yr(Xr());var Ur=Yr(Xr());var Qa=(()=>{let i=class i{constructor(){this.selectedDateSubject=new on(null),this.selectedDateRangeSubject=new on(null),this.selectedYearSubject=new on(null),this.categoryFilterSubject=new on(null),this.searchTermSubject=new on(""),this.selectedCategorySubject=new on(["all"]),this.selectedTypeSubject=new on("all"),this.accountFilterSubject=new on([]),this.amountRangeSubject=new on({min:null,max:null}),this.statusFilterSubject=new on([]),this.tagsSubject=new on([]),this.filterStateSubject=new on(this.getDefaultFilterState()),this.filterHistorySubject=new on([]),this.filterPresetsSubject=new on([]),this.activePresetSubject=new on(null),this.selectedDate$=this.selectedDateSubject.asObservable(),this.selectedDateRange$=this.selectedDateRangeSubject.asObservable(),this.selectedYear$=this.selectedYearSubject.asObservable(),this.categoryFilter$=this.categoryFilterSubject.asObservable(),this.searchTerm$=this.searchTermSubject.asObservable(),this.selectedCategory$=this.selectedCategorySubject.asObservable(),this.selectedType$=this.selectedTypeSubject.asObservable(),this.accountFilter$=this.accountFilterSubject.asObservable(),this.amountRange$=this.amountRangeSubject.asObservable(),this.statusFilter$=this.statusFilterSubject.asObservable(),this.tags$=this.tagsSubject.asObservable(),this.filterState$=this.filterStateSubject.asObservable(),this.filterHistory$=this.filterHistorySubject.asObservable(),this.filterPresets$=this.filterPresetsSubject.asObservable(),this.activePreset$=this.activePresetSubject.asObservable(),this.hasActiveFilters$=this.filterState$.pipe(We(t=>this.hasActiveFilters(t)),cc()),this.activeFiltersCount$=this.filterState$.pipe(We(t=>this.getActiveFiltersCount(t)),cc()),this.initializePresets(),this.setupFilterStateUpdates()}setSelectedDate(t){this.selectedDateSubject.next(t),this.selectedDateRangeSubject.next(null)}getSelectedDate(){return this.selectedDateSubject.value}setSelectedDateRange(t,r){if(!t||!r){console.warn("Invalid date range provided");return}this.selectedDateRangeSubject.next({startDate:t,endDate:r}),this.selectedDateSubject.next(null);let a=(0,Ur.default)(t),o=(0,Ur.default)(r),l=a.year(),m=o.year();l===m&&a.isSame(a.clone().startOf("month"))&&o.isSame(o.clone().endOf("month"))||this.selectedYearSubject.next(null)}getSelectedDateRange(){return this.selectedDateRangeSubject.value}setSelectedYear(t,r){if(!t||!r||t>r){console.warn("Invalid year range provided");return}this.selectedYearSubject.next({startYear:t,endYear:r}),this.selectedDateSubject.next(null);let a=this.selectedDateRangeSubject.value;if(a){let o=(0,Ur.default)(a.startDate),l=(0,Ur.default)(a.endDate),m=o.year(),g=l.year();if(m===g&&m===t&&o.isSame(o.clone().startOf("month"))&&l.isSame(l.clone().endOf("month")))return}this.selectedDateRangeSubject.next(null)}getSelectedYear(){return this.selectedYearSubject.value}setCategoryFilter(t,r,a,o){if(!t||r===void 0||a===void 0||!o){console.warn("Invalid category filter parameters provided");return}let l={categoryId:t,year:r,month:a,monthName:o};this.categoryFilterSubject.next(l)}getCategoryFilter(){return this.categoryFilterSubject.value}setSearchTerm(t){this.searchTermSubject.next(t||"")}getSearchTerm(){return this.searchTermSubject.value}setSelectedCategory(t){if(!Array.isArray(t)||t.length===0){console.warn("Invalid categories array provided");return}this.selectedCategorySubject.next(t)}getSelectedCategory(){return this.selectedCategorySubject.value}setSelectedType(t){this.selectedTypeSubject.next(t||"all")}getSelectedType(){return this.selectedTypeSubject.value}setAccountFilter(t){if(!Array.isArray(t)){console.warn("Invalid accounts array provided");return}this.accountFilterSubject.next(t)}getAccountFilter(){return this.accountFilterSubject.value}setAmountRange(t,r){this.amountRangeSubject.next({min:t,max:r})}getAmountRange(){return this.amountRangeSubject.value}setStatusFilter(t){if(!Array.isArray(t)){console.warn("Invalid statuses array provided");return}this.statusFilterSubject.next(t)}getStatusFilter(){return this.statusFilterSubject.value}setTags(t){if(!Array.isArray(t)){console.warn("Invalid tags array provided");return}this.tagsSubject.next(t)}getTags(){return this.tagsSubject.value}clearSelectedDate(){this.selectedDateSubject.next(null),this.selectedDateRangeSubject.next(null)}clearSelectedYear(){this.selectedYearSubject.next(null)}clearCategoryFilter(){this.categoryFilterSubject.next(null)}clearSearchTerm(){this.searchTermSubject.next("")}clearSelectedCategory(){this.selectedCategorySubject.next(["all"])}clearSelectedType(){this.selectedTypeSubject.next("all")}clearAccountFilter(){this.accountFilterSubject.next([])}clearAmountRange(){this.amountRangeSubject.next({min:null,max:null})}clearStatusFilter(){this.statusFilterSubject.next([])}clearTags(){this.tagsSubject.next([])}clearAllFilters(){this.clearSelectedDate(),this.clearSelectedYear(),this.clearCategoryFilter(),this.clearSearchTerm(),this.clearSelectedCategory(),this.clearSelectedType(),this.clearAccountFilter(),this.clearAmountRange(),this.clearStatusFilter(),this.clearTags(),this.activePresetSubject.next(null)}setupFilterStateUpdates(){Or([this.selectedDate$,this.selectedDateRange$,this.selectedYear$,this.categoryFilter$,this.searchTerm$,this.selectedCategory$,this.selectedType$,this.accountFilter$,this.amountRange$,this.statusFilter$,this.tags$]).subscribe(([t,r,a,o,l,m,g,f,h,x,C])=>{let y={searchTerm:l,selectedCategory:m,selectedType:g,selectedDate:t,selectedDateRange:r,selectedYear:a,categoryFilter:o,accountFilter:f,amountRange:h,statusFilter:x,tags:C};this.filterStateSubject.next(y),this.addToHistory(y)})}saveAsPreset(t,r){if(!t||!r){console.warn("Preset name and description are required");return}let a=this.getCurrentFilterState(),o={id:this.generatePresetId(),name:t,description:r,filter:a},l=[...this.filterPresetsSubject.value,o];this.filterPresetsSubject.next(l),this.savePresetsToStorage(l)}applyPreset(t){let a=this.filterPresetsSubject.value.find(o=>o.id===t);a?(this.applyFilterState(a.filter),this.activePresetSubject.next(t)):console.warn(`Preset with id ${t} not found`)}deletePreset(t){let r=this.filterPresetsSubject.value.filter(a=>a.id!==t);this.filterPresetsSubject.next(r),this.savePresetsToStorage(r)}addToHistory(t){let r={timestamp:new Date,filter:t,description:this.generateFilterDescription(t)},a=this.filterHistorySubject.value,o=[r,...a.slice(0,9)];this.filterHistorySubject.next(o)}getFilterHistory(){return this.filterHistorySubject.value}clearFilterHistory(){this.filterHistorySubject.next([])}getCurrentFilterState(){return this.filterStateSubject.value}hasActiveFilters(t){let r=t||this.getCurrentFilterState();return!!(r.searchTerm||!r.selectedCategory.includes("all")||r.selectedType!=="all"||r.selectedDate||r.selectedDateRange||r.categoryFilter||r.accountFilter.length>0||r.amountRange.min!==null||r.amountRange.max!==null||r.statusFilter.length>0||r.tags.length>0||r.selectedYear)}getActiveFiltersCount(t){let r=t||this.getCurrentFilterState(),a=0;return r.searchTerm&&a++,r.selectedCategory.includes("all")||a++,r.selectedType!=="all"&&a++,r.selectedDate&&a++,r.selectedDateRange&&a++,r.categoryFilter&&a++,r.accountFilter.length>0&&a++,(r.amountRange.min!==null||r.amountRange.max!==null)&&a++,r.statusFilter.length>0&&a++,r.tags.length>0&&a++,r.selectedYear&&a++,a}applyFilterState(t){t.searchTerm!==void 0&&this.setSearchTerm(t.searchTerm),t.selectedCategory!==void 0&&this.setSelectedCategory(t.selectedCategory),t.selectedType!==void 0&&this.setSelectedType(t.selectedType),t.selectedDate!==void 0&&this.setSelectedDate(t.selectedDate),t.selectedDateRange!==void 0&&t.selectedDateRange&&this.setSelectedDateRange(t.selectedDateRange.startDate,t.selectedDateRange.endDate),t.selectedYear!==void 0&&t.selectedYear&&this.setSelectedYear(t.selectedYear.startYear,t.selectedYear.endYear),t.categoryFilter!==void 0&&this.categoryFilterSubject.next(t.categoryFilter),t.accountFilter!==void 0&&this.setAccountFilter(t.accountFilter),t.amountRange!==void 0&&this.setAmountRange(t.amountRange.min,t.amountRange.max),t.statusFilter!==void 0&&this.setStatusFilter(t.statusFilter),t.tags!==void 0&&this.setTags(t.tags)}resetToDefaults(){this.applyFilterState(this.getDefaultFilterState())}getDefaultFilterState(){return{searchTerm:"",selectedCategory:["all"],selectedType:"all",selectedDate:null,selectedDateRange:null,selectedYear:null,categoryFilter:null,accountFilter:[],amountRange:{min:null,max:null},statusFilter:[],tags:[]}}getDefaultPresets(){return[{id:"default-all",name:"All Transactions",description:"Show all transactions without filters",filter:this.getDefaultFilterState(),isDefault:!0},{id:"default-current-month",name:"Current Month",description:"Show transactions from current month",filter:le(oe({},this.getDefaultFilterState()),{selectedDateRange:{startDate:new Date(new Date().getFullYear(),new Date().getMonth(),1),endDate:new Date(new Date().getFullYear(),new Date().getMonth()+1,0)}})}]}initializePresets(){let t=this.loadPresetsFromStorage();this.filterPresetsSubject.next(t)}generatePresetId(){return`preset-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}generateFilterDescription(t){let r=[];return t.searchTerm&&r.push(`Search: "${t.searchTerm}"`),t.selectedCategory.includes("all")||r.push(`Category: ${t.selectedCategory.join(", ")}`),t.selectedType!=="all"&&r.push(`Type: ${t.selectedType}`),t.selectedDate&&r.push(`Date: ${t.selectedDate.toLocaleDateString()}`),t.selectedDateRange&&r.push(`Date Range: ${t.selectedDateRange.startDate.toLocaleDateString()} - ${t.selectedDateRange.endDate.toLocaleDateString()}`),t.categoryFilter&&r.push(`Category Filter: ${t.categoryFilter.categoryId} (${t.categoryFilter.monthName} ${t.categoryFilter.year})`),t.selectedYear&&r.push(`Year Range: ${t.selectedYear.startYear} - ${t.selectedYear.endYear}`),r.length>0?r.join(", "):"No filters applied"}savePresetsToStorage(t){try{localStorage.setItem("money-manager-filter-presets",JSON.stringify(t))}catch(r){console.warn("Failed to save filter presets to localStorage:",r)}}loadPresetsFromStorage(){try{let t=localStorage.getItem("money-manager-filter-presets");return t?JSON.parse(t):this.getDefaultPresets()}catch(t){return console.warn("Failed to load filter presets from localStorage:",t),this.getDefaultPresets()}}filterTransactions(t,r){let a=r||this.getCurrentFilterState(),o=[...t];if(a.searchTerm&&a.searchTerm.trim()){let l=a.searchTerm.toLowerCase().trim();o=o.filter(m=>{var g,f;return((g=m.payee)==null?void 0:g.toLowerCase().includes(l))||((f=m.category)==null?void 0:f.toLowerCase().includes(l))||m.notes&&m.notes.toLowerCase().includes(l)})}if(a.selectedCategory&&!a.selectedCategory.includes("all")&&(o=o.filter(l=>a.selectedCategory.includes(l.categoryId))),a.selectedType&&a.selectedType!=="all"&&(o=o.filter(l=>l.type===a.selectedType)),a.selectedDate){let l=(0,Ur.default)(a.selectedDate).startOf("day");o=o.filter(m=>{let g=this.getTransactionDate(m.date);return g?(0,Ur.default)(g).startOf("day").isSame(l,"day"):!1})}if(a.selectedDateRange&&a.selectedDateRange.startDate&&a.selectedDateRange.endDate){let l=(0,Ur.default)(a.selectedDateRange.startDate).startOf("day"),m=(0,Ur.default)(a.selectedDateRange.endDate).endOf("day");o=o.filter(g=>{let f=this.getTransactionDate(g.date);return f?(0,Ur.default)(f).isBetween(l,m,"day","[]"):!1})}return a.selectedYear&&a.selectedYear.startYear&&a.selectedYear.endYear&&(o=o.filter(l=>{let m=this.getTransactionDate(l.date);if(!m)return!1;let g=(0,Ur.default)(m).year();return g>=a.selectedYear.startYear&&g<=a.selectedYear.endYear})),a.accountFilter&&a.accountFilter.length>0&&(o=o.filter(l=>a.accountFilter.includes(l.accountId))),a.amountRange&&(a.amountRange.min!==null&&(o=o.filter(l=>l.amount>=(a.amountRange.min||0))),a.amountRange.max!==null&&(o=o.filter(l=>l.amount<=(a.amountRange.max||0)))),a.statusFilter&&a.statusFilter.length>0&&(o=o.filter(l=>a.statusFilter.includes(l.status))),a.tags&&a.tags.length>0&&(o=o.filter(l=>l.tags&&a.tags.some(m=>l.tags.includes(m)))),o}filterTransactionsWithCustomFilters(t,r){let a={searchTerm:r.searchTerm||"",selectedCategory:r.selectedCategory||["all"],selectedType:r.selectedType||"all",selectedDate:r.selectedDate||null,selectedDateRange:r.selectedDateRange||null,selectedYear:null,categoryFilter:null,accountFilter:r.accountFilter||[],amountRange:r.amountRange||{min:null,max:null},statusFilter:r.statusFilter||[],tags:r.tags||[]};return this.filterTransactions(t,a)}sortTransactions(t,r="date-desc"){let a=[...t];switch(r){case"date-desc":return a.sort((o,l)=>{var f,h;let m=this.getTransactionDate(o.date),g=this.getTransactionDate(l.date);return((f=g==null?void 0:g.getTime())!=null?f:0)-((h=m==null?void 0:m.getTime())!=null?h:0)});case"date-asc":return a.sort((o,l)=>{var f,h;let m=this.getTransactionDate(o.date),g=this.getTransactionDate(l.date);return((f=m==null?void 0:m.getTime())!=null?f:0)-((h=g==null?void 0:g.getTime())!=null?h:0)});case"amount-desc":return a.sort((o,l)=>l.amount-o.amount);case"amount-asc":return a.sort((o,l)=>o.amount-l.amount);case"payee-asc":return a.sort((o,l)=>o.payee.localeCompare(l.payee));case"category-asc":return a.sort((o,l)=>o.category.localeCompare(l.category));default:return a.sort((o,l)=>{var f,h;let m=this.getTransactionDate(o.date),g=this.getTransactionDate(l.date);return((f=g==null?void 0:g.getTime())!=null?f:0)-((h=m==null?void 0:m.getTime())!=null?h:0)})}}filterAndSortTransactions(t,r,a="date-desc"){let o=this.filterTransactions(t,r);return this.sortTransactions(o,a)}getTransactionDate(t){if(!t)return null;if(t&&typeof t=="object"&&"seconds"in t)return new Date(t.seconds*1e3);if(t instanceof Date)return t;if(typeof t=="string"){let r=new Date(t);return isNaN(r.getTime())?null:r}else if(typeof t=="number")return new Date(t);return null}filterCurrentYearTransactions(t,r){let a=(0,Ur.default)().year(),o=t.filter(l=>{let m=this.getTransactionDate(l.date);return m?(0,Ur.default)(m).year()===a:!1});return this.filterTransactions(o,r)}filterYearTransactions(t,r,a){let o=t.filter(l=>{let m=this.getTransactionDate(l.date);return m?(0,Ur.default)(m).year()===r:!1});return this.filterTransactions(o,a)}getFilteredCount(t,r){return this.filterTransactions(t,r).length}getCurrentYearFilteredCount(t,r){return this.filterCurrentYearTransactions(t,r).length}};i.\u0275fac=function(r){return new(r||i)},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var PC=new wa("NGX_ECHARTS_CONFIG"),Zu=class{constructor(){this.subject=new ho(1),this.subscriptions=new Ri}doFilter(i){this.subject.next(i)}dispose(){this.subscriptions.unsubscribe()}notEmpty(i,n){this.subscriptions.add(this.subject.subscribe(t=>{if(t[i]){let r=t[i].currentValue;r!=null&&n(r)}}))}has(i,n){this.subscriptions.add(this.subject.subscribe(t=>{if(t[i]){let r=t[i].currentValue;n(r)}}))}notFirst(i,n){this.subscriptions.add(this.subject.subscribe(t=>{if(t[i]&&!t[i].isFirstChange()){let r=t[i].currentValue;n(r)}}))}notFirstAndEmpty(i,n){this.subscriptions.add(this.subject.subscribe(t=>{if(t[i]&&!t[i].isFirstChange()){let r=t[i].currentValue;r!=null&&n(r)}}))}},ng=(()=>{let i=class i{constructor(){var t;this.el=ta(xo),this.ngZone=ta(Dr),this.config=ta(PC),this.options=_o(null),this.theme=_o((t=this.config.theme)!=null?t:null),this.initOpts=_o(null),this.merge=_o(null),this.autoResize=_o(!0),this.loading=_o(!1),this.loadingType=_o("default"),this.loadingOpts=_o(null),this.chartInit=Ou(),this.optionsError=Ou(),this.chartClick=Ht(this.createLazyEvent("click")),this.chartDblClick=Ht(this.createLazyEvent("dblclick")),this.chartMouseDown=Ht(this.createLazyEvent("mousedown")),this.chartMouseMove=Ht(this.createLazyEvent("mousemove")),this.chartMouseUp=Ht(this.createLazyEvent("mouseup")),this.chartMouseOver=Ht(this.createLazyEvent("mouseover")),this.chartMouseOut=Ht(this.createLazyEvent("mouseout")),this.chartGlobalOut=Ht(this.createLazyEvent("globalout")),this.chartContextMenu=Ht(this.createLazyEvent("contextmenu")),this.chartHighlight=Ht(this.createLazyEvent("highlight")),this.chartDownplay=Ht(this.createLazyEvent("downplay")),this.chartSelectChanged=Ht(this.createLazyEvent("selectchanged")),this.chartLegendSelectChanged=Ht(this.createLazyEvent("legendselectchanged")),this.chartLegendSelected=Ht(this.createLazyEvent("legendselected")),this.chartLegendUnselected=Ht(this.createLazyEvent("legendunselected")),this.chartLegendLegendSelectAll=Ht(this.createLazyEvent("legendselectall")),this.chartLegendLegendInverseSelect=Ht(this.createLazyEvent("legendinverseselect")),this.chartLegendScroll=Ht(this.createLazyEvent("legendscroll")),this.chartDataZoom=Ht(this.createLazyEvent("datazoom")),this.chartDataRangeSelected=Ht(this.createLazyEvent("datarangeselected")),this.chartGraphRoam=Ht(this.createLazyEvent("graphroam")),this.chartGeoRoam=Ht(this.createLazyEvent("georoam")),this.chartTreeRoam=Ht(this.createLazyEvent("treeroam")),this.chartTimelineChanged=Ht(this.createLazyEvent("timelinechanged")),this.chartTimelinePlayChanged=Ht(this.createLazyEvent("timelineplaychanged")),this.chartRestore=Ht(this.createLazyEvent("restore")),this.chartDataViewChanged=Ht(this.createLazyEvent("dataviewchanged")),this.chartMagicTypeChanged=Ht(this.createLazyEvent("magictypechanged")),this.chartGeoSelectChanged=Ht(this.createLazyEvent("geoselectchanged")),this.chartGeoSelected=Ht(this.createLazyEvent("geoselected")),this.chartGeoUnselected=Ht(this.createLazyEvent("geounselected")),this.chartAxisAreaSelected=Ht(this.createLazyEvent("axisareaselected")),this.chartBrush=Ht(this.createLazyEvent("brush")),this.chartBrushEnd=Ht(this.createLazyEvent("brushend")),this.chartBrushSelected=Ht(this.createLazyEvent("brushselected")),this.chartGlobalCursorTaken=Ht(this.createLazyEvent("globalcursortaken")),this.chartRendered=Ht(this.createLazyEvent("rendered")),this.chartFinished=Ht(this.createLazyEvent("finished")),this.animationFrameID=null,this.chart$=new ho(1),this.resize$=new Bt,this.changeFilter=new Zu,this.resizeObFired=!1,this.echarts=this.config.echarts}ngOnChanges(t){this.changeFilter.doFilter(t)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe(s1(100,Xh,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize()&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(t=>{for(let r of t)r.target===this.el.nativeElement&&(this.resizeObFired?this.animationFrameID=window.requestAnimationFrame(()=>{this.resize$.next()}):this.resizeObFired=!0)})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",t=>this.onOptionsChange(t)),this.changeFilter.notFirstAndEmpty("merge",t=>this.setOption(t)),this.changeFilter.has("loading",t=>this.toggleLoading(!!t)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(t){this.chart?t?this.chart.showLoading(this.loadingType(),this.loadingOpts()):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(r=>t?r.showLoading(this.loadingType(),this.loadingOpts()):r.hideLoading())}setOption(t,r){if(this.chart)try{this.chart.setOption(t,r)}catch(a){console.error(a),this.optionsError.emit(a)}}refreshChart(){return me(this,null,function*(){this.dispose(),yield this.initChart()})}createChart(){let t=this.el.nativeElement;if(window&&window.getComputedStyle){let r=window.getComputedStyle(t,null).getPropertyValue("height");(!r||r==="0px")&&(!t.style.height||t.style.height==="0px")&&(t.style.height="400px")}return this.ngZone.runOutsideAngular(()=>(typeof this.echarts=="function"?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:a})=>{var o,l;return a(t,(l=this.theme())!=null?l:(o=this.config)==null?void 0:o.theme,this.initOpts())}))}initChart(){return me(this,null,function*(){yield this.onOptionsChange(this.options());let t=this.merge();t&&this.chart&&this.setOption(t)})}onOptionsChange(t){return me(this,null,function*(){t&&(this.chart?this.setOption(this.options(),!0):(this.chart=yield this.createChart(),this.chart$.next(this.chart),this.chartInit.emit(this.chart),this.setOption(this.options(),!0)))})}createLazyEvent(t){return Y1(this.chartInit).pipe(wr(r=>new tn(a=>(r.on(t,o=>this.ngZone.run(()=>a.next(o))),()=>{this.chart&&(this.chart.isDisposed()||r.off(t))}))))}};i.\u0275fac=function(r){return new(r||i)},i.\u0275dir=bs({type:i,selectors:[["echarts"],["","echarts",""]],inputs:{options:[1,"options"],theme:[1,"theme"],initOpts:[1,"initOpts"],merge:[1,"merge"],autoResize:[1,"autoResize"],loading:[1,"loading"],loadingType:[1,"loadingType"],loadingOpts:[1,"loadingOpts"]},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartHighlight:"chartHighlight",chartDownplay:"chartDownplay",chartSelectChanged:"chartSelectChanged",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendLegendSelectAll:"chartLegendLegendSelectAll",chartLegendLegendInverseSelect:"chartLegendLegendInverseSelect",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartGraphRoam:"chartGraphRoam",chartGeoRoam:"chartGeoRoam",chartTreeRoam:"chartTreeRoam",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartGeoSelectChanged:"chartGeoSelectChanged",chartGeoSelected:"chartGeoSelected",chartGeoUnselected:"chartGeoUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartGlobalCursorTaken:"chartGlobalCursorTaken",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],standalone:!0,features:[Xd]});let e=i;return e})();function FE(e){return{provide:PC,useValue:e}}var OC=(()=>{let i=class i{static forRoot(t){return{ngModule:i,providers:[FE(t)]}}static forChild(){return{ngModule:i}}};i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=ir({type:i}),i.\u0275inj=nr({});let e=i;return e})();var Kl=Yr(Xr());var ig=()=>({round:!0}),SC=(()=>{let i=class i{constructor(t,r,a,o){this.auth=t,this.notificationService=r,this.currencyService=a,this.store=o,this.totalSpendAmt=0,this.totalIncomeAmt=0,this.showYearly=!1,this.userCurrency=this.currencyService.getDefaultCurrency(),this.subscriptions=new Ri,this.totalIncome$=this.store.select(sx),this.totalIncomeByMonth$=this.store.select(cx((0,Kl.default)().month(),(0,Kl.default)().year())),this.totalExpenses$=this.store.select(lx),this.totalExpensesByMonth$=this.store.select(dx((0,Kl.default)().month(),(0,Kl.default)().year())),this.netBalance$=this.store.select(mx)}ngOnInit(){var r;this.subscriptions.add(this.currencyService.currentCurrency$.subscribe(a=>{this.userCurrency=a}));let t=(r=this.auth.currentUser)==null?void 0:r.uid;t&&this.store.dispatch(li({userId:t})),this.subscriptions.add(this.totalIncome$.subscribe(a=>{this.totalIncomeAmt=a})),this.subscriptions.add(this.totalExpenses$.subscribe(a=>{this.totalSpendAmt=a}))}ngOnDestroy(){this.subscriptions.unsubscribe()}toggleExpenseIncome(){this.showYearly=!this.showYearly}};i.\u0275fac=function(r){return new(r||i)(Y(xt),Y(ft),Y(q_),Y(pt))},i.\u0275cmp=Re({type:i,selectors:[["total-balance"]],decls:17,vars:26,consts:[[1,"text-center","mb-2","pt-5","md:pt-0","mt-2"],[1,"grid","grid-cols-1","gap-4"],[1,"text-center",3,"click"],[1,"text-lg","text-muted","text-gray-500"],[1,"text-responsive-lg","mt-1","font-bold","text-primary"],[1,"text-gray-500"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),F("click",function(){return a.toggleExpenseIncome()}),s(3,"div",3),d(4,"You Expense | Income"),c(),s(5,"div",4),d(6),ce(7,"async"),ce(8,"currency"),ce(9,"async"),ce(10,"currency"),s(11,"span",5),d(12),ce(13,"async"),ce(14,"currency"),ce(15,"async"),ce(16,"currency"),c()()()()()),r&2&&(u(6),ne(" ",a.showYearly?ht(8,4,xe(7,2,a.totalExpenses$),ka(22,ig)):ht(10,9,xe(9,7,a.totalExpensesByMonth$),ka(23,ig))," \xA0 | \xA0 "),u(6),L(a.showYearly?ht(14,14,xe(13,12,a.totalIncome$),ka(24,ig)):ht(16,19,xe(15,17,a.totalIncomeByMonth$),ka(25,ig))))},dependencies:[Vi,Sr]});let e=i;return e})();var BE=["calendar"],NE=(e,i)=>i.value;function LE(e,i){e&1&&(s(0,"div",19),re(1,"total-balance",20),c())}function VE(e,i){if(e&1){let n=ue();s(0,"button",21),F("click",function(){R(n);let r=v();return B(r.clearAll())}),s(1,"mat-icon"),d(2,"clear"),c()()}}function UE(e,i){if(e&1){let n=ue();s(0,"button",22),F("click",function(){R(n);let r=v();return B(r.toggleControls())}),s(1,"mat-icon"),d(2,"expand_more"),c()()}if(e&2){let n=v();ze("rotated",n.isControlsExpanded),Sa("matTooltip",n.isControlsExpanded?"Hide controls":"Show controls")}}function zE(e,i){if(e&1){let n=ue();s(0,"div",23)(1,"button",12),F("click",function(){R(n);let r=v();return B(r.toggleChartViewMode())}),s(2,"mat-icon"),d(3,"category"),c(),d(4," Category View "),c(),s(5,"button",12),F("click",function(){R(n);let r=v();return B(r.toggleChartViewMode())}),s(6,"mat-icon"),d(7,"compare_arrows"),c(),d(8," Income vs Expense "),c()()}if(e&2){let n=v();u(),P("color",n.chartViewMode==="category"?"primary":"basic"),u(4),P("color",n.chartViewMode==="income-expense"?"primary":"basic")}}function jE(e,i){if(e&1&&(s(0,"mat-option",28),d(1),c()),e&2){let n=i.$implicit;P("value",n),u(),ne(" ",n," ")}}function $E(e,i){if(e&1&&(s(0,"mat-option",28),d(1),c()),e&2){let n=i.$implicit;P("value",n.value),u(),ne(" ",n.label," ")}}function YE(e,i){if(e&1){let n=ue();s(0,"div",24)(1,"div",25)(2,"mat-form-field",26)(3,"mat-label"),d(4,"Year"),c(),s(5,"mat-select",27),lt("valueChange",function(r){R(n);let a=v();return ct(a.selectedYear,r)||(a.selectedYear=r),B(r)}),F("selectionChange",function(r){R(n);let a=v();return B(a.onYearChange(r.value))}),Ge(6,jE,2,2,"mat-option",28,rr),c()(),s(8,"mat-form-field",29)(9,"mat-label"),d(10,"Month"),c(),s(11,"mat-select",27),lt("valueChange",function(r){R(n);let a=v();return ct(a.selectedMonth,r)||(a.selectedMonth=r),B(r)}),F("selectionChange",function(r){R(n);let a=v();return B(a.onMonthChange(r.value))}),Ge(12,$E,2,2,"mat-option",28,NE),c()()()()}if(e&2){let n=v();u(5),st("value",n.selectedYear),u(),He(n.availableYears),u(5),st("value",n.selectedMonth),u(),He(n.availableMonths)}}function WE(e,i){if(e&1){let n=ue();s(0,"div",30)(1,"button",31),F("click",function(){R(n);let r=v();return B(r.goToPreviousMonth())}),s(2,"mat-icon"),d(3,"chevron_left"),c()(),s(4,"button",32),F("click",function(){R(n);let r=v();return B(r.goToToday())}),s(5,"mat-icon"),d(6,"today"),c(),d(7," Today "),c(),s(8,"button",33),F("click",function(){R(n);let r=v();return B(r.goToNextMonth())}),s(9,"mat-icon"),d(10,"chevron_right"),c()()()}}function GE(e,i){if(e&1){let n=ue();s(0,"div",34)(1,"div",35)(2,"div",36),F("chartClick",function(r){R(n);let a=v();return B(a.onChartClick(r))}),c()()()}if(e&2){let n=v();u(2),P("options",n.pieChartOption)}}function HE(e,i){if(e&1&&(s(0,"span",47),d(1),ce(2,"date"),c()),e&2){let n=v(2);u(),ne(" ",ht(2,1,n.startDate,"MMM dd, yyyy")," ")}}function qE(e,i){e&1&&(s(0,"span",48),d(1,"Not selected"),c())}function XE(e,i){if(e&1&&(s(0,"span",49),d(1),ce(2,"date"),c()),e&2){let n=v(2);u(),ne(" ",ht(2,1,n.endDate,"MMM dd, yyyy")," ")}}function KE(e,i){e&1&&(s(0,"span",48),d(1,"Not selected"),c())}function ZE(e,i){if(e&1&&(s(0,"div",50)(1,"div",51)(2,"div",52)(3,"div",53),d(4,"Income"),c(),s(5,"div",54),d(6),ce(7,"number"),c()(),s(8,"div",52)(9,"div",53),d(10,"Expenses"),c(),s(11,"div",55),d(12),ce(13,"number"),c()(),s(14,"div",52)(15,"div",53),d(16,"Net"),c(),s(17,"div",56),d(18),ce(19,"number"),c()()(),s(20,"div",57),d(21),c()()),e&2){let n=v(2);u(6),ne("\u20B9",ht(7,7,n.getRangeTotalIncome(),"1.2-2"),""),u(6),ne("\u20B9",ht(13,10,n.getRangeTotalExpenses(),"1.2-2"),""),u(5),P("ngClass",n.getRangeNetAmount()>=0?"positive":"negative"),u(),ne(" \u20B9",ht(19,13,n.getRangeNetAmount(),"1.2-2")," "),u(3),C1(" ",n.rangeTransactions.length," transactions in ",n.getDaysInRange()," day",n.getDaysInRange()!==1?"s":""," ")}}function QE(e,i){if(e&1&&(s(0,"div",37)(1,"div",38)(2,"div",39)(3,"div",40)(4,"span",41),d(5,"Start:"),c(),N(6,HE,3,4,"span",42)(7,qE,2,0,"span",43),c(),s(8,"mat-icon",44),d(9,"arrow_forward"),c(),s(10,"div",40)(11,"span",41),d(12,"End:"),c(),N(13,XE,3,4,"span",45)(14,KE,2,0,"span",43),c()(),N(15,ZE,22,16,"div",46),c()()),e&2){let n=v();u(6),P("ngIf",n.startDate),u(),P("ngIf",!n.startDate),u(6),P("ngIf",n.endDate),u(),P("ngIf",!n.endDate),u(),P("ngIf",n.startDate&&n.endDate)}}function JE(e,i){if(e&1&&(s(0,"div",37)(1,"div",58)(2,"div",59)(3,"mat-icon",60),d(4,"event"),c(),s(5,"span",61),d(6),ce(7,"date"),c()(),s(8,"div",62)(9,"div",51)(10,"div",52)(11,"div",53),d(12,"Income"),c(),s(13,"div",54),d(14),ce(15,"number"),c()(),s(16,"div",52)(17,"div",53),d(18,"Expenses"),c(),s(19,"div",55),d(20),ce(21,"number"),c()(),s(22,"div",52)(23,"div",53),d(24,"Net"),c(),s(25,"div",56),d(26),ce(27,"number"),c()()(),s(28,"div",57),d(29),c()()()()),e&2){let n=v();u(6),L(ht(7,6,n.selectedDate,"fullDate")),u(8),ne("\u20B9",ht(15,9,n.getTotalIncome(),"1.2-2"),""),u(6),ne("\u20B9",ht(21,12,n.getTotalExpenses(),"1.2-2"),""),u(5),P("ngClass",n.getNetAmount()>=0?"positive":"negative"),u(),ne(" \u20B9",ht(27,15,n.getNetAmount(),"1.2-2")," "),u(3),ne(" ",n.selectedDateTransactions.length," transactions ")}}function e5(e,i){if(e&1){let n=ue();s(0,"div",63)(1,"mat-calendar",64,0),F("selectedChange",function(r){R(n);let a=v();return B(a.onDateSelected(r))}),c()()}if(e&2){let n=v();u(),P("dateClass",n.dateClass)("selected",n.selectedDate)}}var rg=(()=>{let i=class i{constructor(t,r,a,o,l){this.breakpointObserver=t,this.filterService=r,this.notificationService=a,this.dateService=o,this.store=l,this.isMobile=!1,this.transactions=[],this.categories=[],this.selectedDate=null,this.selectedDateTransactions=[],this.isRangeMode=!1,this.startDate=null,this.endDate=null,this.rangeTransactions=[],this.isControlsExpanded=!1,this.pieChartOption={},this.showPieChart=!1,this.showCalendar=!0,this.chartViewMode="category",this.currentViewDate=new Date,this.selectedYear=new Date().getFullYear(),this.selectedMonth=new Date().getMonth(),this.availableYears=[],this.availableMonths=[{value:0,label:"January"},{value:1,label:"February"},{value:2,label:"March"},{value:3,label:"April"},{value:4,label:"May"},{value:5,label:"June"},{value:6,label:"July"},{value:7,label:"August"},{value:8,label:"September"},{value:9,label:"October"},{value:10,label:"November"},{value:11,label:"December"}],this.subscription=new Ri,this.dateClass=(m,g)=>{if(g==="month"){let f=(0,pn.default)(m).startOf("day"),h="",x=this.transactions.some(y=>(0,pn.default)(this.dateService.toDate(y.date)).startOf("day").isSame(f,"day")&&y.type===Lt.INCOME);if(this.transactions.some(y=>(0,pn.default)(this.dateService.toDate(y.date)).startOf("day").isSame(f,"day"))&&(x?h+="has-transactions has-income ":h+="has-transactions has-expense "),this.isRangeMode){if(this.startDate&&(0,pn.default)(this.startDate).startOf("day").isSame(f,"day")&&(h+="range-start "),this.endDate&&(0,pn.default)(this.endDate).startOf("day").isSame(f,"day")&&(h+="range-end "),this.startDate&&this.endDate){let y=(0,pn.default)(this.startDate).startOf("day"),b=(0,pn.default)(this.endDate).endOf("day");f.isBetween(y,b,"day","[]")&&(h+="range-in-between ")}}else this.selectedDate&&(0,pn.default)(this.selectedDate).startOf("day").isSame(f,"day")&&(h+="selected-date ");return h.trim()}return""},this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(m=>{this.isMobile=m.matches})}ngOnInit(){this.loadTransactions(),this.loadCategories(),this.initializePieChart(),this.generateAvailableYears(),this.subscribeToFilterService()}ngOnDestroy(){this.subscription.unsubscribe()}loadTransactions(){this.subscription.add(this.store.select(Gn).subscribe({next:t=>{this.transactions=t,this.updatePieChart(),this.updateCalendar()},error:t=>{console.error("Error loading transactions:",t),this.notificationService.error("Failed to load calendar data")}}))}loadCategories(){this.subscription.add(this.store.select(un).subscribe({next:t=>{this.categories=t,this.updatePieChart()},error:t=>{console.error("Error loading categories:",t)}}))}generateAvailableYears(){let t=new Date().getFullYear();this.availableYears=[];for(let r=t-5;r<=t+1;r++)this.availableYears.push(r)}initializePieChart(){this.pieChartOption={title:{text:"Category-wise Spending",left:"center",textStyle:{fontSize:14,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:"{b}<br> \u20B9{c} ({d}%)"},legend:{orient:"horizontal",left:"center",bottom:"10%",type:"scroll"},series:[{name:"Categories",type:"pie",radius:"50%",data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}}updatePieChart(){this.chartViewMode==="category"?this.updateCategoryChart():this.updateIncomeExpenseChart()}updateCategoryChart(){let t=this.getFilteredTransactions(),r=this.getCategorySpendingData(t),a=t.reduce((o,l)=>o+l.amount,0);this.pieChartOption=le(oe({},this.pieChartOption),{title:{text:`${this.availableMonths[this.selectedMonth].label} ${this.selectedYear} - \u20B9${a.toLocaleString()}`,left:"center",textStyle:{fontSize:14,fontWeight:"bold"}},series:[{name:"Categories",type:"pie",radius:"50%",label:{show:!0,position:"outside",formatter:"{b} ({d}%)"},data:r,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}onChartClick(t){this.chartViewMode==="category"&&t.data&&!this.isMobile&&this.applyCategoryFilter(t.data.categoryId||t.data.name)}applyCategoryFilter(t){let r=this.categories.find(m=>m.id===t),a=r?r.name:t;this.filterService.setSelectedCategory([t]);let o=(0,pn.default)([this.selectedYear,this.selectedMonth,1]).startOf("month").toDate(),l=(0,pn.default)([this.selectedYear,this.selectedMonth,1]).endOf("month").toDate();this.filterService.setSelectedDateRange(o,l),this.notificationService.success(`Filtering transactions for ${a} in ${this.availableMonths[this.selectedMonth].label} ${this.selectedYear}`)}updateIncomeExpenseChart(){let t=0,r=0;this.isRangeMode&&this.startDate&&this.endDate?(t=this.getRangeTotalIncome(),r=this.getRangeTotalExpenses()):this.selectedDate&&(t=this.getTotalIncome(),r=this.getTotalExpenses()),this.pieChartOption=le(oe({},this.pieChartOption),{title:{text:"Income vs Expenses",left:"center",textStyle:{fontSize:14,fontWeight:"bold"}},series:[{name:"Transactions",type:"pie",radius:"50%",data:[{value:t,name:"Income",itemStyle:{color:"#10b981"}},{value:r,name:"Expenses",itemStyle:{color:"#ef4444"}}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}getFilteredTransactions(){let t=(0,pn.default)([this.selectedYear,this.selectedMonth,1]),r=(0,pn.default)(t).endOf("month");return this.transactions.filter(a=>(0,pn.default)(this.dateService.toDate(a.date)).isBetween(t,r,"day","[]")&&a.type==="expense")}getCategorySpendingData(t){let r=new Map;t.forEach(o=>{let l=o.categoryId,m=this.categories.find(f=>f.id===l),g=m?m.name:"";if(g&&l)if(r.has(l)){let f=r.get(l);f.amount+=o.amount}else r.set(l,{name:g,id:l,amount:o.amount})});let a=["#5B8DEF","#A0C4FF","#B8B8FF","#CDB4DB","#FFAFCC","#FFC8DD","#FDCB82","#90DBF4","#ADE8F4","#CAF0F8","#A2D2FF","#D0F4DE"];return Array.from(r.values()).map((o,l)=>({name:o.name,categoryId:o.id,value:o.amount,itemStyle:{color:a[l%a.length]}}))}togglePieChart(){this.showPieChart=!this.showPieChart,this.showCalendar=!this.showCalendar,this.showPieChart&&this.updatePieChart()}toggleCalendar(){this.showCalendar=!this.showCalendar,this.showPieChart=!this.showCalendar}toggleChartViewMode(){this.chartViewMode=this.chartViewMode==="category"?"income-expense":"category",this.updatePieChart()}onYearChange(t){this.selectedYear=t,this.updatePieChart()}onMonthChange(t){this.selectedMonth=t,this.updatePieChart()}goToPreviousMonth(){this.currentViewDate=(0,pn.default)(this.currentViewDate).subtract(1,"month").toDate()}goToNextMonth(){this.currentViewDate=(0,pn.default)(this.currentViewDate).add(1,"month").toDate()}goToToday(){this.currentViewDate=new Date}onDateSelected(t){this.isRangeMode?this.handleRangeSelection(t):this.handleSingleDateSelection(t),this.updatePieChart()}handleSingleDateSelection(t){this.selectedDate=t,t?(this.selectedDateTransactions=this.getTransactionsForDate(t),this.filterService.setSelectedDate(t)):(this.selectedDateTransactions=[],this.filterService.clearSelectedDate())}handleRangeSelection(t){t&&(!this.startDate||this.startDate&&this.endDate?(this.startDate=t,this.endDate=null,this.rangeTransactions=[]):(t>=this.startDate?this.endDate=t:(this.endDate=this.startDate,this.startDate=t),this.rangeTransactions=this.getTransactionsForDateRange(this.startDate,this.endDate),this.filterService.setSelectedDateRange(this.startDate,this.endDate)))}getTransactionsForDate(t){let r=(0,pn.default)(t).startOf("day");return this.transactions.filter(a=>(0,pn.default)(this.dateService.toDate(a.date)).startOf("day").isSame(r,"day"))}getTransactionsForDateRange(t,r){let a=(0,pn.default)(t).startOf("day"),o=(0,pn.default)(r).endOf("day");return this.transactions.filter(l=>(0,pn.default)(this.dateService.toDate(l.date)).isBetween(a,o,"day","[]"))}formatDate(t){return(0,pn.default)(t).format("YYYY-MM-DD")}getTotalIncome(){return this.selectedDateTransactions.filter(t=>t.type===Lt.INCOME).reduce((t,r)=>t+r.amount,0)}getTotalExpenses(){return this.selectedDateTransactions.filter(t=>t.type==="expense").reduce((t,r)=>t+r.amount,0)}getNetAmount(){return this.getTotalIncome()-this.getTotalExpenses()}toggleRangeMode(){this.isRangeMode=!this.isRangeMode,this.clearSelections()}toggleControls(){this.isControlsExpanded=!this.isControlsExpanded}hasSelection(){return this.isRangeMode?this.startDate!==null||this.endDate!==null:this.selectedDate!==null}clearSelections(){this.selectedDate=null,this.selectedDateTransactions=[],this.startDate=null,this.endDate=null,this.rangeTransactions=[],this.filterService.clearSelectedDate(),this.updatePieChart()}getRangeTotalIncome(){return this.rangeTransactions.filter(t=>t.type===Lt.INCOME).reduce((t,r)=>t+r.amount,0)}getRangeTotalExpenses(){return this.rangeTransactions.filter(t=>t.type==="expense").reduce((t,r)=>t+r.amount,0)}getRangeNetAmount(){return this.getRangeTotalIncome()-this.getRangeTotalExpenses()}getFormattedDateRange(){if(!this.startDate||!this.endDate)return"";let t=(0,pn.default)(this.startDate),r=(0,pn.default)(this.endDate);return t.isSame(r,"day")?t.format("MMM DD, YYYY"):t.isSame(r,"year")?`${t.format("MMM DD")} - ${r.format("MMM DD, YYYY")}`:`${t.format("MMM DD, YYYY")} - ${r.format("MMM DD, YYYY")}`}getDaysInRange(){if(!this.startDate||!this.endDate)return 0;let t=(0,pn.default)(this.startDate);return(0,pn.default)(this.endDate).diff(t,"days")+1}isToday(t){return(0,pn.default)(t).isSame((0,pn.default)(),"day")}isPastDate(t){return(0,pn.default)(t).isBefore((0,pn.default)(),"day")}isFutureDate(t){return(0,pn.default)(t).isAfter((0,pn.default)(),"day")}clearAll(){this.clearSelections(),this.isControlsExpanded=this.isRangeMode=!1,this.filterService.clearSelectedDate()}subscribeToFilterService(){this.subscription.add(this.filterService.selectedDateRange$.subscribe(t=>{t&&(this.selectedMonth=t.startDate.getMonth(),this.selectedYear=t.startDate.getFullYear()),this.updatePieChart()}))}updateCalendar(){this.calendar&&this.calendar.updateTodaysDate()}};i.\u0275fac=function(r){return new(r||i)(Y(dr),Y(Qa),Y(ft),Y(Vt),Y(pt))},i.\u0275cmp=Re({type:i,selectors:[["calendar-view"]],viewQuery:function(r,a){if(r&1&&ar(BE,5),r&2){let o;Ni(o=Li())&&(a.calendar=o.first)}},decls:35,vars:18,consts:[["calendar",""],[1,"demo-inline-calendar-card"],["class","m-4 flex justify-around",4,"ngIf"],[1,"calendar-header"],[1,"header-main"],[1,"header-title","sm:text-sm","text-xs"],[1,"header-actions"],["mat-icon-button","","color","warn","matTooltip","Clear selection",3,"click",4,"ngIf"],["mat-icon-button","",3,"click","color","matTooltip"],["mat-icon-button","",3,"rotated","matTooltip","click",4,"ngIf"],[1,"controls-section"],[1,"mode-toggle"],["mat-raised-button","",3,"click","color"],["class","chart-mode-toggle",4,"ngIf"],["class","date-filters",4,"ngIf"],["class","calendar-navigation",4,"ngIf"],["class","pie-chart-section",4,"ngIf"],["class","status-section",4,"ngIf"],["class","calendar-container",4,"ngIf"],[1,"m-4","flex","justify-around"],[1,"md:col-span-2","lg:col-span-7"],["mat-icon-button","","color","warn","matTooltip","Clear selection",3,"click"],["mat-icon-button","",3,"click","matTooltip"],[1,"chart-mode-toggle"],[1,"date-filters"],[1,"filter-row"],["appearance","fill",1,"year-select"],[3,"valueChange","selectionChange","value"],[3,"value"],["appearance","fill",1,"month-select"],[1,"calendar-navigation"],["mat-icon-button","","matTooltip","Previous month",3,"click"],["mat-raised-button","","color","primary","matTooltip","Go to today",3,"click"],["mat-icon-button","","matTooltip","Next month",3,"click"],[1,"pie-chart-section"],[1,"chart-container"],["echarts","",1,"pie-chart",3,"chartClick","options"],[1,"status-section"],[1,"range-status"],[1,"date-range-display"],[1,"date-item"],[1,"date-label"],["class","date-value start-date",4,"ngIf"],["class","date-placeholder",4,"ngIf"],[1,"arrow-icon"],["class","date-value end-date",4,"ngIf"],["class","range-summary",4,"ngIf"],[1,"date-value","start-date"],[1,"date-placeholder"],[1,"date-value","end-date"],[1,"range-summary"],[1,"summary-grid"],[1,"summary-item"],[1,"summary-label"],[1,"summary-amount","income"],[1,"summary-amount","expense"],[1,"summary-amount",3,"ngClass"],[1,"transaction-count"],[1,"single-date-status"],[1,"selected-date-display"],[1,"date-icon"],[1,"selected-date-text"],[1,"date-summary"],[1,"calendar-container"],[3,"selectedChange","dateClass","selected"]],template:function(r,a){r&1&&(s(0,"mat-card",1),N(1,LE,2,0,"div",2),s(2,"div",3)(3,"div",4)(4,"div",5)(5,"mat-icon"),d(6,"calendar_today"),c(),s(7,"span"),d(8,"Calendar"),c()(),s(9,"div",6),N(10,VE,3,0,"button",7),s(11,"button",8),F("click",function(){return a.togglePieChart()}),s(12,"mat-icon"),d(13,"pie_chart"),c()(),s(14,"button",8),F("click",function(){return a.toggleCalendar()}),s(15,"mat-icon"),d(16,"calendar_month"),c()(),N(17,UE,3,3,"button",9),c()(),s(18,"div",10)(19,"div",11)(20,"button",12),F("click",function(){return a.toggleRangeMode()}),s(21,"mat-icon"),d(22,"event"),c(),d(23," Single Date "),c(),s(24,"button",12),F("click",function(){return a.toggleRangeMode()}),s(25,"mat-icon"),d(26,"date_range"),c(),d(27," Date Range "),c()(),N(28,zE,9,2,"div",13)(29,YE,14,2,"div",14)(30,WE,11,0,"div",15),c()(),N(31,GE,3,1,"div",16)(32,QE,16,5,"div",17)(33,JE,30,18,"div",17)(34,e5,3,2,"div",18),c()),r&2&&(u(),P("ngIf",!a.isRangeMode&&!a.selectedDate),u(9),P("ngIf",a.hasSelection()),u(),Sa("matTooltip",a.showPieChart?"Hide chart":"Show chart"),P("color",a.showPieChart?"primary":"basic"),u(3),Sa("matTooltip",a.showCalendar&&!a.showPieChart?"Hide calendar":"Show calendar"),P("color",a.showCalendar&&!a.showPieChart?"primary":"basic"),u(3),P("ngIf",!a.isMobile),u(),ze("expanded",a.isControlsExpanded),u(2),P("color",a.isRangeMode?"basic":"primary"),u(4),P("color",a.isRangeMode?"primary":"basic"),u(4),P("ngIf",a.showPieChart),u(),P("ngIf",a.showPieChart&&a.chartViewMode==="category"),u(),P("ngIf",a.showCalendar),u(),P("ngIf",a.showPieChart),u(),P("ngIf",a.isRangeMode&&a.showCalendar),u(),P("ngIf",!a.isRangeMode&&a.selectedDate&&a.showCalendar),u(),P("ngIf",a.showCalendar&&!a.showPieChart))},dependencies:[$n,dt,ji,Jt,gn,Qe,Cx,Oi,Lr,wi,yi,Tn,ng,SC,Vo,_i],styles:[".demo-inline-calendar-card[_ngcontent-%COMP%]{width:100%;max-width:400px;margin:0 auto;overflow:hidden}.calendar-header[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-weight:600;color:#374151}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:.25rem}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:transform .2s ease}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button.rotated[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]{max-height:0;overflow:hidden;transition:max-height .3s ease,padding .3s ease;padding:0 1rem}.calendar-header[_ngcontent-%COMP%]   .controls-section.expanded[_ngcontent-%COMP%]{max-height:400px;padding:1rem;background-color:#f0f8ff}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .mode-toggle[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:center;margin-bottom:1rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .mode-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;max-width:150px}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .chart-mode-toggle[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:center;margin-bottom:1rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .chart-mode-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;max-width:150px;font-size:.75rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .chart-mode-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;margin-right:.25rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]{margin-bottom:1rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:center}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .year-select[_ngcontent-%COMP%], .calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .month-select[_ngcontent-%COMP%]{flex:1;max-width:120px}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .year-select[_ngcontent-%COMP%]     .mat-mdc-form-field, .calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .month-select[_ngcontent-%COMP%]     .mat-mdc-form-field{font-size:.875rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .year-select[_ngcontent-%COMP%]     .mat-mdc-select, .calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .month-select[_ngcontent-%COMP%]     .mat-mdc-select{font-size:.875rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .calendar-navigation[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .calendar-navigation[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:all .2s ease}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .calendar-navigation[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.pie-chart-section[_ngcontent-%COMP%]{padding:1rem 0;border-bottom:1px solid #f3f4f6;background:#f4f3f6}.pie-chart-section[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.pie-chart-section[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .pie-chart[_ngcontent-%COMP%]{width:100%;height:450px;max-width:450px;cursor:pointer}@media (max-width: 480px){.pie-chart-section[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .pie-chart[_ngcontent-%COMP%]{width:100%;height:350px;max-width:350px}}.status-section[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #f3f4f6}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:1rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value[_ngcontent-%COMP%]{font-weight:600}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.start-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.start-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.start-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.start-date[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(70 119 127 / var(--tw-text-opacity))}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.end-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.end-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.end-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.end-date[_ngcontent-%COMP%]{color:#10b981}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-placeholder[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-placeholder[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-placeholder[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-placeholder[_ngcontent-%COMP%]{color:#9ca3af;font-style:italic}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .arrow-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .arrow-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .arrow-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .arrow-icon[_ngcontent-%COMP%]{color:#9ca3af;font-size:1rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-icon[_ngcontent-%COMP%]{color:#10b981}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .selected-date-text[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .selected-date-text[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .selected-date-text[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .selected-date-text[_ngcontent-%COMP%]{font-weight:600;color:#374151}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]{background:#f8fafc;border-radius:8px;padding:1rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-bottom:.5rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{text-align:center}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;margin-bottom:.25rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount[_ngcontent-%COMP%]{font-weight:700;font-size:.875rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.income[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.income[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.income[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.income[_ngcontent-%COMP%]{color:#10b981}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.expense[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.expense[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.expense[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.expense[_ngcontent-%COMP%]{color:#ef4444}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.positive[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.positive[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.positive[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.positive[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(70 119 127 / var(--tw-text-opacity))}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.negative[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.negative[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.negative[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.negative[_ngcontent-%COMP%]{color:#f59e0b}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]{text-align:center;font-size:.75rem;color:#6b7280}.calendar-container[_ngcontent-%COMP%]{padding:1rem}  .mat-calendar-body-cell.has-transactions.has-income .mat-calendar-body-cell-content{background-color:#a6eeb3!important}  .mat-calendar-body-cell.has-transactions.has-expense{color:#fff!important;font-weight:700;border-radius:50%}  .mat-calendar-body-cell.has-transactions.has-expense .mat-calendar-body-cell-content{background-color:#c8dbdf!important}  .mat-calendar-body-cell.has-transactions:hover .mat-calendar-body-cell-content{--tw-bg-opacity: 1;background-color:rgb(70 119 127 / var(--tw-bg-opacity))}  .mat-calendar-body-cell.mat-calendar-body-active .mat-calendar-body-cell-content{--tw-bg-opacity: 1;background-color:rgb(70 119 127 / var(--tw-bg-opacity));color:#fff!important}  .mat-calendar-body-cell.range-start .mat-calendar-body-cell-content{background-color:#059669!important;color:#fff!important;font-weight:700}  .mat-calendar-body-cell.range-end .mat-calendar-body-cell-content{background-color:#dc2626!important;color:#fff!important;font-weight:700}  .mat-calendar-body-cell.range-in-between .mat-calendar-body-cell-content{background-color:#fbbf24!important;color:#1f2937!important;font-weight:500}  .mat-calendar-body-cell.selected-date .mat-calendar-body-cell-content{background-color:#7c3aed!important;color:#fff!important;font-weight:700}.transaction-summary[_ngcontent-%COMP%]   .income-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dcfce7,#bbf7d0)}.transaction-summary[_ngcontent-%COMP%]   .expense-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fee2e2,#fecaca)}.transaction-summary[_ngcontent-%COMP%]   .net-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe)}.transaction-item[_ngcontent-%COMP%]{transition:all .2s ease}.transaction-item[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 6px -1px #0000001a}@media (max-width: 768px){.demo-inline-calendar-card[_ngcontent-%COMP%]{max-width:100%}.transaction-summary[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}}"]});let e=i;return e})();var Qu=(()=>{let i=class i{constructor(){this.topCategoriesConfig={title:"Top Categories",subtitle:"Top categories by spending",currency:"INR",showHeaderIcon:!0,headerIcon:"category",headerIconColor:"blue",showFooter:!0,footerText:"Last updated",cardHeight:"small",theme:"auto",animations:!0,clickable:!0},this.recentActivityConfig={title:"Recent Activity",subtitle:"Recent activity",currency:"INR",showHeaderIcon:!0},this.monthlyTrendsConfig={title:"Monthly Trends",subtitle:"Monthly trends",currency:"INR",showHeaderIcon:!0},this.categoryBreakdownConfig={title:"Category Breakdown",subtitle:"Spending by category",currency:"INR",showHeaderIcon:!0,headerIcon:"category",headerIconColor:"blue",maxItems:5},this.quickActionsFabConfig={title:"Quick Actions",mainButtonIcon:"add",mainButtonColor:"primary",mainButtonTooltip:"Quick Actions",showLabels:!1,animations:!0,autoHide:!1,autoHideDelay:3e3,theme:"auto",actions:[{id:"add-transaction",label:"Add Transaction",icon:"receipt",color:"accent",tooltip:"Add Transaction"},{id:"export-report",label:"Export Report",icon:"file_download",color:"warn",tooltip:"Export Report"},{id:"refresh-data",label:"Refresh Data",icon:"refresh",color:"primary",tooltip:"Refresh Data",loading:!1}],onActionClick:t=>{switch(console.log("Quick action clicked:",t),t.id){case"add-transaction":break;case"export-report":break;case"refresh-data":break}},onMainButtonClick:()=>{console.log("Main FAB clicked")}},this.keyMetricsConfig={title:"",subtitle:"",currency:"INR",showHeaderIcon:!1,columns:3,cardsPerRow:{xs:1,sm:2,md:3,lg:5,xl:6},showPeriod:!1}}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=Re({type:i,selectors:[["app-home"]],decls:17,vars:6,consts:[[1,"grid","grid-cols-1","gap-4","sm:grid-cols-2","sm:gap-6","lg:grid-cols-12","lg:gap-6","xl:gap-8"],[1,"col-span-1","sm:hidden"],[1,"col-span-1","sm:col-span-2","lg:col-span-12"],[3,"config"],[1,"col-span-1","sm:col-span-1","lg:col-span-4"],[1,"col-span-1","sm:col-span-2","lg:col-span-4"],[1,"col-span-1","sm:col-span-1","lg:col-span-7"],[3,"isHomeView"],[1,"col-span-1","sm:col-span-1","lg:col-span-5"]],template:function(r,a){r&1&&(s(0,"section",0)(1,"div",1),re(2,"calendar-view"),c(),s(3,"div",2),re(4,"app-key-metrics-summary-card",3),c(),s(5,"div",4),re(6,"app-top-categories-card",3),c(),s(7,"div",4),re(8,"app-recent-activity-card",3),c(),s(9,"div",5),re(10,"app-category-breakdown-card",3),c(),s(11,"div",6),re(12,"app-budget-card",7),c(),s(13,"div",8),re(14,"app-account-summary-card"),c(),s(15,"div",2),re(16,"app-monthly-trends-card",3),c()()),r&2&&(u(4),P("config",a.keyMetricsConfig),u(2),P("config",a.topCategoriesConfig),u(2),P("config",a.recentActivityConfig),u(2),P("config",a.categoryBreakdownConfig),u(2),P("isHomeView",!0),u(4),P("config",a.monthlyTrendsConfig))},dependencies:[rm,im,Rc,Xc,Kc,Zc,Qc,rg]});let e=i;return e})();var r5=(e,i)=>i.month,TC=(e,i)=>i.name;function a5(e,i){e&1&&(s(0,"div",7)(1,"div",8)(2,"div",9),re(3,"div",10),c(),s(4,"h3",11),d(5,"Loading Financial Data"),c(),s(6,"p",12),d(7,"Please wait while we prepare your reports..."),c()()())}function o5(e,i){e&1&&(s(0,"mat-icon",80),d(1,"check"),c())}function s5(e,i){if(e&1){let n=ue();s(0,"button",38),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.onChartTypeChange(r))}),s(1,"mat-icon",39),d(2),c(),s(3,"span",39),d(4),c(),N(5,o5,2,0,"mat-icon",80),c()}if(e&2){let n=i.$implicit,t=v(2);ze("bg-blue-50",t.selectedChartType===n),u(2),L(n==="pie"?"pie_chart":n==="bar"?"bar_chart":n==="line"?"show_chart":n==="area"?"area_chart":n==="radar"?"radar":n==="funnel"?"filter_alt":n==="scatter"?"scatter_plot":"grid_on"),u(2),L(n.charAt(0).toUpperCase()+n.slice(1)),u(),we(t.selectedChartType===n?5:-1)}}function c5(e,i){e&1&&(s(0,"mat-icon",81),d(1,"check"),c())}function l5(e,i){if(e&1){let n=ue();s(0,"button",38),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.onAnalyticsViewChange(r))}),s(1,"mat-icon",39),d(2),c(),s(3,"span",39),d(4),c(),N(5,c5,2,0,"mat-icon",81),c()}if(e&2){let n=i.$implicit,t=v(2);ze("bg-green-50",t.selectedAnalyticsView===n),u(2),L(n==="overview"?"dashboard":n==="trends"?"trending_up":n==="categories"?"category":n==="accounts"?"account_balance":n==="comparison"?"compare":"timeline"),u(2),L(n.charAt(0).toUpperCase()+n.slice(1)),u(),we(t.selectedAnalyticsView===n?5:-1)}}function d5(e,i){if(e&1&&(s(0,"mat-option",97),d(1),c()),e&2){let n=i.$implicit;P("value",n.name),u(),L(n.name)}}function m5(e,i){if(e&1&&(s(0,"mat-option",97),d(1),c()),e&2){let n=i.$implicit;P("value",n.name),u(),L(n.name)}}function g5(e,i){if(e&1){let n=ue();s(0,"div",82)(1,"div",83)(2,"div",84)(3,"div",85)(4,"mat-icon",50),d(5,"filter_list"),c()(),s(6,"div")(7,"h3",86),d(8,"Quick Filters"),c(),s(9,"p",87),d(10,"Filter your financial data"),c()()(),s(11,"button",88),F("click",function(){R(n);let r=v(2);return B(r.toggleQuickFilters())}),s(12,"mat-icon"),d(13,"expand_less"),c()()(),s(14,"div",89)(15,"div")(16,"label",90),d(17,"Date Range"),c(),s(18,"mat-form-field",91)(19,"mat-select")(20,"mat-option",92),d(21,"Last 7 days"),c(),s(22,"mat-option",93),d(23,"Last 30 days"),c(),s(24,"mat-option",94),d(25,"Last 3 months"),c(),s(26,"mat-option",95),d(27,"Last year"),c()()()(),s(28,"div")(29,"label",90),d(30,"Category"),c(),s(31,"mat-form-field",91)(32,"mat-select")(33,"mat-option",96),d(34,"All Categories"),c(),Ge(35,d5,2,2,"mat-option",97,TC),c()()(),s(37,"div")(38,"label",90),d(39,"Account"),c(),s(40,"mat-form-field",91)(41,"mat-select")(42,"mat-option",96),d(43,"All Accounts"),c(),Ge(44,m5,2,2,"mat-option",97,TC),c()()(),s(46,"div")(47,"label",90),d(48,"Transaction Type"),c(),s(49,"mat-form-field",91)(50,"mat-select")(51,"mat-option",96),d(52,"All Types"),c(),s(53,"mat-option",98),d(54,"Income"),c(),s(55,"mat-option",99),d(56,"Expense"),c()()()()(),s(57,"div",100)(58,"button",101),F("click",function(){R(n);let r=v(2);return B(r.toggleQuickFilters())}),d(59," Cancel "),c(),s(60,"button",102),F("click",function(){R(n);let r=v(2);return B(r.applyFilters())}),d(61," Apply Filters "),c()()()}if(e&2){let n=v(2);u(35),He(n.categories),u(9),He(n.accounts)}}function u5(e,i){if(e&1){let n=ue();s(0,"div",103)(1,"button",104),F("click",function(){R(n);let r=v(2);return B(r.toggleQuickFilters())}),s(2,"mat-icon"),d(3,"filter_list"),c(),s(4,"span"),d(5,"Show Filters"),c()()()}}function p5(e,i){if(e&1&&(s(0,"div",89)(1,"div",105)(2,"div",106)(3,"div",18)(4,"p",107),d(5,"Avg Daily Spending"),c(),s(6,"p",108),d(7),c()(),s(8,"div",109)(9,"mat-icon",110),d(10,"schedule"),c()()()(),s(11,"div",111)(12,"div",106)(13,"div",18)(14,"p",112),d(15,"Avg Monthly Spending"),c(),s(16,"p",113),d(17),c()(),s(18,"div",114)(19,"mat-icon",115),d(20,"calendar_month"),c()()()(),s(21,"div",116)(22,"div",106)(23,"div",18)(24,"p",117),d(25,"Savings Rate"),c(),s(26,"p",118),d(27),c()(),s(28,"div",119)(29,"mat-icon",120),d(30,"trending_up"),c()()()(),s(31,"div",121)(32,"div",106)(33,"div",18)(34,"p",122),d(35,"Expense Growth"),c(),s(36,"p",123),d(37),c()(),s(38,"div",124)(39,"mat-icon",125),d(40,"analytics"),c()()()()()),e&2){let n=v(2);u(7),L(n.formatCurrency(n.averageDailySpending)),u(10),L(n.formatCurrency(n.averageMonthlySpending)),u(10),ne("",n.savingsRate.toFixed(1),"%"),u(9),P("ngClass",n.expenseGrowthRate>=0?"text-rose-600":"text-green-600"),u(),$t(" ",n.expenseGrowthRate>=0?"+":"","",n.expenseGrowthRate.toFixed(1),"% ")}}function f5(e,i){if(e&1&&(s(0,"div",60)(1,"span",63),d(2),c(),s(3,"span",126),d(4),c()()),e&2){let n=i.$implicit,t=v(2);u(2),L(n.month),u(2),L(t.formatCurrency(n.savings))}}function h5(e,i){if(e&1){let n=ue();s(0,"div",82)(1,"div",83)(2,"div",84)(3,"div",127)(4,"mat-icon",70),d(5,"file_download"),c()(),s(6,"div")(7,"h3",86),d(8,"Export Options"),c(),s(9,"p",87),d(10,"Export your financial reports"),c()()(),s(11,"button",88),F("click",function(){R(n);let r=v(2);return B(r.toggleExportOptions())}),s(12,"mat-icon"),d(13,"expand_less"),c()()(),s(14,"div",89)(15,"div")(16,"label",90),d(17,"Export Format"),c(),s(18,"mat-form-field",91)(19,"mat-select",128),lt("ngModelChange",function(r){R(n);let a=v(2);return ct(a.userPreferences.exportFormat,r)||(a.userPreferences.exportFormat=r),B(r)}),s(20,"mat-option",129),d(21,"PDF Report"),c(),s(22,"mat-option",130),d(23,"Excel Spreadsheet"),c(),s(24,"mat-option",131),d(25,"CSV Data"),c(),s(26,"mat-option",132),d(27,"JSON Data"),c()()()(),s(28,"div")(29,"label",90),d(30,"Date Range"),c(),s(31,"mat-form-field",91)(32,"mat-select")(33,"mat-option",133),d(34,"Current Month"),c(),s(35,"mat-option",134),d(36,"Last 3 Months"),c(),s(37,"mat-option",135),d(38,"Last 6 Months"),c(),s(39,"mat-option",136),d(40,"Last 12 Months"),c(),s(41,"mat-option",137),d(42,"Custom Range"),c()()()(),s(43,"div")(44,"label",90),d(45,"Include Charts"),c(),s(46,"mat-slide-toggle",138),d(47,"Include Visualizations"),c()(),s(48,"div",139)(49,"button",140),F("click",function(){R(n);let r=v(2);return B(r.exportReport())}),s(50,"mat-icon",141),d(51,"download"),c(),d(52," Export Report "),c()()(),s(53,"div",100)(54,"button",101),F("click",function(){R(n);let r=v(2);return B(r.toggleExportOptions())}),d(55," Cancel "),c(),s(56,"button",142),F("click",function(){R(n);let r=v(2);return B(r.generateReport())}),s(57,"mat-icon",141),d(58,"description"),c(),d(59," Generate Report "),c()()()}if(e&2){let n=v(2);u(19),st("ngModel",n.userPreferences.exportFormat)}}function _5(e,i){if(e&1){let n=ue();s(0,"div",103)(1,"button",104),F("click",function(){R(n);let r=v(2);return B(r.toggleExportOptions())}),s(2,"mat-icon"),d(3,"file_download"),c(),s(4,"span"),d(5,"Export Options"),c()()()}}function x5(e,i){if(e&1&&(s(0,"div",143),re(1,"app-monthly-trends-card",14)(2,"app-category-breakdown-card",14),c()),e&2){let n=v(2);u(),P("config",n.monthlyTrendsConfig),u(),P("config",n.categoryBreakdownConfig)}}function C5(e,i){if(e&1){let n=ue();s(0,"div",144)(1,"div",145)(2,"mat-icon",146),d(3,"analytics"),c()(),s(4,"h4",147),d(5,"No Data Available"),c(),s(6,"p",148),d(7," Start adding transactions to see detailed reports and insights about your financial patterns. "),c(),s(8,"button",149),F("click",function(){R(n);let r=v(2);return B(r.addTransaction())}),s(9,"mat-icon"),d(10,"add"),c(),s(11,"span"),d(12,"Add Transaction"),c()()()}}function v5(e,i){if(e&1){let n=ue();s(0,"div",13),re(1,"app-key-metrics-summary-card",14),s(2,"div",15)(3,"div",16)(4,"div",17)(5,"div",18)(6,"h2",19),d(7),c(),s(8,"p",20),d(9,"Interactive financial visualization"),c()(),s(10,"div",21)(11,"mat-button-toggle-group",22),F("change",function(r){R(n);let a=v();return B(a.onPeriodChange(r.value))}),s(12,"mat-button-toggle",23),d(13,"D"),c(),s(14,"mat-button-toggle",24),d(15,"W"),c(),s(16,"mat-button-toggle",25),d(17,"M"),c(),s(18,"mat-button-toggle",26),d(19,"Y"),c()(),s(20,"button",27)(21,"mat-icon"),d(22),c()(),s(23,"mat-menu",28,0)(25,"div",29)(26,"div",30),d(27,"Chart Type"),c(),Ge(28,s5,6,5,"button",31,rr),c()(),s(30,"button",32)(31,"mat-icon"),d(32,"analytics"),c()(),s(33,"mat-menu",33,1)(35,"div",29)(36,"div",30),d(37,"Analytics View"),c(),Ge(38,l5,6,5,"button",34,rr),c()(),s(40,"button",35),F("click",function(){R(n);let r=v();return B(r.toggleAdvancedAnalytics())}),s(41,"mat-icon"),d(42),c()(),s(43,"button",36)(44,"mat-icon"),d(45,"more_vert"),c()(),s(46,"mat-menu",37,2)(48,"button",38),F("click",function(){R(n);let r=v();return B(r.openPreferencesDialog())}),s(49,"mat-icon",39),d(50,"settings"),c(),s(51,"span",39),d(52,"Preferences"),c()(),s(53,"button",40),F("click",function(){R(n);let r=v();return B(r.refreshData())}),s(54,"mat-icon",39),d(55,"refresh"),c(),s(56,"span",39),d(57),c()(),s(58,"button",38),F("click",function(){R(n);let r=v();return B(r.toggleHelpTooltip())}),s(59,"mat-icon",39),d(60,"help_outline"),c(),s(61,"span",39),d(62,"Help"),c()(),re(63,"mat-divider"),s(64,"button",38),F("click",function(){R(n);let r=v();return B(r.toggleQuickFilters())}),s(65,"mat-icon",39),d(66,"filter_list"),c(),s(67,"span",39),d(68),c()(),s(69,"button",38),F("click",function(){R(n);let r=v();return B(r.toggleExportOptions())}),s(70,"mat-icon",39),d(71,"file_download"),c(),s(72,"span",39),d(73),c()()()()()(),s(74,"div",41)(75,"div",42),re(76,"div",43),c()()(),s(77,"div",44)(78,"div",45),re(79,"app-analytics-summary-card",14),c(),s(80,"div",46)(81,"mat-card",47)(82,"div",41)(83,"div",48)(84,"div",18)(85,"h3",19),d(86,"Quick Actions"),c(),s(87,"p",20),d(88,"Common tasks"),c()(),s(89,"div",49)(90,"mat-icon",50),d(91,"bolt"),c()()(),s(92,"div",51)(93,"button",52),F("click",function(){R(n);let r=v();return B(r.addTransaction())}),s(94,"mat-icon",53),d(95,"add"),c(),d(96," Add Transaction "),c(),s(97,"button",52),F("click",function(){R(n);let r=v();return B(r.exportReport())}),s(98,"mat-icon",53),d(99,"file_download"),c(),d(100," Export Report "),c(),s(101,"button",54),F("click",function(){R(n);let r=v();return B(r.refreshData())}),s(102,"mat-icon",53),d(103,"refresh"),c(),d(104),c(),s(105,"button",52),F("click",function(){R(n);let r=v();return B(r.toggleQuickFilters())}),s(106,"mat-icon",53),d(107,"filter_list"),c(),d(108),c(),s(109,"button",52),F("click",function(){R(n);let r=v();return B(r.openPreferencesDialog())}),s(110,"mat-icon",53),d(111,"settings"),c(),d(112," Preferences "),c()()()()()(),N(113,g5,62,0,"div",55)(114,u5,6,0,"div",56)(115,p5,41,6,"div",57),s(116,"div",58)(117,"mat-card",15)(118,"div",41)(119,"div",48)(120,"div",18)(121,"h3",19),d(122,"Spending Overview"),c(),s(123,"p",20),d(124,"Your financial summary"),c()(),s(125,"div",49)(126,"mat-icon",50),d(127,"pie_chart"),c()()(),s(128,"div",59)(129,"div",60)(130,"div",61),re(131,"div",62),s(132,"span",63),d(133,"Total Income"),c()(),s(134,"span",64),d(135),c()(),s(136,"div",60)(137,"div",61),re(138,"div",65),s(139,"span",63),d(140,"Total Expenses"),c()(),s(141,"span",66),d(142),c()(),s(143,"div",60)(144,"div",61),re(145,"div",67),s(146,"span",63),d(147,"Net Savings"),c()(),s(148,"span",68),d(149),c()()()()(),s(150,"mat-card",15)(151,"div",41)(152,"div",48)(153,"div",18)(154,"h3",19),d(155,"Monthly Trends"),c(),s(156,"p",20),d(157,"Compare monthly performance"),c()(),s(158,"div",69)(159,"mat-icon",70),d(160,"trending_up"),c()()(),s(161,"div",59),Ge(162,f5,5,2,"div",60,r5),s(164,"div",71)(165,"span",72),d(166,"Change"),c(),s(167,"span",64),d(168),c()()()()(),re(169,"app-top-categories-card",14)(170,"app-recent-activity-card",14),c(),N(171,h5,60,1,"div",55)(172,_5,6,0,"div",56),s(173,"mat-card",15)(174,"div",41)(175,"div",73)(176,"div",18)(177,"h3",74),d(178,"Detailed Analysis"),c(),s(179,"p",20),d(180,"Deep dive into your financial data"),c()(),s(181,"div",75)(182,"button",76),F("click",function(){R(n);let r=v();return B(r.onPeriodChange("daily"))}),d(183," Daily "),c(),s(184,"button",76),F("click",function(){R(n);let r=v();return B(r.onPeriodChange("weekly"))}),d(185," Weekly "),c(),s(186,"button",77),F("click",function(){R(n);let r=v();return B(r.onPeriodChange("monthly"))}),d(187," Monthly "),c(),s(188,"button",76),F("click",function(){R(n);let r=v();return B(r.onPeriodChange("yearly"))}),d(189," Yearly "),c()()(),N(190,x5,3,2,"div",78)(191,C5,13,0,"div",79),c()()()}if(e&2){let n=bn(24),t=bn(34),r=bn(47),a=v();u(),P("config",a.keyMetricsConfig),u(6),L(a.getChartTitle()),u(4),P("value",a.selectedPeriod),u(9),P("matMenuTriggerFor",n),u(2),L(a.selectedChartType==="pie"?"pie_chart":a.selectedChartType==="bar"?"bar_chart":a.selectedChartType==="line"?"show_chart":a.selectedChartType==="area"?"area_chart":a.selectedChartType==="radar"?"radar":a.selectedChartType==="funnel"?"filter_alt":a.selectedChartType==="scatter"?"scatter_plot":"grid_on"),u(6),He(a.availableChartTypes),u(2),P("matMenuTriggerFor",t),u(8),He(a.availableAnalyticsViews),u(2),ze("text-purple-600",a.showAdvancedAnalytics)("text-gray-600",!a.showAdvancedAnalytics),P("matTooltip",a.showAdvancedAnalytics?"Switch to Basic":"Switch to Advanced"),u(2),L(a.showAdvancedAnalytics?"visibility_off":"visibility"),u(),P("matMenuTriggerFor",r),u(10),P("disabled",a.isRefreshing),u(),ze("animate-spin",a.isRefreshing),u(3),L(a.isRefreshing?"Refreshing...":"Refresh Data"),u(11),ne("",a.showQuickFilters?"Hide":"Show"," Filters"),u(5),ne("",a.showExportOptions?"Hide":"Show"," Export"),u(2),P("ngClass",a.getChartHeight()),u(),P("options",a.getCurrentChartOption()),u(3),P("config",a.analyticsSummaryConfig),u(22),P("disabled",a.isRefreshing),u(),ze("animate-spin",a.isRefreshing),u(2),ne(" ",a.isRefreshing?"Refreshing...":"Refresh Data"," "),u(4),ne(" ",a.showQuickFilters?"Hide":"Show"," Filters "),u(5),P("ngIf",a.showQuickFilters),u(),P("ngIf",!a.showQuickFilters),u(),P("ngIf",a.showAdvancedAnalytics),u(20),L(a.formatCurrency(a.totalIncome)),u(7),L(a.formatCurrency(a.totalExpenses)),u(7),L(a.formatCurrency(a.netSavings)),u(13),He(a.monthlyTrends.slice(-2)),u(6),L(a.getMonthlyChangeDisplay()),u(),P("config",a.topCategoriesConfig),u(),P("config",a.recentActivityConfig),u(),P("ngIf",a.showExportOptions),u(),P("ngIf",!a.showExportOptions),u(10),ze("bg-blue-50",a.selectedPeriod==="daily"),u(2),ze("bg-blue-50",a.selectedPeriod==="weekly"),u(2),ze("bg-blue-600",a.selectedPeriod==="monthly"),u(2),ze("bg-blue-50",a.selectedPeriod==="yearly"),u(2),P("ngIf",a.hasData),u(),P("ngIf",!a.hasData)}}function b5(e,i){if(e&1&&(s(0,"mat-option",97),d(1),c()),e&2){let n=i.$implicit;P("value",n),u(),ne(" ",n.charAt(0).toUpperCase()+n.slice(1)," ")}}function y5(e,i){if(e&1&&(s(0,"mat-option",97),d(1),c()),e&2){let n=i.$implicit;P("value",n),u(),ne(" ",n.charAt(0).toUpperCase()+n.slice(1)," ")}}function M5(e,i){if(e&1){let n=ue();s(0,"div")(1,"label",90),d(2,"Email Frequency"),c(),s(3,"mat-form-field",91)(4,"mat-select",128),lt("ngModelChange",function(r){R(n);let a=v(2);return ct(a.userPreferences.emailFrequency,r)||(a.userPreferences.emailFrequency=r),B(r)}),s(5,"mat-option",160),d(6,"Daily"),c(),s(7,"mat-option",161),d(8,"Weekly"),c(),s(9,"mat-option",162),d(10,"Monthly"),c(),s(11,"mat-option",179),d(12,"Never"),c()()()()}if(e&2){let n=v(2);u(4),st("ngModel",n.userPreferences.emailFrequency)}}function P5(e,i){if(e&1){let n=ue();s(0,"div",150)(1,"div",151)(2,"div",152)(3,"div",106)(4,"h2",153),d(5,"Analytics Preferences"),c(),s(6,"button",154),F("click",function(){R(n);let r=v();return B(r.closePreferencesDialog())}),s(7,"mat-icon"),d(8,"close"),c()()(),s(9,"p",155),d(10,"Customize your analytics dashboard experience"),c()(),s(11,"div",156)(12,"div",157)(13,"div")(14,"h3",158),d(15,"Default Settings"),c(),s(16,"div",159)(17,"div")(18,"label",90),d(19,"Default Chart Type"),c(),s(20,"mat-form-field",91)(21,"mat-select",128),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.defaultChartType,r)||(a.userPreferences.defaultChartType=r),B(r)}),Ge(22,b5,2,2,"mat-option",97,rr),c()()(),s(24,"div")(25,"label",90),d(26,"Default Analytics View"),c(),s(27,"mat-form-field",91)(28,"mat-select",128),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.defaultAnalyticsView,r)||(a.userPreferences.defaultAnalyticsView=r),B(r)}),Ge(29,y5,2,2,"mat-option",97,rr),c()()(),s(31,"div")(32,"label",90),d(33,"Default Period"),c(),s(34,"mat-form-field",91)(35,"mat-select",128),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.defaultPeriod,r)||(a.userPreferences.defaultPeriod=r),B(r)}),s(36,"mat-option",160),d(37,"Daily"),c(),s(38,"mat-option",161),d(39,"Weekly"),c(),s(40,"mat-option",162),d(41,"Monthly"),c(),s(42,"mat-option",163),d(43,"Yearly"),c()()()()()(),s(44,"div")(45,"h3",158),d(46,"Display Options"),c(),s(47,"div",159)(48,"div")(49,"label",90),d(50,"Chart Height"),c(),s(51,"mat-form-field",91)(52,"mat-select",128),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.chartHeight,r)||(a.userPreferences.chartHeight=r),B(r)}),s(53,"mat-option",164),d(54,"Small"),c(),s(55,"mat-option",165),d(56,"Medium"),c(),s(57,"mat-option",166),d(58,"Large"),c()()()(),s(59,"div")(60,"label",90),d(61,"Currency Format"),c(),s(62,"mat-form-field",91)(63,"mat-select",128),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.currencyFormat,r)||(a.userPreferences.currencyFormat=r),B(r)}),s(64,"mat-option",167),d(65,"Indian Rupee (\u20B9)"),c(),s(66,"mat-option",168),d(67,"US Dollar ($)"),c(),s(68,"mat-option",169),d(69,"Euro (\u20AC)"),c()()()(),s(70,"div")(71,"label",90),d(72,"Date Format"),c(),s(73,"mat-form-field",91)(74,"mat-select",128),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.dateFormat,r)||(a.userPreferences.dateFormat=r),B(r)}),s(75,"mat-option",170),d(76,"DD/MM/YYYY"),c(),s(77,"mat-option",171),d(78,"MM/DD/YYYY"),c(),s(79,"mat-option",172),d(80,"YYYY-MM-DD"),c()()()()()()(),s(81,"div")(82,"h3",158),d(83,"Chart Options"),c(),s(84,"div",157)(85,"div",159)(86,"mat-slide-toggle",173),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.showTooltips,r)||(a.userPreferences.showTooltips=r),B(r)}),d(87," Show Tooltips "),c(),s(88,"mat-slide-toggle",173),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.showAnimations,r)||(a.userPreferences.showAnimations=r),B(r)}),d(89," Show Animations "),c(),s(90,"mat-slide-toggle",173),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.showAdvancedAnalytics,r)||(a.userPreferences.showAdvancedAnalytics=r),B(r)}),d(91," Show Advanced Analytics "),c()(),s(92,"div",159)(93,"div")(94,"label",90),d(95,"Refresh Interval (minutes)"),c(),s(96,"mat-form-field",91)(97,"input",174),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.refreshInterval,r)||(a.userPreferences.refreshInterval=r),B(r)}),c()()(),s(98,"div")(99,"label",90),d(100,"Export Format"),c(),s(101,"mat-form-field",91)(102,"mat-select",128),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.exportFormat,r)||(a.userPreferences.exportFormat=r),B(r)}),s(103,"mat-option",129),d(104,"PDF"),c(),s(105,"mat-option",130),d(106,"Excel"),c(),s(107,"mat-option",131),d(108,"CSV"),c(),s(109,"mat-option",132),d(110,"JSON"),c()()()()()()(),s(111,"div")(112,"h3",158),d(113,"Email Reports"),c(),s(114,"div",157)(115,"mat-slide-toggle",173),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.userPreferences.emailReports,r)||(a.userPreferences.emailReports=r),B(r)}),d(116," Enable Email Reports "),c(),N(117,M5,13,1,"div",175),c()()(),s(118,"div",176)(119,"button",177),F("click",function(){R(n);let r=v();return B(r.resetPreferences())}),d(120," Reset to Default "),c(),s(121,"div",178)(122,"button",101),F("click",function(){R(n);let r=v();return B(r.closePreferencesDialog())}),d(123," Cancel "),c(),s(124,"button",102),F("click",function(){R(n);let r=v();return r.savePreferences(),B(r.closePreferencesDialog())}),d(125," Save Preferences "),c()()()()()}if(e&2){let n=v();u(21),st("ngModel",n.userPreferences.defaultChartType),u(),He(n.availableChartTypes),u(6),st("ngModel",n.userPreferences.defaultAnalyticsView),u(),He(n.availableAnalyticsViews),u(6),st("ngModel",n.userPreferences.defaultPeriod),u(17),st("ngModel",n.userPreferences.chartHeight),u(11),st("ngModel",n.userPreferences.currencyFormat),u(11),st("ngModel",n.userPreferences.dateFormat),u(12),st("ngModel",n.userPreferences.showTooltips),u(2),st("ngModel",n.userPreferences.showAnimations),u(2),st("ngModel",n.userPreferences.showAdvancedAnalytics),u(7),st("ngModel",n.userPreferences.refreshInterval),u(5),st("ngModel",n.userPreferences.exportFormat),u(13),st("ngModel",n.userPreferences.emailReports),u(2),P("ngIf",n.userPreferences.emailReports)}}function O5(e,i){if(e&1){let n=ue();s(0,"div",150)(1,"div",180)(2,"div",152)(3,"div",106)(4,"h2",153),d(5,"Analytics Help"),c(),s(6,"button",154),F("click",function(){R(n);let r=v();return B(r.toggleHelpTooltip())}),s(7,"mat-icon"),d(8,"close"),c()()()(),s(9,"div",181)(10,"div")(11,"h3",11),d(12,"Chart Types"),c(),s(13,"div",182)(14,"p")(15,"strong"),d(16,"Pie Chart:"),c(),d(17," Shows spending breakdown by category"),c(),s(18,"p")(19,"strong"),d(20,"Bar Chart:"),c(),d(21," Displays monthly financial trends"),c(),s(22,"p")(23,"strong"),d(24,"Line Chart:"),c(),d(25," Shows trends over time with smooth curves"),c(),s(26,"p")(27,"strong"),d(28,"Area Chart:"),c(),d(29," Displays daily spending patterns"),c(),s(30,"p")(31,"strong"),d(32,"Radar Chart:"),c(),d(33," Compares category performance"),c(),s(34,"p")(35,"strong"),d(36,"Funnel Chart:"),c(),d(37," Shows spending funnel analysis"),c(),s(38,"p")(39,"strong"),d(40,"Scatter Chart:"),c(),d(41," Shows income vs expenses correlation"),c(),s(42,"p")(43,"strong"),d(44,"Heatmap:"),c(),d(45," Displays weekly spending patterns"),c()()(),s(46,"div")(47,"h3",11),d(48,"Analytics Views"),c(),s(49,"div",182)(50,"p")(51,"strong"),d(52,"Overview:"),c(),d(53," General financial summary"),c(),s(54,"p")(55,"strong"),d(56,"Trends:"),c(),d(57," Historical data analysis"),c(),s(58,"p")(59,"strong"),d(60,"Categories:"),c(),d(61," Category-wise breakdown"),c(),s(62,"p")(63,"strong"),d(64,"Accounts:"),c(),d(65," Account-specific data"),c(),s(66,"p")(67,"strong"),d(68,"Comparison:"),c(),d(69," Period-over-period analysis"),c(),s(70,"p")(71,"strong"),d(72,"Forecast:"),c(),d(73," Future predictions"),c()()(),s(74,"div")(75,"h3",11),d(76,"Tips"),c(),s(77,"div",182)(78,"p"),d(79,"\u2022 Use different chart types to view data from various perspectives"),c(),s(80,"p"),d(81,"\u2022 Switch between time periods to analyze trends"),c(),s(82,"p"),d(83,"\u2022 Enable advanced analytics for detailed insights"),c(),s(84,"p"),d(85,"\u2022 Customize preferences to match your workflow"),c(),s(86,"p"),d(87,"\u2022 Export reports for sharing or offline analysis"),c()()()(),s(88,"div",183)(89,"button",140),F("click",function(){R(n);let r=v();return B(r.toggleHelpTooltip())}),d(90," Got it! "),c()()()()}}var ag=(()=>{let i=class i{constructor(t,r,a,o,l,m){this.router=t,this.auth=r,this.notificationService=a,this.store=o,this.dateService=l,this.ssrService=m,this.totalIncome=0,this.totalExpenses=0,this.netSavings=0,this.monthlyChange=0,this.monthlyChangePercentage=0,this.keyMetricsConfig={title:"",subtitle:"",showHeaderIcon:!1,currency:"INR",showTrends:!0,showIcons:!0,showPeriod:!0,cardHeight:"medium",layout:"grid",columns:2,theme:"auto",animations:!0,clickable:!0,onMetricClick:g=>this.onMetricClick(g)},this.analyticsSummaryConfig={title:"Analytics Summary",subtitle:"Key insights and trends",currency:"INR",showHeaderIcon:!0,headerIcon:"insights",showFooter:!1,cardHeight:"medium",theme:"auto",animations:!0,clickable:!0,loading:!1,maxItems:{categoryTrends:3,spendingTrends:3,accountBalances:3},onCategoryClick:g=>this.onCategoryTrendClick(g),onSpendingClick:g=>this.onSpendingTrendClick(g),onAccountClick:g=>this.onAccountBalanceClick(g)},this.topCategoriesConfig={title:"Top Spending Categories",subtitle:"Your highest expense areas",currency:"INR",showHeaderIcon:!0,headerIcon:"category",headerIconColor:"purple",showFooter:!1,cardHeight:"medium",theme:"auto",animations:!0,clickable:!0,loading:!1,maxItems:5,period:"monthly",transactionType:"expense",onCategoryClick:g=>{console.log("Top category clicked:",g)},onRefresh:()=>{this.refreshData()}},this.recentActivityConfig={title:"Recent Activity",subtitle:"Latest transactions",currency:"INR",showHeaderIcon:!0,headerIcon:"schedule",headerIconColor:"orange",showFooter:!1,cardHeight:"medium",theme:"auto",animations:!0,clickable:!0,loading:!1,maxItems:5,period:"monthly",transactionType:"all",onTransactionClick:g=>{console.log("Transaction clicked:",g)},onRefresh:()=>{this.refreshData()}},this.monthlyTrendsConfig={title:"Monthly Trends",subtitle:"Compare monthly performance",currency:"INR",showHeaderIcon:!0,headerIcon:"trending_up",headerIconColor:"green",showFooter:!1,cardHeight:"medium",theme:"auto",animations:!0,clickable:!0,loading:!1,maxItems:6,period:"monthly",transactionType:"all",showIncome:!0,showExpenses:!0,showSavings:!0,showChange:!0,layout:"grid",onMonthClick:g=>{console.log("Month clicked:",g)},onRefresh:()=>{this.refreshData()}},this.categoryBreakdownConfig={title:"Category Breakdown",subtitle:"Spending by category",currency:"INR",showHeaderIcon:!0,headerIcon:"category",headerIconColor:"blue",showFooter:!1,cardHeight:"medium",theme:"auto",animations:!0,clickable:!0,loading:!1,maxItems:8,period:"monthly",transactionType:"expense",showProgressBar:!0,showPercentage:!0,showCount:!1,showAverage:!1,layout:"list",onCategoryClick:g=>{console.log("Category clicked:",g)},onRefresh:()=>{this.refreshData()}},this.quickActionsFabConfig={title:"Quick Actions",mainButtonIcon:"add",mainButtonColor:"primary",mainButtonTooltip:"Quick Actions",showLabels:!1,animations:!0,autoHide:!1,autoHideDelay:3e3,theme:"auto",actions:[{id:"add-transaction",label:"Add Transaction",icon:"receipt",color:"accent",tooltip:"Add Transaction"},{id:"export-report",label:"Export Report",icon:"file_download",color:"warn",tooltip:"Export Report"},{id:"refresh-data",label:"Refresh Data",icon:"refresh",color:"primary",tooltip:"Refresh Data",loading:!1}],onActionClick:g=>{switch(console.log("Quick action clicked:",g),g.id){case"add-transaction":this.addTransaction();break;case"export-report":this.exportReport();break;case"refresh-data":this.refreshData();break}},onMainButtonClick:()=>{console.log("Main FAB clicked")}},this.transactions=[],this.accounts=[],this.categories=[],this.topCategories=[],this.recentTransactions=[],this.monthlyTrends=[],this.dailyData=[],this.weeklyData=[],this.yearlyData=[],this.accountBalances=[],this.spendingTrends=[],this.categoryTrends=[],this.averageDailySpending=0,this.averageMonthlySpending=0,this.savingsRate=0,this.expenseGrowthRate=0,this.incomeGrowthRate=0,this.selectedPeriod="monthly",this.selectedChartType="pie",this.selectedAnalyticsView="overview",this.showAdvancedAnalytics=!1,this.availableChartTypes=["pie","bar","line","area","radar","funnel","scatter","heatmap"],this.availableAnalyticsViews=["overview","trends","categories","accounts","comparison","forecast"],this.isLoading=!0,this.hasData=!1,this.pieChartOption={},this.barChartOption={},this.lineChartOption={},this.areaChartOption={},this.radarChartOption={},this.funnelChartOption={},this.scatterChartOption={},this.heatmapChartOption={},this.isDarkMode=!1,this.userPreferences={defaultChartType:"pie",defaultAnalyticsView:"overview",defaultPeriod:"monthly",showAdvancedAnalytics:!1,chartHeight:"medium",refreshInterval:5,currencyFormat:"INR",dateFormat:"DD/MM/YYYY",theme:"auto",showTooltips:!0,showAnimations:!0,exportFormat:"pdf",emailReports:!1,emailFrequency:"never"},this.showPreferencesDialog=!1,this.showQuickFilters=!1,this.showExportOptions=!1,this.showHelpTooltip=!1,this.showQuickActions=!1,this.isRefreshing=!1,this.subscriptions=[],this.transactions$=this.store.select(Gn),this.accounts$=this.store.select(ca),this.categories$=this.store.select(un),this.transactionsLoading$=this.store.select(la),this.accountsLoading$=this.store.select(tm),this.categoriesLoading$=this.store.select(Nr)}ngOnInit(){this.loadPreferences(),this.detectTheme(),this.loadData()}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}loadData(){if(!this.auth.currentUser){this.isLoading=!1,this.notificationService.error("User not authenticated");return}let r=this.transactions$.subscribe(l=>{this.transactions=l,this.calculateFinancialMetrics(),this.calculateTopCategories(),this.getRecentTransactions(),this.calculateMonthlyTrends(),this.calculateEnhancedAnalytics(),this.updateCharts(),this.isLoading=!1,this.hasData=this.transactions.length>0}),a=this.accounts$.subscribe(l=>{this.accounts=l}),o=this.categories$.subscribe(l=>{this.categories=l});this.subscriptions.push(r,a,o)}calculateFinancialMetrics(){let t=new Date,r=t.getMonth(),a=t.getFullYear(),o=r===0?11:r-1,l=r===0?a-1:a,m=this.transactions.filter(C=>{let y=this.dateService.toDate(C.date);return(y==null?void 0:y.getMonth())===r&&(y==null?void 0:y.getFullYear())===a}),g=this.transactions.filter(C=>{let y=this.dateService.toDate(C.date);return(y==null?void 0:y.getMonth())===o&&(y==null?void 0:y.getFullYear())===l});this.totalIncome=m.filter(C=>C.type==="income").reduce((C,y)=>C+y.amount,0),this.totalExpenses=m.filter(C=>C.type==="expense").reduce((C,y)=>C+y.amount,0),this.netSavings=this.totalIncome-this.totalExpenses;let f=g.filter(C=>C.type==="income").reduce((C,y)=>C+y.amount,0),h=g.filter(C=>C.type==="expense").reduce((C,y)=>C+y.amount,0),x=f-h;this.monthlyChange=this.netSavings-x,this.monthlyChangePercentage=x!==0?this.monthlyChange/x*100:0}calculateTopCategories(){let t=new Date().getMonth(),r=new Date().getFullYear(),a=this.transactions.filter(m=>{let g=this.dateService.toDate(m.date);return m.type==="expense"&&(g==null?void 0:g.getMonth())===t&&(g==null?void 0:g.getFullYear())===r}),o=new Map;a.forEach(m=>{let g=o.get(m.categoryId)||0;o.set(m.categoryId,g+m.amount)});let l=this.totalExpenses;this.topCategories=Array.from(o.entries()).map(([m,g])=>{let f=this.categories.find(h=>h.id===m);return{category:(f==null?void 0:f.name)||"Unknown",amount:g,percentage:l>0?g/l*100:0,icon:(f==null?void 0:f.icon)||"category"}}).sort((m,g)=>g.amount-m.amount).slice(0,5)}getRecentTransactions(){this.recentTransactions=this.transactions.sort((t,r)=>{var a,o,l,m;return((o=(a=this.dateService.toDate(r.date))==null?void 0:a.getTime())!=null?o:0)-((m=(l=this.dateService.toDate(t.date))==null?void 0:l.getTime())!=null?m:0)}).slice(0,5)}calculateMonthlyTrends(){let t=new Date,r=[];for(let a=5;a>=0;a--){let o=new Date(t.getFullYear(),t.getMonth()-a,1),l=o.toLocaleDateString(Ut.LANGUAGE.DEFAULT,{month:"short"}),m=this.transactions.filter(h=>{let x=this.dateService.toDate(h.date);return(x==null?void 0:x.getMonth())===o.getMonth()&&(x==null?void 0:x.getFullYear())===o.getFullYear()}),g=m.filter(h=>h.type==="income").reduce((h,x)=>h+x.amount,0),f=m.filter(h=>h.type==="expense").reduce((h,x)=>h+x.amount,0);r.push({month:l,income:g,expenses:f,savings:g-f})}this.monthlyTrends=r}calculateEnhancedAnalytics(){this.calculateDailyData(),this.calculateWeeklyData(),this.calculateYearlyData(),this.calculateAccountBalances(),this.calculateSpendingTrends(),this.calculateCategoryTrends(),this.calculateGrowthRates(),this.populateAnalyticsSummary()}calculateDailyData(){let t=new Date,r=[];for(let a=29;a>=0;a--){let o=new Date(t.getTime()-a*24*60*60*1e3),l=o.toISOString().split("T")[0],m=this.transactions.filter(h=>{let x=this.dateService.toDate(h.date);return(x==null?void 0:x.toDateString())===o.toDateString()}),g=m.filter(h=>h.type==="income").reduce((h,x)=>h+x.amount,0),f=m.filter(h=>h.type==="expense").reduce((h,x)=>h+x.amount,0);r.push({date:l,income:g,expenses:f,savings:g-f})}this.dailyData=r}calculateWeeklyData(){let t=new Date,r=[];for(let a=11;a>=0;a--){let o=new Date(t.getTime()-a*7*24*60*60*1e3),l=new Date(o.getTime()+6*24*60*60*1e3),m=`Week ${Math.ceil((o.getTime()-new Date(o.getFullYear(),0,1).getTime())/(7*24*60*60*1e3))}`,g=this.transactions.filter(x=>{let C=this.dateService.toDate(x.date);return C&&C>=o&&C<=l}),f=g.filter(x=>x.type==="income").reduce((x,C)=>x+C.amount,0),h=g.filter(x=>x.type==="expense").reduce((x,C)=>x+C.amount,0);r.push({week:m,income:f,expenses:h,savings:f-h})}this.weeklyData=r}calculateYearlyData(){let t=new Date,r=[];for(let a=4;a>=0;a--){let o=t.getFullYear()-a,l=o.toString(),m=this.transactions.filter(h=>{let x=this.dateService.toDate(h.date);return(x==null?void 0:x.getFullYear())===o}),g=m.filter(h=>h.type==="income").reduce((h,x)=>h+x.amount,0),f=m.filter(h=>h.type==="expense").reduce((h,x)=>h+x.amount,0);r.push({year:l,income:g,expenses:f,savings:g-f})}this.yearlyData=r}calculateAccountBalances(){let t=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"];this.accountBalances=this.accounts.map((r,a)=>{let l=this.transactions.filter(m=>m.accountId===r.accountId).reduce((m,g)=>m+(g.type==="income"?g.amount:-g.amount),r.balance||0);return r.type==="loan"&&r.loanDetails&&(l=-(r.loanDetails.remainingBalance||0)),{account:r.name,balance:l,color:t[a%t.length]}})}calculateSpendingTrends(){let t=["Last 7 Days","Last 30 Days","Last 3 Months","Last 6 Months","Last Year"],r=[];t.forEach((a,o)=>{let l=[7,30,90,180,365][o],m=new Date,g=new Date(m.getTime()-l*24*60*60*1e3),h=this.transactions.filter(A=>{let E=this.dateService.toDate(A.date);return E&&E>=g&&E<=m}).filter(A=>A.type==="expense").reduce((A,E)=>A+E.amount,0),x=new Date(g.getTime()-l*24*60*60*1e3),y=this.transactions.filter(A=>{let E=this.dateService.toDate(A.date);return E&&E>=x&&E<g}).filter(A=>A.type==="expense").reduce((A,E)=>A+E.amount,0),b=h-y,w=y>0?b/y*100:0;r.push({period:a,amount:h,change:b,percentage:w})}),this.spendingTrends=r}calculateCategoryTrends(){let t=new Date,r=t.getMonth(),a=t.getFullYear(),o=r===0?11:r-1,l=r===0?a-1:a,m=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#EC4899","#84CC16"];this.categoryTrends=this.categories.map((g,f)=>{let x=this.transactions.filter(A=>{let E=this.dateService.toDate(A.date);return A.categoryId===g.id&&A.type==="expense"&&(E==null?void 0:E.getMonth())===r&&(E==null?void 0:E.getFullYear())===a}).reduce((A,E)=>A+E.amount,0),y=this.transactions.filter(A=>{let E=this.dateService.toDate(A.date);return A.categoryId===g.id&&A.type==="expense"&&(E==null?void 0:E.getMonth())===o&&(E==null?void 0:E.getFullYear())===l}).reduce((A,E)=>A+E.amount,0),b=x-y,w=y>0?b/y*100:0;return{category:g.name,currentAmount:x,previousAmount:y,change:b,percentage:w,color:m[f%m.length]}}).filter(g=>g.currentAmount>0||g.previousAmount>0).sort((g,f)=>Math.abs(f.change)-Math.abs(g.change)).slice(0,8)}calculateGrowthRates(){var f;let t=this.transactions.filter(h=>h.type==="expense").reduce((h,x)=>h+x.amount,0),r=this.transactions.length>0?Math.max(1,Math.ceil((new Date().getTime()-(((f=this.dateService.toDate(this.transactions[0].date))==null?void 0:f.getTime())||0))/(24*60*60*1e3))):30;this.averageDailySpending=t/r,this.averageMonthlySpending=this.averageDailySpending*30;let a=this.transactions.filter(h=>h.type==="income").reduce((h,x)=>h+x.amount,0);this.savingsRate=a>0?this.netSavings/a*100:0;let o=this.totalExpenses,l=this.transactions.filter(h=>{let x=this.dateService.toDate(h.date),C=new Date().getMonth()===0?11:new Date().getMonth()-1,y=new Date().getMonth()===0?new Date().getFullYear()-1:new Date().getFullYear();return h.type==="expense"&&(x==null?void 0:x.getMonth())===C&&(x==null?void 0:x.getFullYear())===y}).reduce((h,x)=>h+x.amount,0);this.expenseGrowthRate=l>0?(o-l)/l*100:0;let m=this.totalIncome,g=this.transactions.filter(h=>{let x=this.dateService.toDate(h.date),C=new Date().getMonth()===0?11:new Date().getMonth()-1,y=new Date().getMonth()===0?new Date().getFullYear()-1:new Date().getFullYear();return h.type==="income"&&(x==null?void 0:x.getMonth())===C&&(x==null?void 0:x.getFullYear())===y}).reduce((h,x)=>h+x.amount,0);this.incomeGrowthRate=g>0?(m-g)/g*100:0}populateAnalyticsSummary(){let t=this.categoryTrends.map(o=>({category:o.category,change:o.change,percentage:o.percentage,color:o.color,icon:"category"})),r=this.spendingTrends.map(o=>({period:o.period,amount:o.amount,change:o.change,percentage:o.percentage})),a=this.accountBalances.map(o=>({account:o.account,balance:o.balance,color:o.color,icon:"account_balance"}));this.analyticsSummaryConfig=le(oe({},this.analyticsSummaryConfig),{loading:!1})}onPeriodChange(t){this.selectedPeriod=t,this.notificationService.info(`Report period changed to ${t}`),console.log("Period changed to:",t),this.updateCharts()}onChartTypeChange(t){this.selectedChartType=t,this.notificationService.info(`Chart type changed to ${t}`),this.updateCharts()}onAnalyticsViewChange(t){this.selectedAnalyticsView=t,this.notificationService.info(`Analytics view changed to ${t}`),this.updateCharts()}toggleAdvancedAnalytics(){this.showAdvancedAnalytics=!this.showAdvancedAnalytics,this.userPreferences.showAdvancedAnalytics=this.showAdvancedAnalytics,this.savePreferences(),this.notificationService.info(this.showAdvancedAnalytics?"Advanced analytics enabled":"Advanced analytics disabled")}openPreferencesDialog(){this.showPreferencesDialog=!0}closePreferencesDialog(){this.showPreferencesDialog=!1}savePreferences(){localStorage.setItem("reports-preferences",JSON.stringify(this.userPreferences)),this.notificationService.success("Preferences saved successfully")}loadPreferences(){let t=localStorage.getItem("reports-preferences");t&&(this.userPreferences=oe(oe({},this.userPreferences),JSON.parse(t)),this.selectedChartType=this.userPreferences.defaultChartType,this.selectedAnalyticsView=this.userPreferences.defaultAnalyticsView,this.selectedPeriod=this.userPreferences.defaultPeriod,this.showAdvancedAnalytics=this.userPreferences.showAdvancedAnalytics)}resetPreferences(){this.userPreferences={defaultChartType:"pie",defaultAnalyticsView:"overview",defaultPeriod:"monthly",showAdvancedAnalytics:!1,chartHeight:"medium",refreshInterval:5,currencyFormat:"INR",dateFormat:"DD/MM/YYYY",theme:"auto",showTooltips:!0,showAnimations:!0,exportFormat:"pdf",emailReports:!1,emailFrequency:"never"},this.savePreferences(),this.notificationService.info("Preferences reset to default")}toggleQuickFilters(){this.showQuickFilters=!this.showQuickFilters}applyFilters(){this.notificationService.info("Filters applied successfully"),this.toggleQuickFilters(),this.refreshData()}toggleExportOptions(){this.showExportOptions=!this.showExportOptions}toggleHelpTooltip(){this.showHelpTooltip=!this.showHelpTooltip}toggleQuickActions(){this.showQuickActions=!this.showQuickActions}refreshData(){this.isRefreshing=!0,setTimeout(()=>{this.loadData(),this.isRefreshing=!1,this.notificationService.success("Data refreshed successfully")},1e3)}getChartHeight(){switch(this.userPreferences.chartHeight){case"small":return"h-48 sm:h-56";case"large":return"h-80 sm:h-96";default:return"h-64 sm:h-80"}}formatCurrencyWithPreference(t){switch(this.userPreferences.currencyFormat){case"USD":return`$${t.toLocaleString("en-US")}`;case"EUR":return`\u20AC${t.toLocaleString("de-DE")}`;default:return`\u20B9${t.toLocaleString("en-IN")}`}}exportReport(){try{console.log("Export report clicked"),this.notificationService.info("Export feature coming soon")}catch(t){console.error("Error exporting report:",t),this.notificationService.error("Failed to export report")}}generateReport(){try{console.log("Generate report clicked"),this.notificationService.info("Report generation feature coming soon")}catch(t){console.error("Error generating report:",t),this.notificationService.error("Failed to generate report")}}addTransaction(){this.router.navigate(["/dashboard/transaction-list/add-transaction"])}onMetricClick(t){switch(console.log("Metric clicked:",t),t.title){case"Total Income":break;case"Total Expenses":break;case"Net Savings":break;case"Monthly Change":break}}onCategoryTrendClick(t){console.log("Category trend clicked:",t),this.notificationService.info(`Category: ${t.category} - ${t.change>=0?"+":""}${t.percentage.toFixed(1)}%`)}onSpendingTrendClick(t){console.log("Spending trend clicked:",t),this.notificationService.info(`Period: ${t.period} - ${this.formatCurrency(t.amount)}`)}onAccountBalanceClick(t){console.log("Account balance clicked:",t),this.notificationService.info(`Account: ${t.account} - ${this.formatCurrency(t.balance)}`)}getMonthlyChangeDisplay(){return`${this.monthlyChange>=0?"+":""}${this.monthlyChangePercentage.toFixed(1)}%`}getMonthlyChangeColor(){return this.monthlyChange>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}getMonthlyChangeIcon(){return this.monthlyChange>=0?"trending_up":"trending_down"}formatCurrency(t){return`\u20B9${t.toLocaleString("en-IN")}`}getTransactionIcon(t){return t.type==="income"?"trending_up":"trending_down"}getTransactionColor(t){return t.type==="income"?"text-green-600":"text-red-600"}getCurrentChartOption(){switch(this.selectedChartType){case"pie":return this.pieChartOption;case"bar":return this.barChartOption;case"line":return this.lineChartOption;case"area":return this.areaChartOption;case"radar":return this.radarChartOption;case"funnel":return this.funnelChartOption;case"scatter":return this.scatterChartOption;case"heatmap":return this.heatmapChartOption;default:return this.pieChartOption}}getChartTitle(){switch(this.selectedChartType){case"pie":return"Spending by Category";case"bar":return"Monthly Financial Trends";case"line":return"Financial Trends Over Time";case"area":return"Daily Spending Patterns";case"radar":return"Category Performance Comparison";case"funnel":return"Spending Funnel Analysis";case"scatter":return"Income vs Expenses Correlation";case"heatmap":return"Weekly Spending Heatmap";default:return"Financial Analytics"}}initializePieChart(){if(this.topCategories.length===0){this.pieChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.topCategories.map(r=>({name:r.category,value:r.amount,itemStyle:{color:r.color}}));this.pieChartOption={title:{text:"Spending by Category",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"},formatter:r=>{let a=(r.value/this.totalExpenses*100).toFixed(1);return`${r.name}<br/>${this.formatCurrency(r.value)} (${a}%)`}},legend:{orient:"vertical",left:"left",top:"middle",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"}},series:[{name:"Spending",type:"pie",radius:["40%","70%"],center:["60%","50%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold",color:this.isDarkMode?"#F9FAFB":"#333"}},labelLine:{show:!1},data:t}]}}initializeBarChart(){if(this.monthlyTrends.length===0){this.barChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.monthlyTrends.map(l=>l.month),r=this.monthlyTrends.map(l=>l.income),a=this.monthlyTrends.map(l=>l.expenses),o=this.monthlyTrends.map(l=>l.savings);this.barChartOption={title:{text:"Monthly Financial Trends",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"},formatter:l=>{let m=`${l[0].axisValue}<br/>`;return l.forEach(g=>{m+=`${g.marker} ${g.seriesName}: ${this.formatCurrency(g.value)}<br/>`}),m}},legend:{data:["Income","Expenses","Savings"],top:"bottom",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"}},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",data:t,axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},yAxis:{type:"value",axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333",formatter:l=>this.formatCurrency(l)},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},series:[{name:"Income",type:"bar",data:r,itemStyle:{color:"#10B981"},emphasis:{itemStyle:{color:"#059669"}}},{name:"Expenses",type:"bar",data:a,itemStyle:{color:"#EF4444"},emphasis:{itemStyle:{color:"#DC2626"}}},{name:"Savings",type:"bar",data:o,itemStyle:{color:"#3B82F6"},emphasis:{itemStyle:{color:"#2563EB"}}}]}}initializeLineChart(){if(this.monthlyTrends.length===0){this.lineChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.monthlyTrends.map(l=>l.month),r=this.monthlyTrends.map(l=>l.income),a=this.monthlyTrends.map(l=>l.expenses),o=this.monthlyTrends.map(l=>l.savings);this.lineChartOption={title:{text:"Financial Trends Over Time",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"}},legend:{data:["Income","Expenses","Savings"],top:"bottom",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"}},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",data:t,axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},yAxis:{type:"value",axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333",formatter:l=>this.formatCurrency(l)},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},series:[{name:"Income",type:"line",data:r,smooth:!0,itemStyle:{color:"#10B981"},lineStyle:{color:"#10B981",width:3},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(16, 185, 129, 0.3)"},{offset:1,color:"rgba(16, 185, 129, 0.1)"}]}}},{name:"Expenses",type:"line",data:a,smooth:!0,itemStyle:{color:"#EF4444"},lineStyle:{color:"#EF4444",width:3},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(239, 68, 68, 0.3)"},{offset:1,color:"rgba(239, 68, 68, 0.1)"}]}}},{name:"Savings",type:"line",data:o,smooth:!0,itemStyle:{color:"#3B82F6"},lineStyle:{color:"#3B82F6",width:3},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(59, 130, 246, 0.3)"},{offset:1,color:"rgba(59, 130, 246, 0.1)"}]}}}]}}initializeAreaChart(){if(this.dailyData.length===0){this.areaChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.dailyData.map(o=>o.date),r=this.dailyData.map(o=>o.income),a=this.dailyData.map(o=>o.expenses);this.areaChartOption={title:{text:"Daily Spending Patterns",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"}},legend:{data:["Income","Expenses"],top:"bottom",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"}},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",data:t,axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},yAxis:{type:"value",axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333",formatter:o=>this.formatCurrency(o)},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},series:[{name:"Income",type:"line",stack:"Total",data:r,areaStyle:{color:"#10B981"},itemStyle:{color:"#10B981"}},{name:"Expenses",type:"line",stack:"Total",data:a,areaStyle:{color:"#EF4444"},itemStyle:{color:"#EF4444"}}]}}initializeRadarChart(){if(this.categoryTrends.length===0){this.radarChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.categoryTrends.map(o=>o.category),r=this.categoryTrends.map(o=>o.currentAmount),a=this.categoryTrends.map(o=>o.previousAmount);this.radarChartOption={title:{text:"Category Performance Comparison",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"}},legend:{data:["Current Month","Previous Month"],top:"bottom",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"}},radar:{indicator:t.map(o=>({name:o,max:Math.max(...r,...a)*1.2})),center:["50%","50%"],radius:"60%",axisName:{color:this.isDarkMode?"#F9FAFB":"#333"},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitArea:{show:!1}},series:[{name:"Category Performance",type:"radar",data:[{value:r,name:"Current Month",itemStyle:{color:"#3B82F6"},areaStyle:{color:"rgba(59, 130, 246, 0.3)"}},{value:a,name:"Previous Month",itemStyle:{color:"#10B981"},areaStyle:{color:"rgba(16, 185, 129, 0.3)"}}]}]}}initializeFunnelChart(){if(this.spendingTrends.length===0){this.funnelChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.spendingTrends.map(r=>({name:r.period,value:r.amount}));this.funnelChartOption={title:{text:"Spending Funnel Analysis",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"},formatter:r=>`${r.name}<br/>${this.formatCurrency(r.value)}`},series:[{name:"Spending",type:"funnel",left:"10%",top:60,width:"80%",height:"80%",min:0,max:Math.max(...t.map(r=>r.value)),minSize:"0%",maxSize:"100%",sort:"descending",gap:2,label:{show:!0,position:"inside",color:this.isDarkMode?"#F9FAFB":"#333"},labelLine:{length:10,lineStyle:{width:1,type:"solid"}},itemStyle:{borderColor:this.isDarkMode?"#374151":"#FFFFFF",borderWidth:1},emphasis:{label:{fontSize:20}},data:t}]}}initializeScatterChart(){if(this.dailyData.length===0){this.scatterChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.dailyData.map((r,a)=>[a,r.expenses,r.income]);this.scatterChartOption={title:{text:"Income vs Expenses Correlation",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"},formatter:r=>`Day ${r.data[0]+1}<br/>Expenses: ${this.formatCurrency(r.data[1])}<br/>Income: ${this.formatCurrency(r.data[2])}`},xAxis:{type:"value",name:"Day",axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},yAxis:{type:"value",name:"Amount",axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333",formatter:r=>this.formatCurrency(r)},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},series:[{name:"Income vs Expenses",type:"scatter",data:t,symbolSize:8,itemStyle:{color:"#3B82F6"}}]}}initializeHeatmapChart(){if(this.dailyData.length===0){this.heatmapChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.dailyData.map((r,a)=>[Math.floor(a/7),a%7,r.expenses]);this.heatmapChartOption={title:{text:"Weekly Spending Heatmap",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{position:"top",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"},formatter:r=>{let a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return`Week ${r.data[0]+1}, ${a[r.data[1]]}<br/>${this.formatCurrency(r.data[2])}`}},grid:{height:"50%",top:"10%"},xAxis:{type:"category",data:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],splitArea:{show:!0},axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"}},yAxis:{type:"category",data:["Week 1","Week 2","Week 3","Week 4"],splitArea:{show:!0},axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"}},visualMap:{min:0,max:Math.max(...this.dailyData.map(r=>r.expenses)),calculable:!0,orient:"horizontal",left:"center",bottom:"15%",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"},inRange:{color:["#EBF8FF","#3B82F6"]}},series:[{name:"Spending",type:"heatmap",data:t,label:{show:!0,color:this.isDarkMode?"#F9FAFB":"#333"},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}}updateCharts(){this.initializePieChart(),this.initializeBarChart(),this.initializeLineChart(),this.initializeAreaChart(),this.initializeRadarChart(),this.initializeFunnelChart(),this.initializeScatterChart(),this.initializeHeatmapChart()}detectTheme(){this.isDarkMode=document.documentElement.classList.contains("dark"),new MutationObserver(()=>{this.isDarkMode=document.documentElement.classList.contains("dark"),this.updateCharts()}).observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),this.ssrService.isClientSide()&&window.addEventListener("resize",()=>{setTimeout(()=>this.updateCharts(),100)})}};i.\u0275fac=function(r){return new(r||i)(Y(nn),Y(xt),Y(ft),Y(pt),Y(Vt),Y(Vr))},i.\u0275cmp=Re({type:i,selectors:[["app-reports"]],decls:5,vars:4,consts:[["chartTypeMenu","matMenu"],["analyticsViewMenu","matMenu"],["moreOptionsMenu","matMenu"],[1,"min-h-screen","bg-gray-50","dark:bg-gray-900"],["class","max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",4,"ngIf"],["class","max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",4,"ngIf"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-12"],[1,"text-center"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-blue-100","dark:bg-blue-900/20","rounded-full","mb-6"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","mb-2"],[1,"text-gray-600","dark:text-gray-400"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-6","space-y-6"],[3,"config"],[1,"bg-white","dark:bg-gray-800","shadow-lg","border-0","rounded-xl","overflow-hidden"],[1,"p-4","sm:p-6","border-b","border-gray-200","dark:border-gray-700","bg-gray-50","dark:bg-gray-700/50"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between","gap-4"],[1,"flex-1","min-w-0"],[1,"text-lg","sm:text-xl","font-semibold","text-gray-900","dark:text-white","truncate"],[1,"text-sm","text-gray-600","dark:text-gray-400","mt-1"],[1,"flex","items-center","space-x-2","compact-control-bar"],[1,"hidden","sm:flex",3,"change","value"],["value","daily",1,"text-xs"],["value","weekly",1,"text-xs"],["value","monthly",1,"text-xs"],["value","yearly",1,"text-xs"],["mat-icon-button","","matTooltip","Chart Type",1,"text-gray-600","dark:text-gray-400","hover:text-blue-600","dark:hover:text-blue-400",3,"matMenuTriggerFor"],[1,"chart-type-menu"],[1,"p-2"],[1,"text-xs","font-medium","text-gray-500","dark:text-gray-400","mb-2","px-3"],["mat-menu-item","",1,"flex","items-center","space-x-3",3,"bg-blue-50"],["mat-icon-button","","matTooltip","Analytics View",1,"text-gray-600","dark:text-gray-400","hover:text-green-600","dark:hover:text-green-400",3,"matMenuTriggerFor"],[1,"analytics-view-menu"],["mat-menu-item","",1,"flex","items-center","space-x-3",3,"bg-green-50"],["mat-icon-button","",1,"hover:text-purple-600","dark:hover:text-purple-400",3,"click","matTooltip"],["mat-icon-button","","matTooltip","More Options",1,"text-gray-600","dark:text-gray-400","hover:text-gray-800","dark:hover:text-gray-200",3,"matMenuTriggerFor"],[1,"more-options-menu"],["mat-menu-item","",1,"flex","items-center","space-x-3",3,"click"],[1,"text-sm"],["mat-menu-item","",1,"flex","items-center","space-x-3",3,"click","disabled"],[1,"p-4","sm:p-6"],[1,"w-full","chart-transition",3,"ngClass"],["echarts","",1,"w-full","h-full",3,"options"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2"],[1,"lg:col-span-1"],[1,"bg-white","dark:bg-gray-800","shadow-lg","border-0","rounded-xl","overflow-hidden","h-full"],[1,"flex","items-center","justify-between","mb-4","sm:mb-6"],[1,"bg-blue-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-blue-600","dark:text-blue-400"],[1,"space-y-3"],["mat-stroked-button","",1,"w-full","justify-start",3,"click"],[1,"mr-3"],["mat-stroked-button","",1,"w-full","justify-start",3,"click","disabled"],["class","bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 sm:p-6",4,"ngIf"],["class","flex justify-center",4,"ngIf"],["class","grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-4","sm:gap-6","mb-8"],[1,"space-y-3","sm:space-y-4"],[1,"flex","justify-between","items-center","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg"],[1,"flex","items-center","space-x-3","min-w-0","flex-1"],[1,"w-3","h-3","bg-green-500","rounded-full","flex-shrink-0"],[1,"text-gray-700","dark:text-gray-300","truncate"],[1,"font-semibold","text-green-600","dark:text-green-400","ml-3","text-right"],[1,"w-3","h-3","bg-red-500","rounded-full","flex-shrink-0"],[1,"font-semibold","text-red-600","dark:text-red-400","ml-3","text-right"],[1,"w-3","h-3","bg-blue-500","rounded-full","flex-shrink-0"],[1,"font-semibold","text-blue-600","dark:text-blue-400","ml-3","text-right"],[1,"bg-green-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-green-600","dark:text-green-400"],[1,"flex","justify-between","items-center","p-3","bg-green-50","dark:bg-green-900/20","rounded-lg","border","border-green-200","dark:border-green-700"],[1,"text-gray-700","dark:text-gray-300"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between","gap-4","mb-6","sm:mb-8"],[1,"text-xl","sm:text-2xl","font-bold","text-gray-900","dark:text-white"],[1,"flex","flex-wrap","gap-2","justify-center","lg:justify-end"],["mat-stroked-button","",1,"px-3","sm:px-4","py-2","text-xs","sm:text-sm","border","border-gray-300","dark:border-gray-600","rounded-lg","hover:bg-gray-50","dark:hover:bg-gray-700","transition-colors",3,"click"],["mat-raised-button","","color","primary",1,"px-3","sm:px-4","py-2","text-xs","sm:text-sm","rounded-lg","shadow-md","hover:shadow-lg","transition-shadow",3,"click"],["class","space-y-6",4,"ngIf"],["class","text-center py-12 sm:py-16",4,"ngIf"],[1,"text-blue-600","text-sm"],[1,"text-green-600","text-sm"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-lg","p-4","sm:p-6"],[1,"flex","items-center","justify-between","mb-6"],[1,"flex","items-center","space-x-3"],[1,"bg-blue-500/10","p-2","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-600","dark:text-gray-400"],["mat-icon-button","",1,"text-gray-600","dark:text-gray-400","hover:text-gray-800","dark:hover:text-gray-200",3,"click"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],["appearance","fill",1,"w-full"],["value","7"],["value","30"],["value","90"],["value","365"],["value","all"],[3,"value"],["value","income"],["value","expense"],[1,"flex","justify-end","space-x-3","mt-6"],["mat-stroked-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],[1,"flex","justify-center"],["mat-stroked-button","",1,"flex","items-center","space-x-2","px-6","py-3",3,"click"],[1,"bg-gradient-to-br","from-orange-50","to-orange-100","dark:from-orange-900/20","dark:to-orange-800/20","rounded-xl","p-4","sm:p-6","border","border-orange-200","dark:border-orange-700"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-orange-600","dark:text-orange-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-orange-900","dark:text-orange-100","truncate"],[1,"bg-orange-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-orange-600","dark:text-orange-400","text-lg","sm:text-xl"],[1,"bg-gradient-to-br","from-indigo-50","to-indigo-100","dark:from-indigo-900/20","dark:to-indigo-800/20","rounded-xl","p-4","sm:p-6","border","border-indigo-200","dark:border-indigo-700"],[1,"text-sm","font-medium","text-indigo-600","dark:text-indigo-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-indigo-900","dark:text-indigo-100","truncate"],[1,"bg-indigo-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-indigo-600","dark:text-indigo-400","text-lg","sm:text-xl"],[1,"bg-gradient-to-br","from-emerald-50","to-emerald-100","dark:from-emerald-900/20","dark:to-emerald-800/20","rounded-xl","p-4","sm:p-6","border","border-emerald-200","dark:border-emerald-700"],[1,"text-sm","font-medium","text-emerald-600","dark:text-emerald-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-emerald-900","dark:text-emerald-100","truncate"],[1,"bg-emerald-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-emerald-600","dark:text-emerald-400","text-lg","sm:text-xl"],[1,"bg-gradient-to-br","from-rose-50","to-rose-100","dark:from-rose-900/20","dark:to-rose-800/20","rounded-xl","p-4","sm:p-6","border","border-rose-200","dark:border-rose-700"],[1,"text-sm","font-medium","text-rose-600","dark:text-rose-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-rose-900","dark:text-rose-100","truncate",3,"ngClass"],[1,"bg-rose-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-rose-600","dark:text-rose-400","text-lg","sm:text-xl"],[1,"font-semibold","text-gray-900","dark:text-white","ml-3","text-right"],[1,"bg-green-500/10","p-2","rounded-lg"],[3,"ngModelChange","ngModel"],["value","pdf"],["value","excel"],["value","csv"],["value","json"],["value","current"],["value","last3"],["value","last6"],["value","last12"],["value","custom"],[1,"w-full"],[1,"flex","items-end"],["mat-raised-button","","color","primary",1,"w-full",3,"click"],[1,"mr-2"],["mat-raised-button","","color","accent",3,"click"],[1,"space-y-6"],[1,"text-center","py-12","sm:py-16"],[1,"bg-gray-100","dark:bg-gray-700","w-20","h-20","sm:w-24","sm:h-24","rounded-full","flex","items-center","justify-center","mx-auto","mb-6"],[1,"text-gray-400","text-4xl","sm:text-5xl"],[1,"text-xl","sm:text-2xl","font-bold","text-gray-900","dark:text-white","mb-3"],[1,"text-sm","sm:text-base","text-gray-600","dark:text-gray-400","mb-6","max-w-md","mx-auto"],["mat-raised-button","","color","primary",1,"flex","items-center","space-x-2","px-4","sm:px-6","py-3","rounded-lg","shadow-md","hover:shadow-lg","transition-shadow","mx-auto",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-2xl","max-w-4xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"p-6","border-b","border-gray-200","dark:border-gray-700"],[1,"text-xl","font-bold","text-gray-900","dark:text-white"],["mat-icon-button","",3,"click"],[1,"text-sm","text-gray-600","dark:text-gray-400","mt-2"],[1,"p-6","space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","mb-4"],[1,"space-y-4"],["value","daily"],["value","weekly"],["value","monthly"],["value","yearly"],["value","small"],["value","medium"],["value","large"],["value","INR"],["value","USD"],["value","EUR"],["value","DD/MM/YYYY"],["value","MM/DD/YYYY"],["value","YYYY-MM-DD"],[1,"w-full",3,"ngModelChange","ngModel"],["matInput","","type","number","min","1","max","60",3,"ngModelChange","ngModel"],[4,"ngIf"],[1,"p-6","border-t","border-gray-200","dark:border-gray-700","flex","justify-between"],["mat-stroked-button","",1,"text-red-600","border-red-600","hover:bg-red-50",3,"click"],[1,"space-x-3"],["value","never"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-2xl","max-w-2xl","w-full"],[1,"p-6","space-y-4"],[1,"space-y-2","text-sm","text-gray-600","dark:text-gray-400"],[1,"p-6","border-t","border-gray-200","dark:border-gray-700"]],template:function(r,a){r&1&&(s(0,"div",3),N(1,a5,8,0,"div",4)(2,v5,192,48,"div",5)(3,P5,126,13,"div",6)(4,O5,91,0,"div",6),c()),r&2&&(u(),P("ngIf",a.isLoading),u(),P("ngIf",!a.isLoading),u(),P("ngIf",a.showPreferencesDialog),u(),P("ngIf",a.showHelpTooltip))},dependencies:[$n,dt,Nt,Ui,At,jo,zo,Jn,ji,Ic,Jt,gn,Qe,Oi,wi,yi,Wa,Ya,Ga,cm,lm,da,Tn,ma,Rc,dm,ng,Xc,Kc,Zc,Qc],styles:['.chart-type-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%], .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%], .more-options-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%]{padding:0}.chart-type-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%], .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%], .more-options-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]{min-height:40px;height:40px;padding:0 16px}.chart-type-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover, .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover, .more-options-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover{background-color:#3b82f61a}.chart-type-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%], .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%], .more-options-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%]{background-color:#3b82f626}.mat-button-toggle-group[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden;border:1px solid #e5e7eb}.mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]{border:none;min-width:40px;height:36px}.mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]   .mat-button-toggle-label-content[_ngcontent-%COMP%]{padding:0 8px;font-size:12px;font-weight:500}.mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle.mat-button-toggle-checked[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]:not(.mat-button-toggle-checked){background-color:#fff;color:#6b7280}.mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]:not(.mat-button-toggle-checked):hover{background-color:#f3f4f6}.dark[_ngcontent-%COMP%]   .mat-button-toggle-group[_ngcontent-%COMP%]{border-color:#4b5563}.dark[_ngcontent-%COMP%]   .mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]:not(.mat-button-toggle-checked){background-color:#374151;color:#d1d5db}.dark[_ngcontent-%COMP%]   .mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]:not(.mat-button-toggle-checked):hover{background-color:#4b5563}.dark[_ngcontent-%COMP%]   .chart-type-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover, .dark[_ngcontent-%COMP%]   .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover, .dark[_ngcontent-%COMP%]   .more-options-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover{background-color:#3b82f633}.dark[_ngcontent-%COMP%]   .chart-type-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .more-options-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%]{background-color:#3b82f640}.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{width:36px;height:36px;line-height:36px}.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;line-height:20px}.chart-container[_ngcontent-%COMP%]{min-height:400px}.chart-container.small[_ngcontent-%COMP%]{min-height:300px}.chart-container.medium[_ngcontent-%COMP%]{min-height:400px}.chart-container.large[_ngcontent-%COMP%]{min-height:500px}@media (max-width: 640px){.mat-button-toggle-group[_ngcontent-%COMP%]{display:none!important}.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{width:32px;height:32px;line-height:32px}.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;line-height:18px}}.chart-transition[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.mat-menu-panel[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 10px 25px #00000026;border:1px solid #e5e7eb}.dark[_ngcontent-%COMP%]   .mat-menu-panel[_ngcontent-%COMP%]{border-color:#4b5563;box-shadow:0 10px 25px #0000004d}.mat-tooltip[_ngcontent-%COMP%]{font-size:12px;padding:4px 8px;border-radius:6px}.chart-loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:200px}.chart-loading[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #f3f4f6;border-top:3px solid #3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.mat-card[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.mat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.mat-stroked-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.mat-stroked-button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 6px -1px #0000001a}.mat-raised-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.mat-raised-button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 8px 15px -3px #0000001a}.metric-card[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.metric-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 25px 50px -12px #00000040}.chart-container[_ngcontent-%COMP%]{position:relative}.chart-container[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,#3b82f60d,#9333ea0d);border-radius:inherit;opacity:0;transition:opacity .3s ease-in-out;pointer-events:none}.chart-container[_ngcontent-%COMP%]:hover:before{opacity:1}.loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background:#ffffffe6;display:flex;align-items:center;justify-content:center;border-radius:inherit;z-index:10}@media (max-width: 768px){.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{width:28px;height:28px;line-height:28px}.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;line-height:16px}.metric-card[_ngcontent-%COMP%]:hover{transform:none}}.mat-focus-indicator[_ngcontent-%COMP%]{border-radius:8px}.dark[_ngcontent-%COMP%]   .mat-card[_ngcontent-%COMP%]:hover{box-shadow:0 20px 25px -5px #0000004d,0 10px 10px -5px #0003}.dark[_ngcontent-%COMP%]   .loading-overlay[_ngcontent-%COMP%]{background:#111827e6}']});let e=i;return e})();var dd={};dd.version="0.18.5";var io=1200,ll=1252,S5=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Op={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},wp=function(e){S5.indexOf(e)!=-1&&(ll=Op[0]=e)};function k5(){wp(1252)}var Aa=function(e){io=e,wp(e)};function Sp(){Aa(1200),k5()}function up(e){for(var i=[],n=0,t=e.length;n<t;++n)i[n]=e.charCodeAt(n);return i}function T5(e){for(var i=[],n=0;n<e.length>>1;++n)i[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return i.join("")}function Lv(e){for(var i=[],n=0;n<e.length>>1;++n)i[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return i.join("")}var Jl=function(e){var i=e.charCodeAt(0),n=e.charCodeAt(1);return i==255&&n==254?T5(e.slice(2)):i==254&&n==255?Lv(e.slice(2)):i==65279?e.slice(1):e},og=function(i){return String.fromCharCode(i)},EC=function(i){return String.fromCharCode(i)},Cn;var si=null,Zl=!0,as="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function md(e){for(var i="",n=0,t=0,r=0,a=0,o=0,l=0,m=0,g=0;g<e.length;)n=e.charCodeAt(g++),a=n>>2,t=e.charCodeAt(g++),o=(n&3)<<4|t>>4,r=e.charCodeAt(g++),l=(t&15)<<2|r>>6,m=r&63,isNaN(t)?l=m=64:isNaN(r)&&(m=64),i+=as.charAt(a)+as.charAt(o)+as.charAt(l)+as.charAt(m);return i}function ea(e){var i="",n=0,t=0,r=0,a=0,o=0,l=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var g=0;g<e.length;)a=as.indexOf(e.charAt(g++)),o=as.indexOf(e.charAt(g++)),n=a<<2|o>>4,i+=String.fromCharCode(n),l=as.indexOf(e.charAt(g++)),t=(o&15)<<4|l>>2,l!==64&&(i+=String.fromCharCode(t)),m=as.indexOf(e.charAt(g++)),r=(l&3)<<6|m,m!==64&&(i+=String.fromCharCode(r));return i}var Zt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Io=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(i,n){return n?new Buffer(i,n):new Buffer(i)}:Buffer.from.bind(Buffer)}return function(){}}();function ss(e){return Zt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function IC(e){return Zt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Qr=function(i){return Zt?Io(i,"binary"):i.split("").map(function(n){return n.charCodeAt(0)&255})};function Eg(e){if(typeof ArrayBuffer>"u")return Qr(e);for(var i=new ArrayBuffer(e.length),n=new Uint8Array(i),t=0;t!=e.length;++t)n[t]=e.charCodeAt(t)&255;return i}function ms(e){if(Array.isArray(e))return e.map(function(t){return String.fromCharCode(t)}).join("");for(var i=[],n=0;n<e.length;++n)i[n]=String.fromCharCode(e[n]);return i.join("")}function E5(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function kp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return kp(new Uint8Array(e));for(var i=new Array(e.length),n=0;n<e.length;++n)i[n]=e[n];return i}var Gi=Zt?function(e){return Buffer.concat(e.map(function(i){return Buffer.isBuffer(i)?i:Io(i)}))}:function(e){if(typeof Uint8Array<"u"){var i=0,n=0;for(i=0;i<e.length;++i)n+=e[i].length;var t=new Uint8Array(n),r=0;for(i=0,n=0;i<e.length;n+=r,++i)if(r=e[i].length,e[i]instanceof Uint8Array)t.set(e[i],n);else{if(typeof e[i]=="string")throw"wtf";t.set(new Uint8Array(e[i]),n)}return t}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function I5(e){for(var i=[],n=0,t=e.length+250,r=ss(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)r[n++]=o;else if(o<2048)r[n++]=192|o>>6&31,r[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;r[n++]=240|o>>8&7,r[n++]=128|o>>2&63,r[n++]=128|l>>6&15|(o&3)<<4,r[n++]=128|l&63}else r[n++]=224|o>>12&15,r[n++]=128|o>>6&63,r[n++]=128|o&63;n>t&&(i.push(r.slice(0,n)),n=0,r=ss(65535),t=65530)}return i.push(r.slice(0,n)),Gi(i)}var xr=/\u0000/g,ed=/[\u0001-\u0006]/g;function al(e){for(var i="",n=e.length-1;n>=0;)i+=e.charAt(n--);return i}function Da(e,i){var n=""+e;return n.length>=i?n:ai("0",i-n.length)+n}function Tp(e,i){var n=""+e;return n.length>=i?n:ai(" ",i-n.length)+n}function _g(e,i){var n=""+e;return n.length>=i?n:n+ai(" ",i-n.length)}function A5(e,i){var n=""+Math.round(e);return n.length>=i?n:ai("0",i-n.length)+n}function D5(e,i){var n=""+e;return n.length>=i?n:ai("0",i-n.length)+n}var AC=Math.pow(2,32);function Jc(e,i){if(e>AC||e<-AC)return A5(e,i);var n=Math.round(e);return D5(n,i)}function xg(e,i){return i=i||0,e.length>=7+i&&(e.charCodeAt(i)|32)===103&&(e.charCodeAt(i+1)|32)===101&&(e.charCodeAt(i+2)|32)===110&&(e.charCodeAt(i+3)|32)===101&&(e.charCodeAt(i+4)|32)===114&&(e.charCodeAt(i+5)|32)===97&&(e.charCodeAt(i+6)|32)===108}var DC=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ju=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function F5(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var Mt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},FC={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},R5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Cg(e,i,n){for(var t=e<0?-1:1,r=e*t,a=0,o=1,l=0,m=1,g=0,f=0,h=Math.floor(r);g<i&&(h=Math.floor(r),l=h*o+a,f=h*g+m,!(r-h<5e-8));)r=1/(r-h),a=o,o=l,m=g,g=f;if(f>i&&(g>i?(f=m,l=a):(f=g,l=o)),!n)return[0,t*l,f];var x=Math.floor(t*l/f);return[x,t*l-x*f,f]}function As(e,i,n){if(e>2958465||e<0)return null;var t=e|0,r=Math.floor(86400*(e-t)),a=0,o=[],l={D:t,T:r,u:86400*(e-t)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),i&&i.date1904&&(t+=1462),l.u>.9999&&(l.u=0,++r==86400&&(l.T=r=0,++t,++l.D)),t===60)o=n?[1317,10,29]:[1900,2,29],a=3;else if(t===0)o=n?[1317,8,29]:[1900,1,0],a=6;else{t>60&&--t;var m=new Date(1900,0,1);m.setDate(m.getDate()+t-1),o=[m.getFullYear(),m.getMonth()+1,m.getDate()],a=m.getDay(),t<60&&(a=(a+6)%7),n&&(a=z5(m,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=r%60,r=Math.floor(r/60),l.M=r%60,r=Math.floor(r/60),l.H=r,l.q=a,l}var Vv=new Date(1899,11,31,0,0,0),B5=Vv.getTime(),N5=new Date(1900,2,1,0,0,0);function Uv(e,i){var n=e.getTime();return i?n-=1461*24*60*60*1e3:e>=N5&&(n+=24*60*60*1e3),(n-(B5+(e.getTimezoneOffset()-Vv.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ep(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function L5(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function V5(e){var i=e<0?12:11,n=Ep(e.toFixed(12));return n.length<=i||(n=e.toPrecision(10),n.length<=i)?n:e.toExponential(5)}function U5(e){var i=Ep(e.toFixed(11));return i.length>(e<0?12:11)||i==="0"||i==="-0"?e.toPrecision(6):i}function gd(e){var i=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return i>=-4&&i<=-1?n=e.toPrecision(10+i):Math.abs(i)<=9?n=V5(e):i===10?n=e.toFixed(10).substr(0,12):n=U5(e),Ep(L5(n.toUpperCase()))}function Ns(e,i){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):gd(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return va(14,Uv(e,i&&i.date1904),i)}throw new Error("unsupported value in General format: "+e)}function z5(e,i){i[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function j5(e,i,n,t){var r="",a=0,o=0,l=n.y,m,g=0;switch(e){case 98:l=n.y+543;case 121:switch(i.length){case 1:case 2:m=l%100,g=2;break;default:m=l%1e4,g=4;break}break;case 109:switch(i.length){case 1:case 2:m=n.m,g=i.length;break;case 3:return Ju[n.m-1][1];case 5:return Ju[n.m-1][0];default:return Ju[n.m-1][2]}break;case 100:switch(i.length){case 1:case 2:m=n.d,g=i.length;break;case 3:return DC[n.q][0];default:return DC[n.q][1]}break;case 104:switch(i.length){case 1:case 2:m=1+(n.H+11)%12,g=i.length;break;default:throw"bad hour format: "+i}break;case 72:switch(i.length){case 1:case 2:m=n.H,g=i.length;break;default:throw"bad hour format: "+i}break;case 77:switch(i.length){case 1:case 2:m=n.M,g=i.length;break;default:throw"bad minute format: "+i}break;case 115:if(i!="s"&&i!="ss"&&i!=".0"&&i!=".00"&&i!=".000")throw"bad second format: "+i;return n.u===0&&(i=="s"||i=="ss")?Da(n.S,i.length):(t>=2?o=t===3?1e3:100:o=t===1?10:1,a=Math.round(o*(n.S+n.u)),a>=60*o&&(a=0),i==="s"?a===0?"0":""+a/o:(r=Da(a,2+t),i==="ss"?r.substr(0,2):"."+r.substr(2,i.length-1)));case 90:switch(i){case"[h]":case"[hh]":m=n.D*24+n.H;break;case"[m]":case"[mm]":m=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":m=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+i}g=i.length===3?1:2;break;case 101:m=l,g=1;break}var f=g>0?Da(m,g):"";return f}function os(e){var i=3;if(e.length<=i)return e;for(var n=e.length%i,t=e.substr(0,n);n!=e.length;n+=i)t+=(t.length>0?",":"")+e.substr(n,i);return t}var zv=/%/g;function $5(e,i,n){var t=i.replace(zv,""),r=i.length-t.length;return So(e,t,n*Math.pow(10,2*r))+ai("%",r)}function Y5(e,i,n){for(var t=i.length-1;i.charCodeAt(t-1)===44;)--t;return So(e,i.substr(0,t),n/Math.pow(10,3*(i.length-t)))}function jv(e,i){var n,t=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+jv(e,-i);var r=e.indexOf(".");r===-1&&(r=e.indexOf("E"));var a=Math.floor(Math.log(i)*Math.LOG10E)%r;if(a<0&&(a+=r),n=(i/Math.pow(10,a)).toPrecision(t+1+(r+a)%r),n.indexOf("e")===-1){var o=Math.floor(Math.log(i)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+a):n+="E+"+(o-a);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,r)+"."+n.substr(2+r),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,m,g,f){return m+g+f.substr(0,(r+a)%r)+"."+f.substr(a)+"E"})}else n=i.toExponential(t);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var $v=/# (\?+)( ?)\/( ?)(\d+)/;function W5(e,i,n){var t=parseInt(e[4],10),r=Math.round(i*t),a=Math.floor(r/t),o=r-a*t,l=t;return n+(a===0?"":""+a)+" "+(o===0?ai(" ",e[1].length+1+e[4].length):Tp(o,e[1].length)+e[2]+"/"+e[3]+Da(l,e[4].length))}function G5(e,i,n){return n+(i===0?"":""+i)+ai(" ",e[1].length+2+e[4].length)}var Yv=/^#*0*\.([0#]+)/,Wv=/\).*[0#]/,Gv=/\(###\) ###\\?-####/;function kr(e){for(var i="",n,t=0;t!=e.length;++t)switch(n=e.charCodeAt(t)){case 35:break;case 63:i+=" ";break;case 48:i+="0";break;default:i+=String.fromCharCode(n)}return i}function RC(e,i){var n=Math.pow(10,i);return""+Math.round(e*n)/n}function BC(e,i){var n=e-Math.floor(e),t=Math.pow(10,i);return i<(""+Math.round(n*t)).length?0:Math.round(n*t)}function H5(e,i){return i<(""+Math.round((e-Math.floor(e))*Math.pow(10,i))).length?1:0}function q5(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function pa(e,i,n){if(e.charCodeAt(0)===40&&!i.match(Wv)){var t=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?pa("n",t,n):"("+pa("n",t,-n)+")"}if(i.charCodeAt(i.length-1)===44)return Y5(e,i,n);if(i.indexOf("%")!==-1)return $5(e,i,n);if(i.indexOf("E")!==-1)return jv(i,n);if(i.charCodeAt(0)===36)return"$"+pa(e,i.substr(i.charAt(1)==" "?2:1),n);var r,a,o,l,m=Math.abs(n),g=n<0?"-":"";if(i.match(/^00+$/))return g+Jc(m,i.length);if(i.match(/^[#?]+$/))return r=Jc(n,0),r==="0"&&(r=""),r.length>i.length?r:kr(i.substr(0,i.length-r.length))+r;if(a=i.match($v))return W5(a,m,g);if(i.match(/^#+0+$/))return g+Jc(m,i.length-i.indexOf("0"));if(a=i.match(Yv))return r=RC(n,a[1].length).replace(/^([^\.]+)$/,"$1."+kr(a[1])).replace(/\.$/,"."+kr(a[1])).replace(/\.(\d*)$/,function(y,b){return"."+b+ai("0",kr(a[1]).length-b.length)}),i.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),a=i.match(/^(0*)\.(#*)$/))return g+RC(m,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=i.match(/^#{1,3},##0(\.?)$/))return g+os(Jc(m,0));if(a=i.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+pa(e,i,-n):os(""+(Math.floor(n)+H5(n,a[1].length)))+"."+Da(BC(n,a[1].length),a[1].length);if(a=i.match(/^#,#*,#0/))return pa(e,i.replace(/^#,#*,/,""),n);if(a=i.match(/^([0#]+)(\\?-([0#]+))+$/))return r=al(pa(e,i.replace(/[\\-]/g,""),n)),o=0,al(al(i.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<r.length?r.charAt(o++):y==="0"?"0":""}));if(i.match(Gv))return r=pa(e,"##########",n),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var f="";if(a=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=Cg(m,Math.pow(10,o)-1,!1),r=""+g,f=So("n",a[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),r+=f+a[2]+"/"+a[3],f=_g(l[2],o),f.length<a[4].length&&(f=kr(a[4].substr(a[4].length-f.length))+f),r+=f,r;if(a=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=Cg(m,Math.pow(10,o)-1,!0),g+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Tp(l[1],o)+a[2]+"/"+a[3]+_g(l[2],o):ai(" ",2*o+1+a[2].length+a[3].length));if(a=i.match(/^[#0?]+$/))return r=Jc(n,0),i.length<=r.length?r:kr(i.substr(0,i.length-r.length))+r;if(a=i.match(/^([#0?]+)\.([#0]+)$/)){r=""+n.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var h=i.indexOf(".")-o,x=i.length-r.length-h;return kr(i.substr(0,h)+r+i.substr(i.length-x))}if(a=i.match(/^00,000\.([#0]*0)$/))return o=BC(n,a[1].length),n<0?"-"+pa(e,i,-n):os(q5(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Da(0,3-y.length):"")+y})+"."+Da(o,a[1].length);switch(i){case"###,##0.00":return pa(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var C=os(Jc(m,0));return C!=="0"?g+C:"";case"###,###.00":return pa(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return pa(e,"#,##0.00",n).replace(/^0\./,".");default:}throw new Error("unsupported format |"+i+"|")}function X5(e,i,n){for(var t=i.length-1;i.charCodeAt(t-1)===44;)--t;return So(e,i.substr(0,t),n/Math.pow(10,3*(i.length-t)))}function K5(e,i,n){var t=i.replace(zv,""),r=i.length-t.length;return So(e,t,n*Math.pow(10,2*r))+ai("%",r)}function Hv(e,i){var n,t=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+Hv(e,-i);var r=e.indexOf(".");r===-1&&(r=e.indexOf("E"));var a=Math.floor(Math.log(i)*Math.LOG10E)%r;if(a<0&&(a+=r),n=(i/Math.pow(10,a)).toPrecision(t+1+(r+a)%r),!n.match(/[Ee]/)){var o=Math.floor(Math.log(i)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+a):n+="E+"+(o-a),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,m,g,f){return m+g+f.substr(0,(r+a)%r)+"."+f.substr(a)+"E"})}else n=i.toExponential(t);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function eo(e,i,n){if(e.charCodeAt(0)===40&&!i.match(Wv)){var t=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?eo("n",t,n):"("+eo("n",t,-n)+")"}if(i.charCodeAt(i.length-1)===44)return X5(e,i,n);if(i.indexOf("%")!==-1)return K5(e,i,n);if(i.indexOf("E")!==-1)return Hv(i,n);if(i.charCodeAt(0)===36)return"$"+eo(e,i.substr(i.charAt(1)==" "?2:1),n);var r,a,o,l,m=Math.abs(n),g=n<0?"-":"";if(i.match(/^00+$/))return g+Da(m,i.length);if(i.match(/^[#?]+$/))return r=""+n,n===0&&(r=""),r.length>i.length?r:kr(i.substr(0,i.length-r.length))+r;if(a=i.match($v))return G5(a,m,g);if(i.match(/^#+0+$/))return g+Da(m,i.length-i.indexOf("0"));if(a=i.match(Yv))return r=(""+n).replace(/^([^\.]+)$/,"$1."+kr(a[1])).replace(/\.$/,"."+kr(a[1])),r=r.replace(/\.(\d*)$/,function(y,b){return"."+b+ai("0",kr(a[1]).length-b.length)}),i.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),a=i.match(/^(0*)\.(#*)$/))return g+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=i.match(/^#{1,3},##0(\.?)$/))return g+os(""+m);if(a=i.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+eo(e,i,-n):os(""+n)+"."+ai("0",a[1].length);if(a=i.match(/^#,#*,#0/))return eo(e,i.replace(/^#,#*,/,""),n);if(a=i.match(/^([0#]+)(\\?-([0#]+))+$/))return r=al(eo(e,i.replace(/[\\-]/g,""),n)),o=0,al(al(i.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<r.length?r.charAt(o++):y==="0"?"0":""}));if(i.match(Gv))return r=eo(e,"##########",n),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var f="";if(a=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=Cg(m,Math.pow(10,o)-1,!1),r=""+g,f=So("n",a[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),r+=f+a[2]+"/"+a[3],f=_g(l[2],o),f.length<a[4].length&&(f=kr(a[4].substr(a[4].length-f.length))+f),r+=f,r;if(a=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=Cg(m,Math.pow(10,o)-1,!0),g+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Tp(l[1],o)+a[2]+"/"+a[3]+_g(l[2],o):ai(" ",2*o+1+a[2].length+a[3].length));if(a=i.match(/^[#0?]+$/))return r=""+n,i.length<=r.length?r:kr(i.substr(0,i.length-r.length))+r;if(a=i.match(/^([#0]+)\.([#0]+)$/)){r=""+n.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var h=i.indexOf(".")-o,x=i.length-r.length-h;return kr(i.substr(0,h)+r+i.substr(i.length-x))}if(a=i.match(/^00,000\.([#0]*0)$/))return n<0?"-"+eo(e,i,-n):os(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Da(0,3-y.length):"")+y})+"."+Da(0,a[1].length);switch(i){case"###,###":case"##,###":case"#,###":var C=os(""+m);return C!=="0"?g+C:"";default:if(i.match(/\.[0#?]*$/))return eo(e,i.slice(0,i.lastIndexOf(".")),n)+kr(i.slice(i.lastIndexOf(".")))}throw new Error("unsupported format |"+i+"|")}function So(e,i,n){return(n|0)===n?eo(e,i,n):pa(e,i,n)}function Z5(e){for(var i=[],n=!1,t=0,r=0;t<e.length;++t)switch(e.charCodeAt(t)){case 34:n=!n;break;case 95:case 42:case 92:++t;break;case 59:i[i.length]=e.substr(r,t-r),r=t+1}if(i[i.length]=e.substr(r),n===!0)throw new Error("Format |"+e+"| unterminated string ");return i}var qv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ul(e){for(var i=0,n="",t="";i<e.length;)switch(n=e.charAt(i)){case"G":xg(e,i)&&(i+=6),i++;break;case'"':for(;e.charCodeAt(++i)!==34&&i<e.length;);++i;break;case"\\":i+=2;break;case"_":i+=2;break;case"@":++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(i,3).toUpperCase()==="A/P"||e.substr(i,5).toUpperCase()==="AM/PM"||e.substr(i,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++i;break;case"[":for(t=n;e.charAt(i++)!=="]"&&i<e.length;)t+=e.charAt(i);if(t.match(qv))return!0;break;case".":case"0":case"#":for(;i<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++i))>-1||n=="\\"&&e.charAt(i+1)=="-"&&"0#".indexOf(e.charAt(i+2))>-1););break;case"?":for(;e.charAt(++i)===n;);break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;);break;case" ":++i;break;default:++i;break}return!1}function Q5(e,i,n,t){for(var r=[],a="",o=0,l="",m="t",g,f,h,x="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!xg(e,o))throw new Error("unrecognized character "+l+" in "+e);r[r.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(h=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(h);r[r.length]={t:"t",v:a},++o;break;case"\\":var C=e.charAt(++o),y=C==="("||C===")"?C:"t";r[r.length]={t:y,v:C},++o;break;case"_":r[r.length]={t:"t",v:" "},o+=2;break;case"@":r[r.length]={t:"T",v:i},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(g==null&&(g=As(i,n,e.charAt(o+1)==="2"),g==null))return"";r[r.length]={t:"X",v:e.substr(o,2)},m=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(i<0||g==null&&(g=As(i,n),g==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&m.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=x),r[r.length]={t:l,v:a},m=l;break;case"A":case"a":case"\u4E0A":var b={t:l,v:l};if(g==null&&(g=As(i,n)),e.substr(o,3).toUpperCase()==="A/P"?(g!=null&&(b.v=g.H>=12?"P":"A"),b.t="T",x="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(g!=null&&(b.v=g.H>=12?"PM":"AM"),b.t="T",o+=5,x="h"):e.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(g!=null&&(b.v=g.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),b.t="T",o+=5,x="h"):(b.t="t",++o),g==null&&b.t==="T")return"";r[r.length]=b,m=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(qv)){if(g==null&&(g=As(i,n),g==null))return"";r[r.length]={t:"Z",v:a.toLowerCase()},m=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",ul(e)||(r[r.length]={t:"t",v:a}));break;case".":if(g!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;r[r.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;r[r.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;r[r.length]={t:l,v:a},m=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":r[r.length]={t:t===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);r[r.length]={t:"D",v:a};break;case" ":r[r.length]={t:l,v:l},++o;break;case"$":r[r.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);r[r.length]={t:"t",v:l},++o;break}var w=0,A=0,E;for(o=r.length-1,m="t";o>=0;--o)switch(r[o].t){case"h":case"H":r[o].t=x,m="h",w<1&&(w=1);break;case"s":(E=r[o].v.match(/\.0+$/))&&(A=Math.max(A,E[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":m=r[o].t;break;case"m":m==="s"&&(r[o].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&r[o].v.match(/[Hh]/)&&(w=1),w<2&&r[o].v.match(/[Mm]/)&&(w=2),w<3&&r[o].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M),g.M>=60&&(g.M=0,++g.H);break;case 2:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M);break}var I="",K;for(o=0;o<r.length;++o)switch(r[o].t){case"t":case"T":case" ":case"D":break;case"X":r[o].v="",r[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[o].v=j5(r[o].t.charCodeAt(0),r[o].v,g,A),r[o].t="t";break;case"n":case"?":for(K=o+1;r[K]!=null&&((l=r[K].t)==="?"||l==="D"||(l===" "||l==="t")&&r[K+1]!=null&&(r[K+1].t==="?"||r[K+1].t==="t"&&r[K+1].v==="/")||r[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(r[K].v==="/"||r[K].v===" "&&r[K+1]!=null&&r[K+1].t=="?"));)r[o].v+=r[K].v,r[K]={v:"",t:";"},++K;I+=r[o].v,o=K-1;break;case"G":r[o].t="t",r[o].v=Ns(i,n);break}var Z="",k,S;if(I.length>0){I.charCodeAt(0)==40?(k=i<0&&I.charCodeAt(0)===45?-i:i,S=So("n",I,k)):(k=i<0&&t>1?-i:i,S=So("n",I,k),k<0&&r[0]&&r[0].t=="t"&&(S=S.substr(1),r[0].v="-"+r[0].v)),K=S.length-1;var V=r.length;for(o=0;o<r.length;++o)if(r[o]!=null&&r[o].t!="t"&&r[o].v.indexOf(".")>-1){V=o;break}var W=r.length;if(V===r.length&&S.indexOf("E")===-1){for(o=r.length-1;o>=0;--o)r[o]==null||"n?".indexOf(r[o].t)===-1||(K>=r[o].v.length-1?(K-=r[o].v.length,r[o].v=S.substr(K+1,r[o].v.length)):K<0?r[o].v="":(r[o].v=S.substr(0,K+1),K=-1),r[o].t="t",W=o);K>=0&&W<r.length&&(r[W].v=S.substr(0,K+1)+r[W].v)}else if(V!==r.length&&S.indexOf("E")===-1){for(K=S.indexOf(".")-1,o=V;o>=0;--o)if(!(r[o]==null||"n?".indexOf(r[o].t)===-1)){for(f=r[o].v.indexOf(".")>-1&&o===V?r[o].v.indexOf(".")-1:r[o].v.length-1,Z=r[o].v.substr(f+1);f>=0;--f)K>=0&&(r[o].v.charAt(f)==="0"||r[o].v.charAt(f)==="#")&&(Z=S.charAt(K--)+Z);r[o].v=Z,r[o].t="t",W=o}for(K>=0&&W<r.length&&(r[W].v=S.substr(0,K+1)+r[W].v),K=S.indexOf(".")+1,o=V;o<r.length;++o)if(!(r[o]==null||"n?(".indexOf(r[o].t)===-1&&o!==V)){for(f=r[o].v.indexOf(".")>-1&&o===V?r[o].v.indexOf(".")+1:0,Z=r[o].v.substr(0,f);f<r[o].v.length;++f)K<S.length&&(Z+=S.charAt(K++));r[o].v=Z,r[o].t="t",W=o}}}for(o=0;o<r.length;++o)r[o]!=null&&"n?".indexOf(r[o].t)>-1&&(k=t>1&&i<0&&o>0&&r[o-1].v==="-"?-i:i,r[o].v=So(r[o].t,r[o].v,k),r[o].t="t");var Q="";for(o=0;o!==r.length;++o)r[o]!=null&&(Q+=r[o].v);return Q}var NC=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function LC(e,i){if(i==null)return!1;var n=parseFloat(i[2]);switch(i[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function J5(e,i){var n=Z5(e),t=n.length,r=n[t-1].indexOf("@");if(t<4&&r>-1&&--t,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof i!="number")return[4,n.length===4||r>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=r>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=r>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=r>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break;case 4:break}var a=i>0?n[0]:i<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[t,a];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(NC),l=n[1].match(NC);return LC(i,o)?[t,n[0]]:LC(i,l)?[t,n[1]]:[t,n[o!=null&&l!=null?2:1]]}return[t,a]}function va(e,i,n){n==null&&(n={});var t="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?t=n.dateNF:t=e;break;case"number":e==14&&n.dateNF?t=n.dateNF:t=(n.table!=null?n.table:Mt)[e],t==null&&(t=n.table&&n.table[FC[e]]||Mt[FC[e]]),t==null&&(t=R5[e]||"General");break}if(xg(t,0))return Ns(i,n);i instanceof Date&&(i=Uv(i,n.date1904));var r=J5(t,i);if(xg(r[1]))return Ns(i,n);if(i===!0)i="TRUE";else if(i===!1)i="FALSE";else if(i===""||i==null)return"";return Q5(r[1],i,n,r[0])}function ko(e,i){if(typeof i!="number"){i=+i||-1;for(var n=0;n<392;++n){if(Mt[n]==null){i<0&&(i=n);continue}if(Mt[n]==e){i=n;break}}i<0&&(i=391)}return Mt[i]=e,i}function Ig(e){for(var i=0;i!=392;++i)e[i]!==void 0&&ko(e[i],i)}function pl(){Mt=F5()}var e6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Xv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function t6(e){var i=typeof e=="number"?Mt[e]:e;return i=i.replace(Xv,"(\\d+)"),new RegExp("^"+i+"$")}function n6(e,i,n){var t=-1,r=-1,a=-1,o=-1,l=-1,m=-1;(i.match(Xv)||[]).forEach(function(h,x){var C=parseInt(n[x+1],10);switch(h.toLowerCase().charAt(0)){case"y":t=C;break;case"d":a=C;break;case"h":o=C;break;case"s":m=C;break;case"m":o>=0?l=C:r=C;break}}),m>=0&&l==-1&&r>=0&&(l=r,r=-1);var g=(""+(t>=0?t:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);g.length==7&&(g="0"+g),g.length==8&&(g="20"+g);var f=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return o==-1&&l==-1&&m==-1?g:t==-1&&r==-1&&a==-1?f:g+"T"+f}var i6=function(){var e={};e.version="1.2.0";function i(){for(var S=0,V=new Array(256),W=0;W!=256;++W)S=W,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,V[W]=S;return typeof Int32Array<"u"?new Int32Array(V):V}var n=i();function t(S){var V=0,W=0,Q=0,se=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Q=0;Q!=256;++Q)se[Q]=S[Q];for(Q=0;Q!=256;++Q)for(W=S[Q],V=256+Q;V<4096;V+=256)W=se[V]=W>>>8^S[W&255];var ae=[];for(Q=1;Q!=16;++Q)ae[Q-1]=typeof Int32Array<"u"?se.subarray(Q*256,Q*256+256):se.slice(Q*256,Q*256+256);return ae}var r=t(n),a=r[0],o=r[1],l=r[2],m=r[3],g=r[4],f=r[5],h=r[6],x=r[7],C=r[8],y=r[9],b=r[10],w=r[11],A=r[12],E=r[13],I=r[14];function K(S,V){for(var W=V^-1,Q=0,se=S.length;Q<se;)W=W>>>8^n[(W^S.charCodeAt(Q++))&255];return~W}function Z(S,V){for(var W=V^-1,Q=S.length-15,se=0;se<Q;)W=I[S[se++]^W&255]^E[S[se++]^W>>8&255]^A[S[se++]^W>>16&255]^w[S[se++]^W>>>24]^b[S[se++]]^y[S[se++]]^C[S[se++]]^x[S[se++]]^h[S[se++]]^f[S[se++]]^g[S[se++]]^m[S[se++]]^l[S[se++]]^o[S[se++]]^a[S[se++]]^n[S[se++]];for(Q+=15;se<Q;)W=W>>>8^n[(W^S[se++])&255];return~W}function k(S,V){for(var W=V^-1,Q=0,se=S.length,ae=0,ke=0;Q<se;)ae=S.charCodeAt(Q++),ae<128?W=W>>>8^n[(W^ae)&255]:ae<2048?(W=W>>>8^n[(W^(192|ae>>6&31))&255],W=W>>>8^n[(W^(128|ae&63))&255]):ae>=55296&&ae<57344?(ae=(ae&1023)+64,ke=S.charCodeAt(Q++)&1023,W=W>>>8^n[(W^(240|ae>>8&7))&255],W=W>>>8^n[(W^(128|ae>>2&63))&255],W=W>>>8^n[(W^(128|ke>>6&15|(ae&3)<<4))&255],W=W>>>8^n[(W^(128|ke&63))&255]):(W=W>>>8^n[(W^(224|ae>>12&15))&255],W=W>>>8^n[(W^(128|ae>>6&63))&255],W=W>>>8^n[(W^(128|ae&63))&255]);return~W}return e.table=n,e.bstr=K,e.buf=Z,e.str=k,e}(),_t=function(){var i={};i.version="1.2.1";function n(T,j){for(var U=T.split("/"),z=j.split("/"),G=0,q=0,pe=Math.min(U.length,z.length);G<pe;++G){if(q=U[G].length-z[G].length)return q;if(U[G]!=z[G])return U[G]<z[G]?-1:1}return U.length-z.length}function t(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:t(T.slice(0,-1));var j=T.lastIndexOf("/");return j===-1?T:T.slice(0,j+1)}function r(T){if(T.charAt(T.length-1)=="/")return r(T.slice(0,-1));var j=T.lastIndexOf("/");return j===-1?T:T.slice(j+1)}function a(T,j){typeof j=="string"&&(j=new Date(j));var U=j.getHours();U=U<<6|j.getMinutes(),U=U<<5|j.getSeconds()>>>1,T.write_shift(2,U);var z=j.getFullYear()-1980;z=z<<4|j.getMonth()+1,z=z<<5|j.getDate(),T.write_shift(2,z)}function o(T){var j=T.read_shift(2)&65535,U=T.read_shift(2)&65535,z=new Date,G=U&31;U>>>=5;var q=U&15;U>>>=4,z.setMilliseconds(0),z.setFullYear(U+1980),z.setMonth(q-1),z.setDate(G);var pe=j&31;j>>>=5;var be=j&63;return j>>>=6,z.setHours(j),z.setMinutes(be),z.setSeconds(pe<<1),z}function l(T){Zi(T,0);for(var j={},U=0;T.l<=T.length-4;){var z=T.read_shift(2),G=T.read_shift(2),q=T.l+G,pe={};switch(z){case 21589:U=T.read_shift(1),U&1&&(pe.mtime=T.read_shift(4)),G>5&&(U&2&&(pe.atime=T.read_shift(4)),U&4&&(pe.ctime=T.read_shift(4))),pe.mtime&&(pe.mt=new Date(pe.mtime*1e3));break}T.l=q,j[z]=pe}return j}var m;function g(){return m||(m={})}function f(T,j){if(T[0]==80&&T[1]==75)return so(T,j);if((T[0]|32)==109&&(T[1]|32)==105)return yl(T,j);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var U=3,z=512,G=0,q=0,pe=0,be=0,fe=0,he=[],_e=T.slice(0,512);Zi(_e,0);var Le=h(_e);switch(U=Le[0],U){case 3:z=512;break;case 4:z=4096;break;case 0:if(Le[1]==0)return so(T,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}z!==512&&(_e=T.slice(0,z),Zi(_e,28));var je=T.slice(0,z);x(_e,U);var rt=_e.read_shift(4,"i");if(U===3&&rt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+rt);_e.l+=4,pe=_e.read_shift(4,"i"),_e.l+=4,_e.chk("00100000","Mini Stream Cutoff Size: "),be=_e.read_shift(4,"i"),G=_e.read_shift(4,"i"),fe=_e.read_shift(4,"i"),q=_e.read_shift(4,"i");for(var $e=-1,Ke=0;Ke<109&&($e=_e.read_shift(4,"i"),!($e<0));++Ke)he[Ke]=$e;var at=C(T,z);w(fe,q,at,z,he);var vn=E(at,pe,he,z);vn[pe].name="!Directory",G>0&&be!==ke&&(vn[be].name="!MiniFAT"),vn[he[0]].name="!FAT",vn.fat_addrs=he,vn.ssz=z;var Ji={},Hn=[],er=[],_s=[];I(pe,vn,at,Hn,G,Ji,er,be),y(er,_s,Hn),Hn.shift();var xs={FileIndex:er,FullPaths:_s};return j&&j.raw&&(xs.raw={header:je,sectors:at}),xs}function h(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(Ne,"Header Signature: "),T.l+=16;var j=T.read_shift(2,"u");return[T.read_shift(2,"u"),j]}function x(T,j){var U=9;switch(T.l+=2,U=T.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function C(T,j){for(var U=Math.ceil(T.length/j)-1,z=[],G=1;G<U;++G)z[G-1]=T.slice(G*j,(G+1)*j);return z[U-1]=T.slice(U*j),z}function y(T,j,U){for(var z=0,G=0,q=0,pe=0,be=0,fe=U.length,he=[],_e=[];z<fe;++z)he[z]=_e[z]=z,j[z]=U[z];for(;be<_e.length;++be)z=_e[be],G=T[z].L,q=T[z].R,pe=T[z].C,he[z]===z&&(G!==-1&&he[G]!==G&&(he[z]=he[G]),q!==-1&&he[q]!==q&&(he[z]=he[q])),pe!==-1&&(he[pe]=z),G!==-1&&z!=he[z]&&(he[G]=he[z],_e.lastIndexOf(G)<be&&_e.push(G)),q!==-1&&z!=he[z]&&(he[q]=he[z],_e.lastIndexOf(q)<be&&_e.push(q));for(z=1;z<fe;++z)he[z]===z&&(q!==-1&&he[q]!==q?he[z]=he[q]:G!==-1&&he[G]!==G&&(he[z]=he[G]));for(z=1;z<fe;++z)if(T[z].type!==0){if(be=z,be!=he[be])do be=he[be],j[z]=j[be]+"/"+j[z];while(be!==0&&he[be]!==-1&&be!=he[be]);he[z]=-1}for(j[0]+="/",z=1;z<fe;++z)T[z].type!==2&&(j[z]+="/")}function b(T,j,U){for(var z=T.start,G=T.size,q=[],pe=z;U&&G>0&&pe>=0;)q.push(j.slice(pe*ae,pe*ae+ae)),G-=ae,pe=Is(U,pe*4);return q.length===0?Me(0):Gi(q).slice(0,T.size)}function w(T,j,U,z,G){var q=ke;if(T===ke){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var pe=U[T],be=(z>>>2)-1;if(!pe)return;for(var fe=0;fe<be&&(q=Is(pe,fe*4))!==ke;++fe)G.push(q);w(Is(pe,z-4),j-1,U,z,G)}}function A(T,j,U,z,G){var q=[],pe=[];G||(G=[]);var be=z-1,fe=0,he=0;for(fe=j;fe>=0;){G[fe]=!0,q[q.length]=fe,pe.push(T[fe]);var _e=U[Math.floor(fe*4/z)];if(he=fe*4&be,z<4+he)throw new Error("FAT boundary crossed: "+fe+" 4 "+z);if(!T[_e])break;fe=Is(T[_e],he)}return{nodes:q,data:KC([pe])}}function E(T,j,U,z){var G=T.length,q=[],pe=[],be=[],fe=[],he=z-1,_e=0,Le=0,je=0,rt=0;for(_e=0;_e<G;++_e)if(be=[],je=_e+j,je>=G&&(je-=G),!pe[je]){fe=[];var $e=[];for(Le=je;Le>=0;){$e[Le]=!0,pe[Le]=!0,be[be.length]=Le,fe.push(T[Le]);var Ke=U[Math.floor(Le*4/z)];if(rt=Le*4&he,z<4+rt)throw new Error("FAT boundary crossed: "+Le+" 4 "+z);if(!T[Ke]||(Le=Is(T[Ke],rt),$e[Le]))break}q[je]={nodes:be,data:KC([fe])}}return q}function I(T,j,U,z,G,q,pe,be){for(var fe=0,he=z.length?2:0,_e=j[T].data,Le=0,je=0,rt;Le<_e.length;Le+=128){var $e=_e.slice(Le,Le+128);Zi($e,64),je=$e.read_shift(2),rt=Rg($e,0,je-he),z.push(rt);var Ke={name:rt,type:$e.read_shift(1),color:$e.read_shift(1),L:$e.read_shift(4,"i"),R:$e.read_shift(4,"i"),C:$e.read_shift(4,"i"),clsid:$e.read_shift(16),state:$e.read_shift(4,"i"),start:0,size:0},at=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);at!==0&&(Ke.ct=K($e,$e.l-8));var vn=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);vn!==0&&(Ke.mt=K($e,$e.l-8)),Ke.start=$e.read_shift(4,"i"),Ke.size=$e.read_shift(4,"i"),Ke.size<0&&Ke.start<0&&(Ke.size=Ke.type=0,Ke.start=ke,Ke.name=""),Ke.type===5?(fe=Ke.start,G>0&&fe!==ke&&(j[fe].name="!StreamData")):Ke.size>=4096?(Ke.storage="fat",j[Ke.start]===void 0&&(j[Ke.start]=A(U,Ke.start,j.fat_addrs,j.ssz)),j[Ke.start].name=Ke.name,Ke.content=j[Ke.start].data.slice(0,Ke.size)):(Ke.storage="minifat",Ke.size<0?Ke.size=0:fe!==ke&&Ke.start!==ke&&j[fe]&&(Ke.content=b(Ke,j[fe].data,(j[be]||{}).data))),Ke.content&&Zi(Ke.content,0),q[rt]=Ke,pe.push(Ke)}}function K(T,j){return new Date((Wi(T,j+4)/1e7*Math.pow(2,32)+Wi(T,j)/1e7-11644473600)*1e3)}function Z(T,j){return g(),f(m.readFileSync(T),j)}function k(T,j){var U=j&&j.type;switch(U||Zt&&Buffer.isBuffer(T)&&(U="buffer"),U||"base64"){case"file":return Z(T,j);case"base64":return f(Qr(ea(T)),j);case"binary":return f(Qr(T),j)}return f(T,j)}function S(T,j){var U=j||{},z=U.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=z+"/",T.FileIndex[0]={name:z,type:5}),U.CLSID&&(T.FileIndex[0].clsid=U.CLSID),V(T)}function V(T){var j="Sh33tJ5";if(!_t.find(T,"/"+j)){var U=Me(4);U[0]=55,U[1]=U[3]=50,U[2]=54,T.FileIndex.push({name:j,type:2,content:U,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+j),W(T)}}function W(T,j){S(T);for(var U=!1,z=!1,G=T.FullPaths.length-1;G>=0;--G){var q=T.FileIndex[G];switch(q.type){case 0:z?U=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:z=!0,isNaN(q.R*q.L*q.C)&&(U=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!j)){var pe=new Date(1987,1,19),be=0,fe=Object.create?Object.create(null):{},he=[];for(G=0;G<T.FullPaths.length;++G)fe[T.FullPaths[G]]=!0,T.FileIndex[G].type!==0&&he.push([T.FullPaths[G],T.FileIndex[G]]);for(G=0;G<he.length;++G){var _e=t(he[G][0]);z=fe[_e],z||(he.push([_e,{name:r(_e).replace("/",""),type:1,clsid:Ve,ct:pe,mt:pe,content:null}]),fe[_e]=!0)}for(he.sort(function(rt,$e){return n(rt[0],$e[0])}),T.FullPaths=[],T.FileIndex=[],G=0;G<he.length;++G)T.FullPaths[G]=he[G][0],T.FileIndex[G]=he[G][1];for(G=0;G<he.length;++G){var Le=T.FileIndex[G],je=T.FullPaths[G];if(Le.name=r(je).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||Ve,G===0)Le.C=he.length>1?1:-1,Le.size=0,Le.type=5;else if(je.slice(-1)=="/"){for(be=G+1;be<he.length&&t(T.FullPaths[be])!=je;++be);for(Le.C=be>=he.length?-1:be,be=G+1;be<he.length&&t(T.FullPaths[be])!=t(je);++be);Le.R=be>=he.length?-1:be,Le.type=1}else t(T.FullPaths[G+1]||"")==t(je)&&(Le.R=G+1),Le.type=2}}}function Q(T,j){var U=j||{};if(U.fileType=="mad")return hn(T,U);switch(W(T),U.fileType){case"zip":return Js(T,U)}var z=function(rt){for(var $e=0,Ke=0,at=0;at<rt.FileIndex.length;++at){var vn=rt.FileIndex[at];if(vn.content){var Ji=vn.content.length;Ji>0&&(Ji<4096?$e+=Ji+63>>6:Ke+=Ji+511>>9)}}for(var Hn=rt.FullPaths.length+3>>2,er=$e+7>>3,_s=$e+127>>7,xs=er+Ke+Hn+_s,co=xs+127>>7,Pl=co<=109?0:Math.ceil((co-109)/127);xs+co+Pl+127>>7>co;)Pl=++co<=109?0:Math.ceil((co-109)/127);var Pa=[1,Pl,co,_s,Hn,Ke,$e,0];return rt.FileIndex[0].size=$e<<6,Pa[7]=(rt.FileIndex[0].start=Pa[0]+Pa[1]+Pa[2]+Pa[3]+Pa[4]+Pa[5])+(Pa[6]+7>>3),Pa}(T),G=Me(z[7]<<9),q=0,pe=0;{for(q=0;q<8;++q)G.write_shift(1,Ce[q]);for(q=0;q<8;++q)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),q=0;q<3;++q)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,z[2]),G.write_shift(4,z[0]+z[1]+z[2]+z[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,z[3]?z[0]+z[1]+z[2]-1:ke),G.write_shift(4,z[3]),G.write_shift(-4,z[1]?z[0]-1:ke),G.write_shift(4,z[1]),q=0;q<109;++q)G.write_shift(-4,q<z[2]?z[1]+q:-1)}if(z[1])for(pe=0;pe<z[1];++pe){for(;q<236+pe*127;++q)G.write_shift(-4,q<z[2]?z[1]+q:-1);G.write_shift(-4,pe===z[1]-1?ke:pe+1)}var be=function(rt){for(pe+=rt;q<pe-1;++q)G.write_shift(-4,q+1);rt&&(++q,G.write_shift(-4,ke))};for(pe=q=0,pe+=z[1];q<pe;++q)G.write_shift(-4,Oe.DIFSECT);for(pe+=z[2];q<pe;++q)G.write_shift(-4,Oe.FATSECT);be(z[3]),be(z[4]);for(var fe=0,he=0,_e=T.FileIndex[0];fe<T.FileIndex.length;++fe)_e=T.FileIndex[fe],_e.content&&(he=_e.content.length,!(he<4096)&&(_e.start=pe,be(he+511>>9)));for(be(z[6]+7>>3);G.l&511;)G.write_shift(-4,Oe.ENDOFCHAIN);for(pe=q=0,fe=0;fe<T.FileIndex.length;++fe)_e=T.FileIndex[fe],_e.content&&(he=_e.content.length,!(!he||he>=4096)&&(_e.start=pe,be(he+63>>6)));for(;G.l&511;)G.write_shift(-4,Oe.ENDOFCHAIN);for(q=0;q<z[4]<<2;++q){var Le=T.FullPaths[q];if(!Le||Le.length===0){for(fe=0;fe<17;++fe)G.write_shift(4,0);for(fe=0;fe<3;++fe)G.write_shift(4,-1);for(fe=0;fe<12;++fe)G.write_shift(4,0);continue}_e=T.FileIndex[q],q===0&&(_e.start=_e.size?_e.start-1:ke);var je=q===0&&U.root||_e.name;if(he=2*(je.length+1),G.write_shift(64,je,"utf16le"),G.write_shift(2,he),G.write_shift(1,_e.type),G.write_shift(1,_e.color),G.write_shift(-4,_e.L),G.write_shift(-4,_e.R),G.write_shift(-4,_e.C),_e.clsid)G.write_shift(16,_e.clsid,"hex");else for(fe=0;fe<4;++fe)G.write_shift(4,0);G.write_shift(4,_e.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,_e.start),G.write_shift(4,_e.size),G.write_shift(4,0)}for(q=1;q<T.FileIndex.length;++q)if(_e=T.FileIndex[q],_e.size>=4096)if(G.l=_e.start+1<<9,Zt&&Buffer.isBuffer(_e.content))_e.content.copy(G,G.l,0,_e.size),G.l+=_e.size+511&-512;else{for(fe=0;fe<_e.size;++fe)G.write_shift(1,_e.content[fe]);for(;fe&511;++fe)G.write_shift(1,0)}for(q=1;q<T.FileIndex.length;++q)if(_e=T.FileIndex[q],_e.size>0&&_e.size<4096)if(Zt&&Buffer.isBuffer(_e.content))_e.content.copy(G,G.l,0,_e.size),G.l+=_e.size+63&-64;else{for(fe=0;fe<_e.size;++fe)G.write_shift(1,_e.content[fe]);for(;fe&63;++fe)G.write_shift(1,0)}if(Zt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function se(T,j){var U=T.FullPaths.map(function(fe){return fe.toUpperCase()}),z=U.map(function(fe){var he=fe.split("/");return he[he.length-(fe.slice(-1)=="/"?2:1)]}),G=!1;j.charCodeAt(0)===47?(G=!0,j=U[0].slice(0,-1)+j):G=j.indexOf("/")!==-1;var q=j.toUpperCase(),pe=G===!0?U.indexOf(q):z.indexOf(q);if(pe!==-1)return T.FileIndex[pe];var be=!q.match(ed);for(q=q.replace(xr,""),be&&(q=q.replace(ed,"!")),pe=0;pe<U.length;++pe)if((be?U[pe].replace(ed,"!"):U[pe]).replace(xr,"")==q||(be?z[pe].replace(ed,"!"):z[pe]).replace(xr,"")==q)return T.FileIndex[pe];return null}var ae=64,ke=-2,Ne="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],Ve="00000000000000000000000000000000",Oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ke,FREESECT:-1,HEADER_SIGNATURE:Ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ve,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ze(T,j,U){g();var z=Q(T,U);m.writeFileSync(j,z)}function Se(T){for(var j=new Array(T.length),U=0;U<T.length;++U)j[U]=String.fromCharCode(T[U]);return j.join("")}function Fe(T,j){var U=Q(T,j);switch(j&&j.type||"buffer"){case"file":return g(),m.writeFileSync(j.filename,U),U;case"binary":return typeof U=="string"?U:Se(U);case"base64":return md(typeof U=="string"?U:Se(U));case"buffer":if(Zt)return Buffer.isBuffer(U)?U:Io(U);case"array":return typeof U=="string"?Qr(U):U}return U}var de;function X(T){try{var j=T.InflateRaw,U=new j;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)de=T;else throw new Error("zlib does not expose bytesRead")}catch(z){console.error("cannot use native zlib: "+(z.message||z))}}function te(T,j){if(!de)return Nd(T,j);var U=de.InflateRaw,z=new U,G=z._processChunk(T.slice(T.l),z._finishFlushFlag);return T.l+=z.bytesRead,G}function J(T){return de?de.deflateRawSync(T):Ct(T)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ge=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(T){var j=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(j>>16|j>>8|j)&255}for(var Pe=typeof Uint8Array<"u",ve=Pe?new Uint8Array(256):[],ot=0;ot<256;++ot)ve[ot]=Ee(ot);function H(T,j){var U=ve[T&255];return j<=8?U>>>8-j:(U=U<<8|ve[T>>8&255],j<=16?U>>>16-j:(U=U<<8|ve[T>>16&255],U>>>24-j))}function mt(T,j){var U=j&7,z=j>>>3;return(T[z]|(U<=6?0:T[z+1]<<8))>>>U&3}function Je(T,j){var U=j&7,z=j>>>3;return(T[z]|(U<=5?0:T[z+1]<<8))>>>U&7}function Ot(T,j){var U=j&7,z=j>>>3;return(T[z]|(U<=4?0:T[z+1]<<8))>>>U&15}function nt(T,j){var U=j&7,z=j>>>3;return(T[z]|(U<=3?0:T[z+1]<<8))>>>U&31}function Be(T,j){var U=j&7,z=j>>>3;return(T[z]|(U<=1?0:T[z+1]<<8))>>>U&127}function Ft(T,j,U){var z=j&7,G=j>>>3,q=(1<<U)-1,pe=T[G]>>>z;return U<8-z||(pe|=T[G+1]<<8-z,U<16-z)||(pe|=T[G+2]<<16-z,U<24-z)||(pe|=T[G+3]<<24-z),pe&q}function ln(T,j,U){var z=j&7,G=j>>>3;return z<=5?T[G]|=(U&7)<<z:(T[G]|=U<<z&255,T[G+1]=(U&7)>>8-z),j+3}function In(T,j,U){var z=j&7,G=j>>>3;return U=(U&1)<<z,T[G]|=U,j+1}function qi(T,j,U){var z=j&7,G=j>>>3;return U<<=z,T[G]|=U&255,U>>>=8,T[G+1]=U,j+8}function Un(T,j,U){var z=j&7,G=j>>>3;return U<<=z,T[G]|=U&255,U>>>=8,T[G+1]=U&255,T[G+2]=U>>>8,j+16}function Zn(T,j){var U=T.length,z=2*U>j?2*U:j+5,G=0;if(U>=j)return T;if(Zt){var q=IC(z);if(T.copy)T.copy(q);else for(;G<T.length;++G)q[G]=T[G];return q}else if(Pe){var pe=new Uint8Array(z);if(pe.set)pe.set(T);else for(;G<U;++G)pe[G]=T[G];return pe}return T.length=z,T}function Et(T){for(var j=new Array(T),U=0;U<T;++U)j[U]=0;return j}function Sn(T,j,U){var z=1,G=0,q=0,pe=0,be=0,fe=T.length,he=Pe?new Uint16Array(32):Et(32);for(q=0;q<32;++q)he[q]=0;for(q=fe;q<U;++q)T[q]=0;fe=T.length;var _e=Pe?new Uint16Array(fe):Et(fe);for(q=0;q<fe;++q)he[G=T[q]]++,z<G&&(z=G),_e[q]=0;for(he[0]=0,q=1;q<=z;++q)he[q+16]=be=be+he[q-1]<<1;for(q=0;q<fe;++q)be=T[q],be!=0&&(_e[q]=he[be+16]++);var Le=0;for(q=0;q<fe;++q)if(Le=T[q],Le!=0)for(be=H(_e[q],z)>>z-Le,pe=(1<<z+4-Le)-1;pe>=0;--pe)j[be|pe<<Le]=Le&15|q<<4;return z}var Qn=Pe?new Uint16Array(512):Et(512),Er=Pe?new Uint16Array(32):Et(32);if(!Pe){for(var Rt=0;Rt<512;++Rt)Qn[Rt]=0;for(Rt=0;Rt<32;++Rt)Er[Rt]=0}(function(){for(var T=[],j=0;j<32;j++)T.push(5);Sn(T,Er,32);var U=[];for(j=0;j<=143;j++)U.push(8);for(;j<=255;j++)U.push(9);for(;j<=279;j++)U.push(7);for(;j<=287;j++)U.push(8);Sn(U,Qn,288)})();var hi=function(){for(var j=Pe?new Uint8Array(32768):[],U=0,z=0;U<Te.length-1;++U)for(;z<Te[U+1];++z)j[z]=U;for(;z<32768;++z)j[z]=29;var G=Pe?new Uint8Array(259):[];for(U=0,z=0;U<ge.length-1;++U)for(;z<ge[U+1];++z)G[z]=U;function q(be,fe){for(var he=0;he<be.length;){var _e=Math.min(65535,be.length-he),Le=he+_e==be.length;for(fe.write_shift(1,+Le),fe.write_shift(2,_e),fe.write_shift(2,~_e&65535);_e-- >0;)fe[fe.l++]=be[he++]}return fe.l}function pe(be,fe){for(var he=0,_e=0,Le=Pe?new Uint16Array(32768):[];_e<be.length;){var je=Math.min(65535,be.length-_e);if(je<10){for(he=ln(fe,he,+(_e+je==be.length)),he&7&&(he+=8-(he&7)),fe.l=he/8|0,fe.write_shift(2,je),fe.write_shift(2,~je&65535);je-- >0;)fe[fe.l++]=be[_e++];he=fe.l*8;continue}he=ln(fe,he,+(_e+je==be.length)+2);for(var rt=0;je-- >0;){var $e=be[_e];rt=(rt<<5^$e)&32767;var Ke=-1,at=0;if((Ke=Le[rt])&&(Ke|=_e&-32768,Ke>_e&&(Ke-=32768),Ke<_e))for(;be[Ke+at]==be[_e+at]&&at<250;)++at;if(at>2){$e=G[at],$e<=22?he=qi(fe,he,ve[$e+1]>>1)-1:(qi(fe,he,3),he+=5,qi(fe,he,ve[$e-23]>>5),he+=3);var vn=$e<8?0:$e-4>>2;vn>0&&(Un(fe,he,at-ge[$e]),he+=vn),$e=j[_e-Ke],he=qi(fe,he,ve[$e]>>3),he-=3;var Ji=$e<4?0:$e-2>>1;Ji>0&&(Un(fe,he,_e-Ke-Te[$e]),he+=Ji);for(var Hn=0;Hn<at;++Hn)Le[rt]=_e&32767,rt=(rt<<5^be[_e])&32767,++_e;je-=at-1}else $e<=143?$e=$e+48:he=In(fe,he,1),he=qi(fe,he,ve[$e]),Le[rt]=_e&32767,++_e}he=qi(fe,he,0)-1}return fe.l=(he+7)/8|0,fe.l}return function(fe,he){return fe.length<8?q(fe,he):pe(fe,he)}}();function Ct(T){var j=Me(50+Math.floor(T.length*1.1)),U=hi(T,j);return j.slice(0,U)}var dn=Pe?new Uint16Array(32768):Et(32768),Ei=Pe?new Uint16Array(32768):Et(32768),zn=Pe?new Uint16Array(128):Et(128),Ir=1,fs=1;function nu(T,j){var U=nt(T,j)+257;j+=5;var z=nt(T,j)+1;j+=5;var G=Ot(T,j)+4;j+=4;for(var q=0,pe=Pe?new Uint8Array(19):Et(19),be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,he=Pe?new Uint8Array(8):Et(8),_e=Pe?new Uint8Array(8):Et(8),Le=pe.length,je=0;je<G;++je)pe[ee[je]]=q=Je(T,j),fe<q&&(fe=q),he[q]++,j+=3;var rt=0;for(he[0]=0,je=1;je<=fe;++je)_e[je]=rt=rt+he[je-1]<<1;for(je=0;je<Le;++je)(rt=pe[je])!=0&&(be[je]=_e[rt]++);var $e=0;for(je=0;je<Le;++je)if($e=pe[je],$e!=0){rt=ve[be[je]]>>8-$e;for(var Ke=(1<<7-$e)-1;Ke>=0;--Ke)zn[rt|Ke<<$e]=$e&7|je<<3}var at=[];for(fe=1;at.length<U+z;)switch(rt=zn[Be(T,j)],j+=rt&7,rt>>>=3){case 16:for(q=3+mt(T,j),j+=2,rt=at[at.length-1];q-- >0;)at.push(rt);break;case 17:for(q=3+Je(T,j),j+=3;q-- >0;)at.push(0);break;case 18:for(q=11+Be(T,j),j+=7;q-- >0;)at.push(0);break;default:at.push(rt),fe<rt&&(fe=rt);break}var vn=at.slice(0,U),Ji=at.slice(U);for(je=U;je<286;++je)vn[je]=0;for(je=z;je<30;++je)Ji[je]=0;return Ir=Sn(vn,dn,286),fs=Sn(Ji,Ei,30),j}function Qs(T,j){if(T[0]==3&&!(T[1]&3))return[ss(j),2];for(var U=0,z=0,G=IC(j||1<<18),q=0,pe=G.length>>>0,be=0,fe=0;!(z&1);){if(z=Je(T,U),U+=3,z>>>1)z>>1==1?(be=9,fe=5):(U=nu(T,U),be=Ir,fe=fs);else{U&7&&(U+=8-(U&7));var he=T[U>>>3]|T[(U>>>3)+1]<<8;if(U+=32,he>0)for(!j&&pe<q+he&&(G=Zn(G,q+he),pe=G.length);he-- >0;)G[q++]=T[U>>>3],U+=8;continue}for(;;){!j&&pe<q+32767&&(G=Zn(G,q+32767),pe=G.length);var _e=Ft(T,U,be),Le=z>>>1==1?Qn[_e]:dn[_e];if(U+=Le&15,Le>>>=4,!(Le>>>8&255))G[q++]=Le;else{if(Le==256)break;Le-=257;var je=Le<8?0:Le-4>>2;je>5&&(je=0);var rt=q+ge[Le];je>0&&(rt+=Ft(T,U,je),U+=je),_e=Ft(T,U,fe),Le=z>>>1==1?Er[_e]:Ei[_e],U+=Le&15,Le>>>=4;var $e=Le<4?0:Le-2>>1,Ke=Te[Le];for($e>0&&(Ke+=Ft(T,U,$e),U+=$e),!j&&pe<rt&&(G=Zn(G,rt+100),pe=G.length);q<rt;)G[q]=G[q-Ke],++q}}}return j?[G,U+7>>>3]:[G.slice(0,q),U+7>>>3]}function Nd(T,j){var U=T.slice(T.l||0),z=Qs(U,j);return T.l+=z[1],z[0]}function Ro(T,j){if(T)typeof console<"u"&&console.error(j);else throw new Error(j)}function so(T,j){var U=T;Zi(U,0);var z=[],G=[],q={FileIndex:z,FullPaths:G};S(q,{root:j.root});for(var pe=U.length-4;(U[pe]!=80||U[pe+1]!=75||U[pe+2]!=5||U[pe+3]!=6)&&pe>=0;)--pe;U.l=pe+4,U.l+=4;var be=U.read_shift(2);U.l+=6;var fe=U.read_shift(4);for(U.l=fe,pe=0;pe<be;++pe){U.l+=20;var he=U.read_shift(4),_e=U.read_shift(4),Le=U.read_shift(2),je=U.read_shift(2),rt=U.read_shift(2);U.l+=8;var $e=U.read_shift(4),Ke=l(U.slice(U.l+Le,U.l+Le+je));U.l+=Le+je+rt;var at=U.l;U.l=$e+4,bl(U,he,_e,q,Ke),U.l=at}return q}function bl(T,j,U,z,G){T.l+=2;var q=T.read_shift(2),pe=T.read_shift(2),be=o(T);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var fe=T.read_shift(4),he=T.read_shift(4),_e=T.read_shift(4),Le=T.read_shift(2),je=T.read_shift(2),rt="",$e=0;$e<Le;++$e)rt+=String.fromCharCode(T[T.l++]);if(je){var Ke=l(T.slice(T.l,T.l+je));(Ke[21589]||{}).mt&&(be=Ke[21589].mt),((G||{})[21589]||{}).mt&&(be=G[21589].mt)}T.l+=je;var at=T.slice(T.l,T.l+he);switch(pe){case 8:at=te(T,_e);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+pe)}var vn=!1;q&8&&(fe=T.read_shift(4),fe==134695760&&(fe=T.read_shift(4),vn=!0),he=T.read_shift(4),_e=T.read_shift(4)),he!=j&&Ro(vn,"Bad compressed size: "+j+" != "+he),_e!=U&&Ro(vn,"Bad uncompressed size: "+U+" != "+_e),Ml(z,rt,at,{unsafe:!0,mt:be})}function Js(T,j){var U=j||{},z=[],G=[],q=Me(1),pe=U.compression?8:0,be=0,fe=!1;fe&&(be|=8);var he=0,_e=0,Le=0,je=0,rt=T.FullPaths[0],$e=rt,Ke=T.FileIndex[0],at=[],vn=0;for(he=1;he<T.FullPaths.length;++he)if($e=T.FullPaths[he].slice(rt.length),Ke=T.FileIndex[he],!(!Ke.size||!Ke.content||$e=="Sh33tJ5")){var Ji=Le,Hn=Me($e.length);for(_e=0;_e<$e.length;++_e)Hn.write_shift(1,$e.charCodeAt(_e)&127);Hn=Hn.slice(0,Hn.l),at[je]=i6.buf(Ke.content,0);var er=Ke.content;pe==8&&(er=J(er)),q=Me(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,be),q.write_shift(2,pe),Ke.mt?a(q,Ke.mt):q.write_shift(4,0),q.write_shift(-4,be&8?0:at[je]),q.write_shift(4,be&8?0:er.length),q.write_shift(4,be&8?0:Ke.content.length),q.write_shift(2,Hn.length),q.write_shift(2,0),Le+=q.length,z.push(q),Le+=Hn.length,z.push(Hn),Le+=er.length,z.push(er),be&8&&(q=Me(12),q.write_shift(-4,at[je]),q.write_shift(4,er.length),q.write_shift(4,Ke.content.length),Le+=q.l,z.push(q)),q=Me(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,be),q.write_shift(2,pe),q.write_shift(4,0),q.write_shift(-4,at[je]),q.write_shift(4,er.length),q.write_shift(4,Ke.content.length),q.write_shift(2,Hn.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,Ji),vn+=q.l,G.push(q),vn+=Hn.length,G.push(Hn),++je}return q=Me(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,je),q.write_shift(2,je),q.write_shift(4,vn),q.write_shift(4,Le),q.write_shift(2,0),Gi([Gi(z),Gi(G),q])}var et={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function iu(T,j){if(T.ctype)return T.ctype;var U=T.name||"",z=U.match(/\.([^\.]+)$/);return z&&et[z[1]]||j&&(z=(U=j).match(/[\.\\]([^\.\\])+$/),z&&et[z[1]])?et[z[1]]:"application/octet-stream"}function ru(T){for(var j=md(T),U=[],z=0;z<j.length;z+=76)U.push(j.slice(z,z+76));return U.join(`\r
`)+`\r
`}function ya(T){var j=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var _e=he.charCodeAt(0).toString(16).toUpperCase();return"="+(_e.length==1?"0"+_e:_e)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],z=j.split(`\r
`),G=0;G<z.length;++G){var q=z[G];if(q.length==0){U.push("");continue}for(var pe=0;pe<q.length;){var be=76,fe=q.slice(pe,pe+be);fe.charAt(be-1)=="="?be--:fe.charAt(be-2)=="="?be-=2:fe.charAt(be-3)=="="&&(be-=3),fe=q.slice(pe,pe+be),pe+=be,pe<q.length&&(fe+="="),U.push(fe)}}return U.join(`\r
`)}function Ar(T){for(var j=[],U=0;U<T.length;++U){for(var z=T[U];U<=T.length&&z.charAt(z.length-1)=="=";)z=z.slice(0,z.length-1)+T[++U];j.push(z)}for(var G=0;G<j.length;++G)j[G]=j[G].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return Qr(j.join(`\r
`))}function Qt(T,j,U){for(var z="",G="",q="",pe,be=0;be<10;++be){var fe=j[be];if(!fe||fe.match(/^\s*$/))break;var he=fe.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":z=he[2].trim();break;case"content-type":q=he[2].trim();break;case"content-transfer-encoding":G=he[2].trim();break}}switch(++be,G.toLowerCase()){case"base64":pe=Qr(ea(j.slice(be).join("")));break;case"quoted-printable":pe=Ar(j.slice(be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var _e=Ml(T,z.slice(U.length),pe,{unsafe:!0});q&&(_e.ctype=q)}function yl(T,j){if(Se(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=j&&j.root||"",z=(Zt&&Buffer.isBuffer(T)?T.toString("binary"):Se(T)).split(`\r
`),G=0,q="";for(G=0;G<z.length;++G)if(q=z[G],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),U||(U=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),q.slice(0,U.length)!=U););var pe=(z[1]||"").match(/boundary="(.*?)"/);if(!pe)throw new Error("MAD cannot find boundary");var be="--"+(pe[1]||""),fe=[],he=[],_e={FileIndex:fe,FullPaths:he};S(_e);var Le,je=0;for(G=0;G<z.length;++G){var rt=z[G];rt!==be&&rt!==be+"--"||(je++&&Qt(_e,z.slice(Le,G),U),Le=G)}return _e}function hn(T,j){var U=j||{},z=U.boundary||"SheetJS";z="------="+z;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+z.slice(2)+'"',"","",""],q=T.FullPaths[0],pe=q,be=T.FileIndex[0],fe=1;fe<T.FullPaths.length;++fe)if(pe=T.FullPaths[fe].slice(q.length),be=T.FileIndex[fe],!(!be.size||!be.content||pe=="Sh33tJ5")){pe=pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(at){return"_x"+at.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(at){return"_u"+at.charCodeAt(0).toString(16)+"_"});for(var he=be.content,_e=Zt&&Buffer.isBuffer(he)?he.toString("binary"):Se(he),Le=0,je=Math.min(1024,_e.length),rt=0,$e=0;$e<=je;++$e)(rt=_e.charCodeAt($e))>=32&&rt<128&&++Le;var Ke=Le>=je*4/5;G.push(z),G.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+pe),G.push("Content-Transfer-Encoding: "+(Ke?"quoted-printable":"base64")),G.push("Content-Type: "+iu(be,pe)),G.push(""),G.push(Ke?ya(_e):ru(_e))}return G.push(z+`--\r
`),G.join(`\r
`)}function hs(T){var j={};return S(j,T),j}function Ml(T,j,U,z){var G=z&&z.unsafe;G||S(T);var q=!G&&_t.find(T,j);if(!q){var pe=T.FullPaths[0];j.slice(0,pe.length)==pe?pe=j:(pe.slice(-1)!="/"&&(pe+="/"),pe=(pe+j).replace("//","/")),q={name:r(j),type:2},T.FileIndex.push(q),T.FullPaths.push(pe),G||_t.utils.cfb_gc(T)}return q.content=U,q.size=U?U.length:0,z&&(z.CLSID&&(q.clsid=z.CLSID),z.mt&&(q.mt=z.mt),z.ct&&(q.ct=z.ct)),q}function ec(T,j){S(T);var U=_t.find(T,j);if(U){for(var z=0;z<T.FileIndex.length;++z)if(T.FileIndex[z]==U)return T.FileIndex.splice(z,1),T.FullPaths.splice(z,1),!0}return!1}function Fi(T,j,U){S(T);var z=_t.find(T,j);if(z){for(var G=0;G<T.FileIndex.length;++G)if(T.FileIndex[G]==z)return T.FileIndex[G].name=r(U),T.FullPaths[G]=U,!0}return!1}function Ma(T){W(T,!0)}return i.find=se,i.read=k,i.parse=f,i.write=Fe,i.writeFile=Ze,i.utils={cfb_new:hs,cfb_add:Ml,cfb_del:ec,cfb_mov:Fi,cfb_gc:Ma,ReadShift:nd,CheckField:ub,prep_blob:Zi,bconcat:Gi,use_zlib:X,_deflateRaw:Ct,_inflateRaw:Nd,consts:Oe},i}(),il;function r6(e){return typeof e=="string"?Eg(e):Array.isArray(e)?E5(e):e}function Pd(e,i,n){if(typeof il<"u"&&il.writeFileSync)return n?il.writeFileSync(e,i,n):il.writeFileSync(e,i);if(typeof Deno<"u"){if(n&&typeof i=="string")switch(n){case"utf8":i=new TextEncoder(n).encode(i);break;case"binary":i=Eg(i);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,i)}var t=n=="utf8"?no(i):i;if(typeof IE_SaveFile<"u")return IE_SaveFile(t,e);if(typeof Blob<"u"){var r=new Blob([r6(t)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,e);if(typeof saveAs<"u")return saveAs(r,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(i)&&(i=ms(i)),l.write(i),l.close(),i}catch(m){if(!m.message||!m.message.match(/onstruct/))throw m}throw new Error("cannot save file "+e)}function a6(e){if(typeof il<"u")return il.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var i=File(e);i.open("r"),i.encoding="binary";var n=i.read();return i.close(),n}catch(t){if(!t.message||!t.message.match(/onstruct/))throw t}throw new Error("Cannot access file "+e)}function ci(e){for(var i=Object.keys(e),n=[],t=0;t<i.length;++t)Object.prototype.hasOwnProperty.call(e,i[t])&&n.push(i[t]);return n}function VC(e,i){for(var n=[],t=ci(e),r=0;r!==t.length;++r)n[e[t[r]][i]]==null&&(n[e[t[r]][i]]=t[r]);return n}function Ag(e){for(var i=[],n=ci(e),t=0;t!==n.length;++t)i[e[n[t]]]=n[t];return i}function Dg(e){for(var i=[],n=ci(e),t=0;t!==n.length;++t)i[e[n[t]]]=parseInt(n[t],10);return i}function o6(e){for(var i=[],n=ci(e),t=0;t!==n.length;++t)i[e[n[t]]]==null&&(i[e[n[t]]]=[]),i[e[n[t]]].push(n[t]);return i}var vg=new Date(1899,11,30,0,0,0);function Di(e,i){var n=e.getTime();i&&(n-=1462*24*60*60*1e3);var t=vg.getTime()+(e.getTimezoneOffset()-vg.getTimezoneOffset())*6e4;return(n-t)/(24*60*60*1e3)}var Kv=new Date,s6=vg.getTime()+(Kv.getTimezoneOffset()-vg.getTimezoneOffset())*6e4,UC=Kv.getTimezoneOffset();function Fg(e){var i=new Date;return i.setTime(e*24*60*60*1e3+s6),i.getTimezoneOffset()!==UC&&i.setTime(i.getTime()+(i.getTimezoneOffset()-UC)*6e4),i}function c6(e){var i=0,n=0,t=!1,r=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=r.length;++a)if(r[a]){switch(n=1,a>3&&(t=!0),r[a].slice(r[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[a].slice(r[a].length-1));case"D":n*=24;case"H":n*=60;case"M":if(t)n*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}i+=n*parseInt(r[a],10)}return i}var zC=new Date("2017-02-19T19:06:09.000Z"),Zv=isNaN(zC.getFullYear())?new Date("2/19/17"):zC,l6=Zv.getFullYear()==2017;function Ln(e,i){var n=new Date(e);if(l6)return i>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):i<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(Zv.getFullYear()==1917&&!isNaN(n.getFullYear())){var t=n.getFullYear();return e.indexOf(""+t)>-1||n.setFullYear(n.getFullYear()+100),n}var r=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ls(e,i){if(Zt&&Buffer.isBuffer(e)){if(i){if(e[0]==255&&e[1]==254)return no(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return no(Lv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(i){if(e[0]==255&&e[1]==254)return no(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return no(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return n[a]||a})}catch{}for(var t=[],r=0;r!=e.length;++r)t.push(String.fromCharCode(e[r]));return t.join("")}function Vn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=Vn(e[n]));return i}function ai(e,i){for(var n="";n.length<i;)n+=e;return n}function Fa(e){var i=Number(e);if(!isNaN(i))return isFinite(i)?i:NaN;if(!/\d/.test(e))return i;var n=1,t=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(i=Number(t))||(t=t.replace(/[(](.*)[)]/,function(r,a){return n=-n,a}),!isNaN(i=Number(t)))?i/n:i}var d6=["january","february","march","april","may","june","july","august","september","october","november","december"];function dl(e){var i=new Date(e),n=new Date(NaN),t=i.getYear(),r=i.getMonth(),a=i.getDate();if(isNaN(a))return n;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&d6.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return t<0||t>8099?n:(r>0||a>1)&&t!=101?i:e.match(/[^-0-9:,\/\\]/)?n:i}var m6=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(n,t,r){if(e||typeof t=="string")return n.split(t);for(var a=n.split(t),o=[a[0]],l=1;l<a.length;++l)o.push(r),o.push(a[l]);return o}}();function Qv(e){return e?e.content&&e.type?Ls(e.content,!0):e.data?Jl(e.data):e.asNodeBuffer&&Zt?Jl(e.asNodeBuffer().toString("binary")):e.asBinary?Jl(e.asBinary()):e._data&&e._data.getContent?Jl(Ls(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Jv(e){if(!e)return null;if(e.data)return up(e.data);if(e.asNodeBuffer&&Zt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var i=e._data.getContent();return typeof i=="string"?up(i):Array.prototype.slice.call(i)}return e.content&&e.type?e.content:null}function g6(e){return e&&e.name.slice(-4)===".bin"?Jv(e):Qv(e)}function _a(e,i){for(var n=e.FullPaths||ci(e.files),t=i.toLowerCase().replace(/[\/]/g,"\\"),r=t.replace(/\\/g,"/"),a=0;a<n.length;++a){var o=n[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(t==o||r==o)return e.files?e.files[n[a]]:e.FileIndex[a]}return null}function Ip(e,i){var n=_a(e,i);if(n==null)throw new Error("Cannot find file "+i+" in zip");return n}function ki(e,i,n){if(!n)return g6(Ip(e,i));if(!i)return null;try{return ki(e,i)}catch{return null}}function Jr(e,i,n){if(!n)return Qv(Ip(e,i));if(!i)return null;try{return Jr(e,i)}catch{return null}}function eb(e,i,n){if(!n)return Jv(Ip(e,i));if(!i)return null;try{return eb(e,i)}catch{return null}}function jC(e){for(var i=e.FullPaths||ci(e.files),n=[],t=0;t<i.length;++t)i[t].slice(-1)!="/"&&n.push(i[t].replace(/^Root Entry[\/]/,""));return n.sort()}function Yt(e,i,n){if(e.FullPaths){if(typeof n=="string"){var t;return Zt?t=Io(n):t=I5(n),_t.utils.cfb_add(e,i,t)}_t.utils.cfb_add(e,i,n)}else e.file(i,n)}function Ap(){return _t.utils.cfb_new()}function tb(e,i){switch(i.type){case"base64":return _t.read(e,{type:"base64"});case"binary":return _t.read(e,{type:"binary"});case"buffer":case"array":return _t.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+i.type)}function td(e,i){if(e.charAt(0)=="/")return e.slice(1);var n=i.split("/");i.slice(-1)!="/"&&n.pop();for(var t=e.split("/");t.length!==0;){var r=t.shift();r===".."?n.pop():r!=="."&&n.push(r)}return n.join("/")}var fi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,u6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,$C=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,p6=/<[^>]*>/g,br=fi.match($C)?$C:p6,f6=/<\w*:/,h6=/<(\/?)\w+:/;function kt(e,i,n){for(var t={},r=0,a=0;r!==e.length&&!((a=e.charCodeAt(r))===32||a===10||a===13);++r);if(i||(t[0]=e.slice(0,r)),r===e.length)return t;var o=e.match(u6),l=0,m="",g=0,f="",h="",x=1;if(o)for(g=0;g!=o.length;++g){for(h=o[g],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(f=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(x=(r=h.charCodeAt(a+1))==34||r==39?1:0,m=h.slice(a+1+x,h.length-x),l=0;l!=f.length&&f.charCodeAt(l)!==58;++l);if(l===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),t[f]=m,n||(t[f.toLowerCase()]=m);else{var C=(l===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(l+1);if(t[C]&&f.slice(l-3,l)=="ext")continue;t[C]=m,n||(t[C.toLowerCase()]=m)}}return t}function ro(e){return e.replace(h6,"<$1")}var nb={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Dp=Ag(nb),sn=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,i=/_x([\da-fA-F]{4})_/ig;return function n(t){var r=t+"",a=r.indexOf("<![CDATA[");if(a==-1)return r.replace(e,function(l,m){return nb[l]||String.fromCharCode(parseInt(m,l.indexOf("x")>-1?16:10))||l}).replace(i,function(l,m){return String.fromCharCode(parseInt(m,16))});var o=r.indexOf("]]>");return n(r.slice(0,a))+r.slice(a+9,o)+n(r.slice(o+3))}}(),Fp=/[&<>'"]/g,_6=/[\u0000-\u0008\u000b-\u001f]/g;function On(e){var i=e+"";return i.replace(Fp,function(n){return Dp[n]}).replace(_6,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function YC(e){return On(e).replace(/ /g,"_x0020_")}var ib=/[\u0000-\u001f]/g;function Rp(e){var i=e+"";return i.replace(Fp,function(n){return Dp[n]}).replace(/\n/g,"<br/>").replace(ib,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function x6(e){var i=e+"";return i.replace(Fp,function(n){return Dp[n]}).replace(ib,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}var WC=function(){var e=/&#(\d+);/g;function i(n,t){return String.fromCharCode(parseInt(t,10))}return function(t){return t.replace(e,i)}}();function C6(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Nn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ep(e){for(var i="",n=0,t=0,r=0,a=0,o=0,l=0;n<e.length;){if(t=e.charCodeAt(n++),t<128){i+=String.fromCharCode(t);continue}if(r=e.charCodeAt(n++),t>191&&t<224){o=(t&31)<<6,o|=r&63,i+=String.fromCharCode(o);continue}if(a=e.charCodeAt(n++),t<240){i+=String.fromCharCode((t&15)<<12|(r&63)<<6|a&63);continue}o=e.charCodeAt(n++),l=((t&7)<<18|(r&63)<<12|(a&63)<<6|o&63)-65536,i+=String.fromCharCode(55296+(l>>>10&1023)),i+=String.fromCharCode(56320+(l&1023))}return i}function GC(e){var i=ss(2*e.length),n,t,r=1,a=0,o=0,l;for(t=0;t<e.length;t+=r)r=1,(l=e.charCodeAt(t))<128?n=l:l<224?(n=(l&31)*64+(e.charCodeAt(t+1)&63),r=2):l<240?(n=(l&15)*4096+(e.charCodeAt(t+1)&63)*64+(e.charCodeAt(t+2)&63),r=3):(r=4,n=(l&7)*262144+(e.charCodeAt(t+1)&63)*4096+(e.charCodeAt(t+2)&63)*64+(e.charCodeAt(t+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(i[a++]=o&255,i[a++]=o>>>8,o=0),i[a++]=n%256,i[a++]=n>>>8;return i.slice(0,a).toString("ucs2")}function HC(e){return Io(e,"binary").toString("utf8")}var sg="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",wn=Zt&&(HC(sg)==ep(sg)&&HC||GC(sg)==ep(sg)&&GC)||ep,no=Zt?function(e){return Io(e,"utf8").toString("binary")}:function(e){for(var i=[],n=0,t=0,r=0;n<e.length;)switch(t=e.charCodeAt(n++),!0){case t<128:i.push(String.fromCharCode(t));break;case t<2048:i.push(String.fromCharCode(192+(t>>6))),i.push(String.fromCharCode(128+(t&63)));break;case(t>=55296&&t<57344):t-=55296,r=e.charCodeAt(n++)-56320+(t<<10),i.push(String.fromCharCode(240+(r>>18&7))),i.push(String.fromCharCode(144+(r>>12&63))),i.push(String.fromCharCode(128+(r>>6&63))),i.push(String.fromCharCode(128+(r&63)));break;default:i.push(String.fromCharCode(224+(t>>12))),i.push(String.fromCharCode(128+(t>>6&63))),i.push(String.fromCharCode(128+(t&63)))}return i.join("")},ud=function(){var e={};return function(n,t){var r=n+"|"+(t||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",t||"")}}(),rb=function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(i){return[new RegExp("&"+i[0]+";","ig"),i[1]]});return function(n){for(var t=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<e.length;++r)t=t.replace(e[r][0],e[r][1]);return t}}(),v6=function(){var e={};return function(n){return e[n]!==void 0?e[n]:e[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),b6=/<\/?(?:vt:)?variant>/g,y6=/<(?:vt:)([^>]*)>([\s\S]*)</;function qC(e,i){var n=kt(e),t=e.match(v6(n.baseType))||[],r=[];if(t.length!=n.size){if(i.WTF)throw new Error("unexpected vector length "+t.length+" != "+n.size);return r}return t.forEach(function(a){var o=a.replace(b6,"").match(y6);o&&r.push({v:wn(o[2]),t:o[1]})}),r}var ab=/(^\s|\s$|\n)/;function Qi(e,i){return"<"+e+(i.match(ab)?' xml:space="preserve"':"")+">"+i+"</"+e+">"}function pd(e){return ci(e).map(function(i){return" "+i+'="'+e[i]+'"'}).join("")}function Ye(e,i,n){return"<"+e+(n!=null?pd(n):"")+(i!=null?(i.match(ab)?' xml:space="preserve"':"")+">"+i+"</"+e:"/")+">"}function pp(e,i){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(i)throw n}return""}function M6(e,i){switch(typeof e){case"string":var n=Ye("vt:lpwstr",On(e));return i&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return Ye((e|0)==e?"vt:i4":"vt:r8",On(String(e)));case"boolean":return Ye("vt:bool",e?"true":"false")}if(e instanceof Date)return Ye("vt:filetime",pp(e));throw new Error("Unable to serialize "+e)}function Bp(e){if(Zt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return wn(ms(kp(e)));throw new Error("Bad input format: expected Buffer or string")}var fd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ai={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$s=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Zr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function P6(e,i){for(var n=1-2*(e[i+7]>>>7),t=((e[i+7]&127)<<4)+(e[i+6]>>>4&15),r=e[i+6]&15,a=5;a>=0;--a)r=r*256+e[i+a];return t==2047?r==0?n*(1/0):NaN:(t==0?t=-1022:(t-=1023,r+=Math.pow(2,52)),n*Math.pow(2,t-52)*r)}function O6(e,i,n){var t=(i<0||1/i==-1/0?1:0)<<7,r=0,a=0,o=t?-i:i;isFinite(o)?o==0?r=a=0:(r=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-r),r<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?r=-1022:(a-=Math.pow(2,52),r+=1023)):(r=2047,a=isNaN(i)?26985:0);for(var l=0;l<=5;++l,a/=256)e[n+l]=a&255;e[n+6]=(r&15)<<4|a&15,e[n+7]=r>>4|t}var XC=function(e){for(var i=[],n=10240,t=0;t<e[0].length;++t)if(e[0][t])for(var r=0,a=e[0][t].length;r<a;r+=n)i.push.apply(i,e[0][t].slice(r,r+n));return i},KC=Zt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(i){return Buffer.isBuffer(i)?i:Io(i)})):XC(e)}:XC,ZC=function(e,i,n){for(var t=[],r=i;r<n;r+=2)t.push(String.fromCharCode(wo(e,r)));return t.join("").replace(xr,"")},Rg=Zt?function(e,i,n){return Buffer.isBuffer(e)?e.toString("utf16le",i,n).replace(xr,""):ZC(e,i,n)}:ZC,QC=function(e,i,n){for(var t=[],r=i;r<i+n;++r)t.push(("0"+e[r].toString(16)).slice(-2));return t.join("")},ob=Zt?function(e,i,n){return Buffer.isBuffer(e)?e.toString("hex",i,i+n):QC(e,i,n)}:QC,JC=function(e,i,n){for(var t=[],r=i;r<n;r++)t.push(String.fromCharCode(nl(e,r)));return t.join("")},fl=Zt?function(i,n,t){return Buffer.isBuffer(i)?i.toString("utf8",n,t):JC(i,n,t)}:JC,sb=function(e,i){var n=Wi(e,i);return n>0?fl(e,i+4,i+4+n-1):""},Np=sb,cb=function(e,i){var n=Wi(e,i);return n>0?fl(e,i+4,i+4+n-1):""},Lp=cb,lb=function(e,i){var n=2*Wi(e,i);return n>0?fl(e,i+4,i+4+n-1):""},Vp=lb,db=function(i,n){var t=Wi(i,n);return t>0?Rg(i,n+4,n+4+t):""},Up=db,mb=function(e,i){var n=Wi(e,i);return n>0?fl(e,i+4,i+4+n):""},zp=mb,gb=function(e,i){return P6(e,i)},bg=gb,jp=function(i){return Array.isArray(i)||typeof Uint8Array<"u"&&i instanceof Uint8Array};Zt&&(Np=function(i,n){if(!Buffer.isBuffer(i))return sb(i,n);var t=i.readUInt32LE(n);return t>0?i.toString("utf8",n+4,n+4+t-1):""},Lp=function(i,n){if(!Buffer.isBuffer(i))return cb(i,n);var t=i.readUInt32LE(n);return t>0?i.toString("utf8",n+4,n+4+t-1):""},Vp=function(i,n){if(!Buffer.isBuffer(i))return lb(i,n);var t=2*i.readUInt32LE(n);return i.toString("utf16le",n+4,n+4+t-1)},Up=function(i,n){if(!Buffer.isBuffer(i))return db(i,n);var t=i.readUInt32LE(n);return i.toString("utf16le",n+4,n+4+t)},zp=function(i,n){if(!Buffer.isBuffer(i))return mb(i,n);var t=i.readUInt32LE(n);return i.toString("utf8",n+4,n+4+t)},bg=function(i,n){return Buffer.isBuffer(i)?i.readDoubleLE(n):gb(i,n)},jp=function(i){return Buffer.isBuffer(i)||Array.isArray(i)||typeof Uint8Array<"u"&&i instanceof Uint8Array});function w6(){Rg=function(e,i,n){return Cn.utils.decode(1200,e.slice(i,n)).replace(xr,"")},fl=function(e,i,n){return Cn.utils.decode(65001,e.slice(i,n))},Np=function(e,i){var n=Wi(e,i);return n>0?Cn.utils.decode(ll,e.slice(i+4,i+4+n-1)):""},Lp=function(e,i){var n=Wi(e,i);return n>0?Cn.utils.decode(io,e.slice(i+4,i+4+n-1)):""},Vp=function(e,i){var n=2*Wi(e,i);return n>0?Cn.utils.decode(1200,e.slice(i+4,i+4+n-1)):""},Up=function(e,i){var n=Wi(e,i);return n>0?Cn.utils.decode(1200,e.slice(i+4,i+4+n)):""},zp=function(e,i){var n=Wi(e,i);return n>0?Cn.utils.decode(65001,e.slice(i+4,i+4+n)):""}}typeof Cn<"u"&&w6();var nl=function(e,i){return e[i]},wo=function(e,i){return e[i+1]*256+e[i]},S6=function(e,i){var n=e[i+1]*256+e[i];return n<32768?n:(65535-n+1)*-1},Wi=function(e,i){return e[i+3]*(1<<24)+(e[i+2]<<16)+(e[i+1]<<8)+e[i]},Is=function(e,i){return e[i+3]<<24|e[i+2]<<16|e[i+1]<<8|e[i]},k6=function(e,i){return e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3]};function nd(e,i){var n="",t,r,a=[],o,l,m,g;switch(i){case"dbcs":if(g=this.l,Zt&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)n+=String.fromCharCode(wo(this,g)),g+=2;e*=2;break;case"utf8":n=fl(this,this.l,this.l+e);break;case"utf16le":e*=2,n=Rg(this,this.l,this.l+e);break;case"wstr":if(typeof Cn<"u")n=Cn.utils.decode(io,this.slice(this.l,this.l+2*e));else return nd.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":n=Np(this,this.l),e=4+Wi(this,this.l);break;case"lpstr-cp":n=Lp(this,this.l),e=4+Wi(this,this.l);break;case"lpwstr":n=Vp(this,this.l),e=4+2*Wi(this,this.l);break;case"lpp4":e=4+Wi(this,this.l),n=Up(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Wi(this,this.l),n=zp(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(o=nl(this,this.l+e++))!==0;)a.push(og(o));n=a.join("");break;case"_wstr":for(e=0,n="";(o=wo(this,this.l+e))!==0;)a.push(og(o)),e+=2;e+=2,n=a.join("");break;case"dbcs-cont":for(n="",g=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(g)!==-1)return o=nl(this,g),this.l=g+1,l=nd.call(this,e-m,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(og(wo(this,g))),g+=2}n=a.join(""),e*=2;break;case"cpstr":if(typeof Cn<"u"){n=Cn.utils.decode(io,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(n="",g=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(g)!==-1)return o=nl(this,g),this.l=g+1,l=nd.call(this,e-m,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(og(nl(this,g))),g+=1}n=a.join("");break;default:switch(e){case 1:return t=nl(this,this.l),this.l++,t;case 2:return t=(i==="i"?S6:wo)(this,this.l),this.l+=2,t;case 4:case-4:return i==="i"||!(this[this.l+3]&128)?(t=(e>0?Is:k6)(this,this.l),this.l+=4,t):(r=Wi(this,this.l),this.l+=4,r);case 8:case-8:if(i==="f")return e==8?r=bg(this,this.l):r=bg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:n=ob(this,this.l,e);break}}return this.l+=e,n}var T6=function(e,i,n){e[n]=i&255,e[n+1]=i>>>8&255,e[n+2]=i>>>16&255,e[n+3]=i>>>24&255},E6=function(e,i,n){e[n]=i&255,e[n+1]=i>>8&255,e[n+2]=i>>16&255,e[n+3]=i>>24&255},I6=function(e,i,n){e[n]=i&255,e[n+1]=i>>>8&255};function A6(e,i,n){var t=0,r=0;if(n==="dbcs"){for(r=0;r!=i.length;++r)I6(this,i.charCodeAt(r),this.l+2*r);t=2*i.length}else if(n==="sbcs"){if(typeof Cn<"u"&&ll==874)for(r=0;r!=i.length;++r){var a=Cn.utils.encode(ll,i.charAt(r));this[this.l+r]=a[0]}else for(i=i.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=i.length;++r)this[this.l+r]=i.charCodeAt(r)&255;t=i.length}else if(n==="hex"){for(;r<e;++r)this[this.l++]=parseInt(i.slice(2*r,2*r+2),16)||0;return this}else if(n==="utf16le"){var o=Math.min(this.l+e,this.length);for(r=0;r<Math.min(i.length,e);++r){var l=i.charCodeAt(r);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:t=1,this[this.l]=i&255;break;case 2:t=2,this[this.l]=i&255,i>>>=8,this[this.l+1]=i&255;break;case 3:t=3,this[this.l]=i&255,i>>>=8,this[this.l+1]=i&255,i>>>=8,this[this.l+2]=i&255;break;case 4:t=4,T6(this,i,this.l);break;case 8:if(t=8,n==="f"){O6(this,i,this.l);break}case 16:break;case-4:t=4,E6(this,i,this.l);break}return this.l+=t,this}function ub(e,i){var n=ob(this,this.l,e.length>>1);if(n!==e)throw new Error(i+"Expected "+e+" saw "+n);this.l+=e.length>>1}function Zi(e,i){e.l=i,e.read_shift=nd,e.chk=ub,e.write_shift=A6}function vr(e,i){e.l+=i}function Me(e){var i=ss(e);return Zi(i,0),i}function Ao(e,i,n){if(e){var t,r,a;Zi(e,e.l||0);for(var o=e.length,l=0,m=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var g=bd[l]||bd[65535];for(t=e.read_shift(1),a=t&127,r=1;r<4&&t&128;++r)a+=((t=e.read_shift(1))&127)<<7*r;m=e.l+a;var f=g.f&&g.f(e,a,n);if(e.l=m,i(f,g,l))return}}}function jr(){var e=[],i=Zt?256:2048,n=function(g){var f=Me(g);return Zi(f,0),f},t=n(i),r=function(){t&&(t.length>t.l&&(t=t.slice(0,t.l),t.l=t.length),t.length>0&&e.push(t),t=null)},a=function(g){return t&&g<t.length-t.l?t:(r(),t=n(Math.max(g+1,i)))},o=function(){return r(),Gi(e)},l=function(g){r(),t=g,t.l==null&&(t.l=t.length),a(i)};return{next:a,push:l,end:o,_bufs:e}}function Ae(e,i,n,t){var r=+i,a;if(!isNaN(r)){t||(t=bd[r].p||(n||[]).length||0),a=1+(r>=128?1:0)+1,t>=128&&++a,t>=16384&&++a,t>=2097152&&++a;var o=e.next(a);r<=127?o.write_shift(1,r):(o.write_shift(1,(r&127)+128),o.write_shift(1,r>>7));for(var l=0;l!=4;++l)if(t>=128)o.write_shift(1,(t&127)+128),t>>=7;else{o.write_shift(1,t);break}t>0&&jp(n)&&e.push(n)}}function id(e,i,n){var t=Vn(e);if(i.s?(t.cRel&&(t.c+=i.s.c),t.rRel&&(t.r+=i.s.r)):(t.cRel&&(t.c+=i.c),t.rRel&&(t.r+=i.r)),!n||n.biff<12){for(;t.c>=256;)t.c-=256;for(;t.r>=65536;)t.r-=65536}return t}function ev(e,i,n){var t=Vn(e);return t.s=id(t.s,i.s,n),t.e=id(t.e,i.s,n),t}function rd(e,i){if(e.cRel&&e.c<0)for(e=Vn(e);e.c<0;)e.c+=i>8?16384:256;if(e.rRel&&e.r<0)for(e=Vn(e);e.r<0;)e.r+=i>8?1048576:i>5?65536:16384;var n=Pt(e);return!e.cRel&&e.cRel!=null&&(n=R6(n)),!e.rRel&&e.rRel!=null&&(n=D6(n)),n}function tp(e,i){return e.s.r==0&&!e.s.rRel&&e.e.r==(i.biff>=12?1048575:i.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Xn(e.s.c)+":"+(e.e.cRel?"":"$")+Xn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(i.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+pi(e.s.r)+":"+(e.e.rRel?"":"$")+pi(e.e.r):rd(e.s,i.biff)+":"+rd(e.e,i.biff)}function $p(e){return parseInt(F6(e),10)-1}function pi(e){return""+(e+1)}function D6(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function F6(e){return e.replace(/\$(\d+)$/,"$1")}function Yp(e){for(var i=B6(e),n=0,t=0;t!==i.length;++t)n=26*n+i.charCodeAt(t)-64;return n-1}function Xn(e){if(e<0)throw new Error("invalid column "+e);var i="";for(++e;e;e=Math.floor((e-1)/26))i=String.fromCharCode((e-1)%26+65)+i;return i}function R6(e){return e.replace(/^([A-Z])/,"$$$1")}function B6(e){return e.replace(/^\$([A-Z])/,"$1")}function N6(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kn(e){for(var i=0,n=0,t=0;t<e.length;++t){var r=e.charCodeAt(t);r>=48&&r<=57?i=10*i+(r-48):r>=65&&r<=90&&(n=26*n+(r-64))}return{c:n-1,r:i-1}}function Pt(e){for(var i=e.c+1,n="";i;i=(i-1)/26|0)n=String.fromCharCode((i-1)%26+65)+n;return n+(e.r+1)}function $r(e){var i=e.indexOf(":");return i==-1?{s:Kn(e),e:Kn(e)}:{s:Kn(e.slice(0,i)),e:Kn(e.slice(i+1))}}function zt(e,i){return typeof i>"u"||typeof i=="number"?zt(e.s,e.e):(typeof e!="string"&&(e=Pt(e)),typeof i!="string"&&(i=Pt(i)),e==i?e:e+":"+i)}function cn(e){var i={s:{c:0,r:0},e:{c:0,r:0}},n=0,t=0,r=0,a=e.length;for(n=0;t<a&&!((r=e.charCodeAt(t)-64)<1||r>26);++t)n=26*n+r;for(i.s.c=--n,n=0;t<a&&!((r=e.charCodeAt(t)-48)<0||r>9);++t)n=10*n+r;if(i.s.r=--n,t===a||r!=10)return i.e.c=i.s.c,i.e.r=i.s.r,i;for(++t,n=0;t!=a&&!((r=e.charCodeAt(t)-64)<1||r>26);++t)n=26*n+r;for(i.e.c=--n,n=0;t!=a&&!((r=e.charCodeAt(t)-48)<0||r>9);++t)n=10*n+r;return i.e.r=--n,i}function tv(e,i){var n=e.t=="d"&&i instanceof Date;if(e.z!=null)try{return e.w=va(e.z,n?Di(i):i)}catch{}try{return e.w=va((e.XF||{}).numFmtId||(n?14:0),n?Di(i):i)}catch{return""+i}}function Eo(e,i,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?Do[e.v]||e.v:i==null?tv(e,e.v):tv(e,i))}function gs(e,i){var n=i&&i.sheet?i.sheet:"Sheet1",t={};return t[n]=e,{SheetNames:[n],Sheets:t}}function pb(e,i,n){var t=n||{},r=e?Array.isArray(e):t.dense;si!=null&&r==null&&(r=si);var a=e||(r?[]:{}),o=0,l=0;if(a&&t.origin!=null){if(typeof t.origin=="number")o=t.origin;else{var m=typeof t.origin=="string"?Kn(t.origin):t.origin;o=m.r,l=m.c}a["!ref"]||(a["!ref"]="A1:A1")}var g={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=cn(a["!ref"]);g.s.c=f.s.c,g.s.r=f.s.r,g.e.c=Math.max(g.e.c,f.e.c),g.e.r=Math.max(g.e.r,f.e.r),o==-1&&(g.e.r=o=f.e.r+1)}for(var h=0;h!=i.length;++h)if(i[h]){if(!Array.isArray(i[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=i[h].length;++x)if(!(typeof i[h][x]>"u")){var C={v:i[h][x]},y=o+h,b=l+x;if(g.s.r>y&&(g.s.r=y),g.s.c>b&&(g.s.c=b),g.e.r<y&&(g.e.r=y),g.e.c<b&&(g.e.c=b),i[h][x]&&typeof i[h][x]=="object"&&!Array.isArray(i[h][x])&&!(i[h][x]instanceof Date))C=i[h][x];else if(Array.isArray(C.v)&&(C.f=i[h][x][1],C.v=C.v[0]),C.v===null)if(C.f)C.t="n";else if(t.nullError)C.t="e",C.v=0;else if(t.sheetStubs)C.t="z";else continue;else typeof C.v=="number"?C.t="n":typeof C.v=="boolean"?C.t="b":C.v instanceof Date?(C.z=t.dateNF||Mt[14],t.cellDates?(C.t="d",C.w=va(C.z,Di(C.v))):(C.t="n",C.v=Di(C.v),C.w=va(C.z,C.v))):C.t="s";if(r)a[y]||(a[y]=[]),a[y][b]&&a[y][b].z&&(C.z=a[y][b].z),a[y][b]=C;else{var w=Pt({c:b,r:y});a[w]&&a[w].z&&(C.z=a[w].z),a[w]=C}}}return g.s.c<1e7&&(a["!ref"]=zt(g)),a}function hl(e,i){return pb(null,e,i)}function L6(e){return e.read_shift(4,"i")}function Ra(e,i){return i||(i=Me(4)),i.write_shift(4,e),i}function Cr(e){var i=e.read_shift(4);return i===0?"":e.read_shift(i,"dbcs")}function Hi(e,i){var n=!1;return i==null&&(n=!0,i=Me(4+2*e.length)),i.write_shift(4,e.length),e.length>0&&i.write_shift(0,e,"dbcs"),n?i.slice(0,i.l):i}function V6(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function U6(e,i){return i||(i=Me(4)),i.write_shift(2,e.ich||0),i.write_shift(2,e.ifnt||0),i}function Wp(e,i){var n=e.l,t=e.read_shift(1),r=Cr(e),a=[],o={t:r,h:r};if(t&1){for(var l=e.read_shift(4),m=0;m!=l;++m)a.push(V6(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=n+i,o}function z6(e,i){var n=!1;return i==null&&(n=!0,i=Me(15+4*e.t.length)),i.write_shift(1,0),Hi(e.t,i),n?i.slice(0,i.l):i}var j6=Wp;function $6(e,i){var n=!1;return i==null&&(n=!0,i=Me(23+4*e.t.length)),i.write_shift(1,1),Hi(e.t,i),i.write_shift(4,1),U6({ich:0,ifnt:0},i),n?i.slice(0,i.l):i}function ba(e){var i=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:i,iStyleRef:n}}function Ys(e,i){return i==null&&(i=Me(8)),i.write_shift(-4,e.c),i.write_shift(3,e.iStyleRef||e.s),i.write_shift(1,0),i}function Ws(e){var i=e.read_shift(2);return i+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:i}}function Gs(e,i){return i==null&&(i=Me(4)),i.write_shift(3,e.iStyleRef||e.s),i.write_shift(1,0),i}var Y6=Cr,fb=Hi;function Gp(e){var i=e.read_shift(4);return i===0||i===4294967295?"":e.read_shift(i,"dbcs")}function yg(e,i){var n=!1;return i==null&&(n=!0,i=Me(127)),i.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&i.write_shift(0,e,"dbcs"),n?i.slice(0,i.l):i}var W6=Cr,fp=Gp,Hp=yg;function qp(e){var i=e.slice(e.l,e.l+4),n=i[0]&1,t=i[0]&2;e.l+=4;var r=t===0?bg([0,0,0,0,i[0]&252,i[1],i[2],i[3]],0):Is(i,0)>>2;return n?r/100:r}function hb(e,i){i==null&&(i=Me(4));var n=0,t=0,r=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?t=1:r==(r|0)&&r>=-(1<<29)&&r<1<<29&&(t=1,n=1),t)i.write_shift(-4,((n?r:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function _b(e){var i={s:{},e:{}};return i.s.r=e.read_shift(4),i.e.r=e.read_shift(4),i.s.c=e.read_shift(4),i.e.c=e.read_shift(4),i}function G6(e,i){return i||(i=Me(16)),i.write_shift(4,e.s.r),i.write_shift(4,e.e.r),i.write_shift(4,e.s.c),i.write_shift(4,e.e.c),i}var Hs=_b,_l=G6;function _r(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Vs(e,i){return(i||Me(8)).write_shift(8,e,"f")}function H6(e){var i={},n=e.read_shift(1),t=n>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),m=e.read_shift(1);switch(e.l++,t){case 0:i.auto=1;break;case 1:i.index=r;var g=Ds[r];g&&(i.rgb=_d(g));break;case 2:i.rgb=_d([o,l,m]);break;case 3:i.theme=r;break}return a!=0&&(i.tint=a>0?a/32767:a/32768),i}function Mg(e,i){if(i||(i=Me(8)),!e||e.auto)return i.write_shift(4,0),i.write_shift(4,0),i;e.index!=null?(i.write_shift(1,2),i.write_shift(1,e.index)):e.theme!=null?(i.write_shift(1,6),i.write_shift(1,e.theme)):(i.write_shift(1,5),i.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),i.write_shift(2,n),!e.rgb||e.theme!=null)i.write_shift(2,0),i.write_shift(1,0),i.write_shift(1,0);else{var t=e.rgb||"FFFFFF";typeof t=="number"&&(t=("000000"+t.toString(16)).slice(-6)),i.write_shift(1,parseInt(t.slice(0,2),16)),i.write_shift(1,parseInt(t.slice(2,4),16)),i.write_shift(1,parseInt(t.slice(4,6),16)),i.write_shift(1,255)}return i}function q6(e){var i=e.read_shift(1);e.l++;var n={fBold:i&1,fItalic:i&2,fUnderline:i&4,fStrikeout:i&8,fOutline:i&16,fShadow:i&32,fCondense:i&64,fExtend:i&128};return n}function X6(e,i){i||(i=Me(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return i.write_shift(1,n),i.write_shift(1,0),i}function xb(e,i){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},t=e.read_shift(4);switch(t){case 0:return"";case 4294967295:case 4294967294:return n[e.read_shift(4)]||""}if(t>400)throw new Error("Unsupported Clipboard: "+t.toString(16));return e.l-=4,e.read_shift(0,i==1?"lpstr":"lpwstr")}function K6(e){return xb(e,1)}function Z6(e){return xb(e,2)}var Xp=2,zr=3,cg=11,nv=12,Pg=19;var lg=64,Q6=65,J6=71;var e8=4108,t8=4126,Yi=80,Cb=81,n8=[Yi,Cb],hp={1:{n:"CodePage",t:Xp},2:{n:"Category",t:Yi},3:{n:"PresentationFormat",t:Yi},4:{n:"ByteCount",t:zr},5:{n:"LineCount",t:zr},6:{n:"ParagraphCount",t:zr},7:{n:"SlideCount",t:zr},8:{n:"NoteCount",t:zr},9:{n:"HiddenCount",t:zr},10:{n:"MultimediaClipCount",t:zr},11:{n:"ScaleCrop",t:cg},12:{n:"HeadingPairs",t:e8},13:{n:"TitlesOfParts",t:t8},14:{n:"Manager",t:Yi},15:{n:"Company",t:Yi},16:{n:"LinksUpToDate",t:cg},17:{n:"CharacterCount",t:zr},19:{n:"SharedDoc",t:cg},22:{n:"HyperlinksChanged",t:cg},23:{n:"AppVersion",t:zr,p:"version"},24:{n:"DigSig",t:Q6},26:{n:"ContentType",t:Yi},27:{n:"ContentStatus",t:Yi},28:{n:"Language",t:Yi},29:{n:"Version",t:Yi},255:{},2147483648:{n:"Locale",t:Pg},2147483651:{n:"Behavior",t:Pg},1919054434:{}},_p={1:{n:"CodePage",t:Xp},2:{n:"Title",t:Yi},3:{n:"Subject",t:Yi},4:{n:"Author",t:Yi},5:{n:"Keywords",t:Yi},6:{n:"Comments",t:Yi},7:{n:"Template",t:Yi},8:{n:"LastAuthor",t:Yi},9:{n:"RevNumber",t:Yi},10:{n:"EditTime",t:lg},11:{n:"LastPrinted",t:lg},12:{n:"CreatedDate",t:lg},13:{n:"ModifiedDate",t:lg},14:{n:"PageCount",t:zr},15:{n:"WordCount",t:zr},16:{n:"CharCount",t:zr},17:{n:"Thumbnail",t:J6},18:{n:"Application",t:Yi},19:{n:"DocSecurity",t:zr},255:{},2147483648:{n:"Locale",t:Pg},2147483651:{n:"Behavior",t:Pg},1919054434:{}},iv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},i8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function r8(e){return e.map(function(i){return[i>>16&255,i>>8&255,i&255]})}var a8=r8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ds=Vn(a8),Do={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},vb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},xp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},dg={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Kp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function o8(e){var i=Kp();if(!e||!e.match)return i;var n={};if((e.match(br)||[]).forEach(function(t){var r=kt(t);switch(r[0].replace(f6,"<")){case"<?xml":break;case"<Types":i.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[r.Extension]=r.ContentType;break;case"<Override":i[xp[r.ContentType]]!==void 0&&i[xp[r.ContentType]].push(r.PartName);break}}),i.xmlns!==Ai.CT)throw new Error("Unknown Namespace: "+i.xmlns);return i.calcchain=i.calcchains.length>0?i.calcchains[0]:"",i.sst=i.strs.length>0?i.strs[0]:"",i.style=i.styles.length>0?i.styles[0]:"",i.defaults=n,delete i.calcchains,i}function bb(e,i){var n=o6(xp),t=[],r;t[t.length]=fi,t[t.length]=Ye("Types",null,{xmlns:Ai.CT,"xmlns:xsd":Ai.xsd,"xmlns:xsi":Ai.xsi}),t=t.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(m){return Ye("Default",null,{Extension:m[0],ContentType:m[1]})}));var a=function(m){e[m]&&e[m].length>0&&(r=e[m][0],t[t.length]=Ye("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:dg[m][i.bookType]||dg[m].xlsx}))},o=function(m){(e[m]||[]).forEach(function(g){t[t.length]=Ye("Override",null,{PartName:(g[0]=="/"?"":"/")+g,ContentType:dg[m][i.bookType]||dg[m].xlsx})})},l=function(m){(e[m]||[]).forEach(function(g){t[t.length]=Ye("Override",null,{PartName:(g[0]=="/"?"":"/")+g,ContentType:n[m][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),t.length>2&&(t[t.length]="</Types>",t[1]=t[1].replace("/>",">")),t.join("")}var Wt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hd(e){var i=e.lastIndexOf("/");return e.slice(0,i+1)+"_rels/"+e.slice(i+1)+".rels"}function ad(e,i){var n={"!id":{}};if(!e)return n;i.charAt(0)!=="/"&&(i="/"+i);var t={};return(e.match(br)||[]).forEach(function(r){var a=kt(r);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:td(a.Target,i);n[l]=o,t[a.Id]=o}}),n["!id"]=t,n}function ol(e){var i=[fi,Ye("Relationships",null,{xmlns:Ai.RELS})];return ci(e["!id"]).forEach(function(n){i[i.length]=Ye("Relationship",null,e["!id"][n])}),i.length>2&&(i[i.length]="</Relationships>",i[1]=i[1].replace("/>",">")),i.join("")}function Pn(e,i,n,t,r,a){if(r||(r={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),i<0)for(i=e["!idx"];e["!id"]["rId"+i];++i);if(e["!idx"]=i+1,r.Id="rId"+i,r.Type=t,r.Target=n,a?r.TargetMode=a:[Wt.HLINK,Wt.XPATH,Wt.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),e["!id"][r.Id])throw new Error("Cannot rewrite rId "+i);return e["!id"][r.Id]=r,e[("/"+r.Target).replace("//","/")]=r,i}var s8="application/vnd.oasis.opendocument.spreadsheet";function c8(e,i){for(var n=Bp(e),t,r;t=fd.exec(n);)switch(t[3]){case"manifest":break;case"file-entry":if(r=kt(t[0],!1),r.path=="/"&&r.type!==s8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(i&&i.WTF)throw t}}function l8(e){var i=[fi];i.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),i.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)i.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return i.push("</manifest:manifest>"),i.join("")}function rv(e,i,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+i+`"/>
`,`  </rdf:Description>
`].join("")}function d8(e,i){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+i+`"/>
`,`  </rdf:Description>
`].join("")}function m8(e){var i=[fi];i.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)i.push(rv(e[n][0],e[n][1])),i.push(d8("",e[n][0]));return i.push(rv("","Document","pkg")),i.push("</rdf:RDF>"),i.join("")}function yb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+dd.version+"</meta:generator></office:meta></office:document-meta>"}var Ca=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],g8=function(){for(var e=new Array(Ca.length),i=0;i<Ca.length;++i){var n=Ca[i],t="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[i]=new RegExp("<"+t+"[^>]*>([\\s\\S]*?)</"+t+">")}return e}();function Mb(e){var i={};e=wn(e);for(var n=0;n<Ca.length;++n){var t=Ca[n],r=e.match(g8[n]);r!=null&&r.length>0&&(i[t[1]]=sn(r[1])),t[2]==="date"&&i[t[1]]&&(i[t[1]]=Ln(i[t[1]]))}return i}function np(e,i,n,t,r){r[e]!=null||i==null||i===""||(r[e]=i,i=On(i),t[t.length]=n?Ye(e,i,n):Qi(e,i))}function Pb(e,i){var n=i||{},t=[fi,Ye("cp:coreProperties",null,{"xmlns:cp":Ai.CORE_PROPS,"xmlns:dc":Ai.dc,"xmlns:dcterms":Ai.dcterms,"xmlns:dcmitype":Ai.dcmitype,"xmlns:xsi":Ai.xsi})],r={};if(!e&&!n.Props)return t.join("");e&&(e.CreatedDate!=null&&np("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:pp(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},t,r),e.ModifiedDate!=null&&np("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:pp(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},t,r));for(var a=0;a!=Ca.length;++a){var o=Ca[a],l=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&np(o[0],l,null,t,r)}return t.length>2&&(t[t.length]="</cp:coreProperties>",t[1]=t[1].replace("/>",">")),t.join("")}var Fs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Ob=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wb(e,i,n,t){var r=[];if(typeof e=="string")r=qC(e,t);else for(var a=0;a<e.length;++a)r=r.concat(e[a].map(function(f){return{v:f}}));var o=typeof i=="string"?qC(i,t).map(function(f){return f.v}):i,l=0,m=0;if(o.length>0)for(var g=0;g!==r.length;g+=2){switch(m=+r[g+1].v,r[g].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":n.Worksheets=m,n.SheetNames=o.slice(l,l+m);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":n.NamedRanges=m,n.DefinedNames=o.slice(l,l+m);break;case"Charts":case"Diagramme":n.Chartsheets=m,n.ChartNames=o.slice(l,l+m);break}l+=m}}function u8(e,i,n){var t={};return i||(i={}),e=wn(e),Fs.forEach(function(r){var a=(e.match(ud(r[0]))||[])[1];switch(r[2]){case"string":a&&(i[r[1]]=sn(a));break;case"bool":i[r[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));o&&o.length>0&&(t[r[1]]=o[1]);break}}),t.HeadingPairs&&t.TitlesOfParts&&wb(t.HeadingPairs,t.TitlesOfParts,i,n),i}function Sb(e){var i=[],n=Ye;return e||(e={}),e.Application="SheetJS",i[i.length]=fi,i[i.length]=Ye("Properties",null,{xmlns:Ai.EXT_PROPS,"xmlns:vt":Ai.vt}),Fs.forEach(function(t){if(e[t[1]]!==void 0){var r;switch(t[2]){case"string":r=On(String(e[t[1]]));break;case"bool":r=e[t[1]]?"true":"false";break}r!==void 0&&(i[i.length]=n(t[0],r))}}),i[i.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),i[i.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(t){return"<vt:lpstr>"+On(t)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),i.length>2&&(i[i.length]="</Properties>",i[1]=i[1].replace("/>",">")),i.join("")}var p8=/<[^>]+>[^<]*/g;function f8(e,i){var n={},t="",r=e.match(p8);if(r)for(var a=0;a!=r.length;++a){var o=r[a],l=kt(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":t=sn(l.name);break;case"</property>":t=null;break;default:if(o.indexOf("<vt:")===0){var m=o.split(">"),g=m[0].slice(4),f=m[1];switch(g){case"lpstr":case"bstr":case"lpwstr":n[t]=sn(f);break;case"bool":n[t]=Nn(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[t]=parseInt(f,10);break;case"r4":case"r8":case"decimal":n[t]=parseFloat(f);break;case"filetime":case"date":n[t]=Ln(f);break;case"cy":case"error":n[t]=sn(f);break;default:if(g.slice(-1)=="/")break;i.WTF&&typeof console<"u"&&console.warn("Unexpected",o,g,m)}}else if(o.slice(0,2)!=="</"){if(i.WTF)throw new Error(o)}}}return n}function kb(e){var i=[fi,Ye("Properties",null,{xmlns:Ai.CUST_PROPS,"xmlns:vt":Ai.vt})];if(!e)return i.join("");var n=1;return ci(e).forEach(function(r){++n,i[i.length]=Ye("property",M6(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:On(r)})}),i.length>2&&(i[i.length]="</Properties>",i[1]=i[1].replace("/>",">")),i.join("")}var Cp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ip;function h8(e,i,n){ip||(ip=Ag(Cp)),i=ip[i]||i,e[i]=n}function _8(e,i){var n=[];return ci(Cp).map(function(t){for(var r=0;r<Ca.length;++r)if(Ca[r][1]==t)return Ca[r];for(r=0;r<Fs.length;++r)if(Fs[r][1]==t)return Fs[r];throw t}).forEach(function(t){if(e[t[1]]!=null){var r=i&&i.Props&&i.Props[t[1]]!=null?i.Props[t[1]]:e[t[1]];switch(t[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),n.push(Qi(Cp[t[1]]||t[1],r))}}),Ye("DocumentProperties",n.join(""),{xmlns:Zr.o})}function x8(e,i){var n=["Worksheets","SheetNames"],t="CustomDocumentProperties",r=[];return e&&ci(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<Ca.length;++o)if(a==Ca[o][1])return;for(o=0;o<Fs.length;++o)if(a==Fs[o][1])return;for(o=0;o<n.length;++o)if(a==n[o])return;var l=e[a],m="string";typeof l=="number"?(m="float",l=String(l)):l===!0||l===!1?(m="boolean",l=l?"1":"0"):l=String(l),r.push(Ye(YC(a),l,{"dt:dt":m}))}}),i&&ci(i).forEach(function(a){if(Object.prototype.hasOwnProperty.call(i,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=i[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),r.push(Ye(YC(a),o,{"dt:dt":l}))}}),"<"+t+' xmlns="'+Zr.o+'">'+r.join("")+"</"+t+">"}function Zp(e){var i=e.read_shift(4),n=e.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+i/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function C8(e){var i=typeof e=="string"?new Date(Date.parse(e)):e,n=i.getTime()/1e3+11644473600,t=n%Math.pow(2,32),r=(n-t)/Math.pow(2,32);t*=1e7,r*=1e7;var a=t/Math.pow(2,32)|0;a>0&&(t=t%Math.pow(2,32),r+=a);var o=Me(8);return o.write_shift(4,t),o.write_shift(4,r),o}function Tb(e,i,n){var t=e.l,r=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-t&3;)++e.l;return r}function Eb(e,i,n){var t=e.read_shift(0,"lpwstr");return n&&(e.l+=4-(t.length+1&3)&3),t}function Ib(e,i,n){return i===31?Eb(e):Tb(e,i,n)}function vp(e,i,n){return Ib(e,i,n===!1?0:4)}function v8(e,i){if(!i)throw new Error("VtUnalignedString must have positive length");return Ib(e,i,0)}function b8(e){for(var i=e.read_shift(4),n=[],t=0;t!=i;++t){var r=e.l;n[t]=e.read_shift(0,"lpwstr").replace(xr,""),e.l-r&2&&(e.l+=2)}return n}function y8(e){for(var i=e.read_shift(4),n=[],t=0;t!=i;++t)n[t]=e.read_shift(0,"lpstr-cp").replace(xr,"");return n}function M8(e){var i=e.l,n=Og(e,Cb);e[e.l]==0&&e[e.l+1]==0&&e.l-i&2&&(e.l+=2);var t=Og(e,zr);return[n,t]}function P8(e){for(var i=e.read_shift(4),n=[],t=0;t<i/2;++t)n.push(M8(e));return n}function av(e,i){for(var n=e.read_shift(4),t={},r=0;r!=n;++r){var a=e.read_shift(4),o=e.read_shift(4);t[a]=e.read_shift(o,i===1200?"utf16le":"utf8").replace(xr,"").replace(ed,"!"),i===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),t}function Ab(e){var i=e.read_shift(4),n=e.slice(e.l,e.l+i);return e.l+=i,(i&3)>0&&(e.l+=4-(i&3)&3),n}function O8(e){var i={};return i.Size=e.read_shift(4),e.l+=i.Size+3-(i.Size-1)%4,i}function Og(e,i,n){var t=e.read_shift(2),r,a=n||{};if(e.l+=2,i!==nv&&t!==i&&n8.indexOf(i)===-1&&!((i&65534)==4126&&(t&65534)==4126))throw new Error("Expected type "+i+" saw "+t);switch(i===nv?t:i){case 2:return r=e.read_shift(2,"i"),a.raw||(e.l+=2),r;case 3:return r=e.read_shift(4,"i"),r;case 11:return e.read_shift(4)!==0;case 19:return r=e.read_shift(4),r;case 30:return Tb(e,t,4).replace(xr,"");case 31:return Eb(e);case 64:return Zp(e);case 65:return Ab(e);case 71:return O8(e);case 80:return vp(e,t,!a.raw).replace(xr,"");case 81:return v8(e,t).replace(xr,"");case 4108:return P8(e);case 4126:case 4127:return t==4127?b8(e):y8(e);default:throw new Error("TypedPropertyValue unrecognized type "+i+" "+t)}}function ov(e,i){var n=Me(4),t=Me(4);switch(n.write_shift(4,e==80?31:e),e){case 3:t.write_shift(-4,i);break;case 5:t=Me(8),t.write_shift(8,i,"f");break;case 11:t.write_shift(4,i?1:0);break;case 64:t=C8(i);break;case 31:case 80:for(t=Me(4+2*(i.length+1)+(i.length%2?0:2)),t.write_shift(4,i.length+1),t.write_shift(0,i,"dbcs");t.l!=t.length;)t.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+i)}return Gi([n,t])}function sv(e,i){var n=e.l,t=e.read_shift(4),r=e.read_shift(4),a=[],o=0,l=0,m=-1,g={};for(o=0;o!=r;++o){var f=e.read_shift(4),h=e.read_shift(4);a[o]=[f,h+n]}a.sort(function(E,I){return E[1]-I[1]});var x={};for(o=0;o!=r;++o){if(e.l!==a[o][1]){var C=!0;if(o>0&&i)switch(i[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,C=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],C=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],C=!1);break}if((!i||o==0)&&e.l<=a[o][1]&&(C=!1,e.l=a[o][1]),C)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(i){var y=i[a[o][0]];if(x[y.n]=Og(e,y.t,{raw:!0}),y.p==="version"&&(x[y.n]=String(x[y.n]>>16)+"."+("0000"+String(x[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(x[y.n]){case 0:x[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Aa(l=x[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[y.n])}}else if(a[o][0]===1){if(l=x.CodePage=Og(e,Xp),Aa(l),m!==-1){var b=e.l;e.l=a[m][1],g=av(e,l),e.l=b}}else if(a[o][0]===0){if(l===0){m=o,e.l=a[o+1][1];continue}g=av(e,l)}else{var w=g[a[o][0]],A;switch(e[e.l]){case 65:e.l+=4,A=Ab(e);break;case 30:e.l+=4,A=vp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,A=vp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,A=e.read_shift(4,"i");break;case 19:e.l+=4,A=e.read_shift(4);break;case 5:e.l+=4,A=e.read_shift(8,"f");break;case 11:e.l+=4,A=ui(e,4);break;case 64:e.l+=4,A=Ln(Zp(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[w]=A}}return e.l=n+t,x}var Db=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function w8(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function cv(e,i,n){var t=Me(8),r=[],a=[],o=8,l=0,m=Me(8),g=Me(8);if(m.write_shift(4,2),m.write_shift(4,1200),g.write_shift(4,1),a.push(m),r.push(g),o+=8+m.length,!i){g=Me(8),g.write_shift(4,0),r.unshift(g);var f=[Me(4)];for(f[0].write_shift(4,e.length),l=0;l<e.length;++l){var h=e[l][0];for(m=Me(8+2*(h.length+1)+(h.length%2?0:2)),m.write_shift(4,l+2),m.write_shift(4,h.length+1),m.write_shift(0,h,"dbcs");m.l!=m.length;)m.write_shift(1,0);f.push(m)}m=Gi(f),a.unshift(m),o+=8+m.length}for(l=0;l<e.length;++l)if(!(i&&!i[e[l][0]])&&!(Db.indexOf(e[l][0])>-1||Ob.indexOf(e[l][0])>-1)&&e[l][1]!=null){var x=e[l][1],C=0;if(i){C=+i[e[l][0]];var y=n[C];if(y.p=="version"&&typeof x=="string"){var b=x.split(".");x=(+b[0]<<16)+(+b[1]||0)}m=ov(y.t,x)}else{var w=w8(x);w==-1&&(w=31,x=String(x)),m=ov(w,x)}a.push(m),g=Me(8),g.write_shift(4,i?C:2+l),r.push(g),o+=8+m.length}var A=8*(a.length+1);for(l=0;l<a.length;++l)r[l].write_shift(4,A),A+=a[l].length;return t.write_shift(4,o),t.write_shift(4,a.length),Gi([t].concat(r).concat(a))}function lv(e,i,n){var t=e.content;if(!t)return{};Zi(t,0);var r,a,o,l,m=0;t.chk("feff","Byte Order: "),t.read_shift(2);var g=t.read_shift(4),f=t.read_shift(16);if(f!==_t.utils.consts.HEADER_CLSID&&f!==n)throw new Error("Bad PropertySet CLSID "+f);if(r=t.read_shift(4),r!==1&&r!==2)throw new Error("Unrecognized #Sets: "+r);if(a=t.read_shift(16),l=t.read_shift(4),r===1&&l!==t.l)throw new Error("Length mismatch: "+l+" !== "+t.l);r===2&&(o=t.read_shift(16),m=t.read_shift(4));var h=sv(t,i),x={SystemIdentifier:g};for(var C in h)x[C]=h[C];if(x.FMTID=a,r===1)return x;if(m-t.l==2&&(t.l+=2),t.l!==m)throw new Error("Length mismatch 2: "+t.l+" !== "+m);var y;try{y=sv(t,null)}catch{}for(C in y)x[C]=y[C];return x.FMTID=[a,o],x}function dv(e,i,n,t,r,a){var o=Me(r?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,_t.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,r?2:1),o.write_shift(16,i,"hex"),o.write_shift(4,r?68:48);var m=cv(e,n,t);if(l.push(m),r){var g=cv(r,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+m.length),l.push(g)}return Gi(l)}function rs(e,i){return e.read_shift(i),null}function S8(e,i){i||(i=Me(e));for(var n=0;n<e;++n)i.write_shift(1,0);return i}function k8(e,i,n){for(var t=[],r=e.l+i;e.l<r;)t.push(n(e,r-e.l));if(r!==e.l)throw new Error("Slurp error");return t}function ui(e,i){return e.read_shift(i)===1}function Tr(e,i){return i||(i=Me(2)),i.write_shift(2,+!!e),i}function Ti(e){return e.read_shift(2,"u")}function xa(e,i){return i||(i=Me(2)),i.write_shift(2,e),i}function Fb(e,i){return k8(e,i,Ti)}function T8(e){var i=e.read_shift(1),n=e.read_shift(1);return n===1?i:i===1}function Rb(e,i,n){return n||(n=Me(2)),n.write_shift(1,i=="e"?+e:+!!e),n.write_shift(1,i=="e"?1:0),n}function Od(e,i,n){var t=e.read_shift(n&&n.biff>=12?2:1),r="sbcs-cont",a=io;if(n&&n.biff>=8&&(io=1200),!n||n.biff==8){var o=e.read_shift(1);o&&(r="dbcs-cont")}else n.biff==12&&(r="wstr");n.biff>=2&&n.biff<=5&&(r="cpstr");var l=t?e.read_shift(t,r):"";return io=a,l}function E8(e){var i=io;io=1200;var n=e.read_shift(2),t=e.read_shift(1),r=t&4,a=t&8,o=1+(t&1),l=0,m,g={};a&&(l=e.read_shift(2)),r&&(m=e.read_shift(4));var f=o==2?"dbcs-cont":"sbcs-cont",h=n===0?"":e.read_shift(n,f);return a&&(e.l+=4*l),r&&(e.l+=m),g.t=h,a||(g.raw="<t>"+g.t+"</t>",g.r=g.t),io=i,g}function I8(e){var i=e.t||"",n=1,t=Me(3+(n>1?2:0));t.write_shift(2,i.length),t.write_shift(1,(n>1?8:0)|1),n>1&&t.write_shift(2,n);var r=Me(2*i.length);r.write_shift(2*i.length,i,"utf16le");var a=[t,r];return Gi(a)}function Us(e,i,n){var t;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(i,"cpstr");if(n.biff>=12)return e.read_shift(i,"dbcs-cont")}var r=e.read_shift(1);return r===0?t=e.read_shift(i,"sbcs-cont"):t=e.read_shift(i,"dbcs-cont"),t}function wd(e,i,n){var t=e.read_shift(n&&n.biff==2?1:2);return t===0?(e.l++,""):Us(e,t,n)}function qs(e,i,n){if(n.biff>5)return wd(e,i,n);var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Bb(e,i,n){return n||(n=Me(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function A8(e){var i=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[i,n]}function D8(e){var i=e.read_shift(4),n=e.l,t=!1;i>24&&(e.l+=i-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(t=!0),e.l=n);var r=e.read_shift((t?i-24:i)>>1,"utf16le").replace(xr,"");return t&&(e.l+=24),r}function F8(e){for(var i=e.read_shift(2),n="";i-- >0;)n+="../";var t=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var r=e.read_shift(4);if(r===0)return n+t.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(xr,"");return n+o}function R8(e,i){var n=e.read_shift(16);switch(i-=16,n){case"e0c9ea79f9bace118c8200aa004ba90b":return D8(e,i);case"0303000000000000c000000000000046":return F8(e,i);default:throw new Error("Unsupported Moniker "+n)}}function mg(e){var i=e.read_shift(4),n=i>0?e.read_shift(i,"utf16le").replace(xr,""):"";return n}function mv(e,i){i||(i=Me(6+e.length*2)),i.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)i.write_shift(2,e.charCodeAt(n));return i.write_shift(2,0),i}function B8(e,i){var n=e.l+i,t=e.read_shift(4);if(t!==2)throw new Error("Unrecognized streamVersion: "+t);var r=e.read_shift(2);e.l+=2;var a,o,l,m,g="",f,h;r&16&&(a=mg(e,n-e.l)),r&128&&(o=mg(e,n-e.l)),(r&257)===257&&(l=mg(e,n-e.l)),(r&257)===1&&(m=R8(e,n-e.l)),r&8&&(g=mg(e,n-e.l)),r&32&&(f=e.read_shift(16)),r&64&&(h=Zp(e)),e.l=n;var x=o||l||m||"";x&&g&&(x+="#"+g),x||(x="#"+g),r&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var C={Target:x};return f&&(C.guid=f),h&&(C.time=h),a&&(C.Tooltip=a),C}function N8(e){var i=Me(512),n=0,t=e.Target;t.slice(0,7)=="file://"&&(t=t.slice(7));var r=t.indexOf("#"),a=r>-1?31:23;switch(t.charAt(0)){case"#":a=28;break;case".":a&=-3;break}i.write_shift(4,2),i.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)i.write_shift(4,o[n]);if(a==28)t=t.slice(1),mv(t,i);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)i.write_shift(1,parseInt(o[n],16));var l=r>-1?t.slice(0,r):t;for(i.write_shift(4,2*(l.length+1)),n=0;n<l.length;++n)i.write_shift(2,l.charCodeAt(n));i.write_shift(2,0),a&8&&mv(r>-1?t.slice(r+1):"",i)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)i.write_shift(1,parseInt(o[n],16));for(var m=0;t.slice(m*3,m*3+3)=="../"||t.slice(m*3,m*3+3)=="..\\";)++m;for(i.write_shift(2,m),i.write_shift(4,t.length-3*m+1),n=0;n<t.length-3*m;++n)i.write_shift(1,t.charCodeAt(n+3*m)&255);for(i.write_shift(1,0),i.write_shift(2,65535),i.write_shift(2,57005),n=0;n<6;++n)i.write_shift(4,0)}return i.slice(0,i.l)}function Nb(e){var i=e.read_shift(1),n=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1);return[i,n,t,r]}function Lb(e,i){var n=Nb(e,i);return n[3]=0,n}function ao(e){var i=e.read_shift(2),n=e.read_shift(2),t=e.read_shift(2);return{r:i,c:n,ixfe:t}}function zs(e,i,n,t){return t||(t=Me(6)),t.write_shift(2,e),t.write_shift(2,i),t.write_shift(2,n||0),t}function L8(e){var i=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:i,flags:n}}function V8(e,i,n){return i===0?"":qs(e,i,n)}function U8(e,i,n){var t=n.biff>8?4:2,r=e.read_shift(t),a=e.read_shift(t,"i"),o=e.read_shift(t,"i");return[r,a,o]}function Vb(e){var i=e.read_shift(2),n=qp(e);return[i,n]}function z8(e,i,n){e.l+=4,i-=4;var t=e.l+i,r=Od(e,i,n),a=e.read_shift(2);if(t-=e.l,a!==t)throw new Error("Malformed AddinUdf: padding = "+t+" != "+a);return e.l+=a,r}function Bg(e){var i=e.read_shift(2),n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{s:{c:t,r:i},e:{c:r,r:n}}}function Ub(e,i){return i||(i=Me(8)),i.write_shift(2,e.s.r),i.write_shift(2,e.e.r),i.write_shift(2,e.s.c),i.write_shift(2,e.e.c),i}function zb(e){var i=e.read_shift(2),n=e.read_shift(2),t=e.read_shift(1),r=e.read_shift(1);return{s:{c:t,r:i},e:{c:r,r:n}}}var j8=zb;function jb(e){e.l+=4;var i=e.read_shift(2),n=e.read_shift(2),t=e.read_shift(2);return e.l+=12,[n,i,t]}function $8(e){var i={};return e.l+=4,e.l+=16,i.fSharedNote=e.read_shift(2),e.l+=4,i}function Y8(e){var i={};return e.l+=4,e.cf=e.read_shift(2),i}function ur(e){e.l+=2,e.l+=e.read_shift(2)}var W8={0:ur,4:ur,5:ur,6:ur,7:Y8,8:ur,9:ur,10:ur,11:ur,12:ur,13:$8,14:ur,15:ur,16:ur,17:ur,18:ur,19:ur,20:ur,21:jb};function G8(e,i){for(var n=e.l+i,t=[];e.l<n;){var r=e.read_shift(2);e.l-=2;try{t.push(W8[r](e,n-e.l))}catch{return e.l=n,t}}return e.l!=n&&(e.l=n),t}function gg(e,i){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),i-=2,i>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(i>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(i),n}function Qp(e,i,n){var t=1536,r=16;switch(n.bookType){case"biff8":break;case"biff5":t=1280,r=8;break;case"biff4":t=4,r=6;break;case"biff3":t=3,r=6;break;case"biff2":t=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Me(r);return a.write_shift(2,t),a.write_shift(2,i),r>4&&a.write_shift(2,29282),r>6&&a.write_shift(2,1997),r>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function H8(e,i){return i===0||e.read_shift(2),1200}function q8(e,i,n){if(n.enc)return e.l+=i,"";var t=e.l,r=qs(e,0,n);return e.read_shift(i+t-e.l),r}function X8(e,i){var n=!i||i.biff==8,t=Me(n?112:54);for(t.write_shift(i.biff==8?2:1,7),n&&t.write_shift(1,0),t.write_shift(4,859007059),t.write_shift(4,5458548|(n?0:536870912));t.l<t.length;)t.write_shift(1,n?0:32);return t}function K8(e,i,n){var t=n&&n.biff==8||i==2?e.read_shift(2):(e.l+=i,0);return{fDialog:t&16,fBelow:t&64,fRight:t&128}}function Z8(e,i,n){var t=e.read_shift(4),r=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=Od(e,0,n);return o.length===0&&(o="Sheet1"),{pos:t,hs:r,dt:a,name:o}}function Q8(e,i){var n=!i||i.biff>=8?2:1,t=Me(8+n*e.name.length);t.write_shift(4,e.pos),t.write_shift(1,e.hs||0),t.write_shift(1,e.dt),t.write_shift(1,e.name.length),i.biff>=8&&t.write_shift(1,1),t.write_shift(n*e.name.length,e.name,i.biff<8?"sbcs":"utf16le");var r=t.slice(0,t.l);return r.l=t.l,r}function J8(e,i){for(var n=e.l+i,t=e.read_shift(4),r=e.read_shift(4),a=[],o=0;o!=r&&e.l<n;++o)a.push(E8(e));return a.Count=t,a.Unique=r,a}function eI(e,i){var n=Me(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var t=[],r=0;r<e.length;++r)t[r]=I8(e[r],i);var a=Gi([n].concat(t));return a.parts=[n.length].concat(t.map(function(o){return o.length})),a}function tI(e,i){var n={};return n.dsst=e.read_shift(2),e.l+=i-2,n}function nI(e){var i={};i.r=e.read_shift(2),i.c=e.read_shift(2),i.cnt=e.read_shift(2)-i.c;var n=e.read_shift(2);e.l+=4;var t=e.read_shift(1);return e.l+=3,t&7&&(i.level=t&7),t&32&&(i.hidden=!0),t&64&&(i.hpt=n/20),i}function iI(e){var i=L8(e);if(i.type!=2211)throw new Error("Invalid Future Record "+i.type);var n=e.read_shift(4);return n!==0}function rI(e){return e.read_shift(2),e.read_shift(4)}function gv(e,i,n){var t=0;n&&n.biff==2||(t=e.read_shift(2));var r=e.read_shift(2);n&&n.biff==2&&(t=1-(r>>15),r&=32767);var a={Unsynced:t&1,DyZero:(t&2)>>1,ExAsc:(t&4)>>2,ExDsc:(t&8)>>3};return[a,r]}function aI(e){var i=e.read_shift(2),n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),m=e.read_shift(2),g=e.read_shift(2);return{Pos:[i,n],Dim:[t,r],Flags:a,CurTab:o,FirstTab:l,Selected:m,TabRatio:g}}function oI(){var e=Me(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function sI(e,i,n){if(n&&n.biff>=2&&n.biff<5)return{};var t=e.read_shift(2);return{RTL:t&64}}function cI(e){var i=Me(18),n=1718;return e&&e.RTL&&(n|=64),i.write_shift(2,n),i.write_shift(4,0),i.write_shift(4,64),i.write_shift(4,0),i.write_shift(4,0),i}function lI(){}function dI(e,i,n){var t={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return t.name=Od(e,0,n),t}function mI(e,i){var n=e.name||"Arial",t=i&&i.biff==5,r=t?15+n.length:16+2*n.length,a=Me(r);return a.write_shift(2,(e.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,n.length),t||a.write_shift(1,1),a.write_shift((t?1:2)*n.length,n,t?"sbcs":"utf16le"),a}function gI(e){var i=ao(e);return i.isst=e.read_shift(4),i}function uI(e,i,n,t){var r=Me(10);return zs(e,i,t,r),r.write_shift(4,n),r}function pI(e,i,n){n.biffguess&&n.biff==2&&(n.biff=5);var t=e.l+i,r=ao(e,6);n.biff==2&&e.l++;var a=wd(e,t-e.l,n);return r.val=a,r}function fI(e,i,n,t,r){var a=!r||r.biff==8,o=Me(8+ +a+(1+a)*n.length);return zs(e,i,t,o),o.write_shift(2,n.length),a&&o.write_shift(1,1),o.write_shift((1+a)*n.length,n,a?"utf16le":"sbcs"),o}function hI(e,i,n){var t=e.read_shift(2),r=qs(e,0,n);return[t,r]}function _I(e,i,n,t){var r=n&&n.biff==5;t||(t=Me(r?3+i.length:5+2*i.length)),t.write_shift(2,e),t.write_shift(r?1:2,i.length),r||t.write_shift(1,1),t.write_shift((r?1:2)*i.length,i,r?"sbcs":"utf16le");var a=t.length>t.l?t.slice(0,t.l):t;return a.l==null&&(a.l=a.length),a}var xI=qs;function uv(e,i,n){var t=e.l+i,r=n.biff==8||!n.biff?4:2,a=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2),m=e.read_shift(2);return e.l=t,{s:{r:a,c:l},e:{r:o,c:m}}}function CI(e,i){var n=i.biff==8||!i.biff?4:2,t=Me(2*n+6);return t.write_shift(n,e.s.r),t.write_shift(n,e.e.r+1),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c+1),t.write_shift(2,0),t}function vI(e){var i=e.read_shift(2),n=e.read_shift(2),t=Vb(e);return{r:i,c:n,ixfe:t[0],rknum:t[1]}}function bI(e,i){for(var n=e.l+i-2,t=e.read_shift(2),r=e.read_shift(2),a=[];e.l<n;)a.push(Vb(e));if(e.l!==n)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-r+1)throw new Error("MulRK length mismatch");return{r:t,c:r,C:o,rkrec:a}}function yI(e,i){for(var n=e.l+i-2,t=e.read_shift(2),r=e.read_shift(2),a=[];e.l<n;)a.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-r+1)throw new Error("MulBlank length mismatch");return{r:t,c:r,C:o,ixfe:a}}function MI(e,i,n,t){var r={},a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),m=e.read_shift(2);return r.patternType=i8[l>>26],t.cellStyles&&(r.alc=a&7,r.fWrap=a>>3&1,r.alcV=a>>4&7,r.fJustLast=a>>7&1,r.trot=a>>8&255,r.cIndent=a>>16&15,r.fShrinkToFit=a>>20&1,r.iReadOrder=a>>22&2,r.fAtrNum=a>>26&1,r.fAtrFnt=a>>27&1,r.fAtrAlc=a>>28&1,r.fAtrBdr=a>>29&1,r.fAtrPat=a>>30&1,r.fAtrProt=a>>31&1,r.dgLeft=o&15,r.dgRight=o>>4&15,r.dgTop=o>>8&15,r.dgBottom=o>>12&15,r.icvLeft=o>>16&127,r.icvRight=o>>23&127,r.grbitDiag=o>>30&3,r.icvTop=l&127,r.icvBottom=l>>7&127,r.icvDiag=l>>14&127,r.dgDiag=l>>21&15,r.icvFore=m&127,r.icvBack=m>>7&127,r.fsxButton=m>>14&1),r}function PI(e,i,n){var t={};return t.ifnt=e.read_shift(2),t.numFmtId=e.read_shift(2),t.flags=e.read_shift(2),t.fStyle=t.flags>>2&1,i-=6,t.data=MI(e,i,t.fStyle,n),t}function pv(e,i,n,t){var r=n&&n.biff==5;t||(t=Me(r?16:20)),t.write_shift(2,0),e.style?(t.write_shift(2,e.numFmtId||0),t.write_shift(2,65524)):(t.write_shift(2,e.numFmtId||0),t.write_shift(2,i<<4));var a=0;return e.numFmtId>0&&r&&(a|=1024),t.write_shift(4,a),t.write_shift(4,0),r||t.write_shift(4,0),t.write_shift(2,0),t}function OI(e){e.l+=4;var i=[e.read_shift(2),e.read_shift(2)];if(i[0]!==0&&i[0]--,i[1]!==0&&i[1]--,i[0]>7||i[1]>7)throw new Error("Bad Gutters: "+i.join("|"));return i}function wI(e){var i=Me(8);return i.write_shift(4,0),i.write_shift(2,e[0]?e[0]+1:0),i.write_shift(2,e[1]?e[1]+1:0),i}function fv(e,i,n){var t=ao(e,6);(n.biff==2||i==9)&&++e.l;var r=T8(e,2);return t.val=r,t.t=r===!0||r===!1?"b":"e",t}function SI(e,i,n,t,r,a){var o=Me(8);return zs(e,i,t,o),Rb(n,a,o),o}function kI(e,i,n){n.biffguess&&n.biff==2&&(n.biff=5);var t=ao(e,6),r=_r(e,8);return t.val=r,t}function TI(e,i,n,t){var r=Me(14);return zs(e,i,t,r),Vs(n,r),r}var hv=V8;function EI(e,i,n){var t=e.l+i,r=e.read_shift(2),a=e.read_shift(2);if(n.sbcch=a,a==1025||a==14849)return[a,r];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=Us(e,a),l=[];t>e.l;)l.push(wd(e));return[a,r,o,l]}function _v(e,i,n){var t=e.read_shift(2),r,a={fBuiltIn:t&1,fWantAdvise:t>>>1&1,fWantPict:t>>>2&1,fOle:t>>>3&1,fOleLink:t>>>4&1,cf:t>>>5&1023,fIcon:t>>>15&1};return n.sbcch===14849&&(r=z8(e,i-2,n)),a.body=r||e.read_shift(i-2),typeof r=="string"&&(a.Name=r),a}var II=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function xv(e,i,n){var t=e.l+i,r=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(n&&n.biff==2?1:2),m=0;(!n||n.biff>=5)&&(n.biff!=5&&(e.l+=2),m=e.read_shift(2),n.biff==5&&(e.l+=2),e.l+=4);var g=Us(e,o,n);r&32&&(g=II[g.charCodeAt(0)]);var f=t-e.l;n&&n.biff==2&&--f;var h=t==e.l||l===0||!(f>0)?[]:G7(e,f,n,l);return{chKey:a,Name:g,itab:m,rgce:h}}function $b(e,i,n){if(n.biff<8)return AI(e,i,n);for(var t=[],r=e.l+i,a=e.read_shift(n.biff>8?4:2);a--!==0;)t.push(U8(e,n.biff>8?12:6,n));if(e.l!=r)throw new Error("Bad ExternSheet: "+e.l+" != "+r);return t}function AI(e,i,n){e[e.l+1]==3&&e[e.l]++;var t=Od(e,i,n);return t.charCodeAt(0)==3?t.slice(1):t}function DI(e,i,n){if(n.biff<8){e.l+=i;return}var t=e.read_shift(2),r=e.read_shift(2),a=Us(e,t,n),o=Us(e,r,n);return[a,o]}function FI(e,i,n){var t=zb(e,6);e.l++;var r=e.read_shift(1);return i-=8,[H7(e,i,n),r,t]}function Cv(e,i,n){var t=j8(e,6);switch(n.biff){case 2:e.l++,i-=7;break;case 3:case 4:e.l+=2,i-=8;break;default:e.l+=6,i-=12}return[t,Y7(e,i,n,t)]}function RI(e){var i=e.read_shift(4)!==0,n=e.read_shift(4)!==0,t=e.read_shift(4);return[i,n,t]}function BI(e,i,n){if(!(n.biff<8)){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=qs(e,0,n);return n.biff<8&&e.read_shift(1),[{r:t,c:r},l,o,a]}}function NI(e,i,n){return BI(e,i,n)}function LI(e,i){for(var n=[],t=e.read_shift(2);t--;)n.push(Bg(e,i));return n}function VI(e){var i=Me(2+e.length*8);i.write_shift(2,e.length);for(var n=0;n<e.length;++n)Ub(e[n],i);return i}function UI(e,i,n){if(n&&n.biff<8)return jI(e,i,n);var t=jb(e,22),r=G8(e,i-22,t[1]);return{cmo:t,ft:r}}var zI={8:function(e,i){var n=e.l+i;e.l+=10;var t=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var r=e.read_shift(1);return e.l+=r,e.l=n,{fmt:t}}};function jI(e,i,n){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,i-=36;var o=[];return o.push((zI[t]||vr)(e,i,n)),{cmo:[r,t,a],ft:o}}function $I(e,i,n){var t=e.l,r="";try{e.l+=4;var a=(n.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=A8(e,6,n);var l=e.read_shift(2);e.read_shift(2),Ti(e,2);var m=e.read_shift(2);e.l+=m;for(var g=1;g<e.lens.length-1;++g){if(e.l-t!=e.lens[g])throw new Error("TxO: bad continue record");var f=e[e.l],h=Us(e,e.lens[g+1]-e.lens[g]-1);if(r+=h,r.length>=(f?l:2*l))break}if(r.length!==l&&r.length!==l*2)throw new Error("cchText: "+l+" != "+r.length);return e.l=t+i,{t:r}}catch{return e.l=t+i,{t:r}}}function YI(e,i){var n=Bg(e,8);e.l+=16;var t=B8(e,i-24);return[n,t]}function WI(e){var i=Me(24),n=Kn(e[0]);i.write_shift(2,n.r),i.write_shift(2,n.r),i.write_shift(2,n.c),i.write_shift(2,n.c);for(var t="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)i.write_shift(1,parseInt(t[r],16));return Gi([i,N8(e[1])])}function GI(e,i){e.read_shift(2);var n=Bg(e,8),t=e.read_shift((i-10)/2,"dbcs-cont");return t=t.replace(xr,""),[n,t]}function HI(e){var i=e[1].Tooltip,n=Me(10+2*(i.length+1));n.write_shift(2,2048);var t=Kn(e[0]);n.write_shift(2,t.r),n.write_shift(2,t.r),n.write_shift(2,t.c),n.write_shift(2,t.c);for(var r=0;r<i.length;++r)n.write_shift(2,i.charCodeAt(r));return n.write_shift(2,0),n}function qI(e){var i=[0,0],n;return n=e.read_shift(2),i[0]=iv[n]||n,n=e.read_shift(2),i[1]=iv[n]||n,i}function XI(e){return e||(e=Me(4)),e.write_shift(2,1),e.write_shift(2,1),e}function KI(e){for(var i=e.read_shift(2),n=[];i-- >0;)n.push(Lb(e,8));return n}function ZI(e){for(var i=e.read_shift(2),n=[];i-- >0;)n.push(Lb(e,8));return n}function QI(e){e.l+=2;var i={cxfs:0,crc:0};return i.cxfs=e.read_shift(2),i.crc=e.read_shift(4),i}function Yb(e,i,n){if(!n.cellStyles)return vr(e,i);var t=n&&n.biff>=12?4:2,r=e.read_shift(t),a=e.read_shift(t),o=e.read_shift(t),l=e.read_shift(t),m=e.read_shift(2);t==2&&(e.l+=2);var g={s:r,e:a,w:o,ixfe:l,flags:m};return(n.biff>=5||!n.biff)&&(g.level=m>>8&7),g}function JI(e,i){var n=Me(12);n.write_shift(2,i),n.write_shift(2,i),n.write_shift(2,e.width*256),n.write_shift(2,0);var t=0;return e.hidden&&(t|=1),n.write_shift(1,t),t=e.level||0,n.write_shift(1,t),n.write_shift(2,0),n}function eA(e,i){var n={};return i<32||(e.l+=16,n.header=_r(e,8),n.footer=_r(e,8),e.l+=2),n}function tA(e,i,n){var t={area:!1};if(n.biff!=5)return e.l+=i,t;var r=e.read_shift(1);return e.l+=3,r&16&&(t.area=!0),t}function nA(e){for(var i=Me(2*e),n=0;n<e;++n)i.write_shift(2,n+1);return i}var iA=ao,rA=Fb,aA=wd;function oA(e){var i=e.read_shift(2),n=e.read_shift(2),t=e.read_shift(4),r={fmt:i,env:n,len:t,data:e.slice(e.l,e.l+t)};return e.l+=t,r}function sA(e,i,n){n.biffguess&&n.biff==5&&(n.biff=2);var t=ao(e,6);++e.l;var r=qs(e,i-7,n);return t.t="str",t.val=r,t}function cA(e){var i=ao(e,6);++e.l;var n=_r(e,8);return i.t="n",i.val=n,i}function lA(e,i,n){var t=Me(15);return Ed(t,e,i),t.write_shift(8,n,"f"),t}function dA(e){var i=ao(e,6);++e.l;var n=e.read_shift(2);return i.t="n",i.val=n,i}function mA(e,i,n){var t=Me(9);return Ed(t,e,i),t.write_shift(2,n),t}function gA(e){var i=e.read_shift(1);return i===0?(e.l++,""):e.read_shift(i,"sbcs-cont")}function uA(e,i){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=i-13}function pA(e,i,n){var t=e.l+i,r=ao(e,6),a=e.read_shift(2),o=Us(e,a,n);return e.l=t,r.t="str",r.val=o,r}var fA=[2,3,48,49,131,139,140,245],bp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},i=Ag({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(l,m){var g=[],f=ss(1);switch(m.type){case"base64":f=Qr(ea(l));break;case"binary":f=Qr(l);break;case"buffer":case"array":f=l;break}Zi(f,0);var h=f.read_shift(1),x=!!(h&136),C=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:C=!0,x=!0;break;case 49:C=!0,x=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var b=0,w=521;h==2&&(b=f.read_shift(2)),f.l+=3,h!=2&&(b=f.read_shift(4)),b>1048576&&(b=1e6),h!=2&&(w=f.read_shift(2));var A=f.read_shift(2),E=m.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(E=e[f[f.l]]),f.l+=1,f.l+=2),y&&(f.l+=36);for(var I=[],K={},Z=Math.min(f.length,h==2?521:w-10-(C?264:0)),k=y?32:11;f.l<Z&&f[f.l]!=13;)switch(K={},K.name=Cn.utils.decode(E,f.slice(f.l,f.l+k)).replace(/[\u0000\r\n].*$/g,""),f.l+=k,K.type=String.fromCharCode(f.read_shift(1)),h!=2&&!y&&(K.offset=f.read_shift(4)),K.len=f.read_shift(1),h==2&&(K.offset=f.read_shift(2)),K.dec=f.read_shift(1),K.name.length&&I.push(K),h!=2&&(f.l+=y?13:14),K.type){case"B":(!C||K.len!=8)&&m.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+K.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var S=0,V=0;for(g[0]=[],V=0;V!=I.length;++V)g[0][V]=I[V].name;for(;b-- >0;){if(f[f.l]===42){f.l+=A;continue}for(++f.l,g[++S]=[],V=0,V=0;V!=I.length;++V){var W=f.slice(f.l,f.l+I[V].len);f.l+=I[V].len,Zi(W,0);var Q=Cn.utils.decode(E,W);switch(I[V].type){case"C":Q.trim().length&&(g[S][V]=Q.replace(/\s+$/,""));break;case"D":Q.length===8?g[S][V]=new Date(+Q.slice(0,4),+Q.slice(4,6)-1,+Q.slice(6,8)):g[S][V]=Q;break;case"F":g[S][V]=parseFloat(Q.trim());break;case"+":case"I":g[S][V]=y?W.read_shift(-4,"i")^2147483648:W.read_shift(4,"i");break;case"L":switch(Q.trim().toUpperCase()){case"Y":case"T":g[S][V]=!0;break;case"N":case"F":g[S][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Q+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));g[S][V]="##MEMO##"+(y?parseInt(Q.trim(),10):W.read_shift(4));break;case"N":Q=Q.replace(/\u0000/g,"").trim(),Q&&Q!="."&&(g[S][V]=+Q||0);break;case"@":g[S][V]=new Date(W.read_shift(-8,"f")-621356832e5);break;case"T":g[S][V]=new Date((W.read_shift(4)-2440588)*864e5+W.read_shift(4));break;case"Y":g[S][V]=W.read_shift(4,"i")/1e4+W.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[S][V]=-W.read_shift(-8,"f");break;case"B":if(C&&I[V].len==8){g[S][V]=W.read_shift(8,"f");break}case"G":case"P":W.l+=I[V].len;break;case"0":if(I[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[V].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return m&&m.sheetRows&&(g=g.slice(0,m.sheetRows)),m.DBF=I,g}function t(l,m){var g=m||{};g.dateNF||(g.dateNF="yyyymmdd");var f=hl(n(l,g),g);return f["!cols"]=g.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete g.DBF,f}function r(l,m){try{return gs(t(l,m),m)}catch(g){if(m&&m.WTF)throw g}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,m){var g=m||{};if(+g.codepage>=0&&Aa(+g.codepage),g.type=="string")throw new Error("Cannot write DBF to JS string");var f=jr(),h=Tg(l,{header:1,raw:!0,cellDates:!0}),x=h[0],C=h.slice(1),y=l["!cols"]||[],b=0,w=0,A=0,E=1;for(b=0;b<x.length;++b){if(((y[b]||{}).DBF||{}).name){x[b]=y[b].DBF.name,++A;continue}if(x[b]!=null){if(++A,typeof x[b]=="number"&&(x[b]=x[b].toString(10)),typeof x[b]!="string")throw new Error("DBF Invalid column name "+x[b]+" |"+typeof x[b]+"|");if(x.indexOf(x[b])!==b){for(w=0;w<1024;++w)if(x.indexOf(x[b]+"_"+w)==-1){x[b]+="_"+w;break}}}}var I=cn(l["!ref"]),K=[],Z=[],k=[];for(b=0;b<=I.e.c-I.s.c;++b){var S="",V="",W=0,Q=[];for(w=0;w<C.length;++w)C[w][b]!=null&&Q.push(C[w][b]);if(Q.length==0||x[b]==null){K[b]="?";continue}for(w=0;w<Q.length;++w){switch(typeof Q[w]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=Q[w]instanceof Date?"D":"C";break;default:V="C"}W=Math.max(W,String(Q[w]).length),S=S&&S!=V?"C":V}W>250&&(W=250),V=((y[b]||{}).DBF||{}).type,V=="C"&&y[b].DBF.len>W&&(W=y[b].DBF.len),S=="B"&&V=="N"&&(S="N",k[b]=y[b].DBF.dec,W=y[b].DBF.len),Z[b]=S=="C"||V=="N"?W:a[S]||0,E+=Z[b],K[b]=S}var se=f.next(32);for(se.write_shift(4,318902576),se.write_shift(4,C.length),se.write_shift(2,296+32*A),se.write_shift(2,E),b=0;b<4;++b)se.write_shift(4,0);for(se.write_shift(4,0|(+i[ll]||3)<<8),b=0,w=0;b<x.length;++b)if(x[b]!=null){var ae=f.next(32),ke=(x[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ae.write_shift(1,ke,"sbcs"),ae.write_shift(1,K[b]=="?"?"C":K[b],"sbcs"),ae.write_shift(4,w),ae.write_shift(1,Z[b]||a[K[b]]||0),ae.write_shift(1,k[b]||0),ae.write_shift(1,2),ae.write_shift(4,0),ae.write_shift(1,0),ae.write_shift(4,0),ae.write_shift(4,0),w+=Z[b]||a[K[b]]||0}var Ne=f.next(264);for(Ne.write_shift(4,13),b=0;b<65;++b)Ne.write_shift(4,0);for(b=0;b<C.length;++b){var Ce=f.next(E);for(Ce.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(K[w]){case"L":Ce.write_shift(1,C[b][w]==null?63:C[b][w]?84:70);break;case"B":Ce.write_shift(8,C[b][w]||0,"f");break;case"N":var Ve="0";for(typeof C[b][w]=="number"&&(Ve=C[b][w].toFixed(k[w]||0)),A=0;A<Z[w]-Ve.length;++A)Ce.write_shift(1,32);Ce.write_shift(1,Ve,"sbcs");break;case"D":C[b][w]?(Ce.write_shift(4,("0000"+C[b][w].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(C[b][w].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+C[b][w].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var Oe=String(C[b][w]!=null?C[b][w]:"").slice(0,Z[w]);for(Ce.write_shift(1,Oe,"sbcs"),A=0;A<Z[w]-Oe.length;++A)Ce.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:r,to_sheet:t,from_sheet:o}}(),Wb=function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},i=new RegExp("\x1BN("+ci(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(x,C){var y=e[C];return typeof y=="number"?EC(y):y},t=function(x,C,y){var b=C.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return b==59?x:EC(b)};e["|"]=254;function r(x,C){switch(C.type){case"base64":return a(ea(x),C);case"binary":return a(x,C);case"buffer":return a(Zt&&Buffer.isBuffer(x)?x.toString("binary"):ms(x),C);case"array":return a(Ls(x),C)}throw new Error("Unrecognized type "+C.type)}function a(x,C){var y=x.split(/[\n\r]+/),b=-1,w=-1,A=0,E=0,I=[],K=[],Z=null,k={},S=[],V=[],W=[],Q=0,se;for(+C.codepage>=0&&Aa(+C.codepage);A!==y.length;++A){Q=0;var ae=y[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,t).replace(i,n),ke=ae.replace(/;;/g,"\0").split(";").map(function(ee){return ee.replace(/\u0000/g,";")}),Ne=ke[0],Ce;if(ae.length>0)switch(Ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ke[1].charAt(0)=="P"&&K.push(ae.slice(3).replace(/;;/g,";"));break;case"C":var Ve=!1,Oe=!1,Ze=!1,Se=!1,Fe=-1,de=-1;for(E=1;E<ke.length;++E)switch(ke[E].charAt(0)){case"A":break;case"X":w=parseInt(ke[E].slice(1))-1,Oe=!0;break;case"Y":for(b=parseInt(ke[E].slice(1))-1,Oe||(w=0),se=I.length;se<=b;++se)I[se]=[];break;case"K":Ce=ke[E].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(Fa(Ce))?isNaN(dl(Ce).getDate())||(Ce=Ln(Ce)):(Ce=Fa(Ce),Z!==null&&ul(Z)&&(Ce=Fg(Ce))),typeof Cn<"u"&&typeof Ce=="string"&&(C||{}).type!="string"&&(C||{}).codepage&&(Ce=Cn.utils.decode(C.codepage,Ce)),Ve=!0;break;case"E":Se=!0;var X=sl(ke[E].slice(1),{r:b,c:w});I[b][w]=[I[b][w],X];break;case"S":Ze=!0,I[b][w]=[I[b][w],"S5S"];break;case"G":break;case"R":Fe=parseInt(ke[E].slice(1))-1;break;case"C":de=parseInt(ke[E].slice(1))-1;break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+ae)}if(Ve&&(I[b][w]&&I[b][w].length==2?I[b][w][0]=Ce:I[b][w]=Ce,Z=null),Ze){if(Se)throw new Error("SYLK shared formula cannot have own formula");var te=Fe>-1&&I[Fe][de];if(!te||!te[1])throw new Error("SYLK shared formula cannot find base");I[b][w][1]=ly(te[1],{r:b-Fe,c:w-de})}break;case"F":var J=0;for(E=1;E<ke.length;++E)switch(ke[E].charAt(0)){case"X":w=parseInt(ke[E].slice(1))-1,++J;break;case"Y":for(b=parseInt(ke[E].slice(1))-1,se=I.length;se<=b;++se)I[se]=[];break;case"M":Q=parseInt(ke[E].slice(1))/20;break;case"F":break;case"G":break;case"P":Z=K[parseInt(ke[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(W=ke[E].slice(1).split(" "),se=parseInt(W[0],10);se<=parseInt(W[1],10);++se)Q=parseInt(W[2],10),V[se-1]=Q===0?{hidden:!0}:{wch:Q},cs(V[se-1]);break;case"C":w=parseInt(ke[E].slice(1))-1,V[w]||(V[w]={});break;case"R":b=parseInt(ke[E].slice(1))-1,S[b]||(S[b]={}),Q>0?(S[b].hpt=Q,S[b].hpx=gl(Q)):Q===0&&(S[b].hidden=!0);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+ae)}J<1&&(Z=null);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+ae)}}return S.length>0&&(k["!rows"]=S),V.length>0&&(k["!cols"]=V),C&&C.sheetRows&&(I=I.slice(0,C.sheetRows)),[I,k]}function o(x,C){var y=r(x,C),b=y[0],w=y[1],A=hl(b,C);return ci(w).forEach(function(E){A[E]=w[E]}),A}function l(x,C){return gs(o(x,C),C)}function m(x,C,y,b){var w="C;Y"+(y+1)+";X"+(b+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+af(x.f,{r:y,c:b}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function g(x,C){C.forEach(function(y,b){var w="F;W"+(b+1)+" "+(b+1)+" ";y.hidden?w+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=xd(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Cd(y.wpx)),typeof y.wch=="number"&&(w+=Math.round(y.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function f(x,C){C.forEach(function(y,b){var w="F;";y.hidden?w+="M0;":y.hpt?w+="M"+20*y.hpt+";":y.hpx&&(w+="M"+20*vd(y.hpx)+";"),w.length>2&&x.push(w+"R"+(b+1))})}function h(x,C){var y=["ID;PWXL;N;E"],b=[],w=cn(x["!ref"]),A,E=Array.isArray(x),I=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),x["!cols"]&&g(y,x["!cols"]),x["!rows"]&&f(y,x["!rows"]),y.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var K=w.s.r;K<=w.e.r;++K)for(var Z=w.s.c;Z<=w.e.c;++Z){var k=Pt({r:K,c:Z});A=E?(x[K]||[])[Z]:x[k],!(!A||A.v==null&&(!A.f||A.F))&&b.push(m(A,x,K,Z,C))}return y.join(I)+I+b.join(I)+I+"E"+I}return{to_workbook:l,to_sheet:o,from_sheet:h}}(),Gb=function(){function e(a,o){switch(o.type){case"base64":return i(ea(a),o);case"binary":return i(a,o);case"buffer":return i(Zt&&Buffer.isBuffer(a)?a.toString("binary"):ms(a),o);case"array":return i(Ls(a),o)}throw new Error("Unrecognized type "+o.type)}function i(a,o){for(var l=a.split(`
`),m=-1,g=-1,f=0,h=[];f!==l.length;++f){if(l[f].trim()==="BOT"){h[++m]=[],g=0;continue}if(!(m<0)){var x=l[f].trim().split(","),C=x[0],y=x[1];++f;for(var b=l[f]||"";(b.match(/["]/g)||[]).length&1&&f<l.length-1;)b+=`
`+l[++f];switch(b=b.trim(),+C){case-1:if(b==="BOT"){h[++m]=[],g=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?h[m][g]=!0:b==="FALSE"?h[m][g]=!1:isNaN(Fa(y))?isNaN(dl(y).getDate())?h[m][g]=y:h[m][g]=Ln(y):h[m][g]=Fa(y),++g;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),Zl&&b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),h[m][g++]=b!==""?b:null;break}if(b==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function n(a,o){return hl(e(a,o),o)}function t(a,o){return gs(n(a,o),o)}var r=function(){var a=function(m,g,f,h,x){m.push(g),m.push(f+","+h),m.push('"'+x.replace(/"/g,'""')+'"')},o=function(m,g,f,h){m.push(g+","+f),m.push(g==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(m){var g=[],f=cn(m["!ref"]),h,x=Array.isArray(m);a(g,"TABLE",0,1,"sheetjs"),a(g,"VECTORS",0,f.e.r-f.s.r+1,""),a(g,"TUPLES",0,f.e.c-f.s.c+1,""),a(g,"DATA",0,0,"");for(var C=f.s.r;C<=f.e.r;++C){o(g,-1,0,"BOT");for(var y=f.s.c;y<=f.e.c;++y){var b=Pt({r:C,c:y});if(h=x?(m[C]||[])[y]:m[b],!h){o(g,1,0,"");continue}switch(h.t){case"n":var w=Zl?h.w:h.v;!w&&h.v!=null&&(w=h.v),w==null?Zl&&h.f&&!h.F?o(g,1,0,"="+h.f):o(g,1,0,""):o(g,0,w,"V");break;case"b":o(g,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(g,1,0,!Zl||isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=va(h.z||Mt[14],Di(Ln(h.v)))),Zl?o(g,0,h.w,"V"):o(g,1,0,h.w);break;default:o(g,1,0,"")}}}o(g,-1,0,"EOD");var A=`\r
`,E=g.join(A);return E}}();return{to_workbook:t,to_sheet:n,from_sheet:r}}(),Hb=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function i(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(h,x){for(var C=h.split(`
`),y=-1,b=-1,w=0,A=[];w!==C.length;++w){var E=C[w].trim().split(":");if(E[0]==="cell"){var I=Kn(E[1]);if(A.length<=I.r)for(y=A.length;y<=I.r;++y)A[y]||(A[y]=[]);switch(y=I.r,b=I.c,E[2]){case"t":A[y][b]=e(E[3]);break;case"v":A[y][b]=+E[3];break;case"vtf":var K=E[E.length-1];case"vtc":switch(E[3]){case"nl":A[y][b]=!!+E[4];break;default:A[y][b]=+E[4];break}E[2]=="vtf"&&(A[y][b]=[A[y][b],K])}}}return x&&x.sheetRows&&(A=A.slice(0,x.sheetRows)),A}function t(h,x){return hl(n(h,x),x)}function r(h,x){return gs(t(h,x),x)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function g(h){if(!h||!h["!ref"])return"";for(var x=[],C=[],y,b="",w=$r(h["!ref"]),A=Array.isArray(h),E=w.s.r;E<=w.e.r;++E)for(var I=w.s.c;I<=w.e.c;++I)if(b=Pt({r:E,c:I}),y=A?(h[E]||[])[I]:h[b],!(!y||y.v==null||y.t==="z")){switch(C=["cell",b,"t"],y.t){case"s":case"str":C.push(i(y.v));break;case"n":y.f?(C[2]="vtf",C[3]="n",C[4]=y.v,C[5]=i(y.f)):(C[2]="v",C[3]=y.v);break;case"b":C[2]="vt"+(y.f?"f":"c"),C[3]="nl",C[4]=y.v?"1":"0",C[5]=i(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var K=Di(Ln(y.v));C[2]="vtc",C[3]="nd",C[4]=""+K,C[5]=y.w||va(y.z||Mt[14],K);break;case"e":continue}x.push(C.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function f(h){return[a,o,l,o,g(h),m].join(`
`)}return{to_workbook:r,to_sheet:t,from_sheet:f}}(),ml=function(){function e(f,h,x,C,y){y.raw?h[x][C]=f:f===""||(f==="TRUE"?h[x][C]=!0:f==="FALSE"?h[x][C]=!1:isNaN(Fa(f))?isNaN(dl(f).getDate())?h[x][C]=f:h[x][C]=Ln(f):h[x][C]=Fa(f))}function i(f,h){var x=h||{},C=[];if(!f||f.length===0)return C;for(var y=f.split(/[\r\n]/),b=y.length-1;b>=0&&y[b].length===0;)--b;for(var w=10,A=0,E=0;E<=b;++E)A=y[E].indexOf(" "),A==-1?A=y[E].length:A++,w=Math.max(w,A);for(E=0;E<=b;++E){C[E]=[];var I=0;for(e(y[E].slice(0,w).trim(),C,E,I,x),I=1;I<=(y[E].length-w)/10+1;++I)e(y[E].slice(w+(I-1)*10,w+I*10).trim(),C,E,I,x)}return x.sheetRows&&(C=C.slice(0,x.sheetRows)),C}var n={44:",",9:"	",59:";",124:"|"},t={44:3,9:2,59:1,124:0};function r(f){for(var h={},x=!1,C=0,y=0;C<f.length;++C)(y=f.charCodeAt(C))==34?x=!x:!x&&y in n&&(h[y]=(h[y]||0)+1);y=[];for(C in h)Object.prototype.hasOwnProperty.call(h,C)&&y.push([h[C],C]);if(!y.length){h=t;for(C in h)Object.prototype.hasOwnProperty.call(h,C)&&y.push([h[C],C])}return y.sort(function(b,w){return b[0]-w[0]||t[b[1]]-t[w[1]]}),n[y.pop()[1]]||44}function a(f,h){var x=h||{},C="";si!=null&&x.dense==null&&(x.dense=si);var y=x.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(C=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(C=f.charAt(4),f=f.slice(6)):C=r(f.slice(0,1024)):x&&x.FS?C=x.FS:C=r(f.slice(0,1024));var w=0,A=0,E=0,I=0,K=0,Z=C.charCodeAt(0),k=!1,S=0,V=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var W=x.dateNF!=null?t6(x.dateNF):null;function Q(){var se=f.slice(I,K),ae={};if(se.charAt(0)=='"'&&se.charAt(se.length-1)=='"'&&(se=se.slice(1,-1).replace(/""/g,'"')),se.length===0)ae.t="z";else if(x.raw)ae.t="s",ae.v=se;else if(se.trim().length===0)ae.t="s",ae.v=se;else if(se.charCodeAt(0)==61)se.charCodeAt(1)==34&&se.charCodeAt(se.length-1)==34?(ae.t="s",ae.v=se.slice(2,-1).replace(/""/g,'"')):EF(se)?(ae.t="n",ae.f=se.slice(1)):(ae.t="s",ae.v=se);else if(se=="TRUE")ae.t="b",ae.v=!0;else if(se=="FALSE")ae.t="b",ae.v=!1;else if(!isNaN(E=Fa(se)))ae.t="n",x.cellText!==!1&&(ae.w=se),ae.v=E;else if(!isNaN(dl(se).getDate())||W&&se.match(W)){ae.z=x.dateNF||Mt[14];var ke=0;W&&se.match(W)&&(se=n6(se,x.dateNF,se.match(W)||[]),ke=1),x.cellDates?(ae.t="d",ae.v=Ln(se,ke)):(ae.t="n",ae.v=Di(Ln(se,ke))),x.cellText!==!1&&(ae.w=va(ae.z,ae.v instanceof Date?Di(ae.v):ae.v)),x.cellNF||delete ae.z}else ae.t="s",ae.v=se;if(ae.t=="z"||(x.dense?(y[w]||(y[w]=[]),y[w][A]=ae):y[Pt({c:A,r:w})]=ae),I=K+1,V=f.charCodeAt(I),b.e.c<A&&(b.e.c=A),b.e.r<w&&(b.e.r=w),S==Z)++A;else if(A=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;K<f.length;++K)switch(S=f.charCodeAt(K)){case 34:V===34&&(k=!k);break;case Z:case 10:case 13:if(!k&&Q())break e;break;default:break}return K-I>0&&Q(),y["!ref"]=zt(b),y}function o(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,h):hl(i(f,h),h)}function l(f,h){var x="",C=h.type=="string"?[0,0,0,0]:uf(f,h);switch(h.type){case"base64":x=ea(f);break;case"binary":x=f;break;case"buffer":h.codepage==65001?x=f.toString("utf8"):h.codepage&&typeof Cn<"u"?x=Cn.utils.decode(h.codepage,f):x=Zt&&Buffer.isBuffer(f)?f.toString("binary"):ms(f);break;case"array":x=Ls(f);break;case"string":x=f;break;default:throw new Error("Unrecognized type "+h.type)}return C[0]==239&&C[1]==187&&C[2]==191?x=wn(x.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?x=wn(x):h.type=="binary"&&typeof Cn<"u"&&h.codepage&&(x=Cn.utils.decode(h.codepage,Cn.utils.encode(28591,x))),x.slice(0,19)=="socialcalc:version:"?Hb.to_sheet(h.type=="string"?x:wn(x),h):o(x,h)}function m(f,h){return gs(l(f,h),h)}function g(f){for(var h=[],x=cn(f["!ref"]),C,y=Array.isArray(f),b=x.s.r;b<=x.e.r;++b){for(var w=[],A=x.s.c;A<=x.e.c;++A){var E=Pt({r:b,c:A});if(C=y?(f[b]||[])[A]:f[E],!C||C.v==null){w.push("          ");continue}for(var I=(C.w||(Eo(C),C.w)||"").slice(0,10);I.length<10;)I+=" ";w.push(I+(A===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:m,to_sheet:l,from_sheet:g}}();function hA(e,i){var n=i||{},t=!!n.WTF;n.WTF=!0;try{var r=Wb.to_workbook(e,n);return n.WTF=t,r}catch(a){if(n.WTF=t,!a.message.match(/SYLK bad record ID/)&&t)throw a;return ml.to_workbook(e,i)}}var Rs=function(){function e(X,te,J){if(X){Zi(X,X.l||0);for(var ee=J.Enum||Fe;X.l<X.length;){var ge=X.read_shift(2),Te=ee[ge]||ee[65535],Ee=X.read_shift(2),Pe=X.l+Ee,ve=Te.f&&Te.f(X,Ee,J);if(X.l=Pe,te(ve,Te,ge))return}}}function i(X,te){switch(te.type){case"base64":return n(Qr(ea(X)),te);case"binary":return n(Qr(X),te);case"buffer":case"array":return n(X,te)}throw"Unsupported type "+te.type}function n(X,te){if(!X)return X;var J=te||{};si!=null&&J.dense==null&&(J.dense=si);var ee=J.dense?[]:{},ge="Sheet1",Te="",Ee=0,Pe={},ve=[],ot=[],H={s:{r:0,c:0},e:{r:0,c:0}},mt=J.sheetRows||0;if(X[2]==0&&(X[3]==8||X[3]==9)&&X.length>=16&&X[14]==5&&X[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(X[2]==2)J.Enum=Fe,e(X,function(Be,Ft,ln){switch(ln){case 0:J.vers=Be,Be>=4096&&(J.qpro=!0);break;case 6:H=Be;break;case 204:Be&&(Te=Be);break;case 222:Te=Be;break;case 15:case 51:J.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:ln==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=J.dateNF||Mt[14],J.cellDates&&(Be[1].t="d",Be[1].v=Fg(Be[1].v))),J.qpro&&Be[3]>Ee&&(ee["!ref"]=zt(H),Pe[ge]=ee,ve.push(ge),ee=J.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Ee=Be[3],ge=Te||"Sheet"+(Ee+1),Te="");var In=J.dense?(ee[Be[0].r]||[])[Be[0].c]:ee[Pt(Be[0])];if(In){In.t=Be[1].t,In.v=Be[1].v,Be[1].z!=null&&(In.z=Be[1].z),Be[1].f!=null&&(In.f=Be[1].f);break}J.dense?(ee[Be[0].r]||(ee[Be[0].r]=[]),ee[Be[0].r][Be[0].c]=Be[1]):ee[Pt(Be[0])]=Be[1];break;default:}},J);else if(X[2]==26||X[2]==14)J.Enum=de,X[2]==14&&(J.qpro=!0,X.l=0),e(X,function(Be,Ft,ln){switch(ln){case 204:ge=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>Ee&&(ee["!ref"]=zt(H),Pe[ge]=ee,ve.push(ge),ee=J.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Ee=Be[3],ge="Sheet"+(Ee+1)),mt>0&&Be[0].r>=mt)break;J.dense?(ee[Be[0].r]||(ee[Be[0].r]=[]),ee[Be[0].r][Be[0].c]=Be[1]):ee[Pt(Be[0])]=Be[1],H.e.c<Be[0].c&&(H.e.c=Be[0].c),H.e.r<Be[0].r&&(H.e.r=Be[0].r);break;case 27:Be[14e3]&&(ot[Be[14e3][0]]=Be[14e3][1]);break;case 1537:ot[Be[0]]=Be[1],Be[0]==Ee&&(ge=Be[1]);break;default:break}},J);else throw new Error("Unrecognized LOTUS BOF "+X[2]);if(ee["!ref"]=zt(H),Pe[Te||ge]=ee,ve.push(Te||ge),!ot.length)return{SheetNames:ve,Sheets:Pe};for(var Je={},Ot=[],nt=0;nt<ot.length;++nt)Pe[ve[nt]]?(Ot.push(ot[nt]||ve[nt]),Je[ot[nt]]=Pe[ot[nt]]||Pe[ve[nt]]):(Ot.push(ot[nt]),Je[ot[nt]]={"!ref":"A1"});return{SheetNames:Ot,Sheets:Je}}function t(X,te){var J=te||{};if(+J.codepage>=0&&Aa(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var ee=jr(),ge=cn(X["!ref"]),Te=Array.isArray(X),Ee=[];Xe(ee,0,a(1030)),Xe(ee,6,m(ge));for(var Pe=Math.min(ge.e.r,8191),ve=ge.s.r;ve<=Pe;++ve)for(var ot=pi(ve),H=ge.s.c;H<=ge.e.c;++H){ve===ge.s.r&&(Ee[H]=Xn(H));var mt=Ee[H]+ot,Je=Te?(X[ve]||[])[H]:X[mt];if(!(!Je||Je.t=="z"))if(Je.t=="n")(Je.v|0)==Je.v&&Je.v>=-32768&&Je.v<=32767?Xe(ee,13,C(ve,H,Je.v)):Xe(ee,14,b(ve,H,Je.v));else{var Ot=Eo(Je);Xe(ee,15,h(ve,H,Ot.slice(0,239)))}}return Xe(ee,1),ee.end()}function r(X,te){var J=te||{};if(+J.codepage>=0&&Aa(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var ee=jr();Xe(ee,0,o(X));for(var ge=0,Te=0;ge<X.SheetNames.length;++ge)(X.Sheets[X.SheetNames[ge]]||{})["!ref"]&&Xe(ee,27,Se(X.SheetNames[ge],Te++));var Ee=0;for(ge=0;ge<X.SheetNames.length;++ge){var Pe=X.Sheets[X.SheetNames[ge]];if(!(!Pe||!Pe["!ref"])){for(var ve=cn(Pe["!ref"]),ot=Array.isArray(Pe),H=[],mt=Math.min(ve.e.r,8191),Je=ve.s.r;Je<=mt;++Je)for(var Ot=pi(Je),nt=ve.s.c;nt<=ve.e.c;++nt){Je===ve.s.r&&(H[nt]=Xn(nt));var Be=H[nt]+Ot,Ft=ot?(Pe[Je]||[])[nt]:Pe[Be];if(!(!Ft||Ft.t=="z"))if(Ft.t=="n")Xe(ee,23,Q(Je,nt,Ee,Ft.v));else{var ln=Eo(Ft);Xe(ee,22,S(Je,nt,Ee,ln.slice(0,239)))}}++Ee}}return Xe(ee,1),ee.end()}function a(X){var te=Me(2);return te.write_shift(2,X),te}function o(X){var te=Me(26);te.write_shift(2,4096),te.write_shift(2,4),te.write_shift(4,0);for(var J=0,ee=0,ge=0,Te=0;Te<X.SheetNames.length;++Te){var Ee=X.SheetNames[Te],Pe=X.Sheets[Ee];if(!(!Pe||!Pe["!ref"])){++ge;var ve=$r(Pe["!ref"]);J<ve.e.r&&(J=ve.e.r),ee<ve.e.c&&(ee=ve.e.c)}}return J>8191&&(J=8191),te.write_shift(2,J),te.write_shift(1,ge),te.write_shift(1,ee),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(1,1),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(4,0),te}function l(X,te,J){var ee={s:{c:0,r:0},e:{c:0,r:0}};return te==8&&J.qpro?(ee.s.c=X.read_shift(1),X.l++,ee.s.r=X.read_shift(2),ee.e.c=X.read_shift(1),X.l++,ee.e.r=X.read_shift(2),ee):(ee.s.c=X.read_shift(2),ee.s.r=X.read_shift(2),te==12&&J.qpro&&(X.l+=2),ee.e.c=X.read_shift(2),ee.e.r=X.read_shift(2),te==12&&J.qpro&&(X.l+=2),ee.s.c==65535&&(ee.s.c=ee.e.c=ee.s.r=ee.e.r=0),ee)}function m(X){var te=Me(8);return te.write_shift(2,X.s.c),te.write_shift(2,X.s.r),te.write_shift(2,X.e.c),te.write_shift(2,X.e.r),te}function g(X,te,J){var ee=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(ee[0].c=X.read_shift(1),ee[3]=X.read_shift(1),ee[0].r=X.read_shift(2),X.l+=2):(ee[2]=X.read_shift(1),ee[0].c=X.read_shift(2),ee[0].r=X.read_shift(2)),ee}function f(X,te,J){var ee=X.l+te,ge=g(X,te,J);if(ge[1].t="s",J.vers==20768){X.l++;var Te=X.read_shift(1);return ge[1].v=X.read_shift(Te,"utf8"),ge}return J.qpro&&X.l++,ge[1].v=X.read_shift(ee-X.l,"cstr"),ge}function h(X,te,J){var ee=Me(7+J.length);ee.write_shift(1,255),ee.write_shift(2,te),ee.write_shift(2,X),ee.write_shift(1,39);for(var ge=0;ge<ee.length;++ge){var Te=J.charCodeAt(ge);ee.write_shift(1,Te>=128?95:Te)}return ee.write_shift(1,0),ee}function x(X,te,J){var ee=g(X,te,J);return ee[1].v=X.read_shift(2,"i"),ee}function C(X,te,J){var ee=Me(7);return ee.write_shift(1,255),ee.write_shift(2,te),ee.write_shift(2,X),ee.write_shift(2,J,"i"),ee}function y(X,te,J){var ee=g(X,te,J);return ee[1].v=X.read_shift(8,"f"),ee}function b(X,te,J){var ee=Me(13);return ee.write_shift(1,255),ee.write_shift(2,te),ee.write_shift(2,X),ee.write_shift(8,J,"f"),ee}function w(X,te,J){var ee=X.l+te,ge=g(X,te,J);if(ge[1].v=X.read_shift(8,"f"),J.qpro)X.l=ee;else{var Te=X.read_shift(2);K(X.slice(X.l,X.l+Te),ge),X.l+=Te}return ge}function A(X,te,J){var ee=te&32768;return te&=-32769,te=(ee?X:0)+(te>=8192?te-16384:te),(ee?"":"$")+(J?Xn(te):pi(te))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function K(X,te){Zi(X,0);for(var J=[],ee=0,ge="",Te="",Ee="",Pe="";X.l<X.length;){var ve=X[X.l++];switch(ve){case 0:J.push(X.read_shift(8,"f"));break;case 1:Te=A(te[0].c,X.read_shift(2),!0),ge=A(te[0].r,X.read_shift(2),!1),J.push(Te+ge);break;case 2:{var ot=A(te[0].c,X.read_shift(2),!0),H=A(te[0].r,X.read_shift(2),!1);Te=A(te[0].c,X.read_shift(2),!0),ge=A(te[0].r,X.read_shift(2),!1),J.push(ot+H+":"+Te+ge)}break;case 3:if(X.l<X.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(X.read_shift(2));break;case 6:{for(var mt="";ve=X[X.l++];)mt+=String.fromCharCode(ve);J.push('"'+mt.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:Pe=J.pop(),Ee=J.pop(),J.push(["AND","OR"][ve-20]+"("+Ee+","+Pe+")");break;default:if(ve<32&&I[ve])Pe=J.pop(),Ee=J.pop(),J.push(Ee+I[ve]+Pe);else if(E[ve]){if(ee=E[ve][1],ee==69&&(ee=X[X.l++]),ee>J.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+J.join("|")+"|");return}var Je=J.slice(-ee);J.length-=ee,J.push(E[ve][0]+"("+Je.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}J.length==1?te[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function Z(X){var te=[{c:0,r:0},{t:"n",v:0},0];return te[0].r=X.read_shift(2),te[3]=X[X.l++],te[0].c=X[X.l++],te}function k(X,te){var J=Z(X,te);return J[1].t="s",J[1].v=X.read_shift(te-4,"cstr"),J}function S(X,te,J,ee){var ge=Me(6+ee.length);ge.write_shift(2,X),ge.write_shift(1,J),ge.write_shift(1,te),ge.write_shift(1,39);for(var Te=0;Te<ee.length;++Te){var Ee=ee.charCodeAt(Te);ge.write_shift(1,Ee>=128?95:Ee)}return ge.write_shift(1,0),ge}function V(X,te){var J=Z(X,te);J[1].v=X.read_shift(2);var ee=J[1].v>>1;if(J[1].v&1)switch(ee&7){case 0:ee=(ee>>3)*5e3;break;case 1:ee=(ee>>3)*500;break;case 2:ee=(ee>>3)/20;break;case 3:ee=(ee>>3)/200;break;case 4:ee=(ee>>3)/2e3;break;case 5:ee=(ee>>3)/2e4;break;case 6:ee=(ee>>3)/16;break;case 7:ee=(ee>>3)/64;break}return J[1].v=ee,J}function W(X,te){var J=Z(X,te),ee=X.read_shift(4),ge=X.read_shift(4),Te=X.read_shift(2);if(Te==65535)return ee===0&&ge===3221225472?(J[1].t="e",J[1].v=15):ee===0&&ge===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var Ee=Te&32768;return Te=(Te&32767)-16446,J[1].v=(1-Ee*2)*(ge*Math.pow(2,Te+32)+ee*Math.pow(2,Te)),J}function Q(X,te,J,ee){var ge=Me(14);if(ge.write_shift(2,X),ge.write_shift(1,J),ge.write_shift(1,te),ee==0)return ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(2,65535),ge;var Te=0,Ee=0,Pe=0,ve=0;return ee<0&&(Te=1,ee=-ee),Ee=Math.log2(ee)|0,ee/=Math.pow(2,Ee-31),ve=ee>>>0,ve&2147483648||(ee/=2,++Ee,ve=ee>>>0),ee-=ve,ve|=2147483648,ve>>>=0,ee*=Math.pow(2,32),Pe=ee>>>0,ge.write_shift(4,Pe),ge.write_shift(4,ve),Ee+=16383+(Te?32768:0),ge.write_shift(2,Ee),ge}function se(X,te){var J=W(X,14);return X.l+=te-14,J}function ae(X,te){var J=Z(X,te),ee=X.read_shift(4);return J[1].v=ee>>6,J}function ke(X,te){var J=Z(X,te),ee=X.read_shift(8,"f");return J[1].v=ee,J}function Ne(X,te){var J=ke(X,14);return X.l+=te-10,J}function Ce(X,te){return X[X.l+te-1]==0?X.read_shift(te,"cstr"):""}function Ve(X,te){var J=X[X.l++];J>te-1&&(J=te-1);for(var ee="";ee.length<J;)ee+=String.fromCharCode(X[X.l++]);return ee}function Oe(X,te,J){if(!(!J.qpro||te<21)){var ee=X.read_shift(1);X.l+=17,X.l+=1,X.l+=2;var ge=X.read_shift(te-21,"cstr");return[ee,ge]}}function Ze(X,te){for(var J={},ee=X.l+te;X.l<ee;){var ge=X.read_shift(2);if(ge==14e3){for(J[ge]=[0,""],J[ge][0]=X.read_shift(2);X[X.l];)J[ge][1]+=String.fromCharCode(X[X.l]),X.l++;X.l++}}return J}function Se(X,te){var J=Me(5+X.length);J.write_shift(2,14e3),J.write_shift(2,te);for(var ee=0;ee<X.length;++ee){var ge=X.charCodeAt(ee);J[J.l++]=ge>127?95:ge}return J[J.l++]=0,J}var Fe={0:{n:"BOF",f:Ti},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:y},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:Ve},65535:{n:""}},de={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:W},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:se},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ze},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ae},38:{n:"??"},39:{n:"NUMBER27",f:ke},40:{n:"FORMULA28",f:Ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:t,book_to_wk3:r,to_workbook:i}}();function _A(e){var i={},n=e.match(br),t=0,r=!1;if(n)for(;t!=n.length;++t){var a=kt(n[t]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":i.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;i.cp=Op[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":i.outline=1;break;case"</outline>":break;case"<rFont":i.name=a.val;break;case"<sz":i.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":i.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":i.uval="double";break;case"singleAccounting":i.uval="single-accounting";break;case"doubleAccounting":i.uval="double-accounting";break}case"<u>":case"<u/>":i.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":i.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":i.i=1;break;case"</i>":break;case"<color":a.rgb&&(i.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":i.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":i.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(a[0].charCodeAt(1)!==47&&!r)throw new Error("Unrecognized rich format "+a[0])}}return i}var xA=function(){var e=ud("t"),i=ud("rPr");function n(a){var o=a.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:sn(o[1])},m=a.match(i);return m&&(l.s=_A(m[1])),l}var t=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(o){return o.replace(t,"").split(r).map(n).filter(function(l){return l.v})}}(),CA=function(){var i=/(\r\n|\n)/g;function n(r,a,o){var l=[];r.u&&l.push("text-decoration: underline;"),r.uval&&l.push("text-underline-style:"+r.uval+";"),r.sz&&l.push("font-size:"+r.sz+"pt;"),r.outline&&l.push("text-effect: outline;"),r.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),r.b&&(a.push("<b>"),o.push("</b>")),r.i&&(a.push("<i>"),o.push("</i>")),r.strike&&(a.push("<s>"),o.push("</s>"));var m=r.valign||"";return m=="superscript"||m=="super"?m="sup":m=="subscript"&&(m="sub"),m!=""&&(a.push("<"+m+">"),o.push("</"+m+">")),o.push("</span>"),r}function t(r){var a=[[],r.v,[]];return r.v?(r.s&&n(r.s,a[0],a[2]),a[0].join("")+a[1].replace(i,"<br/>")+a[2].join("")):""}return function(a){return a.map(t).join("")}}(),vA=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,bA=/<(?:\w+:)?r>/,yA=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Jp(e,i){var n=i?i.cellHTML:!0,t={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(t.t=sn(wn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),t.r=wn(e),n&&(t.h=Rp(t.t))):e.match(bA)&&(t.r=wn(e),t.t=sn(wn((e.replace(yA,"").match(vA)||[]).join("").replace(br,""))),n&&(t.h=CA(xA(t.r)))),t):{t:""}}var MA=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,PA=/<(?:\w+:)?(?:si|sstItem)>/g,OA=/<\/(?:\w+:)?(?:si|sstItem)>/;function wA(e,i){var n=[],t="";if(!e)return n;var r=e.match(MA);if(r){t=r[2].replace(PA,"").split(OA);for(var a=0;a!=t.length;++a){var o=Jp(t[a].trim(),i);o!=null&&(n[n.length]=o)}r=kt(r[1]),n.Count=r.count,n.Unique=r.uniqueCount}return n}var SA=/^\s|\s$|[\t\n\r]/;function qb(e,i){if(!i.bookSST)return"";var n=[fi];n[n.length]=Ye("sst",null,{xmlns:$s[0],count:e.Count,uniqueCount:e.Unique});for(var t=0;t!=e.length;++t)if(e[t]!=null){var r=e[t],a="<si>";r.r?a+=r.r:(a+="<t",r.t||(r.t=""),r.t.match(SA)&&(a+=' xml:space="preserve"'),a+=">"+On(r.t)+"</t>"),a+="</si>",n[n.length]=a}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function kA(e){return[e.read_shift(4),e.read_shift(4)]}function TA(e,i){var n=[],t=!1;return Ao(e,function(a,o,l){switch(l){case 159:n.Count=a[0],n.Unique=a[1];break;case 19:n.push(a);break;case 160:return!0;case 35:t=!0;break;case 36:t=!1;break;default:if(o.T,!t||i.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function EA(e,i){return i||(i=Me(8)),i.write_shift(4,e.Count),i.write_shift(4,e.Unique),i}var IA=z6;function AA(e){var i=jr();Ae(i,159,EA(e));for(var n=0;n<e.length;++n)Ae(i,19,IA(e[n]));return Ae(i,160),i.end()}function Xb(e){if(typeof Cn<"u")return Cn.utils.encode(ll,e);for(var i=[],n=e.split(""),t=0;t<n.length;++t)i[t]=n[t].charCodeAt(0);return i}function To(e,i){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),i>=4&&(e.l+=i-4),n}function DA(e){var i={};return i.id=e.read_shift(0,"lpp4"),i.R=To(e,4),i.U=To(e,4),i.W=To(e,4),i}function FA(e){for(var i=e.read_shift(4),n=e.l+i-4,t={},r=e.read_shift(4),a=[];r-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(t.name=e.read_shift(0,"lpp4"),t.comps=a,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return t}function RA(e){var i=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)i.push(FA(e));return i}function BA(e){var i=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)i.push(e.read_shift(0,"lpp4"));return i}function NA(e){var i={};return e.read_shift(4),e.l+=4,i.id=e.read_shift(0,"lpp4"),i.name=e.read_shift(0,"lpp4"),i.R=To(e,4),i.U=To(e,4),i.W=To(e,4),i}function LA(e){var i=NA(e);if(i.ename=e.read_shift(0,"8lpp4"),i.blksz=e.read_shift(4),i.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return i}function Kb(e,i){var n=e.l+i,t={};t.Flags=e.read_shift(4)&63,e.l+=4,t.AlgID=e.read_shift(4);var r=!1;switch(t.AlgID){case 26126:case 26127:case 26128:r=t.Flags==36;break;case 26625:r=t.Flags==4;break;case 0:r=t.Flags==16||t.Flags==4||t.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+t.AlgID}if(!r)throw new Error("Encryption Flags/AlgID mismatch");return t.AlgIDHash=e.read_shift(4),t.KeySize=e.read_shift(4),t.ProviderType=e.read_shift(4),e.l+=8,t.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,t}function Zb(e,i){var n={},t=e.l+i;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,t),e.l=t,n}function VA(e){var i=To(e);switch(i.Minor){case 2:return[i.Minor,UA(e,i)];case 3:return[i.Minor,zA(e,i)];case 4:return[i.Minor,jA(e,i)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+i.Minor)}function UA(e){var i=e.read_shift(4);if((i&63)!=36)throw new Error("EncryptionInfo mismatch");var n=e.read_shift(4),t=Kb(e,n),r=Zb(e,e.length-e.l);return{t:"Std",h:t,v:r}}function zA(){throw new Error("File is password-protected: ECMA-376 Extensible")}function jA(e){var i=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),t={};return n.replace(br,function(a){var o=kt(a);switch(ro(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":i.forEach(function(l){t[l]=o[l]});break;case"<dataIntegrity":t.encryptedHmacKey=o.encryptedHmacKey,t.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":t.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":t.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":t.encs.push(o);break;default:throw o[0]}}),t}function $A(e,i){var n={},t=n.EncryptionVersionInfo=To(e,4);if(i-=4,t.Minor!=2)throw new Error("unrecognized minor version code: "+t.Minor);if(t.Major>4||t.Major<2)throw new Error("unrecognized major version code: "+t.Major);n.Flags=e.read_shift(4),i-=4;var r=e.read_shift(4);return i-=4,n.EncryptionHeader=Kb(e,r),i-=r,n.EncryptionVerifier=Zb(e,i),n}function YA(e){var i={},n=i.EncryptionVersionInfo=To(e,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return i.Salt=e.read_shift(16),i.EncryptedVerifier=e.read_shift(16),i.EncryptedVerifierHash=e.read_shift(16),i}function ef(e){var i=0,n,t=Xb(e),r=t.length+1,a,o,l,m,g;for(n=ss(r),n[0]=t.length,a=1;a!=r;++a)n[a]=t[a-1];for(a=r-1;a>=0;--a)o=n[a],l=i&16384?1:0,m=i<<1&32767,g=l|m,i=g^o;return i^52811}var Qb=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],i=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],t=function(o){return(o/2|o*128)&255},r=function(o,l){return t(o^l)},a=function(o){for(var l=i[o.length-1],m=104,g=o.length-1;g>=0;--g)for(var f=o[g],h=0;h!=7;++h)f&64&&(l^=n[m]),f*=2,--m;return l};return function(o){for(var l=Xb(o),m=a(l),g=l.length,f=ss(16),h=0;h!=16;++h)f[h]=0;var x,C,y;for((g&1)===1&&(x=m>>8,f[g]=r(e[0],x),--g,x=m&255,C=l[l.length-1],f[g]=r(C,x));g>0;)--g,x=m>>8,f[g]=r(l[g],x),--g,x=m&255,f[g]=r(l[g],x);for(g=15,y=15-l.length;y>0;)x=m>>8,f[g]=r(e[y],x),--g,--y,x=m&255,f[g]=r(l[g],x),--g,--y;return f}}(),WA=function(e,i,n,t,r){r||(r=i),t||(t=Qb(e));var a,o;for(a=0;a!=i.length;++a)o=i[a],o^=t[n],o=(o>>5|o<<3)&255,r[a]=o,++n;return[r,n,t]},GA=function(e){var i=0,n=Qb(e);return function(t){var r=WA("",t,i,n);return i=r[1],r[0]}};function HA(e,i,n,t){var r={key:Ti(e),verificationBytes:Ti(e)};return n.password&&(r.verifier=ef(n.password)),t.valid=r.verificationBytes===r.verifier,t.valid&&(t.insitu=GA(n.password)),r}function qA(e,i,n){var t=n||{};return t.Info=e.read_shift(2),e.l-=2,t.Info===1?t.Data=YA(e,i):t.Data=$A(e,i),t}function XA(e,i,n){var t={Type:n.biff>=8?e.read_shift(2):0};return t.Type?qA(e,i-2,t):HA(e,n.biff>=8?i:i-2,n,t),t}var Jb=function(){function e(r,a){switch(a.type){case"base64":return i(ea(r),a);case"binary":return i(r,a);case"buffer":return i(Zt&&Buffer.isBuffer(r)?r.toString("binary"):ms(r),a);case"array":return i(Ls(r),a)}throw new Error("Unrecognized type "+a.type)}function i(r,a){var o=a||{},l=o.dense?[]:{},m=r.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(f,h){Array.isArray(l)&&(l[h]=[]);for(var x=/\\\w+\b/g,C=0,y,b=-1;y=x.exec(f);){switch(y[0]){case"\\cell":var w=f.slice(C,x.lastIndex-y[0].length);if(w[0]==" "&&(w=w.slice(1)),++b,w.length){var A={v:w,t:"s"};Array.isArray(l)?l[h][b]=A:l[Pt({r:h,c:b})]=A}break}C=x.lastIndex}b>g.e.c&&(g.e.c=b)}),l["!ref"]=zt(g),l}function n(r,a){return gs(e(r,a),a)}function t(r){for(var a=["{\\rtf1\\ansi"],o=cn(r["!ref"]),l,m=Array.isArray(r),g=o.s.r;g<=o.e.r;++g){a.push("\\trowd\\trautofit1");for(var f=o.s.c;f<=o.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=o.s.c;f<=o.e.c;++f){var h=Pt({r:g,c:f});l=m?(r[g]||[])[f]:r[h],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(Eo(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:t}}();function KA(e){var i=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(i.slice(0,2),16),parseInt(i.slice(2,4),16),parseInt(i.slice(4,6),16)]}function _d(e){for(var i=0,n=1;i!=3;++i)n=n*256+(e[i]>255?255:e[i]<0?0:e[i]);return n.toString(16).toUpperCase().slice(1)}function ZA(e){var i=e[0]/255,n=e[1]/255,t=e[2]/255,r=Math.max(i,n,t),a=Math.min(i,n,t),o=r-a;if(o===0)return[0,0,i];var l=0,m=0,g=r+a;switch(m=o/(g>1?2-g:g),r){case i:l=((n-t)/o+6)%6;break;case n:l=(t-i)/o+2;break;case t:l=(i-n)/o+4;break}return[l/6,m,g/2]}function QA(e){var i=e[0],n=e[1],t=e[2],r=n*2*(t<.5?t:1-t),a=t-r/2,o=[a,a,a],l=6*i,m;if(n!==0)switch(l|0){case 0:case 6:m=r*l,o[0]+=r,o[1]+=m;break;case 1:m=r*(2-l),o[0]+=m,o[1]+=r;break;case 2:m=r*(l-2),o[1]+=r,o[2]+=m;break;case 3:m=r*(4-l),o[1]+=m,o[2]+=r;break;case 4:m=r*(l-4),o[2]+=r,o[0]+=m;break;case 5:m=r*(6-l),o[2]+=m,o[0]+=r;break}for(var g=0;g!=3;++g)o[g]=Math.round(o[g]*255);return o}function wg(e,i){if(i===0)return e;var n=ZA(KA(e));return i<0?n[2]=n[2]*(1+i):n[2]=1-(1-n[2])*(1-i),_d(QA(n))}var ey=6,JA=15,eD=1,hr=ey;function xd(e){return Math.floor((e+Math.round(128/hr)/256)*hr)}function Cd(e){return Math.floor((e-5)/hr*100+.5)/100}function Sg(e){return Math.round((e*hr+5)/hr*256)/256}function rp(e){return Sg(Cd(xd(e)))}function tf(e){var i=Math.abs(e-rp(e)),n=hr;if(i>.005)for(hr=eD;hr<JA;++hr)Math.abs(e-rp(e))<=i&&(i=Math.abs(e-rp(e)),n=hr);hr=n}function cs(e){e.width?(e.wpx=xd(e.width),e.wch=Cd(e.wpx),e.MDW=hr):e.wpx?(e.wch=Cd(e.wpx),e.width=Sg(e.wch),e.MDW=hr):typeof e.wch=="number"&&(e.width=Sg(e.wch),e.wpx=xd(e.width),e.MDW=hr),e.customWidth&&delete e.customWidth}var tD=96,ty=tD;function vd(e){return e*96/ty}function gl(e){return e*ty/96}var nD={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function iD(e,i,n,t){i.Borders=[];var r={},a=!1;(e[0].match(br)||[]).forEach(function(o){var l=kt(o);switch(ro(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":r={},l.diagonalUp&&(r.diagonalUp=Nn(l.diagonalUp)),l.diagonalDown&&(r.diagonalDown=Nn(l.diagonalDown)),i.Borders.push(r);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function rD(e,i,n,t){i.Fills=[];var r={},a=!1;(e[0].match(br)||[]).forEach(function(o){var l=kt(o);switch(ro(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":r={},i.Fills.push(r);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":i.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":l.patternType&&(r.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":r.bgColor||(r.bgColor={}),l.indexed&&(r.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(r.bgColor.theme=parseInt(l.theme,10)),l.tint&&(r.bgColor.tint=parseFloat(l.tint)),l.rgb&&(r.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":r.fgColor||(r.fgColor={}),l.theme&&(r.fgColor.theme=parseInt(l.theme,10)),l.tint&&(r.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(r.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function aD(e,i,n,t){i.Fonts=[];var r={},a=!1;(e[0].match(br)||[]).forEach(function(o){var l=kt(o);switch(ro(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":i.Fonts.push(r),r={};break;case"<name":l.val&&(r.name=wn(l.val));break;case"<name/>":case"</name>":break;case"<b":r.bold=l.val?Nn(l.val):1;break;case"<b/>":r.bold=1;break;case"<i":r.italic=l.val?Nn(l.val):1;break;case"<i/>":r.italic=1;break;case"<u":switch(l.val){case"none":r.underline=0;break;case"single":r.underline=1;break;case"double":r.underline=2;break;case"singleAccounting":r.underline=33;break;case"doubleAccounting":r.underline=34;break}break;case"<u/>":r.underline=1;break;case"<strike":r.strike=l.val?Nn(l.val):1;break;case"<strike/>":r.strike=1;break;case"<outline":r.outline=l.val?Nn(l.val):1;break;case"<outline/>":r.outline=1;break;case"<shadow":r.shadow=l.val?Nn(l.val):1;break;case"<shadow/>":r.shadow=1;break;case"<condense":r.condense=l.val?Nn(l.val):1;break;case"<condense/>":r.condense=1;break;case"<extend":r.extend=l.val?Nn(l.val):1;break;case"<extend/>":r.extend=1;break;case"<sz":l.val&&(r.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(r.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(r.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(r.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Op[parseInt(l.val,10)];break;case"<color":if(r.color||(r.color={}),l.auto&&(r.color.auto=Nn(l.auto)),l.rgb)r.color.rgb=l.rgb.slice(-6);else if(l.indexed){r.color.index=parseInt(l.indexed,10);var m=Ds[r.color.index];r.color.index==81&&(m=Ds[1]),m||(m=Ds[1]),r.color.rgb=m[0].toString(16)+m[1].toString(16)+m[2].toString(16)}else l.theme&&(r.color.theme=parseInt(l.theme,10),l.tint&&(r.color.tint=parseFloat(l.tint)),l.theme&&n.themeElements&&n.themeElements.clrScheme&&(r.color.rgb=wg(n.themeElements.clrScheme[r.color.theme].rgb,r.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function oD(e,i,n){i.NumberFmt=[];for(var t=ci(Mt),r=0;r<t.length;++r)i.NumberFmt[t[r]]=Mt[t[r]];var a=e[0].match(br);if(a)for(r=0;r<a.length;++r){var o=kt(a[r]);switch(ro(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=sn(wn(o.formatCode)),m=parseInt(o.numFmtId,10);if(i.NumberFmt[m]=l,m>0){if(m>392){for(m=392;m>60&&i.NumberFmt[m]!=null;--m);i.NumberFmt[m]=l}ko(l,m)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function sD(e){var i=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var t=n[0];t<=n[1];++t)e[t]!=null&&(i[i.length]=Ye("numFmt",null,{numFmtId:t,formatCode:On(e[t])}))}),i.length===1?"":(i[i.length]="</numFmts>",i[0]=Ye("numFmts",null,{count:i.length-2}).replace("/>",">"),i.join(""))}var ug=["numFmtId","fillId","fontId","borderId","xfId"],pg=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function cD(e,i,n){i.CellXf=[];var t,r=!1;(e[0].match(br)||[]).forEach(function(a){var o=kt(a),l=0;switch(ro(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(t=o,delete t[0],l=0;l<ug.length;++l)t[ug[l]]&&(t[ug[l]]=parseInt(t[ug[l]],10));for(l=0;l<pg.length;++l)t[pg[l]]&&(t[pg[l]]=Nn(t[pg[l]]));if(i.NumberFmt&&t.numFmtId>392){for(l=392;l>60;--l)if(i.NumberFmt[t.numFmtId]==i.NumberFmt[l]){t.numFmtId=l;break}}i.CellXf.push(t);break;case"</xf>":break;case"<alignment":case"<alignment/>":var m={};o.vertical&&(m.vertical=o.vertical),o.horizontal&&(m.horizontal=o.horizontal),o.textRotation!=null&&(m.textRotation=o.textRotation),o.indent&&(m.indent=o.indent),o.wrapText&&(m.wrapText=Nn(o.wrapText)),t.alignment=m;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":r=!0;break;case"</AlternateContent>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(n&&n.WTF&&!r)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function lD(e){var i=[];return i[i.length]=Ye("cellXfs",null),e.forEach(function(n){i[i.length]=Ye("xf",null,n)}),i[i.length]="</cellXfs>",i.length===2?"":(i[0]=Ye("cellXfs",null,{count:i.length-2}).replace("/>",">"),i.join(""))}var dD=function(){var i=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,t=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,m,g){var f={};if(!l)return f;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=l.match(i))&&oD(h,f,g),(h=l.match(r))&&aD(h,f,m,g),(h=l.match(t))&&rD(h,f,m,g),(h=l.match(a))&&iD(h,f,m,g),(h=l.match(n))&&cD(h,f,g),f}}();function ny(e,i){var n=[fi,Ye("styleSheet",null,{xmlns:$s[0],"xmlns:vt":Ai.vt})],t;return e.SSF&&(t=sD(e.SSF))!=null&&(n[n.length]=t),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(t=lD(i.cellXfs))&&(n[n.length]=t),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function mD(e,i){var n=e.read_shift(2),t=Cr(e,i-2);return[n,t]}function gD(e,i,n){n||(n=Me(6+4*i.length)),n.write_shift(2,e),Hi(i,n);var t=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),t}function uD(e,i,n){var t={};t.sz=e.read_shift(2)/20;var r=q6(e,2,n);r.fItalic&&(t.italic=1),r.fCondense&&(t.condense=1),r.fExtend&&(t.extend=1),r.fShadow&&(t.shadow=1),r.fOutline&&(t.outline=1),r.fStrikeout&&(t.strike=1);var a=e.read_shift(2);switch(a===700&&(t.bold=1),e.read_shift(2)){case 1:t.vertAlign="superscript";break;case 2:t.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(t.underline=o);var l=e.read_shift(1);l>0&&(t.family=l);var m=e.read_shift(1);switch(m>0&&(t.charset=m),e.l++,t.color=H6(e,8),e.read_shift(1)){case 1:t.scheme="major";break;case 2:t.scheme="minor";break}return t.name=Cr(e,i-21),t}function pD(e,i){i||(i=Me(25+4*32)),i.write_shift(2,e.sz*20),X6(e,i),i.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),i.write_shift(2,n),i.write_shift(1,e.underline||0),i.write_shift(1,e.family||0),i.write_shift(1,e.charset||0),i.write_shift(1,0),Mg(e.color,i);var t=0;return e.scheme=="major"&&(t=1),e.scheme=="minor"&&(t=2),i.write_shift(1,t),Hi(e.name,i),i.length>i.l?i.slice(0,i.l):i}var fD=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ap,hD=vr;function vv(e,i){i||(i=Me(4*3+8*7+16*1)),ap||(ap=Ag(fD));var n=ap[e.patternType];n==null&&(n=40),i.write_shift(4,n);var t=0;if(n!=40)for(Mg({auto:1},i),Mg({auto:1},i);t<12;++t)i.write_shift(4,0);else{for(;t<4;++t)i.write_shift(4,0);for(;t<12;++t)i.write_shift(4,0)}return i.length>i.l?i.slice(0,i.l):i}function _D(e,i){var n=e.l+i,t=e.read_shift(2),r=e.read_shift(2);return e.l=n,{ixfe:t,numFmtId:r}}function iy(e,i,n){n||(n=Me(16)),n.write_shift(2,i||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var t=0;return n.write_shift(1,t),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Ql(e,i){return i||(i=Me(10)),i.write_shift(1,0),i.write_shift(1,0),i.write_shift(4,0),i.write_shift(4,0),i}var xD=vr;function CD(e,i){return i||(i=Me(51)),i.write_shift(1,0),Ql(null,i),Ql(null,i),Ql(null,i),Ql(null,i),Ql(null,i),i.length>i.l?i.slice(0,i.l):i}function vD(e,i){return i||(i=Me(12+4*10)),i.write_shift(4,e.xfId),i.write_shift(2,1),i.write_shift(1,+e.builtinId),i.write_shift(1,0),yg(e.name||"",i),i.length>i.l?i.slice(0,i.l):i}function bD(e,i,n){var t=Me(2052);return t.write_shift(4,e),yg(i,t),yg(n,t),t.length>t.l?t.slice(0,t.l):t}function yD(e,i,n){var t={};t.NumberFmt=[];for(var r in Mt)t.NumberFmt[r]=Mt[r];t.CellXf=[],t.Fonts=[];var a=[],o=!1;return Ao(e,function(m,g,f){switch(f){case 44:t.NumberFmt[m[0]]=m[1],ko(m[1],m[0]);break;case 43:t.Fonts.push(m),m.color.theme!=null&&i&&i.themeElements&&i.themeElements.clrScheme&&(m.color.rgb=wg(i.themeElements.clrScheme[m.color.theme].rgb,m.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&t.CellXf.push(m);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(f),o=!0;break;case 38:a.pop(),o=!1;break;default:if(g.T>0)a.push(f);else if(g.T<0)a.pop();else if(!o||n.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),t}function MD(e,i){if(i){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)i[r]!=null&&++n}),n!=0&&(Ae(e,615,Ra(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)i[r]!=null&&Ae(e,44,gD(r,i[r]))}),Ae(e,616))}}function PD(e){var i=1;i!=0&&(Ae(e,611,Ra(i)),Ae(e,43,pD({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Ae(e,612))}function OD(e){var i=2;i!=0&&(Ae(e,603,Ra(i)),Ae(e,45,vv({patternType:"none"})),Ae(e,45,vv({patternType:"gray125"})),Ae(e,604))}function wD(e){var i=1;i!=0&&(Ae(e,613,Ra(i)),Ae(e,46,CD({})),Ae(e,614))}function SD(e){var i=1;Ae(e,626,Ra(i)),Ae(e,47,iy({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Ae(e,627)}function kD(e,i){Ae(e,617,Ra(i.length)),i.forEach(function(n){Ae(e,47,iy(n,0))}),Ae(e,618)}function TD(e){var i=1;Ae(e,619,Ra(i)),Ae(e,48,vD({xfId:0,builtinId:0,name:"Normal"})),Ae(e,620)}function ED(e){var i=0;Ae(e,505,Ra(i)),Ae(e,506)}function ID(e){var i=0;Ae(e,508,bD(i,"TableStyleMedium9","PivotStyleMedium4")),Ae(e,509)}function AD(e,i){var n=jr();return Ae(n,278),MD(n,e.SSF),PD(n,e),OD(n,e),wD(n,e),SD(n,e),kD(n,i.cellXfs),TD(n,e),ED(n,e),ID(n,e),Ae(n,279),n.end()}var DD=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function FD(e,i,n){i.themeElements.clrScheme=[];var t={};(e[0].match(br)||[]).forEach(function(r){var a=kt(r);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":t.rgb=a.val;break;case"<a:sysClr":t.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(i.themeElements.clrScheme[DD.indexOf(a[0])]=t,t={}):t.name=a[0].slice(3,a[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function RD(){}function BD(){}var ND=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,LD=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,VD=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function UD(e,i,n){i.themeElements={};var t;[["clrScheme",ND,FD],["fontScheme",LD,RD],["fmtScheme",VD,BD]].forEach(function(r){if(!(t=e.match(r[1])))throw new Error(r[0]+" not found in themeElements");r[2](t,i,n)})}var zD=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ry(e,i){(!e||e.length===0)&&(e=nf());var n,t={};if(!(n=e.match(zD)))throw new Error("themeElements not found in theme");return UD(n[0],t,i),t.raw=e,t}function nf(e,i){if(i&&i.themeXLSX)return i.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[fi];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',n[n.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',n[n.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',n[n.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',n[n.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',n[n.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',n[n.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function jD(e,i,n){var t=e.l+i,r=e.read_shift(4);if(r!==124226){if(!n.cellStyles){e.l=t;return}var a=e.slice(e.l);e.l=t;var o;try{o=tb(a,{type:"array"})}catch{return}var l=Jr(o,"theme/theme/theme1.xml",!0);if(l)return ry(l,n)}}function $D(e){return e.read_shift(4)}function YD(e){var i={};switch(i.xclrType=e.read_shift(2),i.nTintShade=e.read_shift(2),i.xclrType){case 0:e.l+=4;break;case 1:i.xclrValue=WD(e,4);break;case 2:i.xclrValue=Nb(e,4);break;case 3:i.xclrValue=$D(e,4);break;case 4:e.l+=4;break}return e.l+=8,i}function WD(e,i){return vr(e,i)}function GD(e,i){return vr(e,i)}function HD(e){var i=e.read_shift(2),n=e.read_shift(2)-4,t=[i];switch(i){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:t[1]=YD(e,n);break;case 6:t[1]=GD(e,n);break;case 14:case 15:t[1]=e.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+i+" "+n)}return t}function qD(e,i){var n=e.l+i;e.l+=2;var t=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),a=[];r-- >0;)a.push(HD(e,n-e.l));return{ixfe:t,ext:a}}function XD(e,i){i.forEach(function(n){switch(n[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function KD(e,i){return{flags:e.read_shift(4),version:e.read_shift(4),name:Cr(e,i-8)}}function ZD(e){var i=Me(12+2*e.name.length);return i.write_shift(4,e.flags),i.write_shift(4,e.version),Hi(e.name,i),i.slice(0,i.l)}function QD(e){for(var i=[],n=e.read_shift(4);n-- >0;)i.push([e.read_shift(4),e.read_shift(4)]);return i}function JD(e){var i=Me(4+8*e.length);i.write_shift(4,e.length);for(var n=0;n<e.length;++n)i.write_shift(4,e[n][0]),i.write_shift(4,e[n][1]);return i}function eF(e,i){var n=Me(8+2*i.length);return n.write_shift(4,e),Hi(i,n),n.slice(0,n.l)}function tF(e){return e.l+=4,e.read_shift(4)!=0}function nF(e,i){var n=Me(8);return n.write_shift(4,e),n.write_shift(4,i?1:0),n}function iF(e,i,n){var t={Types:[],Cell:[],Value:[]},r=n||{},a=[],o=!1,l=2;return Ao(e,function(m,g,f){switch(f){case 335:t.Types.push({name:m.name});break;case 51:m.forEach(function(h){l==1?t.Cell.push({type:t.Types[h[0]-1].name,index:h[1]}):l==0&&t.Value.push({type:t.Types[h[0]-1].name,index:h[1]})});break;case 337:l=m?1:0;break;case 338:l=2;break;case 35:a.push(f),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!g.T){if(!o||r.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),t}function rF(){var e=jr();return Ae(e,332),Ae(e,334,Ra(1)),Ae(e,335,ZD({name:"XLDAPR",version:12e4,flags:3496657072})),Ae(e,336),Ae(e,339,eF(1,"XLDAPR")),Ae(e,52),Ae(e,35,Ra(514)),Ae(e,4096,Ra(0)),Ae(e,4097,xa(1)),Ae(e,36),Ae(e,53),Ae(e,340),Ae(e,337,nF(1,!0)),Ae(e,51,JD([[1,0]])),Ae(e,338),Ae(e,333),e.end()}function aF(e,i,n){var t={Types:[],Cell:[],Value:[]};if(!e)return t;var r=!1,a=2,o;return e.replace(br,function(l){var m=kt(l);switch(ro(m[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":t.Types.push({name:m.name});break;case"</metadataType>":break;case"<futureMetadata":for(var g=0;g<t.Types.length;++g)t.Types[g].name==m.name&&(o=t.Types[g]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?t.Cell.push({type:t.Types[m.t-1].name,index:+m.v}):a==0&&t.Value.push({type:t.Types[m.t-1].name,index:+m.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+m.i);break;default:if(!r&&n.WTF)throw new Error("unrecognized "+m[0]+" in metadata")}return l}),t}function ay(){var e=[fi];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function oF(e){var i=[];if(!e)return i;var n=1;return(e.match(br)||[]).forEach(function(t){var r=kt(t);switch(r[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?n=r.i:r.i=n,i.push(r);break}}),i}function sF(e){var i={};i.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),i.r=Pt(n);var t=e.read_shift(1);return t&2&&(i.l="1"),t&8&&(i.a="1"),i}function cF(e,i,n){var t=[],r=!1;return Ao(e,function(o,l,m){switch(m){case 63:t.push(o);break;default:if(!l.T){if(!r||n.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),t}function lF(e,i,n,t){if(!e)return e;var r=t||{},a=!1,o=!1;Ao(e,function(m,g,f){if(!o)switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!g.T){if(!a||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},r)}function dF(e,i){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return i["!id"][n].Target}var rl=1024;function oy(e,i){for(var n=[21600,21600],t=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),r=[Ye("xml",null,{"xmlns:v":Zr.v,"xmlns:o":Zr.o,"xmlns:x":Zr.x,"xmlns:mv":Zr.mv}).replace(/\/>/,">"),Ye("o:shapelayout",Ye("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ye("v:shapetype",[Ye("v:stroke",null,{joinstyle:"miter"}),Ye("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:t})];rl<e*1e3;)rl+=1e3;return i.forEach(function(a){var o=Kn(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var m=l.type=="gradient"?Ye("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,g=Ye("v:fill",m,l),f={on:"t",obscured:"t"};++rl,r=r.concat(["<v:shape"+pd({id:"_x0000_s"+rl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",g,Ye("v:shadow",null,f),Ye("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qi("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Qi("x:AutoFill","False"),Qi("x:Row",String(o.r)),Qi("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function bv(e,i,n,t){var r=Array.isArray(e),a;i.forEach(function(o){var l=Kn(o.ref);if(r?(e[l.r]||(e[l.r]=[]),a=e[l.r][l.c]):a=e[o.ref],!a){a={t:"z"},r?e[l.r][l.c]=a:e[o.ref]=a;var m=cn(e["!ref"]||"BDWGO1000001:A1");m.s.r>l.r&&(m.s.r=l.r),m.e.r<l.r&&(m.e.r=l.r),m.s.c>l.c&&(m.s.c=l.c),m.e.c<l.c&&(m.e.c=l.c);var g=zt(m);g!==e["!ref"]&&(e["!ref"]=g)}a.c||(a.c=[]);var f={a:o.author,t:o.t,r:o.r,T:n};o.h&&(f.h=o.h);for(var h=a.c.length-1;h>=0;--h){if(!n&&a.c[h].T)return;n&&!a.c[h].T&&a.c.splice(h,1)}if(n&&t){for(h=0;h<t.length;++h)if(f.a==t[h].id){f.a=t[h].name||f.a;break}}a.c.push(f)})}function mF(e,i){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],t=[],r=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);r&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&n.push(l[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var m=kt(l[0]),g={author:m.authorId&&n[m.authorId]||"sheetjsghost",ref:m.ref,guid:m.guid},f=Kn(m.ref);if(!(i.sheetRows&&i.sheetRows<=f.r)){var h=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!h&&!!h[1]&&Jp(h[1])||{r:"",t:"",h:""};g.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),g.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),i.cellHTML&&(g.h=x.h),t.push(g)}}}}),t}function sy(e){var i=[fi,Ye("comments",null,{xmlns:$s[0]})],n=[];return i.push("<authors>"),e.forEach(function(t){t[1].forEach(function(r){var a=On(r.a);n.indexOf(a)==-1&&(n.push(a),i.push("<author>"+a+"</author>")),r.T&&r.ID&&n.indexOf("tc="+r.ID)==-1&&(n.push("tc="+r.ID),i.push("<author>tc="+r.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),i.push("<author>SheetJ5</author>")),i.push("</authors>"),i.push("<commentList>"),e.forEach(function(t){var r=0,a=[];if(t[1][0]&&t[1][0].T&&t[1][0].ID?r=n.indexOf("tc="+t[1][0].ID):t[1].forEach(function(m){m.a&&(r=n.indexOf(On(m.a))),a.push(m.t||"")}),i.push('<comment ref="'+t[0]+'" authorId="'+r+'"><text>'),a.length<=1)i.push(Qi("t",On(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;i.push(Qi("t",On(o)))}i.push("</text></comment>")}),i.push("</commentList>"),i.length>2&&(i[i.length]="</comments>",i[1]=i[1].replace("/>",">")),i.join("")}function gF(e,i){var n=[],t=!1,r={},a=0;return e.replace(br,function(l,m){var g=kt(l);switch(ro(g[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":r={author:g.personId,guid:g.id,ref:g.ref,T:1};break;case"</threadedComment>":r.t!=null&&n.push(r);break;case"<text>":case"<text":a=m+l.length;break;case"</text>":r.t=e.slice(a,m).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":t=!0;break;case"</mentions>":t=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":t=!0;break;case"</ext>":t=!1;break;default:if(!t&&i.WTF)throw new Error("unrecognized "+g[0]+" in threaded comments")}return l}),n}function uF(e,i,n){var t=[fi,Ye("ThreadedComments",null,{xmlns:Ai.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(r){var a="";(r[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&i.indexOf(o.a)==-1&&i.push(o.a);var m={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};l==0?a=m.id:m.parentId=a,o.ID=m.id,o.a&&(m.personId="{54EE7950-7262-4200-6969-"+("000000000000"+i.indexOf(o.a)).slice(-12)+"}"),t.push(Ye("threadedComment",Qi("text",o.t||""),m))})}),t.push("</ThreadedComments>"),t.join("")}function pF(e,i){var n=[],t=!1;return e.replace(br,function(a){var o=kt(a);switch(ro(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":t=!0;break;case"</ext>":t=!1;break;default:if(!t&&i.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),n}function fF(e){var i=[fi,Ye("personList",null,{xmlns:Ai.TCMNT,"xmlns:x":$s[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,t){i.push(Ye("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+t).slice(-12)+"}",userId:n,providerId:"None"}))}),i.push("</personList>"),i.join("")}function hF(e){var i={};i.iauthor=e.read_shift(4);var n=Hs(e,16);return i.rfx=n.s,i.ref=Pt(n.s),e.l+=16,i}function _F(e,i){return i==null&&(i=Me(36)),i.write_shift(4,e[1].iauthor),_l(e[0],i),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i}var xF=Cr;function CF(e){return Hi(e.slice(0,54))}function vF(e,i){var n=[],t=[],r={},a=!1;return Ao(e,function(l,m,g){switch(g){case 632:t.push(l);break;case 635:r=l;break;case 637:r.t=l.t,r.h=l.h,r.r=l.r;break;case 636:if(r.author=t[r.iauthor],delete r.iauthor,i.sheetRows&&r.rfx&&i.sheetRows<=r.rfx.r)break;r.t||(r.t=""),delete r.rfx,n.push(r);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!m.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}),n}function bF(e){var i=jr(),n=[];return Ae(i,628),Ae(i,630),e.forEach(function(t){t[1].forEach(function(r){n.indexOf(r.a)>-1||(n.push(r.a.slice(0,54)),Ae(i,632,CF(r.a)))})}),Ae(i,631),Ae(i,633),e.forEach(function(t){t[1].forEach(function(r){r.iauthor=n.indexOf(r.a);var a={s:Kn(t[0]),e:Kn(t[0])};Ae(i,635,_F([a,r])),r.t&&r.t.length>0&&Ae(i,637,$6(r)),Ae(i,636),delete r.iauthor})}),Ae(i,634),Ae(i,629),i.end()}var yF="application/vnd.ms-office.vbaProject";function MF(e){var i=_t.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,t){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var r=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");_t.utils.cfb_add(i,r,e.FileIndex[t].content)}}),_t.write(i)}function PF(e,i){i.FullPaths.forEach(function(n,t){if(t!=0){var r=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&_t.utils.cfb_add(e,r,i.FileIndex[t].content)}})}var cy=["xlsb","xlsm","xlam","biff8","xla"];function OF(){return{"!type":"dialog"}}function wF(){return{"!type":"dialog"}}function SF(){return{"!type":"macro"}}function kF(){return{"!type":"macro"}}var sl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,i={r:0,c:0};function n(t,r,a,o){var l=!1,m=!1;a.length==0?m=!0:a.charAt(0)=="["&&(m=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var g=a.length>0?parseInt(a,10)|0:0,f=o.length>0?parseInt(o,10)|0:0;return l?f+=i.c:--f,m?g+=i.r:--g,r+(l?"":"$")+Xn(f)+(m?"":"$")+pi(g)}return function(r,a){return i=a,r.replace(e,n)}}(),rf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,af=function(){return function(i,n){return i.replace(rf,function(t,r,a,o,l,m){var g=Yp(o)-(a?0:n.c),f=$p(m)-(l?0:n.r),h=f==0?"":l?f+1:"["+f+"]",x=g==0?"":a?g+1:"["+g+"]";return r+"R"+h+"C"+x})}}();function ly(e,i){return e.replace(rf,function(n,t,r,a,o,l){return t+(r=="$"?r+a:Xn(Yp(a)+i.c))+(o=="$"?o+l:pi($p(l)+i.r))})}function TF(e,i,n){var t=$r(i),r=t.s,a=Kn(n),o={r:a.r-r.r,c:a.c-r.c};return ly(e,o)}function EF(e){return e.length!=1}function yv(e){return e.replace(/_xlfn\./g,"")}function Si(e){e.l+=1}function ls(e,i){var n=e.read_shift(i==1?1:2);return[n&16383,n>>14&1,n>>15&1]}function dy(e,i,n){var t=2;if(n){if(n.biff>=2&&n.biff<=5)return my(e,i,n);n.biff==12&&(t=4)}var r=e.read_shift(t),a=e.read_shift(t),o=ls(e,2),l=ls(e,2);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function my(e){var i=ls(e,2),n=ls(e,2),t=e.read_shift(1),r=e.read_shift(1);return{s:{r:i[0],c:t,cRel:i[1],rRel:i[2]},e:{r:n[0],c:r,cRel:n[1],rRel:n[2]}}}function IF(e,i,n){if(n.biff<8)return my(e,i,n);var t=e.read_shift(n.biff==12?4:2),r=e.read_shift(n.biff==12?4:2),a=ls(e,2),o=ls(e,2);return{s:{r:t,c:a[0],cRel:a[1],rRel:a[2]},e:{r,c:o[0],cRel:o[1],rRel:o[2]}}}function gy(e,i,n){if(n&&n.biff>=2&&n.biff<=5)return AF(e,i,n);var t=e.read_shift(n&&n.biff==12?4:2),r=ls(e,2);return{r:t,c:r[0],cRel:r[1],rRel:r[2]}}function AF(e){var i=ls(e,2),n=e.read_shift(1);return{r:i[0],c:n,cRel:i[1],rRel:i[2]}}function DF(e){var i=e.read_shift(2),n=e.read_shift(2);return{r:i,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function FF(e,i,n){var t=n&&n.biff?n.biff:8;if(t>=2&&t<=5)return RF(e,i,n);var r=e.read_shift(t>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;r>524287;)r-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r,c:a,cRel:o,rRel:l}}function RF(e){var i=e.read_shift(2),n=e.read_shift(1),t=(i&32768)>>15,r=(i&16384)>>14;return i&=16383,t==1&&i>=8192&&(i=i-16384),r==1&&n>=128&&(n=n-256),{r:i,c:n,cRel:r,rRel:t}}function BF(e,i,n){var t=(e[e.l++]&96)>>5,r=dy(e,n.biff>=2&&n.biff<=5?6:8,n);return[t,r]}function NF(e,i,n){var t=(e[e.l++]&96)>>5,r=e.read_shift(2,"i"),a=8;if(n)switch(n.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=dy(e,a,n);return[t,r,o]}function LF(e,i,n){var t=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[t]}function VF(e,i,n){var t=(e[e.l++]&96)>>5,r=e.read_shift(2),a=8;if(n)switch(n.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[t,r]}function UF(e,i,n){var t=(e[e.l++]&96)>>5,r=IF(e,i-1,n);return[t,r]}function zF(e,i,n){var t=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[t]}function Mv(e){var i=e[e.l+1]&1,n=1;return e.l+=4,[i,n]}function jF(e,i,n){e.l+=2;for(var t=e.read_shift(n&&n.biff==2?1:2),r=[],a=0;a<=t;++a)r.push(e.read_shift(n&&n.biff==2?1:2));return r}function $F(e,i,n){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(n&&n.biff==2?1:2)]}function YF(e,i,n){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(n&&n.biff==2?1:2)]}function WF(e){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(2)]}function GF(e,i,n){var t=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[t]}function uy(e){var i=e.read_shift(1),n=e.read_shift(1);return[i,n]}function HF(e){return e.read_shift(2),uy(e,2)}function qF(e){return e.read_shift(2),uy(e,2)}function XF(e,i,n){var t=(e[e.l]&96)>>5;e.l+=1;var r=gy(e,0,n);return[t,r]}function KF(e,i,n){var t=(e[e.l]&96)>>5;e.l+=1;var r=FF(e,0,n);return[t,r]}function ZF(e,i,n){var t=(e[e.l]&96)>>5;e.l+=1;var r=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var a=gy(e,0,n);return[t,r,a]}function QF(e,i,n){var t=(e[e.l]&96)>>5;e.l+=1;var r=e.read_shift(n&&n.biff<=3?1:2);return[t9[r],hy[r],t]}function JF(e,i,n){var t=e[e.l++],r=e.read_shift(1),a=n&&n.biff<=3?[t==88?-1:0,e.read_shift(1)]:e7(e);return[r,(a[0]===0?hy:e9)[a[1]]]}function e7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function t7(e,i,n){e.l+=n&&n.biff==2?3:4}function n7(e,i,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var t=e.read_shift(2),r=e.read_shift(n&&n.biff==2?1:2);return[t,r]}function i7(e){return e.l++,Do[e.read_shift(1)]}function r7(e){return e.l++,e.read_shift(2)}function a7(e){return e.l++,e.read_shift(1)!==0}function o7(e){return e.l++,_r(e,8)}function s7(e,i,n){return e.l++,Od(e,i-1,n)}function c7(e,i){var n=[e.read_shift(1)];if(i==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=ui(e,1)?"TRUE":"FALSE",i!=12&&(e.l+=7);break;case 37:case 16:n[1]=Do[e[e.l]],e.l+=i==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=_r(e,8);break;case 2:n[1]=qs(e,0,{biff:i>0&&i<8?2:i});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function l7(e,i,n){for(var t=e.read_shift(n.biff==12?4:2),r=[],a=0;a!=t;++a)r.push((n.biff==12?Hs:Bg)(e,8));return r}function d7(e,i,n){var t=0,r=0;n.biff==12?(t=e.read_shift(4),r=e.read_shift(4)):(r=1+e.read_shift(1),t=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--t,--r==0&&(r=256));for(var a=0,o=[];a!=t&&(o[a]=[]);++a)for(var l=0;l!=r;++l)o[a][l]=c7(e,n.biff);return o}function m7(e,i,n){var t=e.read_shift(1)>>>5&3,r=!n||n.biff>=8?4:2,a=e.read_shift(r);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[t,0,a]}function g7(e,i,n){if(n.biff==5)return u7(e,i,n);var t=e.read_shift(1)>>>5&3,r=e.read_shift(2),a=e.read_shift(4);return[t,r,a]}function u7(e){var i=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var t=e.read_shift(2);return e.l+=12,[i,n,t]}function p7(e,i,n){var t=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var r=e.read_shift(n&&n.biff==2?1:2);return[t,r]}function f7(e,i,n){var t=e.read_shift(1)>>>5&3,r=e.read_shift(n&&n.biff==2?1:2);return[t,r]}function h7(e,i,n){var t=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[t]}function _7(e,i,n){var t=(e[e.l++]&96)>>5,r=e.read_shift(2),a=4;if(n)switch(n.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[t,r]}var x7=vr,C7=vr,v7=vr;function Sd(e,i,n){return e.l+=2,[DF(e,4,n)]}function of(e){return e.l+=6,[]}var b7=Sd,y7=of,M7=of,P7=Sd;function py(e){return e.l+=2,[Ti(e),e.read_shift(2)&1]}var O7=Sd,w7=py,S7=of,k7=Sd,T7=Sd,E7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function I7(e){e.l+=2;var i=e.read_shift(2),n=e.read_shift(2),t=e.read_shift(4),r=e.read_shift(2),a=e.read_shift(2),o=E7[n>>2&31];return{ixti:i,coltype:n&3,rt:o,idx:t,c:r,C:a}}function A7(e){return e.l+=2,[e.read_shift(4)]}function D7(e,i,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function F7(e,i,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function R7(e){var i=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[i,n]}function B7(e){var i=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[i,n]}function N7(e){return e.l+=4,[0,0]}var Pv={1:{n:"PtgExp",f:n7},2:{n:"PtgTbl",f:v7},3:{n:"PtgAdd",f:Si},4:{n:"PtgSub",f:Si},5:{n:"PtgMul",f:Si},6:{n:"PtgDiv",f:Si},7:{n:"PtgPower",f:Si},8:{n:"PtgConcat",f:Si},9:{n:"PtgLt",f:Si},10:{n:"PtgLe",f:Si},11:{n:"PtgEq",f:Si},12:{n:"PtgGe",f:Si},13:{n:"PtgGt",f:Si},14:{n:"PtgNe",f:Si},15:{n:"PtgIsect",f:Si},16:{n:"PtgUnion",f:Si},17:{n:"PtgRange",f:Si},18:{n:"PtgUplus",f:Si},19:{n:"PtgUminus",f:Si},20:{n:"PtgPercent",f:Si},21:{n:"PtgParen",f:Si},22:{n:"PtgMissArg",f:Si},23:{n:"PtgStr",f:s7},26:{n:"PtgSheet",f:D7},27:{n:"PtgEndSheet",f:F7},28:{n:"PtgErr",f:i7},29:{n:"PtgBool",f:a7},30:{n:"PtgInt",f:r7},31:{n:"PtgNum",f:o7},32:{n:"PtgArray",f:zF},33:{n:"PtgFunc",f:QF},34:{n:"PtgFuncVar",f:JF},35:{n:"PtgName",f:m7},36:{n:"PtgRef",f:XF},37:{n:"PtgArea",f:BF},38:{n:"PtgMemArea",f:p7},39:{n:"PtgMemErr",f:x7},40:{n:"PtgMemNoMem",f:C7},41:{n:"PtgMemFunc",f:f7},42:{n:"PtgRefErr",f:h7},43:{n:"PtgAreaErr",f:LF},44:{n:"PtgRefN",f:KF},45:{n:"PtgAreaN",f:UF},46:{n:"PtgMemAreaN",f:R7},47:{n:"PtgMemNoMemN",f:B7},57:{n:"PtgNameX",f:g7},58:{n:"PtgRef3d",f:ZF},59:{n:"PtgArea3d",f:NF},60:{n:"PtgRefErr3d",f:_7},61:{n:"PtgAreaErr3d",f:VF},255:{}},L7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},V7={1:{n:"PtgElfLel",f:py},2:{n:"PtgElfRw",f:k7},3:{n:"PtgElfCol",f:b7},6:{n:"PtgElfRwV",f:T7},7:{n:"PtgElfColV",f:P7},10:{n:"PtgElfRadical",f:O7},11:{n:"PtgElfRadicalS",f:S7},13:{n:"PtgElfColS",f:y7},15:{n:"PtgElfColSV",f:M7},16:{n:"PtgElfRadicalLel",f:w7},25:{n:"PtgList",f:I7},29:{n:"PtgSxName",f:A7},255:{}},U7={0:{n:"PtgAttrNoop",f:N7},1:{n:"PtgAttrSemi",f:GF},2:{n:"PtgAttrIf",f:YF},4:{n:"PtgAttrChoose",f:jF},8:{n:"PtgAttrGoto",f:$F},16:{n:"PtgAttrSum",f:t7},32:{n:"PtgAttrBaxcel",f:Mv},33:{n:"PtgAttrBaxcel",f:Mv},64:{n:"PtgAttrSpace",f:HF},65:{n:"PtgAttrSpaceSemi",f:qF},128:{n:"PtgAttrIfError",f:WF},255:{}};function kd(e,i,n,t){if(t.biff<8)return vr(e,i);for(var r=e.l+i,a=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=d7(e,0,t),a.push(n[o][1]);break;case"PtgMemArea":n[o][2]=l7(e,n[o][1],t),a.push(n[o][2]);break;case"PtgExp":t&&t.biff==12&&(n[o][1][1]=e.read_shift(4),a.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0];default:break}return i=r-e.l,i!==0&&a.push(vr(e,i)),a}function Td(e,i,n){for(var t=e.l+i,r,a,o=[];t!=e.l;)i=t-e.l,a=e[e.l],r=Pv[a]||Pv[L7[a]],(a===24||a===25)&&(r=(a===24?V7:U7)[e[e.l+1]]),!r||!r.f?vr(e,i):o.push([r.n,r.f(e,i,n)]);return o}function z7(e){for(var i=[],n=0;n<e.length;++n){for(var t=e[n],r=[],a=0;a<t.length;++a){var o=t[a];if(o)switch(o[0]){case 2:r.push('"'+o[1].replace(/"/g,'""')+'"');break;default:r.push(o[1])}else r.push("")}i.push(r.join(","))}return i.join(";")}var j7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $7(e,i){if(!e&&!(i&&i.biff<=5&&i.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function fy(e,i,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[i]))return e.SheetNames[i];if(!e.XTI)return"SH33TJSERR6";var t=e.XTI[i];if(n.biff<8)return i>1e4&&(i-=65536),i<0&&(i=-i),i==0?"":e.XTI[i-1];if(!t)return"SH33TJSERR1";var r="";if(n.biff>8)switch(e[t[0]][0]){case 357:return r=t[1]==-1?"#REF":e.SheetNames[t[1]],t[1]==t[2]?r:r+":"+e.SheetNames[t[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[t[0]][0];case 355:default:return"SH33TJSSRC"+e[t[0]][0]}switch(e[t[0]][0][0]){case 1025:return r=t[1]==-1?"#REF":e.SheetNames[t[1]]||"SH33TJSERR3",t[1]==t[2]?r:r+":"+e.SheetNames[t[2]];case 14849:return e[t[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[t[0]][0][3]?(r=t[1]==-1?"#REF":e[t[0]][0][3][t[1]]||"SH33TJSERR4",t[1]==t[2]?r:r+":"+e[t[0]][0][3][t[2]]):"SH33TJSERR2"}}function Ov(e,i,n){var t=fy(e,i,n);return t=="#REF"?t:$7(t,n)}function fr(e,i,n,t,r){var a=r&&r.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],m,g,f,h=0,x=0,C,y="";if(!e[0]||!e[0][0])return"";for(var b=-1,w="",A=0,E=e[0].length;A<E;++A){var I=e[0][A];switch(I[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=l.pop(),g=l.pop(),b>=0){switch(e[0][b][1][0]){case 0:w=ai(" ",e[0][b][1][1]);break;case 1:w=ai("\r",e[0][b][1][1]);break;default:if(w="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}g=g+w,b=-1}l.push(g+j7[I[0]]+m);break;case"PtgIsect":m=l.pop(),g=l.pop(),l.push(g+" "+m);break;case"PtgUnion":m=l.pop(),g=l.pop(),l.push(g+","+m);break;case"PtgRange":m=l.pop(),g=l.pop(),l.push(g+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=id(I[1][1],o,r),l.push(rd(f,a));break;case"PtgRefN":f=n?id(I[1][1],n,r):I[1][1],l.push(rd(f,a));break;case"PtgRef3d":h=I[1][1],f=id(I[1][2],o,r),y=Ov(t,h,r);var K=y;l.push(y+"!"+rd(f,a));break;case"PtgFunc":case"PtgFuncVar":var Z=I[1][0],k=I[1][1];Z||(Z=0),Z&=127;var S=Z==0?[]:l.slice(-Z);l.length-=Z,k==="User"&&(k=S.shift()),l.push(k+"("+S.join(",")+")");break;case"PtgBool":l.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(I[1]);break;case"PtgNum":l.push(String(I[1]));break;case"PtgStr":l.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(I[1]);break;case"PtgAreaN":C=ev(I[1][1],n?{s:n}:o,r),l.push(tp(C,r));break;case"PtgArea":C=ev(I[1][1],o,r),l.push(tp(C,r));break;case"PtgArea3d":h=I[1][1],C=I[1][2],y=Ov(t,h,r),l.push(y+"!"+tp(C,r));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=I[1][2];var V=(t.names||[])[x-1]||(t[0]||[])[x],W=V?V.Name:"SH33TJSNAME"+String(x);W&&W.slice(0,6)=="_xlfn."&&!r.xlfn&&(W=W.slice(6)),l.push(W);break;case"PtgNameX":var Q=I[1][1];x=I[1][2];var se;if(r.biff<=5)Q<0&&(Q=-Q),t[Q]&&(se=t[Q][x]);else{var ae="";if(((t[Q]||[])[0]||[])[0]==14849||(((t[Q]||[])[0]||[])[0]==1025?t[Q][x]&&t[Q][x].itab>0&&(ae=t.SheetNames[t[Q][x].itab-1]+"!"):ae=t.SheetNames[x-1]+"!"),t[Q]&&t[Q][x])ae+=t[Q][x].Name;else if(t[0]&&t[0][x])ae+=t[0][x].Name;else{var ke=(fy(t,Q,r)||"").split(";;");ke[x-1]?ae=ke[x-1]:ae+="SH33TJSERRX"}l.push(ae);break}se||(se={Name:"SH33TJSERRY"}),l.push(se.Name);break;case"PtgParen":var Ne="(",Ce=")";if(b>=0){switch(w="",e[0][b][1][0]){case 2:Ne=ai(" ",e[0][b][1][1])+Ne;break;case 3:Ne=ai("\r",e[0][b][1][1])+Ne;break;case 4:Ce=ai(" ",e[0][b][1][1])+Ce;break;case 5:Ce=ai("\r",e[0][b][1][1])+Ce;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}l.push(Ne+l.pop()+Ce);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":f={c:I[1][1],r:I[1][0]};var Ve={c:n.c,r:n.r};if(t.sharedf[Pt(f)]){var Oe=t.sharedf[Pt(f)];l.push(fr(Oe,o,Ve,t,r))}else{var Ze=!1;for(m=0;m!=t.arrayf.length;++m)if(g=t.arrayf[m],!(f.c<g[0].s.c||f.c>g[0].e.c)&&!(f.r<g[0].s.r||f.r>g[0].e.r)){l.push(fr(g[1],o,Ve,t,r)),Ze=!0;break}Ze||l.push(I[1])}break;case"PtgArray":l.push("{"+z7(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var Se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&b>=0&&Se.indexOf(e[0][A][0])==-1){I=e[0][b];var Fe=!0;switch(I[1][0]){case 4:Fe=!1;case 0:w=ai(" ",I[1][1]);break;case 5:Fe=!1;case 1:w=ai("\r",I[1][1]);break;default:if(w="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}l.push((Fe?w:"")+l.pop()+(Fe?"":w)),b=-1}}if(l.length>1&&r.WTF)throw new Error("bad formula stack");return l[0]}function Y7(e,i,n){var t=e.l+i,r=n.biff==2?1:2,a,o=e.read_shift(r);if(o==65535)return[[],vr(e,i-2)];var l=Td(e,o,n);return i!==o+r&&(a=kd(e,i-o-r,l,n)),e.l=t,[l,a]}function W7(e,i,n){var t=e.l+i,r=n.biff==2?1:2,a,o=e.read_shift(r);if(o==65535)return[[],vr(e,i-2)];var l=Td(e,o,n);return i!==o+r&&(a=kd(e,i-o-r,l,n)),e.l=t,[l,a]}function G7(e,i,n,t){var r=e.l+i,a=Td(e,t,n),o;return r!==e.l&&(o=kd(e,r-e.l,a,n)),[a,o]}function H7(e,i,n){var t=e.l+i,r,a=e.read_shift(2),o=Td(e,a,n);return a==65535?[[],vr(e,i-2)]:(i!==a+2&&(r=kd(e,t-a-2,o,n)),[o,r])}function q7(e){var i;if(wo(e,e.l+6)!==65535)return[_r(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return i=e[e.l+2]===1,e.l+=8,[i,"b"];case 2:return i=e[e.l+2],e.l+=8,[i,"e"];case 3:return e.l+=8,["","s"]}return[]}function X7(e){if(e==null){var i=Me(8);return i.write_shift(1,3),i.write_shift(1,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,65535),i}else if(typeof e=="number")return Vs(e);return Vs(0)}function op(e,i,n){var t=e.l+i,r=ao(e,6);n.biff==2&&++e.l;var a=q7(e,8),o=e.read_shift(1);n.biff!=2&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var l=W7(e,t-e.l,n);return{cell:r,val:a[0],formula:l,shared:o>>3&1,tt:a[1]}}function K7(e,i,n,t,r){var a=zs(i,n,r),o=X7(e.v),l=Me(6),m=33;l.write_shift(2,m),l.write_shift(4,0);for(var g=Me(e.bf.length),f=0;f<e.bf.length;++f)g[f]=e.bf[f];var h=Gi([a,o,l,g]);return h}function Ng(e,i,n){var t=e.read_shift(4),r=Td(e,t,n),a=e.read_shift(4),o=a>0?kd(e,a,r,n):null;return[r,o]}var Z7=Ng,Lg=Ng,Q7=Ng,J7=Ng,e9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},hy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},t9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function wv(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(i,n){return n.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function n9(e){var i="of:="+e.replace(rf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return i.replace(/;/g,"|").replace(/,/g,";")}function sp(e){var i=e.split(":"),n=i[0].split(".")[0];return[n,i[0].split(".")[1]+(i.length>1?":"+(i[1].split(".")[1]||i[1].split(".")[0]):"")]}function i9(e){return e.replace(/\./,"!")}var od={},cl={},sd=typeof Map<"u";function sf(e,i,n){var t=0,r=e.length;if(n){if(sd?n.has(i):Object.prototype.hasOwnProperty.call(n,i)){for(var a=sd?n.get(i):n[i];t<a.length;++t)if(e[a[t]].t===i)return e.Count++,a[t]}}else for(;t<r;++t)if(e[t].t===i)return e.Count++,t;return e[r]={t:i},e.Count++,e.Unique++,n&&(sd?(n.has(i)||n.set(i,[]),n.get(i).push(r)):(Object.prototype.hasOwnProperty.call(n,i)||(n[i]=[]),n[i].push(r))),r}function Vg(e,i){var n={min:e+1,max:e+1},t=-1;return i.MDW&&(hr=i.MDW),i.width!=null?n.customWidth=1:i.wpx!=null?t=Cd(i.wpx):i.wch!=null&&(t=i.wch),t>-1?(n.width=Sg(t),n.customWidth=1):i.width!=null&&(n.width=i.width),i.hidden&&(n.hidden=!0),i.level!=null&&(n.outlineLevel=n.level=i.level),n}function Bs(e,i){if(e){var n=[.7,.7,.75,.75,.3,.3];i=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function us(e,i,n){var t=n.revssf[i.z!=null?i.z:"General"],r=60,a=e.length;if(t==null&&n.ssf){for(;r<392;++r)if(n.ssf[r]==null){ko(i.z,r),n.ssf[r]=i.z,n.revssf[i.z]=t=r;break}}for(r=0;r!=a;++r)if(e[r].numFmtId===t)return r;return e[a]={numFmtId:t,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function _y(e,i,n,t,r,a){try{t.cellNF&&(e.z=Mt[i])}catch(l){if(t.WTF)throw l}if(!(e.t==="z"&&!t.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ln(e.v)),(!t||t.cellText!==!1)&&e.t!=="z")try{if(Mt[i]==null&&ko(e6[i]||"General",i),e.t==="e")e.w=e.w||Do[e.v];else if(i===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=gd(e.v);else if(e.t==="d"){var o=Di(e.v);(o|0)===o?e.w=o.toString(10):e.w=gd(o)}else{if(e.v===void 0)return"";e.w=Ns(e.v,cl)}else e.t==="d"?e.w=va(i,Di(e.v),cl):e.w=va(i,e.v,cl)}catch(l){if(t.WTF)throw l}if(t.cellStyles&&n!=null)try{e.s=a.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=wg(r.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),t.WTF&&(e.s.fgColor.raw_rgb=r.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=wg(r.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),t.WTF&&(e.s.bgColor.raw_rgb=r.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(t.WTF&&a.Fills)throw l}}}function r9(e,i,n){if(e&&e["!ref"]){var t=cn(e["!ref"]);if(t.e.c<t.s.c||t.e.r<t.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function a9(e,i){var n=cn(i);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=zt(n))}var o9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,s9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,c9=/<(?:\w:)?hyperlink [^>]*>/mg,l9=/"(\w*:\w*)"/,d9=/<(?:\w:)?col\b[^>]*[\/]?>/g,m9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,g9=/<(?:\w:)?pageMargins[^>]*\/>/g,xy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,u9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,p9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function f9(e,i,n,t,r,a,o){if(!e)return e;t||(t={"!id":{}}),si!=null&&i.dense==null&&(i.dense=si);var l=i.dense?[]:{},m={s:{r:2e6,c:2e6},e:{r:0,c:0}},g="",f="",h=e.match(s9);h?(g=e.slice(0,h.index),f=e.slice(h.index+h[0].length)):g=f=e;var x=g.match(xy);x?cf(x[0],l,r,n):(x=g.match(u9))&&_9(x[0],x[1]||"",l,r,n,o,a);var C=(g.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(C>0){var y=g.slice(C,C+50).match(l9);y&&a9(l,y[1])}var b=g.match(p9);b&&b[1]&&E9(b[1],r);var w=[];if(i.cellStyles){var A=g.match(d9);A&&O9(w,A)}h&&D9(h[1],l,i,m,a,o);var E=f.match(m9);E&&(l["!autofilter"]=S9(E[0]));var I=[],K=f.match(o9);if(K)for(C=0;C!=K.length;++C)I[C]=cn(K[C].slice(K[C].indexOf('"')+1));var Z=f.match(c9);Z&&y9(l,Z,t);var k=f.match(g9);if(k&&(l["!margins"]=M9(kt(k[0]))),!l["!ref"]&&m.e.c>=m.s.c&&m.e.r>=m.s.r&&(l["!ref"]=zt(m)),i.sheetRows>0&&l["!ref"]){var S=cn(l["!ref"]);i.sheetRows<=+S.e.r&&(S.e.r=i.sheetRows-1,S.e.r>m.e.r&&(S.e.r=m.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>m.e.c&&(S.e.c=m.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),l["!fullref"]=l["!ref"],l["!ref"]=zt(S))}return w.length>0&&(l["!cols"]=w),I.length>0&&(l["!merges"]=I),l}function h9(e){if(e.length===0)return"";for(var i='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)i+='<mergeCell ref="'+zt(e[n])+'"/>';return i+"</mergeCells>"}function cf(e,i,n,t){var r=kt(e);n.Sheets[t]||(n.Sheets[t]={}),r.codeName&&(n.Sheets[t].CodeName=sn(wn(r.codeName)))}function _9(e,i,n,t,r){cf(e.slice(0,e.indexOf(">")),n,t,r)}function x9(e,i,n,t,r){var a=!1,o={},l=null;if(t.bookType!=="xlsx"&&i.vbaraw){var m=i.SheetNames[n];try{i.Workbook&&(m=i.Workbook.Sheets[n].CodeName||m)}catch{}a=!0,o.codeName=no(On(m))}if(e&&e["!outline"]){var g={summaryBelow:1,summaryRight:1};e["!outline"].above&&(g.summaryBelow=0),e["!outline"].left&&(g.summaryRight=0),l=(l||"")+Ye("outlinePr",null,g)}!a&&!l||(r[r.length]=Ye("sheetPr",l,o))}var C9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],v9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function b9(e){var i={sheet:1};return C9.forEach(function(n){e[n]!=null&&e[n]&&(i[n]="1")}),v9.forEach(function(n){e[n]!=null&&!e[n]&&(i[n]="0")}),e.password&&(i.password=ef(e.password).toString(16).toUpperCase()),Ye("sheetProtection",null,i)}function y9(e,i,n){for(var t=Array.isArray(e),r=0;r!=i.length;++r){var a=kt(wn(i[r]),!0);if(!a.ref)return;var o=((n||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+sn(a.location))):(a.Target="#"+sn(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=cn(a.ref),m=l.s.r;m<=l.e.r;++m)for(var g=l.s.c;g<=l.e.c;++g){var f=Pt({c:g,r:m});t?(e[m]||(e[m]=[]),e[m][g]||(e[m][g]={t:"z",v:void 0}),e[m][g].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function M9(e){var i={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(i[n]=parseFloat(e[n]))}),i}function P9(e){return Bs(e),Ye("pageMargins",null,e)}function O9(e,i){for(var n=!1,t=0;t!=i.length;++t){var r=kt(i[t],!0);r.hidden&&(r.hidden=Nn(r.hidden));var a=parseInt(r.min,10)-1,o=parseInt(r.max,10)-1;for(r.outlineLevel&&(r.level=+r.outlineLevel||0),delete r.min,delete r.max,r.width=+r.width,!n&&r.width&&(n=!0,tf(r.width)),cs(r);a<=o;)e[a++]=Vn(r)}}function w9(e,i){for(var n=["<cols>"],t,r=0;r!=i.length;++r)(t=i[r])&&(n[n.length]=Ye("col",null,Vg(r,t)));return n[n.length]="</cols>",n.join("")}function S9(e){var i={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return i}function k9(e,i,n,t){var r=typeof e.ref=="string"?e.ref:zt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var a=n.Workbook.Names,o=$r(r);o.s.r==o.e.r&&(o.e.r=$r(i["!ref"]).e.r,r=zt(o));for(var l=0;l<a.length;++l){var m=a[l];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==t){m.Ref="'"+n.SheetNames[t]+"'!"+r;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:t,Ref:"'"+n.SheetNames[t]+"'!"+r}),Ye("autoFilter",null,{ref:r})}var T9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function E9(e,i){i.Views||(i.Views=[{}]),(e.match(T9)||[]).forEach(function(n,t){var r=kt(n);i.Views[t]||(i.Views[t]={}),+r.zoomScale&&(i.Views[t].zoom=+r.zoomScale),Nn(r.rightToLeft)&&(i.Views[t].RTL=!0)})}function I9(e,i,n,t){var r={workbookViewId:"0"};return(((t||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=t.Workbook.Views[0].RTL?"1":"0"),Ye("sheetViews",Ye("sheetView",null,r),{})}function A9(e,i,n,t){if(e.c&&n["!comments"].push([i,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var r="",a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":r=e.v?"1":"0";break;case"n":r=""+e.v;break;case"e":r=Do[e.v];break;case"d":t&&t.cellDates?r=Ln(e.v,-1).toISOString():(e=Vn(e),e.t="n",r=""+(e.v=Di(Ln(e.v)))),typeof e.z>"u"&&(e.z=Mt[14]);break;default:r=e.v;break}var l=Qi("v",On(r)),m={r:i},g=us(t.cellXfs,e,t);switch(g!==0&&(m.s=g),e.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(t&&t.bookSST){l=Qi("v",""+sf(t.Strings,e.v,t.revStrings)),m.t="s";break}m.t="str";break}if(e.t!=a&&(e.t=a,e.v=o),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,i.length)==i?{t:"array",ref:e.F}:null;l=Ye("f",On(e.f),f)+(e.v!=null?l:"")}return e.l&&n["!links"].push([i,e.l]),e.D&&(m.cm=1),Ye("c",l,m)}var D9=function(){var e=/<(?:\w+:)?c[ \/>]/,i=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,t=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,r=/ref=["']([^"']*)["']/,a=ud("v"),o=ud("f");return function(m,g,f,h,x,C){for(var y=0,b="",w=[],A=[],E=0,I=0,K=0,Z="",k,S,V=0,W=0,Q,se,ae=0,ke=0,Ne=Array.isArray(C.CellXf),Ce,Ve=[],Oe=[],Ze=Array.isArray(g),Se=[],Fe={},de=!1,X=!!f.sheetStubs,te=m.split(i),J=0,ee=te.length;J!=ee;++J){b=te[J].trim();var ge=b.length;if(ge!==0){var Te=0;e:for(y=0;y<ge;++y)switch(b[y]){case">":if(b[y-1]!="/"){++y;break e}if(f&&f.cellStyles){if(S=kt(b.slice(Te,y),!0),V=S.r!=null?parseInt(S.r,10):V+1,W=-1,f.sheetRows&&f.sheetRows<V)continue;Fe={},de=!1,S.ht&&(de=!0,Fe.hpt=parseFloat(S.ht),Fe.hpx=gl(Fe.hpt)),S.hidden=="1"&&(de=!0,Fe.hidden=!0),S.outlineLevel!=null&&(de=!0,Fe.level=+S.outlineLevel),de&&(Se[V-1]=Fe)}break;case"<":Te=y;break}if(Te>=y)break;if(S=kt(b.slice(Te,y),!0),V=S.r!=null?parseInt(S.r,10):V+1,W=-1,!(f.sheetRows&&f.sheetRows<V)){h.s.r>V-1&&(h.s.r=V-1),h.e.r<V-1&&(h.e.r=V-1),f&&f.cellStyles&&(Fe={},de=!1,S.ht&&(de=!0,Fe.hpt=parseFloat(S.ht),Fe.hpx=gl(Fe.hpt)),S.hidden=="1"&&(de=!0,Fe.hidden=!0),S.outlineLevel!=null&&(de=!0,Fe.level=+S.outlineLevel),de&&(Se[V-1]=Fe)),w=b.slice(y).split(e);for(var Ee=0;Ee!=w.length&&w[Ee].trim().charAt(0)=="<";++Ee);for(w=w.slice(Ee),y=0;y!=w.length;++y)if(b=w[y].trim(),b.length!==0){if(A=b.match(n),E=y,I=0,K=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,A!=null&&A.length===2){for(E=0,Z=A[1],I=0;I!=Z.length&&!((K=Z.charCodeAt(I)-64)<1||K>26);++I)E=26*E+K;--E,W=E}else++W;for(I=0;I!=b.length&&b.charCodeAt(I)!==62;++I);if(++I,S=kt(b.slice(0,I),!0),S.r||(S.r=Pt({r:V-1,c:W})),Z=b.slice(I),k={t:""},(A=Z.match(a))!=null&&A[1]!==""&&(k.v=sn(A[1])),f.cellFormula){if((A=Z.match(o))!=null&&A[1]!==""){if(k.f=sn(wn(A[1])).replace(/\r\n/g,`
`),f.xlfn||(k.f=yv(k.f)),A[0].indexOf('t="array"')>-1)k.F=(Z.match(r)||[])[1],k.F.indexOf(":")>-1&&Ve.push([cn(k.F),k.F]);else if(A[0].indexOf('t="shared"')>-1){se=kt(A[0]);var Pe=sn(wn(A[1]));f.xlfn||(Pe=yv(Pe)),Oe[parseInt(se.si,10)]=[se,Pe,S.r]}}else(A=Z.match(/<f[^>]*\/>/))&&(se=kt(A[0]),Oe[se.si]&&(k.f=TF(Oe[se.si][1],Oe[se.si][2],S.r)));var ve=Kn(S.r);for(I=0;I<Ve.length;++I)ve.r>=Ve[I][0].s.r&&ve.r<=Ve[I][0].e.r&&ve.c>=Ve[I][0].s.c&&ve.c<=Ve[I][0].e.c&&(k.F=Ve[I][1])}if(S.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(X)k.t="z";else continue;else k.t=S.t||"n";switch(h.s.c>W&&(h.s.c=W),h.e.c<W&&(h.e.c=W),k.t){case"n":if(k.v==""||k.v==null){if(!X)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!X)continue;k.t="z"}else Q=od[parseInt(k.v,10)],k.v=Q.t,k.r=Q.r,f.cellHTML&&(k.h=Q.h);break;case"str":k.t="s",k.v=k.v!=null?wn(k.v):"",f.cellHTML&&(k.h=Rp(k.v));break;case"inlineStr":A=Z.match(t),k.t="s",A!=null&&(Q=Jp(A[1]))?(k.v=Q.t,f.cellHTML&&(k.h=Q.h)):k.v="";break;case"b":k.v=Nn(k.v);break;case"d":f.cellDates?k.v=Ln(k.v,1):(k.v=Di(Ln(k.v,1)),k.t="n");break;case"e":(!f||f.cellText!==!1)&&(k.w=k.v),k.v=vb[k.v];break}if(ae=ke=0,Ce=null,Ne&&S.s!==void 0&&(Ce=C.CellXf[S.s],Ce!=null&&(Ce.numFmtId!=null&&(ae=Ce.numFmtId),f.cellStyles&&Ce.fillId!=null&&(ke=Ce.fillId))),_y(k,ae,ke,f,x,C),f.cellDates&&Ne&&k.t=="n"&&ul(Mt[ae])&&(k.t="d",k.v=Fg(k.v)),S.cm&&f.xlmeta){var ot=(f.xlmeta.Cell||[])[+S.cm-1];ot&&ot.type=="XLDAPR"&&(k.D=!0)}if(Ze){var H=Kn(S.r);g[H.r]||(g[H.r]=[]),g[H.r][H.c]=k}else g[S.r]=k}}}}Se.length>0&&(g["!rows"]=Se)}}();function F9(e,i,n,t){var r=[],a=[],o=cn(e["!ref"]),l="",m,g="",f=[],h=0,x=0,C=e["!rows"],y=Array.isArray(e),b={r:g},w,A=-1;for(x=o.s.c;x<=o.e.c;++x)f[x]=Xn(x);for(h=o.s.r;h<=o.e.r;++h){for(a=[],g=pi(h),x=o.s.c;x<=o.e.c;++x){m=f[x]+g;var E=y?(e[h]||[])[x]:e[m];E!==void 0&&(l=A9(E,m,e,i,n,t))!=null&&a.push(l)}(a.length>0||C&&C[h])&&(b={r:g},C&&C[h]&&(w=C[h],w.hidden&&(b.hidden=1),A=-1,w.hpx?A=vd(w.hpx):w.hpt&&(A=w.hpt),A>-1&&(b.ht=A,b.customHeight=1),w.level&&(b.outlineLevel=w.level)),r[r.length]=Ye("row",a.join(""),b))}if(C)for(;h<C.length;++h)C&&C[h]&&(b={r:h+1},w=C[h],w.hidden&&(b.hidden=1),A=-1,w.hpx?A=vd(w.hpx):w.hpt&&(A=w.hpt),A>-1&&(b.ht=A,b.customHeight=1),w.level&&(b.outlineLevel=w.level),r[r.length]=Ye("row","",b));return r.join("")}function Cy(e,i,n,t){var r=[fi,Ye("worksheet",null,{xmlns:$s[0],"xmlns:r":Ai.r})],a=n.SheetNames[e],o=0,l="",m=n.Sheets[a];m==null&&(m={});var g=m["!ref"]||"A1",f=cn(g);if(f.e.c>16383||f.e.r>1048575){if(i.WTF)throw new Error("Range "+g+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),g=zt(f)}t||(t={}),m["!comments"]=[];var h=[];x9(m,n,e,i,r),r[r.length]=Ye("dimension",null,{ref:g}),r[r.length]=I9(m,i,e,n),i.sheetFormat&&(r[r.length]=Ye("sheetFormatPr",null,{defaultRowHeight:i.sheetFormat.defaultRowHeight||"16",baseColWidth:i.sheetFormat.baseColWidth||"10",outlineLevelRow:i.sheetFormat.outlineLevelRow||"7"})),m["!cols"]!=null&&m["!cols"].length>0&&(r[r.length]=w9(m,m["!cols"])),r[o=r.length]="<sheetData/>",m["!links"]=[],m["!ref"]!=null&&(l=F9(m,i,e,n,t),l.length>0&&(r[r.length]=l)),r.length>o+1&&(r[r.length]="</sheetData>",r[o]=r[o].replace("/>",">")),m["!protect"]&&(r[r.length]=b9(m["!protect"])),m["!autofilter"]!=null&&(r[r.length]=k9(m["!autofilter"],m,n,e)),m["!merges"]!=null&&m["!merges"].length>0&&(r[r.length]=h9(m["!merges"]));var x=-1,C,y=-1;return m["!links"].length>0&&(r[r.length]="<hyperlinks>",m["!links"].forEach(function(b){b[1].Target&&(C={ref:b[0]},b[1].Target.charAt(0)!="#"&&(y=Pn(t,-1,On(b[1].Target).replace(/#.*$/,""),Wt.HLINK),C["r:id"]="rId"+y),(x=b[1].Target.indexOf("#"))>-1&&(C.location=On(b[1].Target.slice(x+1))),b[1].Tooltip&&(C.tooltip=On(b[1].Tooltip)),r[r.length]=Ye("hyperlink",null,C))}),r[r.length]="</hyperlinks>"),delete m["!links"],m["!margins"]!=null&&(r[r.length]=P9(m["!margins"])),(!i||i.ignoreEC||i.ignoreEC==null)&&(r[r.length]=Qi("ignoredErrors",Ye("ignoredError",null,{numberStoredAsText:1,sqref:g}))),h.length>0&&(y=Pn(t,-1,"../drawings/drawing"+(e+1)+".xml",Wt.DRAW),r[r.length]=Ye("drawing",null,{"r:id":"rId"+y}),m["!drawing"]=h),m["!comments"].length>0&&(y=Pn(t,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Wt.VML),r[r.length]=Ye("legacyDrawing",null,{"r:id":"rId"+y}),m["!legacy"]=y),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function R9(e,i){var n={},t=e.l+i;n.r=e.read_shift(4),e.l+=4;var r=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=t,a&7&&(n.level=a&7),a&16&&(n.hidden=!0),a&32&&(n.hpt=r/20),n}function B9(e,i,n){var t=Me(145),r=(n["!rows"]||[])[e]||{};t.write_shift(4,e),t.write_shift(4,0);var a=320;r.hpx?a=vd(r.hpx)*20:r.hpt&&(a=r.hpt*20),t.write_shift(2,a),t.write_shift(1,0);var o=0;r.level&&(o|=r.level),r.hidden&&(o|=16),(r.hpx||r.hpt)&&(o|=32),t.write_shift(1,o),t.write_shift(1,0);var l=0,m=t.l;t.l+=4;for(var g={r:e,c:0},f=0;f<16;++f)if(!(i.s.c>f+1<<10||i.e.c<f<<10)){for(var h=-1,x=-1,C=f<<10;C<f+1<<10;++C){g.c=C;var y=Array.isArray(n)?(n[g.r]||[])[g.c]:n[Pt(g)];y&&(h<0&&(h=C),x=C)}h<0||(++l,t.write_shift(4,h),t.write_shift(4,x))}var b=t.l;return t.l=m,t.write_shift(4,l),t.l=b,t.length>t.l?t.slice(0,t.l):t}function N9(e,i,n,t){var r=B9(t,n,i);(r.length>17||(i["!rows"]||[])[t])&&Ae(e,0,r)}var L9=Hs,V9=_l;function U9(){}function z9(e,i){var n={},t=e[e.l];return++e.l,n.above=!(t&64),n.left=!(t&128),e.l+=18,n.name=Y6(e,i-19),n}function j9(e,i,n){n==null&&(n=Me(84+4*e.length));var t=192;i&&(i.above&&(t&=-65),i.left&&(t&=-129)),n.write_shift(1,t);for(var r=1;r<3;++r)n.write_shift(1,0);return Mg({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),fb(e,n),n.slice(0,n.l)}function $9(e){var i=ba(e);return[i]}function Y9(e,i,n){return n==null&&(n=Me(8)),Ys(i,n)}function W9(e){var i=Ws(e);return[i]}function G9(e,i,n){return n==null&&(n=Me(4)),Gs(i,n)}function H9(e){var i=ba(e),n=e.read_shift(1);return[i,n,"b"]}function q9(e,i,n){return n==null&&(n=Me(9)),Ys(i,n),n.write_shift(1,e.v?1:0),n}function X9(e){var i=Ws(e),n=e.read_shift(1);return[i,n,"b"]}function K9(e,i,n){return n==null&&(n=Me(5)),Gs(i,n),n.write_shift(1,e.v?1:0),n}function Z9(e){var i=ba(e),n=e.read_shift(1);return[i,n,"e"]}function Q9(e,i,n){return n==null&&(n=Me(9)),Ys(i,n),n.write_shift(1,e.v),n}function J9(e){var i=Ws(e),n=e.read_shift(1);return[i,n,"e"]}function eR(e,i,n){return n==null&&(n=Me(8)),Gs(i,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function tR(e){var i=ba(e),n=e.read_shift(4);return[i,n,"s"]}function nR(e,i,n){return n==null&&(n=Me(12)),Ys(i,n),n.write_shift(4,i.v),n}function iR(e){var i=Ws(e),n=e.read_shift(4);return[i,n,"s"]}function rR(e,i,n){return n==null&&(n=Me(8)),Gs(i,n),n.write_shift(4,i.v),n}function aR(e){var i=ba(e),n=_r(e);return[i,n,"n"]}function oR(e,i,n){return n==null&&(n=Me(16)),Ys(i,n),Vs(e.v,n),n}function vy(e){var i=Ws(e),n=_r(e);return[i,n,"n"]}function sR(e,i,n){return n==null&&(n=Me(12)),Gs(i,n),Vs(e.v,n),n}function cR(e){var i=ba(e),n=qp(e);return[i,n,"n"]}function lR(e,i,n){return n==null&&(n=Me(12)),Ys(i,n),hb(e.v,n),n}function dR(e){var i=Ws(e),n=qp(e);return[i,n,"n"]}function mR(e,i,n){return n==null&&(n=Me(8)),Gs(i,n),hb(e.v,n),n}function gR(e){var i=ba(e),n=Wp(e);return[i,n,"is"]}function uR(e){var i=ba(e),n=Cr(e);return[i,n,"str"]}function pR(e,i,n){return n==null&&(n=Me(12+4*e.v.length)),Ys(i,n),Hi(e.v,n),n.length>n.l?n.slice(0,n.l):n}function fR(e){var i=Ws(e),n=Cr(e);return[i,n,"str"]}function hR(e,i,n){return n==null&&(n=Me(8+4*e.v.length)),Gs(i,n),Hi(e.v,n),n.length>n.l?n.slice(0,n.l):n}function _R(e,i,n){var t=e.l+i,r=ba(e);r.r=n["!row"];var a=e.read_shift(1),o=[r,a,"b"];if(n.cellFormula){e.l+=2;var l=Lg(e,t-e.l,n);o[3]=fr(l,null,r,n.supbooks,n)}else e.l=t;return o}function xR(e,i,n){var t=e.l+i,r=ba(e);r.r=n["!row"];var a=e.read_shift(1),o=[r,a,"e"];if(n.cellFormula){e.l+=2;var l=Lg(e,t-e.l,n);o[3]=fr(l,null,r,n.supbooks,n)}else e.l=t;return o}function CR(e,i,n){var t=e.l+i,r=ba(e);r.r=n["!row"];var a=_r(e),o=[r,a,"n"];if(n.cellFormula){e.l+=2;var l=Lg(e,t-e.l,n);o[3]=fr(l,null,r,n.supbooks,n)}else e.l=t;return o}function vR(e,i,n){var t=e.l+i,r=ba(e);r.r=n["!row"];var a=Cr(e),o=[r,a,"str"];if(n.cellFormula){e.l+=2;var l=Lg(e,t-e.l,n);o[3]=fr(l,null,r,n.supbooks,n)}else e.l=t;return o}var bR=Hs,yR=_l;function MR(e,i){return i==null&&(i=Me(4)),i.write_shift(4,e),i}function PR(e,i){var n=e.l+i,t=Hs(e,16),r=Gp(e),a=Cr(e),o=Cr(e),l=Cr(e);e.l=n;var m={rfx:t,relId:r,loc:a,display:l};return o&&(m.Tooltip=o),m}function OR(e,i){var n=Me(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));_l({s:Kn(e[0]),e:Kn(e[0])},n),Hp("rId"+i,n);var t=e[1].Target.indexOf("#"),r=t==-1?"":e[1].Target.slice(t+1);return Hi(r||"",n),Hi(e[1].Tooltip||"",n),Hi("",n),n.slice(0,n.l)}function wR(){}function SR(e,i,n){var t=e.l+i,r=_b(e,16),a=e.read_shift(1),o=[r];if(o[2]=a,n.cellFormula){var l=Z7(e,t-e.l,n);o[1]=l}else e.l=t;return o}function kR(e,i,n){var t=e.l+i,r=Hs(e,16),a=[r];if(n.cellFormula){var o=J7(e,t-e.l,n);a[1]=o,e.l=t}else e.l=t;return a}function TR(e,i,n){n==null&&(n=Me(18));var t=Vg(e,i);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(t.width||10)*256),n.write_shift(4,0);var r=0;return i.hidden&&(r|=1),typeof t.width=="number"&&(r|=2),i.level&&(r|=i.level<<8),n.write_shift(2,r),n}var by=["left","right","top","bottom","header","footer"];function ER(e){var i={};return by.forEach(function(n){i[n]=_r(e,8)}),i}function IR(e,i){return i==null&&(i=Me(6*8)),Bs(e),by.forEach(function(n){Vs(e[n],i)}),i}function AR(e){var i=e.read_shift(2);return e.l+=28,{RTL:i&32}}function DR(e,i,n){n==null&&(n=Me(30));var t=924;return(((i||{}).Views||[])[0]||{}).RTL&&(t|=32),n.write_shift(2,t),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function FR(e){var i=Me(24);return i.write_shift(4,4),i.write_shift(4,1),_l(e,i),i}function RR(e,i){return i==null&&(i=Me(16*4+2)),i.write_shift(2,e.password?ef(e.password):0),i.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?i.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):i.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),i}function BR(){}function NR(){}function LR(e,i,n,t,r,a,o){if(!e)return e;var l=i||{};t||(t={"!id":{}}),si!=null&&l.dense==null&&(l.dense=si);var m=l.dense?[]:{},g,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=[],x=!1,C=!1,y,b,w,A,E,I,K,Z,k,S=[];l.biff=12,l["!row"]=0;var V=0,W=!1,Q=[],se={},ae=l.supbooks||r.supbooks||[[]];if(ae.sharedf=se,ae.arrayf=Q,ae.SheetNames=r.SheetNames||r.Sheets.map(function(Fe){return Fe.name}),!l.supbooks&&(l.supbooks=ae,r.Names))for(var ke=0;ke<r.Names.length;++ke)ae[0][ke+1]=r.Names[ke];var Ne=[],Ce=[],Ve=!1;bd[16]={n:"BrtShortReal",f:vy};var Oe,Ze;if(Ao(e,function(de,X,te){if(!C)switch(te){case 148:g=de;break;case 0:y=de,l.sheetRows&&l.sheetRows<=y.r&&(C=!0),Z=pi(A=y.r),l["!row"]=y.r,(de.hidden||de.hpt||de.level!=null)&&(de.hpt&&(de.hpx=gl(de.hpt)),Ce[de.r]=de);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:de[2]},de[2]){case"n":b.v=de[1];break;case"s":K=od[de[1]],b.v=K.t,b.r=K.r;break;case"b":b.v=!!de[1];break;case"e":b.v=de[1],l.cellText!==!1&&(b.w=Do[b.v]);break;case"str":b.t="s",b.v=de[1];break;case"is":b.t="s",b.v=de[1].t;break}if((w=o.CellXf[de[0].iStyleRef])&&_y(b,w.numFmtId,null,l,a,o),E=de[0].c==-1?E+1:de[0].c,l.dense?(m[A]||(m[A]=[]),m[A][E]=b):m[Xn(E)+Z]=b,l.cellFormula){for(W=!1,V=0;V<Q.length;++V){var J=Q[V];y.r>=J[0].s.r&&y.r<=J[0].e.r&&E>=J[0].s.c&&E<=J[0].e.c&&(b.F=zt(J[0]),W=!0)}!W&&de.length>3&&(b.f=de[3])}if(f.s.r>y.r&&(f.s.r=y.r),f.s.c>E&&(f.s.c=E),f.e.r<y.r&&(f.e.r=y.r),f.e.c<E&&(f.e.c=E),l.cellDates&&w&&b.t=="n"&&ul(Mt[w.numFmtId])){var ee=As(b.v);ee&&(b.t="d",b.v=new Date(ee.y,ee.m-1,ee.d,ee.H,ee.M,ee.S,ee.u))}Oe&&(Oe.type=="XLDAPR"&&(b.D=!0),Oe=void 0),Ze&&(Ze=void 0);break;case 1:case 12:if(!l.sheetStubs||x)break;b={t:"z",v:void 0},E=de[0].c==-1?E+1:de[0].c,l.dense?(m[A]||(m[A]=[]),m[A][E]=b):m[Xn(E)+Z]=b,f.s.r>y.r&&(f.s.r=y.r),f.s.c>E&&(f.s.c=E),f.e.r<y.r&&(f.e.r=y.r),f.e.c<E&&(f.e.c=E),Oe&&(Oe.type=="XLDAPR"&&(b.D=!0),Oe=void 0),Ze&&(Ze=void 0);break;case 176:S.push(de);break;case 49:Oe=((l.xlmeta||{}).Cell||[])[de-1];break;case 494:var ge=t["!id"][de.relId];for(ge?(de.Target=ge.Target,de.loc&&(de.Target+="#"+de.loc),de.Rel=ge):de.relId==""&&(de.Target="#"+de.loc),A=de.rfx.s.r;A<=de.rfx.e.r;++A)for(E=de.rfx.s.c;E<=de.rfx.e.c;++E)l.dense?(m[A]||(m[A]=[]),m[A][E]||(m[A][E]={t:"z",v:void 0}),m[A][E].l=de):(I=Pt({c:E,r:A}),m[I]||(m[I]={t:"z",v:void 0}),m[I].l=de);break;case 426:if(!l.cellFormula)break;Q.push(de),k=l.dense?m[A][E]:m[Xn(E)+Z],k.f=fr(de[1],f,{r:y.r,c:E},ae,l),k.F=zt(de[0]);break;case 427:if(!l.cellFormula)break;se[Pt(de[0].s)]=de[1],k=l.dense?m[A][E]:m[Xn(E)+Z],k.f=fr(de[1],f,{r:y.r,c:E},ae,l);break;case 60:if(!l.cellStyles)break;for(;de.e>=de.s;)Ne[de.e--]={width:de.w/256,hidden:!!(de.flags&1),level:de.level},Ve||(Ve=!0,tf(de.w/256)),cs(Ne[de.e+1]);break;case 161:m["!autofilter"]={ref:zt(de)};break;case 476:m["!margins"]=de;break;case 147:r.Sheets[n]||(r.Sheets[n]={}),de.name&&(r.Sheets[n].CodeName=de.name),(de.above||de.left)&&(m["!outline"]={above:de.above,left:de.left});break;case 137:r.Views||(r.Views=[{}]),r.Views[0]||(r.Views[0]={}),de.RTL&&(r.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:h.push(te),x=!0;break;case 38:h.pop(),x=!1;break;default:if(!X.T){if(!x||l.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},l),delete l.supbooks,delete l["!row"],!m["!ref"]&&(f.s.r<2e6||g&&(g.e.r>0||g.e.c>0||g.s.r>0||g.s.c>0))&&(m["!ref"]=zt(g||f)),l.sheetRows&&m["!ref"]){var Se=cn(m["!ref"]);l.sheetRows<=+Se.e.r&&(Se.e.r=l.sheetRows-1,Se.e.r>f.e.r&&(Se.e.r=f.e.r),Se.e.r<Se.s.r&&(Se.s.r=Se.e.r),Se.e.c>f.e.c&&(Se.e.c=f.e.c),Se.e.c<Se.s.c&&(Se.s.c=Se.e.c),m["!fullref"]=m["!ref"],m["!ref"]=zt(Se))}return S.length>0&&(m["!merges"]=S),Ne.length>0&&(m["!cols"]=Ne),Ce.length>0&&(m["!rows"]=Ce),m}function VR(e,i,n,t,r,a,o){if(i.v===void 0)return!1;var l="";switch(i.t){case"b":l=i.v?"1":"0";break;case"d":i=Vn(i),i.z=i.z||Mt[14],i.v=Di(Ln(i.v)),i.t="n";break;case"n":case"e":l=""+i.v;break;default:l=i.v;break}var m={r:n,c:t};switch(m.s=us(r.cellXfs,i,r),i.l&&a["!links"].push([Pt(m),i.l]),i.c&&a["!comments"].push([Pt(m),i.c]),i.t){case"s":case"str":return r.bookSST?(l=sf(r.Strings,i.v,r.revStrings),m.t="s",m.v=l,o?Ae(e,18,rR(i,m)):Ae(e,7,nR(i,m))):(m.t="str",o?Ae(e,17,hR(i,m)):Ae(e,6,pR(i,m))),!0;case"n":return i.v==(i.v|0)&&i.v>-1e3&&i.v<1e3?o?Ae(e,13,mR(i,m)):Ae(e,2,lR(i,m)):o?Ae(e,16,sR(i,m)):Ae(e,5,oR(i,m)),!0;case"b":return m.t="b",o?Ae(e,15,K9(i,m)):Ae(e,4,q9(i,m)),!0;case"e":return m.t="e",o?Ae(e,14,eR(i,m)):Ae(e,3,Q9(i,m)),!0}return o?Ae(e,12,G9(i,m)):Ae(e,1,Y9(i,m)),!0}function UR(e,i,n,t){var r=cn(i["!ref"]||"A1"),a,o="",l=[];Ae(e,145);var m=Array.isArray(i),g=r.e.r;i["!rows"]&&(g=Math.max(r.e.r,i["!rows"].length-1));for(var f=r.s.r;f<=g;++f){o=pi(f),N9(e,i,r,f);var h=!1;if(f<=r.e.r)for(var x=r.s.c;x<=r.e.c;++x){f===r.s.r&&(l[x]=Xn(x)),a=l[x]+o;var C=m?(i[f]||[])[x]:i[a];if(!C){h=!1;continue}h=VR(e,C,f,x,t,i,h)}}Ae(e,146)}function zR(e,i){!i||!i["!merges"]||(Ae(e,177,MR(i["!merges"].length)),i["!merges"].forEach(function(n){Ae(e,176,yR(n))}),Ae(e,178))}function jR(e,i){!i||!i["!cols"]||(Ae(e,390),i["!cols"].forEach(function(n,t){n&&Ae(e,60,TR(t,n))}),Ae(e,391))}function $R(e,i){!i||!i["!ref"]||(Ae(e,648),Ae(e,649,FR(cn(i["!ref"]))),Ae(e,650))}function YR(e,i,n){i["!links"].forEach(function(t){if(t[1].Target){var r=Pn(n,-1,t[1].Target.replace(/#.*$/,""),Wt.HLINK);Ae(e,494,OR(t,r))}}),delete i["!links"]}function WR(e,i,n,t){if(i["!comments"].length>0){var r=Pn(t,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Wt.VML);Ae(e,551,Hp("rId"+r)),i["!legacy"]=r}}function GR(e,i,n,t){if(i["!autofilter"]){var r=i["!autofilter"],a=typeof r.ref=="string"?r.ref:zt(r.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,l=$r(a);l.s.r==l.e.r&&(l.e.r=$r(i["!ref"]).e.r,a=zt(l));for(var m=0;m<o.length;++m){var g=o[m];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==t){g.Ref="'"+n.SheetNames[t]+"'!"+a;break}}m==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:t,Ref:"'"+n.SheetNames[t]+"'!"+a}),Ae(e,161,_l(cn(a))),Ae(e,162)}}function HR(e,i,n){Ae(e,133),Ae(e,137,DR(i,n)),Ae(e,138),Ae(e,134)}function qR(e,i){i["!protect"]&&Ae(e,535,RR(i["!protect"]))}function XR(e,i,n,t){var r=jr(),a=n.SheetNames[e],o=n.Sheets[a]||{},l=a;try{n&&n.Workbook&&(l=n.Workbook.Sheets[e].CodeName||l)}catch{}var m=cn(o["!ref"]||"A1");if(m.e.c>16383||m.e.r>1048575){if(i.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ae(r,129),(n.vbaraw||o["!outline"])&&Ae(r,147,j9(l,o["!outline"])),Ae(r,148,V9(m)),HR(r,o,n.Workbook),jR(r,o,e,i,n),UR(r,o,e,i,n),qR(r,o),GR(r,o,n,e),zR(r,o),YR(r,o,t),o["!margins"]&&Ae(r,476,IR(o["!margins"])),(!i||i.ignoreEC||i.ignoreEC==null)&&$R(r,o),WR(r,o,e,t),Ae(r,130),r.end()}function KR(e){var i=[],n=e.match(/^<c:numCache>/),t;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(i[+o[1]]=n?+o[2]:o[2])});var r=sn((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){t=a.replace(/<.*?>/g,"")}),[i,r,t]}function ZR(e,i,n,t,r,a){var o=a||{"!type":"chart"};if(!e)return a;var l=0,m=0,g="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var x=KR(h);f.s.r=f.s.c=0,f.e.c=l,g=Xn(l),x[0].forEach(function(C,y){o[g+pi(y)]={t:"n",v:C,z:x[1]},m=y}),f.e.r<m&&(f.e.r=m),++l}),l>0&&(o["!ref"]=zt(f)),o}function QR(e,i,n,t,r){if(!e)return e;t||(t={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(xy);return l&&cf(l[0],a,r,n),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),t["!id"][a["!rel"]]&&(a["!drawel"]=t["!id"][a["!rel"]]),a}function JR(e,i){e.l+=10;var n=Cr(e,i-10);return{name:n}}function eB(e,i,n,t,r){if(!e)return e;t||(t={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=[],l=!1;return Ao(e,function(g,f,h){switch(h){case 550:a["!rel"]=g;break;case 651:r.Sheets[n]||(r.Sheets[n]={}),g.name&&(r.Sheets[n].CodeName=g.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(h);break;case 38:o.pop();break;default:if(f.T>0)o.push(h);else if(f.T<0)o.pop();else if(!l||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}},i),t["!id"][a["!rel"]]&&(a["!drawel"]=t["!id"][a["!rel"]]),a}var lf=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],tB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],nB=[],iB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Sv(e,i){for(var n=0;n!=e.length;++n)for(var t=e[n],r=0;r!=i.length;++r){var a=i[r];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=Nn(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function kv(e,i){for(var n=0;n!=i.length;++n){var t=i[n];if(e[t[0]]==null)e[t[0]]=t[1];else switch(t[2]){case"bool":typeof e[t[0]]=="string"&&(e[t[0]]=Nn(e[t[0]]));break;case"int":typeof e[t[0]]=="string"&&(e[t[0]]=parseInt(e[t[0]],10));break}}}function yy(e){kv(e.WBProps,lf),kv(e.CalcPr,iB),Sv(e.WBView,tB),Sv(e.Sheets,nB),cl.date1904=Nn(e.WBProps.date1904)}function rB(e){return!e.Workbook||!e.Workbook.WBProps?"false":Nn(e.Workbook.WBProps.date1904)?"true":"false"}var aB="][*?/\\".split("");function My(e,i){if(e.length>31){if(i)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return aB.forEach(function(t){if(e.indexOf(t)!=-1){if(!i)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}function oB(e,i,n){e.forEach(function(t,r){My(t);for(var a=0;a<r;++a)if(t==e[a])throw new Error("Duplicate Sheet Name: "+t);if(n){var o=i&&i[r]&&i[r].CodeName||t;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function sB(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var i=e.Workbook&&e.Workbook.Sheets||[];oB(e.SheetNames,i,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)r9(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}var cB=/<\w+:workbook/;function lB(e,i){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},t=!1,r="xmlns",a={},o=0;if(e.replace(br,function(m,g){var f=kt(m);switch(ro(f[0])){case"<?xml":break;case"<workbook":m.match(cB)&&(r="xmlns"+m.match(/<(\w+):/)[1]),n.xmlns=f[r];break;case"</workbook>":break;case"<fileVersion":delete f[0],n.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":lf.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":n.WBProps[h[0]]=Nn(f[h[0]]);break;case"int":n.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:n.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(n.WBProps.CodeName=wn(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],n.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=sn(wn(f.name)),delete f[0],n.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":t=!0;break;case"</definedNames>":t=!1;break;case"<definedName":a={},a.Name=wn(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),Nn(f.hidden||"0")&&(a.Hidden=!0),o=g+m.length;break;case"</definedName>":a.Ref=sn(wn(e.slice(o,g))),n.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],n.CalcPr=f;break;case"<calcPr/>":delete f[0],n.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":t=!0;break;case"</ext>":t=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":t=!0;break;case"</AlternateContent>":t=!1;break;case"<revisionPtr":break;default:if(!t&&i.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return m}),$s.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return yy(n),n}function Py(e){var i=[fi];i[i.length]=Ye("workbook",null,{xmlns:$s[0],"xmlns:r":Ai.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,t={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(lf.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(t[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(t.codeName=e.Workbook.WBProps.CodeName,delete t.CodeName)),i[i.length]=Ye("workbookPr",null,t);var r=e.Workbook&&e.Workbook.Sheets||[],a=0;if(r&&r[0]&&r[0].Hidden){for(i[i.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!r[a]||!r[a].Hidden);++a);a==e.SheetNames.length&&(a=0),i[i.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',i[i.length]="</bookViews>"}for(i[i.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:On(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),r[a])switch(r[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}i[i.length]=Ye("sheet",null,o)}return i[i.length]="</sheets>",n&&(i[i.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var m={name:l.Name};l.Comment&&(m.comment=l.Comment),l.Sheet!=null&&(m.localSheetId=""+l.Sheet),l.Hidden&&(m.hidden="1"),l.Ref&&(i[i.length]=Ye("definedName",On(l.Ref),m))}),i[i.length]="</definedNames>"),i.length>2&&(i[i.length]="</workbook>",i[1]=i[1].replace("/>",">")),i.join("")}function dB(e,i){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=fp(e,i-8),n.name=Cr(e),n}function mB(e,i){return i||(i=Me(127)),i.write_shift(4,e.Hidden),i.write_shift(4,e.iTabID),Hp(e.strRelID,i),Hi(e.name.slice(0,31),i),i.length>i.l?i.slice(0,i.l):i}function gB(e,i){var n={},t=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var r=i>8?Cr(e):"";return r.length>0&&(n.CodeName=r),n.autoCompressPictures=!!(t&65536),n.backupFile=!!(t&64),n.checkCompatibility=!!(t&4096),n.date1904=!!(t&1),n.filterPrivacy=!!(t&8),n.hidePivotFieldList=!!(t&1024),n.promptedSolutions=!!(t&16),n.publishItems=!!(t&2048),n.refreshAllConnections=!!(t&262144),n.saveExternalLinkValues=!!(t&128),n.showBorderUnselectedTables=!!(t&4),n.showInkAnnotation=!!(t&32),n.showObjects=["all","placeholders","none"][t>>13&3],n.showPivotChartFilter=!!(t&32768),n.updateLinks=["userSet","never","always"][t>>8&3],n}function uB(e,i){i||(i=Me(72));var n=0;return e&&e.filterPrivacy&&(n|=8),i.write_shift(4,n),i.write_shift(4,0),fb(e&&e.CodeName||"ThisWorkbook",i),i.slice(0,i.l)}function pB(e,i){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=i-8,n}function fB(e,i,n){var t=e.l+i;e.l+=4,e.l+=1;var r=e.read_shift(4),a=W6(e),o=Q7(e,0,n),l=Gp(e);e.l=t;var m={Name:a,Ptg:o};return r<268435455&&(m.Sheet=r),l&&(m.Comment=l),m}function hB(e,i){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},t=[],r=!1;i||(i={}),i.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],bd[16]={n:"BrtFRTArchID$",f:pB},Ao(e,function(m,g,f){switch(f){case 156:o.SheetNames.push(m.name),n.Sheets.push(m);break;case 153:n.WBProps=m;break;case 39:m.Sheet!=null&&(i.SID=m.Sheet),m.Ref=fr(m.Ptg,null,null,o,i),delete i.SID,delete m.Ptg,a.push(m);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([f,m]):o[0]=[f,m],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(m),o.XTI=o.XTI.concat(m);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:t.push(f),r=!0;break;case 36:t.pop(),r=!1;break;case 37:t.push(f),r=!0;break;case 38:t.pop(),r=!1;break;case 16:break;default:if(!g.T){if(!r||i.WTF&&t[t.length-1]!=37&&t[t.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},i),yy(n),n.Names=a,n.supbooks=o,n}function _B(e,i){Ae(e,143);for(var n=0;n!=i.SheetNames.length;++n){var t=i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[n]&&i.Workbook.Sheets[n].Hidden||0,r={Hidden:t,iTabID:n+1,strRelID:"rId"+(n+1),name:i.SheetNames[n]};Ae(e,156,mB(r))}Ae(e,144)}function xB(e,i){i||(i=Me(127));for(var n=0;n!=4;++n)i.write_shift(4,0);return Hi("SheetJS",i),Hi(dd.version,i),Hi(dd.version,i),Hi("7262",i),i.length>i.l?i.slice(0,i.l):i}function CB(e,i){i||(i=Me(29)),i.write_shift(-4,0),i.write_shift(-4,460),i.write_shift(4,28800),i.write_shift(4,17600),i.write_shift(4,500),i.write_shift(4,e),i.write_shift(4,e);var n=120;return i.write_shift(1,n),i.length>i.l?i.slice(0,i.l):i}function vB(e,i){if(!(!i.Workbook||!i.Workbook.Sheets)){for(var n=i.Workbook.Sheets,t=0,r=-1,a=-1;t<n.length;++t)!n[t]||!n[t].Hidden&&r==-1?r=t:n[t].Hidden==1&&a==-1&&(a=t);a>r||(Ae(e,135),Ae(e,158,CB(r)),Ae(e,136))}}function bB(e,i){var n=jr();return Ae(n,131),Ae(n,128,xB()),Ae(n,153,uB(e.Workbook&&e.Workbook.WBProps||null)),vB(n,e,i),_B(n,e,i),Ae(n,132),n.end()}function yB(e,i,n){return i.slice(-4)===".bin"?hB(e,n):lB(e,n)}function MB(e,i,n,t,r,a,o,l){return i.slice(-4)===".bin"?LR(e,t,n,r,a,o,l):f9(e,t,n,r,a,o,l)}function PB(e,i,n,t,r,a,o,l){return i.slice(-4)===".bin"?eB(e,t,n,r,a,o,l):QR(e,t,n,r,a,o,l)}function OB(e,i,n,t,r,a,o,l){return i.slice(-4)===".bin"?SF(e,t,n,r,a,o,l):kF(e,t,n,r,a,o,l)}function wB(e,i,n,t,r,a,o,l){return i.slice(-4)===".bin"?OF(e,t,n,r,a,o,l):wF(e,t,n,r,a,o,l)}function SB(e,i,n,t){return i.slice(-4)===".bin"?yD(e,n,t):dD(e,n,t)}function kB(e,i,n){return ry(e,n)}function TB(e,i,n){return i.slice(-4)===".bin"?TA(e,n):wA(e,n)}function EB(e,i,n){return i.slice(-4)===".bin"?vF(e,n):mF(e,n)}function IB(e,i,n){return i.slice(-4)===".bin"?cF(e,i,n):oF(e,i,n)}function AB(e,i,n,t){return n.slice(-4)===".bin"?lF(e,i,n,t):void 0}function DB(e,i,n){return i.slice(-4)===".bin"?iF(e,i,n):aF(e,i,n)}function FB(e,i,n){return(i.slice(-4)===".bin"?bB:Py)(e,n)}function RB(e,i,n,t,r){return(i.slice(-4)===".bin"?XR:Cy)(e,n,t,r)}function BB(e,i,n){return(i.slice(-4)===".bin"?AD:ny)(e,n)}function NB(e,i,n){return(i.slice(-4)===".bin"?AA:qb)(e,n)}function LB(e,i,n){return(i.slice(-4)===".bin"?bF:sy)(e,n)}function VB(e){return(e.slice(-4)===".bin"?rF:ay)()}var Oy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ia(e,i){var n=e.split(/\s+/),t=[];if(i||(t[0]=n[0]),n.length===1)return t;var r=e.match(Oy),a,o,l,m;if(r)for(m=0;m!=r.length;++m)a=r[m].match(wy),(o=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),t[l]=a[2].slice(1,a[2].length-1));return t}function UB(e){var i=e.split(/\s+/),n={};if(i.length===1)return n;var t=e.match(Oy),r,a,o,l;if(t)for(l=0;l!=t.length;++l)r=t[l].match(wy),(a=r[1].indexOf(":"))===-1?n[r[1]]=r[2].slice(1,r[2].length-1):(r[1].slice(0,6)==="xmlns:"?o="xmlns"+r[1].slice(6):o=r[1].slice(a+1),n[o]=r[2].slice(1,r[2].length-1));return n}var cd;function zB(e,i){var n=cd[e]||sn(e);return n==="General"?Ns(i):va(n,i)}function jB(e,i,n,t){var r=t;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=Nn(t);break;case"i2":case"int":r=parseInt(t,10);break;case"r4":case"float":r=parseFloat(t);break;case"date":case"dateTime.tz":r=Ln(t);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[sn(i)]=r}function $B(e,i,n){if(e.t!=="z"){if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||Do[e.v]:i==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=gd(e.v):e.w=Ns(e.v):e.w=zB(i||"General",e.v)}catch(a){if(n.WTF)throw a}try{var t=cd[i]||i||"General";if(n.cellNF&&(e.z=t),n.cellDates&&e.t=="n"&&ul(t)){var r=As(e.v);r&&(e.t="d",e.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}catch(a){if(n.WTF)throw a}}}function YB(e,i,n){if(n.cellStyles&&i.Interior){var t=i.Interior;t.Pattern&&(t.patternType=nD[t.Pattern]||t.Pattern)}e[i.ID]=i}function WB(e,i,n,t,r,a,o,l,m,g){var f="General",h=t.StyleID,x={};g=g||{};var C=[],y=0;for(h===void 0&&l&&(h=l.StyleID),h===void 0&&o&&(h=o.StyleID);a[h]!==void 0&&(a[h].nf&&(f=a[h].nf),a[h].Interior&&C.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(n.Type){case"Boolean":t.t="b",t.v=Nn(e);break;case"String":t.t="s",t.r=WC(sn(e)),t.v=e.indexOf("<")>-1?sn(i||e).replace(/<.*?>/g,""):t.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),t.v=(Ln(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),t.v!==t.v?t.v=sn(e):t.v<60&&(t.v=t.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":t.v===void 0&&(t.v=+e),t.t||(t.t="n");break;case"Error":t.t="e",t.v=vb[e],g.cellText!==!1&&(t.w=e);break;default:e==""&&i==""?t.t="z":(t.t="s",t.v=WC(i||e));break}if($B(t,f,g),g.cellFormula!==!1)if(t.Formula){var b=sn(t.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),t.f=sl(b,r),delete t.Formula,t.ArrayRange=="RC"?t.F=sl("RC:RC",r):t.ArrayRange&&(t.F=sl(t.ArrayRange,r),m.push([cn(t.F),t.F]))}else for(y=0;y<m.length;++y)r.r>=m[y][0].s.r&&r.r<=m[y][0].e.r&&r.c>=m[y][0].s.c&&r.c<=m[y][0].e.c&&(t.F=m[y][1]);g.cellStyles&&(C.forEach(function(w){!x.patternType&&w.patternType&&(x.patternType=w.patternType)}),t.s=x),t.StyleID!==void 0&&(t.ixfe=t.StyleID)}function GB(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function cp(e,i){var n=i||{};pl();var t=Jl(Bp(e));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(typeof Cn<"u"?t=Cn.utils.decode(65001,up(t)):t=wn(t));var r=t.slice(0,1024).toLowerCase(),a=!1;if(r=r.replace(/".*?"/g,""),(r.indexOf(">")&1023)>Math.min(r.indexOf(",")&1023,r.indexOf(";")&1023)){var o=Vn(n);return o.type="string",ml.to_workbook(t,o)}if(r.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ft){r.indexOf("<"+Ft)>=0&&(a=!0)}),a)return IN(t,n);cd={"General Number":"General","General Date":Mt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Mt[15],"Short Date":Mt[14],"Long Time":Mt[19],"Medium Time":Mt[18],"Short Time":Mt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Mt[2],Standard:Mt[4],Percent:Mt[10],Scientific:Mt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,m=[],g;si!=null&&n.dense==null&&(n.dense=si);var f={},h=[],x=n.dense?[]:{},C="",y={},b={},w=Ia('<Data ss:Type="String">'),A=0,E=0,I=0,K={s:{r:2e6,c:2e6},e:{r:0,c:0}},Z={},k={},S="",V=0,W=[],Q={},se={},ae=0,ke=[],Ne=[],Ce={},Ve=[],Oe,Ze=!1,Se=[],Fe=[],de={},X=0,te=0,J={Sheets:[],WBProps:{date1904:!1}},ee={};fd.lastIndex=0,t=t.replace(/<!--([\s\S]*?)-->/mg,"");for(var ge="";l=fd.exec(t);)switch(l[3]=(ge=l[3]).toLowerCase()){case"data":if(ge=="data"){if(l[1]==="/"){if((g=m.pop())[0]!==l[3])throw new Error("Bad state: "+g.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&m.push([l[3],!0]);break}if(m[m.length-1][1])break;l[1]==="/"?WB(t.slice(A,l.index),S,w,m[m.length-1][0]=="comment"?Ce:y,{c:E,r:I},Z,Ve[E],b,Se,n):(S="",w=Ia(l[0]),A=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Ne.length>0&&(y.c=Ne),(!n.sheetRows||n.sheetRows>I)&&y.v!==void 0&&(n.dense?(x[I]||(x[I]=[]),x[I][E]=y):x[Xn(E)+pi(I)]=y),y.HRef&&(y.l={Target:sn(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(X=E+(parseInt(y.MergeAcross,10)|0),te=I+(parseInt(y.MergeDown,10)|0),W.push({s:{c:E,r:I},e:{c:X,r:te}})),!n.sheetStubs)y.MergeAcross?E=X+1:++E;else if(y.MergeAcross||y.MergeDown){for(var Te=E;Te<=X;++Te)for(var Ee=I;Ee<=te;++Ee)(Te>E||Ee>I)&&(n.dense?(x[Ee]||(x[Ee]=[]),x[Ee][Te]={t:"z"}):x[Xn(Te)+pi(Ee)]={t:"z"});E=X+1}else++E;else y=UB(l[0]),y.Index&&(E=+y.Index-1),E<K.s.c&&(K.s.c=E),E>K.e.c&&(K.e.c=E),l[0].slice(-2)==="/>"&&++E,Ne=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(I<K.s.r&&(K.s.r=I),I>K.e.r&&(K.e.r=I),l[0].slice(-2)==="/>"&&(b=Ia(l[0]),b.Index&&(I=+b.Index-1)),E=0,++I):(b=Ia(l[0]),b.Index&&(I=+b.Index-1),de={},(b.AutoFitHeight=="0"||b.Height)&&(de.hpx=parseInt(b.Height,10),de.hpt=vd(de.hpx),Fe[I]=de),b.Hidden=="1"&&(de.hidden=!0,Fe[I]=de));break;case"worksheet":if(l[1]==="/"){if((g=m.pop())[0]!==l[3])throw new Error("Bad state: "+g.join("|"));h.push(C),K.s.r<=K.e.r&&K.s.c<=K.e.c&&(x["!ref"]=zt(K),n.sheetRows&&n.sheetRows<=K.e.r&&(x["!fullref"]=x["!ref"],K.e.r=n.sheetRows-1,x["!ref"]=zt(K))),W.length&&(x["!merges"]=W),Ve.length>0&&(x["!cols"]=Ve),Fe.length>0&&(x["!rows"]=Fe),f[C]=x}else K={s:{r:2e6,c:2e6},e:{r:0,c:0}},I=E=0,m.push([l[3],!1]),g=Ia(l[0]),C=sn(g.Name),x=n.dense?[]:{},W=[],Se=[],Fe=[],ee={name:C,Hidden:0},J.Sheets.push(ee);break;case"table":if(l[1]==="/"){if((g=m.pop())[0]!==l[3])throw new Error("Bad state: "+g.join("|"))}else{if(l[0].slice(-2)=="/>")break;m.push([l[3],!1]),Ve=[],Ze=!1}break;case"style":l[1]==="/"?YB(Z,k,n):k=Ia(l[0]);break;case"numberformat":k.nf=sn(Ia(l[0]).Format||"General"),cd[k.nf]&&(k.nf=cd[k.nf]);for(var Pe=0;Pe!=392&&Mt[Pe]!=k.nf;++Pe);if(Pe==392){for(Pe=57;Pe!=392;++Pe)if(Mt[Pe]==null){ko(k.nf,Pe);break}}break;case"column":if(m[m.length-1][0]!=="table")break;if(Oe=Ia(l[0]),Oe.Hidden&&(Oe.hidden=!0,delete Oe.Hidden),Oe.Width&&(Oe.wpx=parseInt(Oe.Width,10)),!Ze&&Oe.wpx>10){Ze=!0,hr=ey;for(var ve=0;ve<Ve.length;++ve)Ve[ve]&&cs(Ve[ve])}Ze&&cs(Oe),Ve[Oe.Index-1||Ve.length]=Oe;for(var ot=0;ot<+Oe.Span;++ot)Ve[Ve.length]=Vn(Oe);break;case"namedrange":if(l[1]==="/")break;J.Names||(J.Names=[]);var H=kt(l[0]),mt={Name:H.Name,Ref:sl(H.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(mt.Sheet=J.Sheets.length-1),J.Names.push(mt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?S+=t.slice(V,l.index):V=l.index+l[0].length;break;case"interior":if(!n.cellStyles)break;k.Interior=Ia(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?h8(Q,ge,t.slice(ae,l.index)):ae=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((g=m.pop())[0]!==l[3])throw new Error("Bad state: "+g.join("|"))}else m.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((g=m.pop())[0]!==l[3])throw new Error("Bad state: "+g.join("|"));GB(Ce),Ne.push(Ce)}else m.push([l[3],!1]),g=Ia(l[0]),Ce={a:g.Author};break;case"autofilter":if(l[1]==="/"){if((g=m.pop())[0]!==l[3])throw new Error("Bad state: "+g.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Je=Ia(l[0]);x["!autofilter"]={ref:sl(Je.Range).replace(/\$/g,"")},m.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((g=m.pop())[0]!==l[3])throw new Error("Bad state: "+g.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&m.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((g=m.pop())[0]!==l[3])throw new Error("Bad state: "+g.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&m.push([l[3],!0]);break;case"null":break;default:if(m.length==0&&l[3]=="document"||m.length==0&&l[3]=="uof")return Dv(t,n);var Ot=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ot=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ot=!1}break;case"excelworkbook":switch(l[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ot=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ot=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(t.slice(ae,l.index)){case"SheetHidden":ee.Hidden=1;break;case"SheetVeryHidden":ee.Hidden=2;break}else ae=l.index+l[0].length;break;case"header":x["!margins"]||Bs(x["!margins"]={},"xlml"),isNaN(+kt(l[0]).Margin)||(x["!margins"].header=+kt(l[0]).Margin);break;case"footer":x["!margins"]||Bs(x["!margins"]={},"xlml"),isNaN(+kt(l[0]).Margin)||(x["!margins"].footer=+kt(l[0]).Margin);break;case"pagemargins":var nt=kt(l[0]);x["!margins"]||Bs(x["!margins"]={},"xlml"),isNaN(+nt.Top)||(x["!margins"].top=+nt.Top),isNaN(+nt.Left)||(x["!margins"].left=+nt.Left),isNaN(+nt.Right)||(x["!margins"].right=+nt.Right),isNaN(+nt.Bottom)||(x["!margins"].bottom=+nt.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ot=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ot=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ot=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ot=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ot=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ot=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ot=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ot=!1}break;case"smarttags":break;default:Ot=!1;break}if(Ot||l[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+m.join("|");if(m[m.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?jB(se,ge,ke,t.slice(ae,l.index)):(ke=l,ae=l.index+l[0].length);break}if(n.WTF)throw"Unrecognized tag: "+l[3]+"|"+m.join("|")}var Be={};return!n.bookSheets&&!n.bookProps&&(Be.Sheets=f),Be.SheetNames=h,Be.Workbook=J,Be.SSF=Vn(Mt),Be.Props=Q,Be.Custprops=se,Be}function yp(e,i){switch(mf(i=i||{}),i.type||"base64"){case"base64":return cp(ea(e),i);case"binary":case"buffer":case"file":return cp(e,i);case"array":return cp(ms(e),i)}}function HB(e,i){var n=[];return e.Props&&n.push(_8(e.Props,i)),e.Custprops&&n.push(x8(e.Props,e.Custprops,i)),n.join("")}function qB(){return""}function XB(e,i){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return i.cellXfs.forEach(function(t,r){var a=[];a.push(Ye("NumberFormat",null,{"ss:Format":On(Mt[t.numFmtId])}));var o={"ss:ID":"s"+(21+r)};n.push(Ye("Style",a.join(""),o))}),Ye("Styles",n.join(""))}function Sy(e){return Ye("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+af(e.Ref,{r:0,c:0})})}function KB(e){if(!((e||{}).Workbook||{}).Names)return"";for(var i=e.Workbook.Names,n=[],t=0;t<i.length;++t){var r=i[t];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||n.push(Sy(r)))}return Ye("Names",n.join(""))}function ZB(e,i,n,t){if(!e||!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,a=[],o=0;o<r.length;++o){var l=r[o];l.Sheet==n&&(l.Name.match(/^_xlfn\./)||a.push(Sy(l)))}return a.join("")}function QB(e,i,n,t){if(!e)return"";var r=[];if(e["!margins"]&&(r.push("<PageSetup>"),e["!margins"].header&&r.push(Ye("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&r.push(Ye("Footer",null,{"x:Margin":e["!margins"].footer})),r.push(Ye("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),r.push("</PageSetup>")),t&&t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n])if(t.Workbook.Sheets[n].Hidden)r.push(Ye("Visible",t.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<n&&!(t.Workbook.Sheets[a]&&!t.Workbook.Sheets[a].Hidden);++a);a==n&&r.push("<Selected/>")}return((((t||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),e["!protect"]&&(r.push(Qi("ProtectContents","True")),e["!protect"].objects&&r.push(Qi("ProtectObjects","True")),e["!protect"].scenarios&&r.push(Qi("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?r.push(Qi("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&r.push(Qi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&r.push("<"+o[1]+"/>")})),r.length==0?"":Ye("WorksheetOptions",r.join(""),{xmlns:Zr.x})}function JB(e){return e.map(function(i){var n=C6(i.t||""),t=Ye("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ye("Comment",t,{"ss:Author":i.a})}).join("")}function eN(e,i,n,t,r,a,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+On(af(e.f,o))),e.F&&e.F.slice(0,i.length)==i){var m=Kn(e.F.slice(i.length+1));l["ss:ArrayRange"]="RC:R"+(m.r==o.r?"":"["+(m.r-o.r)+"]")+"C"+(m.c==o.c?"":"["+(m.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=On(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=On(e.l.Tooltip))),n["!merges"])for(var g=n["!merges"],f=0;f!=g.length;++f)g[f].s.c!=o.c||g[f].s.r!=o.r||(g[f].e.c>g[f].s.c&&(l["ss:MergeAcross"]=g[f].e.c-g[f].s.c),g[f].e.r>g[f].s.r&&(l["ss:MergeDown"]=g[f].e.r-g[f].s.r));var h="",x="";switch(e.t){case"z":if(!t.sheetStubs)return"";break;case"n":h="Number",x=String(e.v);break;case"b":h="Boolean",x=e.v?"1":"0";break;case"e":h="Error",x=Do[e.v];break;case"d":h="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Mt[14]);break;case"s":h="String",x=x6(e.v||"");break}var C=us(t.cellXfs,e,t);l["ss:StyleID"]="s"+(21+C),l["ss:Index"]=o.c+1;var y=e.v!=null?x:"",b=e.t=="z"?"":'<Data ss:Type="'+h+'">'+y+"</Data>";return(e.c||[]).length>0&&(b+=JB(e.c)),Ye("Cell",b,l)}function tN(e,i){var n='<Row ss:Index="'+(e+1)+'"';return i&&(i.hpt&&!i.hpx&&(i.hpx=gl(i.hpt)),i.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+i.hpx+'"'),i.hidden&&(n+=' ss:Hidden="1"')),n+">"}function nN(e,i,n,t){if(!e["!ref"])return"";var r=cn(e["!ref"]),a=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(w,A){cs(w);var E=!!w.width,I=Vg(A,w),K={"ss:Index":A+1};E&&(K["ss:Width"]=xd(I.width)),w.hidden&&(K["ss:Hidden"]="1"),l.push(Ye("Column",null,K))});for(var m=Array.isArray(e),g=r.s.r;g<=r.e.r;++g){for(var f=[tN(g,(e["!rows"]||[])[g])],h=r.s.c;h<=r.e.c;++h){var x=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>h)&&!(a[o].s.r>g)&&!(a[o].e.c<h)&&!(a[o].e.r<g)){(a[o].s.c!=h||a[o].s.r!=g)&&(x=!0);break}if(!x){var C={r:g,c:h},y=Pt(C),b=m?(e[g]||[])[h]:e[y];f.push(eN(b,y,e,i,n,t,C))}}f.push("</Row>"),f.length>2&&l.push(f.join(""))}return l.join("")}function iN(e,i,n){var t=[],r=n.SheetNames[e],a=n.Sheets[r],o=a?ZB(a,i,e,n):"";return o.length>0&&t.push("<Names>"+o+"</Names>"),o=a?nN(a,i,e,n):"",o.length>0&&t.push("<Table>"+o+"</Table>"),t.push(QB(a,i,e,n)),t.join("")}function rN(e,i){i||(i={}),e.SSF||(e.SSF=Vn(Mt)),e.SSF&&(pl(),Ig(e.SSF),i.revssf=Dg(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF,i.cellXfs=[],us(i.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(HB(e,i)),n.push(qB(e,i)),n.push(""),n.push("");for(var t=0;t<e.SheetNames.length;++t)n.push(Ye("Worksheet",iN(t,i,e),{"ss:Name":On(e.SheetNames[t])}));return n[2]=XB(e,i),n[3]=KB(e,i),fi+Ye("Workbook",n.join(""),{xmlns:Zr.ss,"xmlns:o":Zr.o,"xmlns:x":Zr.x,"xmlns:ss":Zr.ss,"xmlns:dt":Zr.dt,"xmlns:html":Zr.html})}function aN(e){var i={},n=e.content;if(n.l=28,i.AnsiUserType=n.read_shift(0,"lpstr-ansi"),i.AnsiClipboardFormat=K6(n),n.length-n.l<=4)return i;var t=n.read_shift(4);if(t==0||t>40||(n.l-=4,i.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(t=n.read_shift(4),t!==1907505652)||(i.UnicodeClipboardFormat=Z6(n),t=n.read_shift(4),t==0||t>40))return i;n.l-=4,i.Reserved2=n.read_shift(0,"lpwstr")}var oN=[60,1084,2066,2165,2175];function sN(e,i,n,t,r){var a=t,o=[],l=n.slice(n.l,n.l+a);if(r&&r.enc&&r.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:r.enc.insitu(l)}o.push(l),n.l+=a;for(var m=wo(n,n.l),g=Mp[m],f=0;g!=null&&oN.indexOf(m)>-1;)a=wo(n,n.l+2),f=n.l+4,m==2066?f+=4:(m==2165||m==2175)&&(f+=12),l=n.slice(f,n.l+4+a),o.push(l),n.l+=4+a,g=Mp[m=wo(n,n.l)];var h=Gi(o);Zi(h,0);var x=0;h.lens=[];for(var C=0;C<o.length;++C)h.lens.push(x),x+=o[C].length;if(h.length<t)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+t;return i.f(h,h.length,r)}function Ja(e,i,n){if(e.t!=="z"&&e.XF){var t=0;try{t=e.z||e.XF.numFmtId||0,i.cellNF&&(e.z=Mt[t])}catch(a){if(i.WTF)throw a}if(!i||i.cellText!==!1)try{e.t==="e"?e.w=e.w||Do[e.v]:t===0||t=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=gd(e.v):e.w=Ns(e.v):e.w=va(t,e.v,{date1904:!!n,dateNF:i&&i.dateNF})}catch(a){if(i.WTF)throw a}if(i.cellDates&&t&&e.t=="n"&&ul(Mt[t]||String(t))){var r=As(e.v);r&&(e.t="d",e.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}}function fg(e,i,n){return{v:e,ixfe:i,t:n}}function cN(e,i){var n={opts:{}},t={};si!=null&&i.dense==null&&(i.dense=si);var r=i.dense?[]:{},a={},o={},l=null,m=[],g="",f={},h,x="",C,y,b,w,A={},E=[],I,K,Z=[],k=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},W=function(Ct){return Ct<8?Ds[Ct]:Ct<64&&k[Ct-8]||Ds[Ct]},Q=function(Ct,dn,Ei){var zn=dn.XF.data;if(!(!zn||!zn.patternType||!Ei||!Ei.cellStyles)){dn.s={},dn.s.patternType=zn.patternType;var Ir;(Ir=_d(W(zn.icvFore)))&&(dn.s.fgColor={rgb:Ir}),(Ir=_d(W(zn.icvBack)))&&(dn.s.bgColor={rgb:Ir})}},se=function(Ct,dn,Ei){if(!(de>1)&&!(Ei.sheetRows&&Ct.r>=Ei.sheetRows)){if(Ei.cellStyles&&dn.XF&&dn.XF.data&&Q(Ct,dn,Ei),delete dn.ixfe,delete dn.XF,h=Ct,x=Pt(Ct),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ct.r<o.s.r&&(o.s.r=Ct.r),Ct.c<o.s.c&&(o.s.c=Ct.c),Ct.r+1>o.e.r&&(o.e.r=Ct.r+1),Ct.c+1>o.e.c&&(o.e.c=Ct.c+1),Ei.cellFormula&&dn.f){for(var zn=0;zn<E.length;++zn)if(!(E[zn][0].s.c>Ct.c||E[zn][0].s.r>Ct.r)&&!(E[zn][0].e.c<Ct.c||E[zn][0].e.r<Ct.r)){dn.F=zt(E[zn][0]),(E[zn][0].s.c!=Ct.c||E[zn][0].s.r!=Ct.r)&&delete dn.f,dn.f&&(dn.f=""+fr(E[zn][1],o,Ct,Se,ae));break}}Ei.dense?(r[Ct.r]||(r[Ct.r]=[]),r[Ct.r][Ct.c]=dn):r[x]=dn}},ae={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!i&&!!i.cellStyles,WTF:!!i&&!!i.wtf};i.password&&(ae.password=i.password);var ke,Ne=[],Ce=[],Ve=[],Oe=[],Ze=!1,Se=[];Se.SheetNames=ae.snames,Se.sharedf=ae.sharedf,Se.arrayf=ae.arrayf,Se.names=[],Se.XTI=[];var Fe=0,de=0,X=0,te=[],J=[],ee;ae.codepage=1200,Aa(1200);for(var ge=!1;e.l<e.length-1;){var Te=e.l,Ee=e.read_shift(2);if(Ee===0&&Fe===10)break;var Pe=e.l===e.length?0:e.read_shift(2),ve=Mp[Ee];if(ve&&ve.f){if(i.bookSheets&&Fe===133&&Ee!==133)break;if(Fe=Ee,ve.r===2||ve.r==12){var ot=e.read_shift(2);if(Pe-=2,!ae.enc&&ot!==Ee&&((ot&255)<<8|ot>>8)!==Ee)throw new Error("rt mismatch: "+ot+"!="+Ee);ve.r==12&&(e.l+=10,Pe-=10)}var H={};if(Ee===10?H=ve.f(e,Pe,ae):H=sN(Ee,ve,e,Pe,ae),de==0&&[9,521,1033,2057].indexOf(Fe)===-1)continue;switch(Ee){case 34:n.opts.Date1904=S.WBProps.date1904=H;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(ae.enc||(e.l=0),ae.enc=H,!i.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:ae.lastuser=H;break;case 66:var mt=Number(H);switch(mt){case 21010:mt=1200;break;case 32768:mt=1e4;break;case 32769:mt=1252;break}Aa(ae.codepage=mt),ge=!0;break;case 317:ae.rrtabid=H;break;case 25:ae.winlocked=H;break;case 439:n.opts.RefreshAll=H;break;case 12:n.opts.CalcCount=H;break;case 16:n.opts.CalcDelta=H;break;case 17:n.opts.CalcIter=H;break;case 13:n.opts.CalcMode=H;break;case 14:n.opts.CalcPrecision=H;break;case 95:n.opts.CalcSaveRecalc=H;break;case 15:ae.CalcRefMode=H;break;case 2211:n.opts.FullCalc=H;break;case 129:H.fDialog&&(r["!type"]="dialog"),H.fBelow||((r["!outline"]||(r["!outline"]={})).above=!0),H.fRight||((r["!outline"]||(r["!outline"]={})).left=!0);break;case 224:Z.push(H);break;case 430:Se.push([H]),Se[Se.length-1].XTI=[];break;case 35:case 547:Se[Se.length-1].push(H);break;case 24:case 536:ee={Name:H.Name,Ref:fr(H.rgce,o,null,Se,ae)},H.itab>0&&(ee.Sheet=H.itab-1),Se.names.push(ee),Se[0]||(Se[0]=[],Se[0].XTI=[]),Se[Se.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(J[H.itab-1]={ref:zt(H.rgce[0][0][1][2])});break;case 22:ae.ExternCount=H;break;case 23:Se.length==0&&(Se[0]=[],Se[0].XTI=[]),Se[Se.length-1].XTI=Se[Se.length-1].XTI.concat(H),Se.XTI=Se.XTI.concat(H);break;case 2196:if(ae.biff<8)break;ee!=null&&(ee.Comment=H[1]);break;case 18:r["!protect"]=H;break;case 19:H!==0&&ae.WTF&&console.error("Password verifier: "+H);break;case 133:a[H.pos]=H,ae.snames.push(H.name);break;case 10:{if(--de)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,r["!ref"]=zt(o),i.sheetRows&&i.sheetRows<=o.e.r){var Je=o.e.r;o.e.r=i.sheetRows-1,r["!fullref"]=r["!ref"],r["!ref"]=zt(o),o.e.r=Je}o.e.r++,o.e.c++}Ne.length>0&&(r["!merges"]=Ne),Ce.length>0&&(r["!objects"]=Ce),Ve.length>0&&(r["!cols"]=Ve),Oe.length>0&&(r["!rows"]=Oe),S.Sheets.push(V)}g===""?f=r:t[g]=r,r=i.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ae.biff===8&&(ae.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),ae.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(ae.biff=5,ge=!0,Aa(ae.codepage=28591)),ae.biff==8&&H.BIFFVer==0&&H.dt==16&&(ae.biff=2),de++)break;if(r=i.dense?[]:{},ae.biff<8&&!ge&&(ge=!0,Aa(ae.codepage=i.codepage||1252)),ae.biff<5||H.BIFFVer==0&&H.dt==4096){g===""&&(g="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Ot={pos:e.l-Pe,name:g};a[Ot.pos]=Ot,ae.snames.push(g)}else g=(a[Te]||{name:""}).name;H.dt==32&&(r["!type"]="chart"),H.dt==64&&(r["!type"]="macro"),Ne=[],Ce=[],ae.arrayf=E=[],Ve=[],Oe=[],Ze=!1,V={Hidden:(a[Te]||{hs:0}).hs,name:g}}break;case 515:case 3:case 2:r["!type"]=="chart"&&(i.dense?(r[H.r]||[])[H.c]:r[Pt({c:H.c,r:H.r})])&&++H.c,I={ixfe:H.ixfe,XF:Z[H.ixfe]||{},v:H.val,t:"n"},X>0&&(I.z=te[I.ixfe>>8&63]),Ja(I,i,n.opts.Date1904),se({c:H.c,r:H.r},I,i);break;case 5:case 517:I={ixfe:H.ixfe,XF:Z[H.ixfe],v:H.val,t:H.t},X>0&&(I.z=te[I.ixfe>>8&63]),Ja(I,i,n.opts.Date1904),se({c:H.c,r:H.r},I,i);break;case 638:I={ixfe:H.ixfe,XF:Z[H.ixfe],v:H.rknum,t:"n"},X>0&&(I.z=te[I.ixfe>>8&63]),Ja(I,i,n.opts.Date1904),se({c:H.c,r:H.r},I,i);break;case 189:for(var nt=H.c;nt<=H.C;++nt){var Be=H.rkrec[nt-H.c][0];I={ixfe:Be,XF:Z[Be],v:H.rkrec[nt-H.c][1],t:"n"},X>0&&(I.z=te[I.ixfe>>8&63]),Ja(I,i,n.opts.Date1904),se({c:nt,r:H.r},I,i)}break;case 6:case 518:case 1030:{if(H.val=="String"){l=H;break}if(I=fg(H.val,H.cell.ixfe,H.tt),I.XF=Z[I.ixfe],i.cellFormula){var Ft=H.formula;if(Ft&&Ft[0]&&Ft[0][0]&&Ft[0][0][0]=="PtgExp"){var ln=Ft[0][0][1][0],In=Ft[0][0][1][1],qi=Pt({r:ln,c:In});A[qi]?I.f=""+fr(H.formula,o,H.cell,Se,ae):I.F=((i.dense?(r[ln]||[])[In]:r[qi])||{}).F}else I.f=""+fr(H.formula,o,H.cell,Se,ae)}X>0&&(I.z=te[I.ixfe>>8&63]),Ja(I,i,n.opts.Date1904),se(H.cell,I,i),l=H}break;case 7:case 519:if(l)l.val=H,I=fg(H,l.cell.ixfe,"s"),I.XF=Z[I.ixfe],i.cellFormula&&(I.f=""+fr(l.formula,o,l.cell,Se,ae)),X>0&&(I.z=te[I.ixfe>>8&63]),Ja(I,i,n.opts.Date1904),se(l.cell,I,i),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(H);var Un=Pt(H[0].s);if(C=i.dense?(r[H[0].s.r]||[])[H[0].s.c]:r[Un],i.cellFormula&&C){if(!l||!Un||!C)break;C.f=""+fr(H[1],o,H[0],Se,ae),C.F=zt(H[0])}}break;case 1212:{if(!i.cellFormula)break;if(x){if(!l)break;A[Pt(l.cell)]=H[0],C=i.dense?(r[l.cell.r]||[])[l.cell.c]:r[Pt(l.cell)],(C||{}).f=""+fr(H[0],o,h,Se,ae)}}break;case 253:I=fg(m[H.isst].t,H.ixfe,"s"),m[H.isst].h&&(I.h=m[H.isst].h),I.XF=Z[I.ixfe],X>0&&(I.z=te[I.ixfe>>8&63]),Ja(I,i,n.opts.Date1904),se({c:H.c,r:H.r},I,i);break;case 513:i.sheetStubs&&(I={ixfe:H.ixfe,XF:Z[H.ixfe],t:"z"},X>0&&(I.z=te[I.ixfe>>8&63]),Ja(I,i,n.opts.Date1904),se({c:H.c,r:H.r},I,i));break;case 190:if(i.sheetStubs)for(var Zn=H.c;Zn<=H.C;++Zn){var Et=H.ixfe[Zn-H.c];I={ixfe:Et,XF:Z[Et],t:"z"},X>0&&(I.z=te[I.ixfe>>8&63]),Ja(I,i,n.opts.Date1904),se({c:Zn,r:H.r},I,i)}break;case 214:case 516:case 4:I=fg(H.val,H.ixfe,"s"),I.XF=Z[I.ixfe],X>0&&(I.z=te[I.ixfe>>8&63]),Ja(I,i,n.opts.Date1904),se({c:H.c,r:H.r},I,i);break;case 0:case 512:de===1&&(o=H);break;case 252:m=H;break;case 1054:if(ae.biff==4){te[X++]=H[1];for(var Sn=0;Sn<X+163&&Mt[Sn]!=H[1];++Sn);Sn>=163&&ko(H[1],X+163)}else ko(H[1],H[0]);break;case 30:{te[X++]=H;for(var Qn=0;Qn<X+163&&Mt[Qn]!=H;++Qn);Qn>=163&&ko(H,X+163)}break;case 229:Ne=Ne.concat(H);break;case 93:Ce[H.cmo[0]]=ae.lastobj=H;break;case 438:ae.lastobj.TxO=H;break;case 127:ae.lastobj.ImData=H;break;case 440:for(w=H[0].s.r;w<=H[0].e.r;++w)for(b=H[0].s.c;b<=H[0].e.c;++b)C=i.dense?(r[w]||[])[b]:r[Pt({c:b,r:w})],C&&(C.l=H[1]);break;case 2048:for(w=H[0].s.r;w<=H[0].e.r;++w)for(b=H[0].s.c;b<=H[0].e.c;++b)C=i.dense?(r[w]||[])[b]:r[Pt({c:b,r:w})],C&&C.l&&(C.l.Tooltip=H[1]);break;case 28:{if(ae.biff<=5&&ae.biff>=2)break;C=i.dense?(r[H[0].r]||[])[H[0].c]:r[Pt(H[0])];var Er=Ce[H[2]];C||(i.dense?(r[H[0].r]||(r[H[0].r]=[]),C=r[H[0].r][H[0].c]={t:"z"}):C=r[Pt(H[0])]={t:"z"},o.e.r=Math.max(o.e.r,H[0].r),o.s.r=Math.min(o.s.r,H[0].r),o.e.c=Math.max(o.e.c,H[0].c),o.s.c=Math.min(o.s.c,H[0].c)),C.c||(C.c=[]),y={a:H[1],t:Er.TxO.t},C.c.push(y)}break;case 2173:XD(Z[H.ixfe],H.ext);break;case 125:{if(!ae.cellStyles)break;for(;H.e>=H.s;)Ve[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},Ze||(Ze=!0,tf(H.w/256)),cs(Ve[H.e+1])}break;case 520:{var Rt={};H.level!=null&&(Oe[H.r]=Rt,Rt.level=H.level),H.hidden&&(Oe[H.r]=Rt,Rt.hidden=!0),H.hpt&&(Oe[H.r]=Rt,Rt.hpt=H.hpt,Rt.hpx=gl(H.hpt))}break;case 38:case 39:case 40:case 41:r["!margins"]||Bs(r["!margins"]={}),r["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=H;break;case 161:r["!margins"]||Bs(r["!margins"]={}),r["!margins"].header=H.header,r["!margins"].footer=H.footer;break;case 574:H.RTL&&(S.Views[0].RTL=!0);break;case 146:k=H;break;case 2198:ke=H;break;case 140:K=H;break;case 442:g?V.CodeName=H||V.name:S.WBProps.CodeName=H||"ThisWorkbook";break}}else ve||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),e.l+=Pe}return n.SheetNames=ci(a).sort(function(hi,Ct){return Number(hi)-Number(Ct)}).map(function(hi){return a[hi].name}),i.bookSheets||(n.Sheets=t),!n.SheetNames.length&&f["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=f)):n.Preamble=f,n.Sheets&&J.forEach(function(hi,Ct){n.Sheets[n.SheetNames[Ct]]["!autofilter"]=hi}),n.Strings=m,n.SSF=Vn(Mt),ae.enc&&(n.Encryption=ae.enc),ke&&(n.Themes=ke),n.Metadata={},K!==void 0&&(n.Metadata.Country=K),Se.names.length>0&&(S.Names=Se.names),n.Workbook=S,n}var ld={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function lN(e,i,n){var t=_t.find(e,"/!DocumentSummaryInformation");if(t&&t.size>0)try{var r=lv(t,hp,ld.DSI);for(var a in r)i[a]=r[a]}catch(g){if(n.WTF)throw g}var o=_t.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=lv(o,_p,ld.SI);for(var m in l)i[m]==null&&(i[m]=l[m])}catch(g){if(n.WTF)throw g}i.HeadingPairs&&i.TitlesOfParts&&(wb(i.HeadingPairs,i.TitlesOfParts,i,n),delete i.HeadingPairs,delete i.TitlesOfParts)}function dN(e,i){var n=[],t=[],r=[],a=0,o,l=VC(hp,"n"),m=VC(_p,"n");if(e.Props)for(o=ci(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?n:Object.prototype.hasOwnProperty.call(m,o[a])?t:r).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=ci(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?n:Object.prototype.hasOwnProperty.call(m,o[a])?t:r).push([o[a],e.Custprops[o[a]]]);var g=[];for(a=0;a<r.length;++a)Db.indexOf(r[a][0])>-1||Ob.indexOf(r[a][0])>-1||r[a][1]!=null&&g.push(r[a]);t.length&&_t.utils.cfb_add(i,"/SummaryInformation",dv(t,ld.SI,m,_p)),(n.length||g.length)&&_t.utils.cfb_add(i,"/DocumentSummaryInformation",dv(n,ld.DSI,l,hp,g.length?g:null,ld.UDI))}function ky(e,i){i||(i={}),mf(i),Sp(),i.codepage&&wp(i.codepage);var n,t;if(e.FullPaths){if(_t.find(e,"/encryption"))throw new Error("File is password-protected");n=_t.find(e,"!CompObj"),t=_t.find(e,"/Workbook")||_t.find(e,"/Book")}else{switch(i.type){case"base64":e=Qr(ea(e));break;case"binary":e=Qr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Zi(e,0),t={content:e}}var r,a;if(n&&aN(n),i.bookProps&&!i.bookSheets)r={};else{var o=Zt?"buffer":"array";if(t&&t.content)r=cN(t.content,i);else if((a=_t.find(e,"PerfectOffice_MAIN"))&&a.content)r=Rs.to_workbook(a.content,(i.type=o,i));else if((a=_t.find(e,"NativeContent_MAIN"))&&a.content)r=Rs.to_workbook(a.content,(i.type=o,i));else throw(a=_t.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");i.bookVBA&&e.FullPaths&&_t.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=MF(e))}var l={};return e.FullPaths&&lN(e,l,i),r.Props=r.Custprops=l,i.bookFiles&&(r.cfb=e),r}function mN(e,i){var n=i||{},t=_t.utils.cfb_new({root:"R"}),r="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":r="/Workbook",n.biff=8;break;case"biff5":r="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return _t.utils.cfb_add(t,r,Ty(e,n)),n.biff==8&&(e.Props||e.Custprops)&&dN(e,t),n.biff==8&&e.vbaraw&&PF(t,_t.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),t}var bd={0:{f:R9},1:{f:$9},2:{f:cR},3:{f:Z9},4:{f:H9},5:{f:aR},6:{f:uR},7:{f:tR},8:{f:vR},9:{f:CR},10:{f:_R},11:{f:xR},12:{f:W9},13:{f:dR},14:{f:J9},15:{f:X9},16:{f:vy},17:{f:fR},18:{f:iR},19:{f:Wp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:fB},40:{},42:{},43:{f:uD},44:{f:mD},45:{f:hD},46:{f:xD},47:{f:_D},48:{},49:{f:L6},50:{},51:{f:QD},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Yb},62:{f:gR},63:{f:sF},64:{f:BR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:AR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:z9},148:{f:L9,p:16},151:{f:wR},152:{},153:{f:gB},154:{},155:{},156:{f:dB},157:{},158:{},159:{T:1,f:kA},160:{T:-1},161:{T:1,f:Hs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:bR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:KD},336:{T:-1},337:{f:tF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:fp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$b},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:SR},427:{f:kR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:ER},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:U9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:PR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:fp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:xF},633:{T:1},634:{T:-1},635:{T:1,f:hF},636:{T:-1},637:{f:j6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:JR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:NR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Mp={6:{f:op},10:{f:rs},12:{f:Ti},13:{f:Ti},14:{f:ui},15:{f:ui},16:{f:_r},17:{f:ui},18:{f:ui},19:{f:Ti},20:{f:hv},21:{f:hv},23:{f:$b},24:{f:xv},25:{f:ui},26:{},27:{},28:{f:NI},29:{},34:{f:ui},35:{f:_v},38:{f:_r},39:{f:_r},40:{f:_r},41:{f:_r},42:{f:ui},43:{f:ui},47:{f:XA},49:{f:dI},51:{f:Ti},60:{},61:{f:aI},64:{f:ui},65:{f:lI},66:{f:Ti},77:{},80:{},81:{},82:{},85:{f:Ti},89:{},90:{},91:{},92:{f:q8},93:{f:UI},94:{},95:{f:ui},96:{},97:{},99:{f:ui},125:{f:Yb},128:{f:OI},129:{f:K8},130:{f:Ti},131:{f:ui},132:{f:ui},133:{f:Z8},134:{},140:{f:qI},141:{f:Ti},144:{},146:{f:ZI},151:{},152:{},153:{},154:{},155:{},156:{f:Ti},157:{},158:{},160:{f:rA},161:{f:eA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:bI},190:{f:yI},193:{f:rs},197:{},198:{},199:{},200:{},201:{},202:{f:ui},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ti},220:{},221:{f:ui},222:{},224:{f:PI},225:{f:H8},226:{f:rs},227:{},229:{f:LI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:J8},253:{f:gI},255:{f:tI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Fb},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ui},353:{f:rs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:EI},431:{f:ui},432:{},433:{},434:{},437:{},438:{f:$I},439:{f:ui},440:{f:YI},441:{},442:{f:wd},443:{},444:{f:Ti},445:{},446:{},448:{f:rs},449:{f:rI,r:2},450:{f:rs},512:{f:uv},513:{f:iA},515:{f:kI},516:{f:pI},517:{f:fv},519:{f:aA},520:{f:nI},523:{},545:{f:Cv},549:{f:gv},566:{},574:{f:sI},638:{f:vI},659:{},1048:{},1054:{f:hI},1084:{},1212:{f:FI},2048:{f:GI},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:gg},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:rs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:QI,r:12},2173:{f:qD,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ui,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:DI,r:12},2197:{},2198:{f:jD,r:12},2199:{},2200:{},2201:{},2202:{f:RI,r:12},2203:{f:rs},2204:{},2205:{},2206:{},2207:{},2211:{f:iI},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ti},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:tA},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:KI},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:uv},1:{},2:{f:dA},3:{f:cA},4:{f:sA},5:{f:fv},7:{f:gA},8:{},9:{f:gg},11:{},22:{f:Ti},30:{f:xI},31:{},32:{},33:{f:Cv},36:{},37:{f:gv},50:{f:uA},62:{},52:{},67:{},68:{f:Ti},69:{},86:{},126:{},127:{f:oA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:pA},223:{},234:{},354:{},421:{},518:{f:op},521:{f:gg},536:{f:xv},547:{f:_v},561:{},579:{},1030:{f:op},1033:{f:gg},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Xe(e,i,n,t){var r=i;if(!isNaN(r)){var a=t||(n||[]).length||0,o=e.next(4);o.write_shift(2,r),o.write_shift(2,a),a>0&&jp(n)&&e.push(n)}}function gN(e,i,n,t){var r=t||(n||[]).length||0;if(r<=8224)return Xe(e,i,n,r);var a=i;if(!isNaN(a)){for(var o=n.parts||[],l=0,m=0,g=0;g+(o[l]||8224)<=8224;)g+=o[l]||8224,l++;var f=e.next(4);for(f.write_shift(2,a),f.write_shift(2,g),e.push(n.slice(m,m+g)),m+=g;m<r;){for(f=e.next(4),f.write_shift(2,60),g=0;g+(o[l]||8224)<=8224;)g+=o[l]||8224,l++;f.write_shift(2,g),e.push(n.slice(m,m+g)),m+=g}}}function Ed(e,i,n){return e||(e=Me(7)),e.write_shift(2,i),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function uN(e,i,n,t){var r=Me(9);return Ed(r,e,i),Rb(n,t||"b",r),r}function pN(e,i,n){var t=Me(8+2*n.length);return Ed(t,e,i),t.write_shift(1,n.length),t.write_shift(n.length,n,"sbcs"),t.l<t.length?t.slice(0,t.l):t}function fN(e,i,n,t){if(i.v!=null)switch(i.t){case"d":case"n":var r=i.t=="d"?Di(Ln(i.v)):i.v;r==(r|0)&&r>=0&&r<65536?Xe(e,2,mA(n,t,r)):Xe(e,3,lA(n,t,r));return;case"b":case"e":Xe(e,5,uN(n,t,i.v,i.t));return;case"s":case"str":Xe(e,4,pN(n,t,(i.v||"").slice(0,255)));return}Xe(e,1,Ed(null,n,t))}function hN(e,i,n,t){var r=Array.isArray(i),a=cn(i["!ref"]||"A1"),o,l="",m=[];if(a.e.c>255||a.e.r>16383){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=zt(a)}for(var g=a.s.r;g<=a.e.r;++g){l=pi(g);for(var f=a.s.c;f<=a.e.c;++f){g===a.s.r&&(m[f]=Xn(f)),o=m[f]+l;var h=r?(i[g]||[])[f]:i[o];h&&fN(e,h,g,f,t)}}}function _N(e,i){var n=i||{};si!=null&&n.dense==null&&(n.dense=si);for(var t=jr(),r=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==n.sheet&&(r=a);if(r==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Xe(t,n.biff==4?1033:n.biff==3?521:9,Qp(e,16,n)),hN(t,e.Sheets[e.SheetNames[r]],r,n,e),Xe(t,10),t.end()}function xN(e,i,n){Xe(e,49,mI({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function CN(e,i,n){i&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)i[r]!=null&&Xe(e,1054,_I(r,i[r],n))})}function vN(e,i){var n=Me(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Xe(e,2151,n),n=Me(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),Ub(cn(i["!ref"]||"A1"),n),n.write_shift(4,4),Xe(e,2152,n)}function bN(e,i){for(var n=0;n<16;++n)Xe(e,224,pv({numFmtId:0,style:!0},0,i));i.cellXfs.forEach(function(t){Xe(e,224,pv(t,0,i))})}function yN(e,i){for(var n=0;n<i["!links"].length;++n){var t=i["!links"][n];Xe(e,440,WI(t)),t[1].Tooltip&&Xe(e,2048,HI(t))}delete i["!links"]}function MN(e,i){if(i){var n=0;i.forEach(function(t,r){++n<=256&&t&&Xe(e,125,JI(Vg(r,t),r))})}}function PN(e,i,n,t,r){var a=16+us(r.cellXfs,i,r);if(i.v==null&&!i.bf){Xe(e,513,zs(n,t,a));return}if(i.bf)Xe(e,6,K7(i,n,t,r,a));else switch(i.t){case"d":case"n":var o=i.t=="d"?Di(Ln(i.v)):i.v;Xe(e,515,TI(n,t,o,a,r));break;case"b":case"e":Xe(e,517,SI(n,t,i.v,a,r,i.t));break;case"s":case"str":if(r.bookSST){var l=sf(r.Strings,i.v,r.revStrings);Xe(e,253,uI(n,t,l,a,r))}else Xe(e,516,fI(n,t,(i.v||"").slice(0,255),a,r));break;default:Xe(e,513,zs(n,t,a))}}function ON(e,i,n){var t=jr(),r=n.SheetNames[e],a=n.Sheets[r]||{},o=(n||{}).Workbook||{},l=(o.Sheets||[])[e]||{},m=Array.isArray(a),g=i.biff==8,f,h="",x=[],C=cn(a["!ref"]||"A1"),y=g?65536:16384;if(C.e.c>255||C.e.r>=y){if(i.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");C.e.c=Math.min(C.e.c,255),C.e.r=Math.min(C.e.c,y-1)}Xe(t,2057,Qp(n,16,i)),Xe(t,13,xa(1)),Xe(t,12,xa(100)),Xe(t,15,Tr(!0)),Xe(t,17,Tr(!1)),Xe(t,16,Vs(.001)),Xe(t,95,Tr(!0)),Xe(t,42,Tr(!1)),Xe(t,43,Tr(!1)),Xe(t,130,xa(1)),Xe(t,128,wI([0,0])),Xe(t,131,Tr(!1)),Xe(t,132,Tr(!1)),g&&MN(t,a["!cols"]),Xe(t,512,CI(C,i)),g&&(a["!links"]=[]);for(var b=C.s.r;b<=C.e.r;++b){h=pi(b);for(var w=C.s.c;w<=C.e.c;++w){b===C.s.r&&(x[w]=Xn(w)),f=x[w]+h;var A=m?(a[b]||[])[w]:a[f];A&&(PN(t,A,b,w,i),g&&A.l&&a["!links"].push([f,A.l]))}}var E=l.CodeName||l.name||r;return g&&Xe(t,574,cI((o.Views||[])[0])),g&&(a["!merges"]||[]).length&&Xe(t,229,VI(a["!merges"])),g&&yN(t,a),Xe(t,442,Bb(E,i)),g&&vN(t,a),Xe(t,10),t.end()}function wN(e,i,n){var t=jr(),r=(e||{}).Workbook||{},a=r.Sheets||[],o=r.WBProps||{},l=n.biff==8,m=n.biff==5;if(Xe(t,2057,Qp(e,5,n)),n.bookType=="xla"&&Xe(t,135),Xe(t,225,l?xa(1200):null),Xe(t,193,S8(2)),m&&Xe(t,191),m&&Xe(t,192),Xe(t,226),Xe(t,92,X8("SheetJS",n)),Xe(t,66,xa(l?1200:1252)),l&&Xe(t,353,xa(0)),l&&Xe(t,448),Xe(t,317,nA(e.SheetNames.length)),l&&e.vbaraw&&Xe(t,211),l&&e.vbaraw){var g=o.CodeName||"ThisWorkbook";Xe(t,442,Bb(g,n))}Xe(t,156,xa(17)),Xe(t,25,Tr(!1)),Xe(t,18,Tr(!1)),Xe(t,19,xa(0)),l&&Xe(t,431,Tr(!1)),l&&Xe(t,444,xa(0)),Xe(t,61,oI(n)),Xe(t,64,Tr(!1)),Xe(t,141,xa(0)),Xe(t,34,Tr(rB(e)=="true")),Xe(t,14,Tr(!0)),l&&Xe(t,439,Tr(!1)),Xe(t,218,xa(0)),xN(t,e,n),CN(t,e.SSF,n),bN(t,n),l&&Xe(t,352,Tr(!1));var f=t.end(),h=jr();l&&Xe(h,140,XI()),l&&n.Strings&&gN(h,252,eI(n.Strings,n)),Xe(h,10);var x=h.end(),C=jr(),y=0,b=0;for(b=0;b<e.SheetNames.length;++b)y+=(l?12:11)+(l?2:1)*e.SheetNames[b].length;var w=f.length+y+x.length;for(b=0;b<e.SheetNames.length;++b){var A=a[b]||{};Xe(C,133,Q8({pos:w,hs:A.Hidden||0,dt:0,name:e.SheetNames[b]},n)),w+=i[b].length}var E=C.end();if(y!=E.length)throw new Error("BS8 "+y+" != "+E.length);var I=[];return f.length&&I.push(f),E.length&&I.push(E),x.length&&I.push(x),Gi(I)}function SN(e,i){var n=i||{},t=[];e&&!e.SSF&&(e.SSF=Vn(Mt)),e&&e.SSF&&(pl(),Ig(e.SSF),n.revssf=Dg(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,gf(n),n.cellXfs=[],us(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var r=0;r<e.SheetNames.length;++r)t[t.length]=ON(r,n,e);return t.unshift(wN(e,t,n)),Gi(t)}function Ty(e,i){for(var n=0;n<=e.SheetNames.length;++n){var t=e.Sheets[e.SheetNames[n]];if(!(!t||!t["!ref"])){var r=$r(t["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var a=i||{};switch(a.biff||2){case 8:case 5:return SN(e,i);case 4:case 3:case 2:return _N(e,i)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Tv(e,i){var n=i||{};si!=null&&n.dense==null&&(n.dense=si);var t=n.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var r=e.match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=r.index,l=a&&a.index||e.length,m=m6(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),g=-1,f=0,h=0,x=0,C={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(o=0;o<m.length;++o){var b=m[o].trim(),w=b.slice(0,3).toLowerCase();if(w=="<tr"){if(++g,n.sheetRows&&n.sheetRows<=g){--g;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var A=b.split(/<\/t[dh]>/i);for(l=0;l<A.length;++l){var E=A[l].trim();if(E.match(/<t[dh]/i)){for(var I=E,K=0;I.charAt(0)=="<"&&(K=I.indexOf(">"))>-1;)I=I.slice(K+1);for(var Z=0;Z<y.length;++Z){var k=y[Z];k.s.c==f&&k.s.r<g&&g<=k.e.r&&(f=k.e.c+1,Z=-1)}var S=kt(E.slice(0,E.indexOf(">")));x=S.colspan?+S.colspan:1,((h=+S.rowspan)>1||x>1)&&y.push({s:{r:g,c:f},e:{r:g+(h||1)-1,c:f+x-1}});var V=S.t||S["data-t"]||"";if(!I.length){f+=x;continue}if(I=rb(I),C.s.r>g&&(C.s.r=g),C.e.r<g&&(C.e.r=g),C.s.c>f&&(C.s.c=f),C.e.c<f&&(C.e.c=f),!I.length){f+=x;continue}var W={t:"s",v:I};n.raw||!I.trim().length||V=="s"||(I==="TRUE"?W={t:"b",v:!0}:I==="FALSE"?W={t:"b",v:!1}:isNaN(Fa(I))?isNaN(dl(I).getDate())||(W={t:"d",v:Ln(I)},n.cellDates||(W={t:"n",v:Di(W.v)}),W.z=n.dateNF||Mt[14]):W={t:"n",v:Fa(I)}),n.dense?(t[g]||(t[g]=[]),t[g][f]=W):t[Pt({r:g,c:f})]=W,f+=x}}}}return t["!ref"]=zt(C),y.length&&(t["!merges"]=y),t}function kN(e,i,n,t){for(var r=e["!merges"]||[],a=[],o=i.s.c;o<=i.e.c;++o){for(var l=0,m=0,g=0;g<r.length;++g)if(!(r[g].s.r>n||r[g].s.c>o)&&!(r[g].e.r<n||r[g].e.c<o)){if(r[g].s.r<n||r[g].s.c<o){l=-1;break}l=r[g].e.r-r[g].s.r+1,m=r[g].e.c-r[g].s.c+1;break}if(!(l<0)){var f=Pt({r:n,c:o}),h=t.dense?(e[n]||[])[o]:e[f],x=h&&h.v!=null&&(h.h||Rp(h.w||(Eo(h),h.w)||""))||"",C={};l>1&&(C.rowspan=l),m>1&&(C.colspan=m),t.editable?x='<span contenteditable="true">'+x+"</span>":h&&(C["data-t"]=h&&h.t||"z",h.v!=null&&(C["data-v"]=h.v),h.z!=null&&(C["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+h.l.Target+'">'+x+"</a>")),C.id=(t.id||"sjs")+"-"+f,a.push(Ye("td",x,C))}}var y="<tr>";return y+a.join("")+"</tr>"}var TN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',EN="</body></html>";function IN(e,i){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return gs(Tv(n[0],i),i);var t=hf();return n.forEach(function(r,a){_f(t,Tv(r,i),"Sheet"+(a+1))}),t}function AN(e,i,n){var t=[];return t.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Ey(e,i){var n=i||{},t=n.header!=null?n.header:TN,r=n.footer!=null?n.footer:EN,a=[t],o=$r(e["!ref"]);n.dense=Array.isArray(e),a.push(AN(e,o,n));for(var l=o.s.r;l<=o.e.r;++l)a.push(kN(e,o,l,n));return a.push("</table>"+r),a.join("")}function Iy(e,i,n){var t=n||{};si!=null&&(t.dense=si);var r=0,a=0;if(t.origin!=null)if(typeof t.origin=="number")r=t.origin;else{var o=typeof t.origin=="string"?Kn(t.origin):t.origin;r=o.r,a=o.c}var l=i.getElementsByTagName("tr"),m=Math.min(t.sheetRows||1e7,l.length),g={s:{r:0,c:0},e:{r,c:a}};if(e["!ref"]){var f=$r(e["!ref"]);g.s.r=Math.min(g.s.r,f.s.r),g.s.c=Math.min(g.s.c,f.s.c),g.e.r=Math.max(g.e.r,f.e.r),g.e.c=Math.max(g.e.c,f.e.c),r==-1&&(g.e.r=r=f.e.r+1)}var h=[],x=0,C=e["!rows"]||(e["!rows"]=[]),y=0,b=0,w=0,A=0,E=0,I=0;for(e["!cols"]||(e["!cols"]=[]);y<l.length&&b<m;++y){var K=l[y];if(Ev(K)){if(t.display)continue;C[b]={hidden:!0}}var Z=K.children;for(w=A=0;w<Z.length;++w){var k=Z[w];if(!(t.display&&Ev(k))){var S=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):rb(k.innerHTML),V=k.getAttribute("data-z")||k.getAttribute("z");for(x=0;x<h.length;++x){var W=h[x];W.s.c==A+a&&W.s.r<b+r&&b+r<=W.e.r&&(A=W.e.c+1-a,x=-1)}I=+k.getAttribute("colspan")||1,((E=+k.getAttribute("rowspan")||1)>1||I>1)&&h.push({s:{r:b+r,c:A+a},e:{r:b+r+(E||1)-1,c:A+a+(I||1)-1}});var Q={t:"s",v:S},se=k.getAttribute("data-t")||k.getAttribute("t")||"";S!=null&&(S.length==0?Q.t=se||"z":t.raw||S.trim().length==0||se=="s"||(S==="TRUE"?Q={t:"b",v:!0}:S==="FALSE"?Q={t:"b",v:!1}:isNaN(Fa(S))?isNaN(dl(S).getDate())||(Q={t:"d",v:Ln(S)},t.cellDates||(Q={t:"n",v:Di(Q.v)}),Q.z=t.dateNF||Mt[14]):Q={t:"n",v:Fa(S)})),Q.z===void 0&&V!=null&&(Q.z=V);var ae="",ke=k.getElementsByTagName("A");if(ke&&ke.length)for(var Ne=0;Ne<ke.length&&!(ke[Ne].hasAttribute("href")&&(ae=ke[Ne].getAttribute("href"),ae.charAt(0)!="#"));++Ne);ae&&ae.charAt(0)!="#"&&(Q.l={Target:ae}),t.dense?(e[b+r]||(e[b+r]=[]),e[b+r][A+a]=Q):e[Pt({c:A+a,r:b+r})]=Q,g.e.c<A+a&&(g.e.c=A+a),A+=I}}++b}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),g.e.r=Math.max(g.e.r,b-1+r),e["!ref"]=zt(g),b>=m&&(e["!fullref"]=zt((g.e.r=l.length-y+b-1+r,g))),e}function Ay(e,i){var n=i||{},t=n.dense?[]:{};return Iy(t,e,i)}function DN(e,i){return gs(Ay(e,i),i)}function Ev(e){var i="",n=FN(e);return n&&(i=n(e).getPropertyValue("display")),i||(i=e.style&&e.style.display),i==="none"}function FN(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function RN(e){var i=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(t,r){return Array(parseInt(r,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=sn(i.replace(/<[^>]*>/g,""));return[n]}var Iv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Dy(e,i){var n=i||{};si!=null&&n.dense==null&&(n.dense=si);var t=Bp(e),r=[],a,o,l={name:""},m="",g=0,f,h,x={},C=[],y=n.dense?[]:{},b,w,A={value:""},E="",I=0,K,Z=[],k=-1,S=-1,V={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,Q={},se=[],ae={},ke=0,Ne=0,Ce=[],Ve=1,Oe=1,Ze=[],Se={Names:[]},Fe={},de=["",""],X=[],te={},J="",ee=0,ge=!1,Te=!1,Ee=0;for(fd.lastIndex=0,t=t.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=fd.exec(t);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":b[1]==="/"?(V.e.c>=V.s.c&&V.e.r>=V.s.r?y["!ref"]=zt(V):y["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=V.e.r&&(y["!fullref"]=y["!ref"],V.e.r=n.sheetRows-1,y["!ref"]=zt(V)),se.length&&(y["!merges"]=se),Ce.length&&(y["!rows"]=Ce),f.name=f.\u540D\u79F0||f.name,typeof JSON<"u"&&JSON.stringify(f),C.push(f.name),x[f.name]=y,Te=!1):b[0].charAt(b[0].length-2)!=="/"&&(f=kt(b[0],!1),k=S=-1,V.s.r=V.s.c=1e7,V.e.r=V.e.c=0,y=n.dense?[]:{},se=[],Ce=[],Te=!0);break;case"table-row-group":b[1]==="/"?--W:++W;break;case"table-row":case"\u884C":if(b[1]==="/"){k+=Ve,Ve=1;break}if(h=kt(b[0],!1),h.\u884C\u53F7?k=h.\u884C\u53F7-1:k==-1&&(k=0),Ve=+h["number-rows-repeated"]||1,Ve<10)for(Ee=0;Ee<Ve;++Ee)W>0&&(Ce[k+Ee]={level:W});S=-1;break;case"covered-table-cell":b[1]!=="/"&&++S,n.sheetStubs&&(n.dense?(y[k]||(y[k]=[]),y[k][S]={t:"z"}):y[Pt({r:k,c:S})]={t:"z"}),E="",Z=[];break;case"table-cell":case"\u6570\u636E":if(b[0].charAt(b[0].length-2)==="/")++S,A=kt(b[0],!1),Oe=parseInt(A["number-columns-repeated"]||"1",10),w={t:"z",v:null},A.formula&&n.cellFormula!=!1&&(w.f=wv(sn(A.formula))),(A.\u6570\u636E\u7C7B\u578B||A["value-type"])=="string"&&(w.t="s",w.v=sn(A["string-value"]||""),n.dense?(y[k]||(y[k]=[]),y[k][S]=w):y[Pt({r:k,c:S})]=w),S+=Oe-1;else if(b[1]!=="/"){++S,E="",I=0,Z=[],Oe=1;var Pe=Ve?k+Ve-1:k;if(S>V.e.c&&(V.e.c=S),S<V.s.c&&(V.s.c=S),k<V.s.r&&(V.s.r=k),Pe>V.e.r&&(V.e.r=Pe),A=kt(b[0],!1),X=[],te={},w={t:A.\u6570\u636E\u7C7B\u578B||A["value-type"],v:null},n.cellFormula)if(A.formula&&(A.formula=sn(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(ke=parseInt(A["number-matrix-rows-spanned"],10)||0,Ne=parseInt(A["number-matrix-columns-spanned"],10)||0,ae={s:{r:k,c:S},e:{r:k+ke-1,c:S+Ne-1}},w.F=zt(ae),Ze.push([ae,w.F])),A.formula)w.f=wv(A.formula);else for(Ee=0;Ee<Ze.length;++Ee)k>=Ze[Ee][0].s.r&&k<=Ze[Ee][0].e.r&&S>=Ze[Ee][0].s.c&&S<=Ze[Ee][0].e.c&&(w.F=Ze[Ee][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(ke=parseInt(A["number-rows-spanned"],10)||0,Ne=parseInt(A["number-columns-spanned"],10)||0,ae={s:{r:k,c:S},e:{r:k+ke-1,c:S+Ne-1}},se.push(ae)),A["number-columns-repeated"]&&(Oe=parseInt(A["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Nn(A["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(A.value);break;case"percentage":w.t="n",w.v=parseFloat(A.value);break;case"currency":w.t="n",w.v=parseFloat(A.value);break;case"date":w.t="d",w.v=Ln(A["date-value"]),n.cellDates||(w.t="n",w.v=Di(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=c6(A["time-value"])/86400,n.cellDates&&(w.t="d",w.v=Fg(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(A.\u6570\u636E\u6570\u503C);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",A["string-value"]!=null&&(E=sn(A["string-value"]),Z=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(ge=!1,w.t==="s"&&(w.v=E||"",Z.length&&(w.R=Z),ge=I==0),Fe.Target&&(w.l=Fe),X.length>0&&(w.c=X,X=[]),E&&n.cellText!==!1&&(w.w=E),ge&&(w.t="z",delete w.v),(!ge||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=k))for(var ve=0;ve<Ve;++ve){if(Oe=parseInt(A["number-columns-repeated"]||"1",10),n.dense)for(y[k+ve]||(y[k+ve]=[]),y[k+ve][S]=ve==0?w:Vn(w);--Oe>0;)y[k+ve][S+Oe]=Vn(w);else for(y[Pt({r:k+ve,c:S})]=w;--Oe>0;)y[Pt({r:k+ve,c:S+Oe})]=Vn(w);V.e.c<=S&&(V.e.c=S)}Oe=parseInt(A["number-columns-repeated"]||"1",10),S+=Oe-1,Oe=0,w={},E="",Z=[]}Fe={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((a=r.pop())[0]!==b[3])throw"Bad state: "+a}else b[0].charAt(b[0].length-2)!=="/"&&r.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((a=r.pop())[0]!==b[3])throw"Bad state: "+a;te.t=E,Z.length&&(te.R=Z),te.a=J,X.push(te)}else b[0].charAt(b[0].length-2)!=="/"&&r.push([b[3],!1]);J="",ee=0,E="",I=0,Z=[];break;case"creator":b[1]==="/"?J=t.slice(ee,b.index):ee=b.index+b[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((a=r.pop())[0]!==b[3])throw"Bad state: "+a}else b[0].charAt(b[0].length-2)!=="/"&&r.push([b[3],!1]);E="",I=0,Z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(Q[l.name]=m,(a=r.pop())[0]!==b[3])throw"Bad state: "+a}else b[0].charAt(b[0].length-2)!=="/"&&(m="",l=kt(b[0],!1),r.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(r[r.length-1][0]){case"time-style":case"date-style":o=kt(b[0],!1),m+=Iv[b[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(r[r.length-1][0]){case"time-style":case"date-style":o=kt(b[0],!1),m+=Iv[b[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(r[r.length-1][0]){case"number-style":case"date-style":case"time-style":m+=t.slice(g,b.index);break}else g=b.index+b[0].length;break;case"named-range":o=kt(b[0],!1),de=sp(o["cell-range-address"]);var ot={Name:o.name,Ref:de[0]+"!"+de[1]};Te&&(ot.Sheet=C.length),Se.Names.push(ot);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(r[r.length-1][0])>-1)break;if(b[1]==="/"&&(!A||!A["string-value"])){var H=RN(t.slice(I,b.index),K);E=(E.length>0?E+`
`:"")+H[0]}else K=kt(b[0],!1),I=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{de=sp(kt(b[0])["target-range-address"]),x[de[0]]["!autofilter"]={ref:de[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(Fe=kt(b[0],!1),!Fe.href)break;Fe.Target=sn(Fe.href),delete Fe.href,Fe.Target.charAt(0)=="#"&&Fe.Target.indexOf(".")>-1?(de=sp(Fe.Target.slice(1)),Fe.Target="#"+de[0]+"!"+de[1]):Fe.Target.match(/^\.\.[\\\/]/)&&(Fe.Target=Fe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(n.WTF)throw new Error(b)}}var mt={Sheets:x,SheetNames:C,Workbook:Se};return n.bookSheets&&delete mt.Sheets,mt}function Av(e,i){i=i||{},_a(e,"META-INF/manifest.xml")&&c8(ki(e,"META-INF/manifest.xml"),i);var n=Jr(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var t=Dy(wn(n),i);return _a(e,"meta.xml")&&(t.Props=Mb(ki(e,"meta.xml"))),t}function Dv(e,i){return Dy(e,i)}var BN=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),i="<office:document-styles "+pd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return fi+i}}(),Fv=function(){var e=function(a){return On(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},i=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,t=function(a,o,l){var m=[];m.push('      <table:table table:name="'+On(o.SheetNames[l])+`" table:style-name="ta1">
`);var g=0,f=0,h=$r(a["!ref"]||"A1"),x=a["!merges"]||[],C=0,y=Array.isArray(a);if(a["!cols"])for(f=0;f<=h.e.c;++f)m.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var b="",w=a["!rows"]||[];for(g=0;g<h.s.r;++g)b=w[g]?' table:style-name="ro'+w[g].ods+'"':"",m.push("        <table:table-row"+b+`></table:table-row>
`);for(;g<=h.e.r;++g){for(b=w[g]?' table:style-name="ro'+w[g].ods+'"':"",m.push("        <table:table-row"+b+`>
`),f=0;f<h.s.c;++f)m.push(i);for(;f<=h.e.c;++f){var A=!1,E={},I="";for(C=0;C!=x.length;++C)if(!(x[C].s.c>f)&&!(x[C].s.r>g)&&!(x[C].e.c<f)&&!(x[C].e.r<g)){(x[C].s.c!=f||x[C].s.r!=g)&&(A=!0),E["table:number-columns-spanned"]=x[C].e.c-x[C].s.c+1,E["table:number-rows-spanned"]=x[C].e.r-x[C].s.r+1;break}if(A){m.push(n);continue}var K=Pt({r:g,c:f}),Z=y?(a[g]||[])[f]:a[K];if(Z&&Z.f&&(E["table:formula"]=On(n9(Z.f)),Z.F&&Z.F.slice(0,K.length)==K)){var k=$r(Z.F);E["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,E["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!Z){m.push(i);continue}switch(Z.t){case"b":I=Z.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=Z.v?"true":"false";break;case"n":I=Z.w||String(Z.v||0),E["office:value-type"]="float",E["office:value"]=Z.v||0;break;case"s":case"str":I=Z.v==null?"":Z.v,E["office:value-type"]="string";break;case"d":I=Z.w||Ln(Z.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=Ln(Z.v).toISOString(),E["table:style-name"]="ce1";break;default:m.push(i);continue}var S=e(I);if(Z.l&&Z.l.Target){var V=Z.l.Target;V=V.charAt(0)=="#"?"#"+i9(V.slice(1)):V,V.charAt(0)!="#"&&!V.match(/^\w+:/)&&(V="../"+V),S=Ye("text:a",S,{"xlink:href":V.replace(/&/g,"&amp;")})}m.push("          "+Ye("table:table-cell",Ye("text:p",S,{}),E)+`
`)}m.push(`        </table:table-row>
`)}return m.push(`      </table:table>
`),m.join("")},r=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(g){return o.Sheets[g]}).forEach(function(g){if(g&&g["!cols"]){for(var f=0;f<g["!cols"].length;++f)if(g["!cols"][f]){var h=g["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;cs(h),h.ods=l;var x=g["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),a.push(`  </style:style>
`),++l}}});var m=0;o.SheetNames.map(function(g){return o.Sheets[g]}).forEach(function(g){if(g&&g["!rows"]){for(var f=0;f<g["!rows"].length;++f)if(g["!rows"][f]){g["!rows"][f].ods=m;var h=g["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+m+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++m}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var m=[fi],g=pd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=pd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(m.push("<office:document"+g+f+`>
`),m.push(yb().replace(/office:document-meta/g,"office:meta"))):m.push("<office:document-content"+g+`>
`),r(m,o),m.push(`  <office:body>
`),m.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)m.push(t(o.Sheets[o.SheetNames[h]],o,h,l));return m.push(`    </office:spreadsheet>
`),m.push(`  </office:body>
`),l.bookType=="fods"?m.push("</office:document>"):m.push("</office:document-content>"),m.join("")}}();function Fy(e,i){if(i.bookType=="fods")return Fv(e,i);var n=Ap(),t="",r=[],a=[];return t="mimetype",Yt(n,t,"application/vnd.oasis.opendocument.spreadsheet"),t="content.xml",Yt(n,t,Fv(e,i)),r.push([t,"text/xml"]),a.push([t,"ContentFile"]),t="styles.xml",Yt(n,t,BN(e,i)),r.push([t,"text/xml"]),a.push([t,"StylesFile"]),t="meta.xml",Yt(n,t,fi+yb()),r.push([t,"text/xml"]),a.push([t,"MetadataFile"]),t="manifest.rdf",Yt(n,t,m8(a)),r.push([t,"application/rdf+xml"]),t="META-INF/manifest.xml",Yt(n,t,l8(r)),n}function js(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Pp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):wn(ms(e))}function NN(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Qr(no(e))}function LN(e,i){e:for(var n=0;n<=e.length-i.length;++n){for(var t=0;t<i.length;++t)if(e[n+t]!=i[t])continue e;return!0}return!1}function ds(e){var i=e.reduce(function(r,a){return r+a.length},0),n=new Uint8Array(i),t=0;return e.forEach(function(r){n.set(r,t),t+=r.length}),n}function Rv(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function VN(e,i){for(var n=(e[i+15]&127)<<7|e[i+14]>>1,t=e[i+14]&1,r=i+13;r>=i;--r)t=t*256+e[r];return(e[i+15]&128?-t:t)*Math.pow(10,n-6176)}function UN(e,i,n){var t=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,r=n/Math.pow(10,t-6176);e[i+15]|=t>>7,e[i+14]|=(t&127)<<1;for(var a=0;r>=1;++a,r/=256)e[i+a]=r&255;e[i+15]|=n>=0?0:128}function yd(e,i){var n=i?i[0]:0,t=e[n]&127;e:if(e[n++]>=128&&(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128)||(t+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(t+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(t+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return i&&(i[0]=n),t}function Mn(e){var i=new Uint8Array(7);i[0]=e&127;var n=1;e:if(e>127){if(i[n-1]|=128,i[n]=e>>7&127,++n,e<=16383||(i[n-1]|=128,i[n]=e>>14&127,++n,e<=2097151)||(i[n-1]|=128,i[n]=e>>21&127,++n,e<=268435455)||(i[n-1]|=128,i[n]=e/256>>>21&127,++n,e<=34359738367)||(i[n-1]|=128,i[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;i[n-1]|=128,i[n]=e/16777216>>>21&127,++n}return i.slice(0,n)}function oi(e){var i=0,n=e[i]&127;e:if(e[i++]>=128){if(n|=(e[i]&127)<<7,e[i++]<128||(n|=(e[i]&127)<<14,e[i++]<128)||(n|=(e[i]&127)<<21,e[i++]<128))break e;n|=(e[i]&127)<<28}return n}function fn(e){for(var i=[],n=[0];n[0]<e.length;){var t=n[0],r=yd(e,n),a=r&7;r=Math.floor(r/8);var o=0,l;if(r==0)break;switch(a){case 0:{for(var m=n[0];e[n[0]++]>=128;);l=e.slice(m,n[0])}break;case 5:o=4,l=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,l=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=yd(e,n),l=e.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(r," at offset ").concat(t))}var g={data:l,type:a};i[r]==null?i[r]=[g]:i[r].push(g)}return i}function Ki(e){var i=[];return e.forEach(function(n,t){n.forEach(function(r){r.data&&(i.push(Mn(t*8+r.type)),r.type==2&&i.push(Mn(r.data.length)),i.push(r.data))})}),ds(i)}function df(e,i){return(e==null?void 0:e.map(function(n){return i(n.data)}))||[]}function fa(e){for(var i,n=[],t=[0];t[0]<e.length;){var r=yd(e,t),a=fn(e.slice(t[0],t[0]+r));t[0]+=r;var o={id:oi(a[1][0].data),messages:[]};a[2].forEach(function(l){var m=fn(l.data),g=oi(m[3][0].data);o.messages.push({meta:m,data:e.slice(t[0],t[0]+g)}),t[0]+=g}),(i=a[3])!=null&&i[0]&&(o.merge=oi(a[3][0].data)>>>0>0),n.push(o)}return n}function el(e){var i=[];return e.forEach(function(n){var t=[];t[1]=[{data:Mn(n.id),type:0}],t[2]=[],n.merge!=null&&(t[3]=[{data:Mn(+!!n.merge),type:0}]);var r=[];n.messages.forEach(function(o){r.push(o.data),o.meta[3]=[{type:0,data:Mn(o.data.length)}],t[2].push({data:Ki(o.meta),type:2})});var a=Ki(t);i.push(Mn(a.length)),i.push(a),r.forEach(function(o){return i.push(o)})}),ds(i)}function zN(e,i){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],t=yd(i,n),r=[];n[0]<i.length;){var a=i[n[0]]&3;if(a==0){var o=i[n[0]++]>>2;if(o<60)++o;else{var l=o-59;o=i[n[0]],l>1&&(o|=i[n[0]+1]<<8),l>2&&(o|=i[n[0]+2]<<16),l>3&&(o|=i[n[0]+3]<<24),o>>>=0,o++,n[0]+=l}r.push(i.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var m=0,g=0;if(a==1?(g=(i[n[0]]>>2&7)+4,m=(i[n[0]++]&224)<<3,m|=i[n[0]++]):(g=(i[n[0]++]>>2)+1,a==2?(m=i[n[0]]|i[n[0]+1]<<8,n[0]+=2):(m=(i[n[0]]|i[n[0]+1]<<8|i[n[0]+2]<<16|i[n[0]+3]<<24)>>>0,n[0]+=4)),r=[ds(r)],m==0)throw new Error("Invalid offset 0");if(m>r[0].length)throw new Error("Invalid offset beyond length");if(g>=m)for(r.push(r[0].slice(-m)),g-=m;g>=r[r.length-1].length;)r.push(r[r.length-1]),g-=r[r.length-1].length;r.push(r[0].slice(-m,-m+g))}}var f=ds(r);if(f.length!=t)throw new Error("Unexpected length: ".concat(f.length," != ").concat(t));return f}function ha(e){for(var i=[],n=0;n<e.length;){var t=e[n++],r=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,i.push(zN(t,e.slice(n,n+r))),n+=r}if(n!==e.length)throw new Error("data is not a valid framed stream!");return ds(i)}function tl(e){for(var i=[],n=0;n<e.length;){var t=Math.min(e.length-n,268435455),r=new Uint8Array(4);i.push(r);var a=Mn(t),o=a.length;i.push(a),t<=60?(o++,i.push(new Uint8Array([t-1<<2]))):t<=256?(o+=2,i.push(new Uint8Array([240,t-1&255]))):t<=65536?(o+=3,i.push(new Uint8Array([244,t-1&255,t-1>>8&255]))):t<=16777216?(o+=4,i.push(new Uint8Array([248,t-1&255,t-1>>8&255,t-1>>16&255]))):t<=4294967296&&(o+=5,i.push(new Uint8Array([252,t-1&255,t-1>>8&255,t-1>>16&255,t-1>>>24&255]))),i.push(e.slice(n,n+t)),o+=t,r[0]=0,r[1]=o&255,r[2]=o>>8&255,r[3]=o>>16&255,n+=t}return ds(i)}function jN(e,i,n,t){var r=js(e),a=r.getUint32(4,!0),o=(t>1?12:8)+Rv(a&(t>1?3470:398))*4,l=-1,m=-1,g=NaN,f=new Date(2001,0,1);a&512&&(l=r.getUint32(o,!0),o+=4),o+=Rv(a&(t>1?12288:4096))*4,a&16&&(m=r.getUint32(o,!0),o+=4),a&32&&(g=r.getFloat64(o,!0),o+=8),a&64&&(f.setTime(f.getTime()+r.getFloat64(o,!0)*1e3),o+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:g};break;case 3:h={t:"s",v:i[m]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:g>0};break;case 7:h={t:"n",v:g/86400};break;case 8:h={t:"e",v:0};break;case 9:if(l>-1)h={t:"s",v:n[l]};else if(m>-1)h={t:"s",v:i[m]};else if(!isNaN(g))h={t:"n",v:g};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function $N(e,i,n){var t=js(e),r=t.getUint32(8,!0),a=12,o=-1,l=-1,m=NaN,g=NaN,f=new Date(2001,0,1);r&1&&(m=VN(e,a),a+=16),r&2&&(g=t.getFloat64(a,!0),a+=8),r&4&&(f.setTime(f.getTime()+t.getFloat64(a,!0)*1e3),a+=8),r&8&&(l=t.getUint32(a,!0),a+=4),r&16&&(o=t.getUint32(a,!0),a+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:m};break;case 3:h={t:"s",v:i[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:g>0};break;case 7:h={t:"n",v:g/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:n[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(r&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:m};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(r&31," : ").concat(e.slice(0,4)))}return h}function lp(e,i){var n=new Uint8Array(32),t=js(n),r=12,a=0;switch(n[0]=5,e.t){case"n":n[1]=2,UN(n,r,e.v),a|=1,r+=16;break;case"b":n[1]=6,t.setFloat64(r,e.v?1:0,!0),a|=2,r+=8;break;case"s":if(i.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,t.setUint32(r,i.indexOf(e.v),!0),a|=8,r+=4;break;default:throw"unsupported cell type "+e.t}return t.setUint32(8,a,!0),n.slice(0,r)}function dp(e,i){var n=new Uint8Array(32),t=js(n),r=12,a=0;switch(n[0]=3,e.t){case"n":n[2]=2,t.setFloat64(r,e.v,!0),a|=32,r+=8;break;case"b":n[2]=6,t.setFloat64(r,e.v?1:0,!0),a|=32,r+=8;break;case"s":if(i.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,t.setUint32(r,i.indexOf(e.v),!0),a|=16,r+=4;break;default:throw"unsupported cell type "+e.t}return t.setUint32(4,a,!0),n.slice(0,r)}function YN(e,i,n){switch(e[0]){case 0:case 1:case 2:case 3:return jN(e,i,n,e[0]);case 5:return $N(e,i,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function pr(e){var i=fn(e);return yd(i[1][0].data)}function Bv(e,i){var n=fn(i.data),t=oi(n[1][0].data),r=n[3],a=[];return(r||[]).forEach(function(o){var l=fn(o.data),m=oi(l[1][0].data)>>>0;switch(t){case 1:a[m]=Pp(l[3][0].data);break;case 8:{var g=e[pr(l[9][0].data)][0],f=fn(g.data),h=e[pr(f[1][0].data)][0],x=oi(h.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var C=fn(h.data);a[m]=C[3].map(function(y){return Pp(y.data)}).join("")}break}}),a}function WN(e,i){var n,t,r,a,o,l,m,g,f,h,x,C,y,b,w=fn(e),A=oi(w[1][0].data)>>>0,E=oi(w[2][0].data)>>>0,I=((t=(n=w[8])==null?void 0:n[0])==null?void 0:t.data)&&oi(w[8][0].data)>0||!1,K,Z;if((a=(r=w[7])==null?void 0:r[0])!=null&&a.data&&i!=0)K=(l=(o=w[7])==null?void 0:o[0])==null?void 0:l.data,Z=(g=(m=w[6])==null?void 0:m[0])==null?void 0:g.data;else if((h=(f=w[4])==null?void 0:f[0])!=null&&h.data&&i!=1)K=(C=(x=w[4])==null?void 0:x[0])==null?void 0:C.data,Z=(b=(y=w[3])==null?void 0:y[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(i," cell storage");for(var k=I?4:1,S=js(K),V=[],W=0;W<K.length/2;++W){var Q=S.getUint16(W*2,!0);Q<65535&&V.push([W,Q])}if(V.length!=E)throw"Expected ".concat(E," cells, found ").concat(V.length);var se=[];for(W=0;W<V.length-1;++W)se[V[W][0]]=Z.subarray(V[W][1]*k,V[W+1][1]*k);return V.length>=1&&(se[V[V.length-1][0]]=Z.subarray(V[V.length-1][1]*k)),{R:A,cells:se}}function GN(e,i){var n,t=fn(i.data),r=(n=t==null?void 0:t[7])!=null&&n[0]?oi(t[7][0].data)>>>0>0?1:0:-1,a=df(t[5],function(o){return WN(o,r)});return{nrows:oi(t[4][0].data)>>>0,data:a.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(m,g){if(o[l.R][g])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(g));o[l.R][g]=m}),o},[])}}function HN(e,i,n){var t,r=fn(i.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(oi(r[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(r[6][0].data));if(a.e.c=(oi(r[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(r[7][0].data));n["!ref"]=zt(a);var o=fn(r[4][0].data),l=Bv(e,e[pr(o[4][0].data)][0]),m=(t=o[17])!=null&&t[0]?Bv(e,e[pr(o[17][0].data)][0]):[],g=fn(o[3][0].data),f=0;g[1].forEach(function(h){var x=fn(h.data),C=e[pr(x[2][0].data)][0],y=oi(C.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var b=GN(e,C);b.data.forEach(function(w,A){w.forEach(function(E,I){var K=Pt({r:f+A,c:I}),Z=YN(E,l,m);Z&&(n[K]=Z)})}),f+=b.nrows})}function qN(e,i){var n=fn(i.data),t={"!ref":"A1"},r=e[pr(n[2][0].data)],a=oi(r[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return HN(e,r[0],t),t}function XN(e,i){var n,t=fn(i.data),r={name:(n=t[1])!=null&&n[0]?Pp(t[1][0].data):"",sheets:[]},a=df(t[2],pr);return a.forEach(function(o){e[o].forEach(function(l){var m=oi(l.meta[1][0].data);m==6e3&&r.sheets.push(qN(e,l))})}),r}function KN(e,i){var n=hf(),t=fn(i.data),r=df(t[1],pr);if(r.forEach(function(a){e[a].forEach(function(o){var l=oi(o.meta[1][0].data);if(l==2){var m=XN(e,o);m.sheets.forEach(function(g,f){_f(n,g,f==0?m.name:m.name+"_"+f,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function mp(e){var i,n,t,r,a={},o=[];if(e.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var g;try{g=ha(m.content)}catch(h){return console.log("?? "+m.content.length+" "+(h.message||h))}var f;try{f=fa(g)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){a[h.id]=h.messages,o.push(h.id)})}}),!o.length)throw new Error("File has no messages");var l=((r=(t=(n=(i=a==null?void 0:a[1])==null?void 0:i[0])==null?void 0:n.meta)==null?void 0:t[1])==null?void 0:r[0].data)&&oi(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||o.forEach(function(m){a[m].forEach(function(g){var f=oi(g.meta[1][0].data)>>>0;if(f==1)if(!l)l=g;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return KN(a,l)}function ZN(e,i,n){var t,r,a,o;if(!((t=e[6])!=null&&t[0])||!((r=e[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=e[8])==null?void 0:a[0])==null?void 0:o.data)&&oi(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var m=0,g=js(e[7][0].data),f=0,h=[],x=js(e[4][0].data),C=0,y=[],b=0;b<i.length;++b){if(i[b]==null){g.setUint16(b*2,65535,!0),x.setUint16(b*2,65535);continue}g.setUint16(b*2,f,!0),x.setUint16(b*2,C,!0);var w,A;switch(typeof i[b]){case"string":w=lp({t:"s",v:i[b]},n),A=dp({t:"s",v:i[b]},n);break;case"number":w=lp({t:"n",v:i[b]},n),A=dp({t:"n",v:i[b]},n);break;case"boolean":w=lp({t:"b",v:i[b]},n),A=dp({t:"b",v:i[b]},n);break;default:throw new Error("Unsupported value "+i[b])}h.push(w),f+=w.length,y.push(A),C+=A.length,++m}for(e[2][0].data=Mn(m);b<e[7][0].data.length/2;++b)g.setUint16(b*2,65535,!0),x.setUint16(b*2,65535,!0);return e[6][0].data=ds(h),e[3][0].data=ds(y),m}function QN(e,i){if(!i||!i.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var t=$r(n["!ref"]);t.s.r=t.s.c=0;var r=!1;t.e.c>9&&(r=!0,t.e.c=9),t.e.r>49&&(r=!0,t.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(zt(t)));var a=Tg(n,{range:t,header:1}),o=["~Sh33tJ5~"];a.forEach(function(J){return J.forEach(function(ee){typeof ee=="string"&&o.push(ee)})});var l={},m=[],g=_t.read(i.numbers,{type:"base64"});g.FileIndex.map(function(J,ee){return[J,g.FullPaths[ee]]}).forEach(function(J){var ee=J[0],ge=J[1];if(ee.type==2&&ee.name.match(/\.iwa/)){var Te=ee.content,Ee=ha(Te),Pe=fa(Ee);Pe.forEach(function(ve){m.push(ve.id),l[ve.id]={deps:[],location:ge,type:oi(ve.messages[0].meta[1][0].data)}})}}),m.sort(function(J,ee){return J-ee});var f=m.filter(function(J){return J>1}).map(function(J){return[J,Mn(J)]});g.FileIndex.map(function(J,ee){return[J,g.FullPaths[ee]]}).forEach(function(J){var ee=J[0],ge=J[1];if(ee.name.match(/\.iwa/)){var Te=fa(ha(ee.content));Te.forEach(function(Ee){Ee.messages.forEach(function(Pe){f.forEach(function(ve){Ee.messages.some(function(ot){return oi(ot.meta[1][0].data)!=11006&&LN(ot.data,ve[1])})&&l[ve[0]].deps.push(Ee.id)})})})}});function h(){for(var J=927262;J<2e6;++J)if(!l[J])return J;throw new Error("Too many messages")}for(var x=_t.find(g,l[1].location),C=fa(ha(x.content)),y,b=0;b<C.length;++b){var w=C[b];w.id==1&&(y=w)}var A=pr(fn(y.messages[0].data)[1][0].data);for(x=_t.find(g,l[A].location),C=fa(ha(x.content)),b=0;b<C.length;++b)w=C[b],w.id==A&&(y=w);for(A=pr(fn(y.messages[0].data)[2][0].data),x=_t.find(g,l[A].location),C=fa(ha(x.content)),b=0;b<C.length;++b)w=C[b],w.id==A&&(y=w);for(A=pr(fn(y.messages[0].data)[2][0].data),x=_t.find(g,l[A].location),C=fa(ha(x.content)),b=0;b<C.length;++b)w=C[b],w.id==A&&(y=w);var E=fn(y.messages[0].data);{E[6][0].data=Mn(t.e.r+1),E[7][0].data=Mn(t.e.c+1);var I=pr(E[46][0].data),K=_t.find(g,l[I].location),Z=fa(ha(K.content));{for(var k=0;k<Z.length&&Z[k].id!=I;++k);if(Z[k].id!=I)throw"Bad ColumnRowUIDMapArchive";var S=fn(Z[k].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var V=0;V<=t.e.c;++V){var W=[];W[1]=W[2]=[{type:0,data:Mn(V+420690)}],S[1].push({type:2,data:Ki(W)}),S[2].push({type:0,data:Mn(V)}),S[3].push({type:0,data:Mn(V)})}S[4]=[],S[5]=[],S[6]=[];for(var Q=0;Q<=t.e.r;++Q)W=[],W[1]=W[2]=[{type:0,data:Mn(Q+726270)}],S[4].push({type:2,data:Ki(W)}),S[5].push({type:0,data:Mn(Q)}),S[6].push({type:0,data:Mn(Q)});Z[k].messages[0].data=Ki(S)}K.content=tl(el(Z)),K.size=K.content.length,delete E[46];var se=fn(E[4][0].data);{se[7][0].data=Mn(t.e.r+1);var ae=fn(se[1][0].data),ke=pr(ae[2][0].data);K=_t.find(g,l[ke].location),Z=fa(ha(K.content));{if(Z[0].id!=ke)throw"Bad HeaderStorageBucket";var Ne=fn(Z[0].messages[0].data);for(Q=0;Q<a.length;++Q){var Ce=fn(Ne[2][0].data);Ce[1][0].data=Mn(Q),Ce[4][0].data=Mn(a[Q].length),Ne[2][Q]={type:Ne[2][0].type,data:Ki(Ce)}}Z[0].messages[0].data=Ki(Ne)}K.content=tl(el(Z)),K.size=K.content.length;var Ve=pr(se[2][0].data);K=_t.find(g,l[Ve].location),Z=fa(ha(K.content));{if(Z[0].id!=Ve)throw"Bad HeaderStorageBucket";for(Ne=fn(Z[0].messages[0].data),V=0;V<=t.e.c;++V)Ce=fn(Ne[2][0].data),Ce[1][0].data=Mn(V),Ce[4][0].data=Mn(t.e.r+1),Ne[2][V]={type:Ne[2][0].type,data:Ki(Ce)};Z[0].messages[0].data=Ki(Ne)}K.content=tl(el(Z)),K.size=K.content.length;var Oe=pr(se[4][0].data);(function(){for(var J=_t.find(g,l[Oe].location),ee=fa(ha(J.content)),ge,Te=0;Te<ee.length;++Te){var Ee=ee[Te];Ee.id==Oe&&(ge=Ee)}var Pe=fn(ge.messages[0].data);{Pe[3]=[];var ve=[];o.forEach(function(mt,Je){ve[1]=[{type:0,data:Mn(Je)}],ve[2]=[{type:0,data:Mn(1)}],ve[3]=[{type:2,data:NN(mt)}],Pe[3].push({type:2,data:Ki(ve)})})}ge.messages[0].data=Ki(Pe);var ot=el(ee),H=tl(ot);J.content=H,J.size=J.content.length})();var Ze=fn(se[3][0].data);{var Se=Ze[1][0];delete Ze[2];var Fe=fn(Se.data);{var de=pr(Fe[2][0].data);(function(){for(var J=_t.find(g,l[de].location),ee=fa(ha(J.content)),ge,Te=0;Te<ee.length;++Te){var Ee=ee[Te];Ee.id==de&&(ge=Ee)}var Pe=fn(ge.messages[0].data);{delete Pe[6],delete Ze[7];var ve=new Uint8Array(Pe[5][0].data);Pe[5]=[];for(var ot=0,H=0;H<=t.e.r;++H){var mt=fn(ve);ot+=ZN(mt,a[H],o),mt[1][0].data=Mn(H),Pe[5].push({data:Ki(mt),type:2})}Pe[1]=[{type:0,data:Mn(t.e.c+1)}],Pe[2]=[{type:0,data:Mn(t.e.r+1)}],Pe[3]=[{type:0,data:Mn(ot)}],Pe[4]=[{type:0,data:Mn(t.e.r+1)}]}ge.messages[0].data=Ki(Pe);var Je=el(ee),Ot=tl(Je);J.content=Ot,J.size=J.content.length})()}Se.data=Ki(Fe)}se[3][0].data=Ki(Ze)}E[4][0].data=Ki(se)}y.messages[0].data=Ki(E);var X=el(C),te=tl(X);return x.content=te,x.size=x.content.length,g}function Ry(e){return function(n){for(var t=0;t!=e.length;++t){var r=e[t];n[r[0]]===void 0&&(n[r[0]]=r[1]),r[2]==="n"&&(n[r[0]]=Number(n[r[0]]))}}}function mf(e){Ry([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function gf(e){Ry([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function JN(e){return Wt.WS.indexOf(e)>-1?"sheet":Wt.CS&&e==Wt.CS?"chart":Wt.DS&&e==Wt.DS?"dialog":Wt.MS&&e==Wt.MS?"macro":e&&e.length?e:"sheet"}function eL(e,i){if(!e)return 0;try{e=i.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,JN(e["!id"][t.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function tL(e,i,n,t,r,a,o,l,m,g,f,h){try{a[t]=ad(Jr(e,n,!0),i);var x=ki(e,i),C;switch(l){case"sheet":C=MB(x,i,r,m,a[t],g,f,h);break;case"chart":if(C=PB(x,i,r,m,a[t],g,f,h),!C||!C["!drawel"])break;var y=td(C["!drawel"].Target,i),b=hd(y),w=dF(Jr(e,y,!0),ad(Jr(e,b,!0),y)),A=td(w,y),E=hd(A);C=ZR(Jr(e,A,!0),A,m,ad(Jr(e,E,!0),A),g,C);break;case"macro":C=OB(x,i,r,m,a[t],g,f,h);break;case"dialog":C=wB(x,i,r,m,a[t],g,f,h);break;default:throw new Error("Unrecognized sheet type "+l)}o[t]=C;var I=[];a&&a[t]&&ci(a[t]).forEach(function(K){var Z="";if(a[t][K].Type==Wt.CMNT){Z=td(a[t][K].Target,i);var k=EB(ki(e,Z,!0),Z,m);if(!k||!k.length)return;bv(C,k,!1)}a[t][K].Type==Wt.TCMNT&&(Z=td(a[t][K].Target,i),I=I.concat(gF(ki(e,Z,!0),m)))}),I&&I.length&&bv(C,I,!0,m.people||[])}catch(K){if(m.WTF)throw K}}function ua(e){return e.charAt(0)=="/"?e.slice(1):e}function nL(e,i){if(pl(),i=i||{},mf(i),_a(e,"META-INF/manifest.xml")||_a(e,"objectdata.xml"))return Av(e,i);if(_a(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof mp<"u"){if(e.FileIndex)return mp(e);var n=_t.utils.cfb_new();return jC(e).forEach(function(Ne){Yt(n,Ne,eb(e,Ne))}),mp(n)}throw new Error("Unsupported NUMBERS file")}if(!_a(e,"[Content_Types].xml"))throw _a(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):_a(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var t=jC(e),r=o8(Jr(e,"[Content_Types].xml")),a=!1,o,l;if(r.workbooks.length===0&&(l="xl/workbook.xml",ki(e,l,!0)&&r.workbooks.push(l)),r.workbooks.length===0){if(l="xl/workbook.bin",!ki(e,l,!0))throw new Error("Could not find workbook");r.workbooks.push(l),a=!0}r.workbooks[0].slice(-3)=="bin"&&(a=!0);var m={},g={};if(!i.bookSheets&&!i.bookProps){if(od=[],r.sst)try{od=TB(ki(e,ua(r.sst)),r.sst,i)}catch(Ne){if(i.WTF)throw Ne}i.cellStyles&&r.themes.length&&(m=kB(Jr(e,r.themes[0].replace(/^\//,""),!0)||"",r.themes[0],i)),r.style&&(g=SB(ki(e,ua(r.style)),r.style,m,i))}r.links.map(function(Ne){try{var Ce=ad(Jr(e,hd(ua(Ne))),Ne);return AB(ki(e,ua(Ne)),Ce,Ne,i)}catch{}});var f=yB(ki(e,ua(r.workbooks[0])),r.workbooks[0],i),h={},x="";r.coreprops.length&&(x=ki(e,ua(r.coreprops[0]),!0),x&&(h=Mb(x)),r.extprops.length!==0&&(x=ki(e,ua(r.extprops[0]),!0),x&&u8(x,h,i)));var C={};(!i.bookSheets||i.bookProps)&&r.custprops.length!==0&&(x=Jr(e,ua(r.custprops[0]),!0),x&&(C=f8(x,i)));var y={};if((i.bookSheets||i.bookProps)&&(f.Sheets?o=f.Sheets.map(function(Ce){return Ce.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),i.bookProps&&(y.Props=h,y.Custprops=C),i.bookSheets&&typeof o<"u"&&(y.SheetNames=o),i.bookSheets?y.SheetNames:i.bookProps))return y;o={};var b={};i.bookDeps&&r.calcchain&&(b=IB(ki(e,ua(r.calcchain)),r.calcchain,i));var w=0,A={},E,I;{var K=f.Sheets;h.Worksheets=K.length,h.SheetNames=[];for(var Z=0;Z!=K.length;++Z)h.SheetNames[Z]=K[Z].name}var k=a?"bin":"xml",S=r.workbooks[0].lastIndexOf("/"),V=(r.workbooks[0].slice(0,S+1)+"_rels/"+r.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");_a(e,V)||(V="xl/_rels/workbook."+k+".rels");var W=ad(Jr(e,V,!0),V.replace(/_rels.*/,"s5s"));(r.metadata||[]).length>=1&&(i.xlmeta=DB(ki(e,ua(r.metadata[0])),r.metadata[0],i)),(r.people||[]).length>=1&&(i.people=pF(ki(e,ua(r.people[0])),i)),W&&(W=eL(W,f.Sheets));var Q=ki(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var se="sheet";if(W&&W[w]?(E="xl/"+W[w][1].replace(/[\/]?xl\//,""),_a(e,E)||(E=W[w][1]),_a(e,E)||(E=V.replace(/_rels\/.*$/,"")+W[w][1]),se=W[w][2]):(E="xl/worksheets/sheet"+(w+1-Q)+"."+k,E=E.replace(/sheet0\./,"sheet.")),I=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),i&&i.sheets!=null)switch(typeof i.sheets){case"number":if(w!=i.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=i.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(i.sheets)){for(var ae=!1,ke=0;ke!=i.sheets.length;++ke)typeof i.sheets[ke]=="number"&&i.sheets[ke]==w&&(ae=1),typeof i.sheets[ke]=="string"&&i.sheets[ke].toLowerCase()==h.SheetNames[w].toLowerCase()&&(ae=1);if(!ae)continue e}}tL(e,E,I,h.SheetNames[w],w,A,o,se,i,f,m,g)}return y={Directory:r,Workbook:f,Props:h,Custprops:C,Deps:b,Sheets:o,SheetNames:h.SheetNames,Strings:od,Styles:g,Themes:m,SSF:Vn(Mt)},i&&i.bookFiles&&(e.files?(y.keys=t,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(Ne,Ce){Ne=Ne.replace(/^Root Entry[\/]/,""),y.keys.push(Ne),y.files[Ne]=e.FileIndex[Ce]}))),i&&i.bookVBA&&(r.vba.length>0?y.vbaraw=ki(e,ua(r.vba[0]),!0):r.defaults&&r.defaults.bin===yF&&(y.vbaraw=ki(e,"xl/vbaProject.bin",!0))),y}function iL(e,i){var n=i||{},t="Workbook",r=_t.find(e,t);try{if(t="/!DataSpaces/Version",r=_t.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);if(DA(r.content),t="/!DataSpaces/DataSpaceMap",r=_t.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);var a=RA(r.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+t);if(t="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",r=_t.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);var o=BA(r.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+t);if(t="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",r=_t.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);LA(r.content)}catch{}if(t="/EncryptionInfo",r=_t.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);var l=VA(r.content);if(t="/EncryptedPackage",r=_t.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],r.content,n.password||"",n);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],r.content,n.password||"",n);throw new Error("File is password-protected")}function rL(e,i){return i.bookType=="ods"?Fy(e,i):i.bookType=="numbers"?QN(e,i):i.bookType=="xlsb"?aL(e,i):oL(e,i)}function aL(e,i){rl=1024,e&&!e.SSF&&(e.SSF=Vn(Mt)),e&&e.SSF&&(pl(),Ig(e.SSF),i.revssf=Dg(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF),i.rels={},i.wbrels={},i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,sd?i.revStrings=new Map:(i.revStrings={},i.revStrings.foo=[],delete i.revStrings.foo);var n=i.bookType=="xlsb"?"bin":"xml",t=cy.indexOf(i.bookType)>-1,r=Kp();gf(i=i||{});var a=Ap(),o="",l=0;if(i.cellXfs=[],us(i.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Yt(a,o,Pb(e.Props,i)),r.coreprops.push(o),Pn(i.rels,2,o,Wt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],g=0;g<e.SheetNames.length;++g)(e.Workbook.Sheets[g]||{}).Hidden!=2&&m.push(e.SheetNames[g]);e.Props.SheetNames=m}for(e.Props.Worksheets=e.Props.SheetNames.length,Yt(a,o,Sb(e.Props,i)),r.extprops.push(o),Pn(i.rels,3,o,Wt.EXT_PROPS),e.Custprops!==e.Props&&ci(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Yt(a,o,kb(e.Custprops,i)),r.custprops.push(o),Pn(i.rels,4,o,Wt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],x=(h||{})["!type"]||"sheet";switch(x){case"chart":default:o="xl/worksheets/sheet"+l+"."+n,Yt(a,o,RB(l-1,o,i,e,f)),r.sheets.push(o),Pn(i.wbrels,-1,"worksheets/sheet"+l+"."+n,Wt.WS[0])}if(h){var C=h["!comments"],y=!1,b="";C&&C.length>0&&(b="xl/comments"+l+"."+n,Yt(a,b,LB(C,b,i)),r.comments.push(b),Pn(f,-1,"../comments"+l+"."+n,Wt.CMNT),y=!0),h["!legacy"]&&y&&Yt(a,"xl/drawings/vmlDrawing"+l+".vml",oy(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Yt(a,hd(o),ol(f))}return i.Strings!=null&&i.Strings.length>0&&(o="xl/sharedStrings."+n,Yt(a,o,NB(i.Strings,o,i)),r.strs.push(o),Pn(i.wbrels,-1,"sharedStrings."+n,Wt.SST)),o="xl/workbook."+n,Yt(a,o,FB(e,o,i)),r.workbooks.push(o),Pn(i.rels,1,o,Wt.WB),o="xl/theme/theme1.xml",Yt(a,o,nf(e.Themes,i)),r.themes.push(o),Pn(i.wbrels,-1,"theme/theme1.xml",Wt.THEME),o="xl/styles."+n,Yt(a,o,BB(e,o,i)),r.styles.push(o),Pn(i.wbrels,-1,"styles."+n,Wt.STY),e.vbaraw&&t&&(o="xl/vbaProject.bin",Yt(a,o,e.vbaraw),r.vba.push(o),Pn(i.wbrels,-1,"vbaProject.bin",Wt.VBA)),o="xl/metadata."+n,Yt(a,o,VB(o)),r.metadata.push(o),Pn(i.wbrels,-1,"metadata."+n,Wt.XLMETA),Yt(a,"[Content_Types].xml",bb(r,i)),Yt(a,"_rels/.rels",ol(i.rels)),Yt(a,"xl/_rels/workbook."+n+".rels",ol(i.wbrels)),delete i.revssf,delete i.ssf,a}function oL(e,i){rl=1024,e&&!e.SSF&&(e.SSF=Vn(Mt)),e&&e.SSF&&(pl(),Ig(e.SSF),i.revssf=Dg(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF),i.rels={},i.wbrels={},i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,sd?i.revStrings=new Map:(i.revStrings={},i.revStrings.foo=[],delete i.revStrings.foo);var n="xml",t=cy.indexOf(i.bookType)>-1,r=Kp();gf(i=i||{});var a=Ap(),o="",l=0;if(i.cellXfs=[],us(i.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Yt(a,o,Pb(e.Props,i)),r.coreprops.push(o),Pn(i.rels,2,o,Wt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],g=0;g<e.SheetNames.length;++g)(e.Workbook.Sheets[g]||{}).Hidden!=2&&m.push(e.SheetNames[g]);e.Props.SheetNames=m}e.Props.Worksheets=e.Props.SheetNames.length,Yt(a,o,Sb(e.Props,i)),r.extprops.push(o),Pn(i.rels,3,o,Wt.EXT_PROPS),e.Custprops!==e.Props&&ci(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Yt(a,o,kb(e.Custprops,i)),r.custprops.push(o),Pn(i.rels,4,o,Wt.CUST_PROPS));var f=["SheetJ5"];for(i.tcid=0,l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},x=e.Sheets[e.SheetNames[l-1]],C=(x||{})["!type"]||"sheet";switch(C){case"chart":default:o="xl/worksheets/sheet"+l+"."+n,Yt(a,o,Cy(l-1,i,e,h)),r.sheets.push(o),Pn(i.wbrels,-1,"worksheets/sheet"+l+"."+n,Wt.WS[0])}if(x){var y=x["!comments"],b=!1,w="";if(y&&y.length>0){var A=!1;y.forEach(function(E){E[1].forEach(function(I){I.T==!0&&(A=!0)})}),A&&(w="xl/threadedComments/threadedComment"+l+"."+n,Yt(a,w,uF(y,f,i)),r.threadedcomments.push(w),Pn(h,-1,"../threadedComments/threadedComment"+l+"."+n,Wt.TCMNT)),w="xl/comments"+l+"."+n,Yt(a,w,sy(y,i)),r.comments.push(w),Pn(h,-1,"../comments"+l+"."+n,Wt.CMNT),b=!0}x["!legacy"]&&b&&Yt(a,"xl/drawings/vmlDrawing"+l+".vml",oy(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}h["!id"].rId1&&Yt(a,hd(o),ol(h))}return i.Strings!=null&&i.Strings.length>0&&(o="xl/sharedStrings."+n,Yt(a,o,qb(i.Strings,i)),r.strs.push(o),Pn(i.wbrels,-1,"sharedStrings."+n,Wt.SST)),o="xl/workbook."+n,Yt(a,o,Py(e,i)),r.workbooks.push(o),Pn(i.rels,1,o,Wt.WB),o="xl/theme/theme1.xml",Yt(a,o,nf(e.Themes,i)),r.themes.push(o),Pn(i.wbrels,-1,"theme/theme1.xml",Wt.THEME),o="xl/styles."+n,Yt(a,o,ny(e,i)),r.styles.push(o),Pn(i.wbrels,-1,"styles."+n,Wt.STY),e.vbaraw&&t&&(o="xl/vbaProject.bin",Yt(a,o,e.vbaraw),r.vba.push(o),Pn(i.wbrels,-1,"vbaProject.bin",Wt.VBA)),o="xl/metadata."+n,Yt(a,o,ay()),r.metadata.push(o),Pn(i.wbrels,-1,"metadata."+n,Wt.XLMETA),f.length>1&&(o="xl/persons/person.xml",Yt(a,o,fF(f,i)),r.people.push(o),Pn(i.wbrels,-1,"persons/person.xml",Wt.PEOPLE)),Yt(a,"[Content_Types].xml",bb(r,i)),Yt(a,"_rels/.rels",ol(i.rels)),Yt(a,"xl/_rels/workbook."+n+".rels",ol(i.wbrels)),delete i.revssf,delete i.ssf,a}function uf(e,i){var n="";switch((i||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=ea(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(i&&i.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function sL(e,i){return _t.find(e,"EncryptedPackage")?iL(e,i):ky(e,i)}function cL(e,i){var n,t=e,r=i||{};return r.type||(r.type=Zt&&Buffer.isBuffer(e)?"buffer":"base64"),n=tb(t,r),nL(n,r)}function By(e,i){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return yp(e.slice(n),i);default:break e}return ml.to_workbook(e,i)}function lL(e,i){var n="",t=uf(e,i);switch(i.type){case"base64":n=ea(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=Ls(e);break;default:throw new Error("Unrecognized type "+i.type)}return t[0]==239&&t[1]==187&&t[2]==191&&(n=wn(n)),i.type="binary",By(n,i)}function dL(e,i){var n=e;return i.type=="base64"&&(n=ea(n)),n=Cn.utils.decode(1200,n.slice(2),"str"),i.type="binary",By(n,i)}function mL(e){return e.match(/[^\x00-\x7F]/)?no(e):e}function gp(e,i,n,t){return t?(n.type="string",ml.to_workbook(e,n)):ml.to_workbook(i,n)}function kg(e,i){Sp();var n=i||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return kg(new Uint8Array(e),(n=Vn(n),n.type="array",n));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var t=e,r=[0,0,0,0],a=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),cl={},n.dateNF&&(cl.dateNF=n.dateNF),n.type||(n.type=Zt&&Buffer.isBuffer(e)?"buffer":"base64"),n.type=="file"&&(n.type=Zt?"buffer":"binary",t=a6(e),typeof Uint8Array<"u"&&!Zt&&(n.type="array")),n.type=="string"&&(a=!0,n.type="binary",n.codepage=65001,t=mL(e)),n.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return n=Vn(n),n.type="array",kg(kp(t),n)}switch((r=uf(t,n))[0]){case 208:if(r[1]===207&&r[2]===17&&r[3]===224&&r[4]===161&&r[5]===177&&r[6]===26&&r[7]===225)return sL(_t.read(t,n),n);break;case 9:if(r[1]<=8)return ky(t,n);break;case 60:return yp(t,n);case 73:if(r[1]===73&&r[2]===42&&r[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(r[1]===68)return hA(t,n);break;case 84:if(r[1]===65&&r[2]===66&&r[3]===76)return Gb.to_workbook(t,n);break;case 80:return r[1]===75&&r[2]<9&&r[3]<9?cL(t,n):gp(e,t,n,a);case 239:return r[3]===60?yp(t,n):gp(e,t,n,a);case 255:if(r[1]===254)return dL(t,n);if(r[1]===0&&r[2]===2&&r[3]===0)return Rs.to_workbook(t,n);break;case 0:if(r[1]===0&&(r[2]>=2&&r[3]===0||r[2]===0&&(r[3]===8||r[3]===9)))return Rs.to_workbook(t,n);break;case 3:case 131:case 139:case 140:return bp.to_workbook(t,n);case 123:if(r[1]===92&&r[2]===114&&r[3]===116)return Jb.to_workbook(t,n);break;case 10:case 13:case 32:return lL(t,n);case 137:if(r[1]===80&&r[2]===78&&r[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return fA.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?bp.to_workbook(t,n):gp(e,t,n,a)}function Ny(e,i){switch(i.type){case"base64":case"binary":break;case"buffer":case"array":i.type="";break;case"file":return Pd(i.file,_t.write(e,{type:Zt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+i.bookType+"' files");default:throw new Error("Unrecognized type "+i.type)}return _t.write(e,i)}function gL(e,i){var n=Vn(i||{}),t=rL(e,n);return uL(t,n)}function uL(e,i){var n={},t=Zt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(i.compression&&(n.compression="DEFLATE"),i.password)n.type=t;else switch(i.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+i.bookType+"' files");case"buffer":case"file":n.type=t;break;default:throw new Error("Unrecognized type "+i.type)}var r=e.FullPaths?_t.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!i.compression}):e.generate(n);if(typeof Deno<"u"&&typeof r=="string"){if(i.type=="binary"||i.type=="base64")return r;r=new Uint8Array(Eg(r))}return i.password&&typeof encrypt_agile<"u"?Ny(encrypt_agile(r,i.password),i):i.type==="file"?Pd(i.file,r):i.type=="string"?wn(r):r}function pL(e,i){var n=i||{},t=mN(e,n);return Ny(t,n)}function to(e,i,n){n||(n="");var t=n+e;switch(i.type){case"base64":return md(no(t));case"binary":return no(t);case"string":return e;case"file":return Pd(i.file,t,"utf8");case"buffer":return Zt?Io(t,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(t):to(t,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+i.type)}function fL(e,i){switch(i.type){case"base64":return md(e);case"binary":return e;case"string":return e;case"file":return Pd(i.file,e,"binary");case"buffer":return Zt?Io(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+i.type)}function hg(e,i){switch(i.type){case"string":case"base64":case"binary":for(var n="",t=0;t<e.length;++t)n+=String.fromCharCode(e[t]);return i.type=="base64"?md(n):i.type=="string"?wn(n):n;case"file":return Pd(i.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+i.type)}}function pf(e,i){Sp(),sB(e);var n=Vn(i||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var t=pf(e,n);return n.type="array",Eg(t)}var r=0;if(n.sheet&&(typeof n.sheet=="number"?r=n.sheet:r=e.SheetNames.indexOf(n.sheet),!e.SheetNames[r]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return to(rN(e,n),n);case"slk":case"sylk":return to(Wb.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"htm":case"html":return to(Ey(e.Sheets[e.SheetNames[r]],n),n);case"txt":return fL(Ly(e.Sheets[e.SheetNames[r]],n),n);case"csv":return to(ff(e.Sheets[e.SheetNames[r]],n),n,"\uFEFF");case"dif":return to(Gb.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"dbf":return hg(bp.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"prn":return to(ml.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"rtf":return to(Jb.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"eth":return to(Hb.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"fods":return to(Fy(e,n),n);case"wk1":return hg(Rs.sheet_to_wk1(e.Sheets[e.SheetNames[r]],n),n);case"wk3":return hg(Rs.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),hg(Ty(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),pL(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return gL(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function hL(e,i,n,t,r,a,o,l){var m=pi(n),g=l.defval,f=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,x=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:n,enumerable:!1})}catch{x.__rowNum__=n}else x.__rowNum__=n;if(!o||e[n])for(var C=i.s.c;C<=i.e.c;++C){var y=o?e[n][C]:e[t[C]+m];if(y===void 0||y.t===void 0){if(g===void 0)continue;a[C]!=null&&(x[a[C]]=g);continue}var b=y.v;switch(y.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(a[C]!=null){if(b==null)if(y.t=="e"&&b===null)x[a[C]]=null;else if(g!==void 0)x[a[C]]=g;else if(f&&b===null)x[a[C]]=null;else continue;else x[a[C]]=f&&(y.t!=="n"||y.t==="n"&&l.rawNumbers!==!1)?b:Eo(y,b,l);b!=null&&(h=!1)}}return{row:x,isempty:h}}function Tg(e,i){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},t=0,r=1,a=[],o=0,l="",m={s:{r:0,c:0},e:{r:0,c:0}},g=i||{},f=g.range!=null?g.range:e["!ref"];switch(g.header===1?t=1:g.header==="A"?t=2:Array.isArray(g.header)?t=3:g.header==null&&(t=0),typeof f){case"string":m=cn(f);break;case"number":m=cn(e["!ref"]),m.s.r=f;break;default:m=f}t>0&&(r=0);var h=pi(m.s.r),x=[],C=[],y=0,b=0,w=Array.isArray(e),A=m.s.r,E=0,I={};w&&!e[A]&&(e[A]=[]);var K=g.skipHidden&&e["!cols"]||[],Z=g.skipHidden&&e["!rows"]||[];for(E=m.s.c;E<=m.e.c;++E)if(!(K[E]||{}).hidden)switch(x[E]=Xn(E),n=w?e[A][E]:e[x[E]+h],t){case 1:a[E]=E-m.s.c;break;case 2:a[E]=x[E];break;case 3:a[E]=g.header[E-m.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),l=o=Eo(n,null,g),b=I[o]||0,!b)I[o]=1;else{do l=o+"_"+b++;while(I[l]);I[o]=b,I[l]=1}a[E]=l}for(A=m.s.r+r;A<=m.e.r;++A)if(!(Z[A]||{}).hidden){var k=hL(e,m,A,x,t,a,w,g);(k.isempty===!1||(t===1?g.blankrows!==!1:g.blankrows))&&(C[y++]=k.row)}return C.length=y,C}var Nv=/"/g;function _L(e,i,n,t,r,a,o,l){for(var m=!0,g=[],f="",h=pi(n),x=i.s.c;x<=i.e.c;++x)if(t[x]){var C=l.dense?(e[n]||[])[x]:e[t[x]+h];if(C==null)f="";else if(C.v!=null){m=!1,f=""+(l.rawNumbers&&C.t=="n"?C.v:Eo(C,null,l));for(var y=0,b=0;y!==f.length;++y)if((b=f.charCodeAt(y))===r||b===a||b===34||l.forceQuotes){f='"'+f.replace(Nv,'""')+'"';break}f=="ID"&&(f='"ID"')}else C.f!=null&&!C.F?(m=!1,f="="+C.f,f.indexOf(",")>=0&&(f='"'+f.replace(Nv,'""')+'"')):f="";g.push(f)}return l.blankrows===!1&&m?null:g.join(o)}function ff(e,i){var n=[],t=i==null?{}:i;if(e==null||e["!ref"]==null)return"";var r=cn(e["!ref"]),a=t.FS!==void 0?t.FS:",",o=a.charCodeAt(0),l=t.RS!==void 0?t.RS:`
`,m=l.charCodeAt(0),g=new RegExp((a=="|"?"\\|":a)+"+$"),f="",h=[];t.dense=Array.isArray(e);for(var x=t.skipHidden&&e["!cols"]||[],C=t.skipHidden&&e["!rows"]||[],y=r.s.c;y<=r.e.c;++y)(x[y]||{}).hidden||(h[y]=Xn(y));for(var b=0,w=r.s.r;w<=r.e.r;++w)(C[w]||{}).hidden||(f=_L(e,r,w,h,o,m,a,t),f!=null&&(t.strip&&(f=f.replace(g,"")),(f||t.blankrows!==!1)&&n.push((b++?l:"")+f)));return delete t.dense,n.join("")}function Ly(e,i){i||(i={}),i.FS="	",i.RS=`
`;var n=ff(e,i);if(typeof Cn>"u"||i.type=="string")return n;var t=Cn.utils.encode(1200,n,"str");return"\xFF\xFE"+t}function xL(e){var i="",n,t="";if(e==null||e["!ref"]==null)return[];var r=cn(e["!ref"]),a="",o=[],l,m=[],g=Array.isArray(e);for(l=r.s.c;l<=r.e.c;++l)o[l]=Xn(l);for(var f=r.s.r;f<=r.e.r;++f)for(a=pi(f),l=r.s.c;l<=r.e.c;++l)if(i=o[l]+a,n=g?(e[f]||[])[l]:e[i],t="",n!==void 0){if(n.F!=null){if(i=n.F,!n.f)continue;t=n.f,i.indexOf(":")==-1&&(i=i+":"+i)}if(n.f!=null)t=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)t=""+n.v;else if(n.t=="b")t=n.v?"TRUE":"FALSE";else if(n.w!==void 0)t="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?t="'"+n.v:t=""+n.v}}m[m.length]=i+"="+t}return m}function Vy(e,i,n){var t=n||{},r=+!t.skipHeader,a=e||{},o=0,l=0;if(a&&t.origin!=null)if(typeof t.origin=="number")o=t.origin;else{var m=typeof t.origin=="string"?Kn(t.origin):t.origin;o=m.r,l=m.c}var g,f={s:{c:0,r:0},e:{c:l,r:o+i.length-1+r}};if(a["!ref"]){var h=cn(a["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),o==-1&&(o=h.e.r+1,f.e.r=o+i.length-1+r)}else o==-1&&(o=0,f.e.r=i.length-1+r);var x=t.header||[],C=0;i.forEach(function(b,w){ci(b).forEach(function(A){(C=x.indexOf(A))==-1&&(x[C=x.length]=A);var E=b[A],I="z",K="",Z=Pt({c:l+C,r:o+w+r});g=Md(a,Z),E&&typeof E=="object"&&!(E instanceof Date)?a[Z]=E:(typeof E=="number"?I="n":typeof E=="boolean"?I="b":typeof E=="string"?I="s":E instanceof Date?(I="d",t.cellDates||(I="n",E=Di(E)),K=t.dateNF||Mt[14]):E===null&&t.nullError&&(I="e",E=0),g?(g.t=I,g.v=E,delete g.w,delete g.R,K&&(g.z=K)):a[Z]=g={t:I,v:E},K&&(g.z=K))})}),f.e.c=Math.max(f.e.c,l+x.length-1);var y=pi(o);if(r)for(C=0;C<x.length;++C)a[Xn(C+l)+y]={t:"s",v:x[C]};return a["!ref"]=zt(f),a}function CL(e,i){return Vy(null,e,i)}function Md(e,i,n){if(typeof i=="string"){if(Array.isArray(e)){var t=Kn(i);return e[t.r]||(e[t.r]=[]),e[t.r][t.c]||(e[t.r][t.c]={t:"z"})}return e[i]||(e[i]={t:"z"})}return typeof i!="number"?Md(e,Pt(i)):Md(e,Pt({r:i,c:n||0}))}function vL(e,i){if(typeof i=="number"){if(i>=0&&e.SheetNames.length>i)return i;throw new Error("Cannot find sheet # "+i)}else if(typeof i=="string"){var n=e.SheetNames.indexOf(i);if(n>-1)return n;throw new Error("Cannot find sheet name |"+i+"|")}else throw new Error("Cannot find sheet |"+i+"|")}function hf(){return{SheetNames:[],Sheets:{}}}function _f(e,i,n,t){var r=1;if(!n)for(;r<=65535&&e.SheetNames.indexOf(n="Sheet"+r)!=-1;++r,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(t&&e.SheetNames.indexOf(n)>=0){var a=n.match(/(^.*?)(\d+)$/);r=a&&+a[2]||0;var o=a&&a[1]||n;for(++r;r<=65535&&e.SheetNames.indexOf(n=o+r)!=-1;++r);}if(My(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=i,n}function bL(e,i,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var t=vL(e,i);switch(e.Workbook.Sheets[t]||(e.Workbook.Sheets[t]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[t].Hidden=n}function yL(e,i){return e.z=i,e}function Uy(e,i,n){return i?(e.l={Target:i},n&&(e.l.Tooltip=n)):delete e.l,e}function ML(e,i,n){return Uy(e,"#"+i,n)}function PL(e,i,n){e.c||(e.c=[]),e.c.push({t:i,a:n||"SheetJS"})}function OL(e,i,n,t){for(var r=typeof i!="string"?i:cn(i),a=typeof i=="string"?i:zt(i),o=r.s.r;o<=r.e.r;++o)for(var l=r.s.c;l<=r.e.c;++l){var m=Md(e,o,l);m.t="n",m.F=a,delete m.v,o==r.s.r&&l==r.s.c&&(m.f=n,t&&(m.D=!0))}return e}var ps={encode_col:Xn,encode_row:pi,encode_cell:Pt,encode_range:zt,decode_col:Yp,decode_row:$p,split_cell:N6,decode_cell:Kn,decode_range:$r,format_cell:Eo,sheet_add_aoa:pb,sheet_add_json:Vy,sheet_add_dom:Iy,aoa_to_sheet:hl,json_to_sheet:CL,table_to_sheet:Ay,table_to_book:DN,sheet_to_csv:ff,sheet_to_txt:Ly,sheet_to_json:Tg,sheet_to_html:Ey,sheet_to_formulae:xL,sheet_to_row_object_array:Tg,sheet_get_cell:Md,book_new:hf,book_append_sheet:_f,book_set_sheet_visibility:bL,cell_set_number_format:yL,cell_set_hyperlink:Uy,cell_set_internal_link:ML,cell_add_comment:PL,sheet_set_array_formula:OL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var fX=dd.version;var SL=["fileUploadContainer"],kL=(e,i)=>i.accountId,TL=(e,i)=>i.id;function EL(e,i){if(e&1&&(s(0,"mat-option",18),d(1),c()),e&2){let n=i.$implicit;P("value",n.accountId),u(),$t(" ",n.name," (",n.type,") ")}}function IL(e,i){if(e&1){let n=ue();s(0,"div",13)(1,"div",14)(2,"div",15)(3,"label",16),d(4,"Default Account"),c(),s(5,"mat-select",17),lt("valueChange",function(r){R(n);let a=v();return ct(a.defaultAccountId,r)||(a.defaultAccountId=r),B(r)}),Ge(6,EL,2,3,"mat-option",18,kL),c()()()()}if(e&2){let n=v();u(5),st("value",n.defaultAccountId),u(),He(n.accounts)}}function AL(e,i){if(e&1){let n=ue();s(0,"div",19)(1,"button",20),F("click",function(){R(n);let r=v();return B(r.downloadTemplate())}),s(2,"mat-icon"),d(3,"download"),c(),d(4," Download Excel Template "),c()()}}function DL(e,i){if(e&1&&(s(0,"div",30)(1,"mat-icon",31),d(2,"file_present"),c(),d(3),c()),e&2){let n=v(2);u(3),$t(" ",n.selectedFile.name," (",n.fileType,") ")}}function FL(e,i){if(e&1&&(s(0,"div",32)(1,"mat-icon",33),d(2,"error"),c(),s(3,"span",34),d(4),c()()),e&2){let n=v(2);u(4),L(n.error)}}function RL(e,i){if(e&1){let n=ue();s(0,"div",21)(1,"div",22,0)(3,"input",23),F("change",function(r){R(n);let a=v();return B(a.onFileSelected(r))}),c(),s(4,"div",24)(5,"mat-icon",25),d(6,"cloud_upload"),c(),s(7,"p",26),d(8),c(),s(9,"p",27),d(10,"Supports Excel (XLSX, XLS) files only"),c(),N(11,DL,4,2,"div",28),c()(),N(12,FL,5,1,"div",29),c()}if(e&2){let n=v();u(),ze("drag-over",n.isDragOver),u(2),P("disabled",n.isLoading),u(5),ne(" ",n.isLoading?"Processing...":"Click to select file or drag and drop"," "),u(3),P("ngIf",n.selectedFile),u(),P("ngIf",n.error)}}function BL(e,i){e&1&&(s(0,"div",35),re(1,"mat-spinner",36),s(2,"p",37),d(3,"Processing file..."),c()())}function NL(e,i){e&1&&(s(0,"div",49)(1,"div",50)(2,"mat-icon",51),d(3,"info"),c(),s(4,"span",52),d(5," Data imported from Google Sheets. Review and select the transactions you want to import into your account. "),c()()())}function LL(e,i){if(e&1&&(s(0,"mat-option",18)(1,"div",62)(2,"span",63),d(3),c()()()),e&2){let n=i.$implicit;P("value",n.id+"-"+n.name),u(3),L(n.name)}}function VL(e,i){if(e&1){let n=ue();s(0,"tr",48)(1,"td",46)(2,"mat-checkbox",53),F("change",function(){let r=R(n).$index,a=v(2);return B(a.toggleSelect(r))}),c()(),s(3,"td",54)(4,"span"),d(5),ce(6,"number"),c()(),s(7,"td",55),d(8),c(),s(9,"td",56)(10,"span",57),d(11),c()(),s(12,"td",58)(13,"mat-select",59),F("selectionChange",function(r){let a=R(n).$index,o=v(2);return B(o.updateCategory(a,r.value))}),s(14,"mat-option"),re(15,"ngx-mat-select-search",60),c(),Ge(16,LL,4,2,"mat-option",18,TL),ce(18,"async"),c()(),s(19,"td",61),d(20),ce(21,"date"),c()()}if(e&2){let n=i.$implicit,t=i.$index,r=v(2);u(2),P("checked",r.selectedToImport.has(t)),u(2),ze("income",n.type==="income")("expense",n.type==="expense"),u(),$t(" ",n.type==="income"?"+":"-","\u20B9",ht(6,16,n.amount,"1.2-2")," "),u(3),L(n.description),u(2),ze("income",n.type==="income")("expense",n.type==="expense"),u(),ne(" ",n.type," "),u(2),P("value",n.categoryId+"-"+n.category),u(2),P("formControl",r.categoryFilterCtrl),u(),He(xe(18,19,r.filteredCategories)),u(4),L(ht(21,21,n.date,"dd MMM yyyy"))}}function UL(e,i){if(e&1){let n=ue();s(0,"div",38),N(1,NL,6,0,"div",39),s(2,"div",40)(3,"h3",41),d(4),c(),s(5,"div",42)(6,"button",43),F("click",function(){R(n);let r=v();return B(r.toggleSelectAll())}),d(7),c(),s(8,"span",26),d(9),c()()(),s(10,"div",44)(11,"table",45)(12,"thead")(13,"tr")(14,"th",46)(15,"mat-checkbox",47),F("change",function(){R(n);let r=v();return B(r.toggleSelectAll())}),c()(),s(16,"th"),d(17,"Amount"),c(),s(18,"th"),d(19,"Description"),c(),s(20,"th"),d(21,"Type"),c(),s(22,"th"),d(23,"Category"),c(),s(24,"th"),d(25,"Date"),c()()(),s(26,"tbody"),Ge(27,VL,22,24,"tr",48,_1),c()()()()}if(e&2){let n=v();u(),P("ngIf",n.data==null?null:n.data.transactions),u(3),ne(" ",n.data.transactions?"Google Sheets Data Preview":"Preview & Select Transactions"," "),u(3),ne(" ",n.selectedToImport.size===n.parsedTransactions.length?"Deselect All":"Select All"," "),u(2),$t(" ",n.selectedToImport.size," of ",n.parsedTransactions.length," selected "),u(6),P("checked",n.selectedToImport.size===n.parsedTransactions.length)("indeterminate",n.selectedToImport.size>0&&n.selectedToImport.size<n.parsedTransactions.length),u(12),He(n.parsedTransactions)}}var xl=(()=>{let i=class i{constructor(t,r,a,o,l,m){this.dialogRef=t,this.data=r,this.notificationService=a,this.auth=o,this.store=l,this.ssrService=m,this.selectedFile=null,this.parsedTransactions=[],this.selectedToImport=new Set,this.error="",this.isLoading=!1,this.isDragOver=!1,this.fileType="",this.accounts=[],this.categories$=gt([]),this.categories=[],this.defaultAccountId="",this.categoryFilterCtrl=new dc,this.filteredCategories=new ho(1),this._onDestroy=new Bt,this.categories=this.data.categories,this.setupDragAndDrop(),this.loadAccountsAndCategories(),this.categories$.subscribe(g=>{this.filteredCategories.next(g.slice())}),this.categoryFilterCtrl.valueChanges.pipe(yt(this._onDestroy)).subscribe(()=>{this.filterCategories()}),r&&r.transactions&&Array.isArray(r.transactions)&&(this.parsedTransactions=this.setCategory(r.transactions),this.selectedToImport=new Set(this.parsedTransactions.map((g,f)=>f)),this.notificationService.success(`Loaded ${this.parsedTransactions.length} transactions from Google Sheets`))}ngOnDestroy(){this._onDestroy.next(),this._onDestroy.complete()}filterCategories(){this.categories$&&this.categories$.pipe(tr(1)).subscribe(t=>{let r=this.categoryFilterCtrl.value;if(r)r=r.toLowerCase();else{this.filteredCategories.next(t.slice());return}let a=t.filter(o=>o.name.toLowerCase().indexOf(r)>-1);this.filteredCategories.next(a)})}loadAccountsAndCategories(){return me(this,null,function*(){var r;if((r=this.auth.currentUser)!=null&&r.uid)try{this.store.select(ca).subscribe(a=>{this.accounts=a,a.length>0&&(this.defaultAccountId=a[0].accountId)}),this.categories$=this.store.select(un)}catch(a){console.error("Error loading accounts and categories:",a)}})}updateCategory(t,r){t!==-1&&(this.parsedTransactions[t].categoryId=r.split("-")[0],this.parsedTransactions[t].category=r.split("-")[1])}setupDragAndDrop(){var r;let t=(r=this.fileUploadContainer)==null?void 0:r.nativeElement;t&&(t.addEventListener("dragover",a=>{a.preventDefault(),a.stopPropagation(),this.isDragOver=!0}),t.addEventListener("dragleave",a=>{a.preventDefault(),a.stopPropagation(),this.isDragOver=!1}),t.addEventListener("drop",a=>{var l;a.preventDefault(),a.stopPropagation(),this.isDragOver=!1;let o=(l=a.dataTransfer)==null?void 0:l.files;o&&o.length>0&&this.handleFile(o[0])}))}onFileSelected(t){let r=t.target.files[0];r&&this.handleFile(r)}handleFile(t){if(!t){this.notificationService.warning("Please select a file");return}let r=[".xlsx",".xls"],a=t.name.toLowerCase().substring(t.name.lastIndexOf("."));if(!r.includes(a)){this.notificationService.error("Please select an Excel file (XLSX or XLS)");return}this.selectedFile=t,this.fileType=a.toUpperCase(),this.error="",this.isLoading=!0,this.notificationService.info(`Processing ${this.fileType} file...`),this.parseExcelFile(t)}parseExcelFile(t){let r=new FileReader;r.onload=a=>{try{let o=new Uint8Array(a.target.result),l=kg(o,{type:"array"});if(l.SheetNames.length===0){this.isLoading=!1,this.error="Excel file contains no sheets.",this.notificationService.error("No sheets found in Excel file");return}let m=l.SheetNames[0],g=l.Sheets[m],f=ps.sheet_to_json(g,{header:1});if(f.length<2){this.isLoading=!1,this.error="Excel file is empty or has no data rows.",this.notificationService.error("No data found in Excel file");return}let h=f[0],x=f.slice(1);if(!h||h.length===0){this.isLoading=!1,this.error="Excel file must have a header row.",this.notificationService.error("Invalid Excel format - missing headers");return}let C=ps.sheet_to_json(g,{defval:"",raw:!0});if(C.length===0){this.isLoading=!1,this.error="No valid data rows found in Excel file.",this.notificationService.error("No valid data in Excel file");return}this.isLoading=!1,this.processParsedData(C),this.notificationService.success(`Successfully parsed ${this.parsedTransactions.length} transactions from Excel file`)}catch(o){this.isLoading=!1,this.error="Error parsing Excel file. Please check the format.",this.notificationService.error("Failed to parse Excel file"),console.error("Excel parsing error:",o)}},r.onerror=()=>{this.isLoading=!1,this.error="Error reading Excel file.",this.notificationService.error("Failed to read Excel file")},r.readAsArrayBuffer(t)}processParsedData(t){if(!t||t.length===0){this.error="No valid data found in the file.",this.notificationService.error("No transactions found in the file");return}if(this.parseStandardFormat(t),this.parsedTransactions.length===0){this.error="No valid transactions found in the file.",this.notificationService.error("No valid transactions found");return}this.selectedToImport=new Set(this.parsedTransactions.map((r,a)=>a))}parseStandardFormat(t){this.parsedTransactions=t.map(r=>({type:(r.type||r.Type||r.TYPE||"expense").toLowerCase(),category:r.category||r.Category||r.CATEGORY||"Other",date:r.date||r.Date||r.DATE||new Date().toISOString().split("T")[0],description:r.description||r.Description||r.DESCRIPTION||r.payee||r.Payee||r.PAYEE||"",amount:parseFloat(r.amount||r.Amount||r.AMOUNT||"0")}))}toggleSelect(t){this.selectedToImport.has(t)?this.selectedToImport.delete(t):this.selectedToImport.add(t)}toggleSelectAll(){this.selectedToImport.size===this.parsedTransactions.length?this.selectedToImport.clear():this.selectedToImport=new Set(this.parsedTransactions.map((t,r)=>r))}downloadTemplate(){try{if(this.ssrService.isClientSide()){let t=[["Payee","Amount","Type","Category","Date","Notes"],["Salary Payment",5e4,"income","Salary","2024-01-15","Monthly salary"]],r=ps.aoa_to_sheet(t);r["!cols"]=[{width:20},{width:12},{width:10},{width:18},{width:12},{width:25}];let a=ps.book_new();ps.book_append_sheet(a,r,"Transactions");let o=[["Transaction Import Template - Instructions"],[""],["Column Descriptions:"],["Payee","Name of the person, merchant, or company"],["Amount","Transaction amount (positive number)"],["Type",'Must be either "income" or "expense"'],["Category","Transaction category (e.g., Salary, Food & Dining, etc.)"],["Date","Transaction date in YYYY-MM-DD format"],["Notes","Optional description or notes"],[""],["Important Notes:"],["- Keep the header row as is (Row 1)"],["- Use YYYY-MM-DD format for dates"],["- Delete sample row (Row 2) before adding your data"]],l=ps.aoa_to_sheet(o);l["!cols"]=[{width:60}],ps.book_append_sheet(a,l,"Instructions");let m=pf(a,{bookType:"xlsx",type:"array"}),g=new Blob([m],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),f=window.URL.createObjectURL(g),h=document.createElement("a");h.href=f,h.download="transaction_import_template.xlsx",h.click(),window.URL.revokeObjectURL(f),this.notificationService.success("Excel template downloaded successfully")}}catch(t){console.error("Error downloading template:",t),this.notificationService.error("Failed to download template")}}importSelected(){let t=this.parsedTransactions.filter((o,l)=>this.selectedToImport.has(l));if(t.length===0){this.notificationService.warning("Please select at least one transaction to import");return}let r=t.filter((o,l)=>!o.description||!o.description.trim()?(this.notificationService.warning(`Transaction ${l+1}: Description is required`),!1):!o.amount||o.amount<=0?(this.notificationService.warning(`Transaction ${l+1}: Amount must be greater than 0`),!1):!o.type||!["income","expense"].includes(o.type)?(this.notificationService.warning(`Transaction ${l+1}: Invalid transaction type`),!1):!o.category||!o.category.trim()?(this.notificationService.warning(`Transaction ${l+1}: Category is required`),!1):o.date?!0:(this.notificationService.warning(`Transaction ${l+1}: Date is required`),!1));if(r.length===0){this.notificationService.error("No valid transactions to import");return}r.length<t.length&&this.notificationService.warning(`${t.length-r.length} transactions were skipped due to validation errors`);let a=r.map(o=>le(oe({},o),{accountId:this.defaultAccountId||"default",categoryId:o.categoryId||"default",category:o.category||"default"}));this.notificationService.success(`Importing ${r.length} transactions`),this.dialogRef.close(a)}close(){this.dialogRef.close()}setCategory(t){return t.map(r=>{let a=this.categories.find(o=>o.name.toLowerCase()===r.category.toLowerCase());return a&&(r.categoryId=a.id,r.category=a.name),r})}};i.\u0275fac=function(r){return new(r||i)(Y(Mi),Y(Pi),Y(ft),Y(xt),Y(pt),Y(Vr))},i.\u0275cmp=Re({type:i,selectors:[["import-transactions"]],viewQuery:function(r,a){if(r&1&&ar(SL,5),r&2){let o;Ni(o=Li())&&(a.fileUploadContainer=o.first)}},decls:18,vars:11,consts:[["fileUploadContainer",""],[1,"import-dialog"],["mat-dialog-title","",1,"text-lg","font-semibold","mb-4"],[1,"mr-2"],["mat-dialog-content","",1,"max-h-[70vh]","overflow-y-auto"],["class","mb-6 p-4 bg-gray-50 rounded-lg",4,"ngIf"],["class","mb-2 flex justify-end",4,"ngIf"],["class","mb-6",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","transactions-preview",4,"ngIf"],["mat-dialog-actions","","align","end",1,"dialog-actions"],["mat-button","",1,"mr-2",3,"click"],["mat-raised-button","","color","primary",1,"import-button",3,"click","disabled"],[1,"mb-6","p-4","bg-gray-50","rounded-lg"],[1,"flex","flex-col","sm:flex-row","gap-4"],[1,"flex-1"],[1,"block","text-sm","font-medium","text-gray-600","mb-1"],["placeholder","Select account for imported transactions",1,"w-full",3,"valueChange","value"],[3,"value"],[1,"mb-2","flex","justify-end"],["mat-stroked-button","","color","primary",1,"w-full","sm:w-auto",3,"click"],[1,"mb-6"],[1,"file-upload-container"],["type","file","accept",".xlsx,.xls",1,"file-input",3,"change","disabled"],[1,"file-upload-overlay"],[1,"text-4xl","mb-2"],[1,"text-sm","text-gray-600"],[1,"text-xs","text-gray-500","mt-1"],["class","mt-2 p-2 bg-blue-50 rounded text-xs text-blue-700",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"mt-2","p-2","bg-blue-50","rounded","text-xs","text-blue-700"],[1,"text-sm","mr-1"],[1,"error-message"],[1,"text-red-500"],[1,"text-red-600","text-sm"],[1,"loading-container"],["diameter","40"],[1,"mt-2","text-gray-600"],[1,"transactions-preview"],["class","mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",4,"ngIf"],[1,"preview-header"],[1,"font-semibold","mb-2"],[1,"preview-actions"],["mat-button","","color","primary",1,"text-sm",3,"click"],[1,"table-container"],[1,"transactions-table"],[1,"checkbox-col"],[3,"change","checked","indeterminate"],[1,"transaction-row"],[1,"mb-4","p-3","bg-blue-50","border","border-blue-200","rounded-lg"],[1,"flex","items-center","gap-2"],[1,"text-blue-600","text-sm"],[1,"text-sm","text-blue-800"],[3,"change","checked"],[1,"amount-cell"],[1,"payee-cell"],[1,"type-cell"],[1,"type-badge"],[1,"category-cell"],[1,"category-select",3,"selectionChange","value"],["placeholderLabel","Search categories...","noEntriesFoundLabel","No categories found",3,"formControl"],[1,"date-cell"],[1,"option-content"],[1,"option-text"]],template:function(r,a){r&1&&(s(0,"div",1)(1,"h2",2)(2,"mat-icon",3),d(3),c(),d(4),c(),s(5,"div",4),N(6,IL,8,1,"div",5)(7,AL,5,0,"div",6)(8,RL,13,6,"div",7)(9,BL,4,0,"div",8)(10,UL,29,7,"div",9),c(),s(11,"div",10)(12,"button",11),F("click",function(){return a.close()}),d(13,"Cancel"),c(),s(14,"button",12),F("click",function(){return a.importSelected()}),s(15,"mat-icon"),d(16),c(),d(17),c()()()),r&2&&(u(3),L(a.data.transactions?"table_chart":"upload_file"),u(),ne(" ",a.data.transactions?"Import from Google Sheets":"Import Transactions"," "),u(2),P("ngIf",a.accounts.length>0),u(),P("ngIf",!(a.data!=null&&a.data.transactions)),u(),P("ngIf",!(a.data!=null&&a.data.transactions)),u(),P("ngIf",a.isLoading&&!(a.data!=null&&a.data.transactions)),u(),P("ngIf",a.parsedTransactions.length&&!a.isLoading),u(4),P("disabled",!a.parsedTransactions.length||a.selectedToImport.size===0),u(2),L(a.data.transactions?"table_chart":"cloud_upload"),u(),$t(" ",a.data.transactions?"Import from Sheets":"Import Selected"," (",a.selectedToImport.size,") "))},dependencies:[dt,At,mc,Jt,Qe,Br,wi,yi,Q0,em,J0,za,Gl,Vi,Vo,_i],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-width:350px}.import-dialog[_ngcontent-%COMP%]{padding:.5rem}.import-header[_ngcontent-%COMP%]{margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid #e5e7eb}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem}@media (max-width: 640px){.header-content[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:1rem}}.title-section[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem;flex:1}.title-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:1.75rem;width:1.75rem;height:1.75rem;margin-top:.125rem}@media (max-width: 640px){.title-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem}}.title-text[_ngcontent-%COMP%]{flex:1}.dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:700;color:#111827;line-height:1.2}@media (max-width: 640px){.dialog-title[_ngcontent-%COMP%]{font-size:1.25rem}}.dialog-subtitle[_ngcontent-%COMP%]{margin:.25rem 0 0;font-size:.875rem;color:#6b7280;line-height:1.4}@media (max-width: 640px){.dialog-subtitle[_ngcontent-%COMP%]{font-size:.8rem}}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center}@media (max-width: 640px){.header-actions[_ngcontent-%COMP%]{justify-content:stretch}}.download-template-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.625rem 1rem;border-radius:8px;font-weight:500;transition:all .2s ease;border:2px solid #3b82f6;background:transparent;color:#3b82f6}.download-template-btn[_ngcontent-%COMP%]:hover{background:#3b82f6;color:#fff;transform:translateY(-1px);box-shadow:0 4px 12px #3b82f64d}.download-template-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}@media (max-width: 640px){.download-template-btn[_ngcontent-%COMP%]{width:100%;justify-content:center;padding:.75rem 1rem}}.btn-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.btn-text[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500}@media (max-width: 640px){.btn-text[_ngcontent-%COMP%]{font-size:.9rem}}.file-upload-container[_ngcontent-%COMP%]{position:relative;border:2px dashed #d1d5db;border-radius:8px;padding:2rem;text-align:center;transition:all .3s ease;background:#f9fafb;cursor:pointer}.file-upload-container[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#f0f9ff}.file-upload-container.drag-over[_ngcontent-%COMP%]{border-color:#3b82f6;background:#dbeafe}.file-input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer;z-index:2}.file-upload-overlay[_ngcontent-%COMP%]{pointer-events:none;z-index:1}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-top:.5rem;padding:.75rem;background:#fef2f2;border:1px solid #fecaca;border-radius:6px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem 1rem;text-align:center}.transactions-preview[_ngcontent-%COMP%]{margin-top:1.5rem}.preview-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;flex-wrap:wrap;gap:.5rem}@media (max-width: 640px){.preview-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}.preview-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}@media (max-width: 640px){.preview-actions[_ngcontent-%COMP%]{width:100%;justify-content:space-between}}.table-container[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:8px;overflow:hidden;background:#fff;overflow-x:auto}.transactions-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.875rem;min-width:600px}.transactions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .transactions-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;text-align:left;border-bottom:1px solid #f3f4f6}.transactions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f9fafb;font-weight:600;color:#374151;position:sticky;top:0;z-index:10}.transactions-table[_ngcontent-%COMP%]   .checkbox-col[_ngcontent-%COMP%]{width:48px;text-align:center}.transactions-table[_ngcontent-%COMP%]   .payee-cell[_ngcontent-%COMP%]{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.transactions-table[_ngcontent-%COMP%]   .amount-cell[_ngcontent-%COMP%]{font-weight:600;text-align:right}.transactions-table[_ngcontent-%COMP%]   .amount-cell[_ngcontent-%COMP%]   .income[_ngcontent-%COMP%]{color:#059669}.transactions-table[_ngcontent-%COMP%]   .amount-cell[_ngcontent-%COMP%]   .expense[_ngcontent-%COMP%]{color:#dc2626}.transactions-table[_ngcontent-%COMP%]   .type-cell[_ngcontent-%COMP%]{text-align:center}.transactions-table[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:12px;font-size:.75rem;font-weight:500;text-transform:capitalize}.transactions-table[_ngcontent-%COMP%]   .type-badge.income[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.transactions-table[_ngcontent-%COMP%]   .type-badge.expense[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.transactions-table[_ngcontent-%COMP%]   .category-cell[_ngcontent-%COMP%]{max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.transactions-table[_ngcontent-%COMP%]   .category-select[_ngcontent-%COMP%]{width:100%;font-size:.75rem}.transactions-table[_ngcontent-%COMP%]   .category-select[_ngcontent-%COMP%]     .mat-mdc-select-trigger{height:auto;min-height:32px;padding:.25rem .5rem;background:#f8fafc;border:1px solid transparent;border-radius:4px;transition:all .2s ease}.transactions-table[_ngcontent-%COMP%]   .category-select[_ngcontent-%COMP%]     .mat-mdc-select-trigger:hover{background:#e2e8f0;border-color:#cbd5e1}.transactions-table[_ngcontent-%COMP%]   .category-select[_ngcontent-%COMP%]     .mat-mdc-select-value{color:#374151;font-size:.75rem}.transactions-table[_ngcontent-%COMP%]   .category-select[_ngcontent-%COMP%]     .mat-mdc-select-arrow{color:#6b7280}.transactions-table[_ngcontent-%COMP%]   .option-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%}.transactions-table[_ngcontent-%COMP%]   .option-text[_ngcontent-%COMP%]{font-size:.75rem;color:#374151;flex:1}.transactions-table[_ngcontent-%COMP%]   .option-badge[_ngcontent-%COMP%]{font-size:.625rem;padding:.125rem .375rem;border-radius:8px;font-weight:500;margin-left:.5rem;text-transform:capitalize}.transactions-table[_ngcontent-%COMP%]   .option-badge.original[_ngcontent-%COMP%]{background:#fbbf24;color:#92400e}.transactions-table[_ngcontent-%COMP%]   .option-badge.income[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.transactions-table[_ngcontent-%COMP%]   .option-badge.expense[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.transactions-table[_ngcontent-%COMP%]   .no-categories-text[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-style:italic}.transactions-table[_ngcontent-%COMP%]     .keep-original-option{background:#fef3c7}.transactions-table[_ngcontent-%COMP%]     .keep-original-option:hover{background:#fde68a!important}.transactions-table[_ngcontent-%COMP%]     .keep-original-option.mat-mdc-option-active{background:#fde68a!important}.transactions-table[_ngcontent-%COMP%]   .date-cell[_ngcontent-%COMP%]{text-align:center;white-space:nowrap}.transactions-table[_ngcontent-%COMP%]   .transaction-row[_ngcontent-%COMP%]{transition:background-color .2s ease}.transactions-table[_ngcontent-%COMP%]   .transaction-row[_ngcontent-%COMP%]:hover{background:#f9fafb}.dialog-actions[_ngcontent-%COMP%]{padding:1rem 0 0;border-top:1px solid #e5e7eb;margin-top:1rem}@media (max-width: 640px){.dialog-actions[_ngcontent-%COMP%]{flex-direction:column-reverse;gap:.5rem}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}@media (max-width: 640px){.import-button[_ngcontent-%COMP%]{margin-bottom:.5rem}}@media (max-width: 768px){.transactions-table[_ngcontent-%COMP%]{font-size:.75rem}.transactions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .transactions-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem}.transactions-table[_ngcontent-%COMP%]   .payee-cell[_ngcontent-%COMP%]{max-width:120px}.transactions-table[_ngcontent-%COMP%]   .category-cell[_ngcontent-%COMP%]{max-width:80px}.file-upload-container[_ngcontent-%COMP%]{padding:1.5rem}}@media (max-width: 480px){.transactions-table[_ngcontent-%COMP%]{font-size:.7rem}.transactions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .transactions-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.375rem}.transactions-table[_ngcontent-%COMP%]   .payee-cell[_ngcontent-%COMP%]{max-width:100px}.transactions-table[_ngcontent-%COMP%]   .category-cell[_ngcontent-%COMP%]{max-width:60px}.file-upload-container[_ngcontent-%COMP%]{padding:1rem}.preview-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem}}"]});let e=i;return e})();var oo=Yr(Xr());var zy=(()=>{let i=class i{constructor(t){this.dateService=t,this.oldRegimeSlabs=[{minIncome:0,maxIncome:25e4,rate:0,description:"Up to \u20B92,50,000"},{minIncome:250001,maxIncome:5e5,rate:5,description:"\u20B92,50,001 - \u20B95,00,000"},{minIncome:500001,maxIncome:1e6,rate:20,description:"\u20B95,00,001 - \u20B910,00,000"},{minIncome:1000001,maxIncome:1/0,rate:30,description:"Above \u20B910,00,000"}],this.newRegimeSlabs=[{minIncome:0,maxIncome:3e5,rate:0,description:"Up to \u20B93,00,000"},{minIncome:300001,maxIncome:6e5,rate:5,description:"\u20B93,00,001 - \u20B96,00,000"},{minIncome:600001,maxIncome:9e5,rate:10,description:"\u20B96,00,001 - \u20B99,00,000"},{minIncome:900001,maxIncome:12e5,rate:15,description:"\u20B99,00,001 - \u20B912,00,000"},{minIncome:1200001,maxIncome:15e5,rate:20,description:"\u20B912,00,001 - \u20B915,00,000"},{minIncome:1500001,maxIncome:1/0,rate:30,description:"Above \u20B915,00,000"}],this.NEW_REGIME_STANDARD_DEDUCTION=Ut.VALIDATION.MAX_AMOUNT*.05}calculateTotalIncome(t,r=2025){let a=new Date(r-1,3,1),o=new Date(r,2,31);return t.filter(l=>{let m=this.dateService.toDate(l.date)||new Date;return l.type==="income"&&m>=a&&m<=o}).reduce((l,m)=>l+m.amount,0)}getDefaultDeductions(){return[{section:"80C",description:"ELSS, PPF, EPF, Life Insurance, etc.",maxAmount:15e4,currentAmount:0},{section:"80D",description:"Health Insurance Premium",maxAmount:25e3,currentAmount:0},{section:"80G",description:"Donations to Charitable Institutions",maxAmount:1e5,currentAmount:0},{section:"80TTA",description:"Interest on Savings Account",maxAmount:1e4,currentAmount:0},{section:"HRA",description:"House Rent Allowance Exemption",maxAmount:0,currentAmount:0},{section:"LTA",description:"Leave Travel Allowance",maxAmount:0,currentAmount:0}]}calculateOldRegimeTax(t,r){let a=r.reduce((f,h)=>f+h.currentAmount,0),o=Math.max(0,t-a),l=this.calculateTaxBySlabs(o,this.oldRegimeSlabs),m=l*.04,g=l+m;return{totalIncome:t,deductions:r,totalDeductions:a,taxableIncome:o,incomeTax:l,cess:m,totalTaxLiability:g,regime:"old"}}calculateNewRegimeTax(t){let r=Math.max(0,t-this.NEW_REGIME_STANDARD_DEDUCTION),a=this.calculateTaxBySlabs(r,this.newRegimeSlabs),o=a*.04,l=a+o;return{totalIncome:t,deductions:[{section:"Standard",description:"Standard Deduction",maxAmount:this.NEW_REGIME_STANDARD_DEDUCTION,currentAmount:this.NEW_REGIME_STANDARD_DEDUCTION}],totalDeductions:this.NEW_REGIME_STANDARD_DEDUCTION,taxableIncome:r,incomeTax:a,cess:o,totalTaxLiability:l,regime:"new"}}calculateTaxBySlabs(t,r){let a=0,o=t;for(let l of r){if(o<=0)break;let m=Math.min(o,l.maxIncome===1/0?o:l.maxIncome-l.minIncome+1);a+=m*l.rate/100,o-=m}return a}calculateGST(t,r=18){let a=t*r/100,o=a/2,l=a/2;return{baseAmount:t,cgst:o,sgst:l,totalGST:a}}getTaxSlabs(t){return t==="old"?this.oldRegimeSlabs:this.newRegimeSlabs}compareRegimes(t,r){let a=this.calculateOldRegimeTax(t,r),o=this.calculateNewRegimeTax(t),l=a.totalTaxLiability-o.totalTaxLiability,m=l>0?"new":"old";return{oldRegime:a,newRegime:o,recommendation:m,savings:Math.abs(l)}}generateTaxReport(t,r){return`
INDIAN TAX ANALYSIS REPORT
Financial Year: 2024-25
Tax Regime: ${t.regime==="old"?"Old Regime (With Deductions)":"New Regime (Simplified)"}

INCOME DETAILS:
Total Income: \u20B9${t.totalIncome.toLocaleString("en-IN")}

${t.regime==="old"?`
DEDUCTIONS:
${t.deductions.map(o=>`${o.section}: \u20B9${o.currentAmount.toLocaleString("en-IN")}`).join(`
`)}
Total Deductions: \u20B9${t.totalDeductions.toLocaleString("en-IN")}
`:`
STANDARD DEDUCTION:
Standard Deduction: \u20B9${t.totalDeductions.toLocaleString("en-IN")}
`}

TAXABLE INCOME: \u20B9${t.taxableIncome.toLocaleString("en-IN")}

TAX CALCULATION:
Income Tax: \u20B9${t.incomeTax.toLocaleString("en-IN")}
Cess (4%): \u20B9${t.cess.toLocaleString("en-IN")}
TOTAL TAX LIABILITY: \u20B9${t.totalTaxLiability.toLocaleString("en-IN")}

${r?`
GST ANALYSIS:
Base Amount: \u20B9${r.baseAmount.toLocaleString("en-IN")}
CGST (9%): \u20B9${r.cgst.toLocaleString("en-IN")}
SGST (9%): \u20B9${r.sgst.toLocaleString("en-IN")}
Total GST (18%): \u20B9${r.totalGST.toLocaleString("en-IN")}
`:""}

Generated on: ${new Date().toLocaleDateString("en-IN")}
    `}};i.\u0275fac=function(r){return new(r||i)(De(Vt))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();function jL(e,i){e&1&&(s(0,"div",44),d(1," Please enter a valid income amount "),c())}function $L(e,i){if(e&1){let n=ue();s(0,"div",38)(1,"form",39)(2,"div")(3,"label",40),d(4,"Annual Income (\u20B9)"),c(),s(5,"input",41),F("input",function(r){R(n);let a=v();return B(a.onInputChange(r))})("blur",function(){R(n);let r=v();return B(r.onManualIncomeChange())}),c(),s(6,"div",42),d(7),c(),N(8,jL,2,0,"div",43),c()()()}if(e&2){let n,t=v();u(),P("formGroup",t.taxForm),u(6),$t(" Enter your total annual income for FY ",t.currentYear,"-",t.currentYear+1," "),u(),P("ngIf",((n=t.taxForm.get("manualIncome"))==null?null:n.invalid)&&((n=t.taxForm.get("manualIncome"))==null?null:n.touched))}}function YL(e,i){if(e&1&&(s(0,"div",45)(1,"div",46)(2,"div")(3,"div",47),d(4,"Income from Transactions"),c(),s(5,"div",48),d(6),c(),s(7,"div",49),d(8),c()(),s(9,"mat-icon",50),d(10,"check_circle"),c()()()),e&2){let n=v();u(6),L(n.formatCurrency(n.totalIncome)),u(2),$t(" Calculated from your income transactions for FY ",n.currentYear,"-",n.currentYear+1," ")}}function WL(e,i){e&1&&(s(0,"div",51)(1,"div",52),re(2,"mat-spinner",53),s(3,"span",54),d(4,"Calculating tax from your transactions..."),c()()())}function GL(e,i){if(e&1&&(s(0,"div",55)(1,"div",22)(2,"h4",56)(3,"mat-icon",57),d(4,"account_balance"),c(),d(5," Tax Calculation Summary "),c(),s(6,"div",58)(7,"div",59)(8,"span",54),d(9),c(),s(10,"span",60),d(11),c()(),s(12,"div",59)(13,"span",54),d(14,"Standard Deduction"),c(),s(15,"span",61),d(16),c()(),s(17,"div",62)(18,"span",63),d(19,"Taxable Income"),c(),s(20,"span",64),d(21),c()(),s(22,"div",59)(23,"span",54),d(24,"Income Tax"),c(),s(25,"span",65),d(26),c()(),s(27,"div",59)(28,"span",54),d(29,"Cess (4%)"),c(),s(30,"span",65),d(31),c()(),s(32,"div",66)(33,"span",67),d(34,"Total Tax Liability"),c(),s(35,"span",68),d(36),c()()()(),s(37,"div",22)(38,"h4",56)(39,"mat-icon",11),d(40,"info"),c(),d(41," Tax Details "),c(),s(42,"div",58)(43,"div",59)(44,"span",54),d(45,"Current Tax Slab"),c(),s(46,"span",69),d(47),c()(),s(48,"div",59)(49,"span",54),d(50,"Effective Tax Rate"),c(),s(51,"span",69),d(52),c()(),s(53,"div",59)(54,"span",54),d(55,"Monthly Tax"),c(),s(56,"span",70),d(57),c()(),s(58,"div",59)(59,"span",54),d(60,"Net Income After Tax"),c(),s(61,"span",71),d(62),c()(),s(63,"div",38)(64,"div",72)(65,"strong"),d(66,"Note:"),c(),d(67," This calculation uses the new tax regime with simplified rates and standard deduction of \u20B950,000. "),c()()()()()),e&2){let n=v();u(9),$t("Total Income (FY ",n.currentYear,"-",n.currentYear+1,")"),u(2),L(n.formatCurrency(n.taxCalculation.totalIncome)),u(5),L(n.formatCurrency(n.taxCalculation.totalDeductions)),u(5),L(n.formatCurrency(n.taxCalculation.taxableIncome)),u(5),L(n.formatCurrency(n.taxCalculation.incomeTax)),u(5),L(n.formatCurrency(n.taxCalculation.cess)),u(5),L(n.formatCurrency(n.taxCalculation.totalTaxLiability)),u(11),L(n.getCurrentTaxSlab()),u(5),ne("",n.taxCalculation.totalIncome>0?(n.taxCalculation.totalTaxLiability/n.taxCalculation.totalIncome*100).toFixed(2):"0","%"),u(5),L(n.formatCurrency(n.taxCalculation.totalTaxLiability/12)),u(5),L(n.formatCurrency(n.taxCalculation.totalIncome-n.taxCalculation.totalTaxLiability))}}function HL(e,i){if(e&1&&(s(0,"div",51)(1,"div",73)(2,"mat-icon",74),d(3,"account_balance_wallet"),c(),s(4,"h3",75),d(5),c(),s(6,"p",76),d(7),c(),s(8,"p",77),d(9),c()()()),e&2){let n=v();u(5),ne(" ",n.useManualIncome?"No Income Entered":"No Income Transactions Found"," "),u(2),ne(" ",n.useManualIncome?"Please enter your annual income to see the tax calculation.":"We couldn't find any income transactions for FY "+n.currentYear+"-"+(n.currentYear+1)+"."," "),u(2),ne(" ",n.useManualIncome?"Enter your income in the manual input field above.":"Add income transactions to see your tax calculation."," ")}}var Ug=(()=>{let i=class i{constructor(t,r,a,o,l){this.auth=t,this.taxService=r,this.notificationService=a,this.store=o,this.fb=l,this.taxCalculation=null,this.transactions=[],this.totalIncome=0,this.currentYear=new Date().getFullYear(),this.useManualIncome=!1,this.isLoading=!1,this.subscriptions=[],this.taxForm=this.fb.group({manualIncome:[0,[tt.required,tt.min(0)]]})}ngOnInit(){this.loadTransactions()}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}loadTransactions(){var r;if((r=this.auth.currentUser)==null?void 0:r.uid){let a=this.store.select(Gn).pipe(tr(1)).subscribe({next:o=>{this.transactions=o,this.calculateTaxFromTransactions()},error:o=>{console.error("Error loading transactions:",o),this.notificationService.error("Failed to load transaction data")}});this.subscriptions.push(a)}}calculateTaxFromTransactions(){this.isLoading=!0;try{this.totalIncome=this.taxService.calculateTotalIncome(this.transactions,this.currentYear),this.calculateTax(),this.totalIncome>0&&this.notificationService.success("Tax calculation completed successfully!")}catch(t){console.error("Error calculating tax:",t),this.notificationService.error("Failed to calculate tax.")}finally{this.isLoading=!1}}calculateTax(){let t=this.getCurrentIncome();this.taxCalculation=this.taxService.calculateNewRegimeTax(t)}toggleIncomeSource(){if(this.useManualIncome=!this.useManualIncome,this.useManualIncome){let t=this.totalIncome>0?this.totalIncome:0;this.taxForm.patchValue({manualIncome:t}),setTimeout(()=>this.calculateTax(),0)}else this.calculateTax()}onManualIncomeChange(){if(this.useManualIncome){let t=this.taxForm.value.manualIncome;t!=null&&t>=0&&this.calculateTax()}}onInputChange(t){let r=t.target.value;if(this.useManualIncome&&r!==""){let a=parseFloat(r);!isNaN(a)&&a>=0&&(this.taxForm.patchValue({manualIncome:a}),this.calculateTax())}}getCurrentIncome(){if(this.useManualIncome){let t=this.taxForm.value.manualIncome;return t!=null&&t>=0?t:0}return this.totalIncome}formatCurrency(t){return`\u20B9${t.toLocaleString("en-IN")}`}getCurrentTaxSlab(){if(!this.taxCalculation)return"N/A";let t=this.taxService.getTaxSlabs("new"),r=this.taxCalculation.taxableIncome;for(let a of t)if(r<=a.maxIncome)return`${a.description} (${a.rate}%)`;return"Above \u20B915,00,000 (30%)"}isManualIncomeValid(){var t;return((t=this.taxForm.get("manualIncome"))==null?void 0:t.valid)||!1}};i.\u0275fac=function(r){return new(r||i)(Y(xt),Y(zy),Y(ft),Y(pt),Y(vi))},i.\u0275cmp=Re({type:i,selectors:[["app-tax"]],decls:127,vars:27,consts:[[1,"min-h-screen","bg-gray-50","p-4","sm:p-6","lg:p-8"],[1,"max-w-7xl","mx-auto"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-6","mb-6"],[1,"flex","flex-col","sm:flex-row","sm:justify-between","sm:items-center","gap-4"],[1,"flex-1"],[1,"text-2xl","sm:text-3xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600","text-sm","sm:text-base"],[1,"flex","items-center"],[1,"text-blue-600","mr-2"],[1,"text-blue-600","font-medium"],[1,"text-xl","font-semibold","text-gray-900","mb-4","flex","items-center"],[1,"text-green-600","mr-3"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4","mb-6"],["mat-raised-button","",1,"flex","items-center","justify-center","space-x-3","p-4","h-auto","min-h-[60px]","transition-all","duration-200","hover:shadow-md",3,"click","color"],[1,"text-xl"],[1,"text-left"],[1,"font-semibold"],[1,"text-xs","opacity-80"],["class","bg-blue-50 p-4 rounded-lg border border-blue-200",4,"ngIf"],["class","bg-green-50 p-4 rounded-lg border border-green-200",4,"ngIf"],["class","bg-white rounded-xl shadow-sm border border-gray-100 p-8 mb-6",4,"ngIf"],["class","grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",4,"ngIf"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-6"],[1,"text-lg","font-semibold","text-gray-900","mb-6","flex","items-center"],[1,"text-purple-600","mr-3"],[1,"overflow-x-auto","rounded-lg","border","border-gray-200"],[1,"w-full"],[1,"bg-gray-50"],[1,"px-4","py-3","text-left","font-semibold","text-gray-700","text-sm"],[1,"divide-y","divide-gray-200"],[1,"hover:bg-gray-50","transition-colors"],[1,"px-4","py-3","text-sm"],[1,"px-4","py-3","text-green-600","font-medium","text-sm"],[1,"hover:bg-red-50","transition-colors","bg-red-50"],[1,"px-4","py-3","font-medium","text-sm"],[1,"mt-6","p-4","bg-blue-50","rounded-lg","border","border-blue-200"],[1,"font-semibold","text-blue-800","mb-2"],[1,"text-sm","text-blue-700","space-y-1"],[1,"bg-blue-50","p-4","rounded-lg","border","border-blue-200"],[1,"space-y-4",3,"formGroup"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","number","formControlName","manualIncome","placeholder","Enter your annual income",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"input","blur"],[1,"text-xs","text-gray-500","mt-1"],["class","text-red-500 text-xs mt-1",4,"ngIf"],[1,"text-red-500","text-xs","mt-1"],[1,"bg-green-50","p-4","rounded-lg","border","border-green-200"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-green-800"],[1,"text-2xl","font-bold","text-green-700"],[1,"text-xs","text-green-600","mt-1"],[1,"text-green-600","text-3xl"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-8","mb-6"],[1,"flex","items-center","justify-center"],["diameter","40",1,"mr-4"],[1,"text-gray-600"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6","mb-6"],[1,"text-lg","font-semibold","text-gray-900","mb-4","flex","items-center"],[1,"text-blue-600","mr-3"],[1,"space-y-4"],[1,"flex","justify-between","items-center","py-3","border-b","border-gray-100"],[1,"font-semibold","text-gray-900","text-lg"],[1,"font-semibold","text-green-600","text-lg"],[1,"flex","justify-between","items-center","py-3","border-b-2","border-blue-200","bg-blue-50","px-4","rounded-lg"],[1,"text-gray-700","font-medium"],[1,"font-bold","text-blue-700","text-lg"],[1,"font-semibold","text-red-600","text-lg"],[1,"flex","justify-between","items-center","py-4","bg-red-50","px-4","rounded-lg","border-2","border-red-200"],[1,"text-gray-700","font-semibold"],[1,"font-bold","text-red-700","text-xl"],[1,"font-semibold","text-blue-600"],[1,"font-semibold","text-red-600"],[1,"font-semibold","text-green-600"],[1,"text-sm","text-blue-800"],[1,"text-center"],[1,"text-gray-400","text-6xl","mb-4"],[1,"text-xl","font-semibold","text-gray-700","mb-2"],[1,"text-gray-500","mb-4"],[1,"text-sm","text-gray-400"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),d(6,"Tax Analysis"),c(),s(7,"p",6),d(8),c()(),s(9,"div",7)(10,"mat-icon",8),d(11,"new_releases"),c(),s(12,"span",9),d(13,"New Regime"),c()()()(),s(14,"div",2)(15,"h3",10)(16,"mat-icon",11),d(17,"account_balance_wallet"),c(),d(18," Income Source "),c(),s(19,"div",12)(20,"button",13),F("click",function(){return a.toggleIncomeSource()}),s(21,"mat-icon",14),d(22,"sync"),c(),s(23,"div",15)(24,"div",16),d(25,"Auto from Transactions"),c(),s(26,"div",17),d(27,"Use your transaction data"),c()()(),s(28,"button",13),F("click",function(){return a.toggleIncomeSource()}),s(29,"mat-icon",14),d(30,"edit"),c(),s(31,"div",15)(32,"div",16),d(33,"Manual Entry"),c(),s(34,"div",17),d(35,"Enter income manually"),c()()()(),N(36,$L,9,4,"div",18)(37,YL,11,3,"div",19),c(),N(38,WL,5,0,"div",20)(39,GL,68,12,"div",21)(40,HL,10,3,"div",20),s(41,"div",22)(42,"h4",23)(43,"mat-icon",24),d(44,"table_chart"),c(),d(45),c(),s(46,"div",25)(47,"table",26)(48,"thead")(49,"tr",27)(50,"th",28),d(51,"Income Range"),c(),s(52,"th",28),d(53,"Tax Rate"),c(),s(54,"th",28),d(55,"Cess"),c(),s(56,"th",28),d(57,"Effective Rate"),c()()(),s(58,"tbody",29)(59,"tr",30)(60,"td",31),d(61,"Up to \u20B93,00,000"),c(),s(62,"td",32),d(63,"Nil"),c(),s(64,"td",31),d(65,"-"),c(),s(66,"td",32),d(67,"0%"),c()(),s(68,"tr",30)(69,"td",31),d(70,"\u20B93,00,001 - \u20B96,00,000"),c(),s(71,"td",31),d(72,"5%"),c(),s(73,"td",31),d(74,"4%"),c(),s(75,"td",31),d(76,"5.2%"),c()(),s(77,"tr",30)(78,"td",31),d(79,"\u20B96,00,001 - \u20B99,00,000"),c(),s(80,"td",31),d(81,"10%"),c(),s(82,"td",31),d(83,"4%"),c(),s(84,"td",31),d(85,"10.4%"),c()(),s(86,"tr",30)(87,"td",31),d(88,"\u20B99,00,001 - \u20B912,00,000"),c(),s(89,"td",31),d(90,"15%"),c(),s(91,"td",31),d(92,"4%"),c(),s(93,"td",31),d(94,"15.6%"),c()(),s(95,"tr",30)(96,"td",31),d(97,"\u20B912,00,001 - \u20B915,00,000"),c(),s(98,"td",31),d(99,"20%"),c(),s(100,"td",31),d(101,"4%"),c(),s(102,"td",31),d(103,"20.8%"),c()(),s(104,"tr",33)(105,"td",34),d(106,"Above \u20B915,00,000"),c(),s(107,"td",34),d(108,"30%"),c(),s(109,"td",31),d(110,"4%"),c(),s(111,"td",34),d(112,"31.2%"),c()()()()(),s(113,"div",35)(114,"h5",36),d(115,"New Regime Benefits:"),c(),s(116,"ul",37)(117,"li"),d(118,"\u2022 Standard deduction of \u20B950,000 automatically applied"),c(),s(119,"li"),d(120,"\u2022 Lower tax rates compared to old regime"),c(),s(121,"li"),d(122,"\u2022 No need to maintain investment proofs"),c(),s(123,"li"),d(124,"\u2022 Simplified tax filing process"),c(),s(125,"li"),d(126,"\u2022 No deductions except standard deduction"),c()()()()()()),r&2&&(u(8),$t("New Tax Regime calculation for FY ",a.currentYear,"-",a.currentYear+1,""),u(12),ze("bg-blue-600",!a.useManualIncome)("text-white",!a.useManualIncome)("bg-gray-100",a.useManualIncome)("text-gray-700",a.useManualIncome),P("color",a.useManualIncome?"basic":"primary"),u(8),ze("bg-blue-600",a.useManualIncome)("text-white",a.useManualIncome)("bg-gray-100",!a.useManualIncome)("text-gray-700",!a.useManualIncome),P("color",a.useManualIncome?"primary":"basic"),u(8),P("ngIf",a.useManualIncome),u(),P("ngIf",!a.useManualIncome),u(),P("ngIf",a.isLoading),u(),P("ngIf",!a.isLoading&&a.taxCalculation&&(a.useManualIncome?a.isManualIncomeValid():!0)),u(),P("ngIf",!a.isLoading&&a.getCurrentIncome()===0),u(5),$t(" New Tax Regime Slabs (FY ",a.currentYear,"-",a.currentYear+1,") "))},dependencies:[dt,Wn,Nt,Ui,At,Yn,xi,Ci,Jt,Qe,Br]});let e=i;return e})();var jy=(e,i)=>i.value,XL=(e,i)=>i.id;function KL(e,i){if(e&1&&(s(0,"option",12),d(1),c()),e&2){let n=i.$implicit;P("value",n.value),u(),ne(" ",n.label," ")}}function ZL(e,i){if(e&1&&(s(0,"option",12),d(1),c()),e&2){let n=i.$implicit;P("value",n.value),u(),ne(" ",n.label," ")}}function QL(e,i){if(e&1){let n=ue();s(0,"span",29),d(1),s(2,"button",35),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.removeTag(r))}),s(3,"mat-icon",36),d(4,"close"),c()()()}if(e&2){let n=i.$implicit;u(),ne(" ",n," ")}}function JL(e,i){if(e&1){let n=ue();s(0,"div",16)(1,"mat-card",17)(2,"div",18)(3,"h3",19),d(4,"Add New Note"),c(),s(5,"button",20),F("click",function(){R(n);let r=v();return B(r.cancelAddNote())}),s(6,"mat-icon"),d(7,"close"),c()()(),s(8,"div",21)(9,"div")(10,"label",22),d(11,"Title"),c(),s(12,"input",23),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.newNote.title,r)||(a.newNote.title=r),B(r)}),c()(),s(13,"div")(14,"label",22),d(15,"Content"),c(),s(16,"textarea",24),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.newNote.content,r)||(a.newNote.content=r),B(r)}),c()(),s(17,"div",25)(18,"div")(19,"label",22),d(20,"Category"),c(),s(21,"select",26),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.newNote.category,r)||(a.newNote.category=r),B(r)}),Ge(22,ZL,2,2,"option",12,jy),c()(),s(24,"div")(25,"label",22),d(26,"Tags"),c(),s(27,"input",27),F("keyup.enter",function(r){R(n);let a=v();return B(a.addTag(r))}),c(),s(28,"div",28),Ge(29,QL,5,1,"span",29,rr),c()()(),s(31,"div",30)(32,"mat-checkbox",31),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.newNote.isImportant,r)||(a.newNote.isImportant=r),B(r)}),d(33," Mark as Important "),c()(),s(34,"div",32)(35,"button",33),F("click",function(){R(n);let r=v();return B(r.cancelAddNote())}),d(36,"Cancel"),c(),s(37,"button",34),F("click",function(){R(n);let r=v();return B(r.saveNote())}),d(38,"Save Note"),c()()()()()}if(e&2){let n=v();u(12),st("ngModel",n.newNote.title),u(4),st("ngModel",n.newNote.content),u(5),st("ngModel",n.newNote.category),u(),He(n.categories.slice(1)),u(7),He(n.newNote.tags),u(3),st("ngModel",n.newNote.isImportant)}}function eV(e,i){if(e&1&&(s(0,"span",47),d(1),c()),e&2){let n=i.$implicit;u(),ne(" ",n," ")}}function tV(e,i){if(e&1){let n=ue();s(0,"div",8)(1,"mat-card",37)(2,"div",0)(3,"div",38)(4,"div",39)(5,"h3",40),d(6),c(),s(7,"div",41)(8,"mat-icon",36),d(9),c(),s(10,"span"),d(11),c(),s(12,"span"),d(13,"\u2022"),c(),s(14,"span"),d(15),ce(16,"date"),c()()(),s(17,"div",42)(18,"button",43),F("click",function(){let r=R(n).$implicit,a=v();return B(a.toggleImportant(r))}),s(19,"mat-icon"),d(20),c()(),s(21,"button",44),F("click",function(){let r=R(n).$implicit,a=v();return B(a.deleteNote(r.id))}),s(22,"mat-icon"),d(23,"delete"),c()()()(),s(24,"p",45),d(25),c(),s(26,"div",46),Ge(27,eV,2,1,"span",47,rr),c(),s(29,"div",48),d(30),ce(31,"date"),c()()()()}if(e&2){let n=i.$implicit,t=v();u(),ze("border-l-4",n.isImportant)("border-l-red-500",n.isImportant),u(5),L(n.title),u(3),L(t.getCategoryInfo(n.category).icon),u(2),L(t.getCategoryInfo(n.category).label),u(4),L(ht(16,13,n.createdAt,"MMM dd, yyyy")),u(3),ze("text-red-500",n.isImportant),u(2),L(n.isImportant?"star":"star_border"),u(5),L(n.content),u(2),He(n.tags),u(3),ne(" Last updated: ",ht(31,16,n.updatedAt,"MMM dd, yyyy HH:mm")," ")}}function nV(e,i){if(e&1){let n=ue();s(0,"div",49)(1,"mat-icon",50),d(2,"note"),c(),s(3,"h3",51),d(4,"No notes found"),c(),s(5,"p",52),d(6),c(),s(7,"button",53),F("click",function(){R(n);let r=v();return B(r.addNote())}),s(8,"mat-icon"),d(9,"add"),c(),s(10,"span"),d(11,"Add Note"),c()()()}if(e&2){let n=v();u(6),ne(" ",n.searchTerm||n.selectedCategory!=="all"?"Try adjusting your search or filter criteria.":"Start by adding your first note to keep track of important information."," ")}}var zg=(()=>{let i=class i{constructor(t){this.notificationService=t,this.notes=[],this.filteredNotes=[],this.selectedCategory="all",this.searchTerm="",this.isAddingNote=!1,this.newNote={title:"",content:"",category:"personal",tags:[],isImportant:!1},this.categories=[{value:"all",label:"All Notes",icon:"note"},{value:"personal",label:"Personal",icon:"person"},{value:"financial",label:"Financial",icon:"account_balance_wallet"},{value:"tax",label:"Tax Related",icon:"receipt_long"},{value:"investment",label:"Investment",icon:"trending_up"},{value:"expenses",label:"Expenses",icon:"money_off"},{value:"goals",label:"Goals",icon:"flag"},{value:"documents",label:"Documents",icon:"description"}]}ngOnInit(){this.loadNotes()}loadNotes(){try{this.notes=[{id:"1",title:"Tax Planning Notes",content:"Remember to invest in ELSS for tax saving under section 80C. Also consider health insurance for 80D benefits.",category:"tax",tags:["tax","investment","planning"],createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-15"),isImportant:!0},{id:"2",title:"Monthly Budget Goals",content:"Target: Save 30% of income. Track expenses daily. Review budget every weekend.",category:"financial",tags:["budget","savings","goals"],createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-10"),isImportant:!0}],this.filteredNotes=[...this.notes]}catch(t){console.error("Error loading notes:",t),this.notificationService.error("Failed to load notes")}}filterNotes(){this.filteredNotes=this.notes.filter(t=>{let r=this.selectedCategory==="all"||t.category===this.selectedCategory,a=t.title.toLowerCase().includes(this.searchTerm.toLowerCase())||t.content.toLowerCase().includes(this.searchTerm.toLowerCase())||t.tags.some(o=>o.toLowerCase().includes(this.searchTerm.toLowerCase()));return r&&a})}onCategoryChange(){this.filterNotes()}onSearchChange(){this.filterNotes()}addNote(){this.isAddingNote=!0}saveNote(){if(!this.newNote.title||!this.newNote.content){this.notificationService.warning("Please fill in title and content");return}try{let t={id:Date.now().toString(),title:this.newNote.title,content:this.newNote.content,category:this.newNote.category,tags:this.newNote.tags,createdAt:new Date,updatedAt:new Date,isImportant:this.newNote.isImportant};this.notes.unshift(t),this.filterNotes(),this.resetNewNote(),this.isAddingNote=!1,this.notificationService.success("Note saved successfully")}catch(t){console.error("Error saving note:",t),this.notificationService.error("Failed to save note")}}cancelAddNote(){this.resetNewNote(),this.isAddingNote=!1,this.notificationService.info("Note creation cancelled")}resetNewNote(){this.newNote={title:"",content:"",category:"personal",tags:[],isImportant:!1}}deleteNote(t){try{let r=this.notes.find(a=>a.id===t);this.notes=this.notes.filter(a=>a.id!==t),this.filterNotes(),this.notificationService.success(`Note "${r==null?void 0:r.title}" deleted successfully`)}catch(r){console.error("Error deleting note:",r),this.notificationService.error("Failed to delete note")}}toggleImportant(t){try{t.isImportant=!t.isImportant,t.updatedAt=new Date;let r=t.isImportant?"marked as important":"unmarked as important";this.notificationService.success(`Note "${t.title}" ${r}`)}catch(r){console.error("Error updating note importance:",r),this.notificationService.error("Failed to update note importance")}}addTag(t){let r=t.target.value;r&&!this.newNote.tags.includes(r)?(this.newNote.tags.push(r),this.notificationService.info(`Tag "${r}" added`)):this.newNote.tags.includes(r)&&this.notificationService.warning("Tag already exists")}removeTag(t){this.newNote.tags=this.newNote.tags.filter(r=>r!==t),this.notificationService.info(`Tag "${t}" removed`)}exportNotes(){try{console.log("Export notes clicked"),this.notificationService.info("Export feature coming soon")}catch(t){console.error("Error exporting notes:",t),this.notificationService.error("Failed to export notes")}}importNotes(){try{console.log("Import notes clicked"),this.notificationService.info("Import feature coming soon")}catch(t){console.error("Error importing notes:",t),this.notificationService.error("Failed to import notes")}}getCategoryInfo(t){let r=this.categories.find(a=>a.value===t);return r?{icon:r.icon,label:r.label}:{icon:"note",label:"Unknown"}}};i.\u0275fac=function(r){return new(r||i)(Y(ft))},i.\u0275cmp=Re({type:i,selectors:[["app-notes"]],decls:37,vars:4,consts:[[1,"p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800","mb-1"],[1,"text-gray-600"],[1,"flex","space-x-3"],["mat-stroked-button","",1,"flex","items-center","space-x-2",3,"click"],["mat-raised-button","","color","primary",1,"flex","items-center","space-x-2",3,"click"],[1,"mb-6","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"relative"],[1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","text-gray-400"],["type","text","placeholder","Search notes...",1,"w-full","pl-10","pr-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","input","ngModel"],[1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","change","ngModel"],[3,"value"],["class","mb-6",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-2","xl:grid-cols-3","gap-6"],["class","text-center py-12",4,"ngIf"],[1,"mb-6"],[1,"p-6","shadow-lg","border-0","rounded-xl"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-lg","font-semibold","text-gray-800"],["mat-icon-button","",3,"click"],[1,"space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Enter note title...",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["placeholder","Enter note content...","rows","4",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["type","text","placeholder","Add tags (comma separated)...",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"keyup.enter"],[1,"flex","flex-wrap","gap-2","mt-2"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"flex","items-center"],[1,"mr-2",3,"ngModelChange","ngModel"],[1,"flex","justify-end","space-x-3"],["mat-stroked-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],[1,"ml-1","text-blue-600","hover:text-blue-800",3,"click"],[1,"text-xs"],[1,"h-full","shadow-lg","border-0","rounded-xl","hover:shadow-xl","transition-shadow"],[1,"flex","justify-between","items-start","mb-3"],[1,"flex-1"],[1,"text-lg","font-semibold","text-gray-800","mb-1"],[1,"flex","items-center","space-x-2","text-sm","text-gray-500"],[1,"flex","space-x-1"],["mat-icon-button","","matTooltip","Mark as important",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete note",3,"click"],[1,"text-gray-600","mb-4","line-clamp-3"],[1,"flex","flex-wrap","gap-2","mb-3"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-700"],[1,"text-xs","text-gray-400"],[1,"text-center","py-12"],[1,"text-gray-400","text-6xl","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-500","mb-4"],["mat-raised-button","","color","primary",1,"flex","items-center","space-x-2","mx-auto",3,"click"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),d(4,"Notes & Documents"),c(),s(5,"p",3),d(6,"Store and organize your financial notes, documents, and important information"),c()(),s(7,"div",4)(8,"button",5),F("click",function(){return a.importNotes()}),s(9,"mat-icon"),d(10,"upload"),c(),s(11,"span"),d(12,"Import"),c()(),s(13,"button",5),F("click",function(){return a.exportNotes()}),s(14,"mat-icon"),d(15,"download"),c(),s(16,"span"),d(17,"Export"),c()(),s(18,"button",6),F("click",function(){return a.addNote()}),s(19,"mat-icon"),d(20,"add"),c(),s(21,"span"),d(22,"Add Note"),c()()()(),s(23,"div",7)(24,"div",8)(25,"mat-icon",9),d(26,"search"),c(),s(27,"input",10),lt("ngModelChange",function(l){return ct(a.searchTerm,l)||(a.searchTerm=l),l}),F("input",function(){return a.onSearchChange()}),c()(),s(28,"div")(29,"select",11),lt("ngModelChange",function(l){return ct(a.selectedCategory,l)||(a.selectedCategory=l),l}),F("change",function(){return a.onCategoryChange()}),Ge(30,KL,2,2,"option",12,jy),c()()(),N(32,JL,39,4,"div",13),s(33,"div",14),Ge(34,tV,32,19,"div",8,XL),c(),N(36,nV,12,1,"div",15),c()),r&2&&(u(27),st("ngModel",a.searchTerm),u(2),st("ngModel",a.selectedCategory),u(),He(a.categories),u(2),P("ngIf",a.isAddingNote),u(2),He(a.filteredNotes),u(2),P("ngIf",a.filteredNotes.length===0&&!a.isAddingNote))},dependencies:[dt,uc,pc,Nt,gc,At,Jn,ji,Jt,gn,Qe,za,Tn,_i],styles:[".line-clamp-3[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}"]});let e=i;return e})();var yr=Yr(Xr());var Cf=Yr(Xr());function rV(e,i){if(e&1&&(s(0,"div",33)(1,"mat-icon",34),d(2,"error_outline"),c(),s(3,"span",35),d(4),c()()),e&2){let n=v();u(4),L(n.errorMessage)}}var vf=(()=>{let i=class i{constructor(t,r){this.dialogRef=t,this.data=r,this.startDate=null,this.endDate=null,this.errorMessage=""}ngOnInit(){var t,r;(t=this.data)!=null&&t.startDate&&(this.startDate=new Date(this.data.startDate)),(r=this.data)!=null&&r.endDate&&(this.endDate=new Date(this.data.endDate))}applyDateRange(){if(this.errorMessage="",!this.startDate||!this.endDate){this.errorMessage="Please select both start and end dates.";return}let t=(0,Cf.default)(this.startDate),r=(0,Cf.default)(this.endDate);if(!t.isValid()||!r.isValid()){this.errorMessage="Please enter valid dates.";return}if(r.isBefore(t)){this.errorMessage="End date must be on or after start date.";return}this.dialogRef.close({start:this.startDate,end:this.endDate})}onCancel(){this.dialogRef.close()}selectLast7Days(){let t=new Date,r=new Date;r.setDate(t.getDate()-6),this.startDate=r,this.endDate=t,this.errorMessage=""}selectLast30Days(){let t=new Date,r=new Date;r.setDate(t.getDate()-29),this.startDate=r,this.endDate=t,this.errorMessage=""}selectThisMonth(){let t=new Date,r=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);this.startDate=r,this.endDate=a,this.errorMessage=""}};i.\u0275fac=function(r){return new(r||i)(Y(Mi),Y(Pi))},i.\u0275cmp=Re({type:i,selectors:[["app-custom-date-range-dialog"]],decls:76,vars:5,consts:[[1,"custom-date-range-dialog"],[1,"mobile-header"],[1,"header-content"],[1,"header-title"],[1,"header-actions"],["mat-icon-button","","color","primary","matTooltip","Apply Range",1,"apply-btn",3,"click","disabled"],["mat-icon-button","","matTooltip","Close",1,"close-btn",3,"click"],[1,"mobile-content"],[1,"content-wrapper"],[1,"date-range-card"],[1,"card-header"],[1,"card-icon"],[1,"card-title"],[1,"date-inputs-container"],[1,"date-input-group"],[1,"input-label"],[1,"label-icon"],[1,"date-input-wrapper"],["type","date","aria-label","Start date",1,"date-input",3,"ngModelChange","ngModel"],[1,"input-icon"],[1,"date-separator"],[1,"separator-line"],[1,"separator-icon"],["type","date","aria-label","End date",1,"date-input",3,"ngModelChange","ngModel"],["class","error-card","role","alert",4,"ngIf"],[1,"quick-actions-card"],[1,"quick-buttons"],["mat-stroked-button","","aria-label","Select last 7 days",1,"quick-btn",3,"click"],["mat-stroked-button","","aria-label","Select last 30 days",1,"quick-btn",3,"click"],["mat-stroked-button","","aria-label","Select this month",1,"quick-btn",3,"click"],[1,"action-buttons"],["mat-button","","aria-label","Cancel date selection",1,"cancel-btn",3,"click"],["mat-raised-button","","color","primary","aria-label","Apply selected date range",1,"apply-range-btn",3,"click","disabled"],["role","alert",1,"error-card"],[1,"error-icon"],[1,"error-text"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),d(4,"Select Date Range"),c(),s(5,"div",4)(6,"button",5),F("click",function(){return a.applyDateRange()}),s(7,"mat-icon"),d(8,"check"),c()(),s(9,"button",6),F("click",function(){return a.onCancel()}),s(10,"mat-icon"),d(11,"close"),c()()()()(),s(12,"div",7)(13,"div",8)(14,"div",9)(15,"div",10)(16,"mat-icon",11),d(17,"calendar_today"),c(),s(18,"span",12),d(19,"Date Range"),c()(),s(20,"div",13)(21,"div",14)(22,"label",15)(23,"mat-icon",16),d(24,"event"),c(),s(25,"span"),d(26,"Start Date"),c()(),s(27,"div",17)(28,"input",18),lt("ngModelChange",function(l){return ct(a.startDate,l)||(a.startDate=l),l}),c(),s(29,"mat-icon",19),d(30,"calendar_today"),c()()(),s(31,"div",20),re(32,"div",21),s(33,"mat-icon",22),d(34,"arrow_downward"),c(),re(35,"div",21),c(),s(36,"div",14)(37,"label",15)(38,"mat-icon",16),d(39,"event"),c(),s(40,"span"),d(41,"End Date"),c()(),s(42,"div",17)(43,"input",23),lt("ngModelChange",function(l){return ct(a.endDate,l)||(a.endDate=l),l}),c(),s(44,"mat-icon",19),d(45,"calendar_today"),c()()()()(),N(46,rV,5,1,"div",24),s(47,"div",25)(48,"div",10)(49,"mat-icon",11),d(50,"flash_on"),c(),s(51,"span",12),d(52,"Quick Select"),c()(),s(53,"div",26)(54,"button",27),F("click",function(){return a.selectLast7Days()}),s(55,"mat-icon"),d(56,"today"),c(),s(57,"span"),d(58,"Last 7 days"),c()(),s(59,"button",28),F("click",function(){return a.selectLast30Days()}),s(60,"mat-icon"),d(61,"calendar_month"),c(),s(62,"span"),d(63,"Last 30 days"),c()(),s(64,"button",29),F("click",function(){return a.selectThisMonth()}),s(65,"mat-icon"),d(66,"date_range"),c(),s(67,"span"),d(68,"This month"),c()()()(),s(69,"div",30)(70,"button",31),F("click",function(){return a.onCancel()}),d(71," Cancel "),c(),s(72,"button",32),F("click",function(){return a.applyDateRange()}),s(73,"mat-icon"),d(74,"check"),c(),d(75," Apply Range "),c()()()()()),r&2&&(u(6),P("disabled",!a.startDate||!a.endDate),u(22),st("ngModel",a.startDate),u(15),st("ngModel",a.endDate),u(3),P("ngIf",a.errorMessage),u(26),P("disabled",!a.startDate||!a.endDate))},dependencies:[dt,Nt,At,Jn,Jt,gn,Qe,Tn],styles:[".custom-date-range-dialog[_ngcontent-%COMP%]{width:100%;height:100vh;max-width:100vw;background:#f8fafc;display:flex;flex-direction:column;overflow:hidden}.mobile-header[_ngcontent-%COMP%]{position:sticky;top:0;z-index:20;background:#fff;border-bottom:1px solid #e2e8f0;box-shadow:0 1px 3px #0000001a;padding:12px 16px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#1f2937;flex:1}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;background:#3b82f6;color:#fff;transition:all .2s ease}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb;transform:translateY(-1px);box-shadow:0 2px 8px #3b82f64d}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]:disabled{background:#9ca3af;color:#6b7280}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;color:#6b7280;transition:all .2s ease}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.mobile-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;background:#f8fafc}.mobile-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{padding:16px;display:flex;flex-direction:column;gap:16px}.date-range-card[_ngcontent-%COMP%], .quick-actions-card[_ngcontent-%COMP%], .error-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a;overflow:hidden}.card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:16px;border-bottom:1px solid #f3f4f6}.card-header[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:#3b82f6}.card-header[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1f2937}.date-range-card[_ngcontent-%COMP%]   .date-inputs-container[_ngcontent-%COMP%]{padding:16px;display:flex;flex-direction:column;gap:20px}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:14px;font-weight:500;color:#374151}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]   .label-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#3b82f6}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .date-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .date-input-wrapper[_ngcontent-%COMP%]   .date-input[_ngcontent-%COMP%]{width:100%;padding:12px 48px 12px 16px;border:1px solid #d1d5db;border-radius:8px;font-size:16px;color:#1f2937;background:#fff;transition:all .2s ease}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .date-input-wrapper[_ngcontent-%COMP%]   .date-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .date-input-wrapper[_ngcontent-%COMP%]   .date-input[_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{opacity:0;position:absolute;right:0;top:0;width:100%;height:100%;cursor:pointer}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .date-input-wrapper[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{position:absolute;right:12px;color:#9ca3af;font-size:20px;width:20px;height:20px;pointer-events:none}.date-range-card[_ngcontent-%COMP%]   .date-separator[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;margin:8px 0}.date-range-card[_ngcontent-%COMP%]   .date-separator[_ngcontent-%COMP%]   .separator-line[_ngcontent-%COMP%]{flex:1;height:1px;background:linear-gradient(90deg,transparent,#d1d5db,transparent);max-width:60px}.date-range-card[_ngcontent-%COMP%]   .date-separator[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#9ca3af;transform:rotate(90deg)}.error-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;padding:16px;background:#fef2f2;border:1px solid #fecaca}.error-card[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:#dc2626;flex-shrink:0;margin-top:2px}.error-card[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{font-size:14px;color:#dc2626;line-height:1.4;flex:1}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]{padding:16px;display:flex;flex-direction:column;gap:12px}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;border:1px solid #d1d5db;border-radius:8px;background:#fff;color:#374151;font-size:14px;font-weight:500;transition:all .2s ease;text-align:left}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#3b82f6;color:#3b82f6;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#6b7280}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1}.action-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;padding:16px 0}.action-buttons[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{padding:12px 24px;border:1px solid #d1d5db;border-radius:8px;background:#fff;color:#6b7280;font-size:16px;font-weight:500;transition:all .2s ease}.action-buttons[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#9ca3af;color:#374151}.action-buttons[_ngcontent-%COMP%]   .apply-range-btn[_ngcontent-%COMP%]{padding:12px 24px;border-radius:8px;background:#3b82f6;color:#fff;font-size:16px;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .2s ease}.action-buttons[_ngcontent-%COMP%]   .apply-range-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb;transform:translateY(-1px);box-shadow:0 4px 12px #3b82f64d}.action-buttons[_ngcontent-%COMP%]   .apply-range-btn[_ngcontent-%COMP%]:disabled{background:#9ca3af;color:#6b7280}.action-buttons[_ngcontent-%COMP%]   .apply-range-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]{padding:12px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:16px}.mobile-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{padding:12px;gap:12px}.date-range-card[_ngcontent-%COMP%]   .date-inputs-container[_ngcontent-%COMP%]{padding:12px;gap:16px}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]{padding:12px;gap:8px}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]{padding:10px 12px;font-size:13px}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.action-buttons[_ngcontent-%COMP%]{gap:8px}.action-buttons[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%], .action-buttons[_ngcontent-%COMP%]   .apply-range-btn[_ngcontent-%COMP%]{padding:10px 20px;font-size:14px}}@media (max-width: 360px){.mobile-header[_ngcontent-%COMP%]{padding:8px 12px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{gap:8px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:15px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{gap:4px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%], .mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{width:36px;height:36px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.mobile-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{padding:8px;gap:8px}.card-header[_ngcontent-%COMP%]{padding:12px}.card-header[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.card-header[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:14px}}"]});let e=i;return e})();var $y=(e,i)=>i.id,aV=(e,i)=>i.value,oV=(e,i)=>i.categoryId;function sV(e,i){if(e&1){let n=ue();s(0,"div",31)(1,"div",32)(2,"mat-icon",33),d(3,"filter_alt"),c(),s(4,"span",34),d(5),c()(),s(6,"div",35)(7,"mat-icon",36),F("click",function(){R(n);let r=v(2);return B(r.quickClearFilters())}),d(8,"clear"),c()()()}if(e&2){let n=v(2);u(5),$t("",n.getActiveFiltersCount()," Filter",n.getActiveFiltersCount()>1?"s":""," Active")}}function cV(e,i){if(e&1){let n=ue();s(0,"button",37),F("click",function(){R(n);let r=v(2);return B(r.onSearchChange(""))}),s(1,"mat-icon"),d(2,"close"),c()()}}function lV(e,i){e&1&&(s(0,"mat-icon",38),d(1,"check"),c())}function dV(e,i){if(e&1){let n=ue();s(0,"button",24),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.onSortChange(r.value))}),s(1,"mat-icon"),d(2),c(),s(3,"span"),d(4),c(),N(5,lV,2,0,"mat-icon",38),c()}if(e&2){let n=i.$implicit,t=v(2);ze("active-menu-item",t.selectedSort===n.value),u(2),L(n.icon),u(2),L(n.label),u(),we(t.selectedSort===n.value?5:-1)}}function mV(e,i){e&1&&(s(0,"mat-icon",38),d(1,"check"),c())}function gV(e,i){e&1&&(s(0,"mat-icon",38),d(1,"check"),c())}function uV(e,i){e&1&&(s(0,"mat-icon",38),d(1,"check"),c())}function pV(e,i){e&1&&(s(0,"mat-icon",38),d(1,"check"),c())}function fV(e,i){e&1&&(s(0,"mat-icon",38),d(1,"check"),c())}function hV(e,i){if(e&1){let n=ue();s(0,"button",24),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.onCategoryChange(r.id))}),s(1,"mat-icon"),d(2),c(),s(3,"span"),d(4),c(),N(5,fV,2,0,"mat-icon",38),c()}if(e&2){let n=i.$implicit,t=v(2);ze("active-menu-item",t.isCategorySelected(n.id)),u(2),L(n.icon),u(2),L(n.name),u(),we(t.isCategorySelected(n.id)?5:-1)}}function _V(e,i){e&1&&(s(0,"mat-icon",38),d(1,"check"),c())}function xV(e,i){e&1&&(s(0,"mat-icon",38),d(1,"check"),c())}function CV(e,i){e&1&&(s(0,"mat-icon",38),d(1,"check"),c())}function vV(e,i){e&1&&(s(0,"mat-icon",38),d(1,"check"),c())}function bV(e,i){e&1&&(s(0,"mat-icon",38),d(1,"check"),c())}function yV(e,i){if(e&1){let n=ue();s(0,"div",11),N(1,sV,9,2,"div",12),s(2,"div",13)(3,"div",14)(4,"mat-icon",15),d(5,"search"),c(),s(6,"input",16),F("ngModelChange",function(r){R(n);let a=v();return B(a.onSearchChange(r))}),c(),N(7,cV,3,0,"button",17),c()(),s(8,"div",18)(9,"button",19)(10,"mat-icon"),d(11,"sort"),c(),s(12,"span",20),d(13),c()(),s(14,"mat-menu",21,0),Ge(16,dV,6,5,"button",22,aV),c(),s(18,"button",23)(19,"mat-icon"),d(20,"account_balance_wallet"),c(),s(21,"span",20),d(22),c()(),s(23,"mat-menu",21,1)(25,"button",24),F("click",function(){R(n);let r=v();return B(r.onTypeChange("all"))}),s(26,"mat-icon"),d(27,"list"),c(),s(28,"span"),d(29,"All Types"),c(),N(30,mV,2,0,"mat-icon",25),c(),s(31,"button",24),F("click",function(){R(n);let r=v();return B(r.onTypeChange("income"))}),s(32,"mat-icon",26),d(33,"trending_up"),c(),s(34,"span"),d(35,"Income"),c(),N(36,gV,2,0,"mat-icon",25),c(),s(37,"button",24),F("click",function(){R(n);let r=v();return B(r.onTypeChange("expense"))}),s(38,"mat-icon",27),d(39,"trending_down"),c(),s(40,"span"),d(41,"Expense"),c(),N(42,uV,2,0,"mat-icon",25),c()(),s(43,"button",28)(44,"mat-icon"),d(45,"category"),c(),s(46,"span",20),d(47),c()(),s(48,"mat-menu",21,2)(50,"button",24),F("click",function(){R(n);let r=v();return B(r.onCategoryChange("all"))}),s(51,"mat-icon"),d(52,"list"),c(),s(53,"span"),d(54,"All Categories"),c(),N(55,pV,2,0,"mat-icon",25),c(),re(56,"mat-divider"),Ge(57,hV,6,5,"button",22,$y),c(),s(59,"button",29)(60,"mat-icon"),d(61,"calendar_today"),c(),s(62,"span",20),d(63),c()(),s(64,"mat-menu",21,3)(66,"button",24),F("click",function(){R(n);let r=v();return B(r.onDateRangeChange(null))}),s(67,"mat-icon"),d(68,"all_inclusive"),c(),s(69,"span"),d(70,"All Time"),c(),N(71,_V,2,0,"mat-icon",25),c(),s(72,"button",24),F("click",function(){R(n);let r=v();return B(r.onDateRangeChange("this-month"))}),s(73,"mat-icon"),d(74,"calendar_month"),c(),s(75,"span"),d(76,"This Month"),c(),N(77,xV,2,0,"mat-icon",25),c(),s(78,"button",24),F("click",function(){R(n);let r=v();return B(r.onDateRangeChange("last-month"))}),s(79,"mat-icon"),d(80,"calendar_view_month"),c(),s(81,"span"),d(82,"Last Month"),c(),N(83,CV,2,0,"mat-icon",25),c(),s(84,"button",24),F("click",function(){R(n);let r=v();return B(r.onDateRangeChange("this-year"))}),s(85,"mat-icon"),d(86,"calendar_today"),c(),s(87,"span"),d(88,"This Year"),c(),N(89,vV,2,0,"mat-icon",25),c(),re(90,"mat-divider"),s(91,"button",24),F("click",function(){R(n);let r=v();return B(r.openCustomDateRangeDialog())}),s(92,"mat-icon"),d(93,"date_range"),c(),s(94,"span"),d(95,"Custom Range"),c(),N(96,bV,2,0,"mat-icon",25),c()(),s(97,"button",30),F("click",function(){R(n);let r=v();return B(r.openImportDialog())}),s(98,"mat-icon"),d(99,"upload_file"),c(),s(100,"span",20),d(101,"Import"),c()()()()}if(e&2){let n=bn(15),t=bn(24),r=bn(49),a=bn(65),o=v();u(),P("ngIf",o.hasActiveFilters()),u(5),P("ngModel",o.searchTerm),u(),P("ngIf",o.searchTerm),u(2),Sa("matTooltip",o.getCurrentSortLabel()),P("matMenuTriggerFor",n),u(4),L(o.getCurrentSortLabel()),u(3),He(o.sortOptions),u(2),Sa("matTooltip",o.getCurrentTypeLabel()),P("matMenuTriggerFor",t),u(4),L(o.getCurrentTypeLabel()),u(3),ze("active-menu-item",o.selectedType==="all"),u(5),P("ngIf",o.selectedType==="all"),u(),ze("active-menu-item",o.selectedType==="income"),u(5),P("ngIf",o.selectedType==="income"),u(),ze("active-menu-item",o.selectedType==="expense"),u(5),P("ngIf",o.selectedType==="expense"),u(),Sa("matTooltip",o.getCurrentCategoryLabel()),P("matMenuTriggerFor",r),u(4),L(o.getCurrentCategoryLabel()),u(3),ze("active-menu-item",o.selectedCategory.includes("all")),u(5),P("ngIf",o.selectedCategory.includes("all")),u(2),He(o.getCategoriesList()),u(2),Sa("matTooltip",o.getCurrentDateLabel()),P("matMenuTriggerFor",a),u(4),L(o.getCurrentDateLabel()),u(3),ze("active-menu-item",o.selectedDateRange===null),u(5),P("ngIf",o.selectedDateRange===null),u(),ze("active-menu-item",o.isCurrentMonth()),u(5),P("ngIf",o.isCurrentMonth()),u(),ze("active-menu-item",o.isLastMonth()),u(5),P("ngIf",o.isLastMonth()),u(),ze("active-menu-item",o.isCurrentYear()),u(5),P("ngIf",o.isCurrentYear()),u(2),ze("active-menu-item",o.isCustomDateRange()),u(5),P("ngIf",o.isCustomDateRange())}}function MV(e,i){if(e&1&&(s(0,"div",39)(1,"div",40)(2,"div",41)(3,"span",42),d(4),c(),s(5,"span",43),d(6),c()(),s(7,"div",41)(8,"span",44),d(9),ce(10,"number"),c()(),s(11,"div",41)(12,"span",45),d(13),ce(14,"number"),c()()()()),e&2){let n=v();u(4),L(n.getFilteredCount()),u(2),ne("/ ",n.getTotalCount(),""),u(3),ne("+\u20B9",ht(10,4,n.getTotalIncome(),"1.0-0"),""),u(4),ne("-\u20B9",ht(14,7,n.getTotalExpenses(),"1.0-0"),"")}}function PV(e,i){if(e&1){let n=ue();s(0,"button",52),F("click",function(){R(n);let r=v(2);return B(r.onAddTransaction())}),s(1,"mat-icon"),d(2,"add"),c(),s(3,"span",53),d(4,"Add First Transaction"),c()()}}function OV(e,i){if(e&1){let n=ue();s(0,"button",54),F("click",function(){R(n);let r=v(2);return B(r.clearAllFilters())}),s(1,"mat-icon"),d(2,"clear"),c(),s(3,"span",53),d(4,"Clear Filters"),c()()}}function wV(e,i){if(e&1&&(s(0,"div",46)(1,"div",47)(2,"mat-icon"),d(3,"receipt_long"),c()(),s(4,"h3",48),d(5,"No transactions found"),c(),s(6,"p",49),d(7),c(),N(8,PV,5,0,"button",50)(9,OV,5,0,"button",51),c()),e&2){let n=v();u(7),ne(" ",n.allTransactions.length===0?"Start by adding your first transaction":"No transactions match your current filters. Try adjusting your search or filters."," "),u(),P("ngIf",n.allTransactions.length===0),u(),P("ngIf",n.allTransactions.length>0&&n.hasActiveFilters())}}function SV(e,i){e&1&&(s(0,"mat-icon",59),d(1,"bookmark"),c())}function kV(e,i){e&1&&(s(0,"mat-icon",60),d(1,"category"),c())}function TV(e,i){if(e&1&&(s(0,"div",70),d(1),c()),e&2){let n=v().$implicit;u(),ne(" ",n.notes," ")}}function EV(e,i){if(e&1){let n=ue();s(0,"div",71)(1,"div",72)(2,"button",73),F("click",function(){R(n);let r=v().$implicit,a=v();return B(a.onEditTransaction(r))}),s(3,"mat-icon"),d(4,"edit"),c()(),s(5,"button",74),F("click",function(){R(n);let r=v().$implicit,a=v();return B(a.onDeleteTransaction(r))}),s(6,"mat-icon"),d(7,"delete"),c()()()()}}function IV(e,i){if(e&1&&(s(0,"span",87),d(1),c()),e&2){let n=v(2).$implicit,t=v();u(),ne("(",t.getAccountType(n.accountId),")")}}function AV(e,i){if(e&1&&(s(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"fingerprint"),c(),s(4,"span"),d(5,"Transaction ID"),c()(),s(6,"div",80)(7,"span",88),d(8),c()()()),e&2){let n=v(2).$implicit;u(8),L(n.id)}}function DV(e,i){if(e&1&&(s(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"repeat"),c(),s(4,"span"),d(5,"Recurring"),c()(),s(6,"div",80)(7,"span",89),d(8),c()()()),e&2){let n=v(2).$implicit,t=v();u(8),L(t.getRecurringInfo(n))}}function FV(e,i){if(e&1&&(s(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"note"),c(),s(4,"span"),d(5,"Notes"),c()(),s(6,"div",80)(7,"span",90),d(8),c()()()),e&2){let n=v(2).$implicit;u(8),L(n.notes)}}function RV(e,i){if(e&1&&(s(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"payment"),c(),s(4,"span"),d(5,"Payment Method"),c()(),s(6,"div",80)(7,"span",91),d(8),c()()()),e&2){let n=v(2).$implicit;u(8),L(n.paymentMethod)}}function BV(e,i){if(e&1&&(s(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"payment"),c(),s(4,"span"),d(5,"Tax Amount"),c()(),re(6,"div",80),s(7,"span",92),d(8),ce(9,"number"),c()()),e&2){let n=v(2).$implicit;u(8),L(ht(9,1,n.taxAmount,"1.0-0"))}}function NV(e,i){if(e&1&&(s(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"payment"),c(),s(4,"span"),d(5,"Tax Percentage"),c()(),s(6,"div",80)(7,"span",93),d(8),c()()()),e&2){let n=v(2).$implicit;u(8),ne("",n.taxPercentage,"%")}}function LV(e,i){if(e&1&&(s(0,"div",95)(1,"span",96),d(2),c(),s(3,"span",97),d(4),c()()),e&2){let n=i.$implicit;u(2),L(n.categoryName),u(2),$t("\u20B9",n.amount.toFixed(2)," (",n.percentage.toFixed(1),"%)")}}function VV(e,i){if(e&1&&(s(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"category"),c(),s(4,"span"),d(5,"Category Splits"),c()(),s(6,"div",80)(7,"div",94),Ge(8,LV,5,3,"div",95,oV),c()()()),e&2){let n=v(2).$implicit;u(8),He(n.categorySplits)}}function UV(e,i){if(e&1&&(s(0,"div",75)(1,"div",76)(2,"div",77)(3,"div",78)(4,"mat-icon",79),d(5,"account_balance"),c(),s(6,"span"),d(7,"Account"),c()(),s(8,"div",80)(9,"span",81),d(10),c(),N(11,IV,2,1,"span",82),c()(),N(12,AV,9,1,"div",83)(13,DV,9,1,"div",83),s(14,"div",77)(15,"div",78)(16,"mat-icon",79),d(17),c(),s(18,"span"),d(19,"Status"),c()(),s(20,"div",80)(21,"span",84),d(22),c()()(),s(23,"div",77)(24,"div",78)(25,"mat-icon",79),d(26,"schedule"),c(),s(27,"span"),d(28,"Created Date"),c()(),s(29,"div",80)(30,"span",85),d(31),ce(32,"date"),c()()(),s(33,"div",77)(34,"div",78)(35,"mat-icon",79),d(36,"schedule"),c(),s(37,"span"),d(38,"Created Time"),c()(),s(39,"div",80)(40,"span",86),d(41),ce(42,"date"),c()()(),N(43,FV,9,1,"div",83)(44,RV,9,1,"div",83)(45,BV,10,4,"div",83),c(),N(46,NV,9,1,"div",83)(47,VV,10,0,"div",83),c()),e&2){let n=v().$implicit,t=v();u(10),L(t.getAccountName(n.accountId)),u(),P("ngIf",t.getAccountType(n.accountId)),u(),P("ngIf",n.id),u(),P("ngIf",n.isRecurring),u(3),wt("color",t.getSyncStatusColor(n)),u(),L(t.getSyncStatusIcon(n)),u(4),wt("color",t.getSyncStatusColor(n)),u(),L(t.getSyncStatusInfo(n)),u(9),L(ht(32,17,t.dateService.toDate(n.date),"fullDate")),u(10),L(ht(42,20,t.dateService.toDate(n.date),"shortTime")),u(2),P("ngIf",n.notes&&n.notes.trim()),u(),P("ngIf",n.paymentMethod),u(),P("ngIf",n.taxAmount),u(),P("ngIf",n.taxPercentage),u(),P("ngIf",n.isCategorySplit&&(n.categorySplits==null?null:n.categorySplits.length))}}function zV(e,i){if(e&1){let n=ue();s(0,"div",55),F("click",function(){let r=R(n).$implicit,a=v();return B(a.onLongPress(r))}),s(1,"div",56)(2,"div",57)(3,"div",58)(4,"mat-icon"),d(5),c(),N(6,SV,2,0,"mat-icon",59)(7,kV,2,0,"mat-icon",60),c()(),s(8,"div",61)(9,"div",62),d(10),ce(11,"titlecase"),c(),s(12,"div",63),d(13),ce(14,"date"),c(),N(15,TV,2,1,"div",64),c(),s(16,"div",65)(17,"div",66),d(18),ce(19,"number"),c(),s(20,"div",67),d(21),c()()(),N(22,EV,8,0,"div",68)(23,UV,48,23,"div",69),c()}if(e&2){let n=i.$implicit,t=v();ze("selected",(t.selectedTx==null?null:t.selectedTx.id)===n.id),u(4),wt("color",t.getCategoryColor(n.categoryId)),u(),ne(" ",t.getCategoryIcon(n.categoryId)," "),u(),we(n.isSplitTransaction?6:-1),u(),we(n.isCategorySplit?7:-1),u(3),ne(" ",xe(11,16,n.payee)," "),u(3),ne(" ",ht(14,18,t.dateService.toDate(n.date),"dd MMM - hh:mm")," "),u(2),P("ngIf",n.notes),u(2),P("ngClass",n.type==="income"?"income-text":"expense-text"),u(),$t(" ",n.type==="income"?"+":"-","\u20B9",ht(19,21,n.amount,"1.0-0")," "),u(3),ne(" ",t.getCategoryName(n.categoryId)," "),u(),P("ngIf",(t.selectedTx==null?null:t.selectedTx.id)===n.id),u(),P("ngIf",(t.selectedTx==null?null:t.selectedTx.id)===n.id)}}var Yy=(()=>{let i=class i{constructor(t,r,a,o,l,m,g){this.auth=t,this.route=r,this.dialog=a,this.dateService=o,this.store=l,this.filterService=m,this.categoryService=g,this.editTransaction=new _n,this.deleteTransaction=new _n,this.addTransaction=new _n,this.importTransactions=new _n,this.selectedTx=null,this.filteredTransactions=[],this.selectedSort="date-desc",this.showFilters=!1,this.accounts=[],this.searchTerm="",this.selectedCategory=["all"],this.selectedType="all",this.selectedDate=null,this.selectedDateRange=null,this.sortOptions=[{value:"date-desc",label:"Newest First",icon:"schedule"},{value:"date-asc",label:"Oldest First",icon:"schedule"},{value:"amount-desc",label:"Highest Amount",icon:"trending_up"},{value:"amount-asc",label:"Lowest Amount",icon:"trending_down"},{value:"payee-asc",label:"Payee A-Z",icon:"sort_by_alpha"},{value:"category-asc",label:"Category A-Z",icon:"category"}],this.subscription=new Ri,this.destroy$=new Bt,this.categories=[],this.transactions$=this.store.select(Gn),this.allTransactions=[]}ngOnInit(){this.setupFilterServiceSubscriptions(),this.setupTransactionSubscriptions(),this.loadUserCategories(),this.loadUserAccounts(),this.route.url.includes("transactions")&&(this.showFilters=!0)}ngOnDestroy(){this.subscription.unsubscribe(),this.destroy$.next(),this.destroy$.complete()}setupTransactionSubscriptions(){this.subscription.add(this.transactions$.subscribe(t=>{this.allTransactions=t.sort((r,a)=>{var m,g;let o=this.dateService.toDate(r.date),l=this.dateService.toDate(a.date);return((m=l==null?void 0:l.getTime())!=null?m:0)-((g=o==null?void 0:o.getTime())!=null?g:0)}),this.filterTransactions()}))}setupFilterServiceSubscriptions(){this.subscription.add(this.filterService.searchTerm$.subscribe(t=>{this.searchTerm=t,this.filterTransactions()})),this.subscription.add(this.filterService.selectedCategory$.subscribe(t=>{this.selectedCategory=t,this.filterTransactions()})),this.subscription.add(this.filterService.selectedType$.subscribe(t=>{this.selectedType=t,this.filterTransactions()})),this.subscription.add(this.filterService.selectedDate$.subscribe(t=>{this.selectedDate=t,this.filterTransactions()})),this.subscription.add(this.filterService.selectedDateRange$.subscribe(t=>{this.selectedDateRange=t,this.filterTransactions()}))}filterTransactions(){let t;this.filterService.getSelectedDate()||this.filterService.getSelectedDateRange()||this.filterService.getSelectedYear()?t=this.filterService.filterTransactions(this.allTransactions,this.filterService.getCurrentFilterState()):t=this.filterService.filterCurrentYearTransactions(this.allTransactions,this.filterService.getCurrentFilterState());let a=this.filterService.sortTransactions(t,this.selectedSort);this.filteredTransactions=a}onSearchChange(t){this.filterService.setSearchTerm(t)}onSortChange(t){this.selectedSort=t,this.filterTransactions()}onTypeChange(t){this.filterService.setSelectedType(t)}onCategoryChange(t){t==="all"?this.filterService.setSelectedCategory(["all"]):this.filterService.setSelectedCategory([t])}onDateRangeChange(t){if(!t){this.filterService.clearSelectedDate();return}let r=(0,yr.default)(),a,o;switch(t){case"today":a=r.startOf("day").toDate(),o=r.endOf("day").toDate();break;case"yesterday":a=r.subtract(1,"day").startOf("day").toDate(),o=r.endOf("day").toDate();break;case"this-week":a=r.startOf("week").toDate(),o=r.endOf("week").toDate();break;case"last-week":a=r.subtract(1,"week").startOf("week").toDate(),o=r.subtract(1,"week").endOf("week").toDate();break;case"this-month":a=r.startOf("month").toDate(),o=r.endOf("month").toDate();break;case"last-month":a=r.subtract(1,"month").startOf("month").toDate(),o=r.subtract(1,"month").endOf("month").toDate();break;case"this-year":a=r.startOf("year").toDate(),o=r.endOf("year").toDate();break;default:return}this.filterService.setSelectedDateRange(a,o)}isCurrentMonth(){let t=(0,yr.default)().month(),r=(0,yr.default)().year();return this.filteredTransactions.some(a=>{let o=(0,yr.default)(this.dateService.toDate(a.date));return o.month()===t&&o.year()===r})}isLastMonth(){let t=(0,yr.default)().subtract(1,"month").month(),r=(0,yr.default)().subtract(1,"month").year();return this.filteredTransactions.some(a=>{let o=(0,yr.default)(this.dateService.toDate(a.date));return o.month()===t&&o.year()===r})}isCurrentYear(){let t=(0,yr.default)().year();return this.filteredTransactions.some(r=>(0,yr.default)(this.dateService.toDate(r.date)).year()===t)}hasActiveFilters(){return this.filterService.hasActiveFilters()}getCurrentSortLabel(){let t=this.sortOptions.find(r=>r.value===this.selectedSort);return t?t.label:"Sort"}getCurrentTypeLabel(){switch(this.selectedType){case"income":return"Income";case"expense":return"Expense";default:return"All Types"}}getCurrentCategoryLabel(){if(this.selectedCategory.includes("all"))return"All Categories";let t=this.categories.find(r=>r.id===this.selectedCategory[0]);return t?t.name:"Unknown Category"}getCurrentDateLabel(){if(this.selectedDate)return(0,yr.default)(this.selectedDate).format("MMM DD, YYYY");if(this.selectedDateRange){let t=(0,yr.default)(this.selectedDateRange.startDate).format("MMM DD"),r=(0,yr.default)(this.selectedDateRange.endDate).format("MMM DD, YYYY");return`${t} - ${r}`}return"All Dates"}onLongPress(t){this.selectedTx=t}onEditTransaction(t){this.editTransaction.emit(t)}onDeleteTransaction(t){this.dialog.open(Hr,{width:"300px",data:{title:"Delete Transaction",message:"Are you sure you want to delete this transaction?",confirmText:"Delete",cancelText:"Cancel"}}).afterClosed().subscribe(r=>{r&&this.deleteTransaction.emit(t)})}onAddTransaction(){this.addTransaction.emit()}onImportTransactions(){this.importTransactions.emit()}getTotalIncome(){return this.filteredTransactions.filter(t=>t.type==="income").reduce((t,r)=>t+r.amount,0)}getTotalExpenses(){return this.filteredTransactions.filter(t=>t.type==="expense").reduce((t,r)=>t+r.amount,0)}getNetAmount(){return this.getTotalIncome()-this.getTotalExpenses()}getCategoriesList(){return this.categories.map(t=>le(oe({},t),{id:t.id||""}))}getFilteredCount(){return this.filteredTransactions.length}getTotalCount(){return this.allTransactions.length}getCurrentYear(){return(0,yr.default)().year()}getCategoryIcon(t){let r=this.categories.find(a=>a.id===t);return(r==null?void 0:r.icon)||"category"}getCategoryColor(t){let r=this.categories.find(a=>a.id===t);return(r==null?void 0:r.color)||"#46777f"}loadUserCategories(){return me(this,null,function*(){this.subscription.add(this.store.select(un).subscribe(t=>{this.categories=t}))})}loadUserAccounts(){return me(this,null,function*(){this.subscription.add(this.store.select(ca).subscribe(t=>{this.accounts=t}))})}getAccountName(t){let r=this.accounts.find(a=>a.accountId===t);return(r==null?void 0:r.name)||"Unknown Account"}getAccountType(t){let r=this.accounts.find(a=>a.accountId===t);return(r==null?void 0:r.type)||"Unknown"}getRecurringInfo(t){return t.recurringInterval?`Repeats ${t.recurringInterval.toLowerCase()}`:""}getSyncStatusInfo(t){switch(t.syncStatus){case bi.PENDING:return"Pending sync";case bi.SYNCED:return"Synced";case bi.FAILED:return"Sync failed";default:return""}}getSyncStatusIcon(t){switch(t.syncStatus){case bi.PENDING:return"schedule";case bi.SYNCED:return"check_circle";case bi.FAILED:return"error";default:return"help"}}getSyncStatusColor(t){switch(t.syncStatus){case bi.PENDING:return"orange";case bi.SYNCED:return"green";case bi.FAILED:return"red";default:return"gray"}}clearAllFilters(){this.filterService.clearAllFilters(),this.selectedSort="date-desc"}quickClearFilters(){this.filterService.clearAllFilters()}onClearDateFilter(){this.filterService.clearSelectedDate()}getActiveFiltersCount(){return this.filterService.getActiveFiltersCount()}isCategorySelected(t){return this.selectedCategory.includes(t)}isCustomDateRange(){return!!(this.selectedDate||this.selectedDateRange&&(this.selectedDateRange.startDate!==(0,yr.default)().startOf("month").toDate()||this.selectedDateRange.endDate!==(0,yr.default)().endOf("month").toDate()))}openCustomDateRangeDialog(){var r,a,o,l;this.dialog.open(vf,{width:"400px",data:{startDate:(a=(r=this.selectedDateRange)==null?void 0:r.startDate)!=null?a:new Date,endDate:(l=(o=this.selectedDateRange)==null?void 0:o.endDate)!=null?l:new Date}}).afterClosed().subscribe(m=>{m&&this.filterService.setSelectedDateRange(m.start,m.end)})}openImportDialog(){this.importTransactions.emit()}getCategoryName(t){let r=this.categories.find(a=>a.id===t);return(r==null?void 0:r.name)||t}};i.\u0275fac=function(r){return new(r||i)(Y(xt),Y(nn),Y(xn),Y(Vt),Y(pt),Y(Qa),Y(Za))},i.\u0275cmp=Re({type:i,selectors:[["mobile-transaction-list"]],outputs:{editTransaction:"editTransaction",deleteTransaction:"deleteTransaction",addTransaction:"addTransaction",importTransactions:"importTransactions"},decls:8,vars:3,consts:[["sortMenu","matMenu"],["typeMenu","matMenu"],["categoryMenu","matMenu"],["dateMenu","matMenu"],[1,"mobile-transaction-container"],["class","mobile-filter-header",4,"ngIf"],["class","transaction-summary",4,"ngIf"],[1,"transaction-list-container"],[1,"transaction-scroll"],["class","empty-state",4,"ngIf"],[1,"transaction-card",3,"selected"],[1,"mobile-filter-header"],["class","active-filters-indicator flex justify-between items-center",4,"ngIf"],[1,"search-container"],[1,"search-input-wrapper"],[1,"search-icon"],["type","text","placeholder","Search transactions...",1,"search-input",3,"ngModelChange","ngModel"],["mat-icon-button","","class","clear-search-btn",3,"click",4,"ngIf"],[1,"filter-menu-container","md:justify-center"],["mat-icon-button","","aria-label","Sort transactions",1,"filter-menu-btn",3,"matMenuTriggerFor","matTooltip"],[1,"filter-btn-text"],[1,"filter-menu"],["mat-menu-item","",3,"active-menu-item"],["mat-icon-button","","aria-label","Filter by transaction type",1,"filter-menu-btn",3,"matMenuTriggerFor","matTooltip"],["mat-menu-item","",3,"click"],["class","check-icon",4,"ngIf"],[1,"income-icon"],[1,"expense-icon"],["mat-icon-button","","aria-label","Filter by category",1,"filter-menu-btn",3,"matMenuTriggerFor","matTooltip"],["mat-icon-button","","aria-label","Filter by date range",1,"filter-menu-btn",3,"matMenuTriggerFor","matTooltip"],["mat-icon-button","","matTooltip","Import transactions","aria-label","Import transactions",1,"filter-menu-btn","import-btn",3,"click"],[1,"active-filters-indicator","flex","justify-between","items-center"],[1,"filter-icon-container"],[1,"filter-icon"],[1,"filter-text"],[1,""],[1,"text-black","relative","top-1","!text-blue-700","text-sm",3,"click"],["mat-icon-button","",1,"clear-search-btn",3,"click"],[1,"check-icon"],[1,"transaction-summary"],[1,"summary-stats"],[1,"stat-item"],[1,"stat-value"],[1,"stat-total"],[1,"stat-value","income"],[1,"stat-value","expense"],[1,"empty-state"],[1,"empty-icon"],[1,"empty-title","text-base"],[1,"empty-description","text-base"],["mat-raised-button","","color","primary","class","add-first-btn",3,"click",4,"ngIf"],["mat-stroked-button","","class","clear-filters-btn-large",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"add-first-btn",3,"click"],[1,"text-base"],["mat-stroked-button","",1,"clear-filters-btn-large",3,"click"],[1,"transaction-card",3,"click"],[1,"transaction-main"],[1,"transaction-icon"],[1,"icon-container"],[1,"split-transaction"],[1,"category-split-transaction"],[1,"transaction-details"],[1,"transaction-title","text-base"],[1,"transaction-date","text-base"],["class","transaction-notes text-base",4,"ngIf"],[1,"transaction-amount"],[1,"amount-value","text-base",3,"ngClass"],[1,"amount-type","text-base"],["class","transaction-actions",4,"ngIf"],["class","transaction-details-expanded",4,"ngIf"],[1,"transaction-notes","text-base"],[1,"transaction-actions"],[1,"actions-container"],["mat-icon-button","","matTooltip","Edit transaction",1,"action-button","edit-btn",3,"click"],["mat-icon-button","","matTooltip","Delete transaction",1,"action-button","delete-btn",3,"click"],[1,"transaction-details-expanded"],[1,"details-container"],[1,"detail-row"],[1,"detail-label"],[1,"detail-icon"],[1,"detail-value"],[1,"account-name"],["class","account-type",4,"ngIf"],["class","detail-row",4,"ngIf"],[1,"sync-status"],[1,"created-date"],[1,"created-time"],[1,"account-type"],[1,"transaction-id"],[1,"recurring-info"],[1,"transaction-notes"],[1,"payment-method"],[1,"tax-amount"],[1,"tax-percentage"],[1,"category-splits-list"],[1,"category-split-item"],[1,"split-category"],[1,"split-amount"]],template:function(r,a){r&1&&(s(0,"div",4),N(1,yV,102,42,"div",5)(2,MV,15,10,"div",6),s(3,"div",7)(4,"div",8),N(5,wV,10,3,"div",9),Ge(6,zV,24,24,"div",10,$y),c()()()),r&2&&(u(),P("ngIf",a.showFilters),u(),P("ngIf",a.showFilters&&a.filteredTransactions.length>0),u(3),P("ngIf",!a.filteredTransactions.length),u(),He(a.filteredTransactions))},dependencies:[$n,dt,Nt,At,Jn,Ic,Jt,gn,Qe,Wa,Ya,Ga,Tn,Vo,sr,_i],styles:[".mobile-transaction-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;background:#f8fafc;position:relative}.mobile-filter-header[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid #e2e8f0;padding:12px;box-shadow:0 1px 3px #0000001a;z-index:10}.active-filters-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:#eff6ff;border:1px solid #bfdbfe;border-radius:8px;margin-bottom:8px;animation:_ngcontent-%COMP%_fadeIn .3s ease}.active-filters-indicator[_ngcontent-%COMP%]   .filter-icon[_ngcontent-%COMP%]{color:#2563eb;font-size:16px;width:16px;height:16px}.active-filters-indicator[_ngcontent-%COMP%]   .filter-text[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#2563eb}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.search-container[_ngcontent-%COMP%]{margin-bottom:12px}.search-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;padding:0 12px;transition:all .2s ease}.search-input-wrapper[_ngcontent-%COMP%]:focus-within{border-color:#3b82f6;background:#fff;box-shadow:0 0 0 3px #3b82f61a}.search-icon[_ngcontent-%COMP%]{color:#9ca3af;font-size:20px;width:20px;height:20px;margin-right:8px}.search-input[_ngcontent-%COMP%]{flex:1;border:none;background:transparent;padding:12px 0;font-size:16px;color:#1f2937;outline:none}.search-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.clear-search-btn[_ngcontent-%COMP%]{color:#9ca3af;width:32px;height:32px;margin-left:8px}.clear-search-btn[_ngcontent-%COMP%]:hover{color:#6b7280;background:#f3f4f6}.filter-menu-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.filter-menu-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;border:1px solid #e2e8f0;background:#fff;color:#374151;transition:all .2s ease;flex-shrink:0;position:relative;display:flex;align-items:center;justify-content:center}.filter-menu-btn[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1;transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.filter-menu-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 1px 2px #0000001a}.filter-menu-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.filter-menu-btn[_ngcontent-%COMP%]   .filter-btn-text[_ngcontent-%COMP%]{display:none;font-size:12px;font-weight:500;margin-left:4px;white-space:nowrap}.filter-menu-btn.import-btn[_ngcontent-%COMP%]{background:#f0f9ff;border-color:#0ea5e9;color:#0ea5e9}.filter-menu-btn.import-btn[_ngcontent-%COMP%]:hover{background:#e0f2fe;border-color:#0284c7;color:#0284c7;transform:translateY(-1px);box-shadow:0 2px 4px #0ea5e933}.filter-menu-btn.import-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 1px 2px #0ea5e91a}@media (min-width: 768px){.filter-menu-btn[_ngcontent-%COMP%]{width:auto;min-width:120px;height:40px;padding:0 12px;justify-content:flex-start}.filter-menu-btn[_ngcontent-%COMP%]   .filter-btn-text[_ngcontent-%COMP%]{display:inline-block}.filter-menu-container[_ngcontent-%COMP%]{gap:12px}}@media (min-width: 1024px){.filter-menu-btn[_ngcontent-%COMP%]{min-width:140px;padding:0 16px}}.clear-filters-btn[_ngcontent-%COMP%]{color:#ef4444;width:40px;height:40px;border-radius:8px;background:#fef2f2;border:1px solid #fecaca;flex-shrink:0}.clear-filters-btn[_ngcontent-%COMP%]:hover{background:#fee2e2;border-color:#fca5a5;transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.clear-filters-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 1px 2px #0000001a}.clear-filters-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.filter-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%]{padding:0}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;font-size:14px;color:#374151;transition:all .2s ease}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover{background:#f8fafc}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item.active-menu-item[_ngcontent-%COMP%]{background:#eff6ff;color:#1d4ed8}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item.active-menu-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1d4ed8}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#6b7280}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]   mat-icon.income-icon[_ngcontent-%COMP%]{color:#10b981}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]   mat-icon.expense-icon[_ngcontent-%COMP%]{color:#ef4444}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]   mat-icon.check-icon[_ngcontent-%COMP%]{margin-left:auto;color:#1d4ed8}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1}.filter-menu[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{margin:4px 0}.transaction-summary[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid #e2e8f0;padding:8px 12px}.summary-stats[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:12px}.stat-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;flex:1;justify-content:center}.stat-value[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#1f2937}.stat-value.income[_ngcontent-%COMP%]{color:#10b981}.stat-value.expense[_ngcontent-%COMP%]{color:#ef4444}.stat-total[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af;font-weight:400}.transaction-list-container[_ngcontent-%COMP%]{flex:1;overflow:hidden;position:relative}.transaction-scroll[_ngcontent-%COMP%]{height:100%;padding:12px;overflow-y:auto;max-height:70vh}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.empty-icon[_ngcontent-%COMP%]{margin-bottom:16px}.empty-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#d1d5db}.empty-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#374151;margin-bottom:8px}.empty-description[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin-bottom:24px;line-height:1.5}.add-first-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:8px;font-weight:500}.clear-filters-btn-large[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:8px;font-weight:500;color:#ef4444;border-color:#fecaca;background:#fef2f2}.clear-filters-btn-large[_ngcontent-%COMP%]:hover{background:#fee2e2;border-color:#fca5a5}.transaction-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;margin-bottom:10px;border:1px solid #e5e7eb;overflow:hidden;transition:all .2s ease;cursor:pointer}.transaction-card[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.transaction-card.selected[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.transaction-main[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px;gap:12px}.transaction-icon[_ngcontent-%COMP%]{flex-shrink:0}.icon-container[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.icon-container.income-bg[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d1fae5,#a7f3d0)}.icon-container.expense-bg[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fee2e2,#fecaca)}.income-icon[_ngcontent-%COMP%]{color:#059669;font-size:22px;width:22px;height:22px}.expense-icon[_ngcontent-%COMP%]{color:#dc2626;font-size:22px;width:22px;height:22px}.transaction-details[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:2px}.transaction-title[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;line-height:1.3;font-size:.9rem;margin:0}.transaction-category[_ngcontent-%COMP%]{font-size:.9rem;color:#6b7280;font-weight:500;margin:0}.transaction-date[_ngcontent-%COMP%]{font-size:.9rem;color:#9ca3af;display:flex;align-items:center;gap:4px;margin:0}.time-separator[_ngcontent-%COMP%]{color:#d1d5db}.transaction-notes[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;font-style:italic;line-height:1.4;margin:2px 0 0}.transaction-amount[_ngcontent-%COMP%]{text-align:right;flex-shrink:0;display:flex;flex-direction:column;align-items:flex-end;gap:1px}.amount-value[_ngcontent-%COMP%]{font-size:15px;font-weight:700;margin:0}.amount-value.income-text[_ngcontent-%COMP%]{color:#059669}.amount-value.expense-text[_ngcontent-%COMP%]{color:#dc2626}.amount-type[_ngcontent-%COMP%]{font-size:10px;color:#9ca3af;text-transform:capitalize;font-weight:500;letter-spacing:.5px;margin:0;background-color:#fff;padding:1px 5px;border-radius:5px;position:relative;color:#766d6d;font-weight:600;top:5px;left:4px;border:.5px dotted}.transaction-actions[_ngcontent-%COMP%]{background:#f8fafc;border-top:1px solid #e5e7eb;padding:8px 12px;animation:_ngcontent-%COMP%_slideDown .2s ease}.actions-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px}.action-button[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;transition:all .2s ease}.action-button.edit-btn[_ngcontent-%COMP%]{border:1px dashed gray;color:gray}.action-button.edit-btn[_ngcontent-%COMP%]:hover{background:#bfdbfe;transform:scale(1.05)}.action-button.delete-btn[_ngcontent-%COMP%]{border:1px solid #dc2626;color:#dc2626}.action-button.delete-btn[_ngcontent-%COMP%]:hover{background:#fecaca;transform:scale(1.05)}.transaction-details-expanded[_ngcontent-%COMP%]{background:#f8fafc;border-top:1px solid #e5e7eb;padding:16px 12px;animation:_ngcontent-%COMP%_slideDown .3s ease}.details-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f1f5f9}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex-shrink:0;min-width:120px}.detail-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#6b7280}.detail-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#374151}.detail-value[_ngcontent-%COMP%]{flex:1;text-align:right;display:flex;flex-direction:column;align-items:flex-end;gap:2px}.account-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#1f2937}.account-type[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-style:italic}.transaction-id[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-family:Courier New,monospace;background:#f3f4f6;padding:2px 6px;border-radius:4px}.recurring-info[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#059669;background:#d1fae5;padding:4px 8px;border-radius:6px}.sync-status[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.created-date[_ngcontent-%COMP%], .created-time[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.transaction-notes[_ngcontent-%COMP%]{font-size:14px;color:#374151;font-style:italic;line-height:1.4;text-align:left;max-width:200px;word-wrap:break-word}.fab-add[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:24px;z-index:1000;box-shadow:0 8px 24px #3b82f64d;transition:all .2s ease}.fab-add[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 12px 32px #3b82f666}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 480px){.filter-menu-container[_ngcontent-%COMP%]{flex-direction:row;align-items:stretch;justify-content:flex-end}.filter-menu-btn[_ngcontent-%COMP%]{justify-content:space-between}.summary-stats[_ngcontent-%COMP%]{gap:8px}.stat-item[_ngcontent-%COMP%]{flex-direction:row;gap:4px}}.split-transaction[_ngcontent-%COMP%]{position:relative;font-size:27px;top:-28px!important;left:-24px!important;color:#b75e5e}.category-split-transaction[_ngcontent-%COMP%]{position:relative;font-size:27px;top:-28px!important;left:-24px!important;color:#059669}.category-splits-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-top:8px}.category-split-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:#f0f9ff;border:1px solid #bae6fd;border-radius:6px;font-size:14px}.category-split-item[_ngcontent-%COMP%]   .split-category[_ngcontent-%COMP%]{font-weight:500;color:#0369a1}.category-split-item[_ngcontent-%COMP%]   .split-amount[_ngcontent-%COMP%]{font-weight:600;color:#059669}"]});let e=i;return e})();var bf=Yr(Xr());var yf=(e,i)=>i.id,$V=(e,i,n)=>({"max-h-[calc(78vh-210px)]":e,"max-h-[65vh]":i,"max-h-[69vh]":n}),Wy=e=>({"min-w-[150px] max-w-[150px]":e});function YV(e,i){if(e&1){let n=ue();s(0,"div",24)(1,"span",25),d(2),c(),s(3,"button",26),F("click",function(){R(n);let r=v(2);return B(r.onBulkUpdateCategory())}),s(4,"mat-icon",27),d(5,"category"),c(),d(6," Update Category "),c(),s(7,"button",28),F("click",function(){R(n);let r=v(2);return B(r.onBulkDelete())}),s(8,"mat-icon",27),d(9,"delete"),c(),d(10," Delete "),c()()}if(e&2){let n=v(2);u(2),ne("",n.getSelectedCount()," selected")}}function WV(e,i){if(e&1&&(s(0,"div",22),N(1,YV,11,1,"div",23),c()),e&2){let n=v();u(),P("ngIf",n.hasSelection()&&(n.breakpointService.device.isTablePortrait||n.breakpointService.device.isDesktop)&&!n.isHome)}}function GV(e,i){if(e&1){let n=ue();s(0,"th",56)(1,"mat-checkbox",57),F("change",function(r){R(n);let a=v(3);return B(r?a.toggleAllSelection():null)}),c()()}if(e&2){let n=v(3);u(),P("checked",n.isAllSelected)("indeterminate",n.isIndeterminate)("disabled",!n.dataSource.data.length)}}function HV(e,i){if(e&1){let n=ue();s(0,"td",58)(1,"mat-checkbox",59),F("click",function(r){return R(n),B(r.stopPropagation())})("change",function(r){let a=R(n).$implicit,o=v(3);return B(r?o.toggleSelection(a):null)}),c()()}if(e&2){let n=i.$implicit,t=v(3);u(),P("checked",t.isSelected(n))}}function qV(e,i){e&1&&(Co(0,53),N(1,GV,2,3,"th",54)(2,HV,2,1,"td",55),vo())}function XV(e,i){e&1&&(s(0,"th",60)(1,"div",61)(2,"mat-icon",62),d(3,"schedule"),c(),s(4,"span",63),d(5,"Date"),c()()())}function KV(e,i){if(e&1&&(d(0),ce(1,"date")),e&2){let n=v().$implicit;ne(" ",ht(1,1,n.date.seconds*1e3,"MMM dd")," ")}}function ZV(e,i){if(e&1&&(d(0),ce(1,"date")),e&2){let n=v().$implicit;ne(" ",ht(1,1,n.date.seconds*1e3,"dd MMM yyyy hh:mm a")," ")}}function QV(e,i){if(e&1&&(d(0),ce(1,"date")),e&2){let n=v().$implicit;ne(" ",ht(1,1,n.date.seconds*1e3,"dd MMM yyyy")," ")}}function JV(e,i){if(e&1&&(s(0,"div",67),d(1),ce(2,"date"),c()),e&2){let n=v().$implicit;u(),ne(" ",ht(2,1,n.date.seconds*1e3,"hh:mm a")," ")}}function eU(e,i){if(e&1&&(s(0,"td",64)(1,"div",65),N(2,KV,2,4)(3,ZV,2,4)(4,QV,2,4),c(),N(5,JV,3,4,"div",66),c()),e&2){let n=v(2);u(2),we(n.breakpointService.device.isTablePortrait?2:n.breakpointService.device.isDesktop?3:4),u(3),P("ngIf",!n.breakpointService.device.isDesktop)}}function tU(e,i){e&1&&(s(0,"th",68)(1,"div",69)(2,"mat-icon",62),d(3,"category"),c(),s(4,"span",63),d(5,"Category"),c()()())}function nU(e,i){if(e&1&&(s(0,"td",70)(1,"div",71)(2,"div",72)(3,"mat-icon",73),d(4),c()(),s(5,"span",74),d(6),c()()()),e&2){let n=i.$implicit,t=v(2);u(3),wt("color",t.getCategoryColor(n.categoryId)),u(),L(t.getCategoryIcon(n.categoryId)),u(2),ne(" ",t.getCategoryName(n.categoryId)," ")}}function iU(e,i){if(e&1&&(s(0,"th",75)(1,"div",61)(2,"mat-icon",62),d(3,"description"),c(),s(4,"span",63),d(5,"Description"),c()()()),e&2){let n=v(2);P("ngClass",Ta(1,Wy,n.breakpointService.device.isTablePortrait))}}function rU(e,i){if(e&1&&(s(0,"div",79),d(1),c()),e&2){let n=v().$implicit;P("matTooltip",n.payee),u(),L(n.payee)}}function aU(e,i){if(e&1){let n=ue();s(0,"input",80),lt("ngModelChange",function(r){R(n);let a=v().$implicit;return ct(a.payee,r)||(a.payee=r),B(r)}),c()}if(e&2){let n=v().$implicit;st("ngModel",n.payee)}}function oU(e,i){if(e&1&&(s(0,"td",76),N(1,rU,2,2,"div",77)(2,aU,1,1,"input",78),c()),e&2){let n=i.$implicit,t=v(2);P("ngClass",Ta(3,Wy,t.breakpointService.device.isTablePortrait)),u(),P("ngIf",!n.isEditing),u(),P("ngIf",n.isEditing)}}function sU(e,i){e&1&&(s(0,"th",81)(1,"div",61)(2,"mat-icon",62),d(3,"account_balance_wallet"),c(),s(4,"span",63),d(5,"Amount"),c()()())}function cU(e,i){if(e&1&&(s(0,"span",85),d(1),c()),e&2){let n=v().$implicit;jt(n.type==="income"?"text-green-700":"text-red-800"),u(),ne(" ",(n.type=="income"?"+":"-")+" \u20B9"+n.amount.toLocaleString()," ")}}function lU(e,i){if(e&1){let n=ue();s(0,"input",86),lt("ngModelChange",function(r){R(n);let a=v().$implicit;return ct(a.amount,r)||(a.amount=r),B(r)}),c()}if(e&2){let n=v().$implicit;st("ngModel",n.amount)}}function dU(e,i){if(e&1&&(s(0,"td",82),N(1,cU,2,3,"span",83)(2,lU,1,1,"input",84),c()),e&2){let n=i.$implicit;u(),P("ngIf",!n.isEditing),u(),P("ngIf",n.isEditing)}}function mU(e,i){e&1&&(s(0,"th",87)(1,"div",61)(2,"mat-icon",62),d(3,"swap_horiz"),c(),s(4,"span",63),d(5,"Type"),c()()())}function gU(e,i){if(e&1&&(s(0,"span")(1,"span",91)(2,"mat-icon",92),d(3),c(),d(4),c()()),e&2){let n=v().$implicit;u(),jt(n.type==="income"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),u(2),L(n.type==="income"?"trending_up":"trending_down"),u(),ne(" ",n.type," ")}}function uU(e,i){if(e&1){let n=ue();s(0,"select",93),lt("ngModelChange",function(r){R(n);let a=v().$implicit;return ct(a.type,r)||(a.type=r),B(r)}),s(1,"option",94),d(2,"Income"),c(),s(3,"option",95),d(4,"Expense"),c()()}if(e&2){let n=v().$implicit;st("ngModel",n.type)}}function pU(e,i){if(e&1&&(s(0,"td",88),N(1,gU,5,4,"span",89)(2,uU,5,1,"select",90),c()),e&2){let n=i.$implicit;u(),P("ngIf",!n.isEditing),u(),P("ngIf",n.isEditing)}}function fU(e,i){e&1&&(s(0,"th",60)(1,"div",61)(2,"mat-icon",62),d(3,"account_balance"),c(),s(4,"span",63),d(5,"Account"),c()()())}function hU(e,i){if(e&1&&(s(0,"td",64)(1,"div",65),d(2),c()()),e&2){let n=i.$implicit,t=v(2);u(2),ne(" ",t.getAccountName(n.accountId)," ")}}function _U(e,i){e&1&&(s(0,"th",96)(1,"div",97)(2,"mat-icon",62),d(3,"settings"),c(),s(4,"span",63),d(5,"Actions"),c()()())}function xU(e,i){if(e&1){let n=ue();s(0,"div",100)(1,"button",101),F("click",function(r){R(n);let a=v().$implicit,o=v(2);return r.stopPropagation(),B(o.onStartRowEdit(a))}),s(2,"mat-icon",102),d(3,"edit"),c()(),s(4,"button",103),F("click",function(r){R(n);let a=v().$implicit,o=v(2);return r.stopPropagation(),B(o.onDeleteTransaction(a))}),s(5,"mat-icon",102),d(6,"delete"),c()()()}}function CU(e,i){if(e&1){let n=ue();s(0,"div",100)(1,"button",104),F("click",function(r){R(n);let a=v().$implicit,o=v(2);return r.stopPropagation(),B(o.onSaveRowEdit(a))}),s(2,"mat-icon",102),d(3,"check"),c()(),s(4,"button",105),F("click",function(r){R(n);let a=v().$implicit,o=v(2);return r.stopPropagation(),B(o.onCancelRowEdit(a))}),s(5,"mat-icon",102),d(6,"close"),c()()()}}function vU(e,i){if(e&1&&(s(0,"td",98),N(1,xU,7,0,"div",99)(2,CU,7,0,"div",99),c()),e&2){let n=i.$implicit;u(),P("ngIf",!n.isEditing),u(),P("ngIf",n.isEditing)}}function bU(e,i){e&1&&re(0,"tr",106)}function yU(e,i){if(e&1){let n=ue();s(0,"tr",107),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.onRowClick(r))}),c()}}function MU(e,i){if(e&1&&(s(0,"div",29)(1,"table",30),N(2,qV,3,0,"ng-container",31),Co(3,32),N(4,XV,6,0,"th",33)(5,eU,6,2,"td",34),vo(),Co(6,35),N(7,tU,6,0,"th",36)(8,nU,7,4,"td",37),vo(),Co(9,38),N(10,iU,6,3,"th",39)(11,oU,3,5,"td",40),vo(),Co(12,41),N(13,sU,6,0,"th",42)(14,dU,3,2,"td",43),vo(),Co(15,44),N(16,mU,6,0,"th",45)(17,pU,3,2,"td",46),vo(),Co(18,47),N(19,fU,6,0,"th",33)(20,hU,3,1,"td",34),vo(),Co(21,48),N(22,_U,6,0,"th",49)(23,vU,3,2,"td",50),vo(),N(24,bU,1,0,"tr",51)(25,yU,1,0,"tr",52),c()()),e&2){let n=v();u(),P("dataSource",n.dataSource),u(),P("ngIf",(n.breakpointService.device.isTablePortrait||n.breakpointService.device.isDesktop)&&!n.isHome),u(22),P("matHeaderRowDef",n.displayedColumns),u(),P("matRowDefColumns",n.displayedColumns)}}function PU(e,i){if(e&1){let n=ue();s(0,"div",127)(1,"mat-checkbox",59),F("click",function(r){return R(n),B(r.stopPropagation())})("change",function(r){R(n);let a=v().$implicit,o=v(2);return B(r?o.toggleSelection(a):null)}),c()()}if(e&2){let n=v().$implicit,t=v(2);u(),P("checked",t.isSelected(n))}}function OU(e,i){if(e&1){let n=ue();s(0,"div",111),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.onRowClick(r))}),s(1,"div",112)(2,"div",113),N(3,PU,2,1,"div",114),s(4,"div",115)(5,"mat-icon",116),d(6),c()(),s(7,"div",117)(8,"div",118)(9,"h4",119),d(10),c(),s(11,"span",120),d(12),c()(),s(13,"div",121)(14,"span"),d(15),c(),s(16,"span",122)(17,"mat-icon",92),d(18),c(),d(19),c()()()(),s(20,"div",118)(21,"div",123)(22,"div",124),d(23),c()(),s(24,"div",125)(25,"button",101),F("click",function(r){let a=R(n).$implicit,o=v(2);return r.stopPropagation(),B(o.onStartRowEdit(a))}),s(26,"mat-icon",126),d(27,"edit"),c()(),s(28,"button",103),F("click",function(r){let a=R(n).$implicit,o=v(2);return r.stopPropagation(),B(o.onDeleteTransaction(a))}),s(29,"mat-icon",126),d(30,"delete"),c()()()()()()}if(e&2){let n=i.$implicit,t=v(2);u(3),P("ngIf",(t.breakpointService.device.isTablePortrait||t.breakpointService.device.isDesktop)&&!t.isHome),u(2),wt("color",t.getCategoryColor(n.categoryId)),u(),L(t.getCategoryIcon(n.categoryId)),u(3),P("matTooltip",n.payee),u(),L(n.payee),u(2),ne(" ",t.getCategoryName(n.categoryId)," "),u(3),L(t.getDateDisplay(n.date)),u(),jt(n.type==="income"?"text-green-600":"text-red-600"),u(2),L(n.type==="income"?"trending_up":"trending_down"),u(),ne(" ",n.type," "),u(3),jt(n.type==="income"?"text-green-700":"text-red-800"),u(),ne(" ",(n.type=="income"?"+":"-")+" \u20B9"+n.amount.toLocaleString()," ")}}function wU(e,i){if(e&1&&(s(0,"div",108)(1,"div",109),Ge(2,OU,31,15,"div",110,yf),c()()),e&2){let n=v();u(2),He(n.dataSource.data)}}function SU(e,i){if(e&1){let n=ue();s(0,"div",131),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.onRowClick(r))}),s(1,"div",132)(2,"div",133)(3,"div",134)(4,"mat-icon"),d(5),c()(),s(6,"div",135)(7,"div",136),d(8),c(),s(9,"div",137),d(10),c()()(),s(11,"div",138)(12,"div",139),d(13),c(),s(14,"div",140),d(15),c()()(),s(16,"div",141)(17,"span",142)(18,"mat-icon"),d(19),c(),d(20),c(),s(21,"div",143)(22,"button",101),F("click",function(r){let a=R(n).$implicit,o=v(2);return r.stopPropagation(),B(o.onStartRowEdit(a))}),s(23,"mat-icon"),d(24,"edit"),c()(),s(25,"button",103),F("click",function(r){let a=R(n).$implicit,o=v(2);return r.stopPropagation(),B(o.onDeleteTransaction(a))}),s(26,"mat-icon"),d(27,"delete"),c()()()()()}if(e&2){let n=i.$implicit,t=v(2);u(4),wt("color",t.getCategoryColor(n.categoryId)),u(),L(t.getCategoryIcon(n.categoryId)),u(3),L(n.payee),u(2),L(t.getCategoryName(n.categoryId)),u(2),jt(n.type==="income"?"income":"expense"),u(),ne(" ",(n.type=="income"?"+":"-")+" \u20B9"+n.amount.toLocaleString()," "),u(2),L(t.getDateDisplay(n.date)),u(2),jt(n.type==="income"?"income":"expense"),u(2),L(n.type==="income"?"trending_up":"trending_down"),u(),ne(" ",n.type," ")}}function kU(e,i){if(e&1&&(s(0,"div",128)(1,"div",129),Ge(2,SU,28,13,"div",130,yf),c()()),e&2){let n=v();u(2),He(n.dataSource.data)}}function TU(e,i){if(e&1){let n=ue();s(0,"div",147),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.onRowClick(r))}),s(1,"div",118)(2,"div",148)(3,"mat-icon",126),d(4),c()(),s(5,"div",117)(6,"div",112)(7,"h4",119),d(8),c(),s(9,"div",149),d(10),c()(),s(11,"div",150)(12,"div",151)(13,"span"),d(14),c(),s(15,"span",152),d(16),c()(),s(17,"div",125)(18,"button",101),F("click",function(r){let a=R(n).$implicit,o=v(2);return r.stopPropagation(),B(o.onStartRowEdit(a))}),s(19,"mat-icon",126),d(20,"edit"),c()(),s(21,"button",103),F("click",function(r){let a=R(n).$implicit,o=v(2);return r.stopPropagation(),B(o.onDeleteTransaction(a))}),s(22,"mat-icon",126),d(23,"delete"),c()()()()()()()}if(e&2){let n=i.$implicit,t=v(2);u(3),wt("color",t.getCategoryColor(n.categoryId)),u(),L(t.getCategoryIcon(n.categoryId)),u(3),P("matTooltip",n.payee),u(),L(n.payee),u(),jt(n.type==="income"?"text-green-700":"text-red-800"),u(),ne(" ",(n.type=="income"?"+":"-")+" \u20B9"+n.amount.toLocaleString()," "),u(4),L(t.getDateDisplay(n.date)),u(2),ne(" ",t.getCategoryName(n.categoryId)," ")}}function EU(e,i){if(e&1&&(s(0,"div",144)(1,"div",145),Ge(2,TU,24,10,"div",146,yf),c()()),e&2){let n=v();u(2),He(n.dataSource.data)}}function IU(e,i){if(e&1){let n=ue();s(0,"div",153)(1,"mat-icon",154),d(2,"receipt_long"),c(),s(3,"h3",155),d(4),c(),s(5,"p",156),d(6,"No transactions found for the current year. Start by adding your first transaction to track your finances."),c(),s(7,"button",157),F("click",function(){R(n);let r=v();return B(r.onAddTransaction())}),s(8,"mat-icon"),d(9,"add"),c(),s(10,"span"),d(11,"Add Transaction"),c()()()}if(e&2){let n=v();u(4),ne("No transactions for ",n.getCurrentYear(),"")}}var Gy=(()=>{let i=class i{constructor(t,r,a,o,l,m,g){this.auth=t,this.dateService=r,this.filterService=a,this.store=o,this.ssrService=l,this.dialog=m,this.breakpointService=g,this.isHome=!1,this.editTransaction=new _n,this.deleteTransaction=new _n,this.startRowEdit=new _n,this.saveRowEdit=new _n,this.cancelRowEdit=new _n,this.addTransaction=new _n,this.bulkDeleteTransactions=new _n,this.bulkUpdateCategory=new _n,this.dataSource=new Ll,this.displayedColumns=["select","Date","Type","Payee","Amount","Status","Actions"],this.isListView=!1,this.selectedTransactions=new Set,this.isAllSelected=!1,this.isIndeterminate=!1,this.accounts=[],this.MOBILE_BREAKPOINT=640,this.TABLET_BREAKPOINT=768,this.subscription=new Ri,this.categories={},this.transactions$=this.store.select(Gn),this.allTransactions=[]}ngOnInit(){this.setupDataSource(),this.setupFilterServiceSubscriptions(),this.setupTransactionSubscriptions(),this.loadCategories(),this.loadAccounts(),this.updateColumnVisibility()}ngOnDestroy(){this.subscription.unsubscribe()}ngAfterViewInit(){this.setupSorting()}onResize(){this.updateColumnVisibility()}loadAccounts(){this.store.select(ca).subscribe(t=>{this.accounts=t})}updateColumnVisibility(){if(this.ssrService.isClientSide()){let t=window.innerWidth;t<this.MOBILE_BREAKPOINT?this.displayedColumns=["Date","Payee","Amount","Actions"]:t<this.TABLET_BREAKPOINT?this.displayedColumns=this.isHome?["Date","Type","Payee","Amount","Actions"]:["select","Date","Type","Payee","Amount","Actions"]:this.displayedColumns=this.isHome?["Date","Type","Payee","Amount","Status","Actions"]:["select","Date","Type","Payee","Amount","Status","Actions","Account"]}}setupDataSource(){this.dataSource=new Ll([]),this.dataSource.filterPredicate=(t,r)=>this.filterService.filterTransactions([t],{searchTerm:r,selectedCategory:this.filterService.getSelectedCategory(),selectedType:this.filterService.getSelectedType(),selectedYear:this.filterService.getSelectedYear(),selectedDate:this.filterService.getSelectedDate(),selectedDateRange:this.filterService.getSelectedDateRange(),categoryFilter:this.filterService.getCategoryFilter(),accountFilter:this.filterService.getAccountFilter(),amountRange:this.filterService.getAmountRange(),statusFilter:this.filterService.getStatusFilter(),tags:this.filterService.getTags()}).length>0}setupTransactionSubscriptions(){this.subscription.add(this.transactions$.subscribe(t=>{this.allTransactions=t.sort((r,a)=>{var m,g;let o=this.dateService.toDate(r.date),l=this.dateService.toDate(a.date);return((m=l==null?void 0:l.getTime())!=null?m:0)-((g=o==null?void 0:o.getTime())!=null?g:0)}),this.updateFilteredData()}))}setupFilterServiceSubscriptions(){this.subscription.add(this.filterService.filterState$.subscribe(()=>{this.updateFilteredData()}))}updateFilteredData(){var f,h;let t=(0,bf.default)().year(),r;this.filterService.getSelectedDate()||this.filterService.getSelectedDateRange()||this.filterService.getSelectedYear()?r=this.filterService.filterTransactions(this.allTransactions,this.filterService.getCurrentFilterState()):r=this.filterService.filterCurrentYearTransactions(this.allTransactions,this.filterService.getCurrentFilterState());let o=((f=this.sort)==null?void 0:f.direction)||"desc",l=((h=this.sort)==null?void 0:h.active)||"Date",m=this.getSortByFromMatSort(l,o),g=this.filterService.sortTransactions(r,m);this.dataSource.data=g}getSortByFromMatSort(t,r){switch(t){case"Date":return r==="asc"?"date-asc":"date-desc";case"Amount":return r==="asc"?"amount-asc":"amount-desc";case"Payee":return"payee-asc";case"Type":return"category-asc";default:return"date-desc"}}setupSorting(){this.dataSource.sortingDataAccessor=(t,r)=>{switch(r){case"Date":return(this.dateService.toDate(t==null?void 0:t.date)||new Date).getTime();case"Type":return(t==null?void 0:t.category.toString().toLowerCase())||"";case"Payee":return((t==null?void 0:t.payee)||"").toLowerCase();case"Amount":return t==null?void 0:t.amount;case"Status":return((t==null?void 0:t.type)||"").toLowerCase();default:return""}},this.dataSource.sort=this.sort,this.subscription.add(this.sort.sortChange.subscribe(t=>{console.log(`Sorting by ${t.active} in ${t.direction} order`),this.updateFilteredData()})),this.sort.sort({id:"Date",start:"desc",disableClear:!1})}onEditTransaction(t){this.editTransaction.emit(t)}onDeleteTransaction(t){this.dialog.open(Hr,{width:"300px",data:{title:"Delete Transaction",message:"Are you sure you want to delete this transaction?",confirmText:"Delete",cancelText:"Cancel"}}).afterClosed().subscribe(r=>{r&&this.deleteTransaction.emit(t)})}onStartRowEdit(t){this.editTransaction.emit(t)}onSaveRowEdit(t){this.saveRowEdit.emit(t)}onCancelRowEdit(t){this.cancelRowEdit.emit(t)}onAddTransaction(){this.addTransaction.emit()}onRowClick(t){this.openTransactionViewDialog(t)}openTransactionViewDialog(t){let r=this.dialog.open(Es,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog",data:{transaction:t,mode:"view"}})}getFilteredCount(){return this.dataSource.data.length}getTotalCount(){return this.allTransactions.length}getCurrentYear(){return(0,bf.default)().year()}getCurrentSortState(){return this.sort&&this.sort.active?{active:this.sort.active,direction:this.sort.direction}:null}clearSort(){this.sort&&this.sort.sort({id:"",start:"asc",disableClear:!1})}loadCategories(){var r;((r=this.auth.currentUser)==null?void 0:r.uid)&&this.store.select(un).subscribe(a=>{for(let o of a)this.categories[o.id]=o})}getCategoryIcon(t){var r;return((r=this.categories[t])==null?void 0:r.icon)||"category"}getCategoryName(t){var r;return((r=this.categories[t])==null?void 0:r.name)||t}getCategoryColor(t){var r;return((r=this.categories[t])==null?void 0:r.color)||"#46777f"}getDateDisplay(t){return t&&typeof t=="object"&&"seconds"in t?new Date(t.seconds*1e3).toLocaleDateString(Ut.LANGUAGE.DEFAULT,{month:"short",day:"numeric"}):t instanceof Date?t.toLocaleDateString(Ut.LANGUAGE.DEFAULT,{month:"short",day:"numeric"}):""}getTotalIncome(){return this.dataSource.data.filter(t=>t.type==="income").reduce((t,r)=>t+r.amount,0)}getTotalExpense(){return this.dataSource.data.filter(t=>t.type==="expense").reduce((t,r)=>t+r.amount,0)}getNetAmount(){return this.getTotalIncome()-this.getTotalExpense()}getTransactionCount(){return this.dataSource.data.length}clearAllFilters(){this.filterService.clearAllFilters()}getActiveFiltersCount(){return this.filterService.getActiveFiltersCount()}hasActiveFilters(){return this.filterService.hasActiveFilters()}getCurrentFilterState(){return this.filterService.getCurrentFilterState()}toggleView(){this.isListView=!this.isListView}isSelected(t){return this.selectedTransactions.has(t.id)}toggleSelection(t){this.selectedTransactions.has(t.id)?this.selectedTransactions.delete(t.id):this.selectedTransactions.add(t.id),this.updateSelectionState()}toggleAllSelection(){this.isAllSelected?this.selectedTransactions.clear():this.dataSource.data.forEach(t=>{this.selectedTransactions.add(t.id)}),this.updateSelectionState()}updateSelectionState(){let t=this.selectedTransactions.size,r=this.dataSource.data.length;this.isAllSelected=t===r&&r>0,this.isIndeterminate=t>0&&t<r}getSelectedTransactions(){return this.dataSource.data.filter(t=>this.selectedTransactions.has(t.id))}getSelectedCount(){return this.selectedTransactions.size}hasSelection(){return this.selectedTransactions.size>0}clearSelection(){this.selectedTransactions.clear(),this.updateSelectionState()}onBulkDelete(){let t=this.getSelectedTransactions();if(t.length===0)return;this.dialog.open(Hr,{width:"400px",data:{title:"Delete Multiple Transactions",message:`Are you sure you want to delete ${t.length} transaction(s)? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",confirmColor:"warn"}}).afterClosed().subscribe(a=>{a&&(this.bulkDeleteTransactions.emit(t),this.clearSelection())})}onBulkUpdateCategory(){let t=this.getSelectedTransactions();if(t.length===0)return;let r=Object.values(this.categories).filter(o=>!o.parentCategoryId);this.dialog.open(Xm,{width:"500px",data:{title:"Update Category for Multiple Transactions",message:`Select a new category for ${t.length} transaction(s):`,categories:r}}).afterClosed().subscribe(o=>{o&&(this.bulkUpdateCategory.emit({transactions:t,categoryId:o.id}),this.clearSelection())})}getAccountName(t){var r;return((r=this.accounts.find(a=>a.accountId===t))==null?void 0:r.name)||t}};i.\u0275fac=function(r){return new(r||i)(Y(xt),Y(Vt),Y(Qa),Y(pt),Y(Vr),Y(xn),Y(gr))},i.\u0275cmp=Re({type:i,selectors:[["transaction-table"]],viewQuery:function(r,a){if(r&1&&ar(mm,5),r&2){let o;Ni(o=Li())&&(a.sort=o.first)}},hostBindings:function(r,a){r&1&&F("resize",function(l){return a.onResize(l)},!1,p1)},inputs:{isHome:"isHome"},outputs:{editTransaction:"editTransaction",deleteTransaction:"deleteTransaction",startRowEdit:"startRowEdit",saveRowEdit:"saveRowEdit",cancelRowEdit:"cancelRowEdit",addTransaction:"addTransaction",bulkDeleteTransactions:"bulkDeleteTransactions",bulkUpdateCategory:"bulkUpdateCategory"},decls:71,vars:25,consts:[[1,"bg-white","rounded-lg","border","border-gray-200","overflow-hidden","flex","flex-col",3,"ngClass"],["class","flex justify-between items-center p-3 border-b border-gray-200 bg-gray-50",4,"ngIf"],["class","hidden sm:flex flex-1 overflow-auto table-container",4,"ngIf"],["class","hidden sm:flex flex-1 overflow-auto list-container",4,"ngIf"],[1,"hidden","sm:flex","fixed-footer"],[1,"footer-content"],[1,"transaction-count"],[1,"count-text"],[1,"totals-section"],[1,"total-item"],[1,"income"],[1,"total-content"],[1,"total-label"],[1,"total-value","income"],[1,"expense"],[1,"total-value","expense"],[1,"total-item","net-separator"],[1,"total-value"],["class","sm:hidden flex-1 overflow-auto max-h-full mobile-card-view",4,"ngIf"],["class","sm:hidden flex-1 overflow-auto max-h-full mobile-list-view",4,"ngIf"],[1,"sm:hidden","fixed-footer"],["class","text-center py-8 md:py-12 px-4",4,"ngIf"],[1,"flex","justify-between","items-center","p-3","border-b","border-gray-200","bg-gray-50"],["class","flex items-center space-x-2",4,"ngIf"],[1,"flex","items-center","space-x-2"],[1,"text-sm","text-gray-600"],["mat-button","","color","primary","matTooltip","Update category for selected transactions",1,"text-xs","px-3","py-1","rounded-md","transition-colors",3,"click"],[1,"text-sm","mr-1"],["mat-button","","color","warn","matTooltip","Delete selected transactions",1,"text-xs","px-3","py-1","rounded-md","transition-colors",3,"click"],[1,"hidden","sm:flex","flex-1","overflow-auto","table-container"],["mat-table","","matSort","",1,"w-full","min-w-[800px]",3,"dataSource"],["matColumnDef","select",4,"ngIf"],["matColumnDef","Date"],["mat-header-cell","","mat-sort-header","","class","bg-gray-50 px-3 py-4 md:px-6 sticky top-0 z-10",4,"matHeaderCellDef"],["mat-cell","","class","px-3 py-4 border-b border-gray-100 md:px-6",4,"matCellDef"],["matColumnDef","Type"],["mat-header-cell","","mat-sort-header","","class","px-1 py-4  hidden sm:table-cell sticky top-0 z-10 bg-gray-50",4,"matHeaderCellDef"],["mat-cell","","class","px-1 py-4 border-b border-gray-100  hidden sm:table-cell",4,"matCellDef"],["matColumnDef","Payee"],["mat-header-cell","","mat-sort-header","","class","px-3 py-4 md:px-6 sticky top-0 z-10 bg-gray-50 min-w-[200px] max-w-[200px]",3,"ngClass",4,"matHeaderCellDef"],["mat-cell","","class","px-3 py-4 border-b border-gray-100 md:px-6 min-w-[200px] max-w-[200px]",3,"ngClass",4,"matCellDef"],["matColumnDef","Amount"],["mat-header-cell","","mat-sort-header","","class","bg-gray-50 px-1 py-4  sticky top-0 z-10",4,"matHeaderCellDef"],["mat-cell","","class","px-1 py-4 border-b border-gray-100 ",4,"matCellDef"],["matColumnDef","Status"],["mat-header-cell","","mat-sort-header","","class","bg-gray-50 px-3 py-4 md:px-6 hidden md:table-cell sticky top-0 z-10",4,"matHeaderCellDef"],["mat-cell","","class","px-3 py-4 border-b border-gray-100 md:px-6 hidden md:table-cell",4,"matCellDef"],["matColumnDef","Account"],["matColumnDef","Actions"],["mat-header-cell","","class","bg-gray-50 px-3 py-4 md:px-6 text-center sticky top-0 z-10",4,"matHeaderCellDef"],["mat-cell","","class","px-3 py-4 border-b border-gray-100 text-center md:px-6",4,"matCellDef"],["mat-header-row","","class","h-12 md:h-16 sticky top-0 z-10",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50 transition-colors cursor-pointer",3,"click",4,"matRowDef","matRowDefColumns"],["matColumnDef","select"],["mat-header-cell","","class","bg-gray-50 px-3 py-4 sticky top-0 z-10",4,"matHeaderCellDef"],["mat-cell","","class","px-3 py-4 border-b border-gray-100",4,"matCellDef"],["mat-header-cell","",1,"bg-gray-50","px-3","py-4","sticky","top-0","z-10"],[1,"text-gray-700",3,"change","checked","indeterminate","disabled"],["mat-cell","",1,"px-3","py-4","border-b","border-gray-100"],[1,"text-gray-700",3,"click","change","checked"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50","px-3","py-4","md:px-6","sticky","top-0","z-10"],[1,"flex","items-center","space-x-1","md:space-x-2"],[1,"text-gray-500","text-xs","md:text-sm"],[1,"font-semibold","text-gray-700","text-xs","md:text-sm"],["mat-cell","",1,"px-3","py-4","border-b","border-gray-100","md:px-6"],[1,"text-xs","md:text-sm","text-gray-600"],["class","text-xs text-gray-400 hidden md:block",4,"ngIf"],[1,"text-xs","text-gray-400","hidden","md:block"],["mat-header-cell","","mat-sort-header","",1,"px-1","py-4","hidden","sm:table-cell","sticky","top-0","z-10","bg-gray-50"],[1,"flex","items-center","space-x-1"],["mat-cell","",1,"px-1","py-4","border-b","border-gray-100","hidden","sm:table-cell"],[1,"flex","items-center"],[1,"w-6","h-6","md:w-8","md:h-8","rounded-full","flex","items-center","justify-center","bg-gray-100"],[1,"text-xs","md:text-sm"],[1,"inline-flex","items-center","px-1.5","md:px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-800"],["mat-header-cell","","mat-sort-header","",1,"px-3","py-4","md:px-6","sticky","top-0","z-10","bg-gray-50","min-w-[200px]","max-w-[200px]",3,"ngClass"],["mat-cell","",1,"px-3","py-4","border-b","border-gray-100","md:px-6","min-w-[200px]","max-w-[200px]",3,"ngClass"],["class","font-medium text-gray-900 text-xs md:text-sm w-full overflow-hidden text-ellipsis whitespace-nowrap",3,"matTooltip",4,"ngIf"],["class","w-full px-2 md:px-3 py-1 md:py-2 border border-blue-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","placeholder","Enter payee name",3,"ngModel","ngModelChange",4,"ngIf"],[1,"font-medium","text-gray-900","text-xs","md:text-sm","w-full","overflow-hidden","text-ellipsis","whitespace-nowrap",3,"matTooltip"],["placeholder","Enter payee name",1,"w-full","px-2","md:px-3","py-1","md:py-2","border","border-blue-300","rounded-lg","text-xs","md:text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50","px-1","py-4","sticky","top-0","z-10"],["mat-cell","",1,"px-1","py-4","border-b","border-gray-100"],["class","font-bold text-xs md:text-sm",3,"class",4,"ngIf"],["type","number","class","w-full px-2 md:px-3 py-1 md:py-2 border border-blue-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","placeholder","Enter amount",3,"ngModel","ngModelChange",4,"ngIf"],[1,"font-bold","text-xs","md:text-sm"],["type","number","placeholder","Enter amount",1,"w-full","px-2","md:px-3","py-1","md:py-2","border","border-blue-300","rounded-lg","text-xs","md:text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50","px-3","py-4","md:px-6","hidden","md:table-cell","sticky","top-0","z-10"],["mat-cell","",1,"px-3","py-4","border-b","border-gray-100","md:px-6","hidden","md:table-cell"],[4,"ngIf"],["class","w-full px-2 md:px-3 py-1 md:py-2 border border-blue-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",3,"ngModel","ngModelChange",4,"ngIf"],[1,"inline-flex","items-center","px-2","md:px-3","py-1","rounded-full","text-xs","font-medium"],[1,"text-xs","mr-1"],[1,"w-full","px-2","md:px-3","py-1","md:py-2","border","border-blue-300","rounded-lg","text-xs","md:text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["value","income"],["value","expense"],["mat-header-cell","",1,"bg-gray-50","px-3","py-4","md:px-6","text-center","sticky","top-0","z-10"],[1,"flex","items-center","justify-center","space-x-1","md:space-x-2"],["mat-cell","",1,"px-3","py-4","border-b","border-gray-100","text-center","md:px-6"],["class","flex justify-center space-x-1 md:space-x-2",4,"ngIf"],[1,"flex","justify-center","space-x-1","md:space-x-2"],["mat-icon-button","","matTooltip","Edit transaction",1,"text-blue-600","hover:bg-blue-50","rounded-full","transition-colors",3,"click"],[1,"text-sm","md:text-base"],["mat-icon-button","","matTooltip","Delete transaction",1,"text-red-600","hover:bg-red-50","rounded-full","transition-colors",3,"click"],["mat-icon-button","","color","primary","matTooltip","Save changes",1,"bg-green-100","text-green-600","hover:bg-green-200","rounded-full","transition-colors",3,"click"],["mat-icon-button","","color","warn","matTooltip","Cancel editing",1,"bg-red-100","text-red-600","hover:bg-red-200","rounded-full","transition-colors",3,"click"],["mat-header-row","",1,"h-12","md:h-16","sticky","top-0","z-10"],["mat-row","",1,"hover:bg-gray-50","transition-colors","cursor-pointer",3,"click"],[1,"hidden","sm:flex","flex-1","overflow-auto","list-container"],[1,"w-full","p-4","space-y-3"],[1,"list-item","bg-white","border","border-gray-200","rounded-lg","p-4","hover:bg-gray-50","transition-colors","cursor-pointer"],[1,"list-item","bg-white","border","border-gray-200","rounded-lg","p-4","hover:bg-gray-50","transition-colors","cursor-pointer",3,"click"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","space-x-4","flex-1"],["class","flex-shrink-0",4,"ngIf"],[1,"w-10","h-10","rounded-full","flex","items-center","justify-center","bg-gray-100"],[1,"text-lg"],[1,"flex-1","min-w-0"],[1,"flex","items-center","space-x-3"],[1,"font-medium","text-gray-900","text-sm","truncate",3,"matTooltip"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-800"],[1,"flex","items-center","space-x-4","mt-1","text-xs","text-gray-500"],[1,"inline-flex","items-center"],[1,"text-right"],[1,"font-bold","text-sm"],[1,"flex","space-x-1"],[1,"text-sm"],[1,"flex-shrink-0"],[1,"sm:hidden","flex-1","overflow-auto","max-h-full","mobile-card-view"],[1,"p-4","space-y-3"],[1,"transaction-card"],[1,"transaction-card",3,"click"],[1,"card-header"],[1,"left-section"],[1,"category-icon"],[1,"transaction-info"],[1,"payee-name"],[1,"category-name"],[1,"right-section"],[1,"amount"],[1,"date"],[1,"card-footer"],[1,"type-badge"],[1,"action-buttons"],[1,"sm:hidden","flex-1","overflow-auto","max-h-full","mobile-list-view"],[1,"p-3","space-y-2"],[1,"list-item","bg-white","border","border-gray-200","rounded-lg","p-3","hover:bg-gray-50","transition-colors","cursor-pointer"],[1,"list-item","bg-white","border","border-gray-200","rounded-lg","p-3","hover:bg-gray-50","transition-colors","cursor-pointer",3,"click"],[1,"w-8","h-8","rounded-full","flex","items-center","justify-center","bg-gray-100","flex-shrink-0"],[1,"font-bold","text-sm","ml-2"],[1,"flex","items-center","justify-between","mt-1"],[1,"flex","items-center","space-x-2","text-xs","text-gray-500"],[1,"inline-flex","items-center","px-1.5","py-0.5","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-800"],[1,"text-center","py-8","md:py-12","px-4"],[1,"text-gray-400","text-4xl","md:text-6xl","mb-4"],[1,"text-base","md:text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-500","mb-4","text-sm","md:text-base"],["mat-raised-button","","color","primary",1,"flex","items-center","space-x-2","mx-auto","text-sm","md:text-base",3,"click"]],template:function(r,a){r&1&&(s(0,"div",0),N(1,WV,2,1,"div",1)(2,MU,26,4,"div",2)(3,wU,4,0,"div",3),s(4,"div",4)(5,"div",5)(6,"div",6)(7,"mat-icon"),d(8,"receipt"),c(),s(9,"span",7),d(10),c()(),s(11,"div",8)(12,"div",9)(13,"mat-icon",10),d(14,"trending_up"),c(),s(15,"div",11)(16,"div",12),d(17,"Income"),c(),s(18,"div",13),d(19),c()()(),s(20,"div",9)(21,"mat-icon",14),d(22,"trending_down"),c(),s(23,"div",11)(24,"div",12),d(25,"Expense"),c(),s(26,"div",15),d(27),c()()(),s(28,"div",16)(29,"mat-icon"),d(30,"account_balance_wallet"),c(),s(31,"div",11)(32,"div",12),d(33,"Net"),c(),s(34,"div",17),d(35),c()()()()()(),N(36,kU,4,0,"div",18)(37,EU,4,0,"div",19),s(38,"div",20)(39,"div",5)(40,"div",6)(41,"mat-icon"),d(42,"receipt"),c(),s(43,"span"),d(44),c()(),s(45,"div",8)(46,"div",9)(47,"mat-icon",10),d(48,"trending_up"),c(),s(49,"div",11)(50,"div",12),d(51,"Income"),c(),s(52,"div",13),d(53),c()()(),s(54,"div",9)(55,"mat-icon",14),d(56,"trending_down"),c(),s(57,"div",11)(58,"div",12),d(59,"Expense"),c(),s(60,"div",15),d(61),c()()(),s(62,"div",16)(63,"mat-icon"),d(64,"account_balance_wallet"),c(),s(65,"div",11)(66,"div",12),d(67,"Net"),c(),s(68,"div",17),d(69),c()()()()()(),N(70,IU,12,1,"div",21),c()),r&2&&(P("ngClass",M1(21,$V,a.isHome&&!a.breakpointService.device.isTablePortrait,a.isHome&&a.breakpointService.device.isTablePortrait,!a.isHome)),u(),P("ngIf",!a.isHome),u(),P("ngIf",!a.isListView),u(),P("ngIf",a.isListView),u(7),ne("",a.getTransactionCount()," transactions"),u(9),ne("\u20B9",a.getTotalIncome().toLocaleString(),""),u(8),ne("\u20B9",a.getTotalExpense().toLocaleString(),""),u(7),jt(a.getNetAmount()>=0?"net-positive":"net-negative"),u(),$t(" ",a.getNetAmount()>=0?"+":"","\u20B9",a.getNetAmount().toLocaleString()," "),u(),P("ngIf",!a.isListView),u(),P("ngIf",a.isListView),u(7),ne("",a.getTransactionCount()," transactions"),u(9),ne("\u20B9",a.getTotalIncome().toLocaleString(),""),u(8),ne("\u20B9",a.getTotalExpense().toLocaleString(),""),u(7),jt(a.getNetAmount()>=0?"net-positive":"net-negative"),u(),$t(" ",a.getNetAmount()>=0?"+":"","\u20B9",a.getNetAmount().toLocaleString()," "),u(),P("ngIf",!(a.dataSource.data!=null&&a.dataSource.data.length)))},dependencies:[$n,dt,uc,pc,Nt,Ui,gc,At,Jn,Jt,gn,Qe,Ox,Sx,Ix,kx,wx,Ax,Tx,Ex,Dx,Fx,mm,Rx,za,Tn,_i],styles:[".table-container[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#cbd5e1 #f1f5f9}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}@media (max-width: 768px){.table-container[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;min-width:800px}@media (max-width: 640px){table[_ngcontent-%COMP%]{min-width:600px}}.mat-header-cell[_ngcontent-%COMP%]{background:#f8fafc;border-bottom:2px solid #e2e8f0;font-weight:600;color:#374151;padding:12px 16px;position:sticky;top:0;z-index:10;cursor:pointer;transition:all .2s ease;white-space:nowrap}@media (min-width: 768px){.mat-header-cell[_ngcontent-%COMP%]{padding:16px 24px}}.mat-header-cell[_ngcontent-%COMP%]:hover{background:#f1f5f9}.mat-header-cell[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}@media (min-width: 768px){.mat-header-cell[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{gap:8px}}.mat-header-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px;color:#6b7280}@media (min-width: 768px){.mat-header-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}}.mat-header-cell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;font-weight:600}@media (min-width: 768px){.mat-header-cell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}}.mat-sort-header-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}@media (min-width: 768px){.mat-sort-header-container[_ngcontent-%COMP%]{gap:8px}}.mat-sort-header-container[_ngcontent-%COMP%]   .mat-sort-header-arrow[_ngcontent-%COMP%]{color:#6b7280;opacity:.5;transition:all .2s ease}.mat-sort-header-container[_ngcontent-%COMP%]   .mat-sort-header-indicator[_ngcontent-%COMP%]{color:#3b82f6}.mat-header-cell.mat-sort-header-sorted[_ngcontent-%COMP%]{background:#eff6ff;border-bottom-color:#3b82f6}.mat-header-cell.mat-sort-header-sorted[_ngcontent-%COMP%]   .mat-sort-header-arrow[_ngcontent-%COMP%]{opacity:1;color:#3b82f6}.mat-header-cell.mat-sort-header-sorted[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1e40af}.mat-cell[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #f1f5f9;vertical-align:middle}@media (min-width: 768px){.mat-cell[_ngcontent-%COMP%]{padding:16px 24px}}.mat-cell[_ngcontent-%COMP%]:last-child{border-right:none}.mat-row[_ngcontent-%COMP%]{transition:all .2s ease}.mat-row[_ngcontent-%COMP%]:hover{background-color:#f8fafc;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.mat-row[_ngcontent-%COMP%]:last-child   .mat-cell[_ngcontent-%COMP%]{border-bottom:none}.date-cell[_ngcontent-%COMP%]   .date-main[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#374151;margin-bottom:2px}@media (min-width: 768px){.date-cell[_ngcontent-%COMP%]   .date-main[_ngcontent-%COMP%]{font-size:14px}}.date-cell[_ngcontent-%COMP%]   .date-time[_ngcontent-%COMP%]{font-size:11px;color:#6b7280}@media (min-width: 768px){.date-cell[_ngcontent-%COMP%]   .date-time[_ngcontent-%COMP%]{font-size:12px}}.category-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:2px 8px;border-radius:12px;font-size:11px;font-weight:500;background:#f3f4f6;color:#374151;border:1px solid #e5e7eb}@media (min-width: 768px){.category-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:16px;font-size:12px}}.payee-cell[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{font-weight:500;color:#1f2937;max-width:80px;word-wrap:break-word;line-height:1.4;font-size:12px}@media (min-width: 768px){.payee-cell[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{max-width:120px;font-size:14px}}.payee-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:6px 8px;border:2px solid #3b82f6;border-radius:6px;font-size:12px;transition:all .2s ease}@media (min-width: 768px){.payee-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:8px 12px;border-radius:8px;font-size:14px}}.payee-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f61a}.amount-cell[_ngcontent-%COMP%]{text-align:right}.amount-cell[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-weight:700;font-size:12px}@media (min-width: 768px){.amount-cell[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-size:14px}}.amount-cell[_ngcontent-%COMP%]   .amount-value.income[_ngcontent-%COMP%]{color:#059669}.amount-cell[_ngcontent-%COMP%]   .amount-value.expense[_ngcontent-%COMP%]{color:#dc2626}.amount-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:6px 8px;border:2px solid #3b82f6;border-radius:6px;font-size:12px;text-align:right;transition:all .2s ease}@media (min-width: 768px){.amount-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:8px 12px;border-radius:8px;font-size:14px}}.amount-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f61a}.status-cell[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:2px 6px;border-radius:10px;font-size:10px;font-weight:500}@media (min-width: 768px){.status-cell[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:16px;font-size:12px}}.status-cell[_ngcontent-%COMP%]   .status-badge.income[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.status-cell[_ngcontent-%COMP%]   .status-badge.expense[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.status-cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:6px 8px;border:2px solid #3b82f6;border-radius:6px;font-size:12px;transition:all .2s ease}@media (min-width: 768px){.status-cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px 12px;border-radius:8px;font-size:14px}}.status-cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f61a}.actions-cell[_ngcontent-%COMP%]{text-align:center}.actions-cell[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:4px}@media (min-width: 768px){.actions-cell[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{gap:8px}}.actions-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:32px;height:32px}@media (min-width: 768px){.actions-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:40px;height:40px}}.actions-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}@media (min-width: 768px){.actions-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:16px;margin-bottom:12px;box-shadow:0 1px 3px #0000001a;transition:all .2s ease}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026;transform:translateY(-1px)}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;background:#f3f4f6;display:flex;align-items:center;justify-content:center}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;font-size:14px;margin-bottom:2px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-section[_ngcontent-%COMP%]{text-align:right}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-section[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:700;font-size:14px;margin-bottom:2px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-section[_ngcontent-%COMP%]   .amount.income[_ngcontent-%COMP%]{color:#059669}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-section[_ngcontent-%COMP%]   .amount.expense[_ngcontent-%COMP%]{color:#dc2626}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-section[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 8px;border-radius:12px;font-size:11px;font-weight:500}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .type-badge.income[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .type-badge.expense[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px;margin-right:4px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:4px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:32px;height:32px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}@media (max-width: 640px){.hidden-mobile[_ngcontent-%COMP%]{display:none!important}.table-container[_ngcontent-%COMP%]{border-radius:8px;margin:0 -8px}.mobile-card-view[_ngcontent-%COMP%]{padding:12px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]{margin-bottom:8px;padding:12px}}@media (max-width: 768px){.hidden-tablet[_ngcontent-%COMP%]{display:none!important}}.empty-state[_ngcontent-%COMP%]{padding:2rem 1rem}@media (min-width: 768px){.empty-state[_ngcontent-%COMP%]{padding:3rem 2rem}}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem}@media (min-width: 768px){.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:4rem;width:4rem;height:4rem}}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem}@media (min-width: 768px){.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem}}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem}@media (min-width: 768px){.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem}}.pagination-container[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:8px;padding:16px;margin-top:16px}.pagination-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]{background:transparent;border:none}.pagination-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]     .mat-paginator-container{justify-content:center}.pagination-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]     .mat-paginator-page-size{margin-right:16px}.pagination-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]     .mat-paginator-range-actions{margin-left:16px}.fixed-footer[_ngcontent-%COMP%]{background:#f9fafb;border-top:1px solid #e5e7eb;padding:12px 16px;position:sticky;bottom:0;z-index:10;box-shadow:0 -2px 8px #0000001a}@media (min-width: 768px){.fixed-footer[_ngcontent-%COMP%]{padding:16px 24px}}@media (min-width: 1024px){.fixed-footer[_ngcontent-%COMP%]{padding:20px 32px}}.fixed-footer[_ngcontent-%COMP%]   .footer-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;min-width:800px}@media (max-width: 1200px){.fixed-footer[_ngcontent-%COMP%]   .footer-content[_ngcontent-%COMP%]{min-width:600px}}@media (max-width: 768px){.fixed-footer[_ngcontent-%COMP%]   .footer-content[_ngcontent-%COMP%]{min-width:auto;flex-direction:column;gap:12px}}@media (max-width: 640px){.fixed-footer[_ngcontent-%COMP%]   .footer-content[_ngcontent-%COMP%]{gap:8px}}.fixed-footer[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}@media (max-width: 640px){.fixed-footer[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]{gap:6px}}.fixed-footer[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280;font-size:16px;width:16px;height:16px}@media (max-width: 1024px){.fixed-footer[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}}@media (max-width: 640px){.fixed-footer[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px}}.fixed-footer[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]   .count-text[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#374151}@media (max-width: 1024px){.fixed-footer[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]   .count-text[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 640px){.fixed-footer[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]   .count-text[_ngcontent-%COMP%]{font-size:12px}}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:24px}@media (max-width: 1200px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]{gap:20px}}@media (max-width: 1024px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]{gap:16px}}@media (max-width: 768px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]{gap:16px;width:100%;justify-content:space-between}}@media (max-width: 640px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]{gap:12px}}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}@media (max-width: 1024px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]{gap:6px}}@media (max-width: 640px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]{gap:4px}}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}@media (max-width: 1024px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}}@media (max-width: 640px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px}}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   mat-icon.income[_ngcontent-%COMP%]{color:#059669}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   mat-icon.expense[_ngcontent-%COMP%]{color:#dc2626}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]{text-align:right}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin-bottom:2px}@media (max-width: 1024px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:11px}}@media (max-width: 640px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:10px}}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]{font-size:14px;font-weight:600}@media (max-width: 1024px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 640px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]{font-size:11px}}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value.income[_ngcontent-%COMP%]{color:#059669}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value.expense[_ngcontent-%COMP%]{color:#dc2626}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value.net-positive[_ngcontent-%COMP%]{color:#059669}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value.net-negative[_ngcontent-%COMP%]{color:#dc2626}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .net-separator[_ngcontent-%COMP%]{border-left:1px solid #d1d5db;padding-left:24px;margin-left:8px}@media (max-width: 1200px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .net-separator[_ngcontent-%COMP%]{padding-left:20px;margin-left:6px}}@media (max-width: 1024px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .net-separator[_ngcontent-%COMP%]{padding-left:16px;margin-left:4px}}@media (max-width: 768px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .net-separator[_ngcontent-%COMP%]{padding-left:12px;margin-left:4px}}@media (max-width: 640px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .net-separator[_ngcontent-%COMP%]{padding-left:8px;margin-left:2px}}@media (max-width: 1024px){.mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:12px 16px}.payee-cell[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{max-width:100px}}@media (max-width: 768px){.mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:8px 12px}.mat-header-cell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}.mat-header-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}.payee-cell[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{max-width:80px;font-size:13px}.amount-cell[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-size:13px}.status-cell[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:4px 8px;font-size:11px}.actions-cell[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{width:32px;height:32px}}@media (max-width: 640px){.mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:6px 8px}.mat-header-cell[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{flex-direction:column;gap:4px;text-align:center}.mat-header-cell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}.mat-header-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px}.payee-cell[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{max-width:60px;font-size:12px}.amount-cell[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-size:12px}.status-cell[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:2px 6px;font-size:10px}.actions-cell[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{width:28px;height:28px}}"]});let e=i;return e})();var Ba=Yr(Xr());var DU=(e,i)=>i.value,FU=(e,i)=>i.id,RU=(e,i)=>i.type;function BU(e,i){if(e&1){let n=ue();s(0,"mat-chip",24),F("removed",function(){let r=R(n).$implicit;return B(r.onRemove())}),d(1),s(2,"mat-icon",25),d(3,"cancel"),c()()}if(e&2){let n=i.$implicit;P("removable",!0),u(),ne(" ",n.label," ")}}function NU(e,i){if(e&1&&(s(0,"div",18)(1,"div",19)(2,"div",20)(3,"mat-icon",21),d(4,"filter_alt"),c(),s(5,"span",22),d(6,"Active Filters"),c()(),Ge(7,BU,4,2,"mat-chip",23,RU),c()()),e&2){let n=v();u(7),He(n.getActiveFilters())}}function LU(e,i){if(e&1&&(s(0,"mat-option",14),d(1),c()),e&2){let n=i.$implicit;P("value",n),u(),ne(" ",n," ")}}function VU(e,i){if(e&1&&(s(0,"mat-option",14),d(1),c()),e&2){let n=i.$implicit;P("value",n.value),u(),ne(" ",n.label," ")}}function UU(e,i){if(e&1&&(s(0,"mat-option",14),d(1),c()),e&2){let n=i.$implicit;P("value",n.id),u(),ne(" ",n.name," ")}}var Hy=(()=>{let i=class i{constructor(t,r,a,o){this.notificationService=t,this.store=r,this.dateService=a,this.filterService=o,this.addTransaction=new _n,this.importTransactions=new _n,this.openFilterDialog=new _n,this.viewAnalytics=new _n,this.expandTable=new _n,this.searchTerm="",this.selectedCategory="all",this.selectedType="all",this.selectedYear=(0,Ba.default)().year(),this.selectedMonth=(0,Ba.default)().month(),this.selectedMonthOption="all",this.selectedDate=null,this.selectedDateRange=null,this.categories=[],this.availableYears=[],this.months=[],this.subscription=new Ri,this.transactions$=this.store.select(Gn),this.allTransactions=[],this.filteredCount=0,this.currentYear=(0,Ba.default)().year()}ngOnInit(){this.loadCategoriesFromStore(),this.setupTransactionSubscriptions(),this.updateAvailableYears(),this.updateMonths(),this.setupFilterServiceSubscriptions()}ngOnDestroy(){this.subscription.unsubscribe()}ngOnChanges(t){t.transactions&&(this.updateAvailableYears(),this.updateCategoriesFromTransactions())}setupTransactionSubscriptions(){this.subscription.add(this.transactions$.subscribe(t=>{this.allTransactions=t,this.updateAvailableYears(),this.updateCategoriesFromTransactions(),this.updateFilteredCount()}))}setupFilterServiceSubscriptions(){this.subscription.add(this.filterService.searchTerm$.subscribe(t=>{this.searchTerm=t,this.updateFilteredCount()})),this.subscription.add(this.filterService.selectedCategory$.subscribe(t=>{this.selectedCategory=t.includes("all")?"all":t[0]||"all",this.updateFilteredCount()})),this.subscription.add(this.filterService.selectedType$.subscribe(t=>{this.selectedType=t,this.updateFilteredCount()})),this.subscription.add(this.filterService.selectedDate$.subscribe(t=>{this.selectedDate=t,t&&(this.selectedDateRange=null),this.updateFilteredCount()})),this.subscription.add(this.filterService.selectedDateRange$.subscribe(t=>{this.selectedDateRange=t?{start:t.startDate,end:t.endDate}:null,t&&(this.selectedDate=null),this.updateFilteredCount()})),this.subscription.add(this.filterService.selectedYear$.subscribe(t=>{t&&(this.selectedYear=t.startYear),this.updateFilteredCount()}))}loadCategoriesFromStore(){this.subscription.add(this.store.select(un).subscribe(t=>{this.categories=t.map(r=>({id:r.id||"",name:r.name})).sort((r,a)=>r.name.localeCompare(a.name))}))}updateCategoriesFromTransactions(){if(this.allTransactions&&this.allTransactions.length>0){let t=new Set,r=new Map;this.allTransactions.forEach(a=>{a.categoryId&&a.category&&(t.add(a.categoryId),r.set(a.categoryId,a.category))}),this.categories=Array.from(t).map(a=>({id:a,name:r.get(a)||"Unknown"})).sort((a,o)=>a.name.localeCompare(o.name))}else this.categories=[]}updateAvailableYears(){if(this.allTransactions&&this.allTransactions.length>0){let t=new Set;this.allTransactions.forEach(r=>{if(r.date){let a=(0,Ba.default)(this.dateService.toDate(r.date)).year();t.add(a)}}),t.add(this.currentYear),this.availableYears=Array.from(t).sort((r,a)=>a-r)}else this.availableYears=[this.currentYear];(isNaN(this.selectedYear)||!this.availableYears.includes(this.selectedYear))&&(this.selectedYear=this.availableYears.length>0?this.availableYears[0]:this.currentYear)}updateMonths(){this.months=[{value:0,label:"January"},{value:1,label:"February"},{value:2,label:"March"},{value:3,label:"April"},{value:4,label:"May"},{value:5,label:"June"},{value:6,label:"July"},{value:7,label:"August"},{value:8,label:"September"},{value:9,label:"October"},{value:10,label:"November"},{value:11,label:"December"}]}updateFilteredCount(){this.filterService.getSelectedDate()||this.filterService.getSelectedDateRange()||this.filterService.getSelectedYear()?this.filteredCount=this.filterService.getFilteredCount(this.allTransactions,this.filterService.getCurrentFilterState()):this.filteredCount=this.filterService.getCurrentYearFilteredCount(this.allTransactions,this.filterService.getCurrentFilterState())}onSearchChange(t){let r=t;this.filterService.setSearchTerm(r)}onCategoryChange(t){let r=t;this.filterService.setSelectedCategory([r])}onTypeChange(t){let r=t;this.filterService.setSelectedType(r)}onSelectedYearChange(t){let r=t;if(this.selectedYear=r,this.selectedMonthOption!=="all"){let a=parseInt(this.selectedMonthOption),o=(0,Ba.default)().year(r).month(a).startOf("month").toDate(),l=(0,Ba.default)().year(r).month(a).endOf("month").toDate();this.filterService.setSelectedDateRange(o,l)}else this.filterService.setSelectedYear(r,r)}onSelectedMonthChange(t){if(this.selectedMonthOption=t,t!=="all"){let r=parseInt(t),a=(0,Ba.default)().year(this.selectedYear).month(r).startOf("month").toDate(),o=(0,Ba.default)().year(this.selectedYear).month(r).endOf("month").toDate();this.filterService.setSelectedDateRange(a,o)}else this.filterService.clearSelectedDate(),this.filterService.setSelectedYear(this.selectedYear,this.selectedYear)}onAddTransaction(){this.addTransaction.emit()}onImportTransactions(){this.importTransactions.emit()}onOpenFilterDialog(){this.openFilterDialog.emit()}onViewAnalytics(){this.viewAnalytics.emit()}onExpandTable(){this.expandTable.emit()}onClearAllFilters(){this.filterService.clearAllFilters(),this.selectedDateRange=null,this.selectedDate=null,this.searchTerm="",this.selectedCategory="all",this.selectedType="all",this.selectedYear=this.availableYears.length>0?this.availableYears[0]:this.currentYear,this.selectedMonthOption="all"}onClearSearchFilter(){this.filterService.clearSearchTerm()}onClearYearFilter(){let t=this.availableYears.length>0?this.availableYears[0]:this.currentYear;this.selectedYear=t,this.filterService.setSelectedYear(this.selectedYear,this.selectedYear),this.selectedMonthOption!=="all"&&this.filterService.setSelectedDateRange((0,Ba.default)().year(this.selectedYear).startOf("year").toDate(),(0,Ba.default)().year(this.selectedYear).endOf("year").toDate())}onClearMonthFilter(){this.selectedMonthOption="all",this.filterService.clearSelectedDate(),this.filterService.setSelectedYear(this.selectedYear,this.selectedYear)}onClearCategoryFilter(){this.filterService.clearSelectedCategory()}onClearTypeFilter(){this.filterService.clearSelectedType()}onClearDateRangeFilter(){this.filterService.clearSelectedDate(),this.filterService.clearSelectedYear()}onClearDateFilter(){this.filterService.clearSelectedDate(),this.filterService.clearSelectedYear()}getActiveFilters(){var a,o;let t=[],r=this.availableYears.length>0?this.availableYears[0]:this.currentYear;if(this.searchTerm&&t.push({type:"search",label:`Search: "${this.searchTerm}"`,onRemove:()=>this.onClearSearchFilter()}),this.selectedYear!==r&&t.push({type:"year",label:`Year: ${this.selectedYear}`,onRemove:()=>this.onClearYearFilter()}),this.selectedMonthOption!=="all"){let l=(a=this.months.find(m=>m.value===parseInt(this.selectedMonthOption)))==null?void 0:a.label;t.push({type:"month",label:`Month: ${l}`,onRemove:()=>this.onClearMonthFilter()})}if(this.selectedCategory!=="all"){let l=(o=this.categories.find(m=>m.id===this.selectedCategory))==null?void 0:o.name;t.push({type:"category",label:`Category: ${l||"Unknown"}`,onRemove:()=>this.onClearCategoryFilter()})}return this.selectedType!=="all"&&t.push({type:"type",label:`Type: ${this.selectedType}`,onRemove:()=>this.onClearTypeFilter()}),this.selectedDateRange&&t.push({type:"dateRange",label:`Date Range: ${this.selectedDateRange.start.toLocaleDateString()} - ${this.selectedDateRange.end.toLocaleDateString()}`,onRemove:()=>this.onClearDateRangeFilter()}),this.selectedDate&&t.push({type:"date",label:`Date: ${this.selectedDate.toLocaleDateString()}`,onRemove:()=>this.onClearDateFilter()}),t}hasActiveFilters(){return this.filterService.hasActiveFilters()}getActiveFiltersCount(){return this.filterService.getActiveFiltersCount()}getCurrentFilterState(){return this.filterService.getCurrentFilterState()}saveFilterPreset(t,r){this.filterService.saveAsPreset(t,r)}applyFilterPreset(t){this.filterService.applyPreset(t)}getFilterPresets(){return this.filterService.filterPresets$}getFilterHistory(){return this.filterService.filterHistory$}};i.\u0275fac=function(r){return new(r||i)(Y(ft),Y(pt),Y(Vt),Y(Qa))},i.\u0275cmp=Re({type:i,selectors:[["search-filter"]],outputs:{addTransaction:"addTransaction",importTransactions:"importTransactions",openFilterDialog:"openFilterDialog",viewAnalytics:"viewAnalytics",expandTable:"expandTable"},features:[Xd],decls:63,vars:8,consts:[[1,"bg-white","rounded-xl","border","border-gray-100","shadow-sm","p-4","pb-0"],[1,"flex","items-center","justify-between","mb-2"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","space-x-2"],[1,"w-2","h-2","bg-blue-500","rounded-full"],[1,"text-sm","font-medium","text-gray-700"],[1,"flex","items-center","space-x-1"],[1,"text-sm","font-semibold","text-gray-900"],["class","mb-3 pb-2 border-b border-gray-100",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4","w-full"],["appearance","fill",1,"w-full"],["matInput","","placeholder","Search transactions...",3,"ngModelChange","ngModel"],["matSuffix","",1,"text-gray-400","text-sm"],[3,"ngModelChange","ngModel"],[3,"value"],["value","all"],["value","income"],["value","expense"],[1,"mb-3","pb-2","border-b","border-gray-100"],[1,"flex","flex-wrap","gap-1"],[1,"flex","items-center","space-x-1","ml-2"],[1,"text-blue-500","text-xs"],[1,"text-xs","text-gray-600","font-medium"],[1,"bg-blue-50","text-blue-700","border-blue-200","text-xs","h-6",3,"removable"],[1,"bg-blue-50","text-blue-700","border-blue-200","text-xs","h-6",3,"removed","removable"],["matChipRemove","",1,"text-blue-500","text-xs"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),re(4,"div",4),s(5,"span",5),d(6),c()(),s(7,"div",6)(8,"span",7),d(9),c()()()(),N(10,NU,9,0,"div",8),s(11,"div",9)(12,"div")(13,"mat-form-field",10)(14,"mat-label"),d(15,"Search transactions..."),c(),s(16,"input",11),F("ngModelChange",function(l){return a.onSearchChange(l)}),c(),s(17,"mat-icon",12),d(18,"search"),c()()(),s(19,"div")(20,"mat-form-field",10)(21,"mat-label"),d(22,"Year"),c(),s(23,"mat-select",13),F("ngModelChange",function(l){return a.onSelectedYearChange(l)}),Ge(24,LU,2,2,"mat-option",14,rr),c(),s(26,"mat-icon",12),d(27,"calendar_today"),c()()(),s(28,"div")(29,"mat-form-field",10)(30,"mat-label"),d(31,"Month"),c(),s(32,"mat-select",13),F("ngModelChange",function(l){return a.onSelectedMonthChange(l)}),s(33,"mat-option",15),d(34,"All Months"),c(),Ge(35,VU,2,2,"mat-option",14,DU),c(),s(37,"mat-icon",12),d(38,"date_range"),c()()(),s(39,"div")(40,"mat-form-field",10)(41,"mat-label"),d(42,"Category"),c(),s(43,"mat-select",13),F("ngModelChange",function(l){return a.onCategoryChange(l)}),s(44,"mat-option",15),d(45,"All Categories"),c(),Ge(46,UU,2,2,"mat-option",14,FU),c(),s(48,"mat-icon",12),d(49,"category"),c()()(),s(50,"div")(51,"mat-form-field",10)(52,"mat-label"),d(53,"Type"),c(),s(54,"mat-select",13),F("ngModelChange",function(l){return a.onTypeChange(l)}),s(55,"mat-option",15),d(56,"All Types"),c(),s(57,"mat-option",16),d(58,"Income"),c(),s(59,"mat-option",17),d(60,"Expense"),c()(),s(61,"mat-icon",12),d(62,"account_balance_wallet"),c()()()()()),r&2&&(u(6),ne(" ",a.selectedYear," Transactions "),u(3),L(a.filteredCount),u(),P("ngIf",a.hasActiveFilters()),u(6),P("ngModel",a.searchTerm),u(7),P("ngModel",a.selectedYear),u(),He(a.availableYears),u(8),P("ngModel",a.selectedMonthOption),u(3),He(a.months),u(8),P("ngModel",a.selectedCategory),u(3),He(a.categories),u(8),P("ngModel",a.selectedType))},dependencies:[dt,Nt,At,Jn,Qe,Oi,Lr,$a,wi,yi,da,Nx,Bx]});let e=i;return e})();var jU=["tableSort"];function $U(e,i){if(e&1){let n=ue();s(0,"mobile-transaction-list",2),F("editTransaction",function(r){R(n);let a=v();return B(a.editTransaction(r))})("deleteTransaction",function(r){R(n);let a=v();return B(a.deleteTransaction(r))})("addTransaction",function(){R(n);let r=v();return B(r.addTransactionDialog())})("importTransactions",function(){R(n);let r=v();return B(r.openImportDialog())}),c()}}function YU(e,i){if(e&1){let n=ue();s(0,"div",0)(1,"div",3),re(2,"calendar-view"),c(),s(3,"div",4)(4,"search-filter",5),F("addTransaction",function(){R(n);let r=v();return B(r.addTransactionDialog())})("importTransactions",function(){R(n);let r=v();return B(r.openImportDialog())})("openFilterDialog",function(){R(n);let r=v();return B(r.openFilterDialog())})("viewAnalytics",function(){R(n);let r=v();return B(r.viewAnalytics())})("expandTable",function(){R(n);let r=v();return B(r.expandTable())}),c(),s(5,"transaction-table",6),F("editTransaction",function(r){R(n);let a=v();return B(a.editTransaction(r))})("deleteTransaction",function(r){R(n);let a=v();return B(a.deleteTransaction(r))})("startRowEdit",function(r){R(n);let a=v();return B(a.startRowEdit(r))})("saveRowEdit",function(r){R(n);let a=v();return B(a.saveRowEdit(r))})("cancelRowEdit",function(r){R(n);let a=v();return B(a.cancelRowEdit(r))})("addTransaction",function(){R(n);let r=v();return B(r.addTransactionDialog())})("bulkDeleteTransactions",function(r){R(n);let a=v();return B(a.bulkDeleteTransactions(r))})("bulkUpdateCategory",function(r){R(n);let a=v();return B(a.bulkUpdateCategory(r))}),c()()()}if(e&2){let n=v();u(5),P("isHome",n.isHome)}}function WU(e,i){e&1&&(s(0,"div",12)(1,"mat-icon",13),d(2,"compare_arrows"),c(),s(3,"span",14),d(4,"Transactions"),c()())}function GU(e,i){if(e&1){let n=ue();s(0,"div",10)(1,"search-filter",5),F("addTransaction",function(){R(n);let r=v(2);return B(r.addTransactionDialog())})("importTransactions",function(){R(n);let r=v(2);return B(r.openImportDialog())})("openFilterDialog",function(){R(n);let r=v(2);return B(r.openFilterDialog())})("viewAnalytics",function(){R(n);let r=v(2);return B(r.viewAnalytics())})("expandTable",function(){R(n);let r=v(2);return B(r.expandTable())}),c(),s(2,"transaction-table",6),F("editTransaction",function(r){R(n);let a=v(2);return B(a.editTransaction(r))})("deleteTransaction",function(r){R(n);let a=v(2);return B(a.deleteTransaction(r))})("startRowEdit",function(r){R(n);let a=v(2);return B(a.startRowEdit(r))})("saveRowEdit",function(r){R(n);let a=v(2);return B(a.saveRowEdit(r))})("cancelRowEdit",function(r){R(n);let a=v(2);return B(a.cancelRowEdit(r))})("addTransaction",function(){R(n);let r=v(2);return B(r.addTransactionDialog())})("bulkDeleteTransactions",function(r){R(n);let a=v(2);return B(a.bulkDeleteTransactions(r))})("bulkUpdateCategory",function(r){R(n);let a=v(2);return B(a.bulkUpdateCategory(r))}),c()()}if(e&2){let n=v(2);u(2),P("isHome",n.isHome)}}function HU(e,i){e&1&&(s(0,"div",12)(1,"mat-icon",13),d(2,"attach_money"),c(),s(3,"span",14),d(4,"Accounts"),c()())}function qU(e,i){e&1&&(s(0,"div",11),re(1,"user-accounts"),c())}function XU(e,i){e&1&&(s(0,"div",12)(1,"mat-icon",13),d(2,"local_offer"),c(),s(3,"span",14),d(4,"Categories"),c()())}function KU(e,i){e&1&&(s(0,"div",11),re(1,"user-category",15),c()),e&2&&(u(),P("isChildView",!0))}function ZU(e,i){e&1&&(s(0,"div",12)(1,"mat-icon",13),d(2,"analytics"),c(),s(3,"span",14),d(4,"Reports"),c()())}function QU(e,i){e&1&&re(0,"app-reports")}function JU(e,i){e&1&&(s(0,"div",12)(1,"mat-icon",13),d(2,"receipt_long"),c(),s(3,"span",14),d(4,"Tax"),c()())}function ez(e,i){e&1&&re(0,"app-tax")}function tz(e,i){e&1&&(s(0,"div",12)(1,"mat-icon",16),d(2,"note"),c(),s(3,"span",14),d(4,"Notes"),c()())}function nz(e,i){e&1&&re(0,"app-notes")}function iz(e,i){if(e&1){let n=ue();s(0,"mat-card",1)(1,"mat-tab-group",7),lt("selectedIndexChange",function(r){R(n);let a=v();return ct(a.selectedTabIndex,r)||(a.selectedTabIndex=r),B(r)}),s(2,"mat-tab",8),N(3,WU,5,0,"ng-template",9)(4,GU,3,1,"div",10),c(),s(5,"mat-tab"),N(6,HU,5,0,"ng-template",9)(7,qU,2,0,"div",11),c(),s(8,"mat-tab"),N(9,XU,5,0,"ng-template",9)(10,KU,2,1,"div",11),c(),s(11,"mat-tab"),N(12,ZU,5,0,"ng-template",9)(13,QU,1,0,"app-reports"),c(),s(14,"mat-tab"),N(15,JU,5,0,"ng-template",9)(16,ez,1,0,"app-tax"),c(),s(17,"mat-tab"),N(18,tz,5,0,"ng-template",9)(19,nz,1,0,"app-notes"),c()()()}if(e&2){let n=v();u(),st("selectedIndex",n.selectedTabIndex),u(3),we(n.selectedTabIndex===0?4:-1),u(3),we(n.selectedTabIndex===1?7:-1),u(3),we(n.selectedTabIndex===2?10:-1),u(3),we(n.selectedTabIndex===3?13:-1),u(3),we(n.selectedTabIndex===4?16:-1),u(3),we(n.selectedTabIndex===4?19:-1)}}var qy=(()=>{let i=class i{constructor(t,r,a,o,l,m,g,f,h,x){this.loaderService=t,this._dialog=r,this.auth=a,this.notificationService=o,this.filterService=l,this.store=m,this.dateService=g,this.breakpointService=f,this.router=h,this.transactionsService=x,this.isHome=!1,this.dataSource=new Ll,this.displayedColumns=["Payee","Amount","Status","Type","Date","Actions"],this.pageSizeOptions=[...Ut.PAGINATION.PAGE_SIZE_OPTIONS],this.selectedTx=null,this.selectedTabIndex=0,this.showFullTable=!1,this.isTransactionsPage=!1,this.isTransactionsPage=!!this.router.url.includes("transactions"),this.transactions$=this.store.select(Gn),this.transactionsLoading$=this.store.select(la),this.transactionsError$=this.store.select(ox)}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}ngOnInit(){this.loadTransactions(),this.subscribeToStoreData()}ngOnDestroy(){}loadTransactions(){var r;this.loaderService.show();let t=(r=this.auth.currentUser)==null?void 0:r.uid;t&&(this.store.dispatch(li({userId:t})),this.store.dispatch(Xi({userId:t})))}subscribeToStoreData(){this.transactions$.subscribe(t=>{this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.loaderService.hide()}),this.transactionsError$.subscribe(t=>{t&&(console.error("Error loading transactions:",t),this.notificationService.error("Failed to load transactions"),this.loaderService.hide())})}editTransaction(t){this._dialog.open(Es,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog",data:t}).afterClosed().subscribe(a=>{a&&this.loadTransactions()})}deleteTransaction(t){return me(this,null,function*(){var a;let r=(a=this.auth.currentUser)==null?void 0:a.uid;r&&t.id&&(this.store.dispatch(yc({userId:r,transactionId:t.id})),this.notificationService.success("Transaction deleted successfully"))})}onLongPress(t){this.selectedTx=t}startRowEdit(t){t.originalValues={payee:t.payee,amount:t.amount,type:t.type},t.isEditing=!0}saveRowEdit(t){var l;if(!t.payee||!t.payee.trim()){this.notificationService.error("Payee cannot be empty");return}let r=parseFloat(t.amount);if(!r||r<=0){this.notificationService.error("Amount must be a positive number");return}if(!t.type||t.type!=="income"&&t.type!=="expense"){this.notificationService.error("Please select a valid transaction type");return}let a={payee:t.payee.trim(),amount:r,type:t.type},o=(l=this.auth.currentUser)==null?void 0:l.uid;o&&t.id&&(this.store.dispatch(Wo({userId:o,transactionId:t.id,transaction:a})),this.notificationService.success("Transaction updated successfully"),t.isEditing=!1,delete t.originalValues)}cancelRowEdit(t){t.payee=t.originalValues.payee,t.amount=t.originalValues.amount,t.type=t.originalValues.type,t.isEditing=!1,delete t.originalValues}openImportDialog(){this._dialog.open(xl,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"import-transactions-dialog"}).afterClosed().subscribe(r=>{r&&r.length&&this.importTransactions(r)})}importTransactions(t){return me(this,null,function*(){var a;this.loaderService.show();let r=(a=this.auth.currentUser)==null?void 0:a.uid;if(!r){this.notificationService.error("User not authenticated"),this.loaderService.hide();return}try{let o=0,l=0;for(let m of t)try{let g=new Date(m.date);if(isNaN(g.getTime()))throw new Error("Invalid date format");let f={payee:m.payee,userId:r,accountId:m.accountId,amount:parseFloat(m.amount),type:m.type,category:(m==null?void 0:m.category)||"",categoryId:(m==null?void 0:m.categoryId)||"",date:g,notes:m.narration||"",isPending:!1,syncStatus:bi.PENDING,lastSyncedAt:new Date,createdAt:new Date,updatedAt:new Date,createdBy:r,updatedBy:r,status:Xo.COMPLETED};this.store.dispatch(Yo({userId:r,transaction:f})),o++}catch(g){console.error("Error importing transaction:",m,g),l++}this.loaderService.hide(),o>0&&(this.notificationService.success(`Successfully imported ${o} transactions`),this.store.dispatch(li({userId:r}))),l>0&&this.notificationService.warning(`${l} transactions failed to import`)}catch(o){this.loaderService.hide(),this.notificationService.error("Failed to import transactions"),console.error("Import error:",o)}})}exportToExcel(){if(!this.dataSource.data||this.dataSource.data.length===0){this.notificationService.error("No transactions to export");return}let t=this.dataSource.data.map(g=>{let f=this.dateService.toDate(g.date);return{Date:(0,oo.default)(f).format("MM/DD/YYYY"),Time:(0,oo.default)(f).format("hh:mm A"),Payee:g.payee,Amount:g.amount,Type:g.type,Category:g.category,Notes:g.notes||""}}),r=Object.keys(t[0]),a=[r.join(","),...t.map(g=>r.map(f=>`"${g[f]}"`).join(","))].join(`
`),o=new Blob([a],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),m=URL.createObjectURL(o);l.setAttribute("href",m),l.setAttribute("download",`transactions_${(0,oo.default)().format("YYYY-MM-DD")}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(m),this.notificationService.success(`Exported ${t.length} transactions successfully`)}getCurrentMonthTransactions(){let t=(0,oo.default)().month(),r=(0,oo.default)().year();return this.dataSource.data.filter(a=>{let o=this.dateService.toDate(a.date);if(!o)return!1;let l=(0,oo.default)(o);return l.month()===t&&l.year()===r}).length}getUniqueCategories(){return new Set(this.dataSource.data.map(r=>r.category)).size}getFilteredCount(){return this.dataSource.data.length}getTotalCount(){return this.dataSource.data.length}getCurrentYearCount(){let t=(0,oo.default)().year();return this.dataSource.data.filter(r=>{let a=this.dateService.toDate(r.date);return a?(0,oo.default)(a).year()===t:!1}).length}getCurrentYear(){return(0,oo.default)().year()}getCategoriesList(){let t=new Set(this.dataSource.data.map(r=>r.category));return Array.from(t).sort()}getTypesList(){return[Lt.INCOME,Lt.EXPENSE]}refreshTransactions(){var r;let t=(r=this.auth.currentUser)==null?void 0:r.uid;t&&(this.store.dispatch(li({userId:t})),this.notificationService.success("Transactions refreshed"))}openFilterDialog(){this.notificationService.success("Filter functionality coming soon")}viewAnalytics(){this.notificationService.success("Analytics view coming soon")}addTransactionDialog(){this._dialog.open(Es,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog"}).afterClosed().subscribe(t=>{var r;if(t){let a=(r=this.auth.currentUser)==null?void 0:r.uid;a&&this.store.dispatch(li({userId:a}))}})}expandTable(){this.showFullTable=!this.showFullTable}clearAllFilters(){this.filterService.clearAllFilters()}getActiveFiltersCount(){return this.filterService.getActiveFiltersCount()}hasActiveFilters(){return this.filterService.hasActiveFilters()}getCurrentFilterState(){return this.filterService.getCurrentFilterState()}bulkDeleteTransactions(t){return me(this,null,function*(){var a;if(!t||t.length===0)return;this.loaderService.show();let r=(a=this.auth.currentUser)==null?void 0:a.uid;if(!r){this.notificationService.error("User not authenticated"),this.loaderService.hide();return}try{for(let o of t)yield this.transactionsService.deleteTransaction(r,o.id).toPromise();this.notificationService.success(`Successfully deleted ${t.length} transaction(s)`)}catch(o){console.error("Error deleting transactions:",o),this.notificationService.error("Failed to delete some transactions")}finally{this.loaderService.hide()}})}bulkUpdateCategory(t){return me(this,null,function*(){var l;let{transactions:r,categoryId:a}=t;if(!r||r.length===0||!a)return;this.loaderService.show();let o=(l=this.auth.currentUser)==null?void 0:l.uid;if(!o){this.notificationService.error("User not authenticated"),this.loaderService.hide();return}try{for(let m of r){let g={categoryId:a};yield this.transactionsService.updateTransaction(o,m.id,g).toPromise()}this.notificationService.success(`Successfully updated category for ${r.length} transaction(s)`)}catch(m){console.error("Error updating transactions:",m),this.notificationService.error("Failed to update some transactions")}finally{this.loaderService.hide()}})}};i.\u0275fac=function(r){return new(r||i)(Y(Ac),Y(xn),Y(xt),Y(ft),Y(Qa),Y(pt),Y(Vt),Y(gr),Y(nn),Y(Ka))},i.\u0275cmp=Re({type:i,selectors:[["transaction-list"]],viewQuery:function(r,a){if(r&1&&(ar(Px,5),ar(jU,5)),r&2){let o;Ni(o=Li())&&(a.paginator=o.first),Ni(o=Li())&&(a.sort=o.first)}},inputs:{isHome:"isHome"},decls:3,vars:1,consts:[[1,"grid","grid-cols-12","gap-2"],[1,"p-2","shadow-lg","border-0","rounded-xl","transaction-list-container"],[3,"editTransaction","deleteTransaction","addTransaction","importTransactions"],[1,"col-span-3"],[1,"col-span-9"],[3,"addTransaction","importTransactions","openFilterDialog","viewAnalytics","expandTable"],[3,"editTransaction","deleteTransaction","startRowEdit","saveRowEdit","cancelRowEdit","addTransaction","bulkDeleteTransactions","bulkUpdateCategory","isHome"],["mat-stretch-tabs","false","mat-align-tabs","start",1,"custom-tabs",3,"selectedIndexChange","selectedIndex"],[1,"max-h-full"],["mat-tab-label",""],[1,"p-2","overflow-hidden"],[1,"p-6"],[1,"flex","items-center","space-x-2","px-4","py-2"],[1,"text-primary"],[1,"font-semibold","text-gray-700","text-xs"],[3,"isChildView"],[1,"text-yellow-600"]],template:function(r,a){r&1&&N(0,$U,1,0,"mobile-transaction-list")(1,YU,6,1,"div",0)(2,iz,20,7,"mat-card",1),r&2&&we(a.breakpointService.device.isMobile||a.breakpointService.device.isTablePortrait&&a.isTransactionsPage?0:!a.isHome&&!a.breakpointService.device.isMobile&&!a.breakpointService.device.isTablePortrait?1:2)},dependencies:[ji,Qe,xx,Dc,Fc,rg,Zm,tg,ag,Ug,zg,Yy,Gy,Hy],styles:[".hide-scrollbar[_ngcontent-%COMP%]{-ms-overflow-style:none;scrollbar-width:none;overflow:-moz-scrollbars-none;-webkit-overflow-scrolling:touch}.hide-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.custom-tabs[_ngcontent-%COMP%]   .mat-mdc-tab-group[_ngcontent-%COMP%]   .mat-mdc-tab-header[_ngcontent-%COMP%]{border-bottom:2px solid #e5e7eb}.custom-tabs[_ngcontent-%COMP%]   .mat-mdc-tab-group[_ngcontent-%COMP%]   .mat-mdc-tab-header[_ngcontent-%COMP%]   .mat-mdc-tab-label-container[_ngcontent-%COMP%]   .mat-mdc-tab-label[_ngcontent-%COMP%]{min-width:120px;padding:0}.custom-tabs[_ngcontent-%COMP%]   .mat-mdc-tab-group[_ngcontent-%COMP%]   .mat-mdc-tab-header[_ngcontent-%COMP%]   .mat-mdc-tab-label-container[_ngcontent-%COMP%]   .mat-mdc-tab-label.mat-mdc-tab-label-active[_ngcontent-%COMP%]{background-color:#f3f4f6;border-radius:8px 8px 0 0}.mat-mdc-table[_ngcontent-%COMP%]{background-color:#fff}.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#374151;background-color:#fff;border-bottom:2px solid #e5e7eb;position:sticky;top:0;z-index:10}.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{padding:16px 24px;border-bottom:1px solid #f3f4f6}.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]{transition:all .2s ease}.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:inherit;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.table-container[_ngcontent-%COMP%]{height:100%;overflow:auto}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.transaction-list-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.transaction-list-container[_ngcontent-%COMP%]   .mat-mdc-tab-body-content[_ngcontent-%COMP%]{height:calc(100vh - 200px);overflow:hidden}.mat-mdc-card[_ngcontent-%COMP%]{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f!important;border-radius:16px!important;border:none!important}.mat-mdc-raised-button[_ngcontent-%COMP%]{border-radius:8px!important;font-weight:500!important;text-transform:none!important;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f!important}.mat-mdc-raised-button[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f!important}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{transition:all .2s ease}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{transform:translateY(-1px);box-shadow:0 4px 12px #3b82f626}.status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 12px;border-radius:20px;font-size:12px;font-weight:500;text-transform:capitalize}.status-badge.income[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.status-badge.expense[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b}.mat-mdc-row.editing[_ngcontent-%COMP%]{background-color:#eff6ff;border-left:4px solid #3b82f6}@media (max-width: 768px){.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{padding:12px 16px}}"]});let e=i;return e})();var rz=(e,i)=>i.title,az=(e,i)=>i.step;function oz(e,i){if(e&1&&(s(0,"div",46)(1,"div",87)(2,"mat-icon"),d(3),c()(),s(4,"h3",88),d(5),c(),s(6,"p",89),d(7),c()()),e&2){let n=i.$implicit;u(3),L(n.icon),u(2),L(n.title),u(2),L(n.description)}}function sz(e,i){if(e&1&&(s(0,"div",53)(1,"div",90),d(2),c(),s(3,"div",91)(4,"mat-icon"),d(5),c()(),s(6,"h3",92),d(7),c(),s(8,"p",93),d(9),c()()),e&2){let n=i.$implicit;u(2),ne(" ",n.step," "),u(3),L(n.icon),u(2),L(n.title),u(2),L(n.description)}}var Xy=(()=>{let i=class i{constructor(t,r){this.router=t,this.notificationService=r,this.features=[{icon:"account_balance",title:"Connect Bank",description:"Securely connect your bank accounts for automatic transaction tracking and real-time balance updates."},{icon:"pie_chart",title:"Smart Budgeting",description:"Create and manage budgets with intelligent spending alerts to keep you on track."},{icon:"category",title:"Sub Category",description:"Create and manage sub categories to track your spending."},{icon:"trending_up",title:"Real-Time Insights",description:"Get instant financial insights and trends with beautiful charts and analytics."},{icon:"flag",title:"Goal Tracking",description:"Set savings goals and track your progress with visual milestones."},{icon:"wifi_off",title:"Offline Access",description:"Access your data anytime, even without an internet connection."},{icon:"currency_exchange",title:"Multiple Currency Support",description:"Manage your finances in multiple currencies with ease."},{icon:"devices",title:"PWA - Multi-Platform Support",description:"Access your data on multiple devices web, android and ios"},{icon:"security",title:"Secure & Private",description:"Your financial data is protected with industry-standard security measures."},{icon:"cloud",title:"Cloud Sync",description:"Sync your data across all your devices with ease."}],this.howItWorks=[{step:"1",title:"Download & Sign Up",description:"Get the app from App Store or Play Store and create your account in seconds.",icon:"smartphone"},{step:"2",title:"Set Your Goals",description:"Define your financial goals and create personalized budgets.",icon:"flag"},{step:"3",title:"Track & Grow",description:"Monitor your progress and watch your savings grow with smart insights.",icon:"trending_up"}],this.testimonials=[{name:"Sarah Johnson",role:"Freelance Designer",content:"Money Manager helped me save $5,000 in just 6 months! The goal tracking feature is incredible.",avatar:"\u{1F469}\u200D\u{1F3A8}",rating:5,location:"San Francisco, CA"},{name:"Mike Chen",role:"Software Engineer",content:"Finally, a finance app that actually works offline and syncs perfectly across all my devices.",avatar:"\u{1F468}\u200D\u{1F4BB}",rating:5,location:"Seattle, WA"},{name:"Emma Davis",role:"Small Business Owner",content:"The real-time insights helped me identify spending patterns I never noticed before. Game changer!",avatar:"\u{1F469}\u200D\u{1F4BC}",rating:5,location:"Austin, TX"}],this.screenshots=[{title:"Dashboard Overview",description:"Get a complete view of your finances at a glance",image:"assets/images/screenshot/dashboard.png"},{title:"Smart Analytics",description:"Beautiful charts and insights to understand your spending",image:"assets/images/screenshot/analytics.png"},{title:"Goal Tracking",description:"Set and track your financial goals with visual progress",image:"assets/images/screenshot/goals.png"}],this.currentScreenshotIndex=0}ngOnInit(){}navigateToSignUp(){this.router.navigate(["/sign-in"])}navigateToSignIn(){this.router.navigate(["/sign-in"])}scrollToFeatures(){let t=document.getElementById("features");t&&t.scrollIntoView({behavior:"smooth"})}nextScreenshot(){this.currentScreenshotIndex=(this.currentScreenshotIndex+1)%this.screenshots.length}prevScreenshot(){this.currentScreenshotIndex=this.currentScreenshotIndex===0?this.screenshots.length-1:this.currentScreenshotIndex-1}setScreenshotIndex(t){this.currentScreenshotIndex=t}downloadAppStore(){this.notificationService.info("App Store link coming soon!")}downloadPlayStore(){this.notificationService.info("Play Store link coming soon!")}installPwa(){return me(this,null,function*(){this.notificationService.info("PWA installation will be triggered automatically when available.")})}onPwaInstallClicked(){console.log("PWA install clicked from prompt component"),this.notificationService.success("Installing Money Manager...")}onPwaInstallDismissed(){console.log("PWA install dismissed from prompt component"),this.notificationService.info("Installation cancelled")}};i.\u0275fac=function(r){return new(r||i)(Y(nn),Y(ft))},i.\u0275cmp=Re({type:i,selectors:[["app-landing"]],decls:160,vars:0,consts:[[1,"hero-section","min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-primary-50","via-white","to-primary-100","relative","overflow-hidden"],[1,"absolute","inset-0","overflow-hidden"],[1,"absolute","-top-40","-right-40","w-80","h-80","bg-primary/20","rounded-full","mix-blend-multiply","filter","blur-xl","opacity-70","animate-blob"],[1,"absolute","-bottom-40","-left-40","w-80","h-80","bg-primary/30","rounded-full","mix-blend-multiply","filter","blur-xl","opacity-70","animate-blob","animation-delay-2000"],[1,"absolute","top-40","left-40","w-80","h-80","bg-primary/25","rounded-full","mix-blend-multiply","filter","blur-xl","opacity-70","animate-blob","animation-delay-4000"],[1,"container","mx-auto","px-4","relative","z-10"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8","lg:gap-12","items-center"],[1,"text-center","lg:text-left"],[1,"mb-6"],[1,"text-3xl","sm:text-4xl","lg:text-5xl","xl:text-6xl","font-bold","text-gray-900","mb-4","leading-tight"],[1,"bg-gradient-to-r","from-primary","to-primary-600","bg-clip-text","text-transparent","block"],[1,"text-base","sm:text-lg","lg:text-xl","text-gray-600","mb-6","max-w-lg","mx-auto","lg:mx-0"],[1,"flex","flex-col","sm:flex-row","gap-3","justify-center","lg:justify-start","mb-8"],[1,"flex","items-center","justify-center","gap-3","px-8","py-4","bg-gradient-to-r","from-primary","to-primary-600","text-white","font-semibold","rounded-xl","shadow-lg","hover:shadow-xl","transition-all","duration-300","transform","hover:-translate-y-1",3,"click"],[1,"!text-[1.5rem]"],[1,"text-lg"],[1,"flex","justify-center","lg:justify-end"],[1,"relative"],[1,"w-56","h-[450px]","sm:w-64","sm:h-[500px]","lg:w-72","lg:h-[560px]","bg-gray-900","rounded-[2.5rem]","p-2","shadow-2xl"],[1,"w-full","h-full","bg-white","rounded-[2rem]","overflow-hidden"],[1,"h-5","bg-gradient-to-r","from-primary","to-primary-600","flex","items-center","justify-between","px-3","text-white","text-xs"],[1,"flex","items-center","gap-1"],[1,"w-3","h-1.5","bg-white/30","rounded-full"],[1,"p-3","h-full","bg-gradient-to-br","from-primary-50","to-primary-100"],[1,"text-center","mb-3"],[1,"w-10","h-10","rounded-lg","flex","items-center","justify-center","mx-auto","mb-2"],["src","assets/icon/app-icon/icon-192x192.png","alt","Money Manager",1,"w-10","h-10"],[1,"text-xs","font-semibold","text-gray-800"],[1,"space-y-2"],[1,"bg-white","rounded-lg","p-2","shadow-sm"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-xs","text-gray-600"],[1,"text-sm","font-bold","text-gray-800"],[1,"grid","grid-cols-2","gap-2"],[1,"text-xs","font-semibold","text-green-600"],[1,"text-xs","font-semibold","text-red-600"],[1,"text-xs","text-gray-600","mb-1"],[1,"w-full","bg-gray-200","rounded-full","h-1.5"],[1,"bg-gradient-to-r","from-primary","to-primary-600","h-1.5","rounded-full",2,"width","65%"],[1,"text-xs","text-gray-600","mt-1"],["id","features",1,"py-16","lg:py-20","bg-white"],[1,"container","mx-auto","px-4"],[1,"text-center","mb-12","lg:mb-16","flex","flex-col","items-center","justify-center"],[1,"text-2xl","sm:text-3xl","lg:text-4xl","font-bold","text-gray-900","mb-4"],[1,"text-base","sm:text-lg","text-gray-600","max-w-2xl","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6","lg:gap-8"],[1,"group","p-6","lg:p-8","rounded-2xl","border","border-gray-200","hover:border-primary","hover:shadow-xl","transition-all","duration-300","transform","hover:-translate-y-2","bg-gradient-to-br","from-white","to-primary-50/30","hover:from-primary-50/50","hover:to-white"],[1,"py-20","bg-gradient-to-br","from-primary-50","to-white"],[1,"container-responsive","px-4","sm:px-6","lg:px-8"],[1,"text-center","mb-16","flex","flex-col","items-center","justify-center"],[1,"text-3xl","sm:text-4xl","md:text-5xl","font-bold","text-gray-900","mb-6"],[1,"text-lg","sm:text-xl","text-gray-600","max-w-3xl","mx-auto","leading-relaxed"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-8"],[1,"text-center","group","relative"],[1,"py-20","bg-gradient-to-r","from-primary","via-primary-600","to-primary"],[1,"container","mx-auto","text-center","px-4","flex","flex-col","items-center","justify-center"],[1,"text-3xl","sm:text-4xl","md:text-5xl","font-bold","text-white","mb-6"],[1,"text-xl","text-primary-100","mb-8","mx-auto","leading-relaxed"],[1,"flex","flex-wrap","items-center","justify-center","gap-6","mb-8"],[1,"flex","items-center","gap-2"],[1,"w-6","h-6","bg-primary-400","rounded-full","flex","items-center","justify-center"],[1,"text-white","text-xs"],[1,"text-primary-100","text-sm"],[1,"flex","flex-col","sm:flex-row","gap-4","justify-center"],[1,"flex","items-center","justify-center","gap-3","px-8","py-4","bg-white","text-primary","font-semibold","rounded-xl","shadow-lg","hover:shadow-xl","transform","hover:-translate-y-1","transition-all","duration-300",3,"click"],[1,"text-xl"],[1,"text-lg","font-bold"],[1,"py-12","bg-gray-900","text-white"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-8","mb-8"],[1,"md:col-span-2"],[1,"flex","items-start","mb-4"],[1,"w-10","h-10","rounded-lg","flex","items-center","justify-center","mr-3","bg-gradient-to-r","from-primary","to-primary-600"],["src","assets/icon/app-icon/icon-192x192.png","alt","Money Manager",1,"w-6","h-6"],[1,"text-xl","font-bold"],[1,"text-sm","text-gray-400"],[1,"text-gray-400","mb-4","max-w-md","leading-relaxed"],[1,"font-semibold","mb-4","text-primary-400"],["href","#features",1,"text-gray-400","hover:text-primary-400","transition-colors","duration-300"],["routerLink","/privacy-policy",1,"text-gray-400","hover:text-primary-400","transition-colors","duration-300"],["routerLink","/terms-conditions",1,"text-gray-400","hover:text-primary-400","transition-colors","duration-300"],["href","#",1,"text-gray-400","hover:text-primary-400","transition-colors","duration-300"],[1,"border-t","border-gray-800","pt-6"],[1,"flex","flex-col","md:flex-row","justify-between","items-center","space-y-2","md:space-y-0"],[1,"text-gray-400","text-sm"],[1,"flex","items-center","space-x-4","text-sm","text-gray-400"],[1,"flex","items-center"],[1,"text-sm","mr-1"],[1,"text-3xl","lg:text-4xl","mb-4","group-hover:scale-110","transition-transform","duration-300","text-primary"],[1,"text-lg","lg:text-xl","font-semibold","text-gray-900","mb-3","group-hover:text-primary","transition-colors","duration-300"],[1,"text-sm","lg:text-base","text-gray-600","leading-relaxed"],[1,"w-16","h-16","bg-gradient-to-r","from-primary","to-primary-600","text-white","rounded-full","flex","items-center","justify-center","text-2xl","font-bold","mx-auto","mb-6","shadow-lg","group-hover:shadow-xl","transition-shadow","duration-300"],[1,"text-3xl","mb-4","group-hover:scale-110","transition-transform","duration-300","text-primary"],[1,"text-xl","font-semibold","text-gray-900","mb-4","group-hover:text-primary","transition-colors","duration-300"],[1,"text-gray-600","leading-relaxed"]],template:function(r,a){r&1&&(s(0,"section",0)(1,"div",1),re(2,"div",2)(3,"div",3)(4,"div",4),c(),s(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"h1",9),d(10," Simple "),s(11,"span",10),d(12,"Money Management"),c()(),s(13,"p",11),d(14," Track your expenses, manage budgets, and keep your finances organized. "),c()(),s(15,"div",12)(16,"button",13),F("click",function(){return a.navigateToSignUp()}),s(17,"mat-icon",14),d(18,"person_add"),c(),s(19,"span",15),d(20,"Get Started Free"),c()()()(),s(21,"div",16)(22,"div",17)(23,"div",18)(24,"div",19)(25,"div",20)(26,"span"),d(27,"9:41"),c(),s(28,"div",21),re(29,"div",22),s(30,"span"),d(31,"\u{1F4F6}"),c(),s(32,"span"),d(33,"\u{1F50B}"),c()()(),s(34,"div",23)(35,"div",24)(36,"div",25),re(37,"img",26),c(),s(38,"h3",27),d(39,"Money Manager"),c()(),s(40,"div",28)(41,"div",29)(42,"div",30)(43,"span",31),d(44,"Total Balance"),c()(),s(45,"div",32),d(46,"\u20B92,450.00"),c()(),s(47,"div",33)(48,"div",29)(49,"div",31),d(50,"Income"),c(),s(51,"div",34),d(52,"\u20B93,200"),c()(),s(53,"div",29)(54,"div",31),d(55,"Expenses"),c(),s(56,"div",35),d(57,"\u20B91,850"),c()()(),s(58,"div",29)(59,"div",36),d(60,"Monthly Budget"),c(),s(61,"div",37),re(62,"div",38),c(),s(63,"div",39),d(64,"65% used"),c()()()()()()()()()()(),s(65,"section",40)(66,"div",41)(67,"div",42)(68,"h2",43),d(69," What You Can Do "),c(),s(70,"p",44),d(71," Essential tools to help you manage your money better. "),c()(),s(72,"div",45),Ge(73,oz,8,3,"div",46,rz),c()()(),s(75,"section",47)(76,"div",48)(77,"div",49)(78,"h2",50),d(79," Getting Started "),c(),s(80,"p",51),d(81," Simple steps to start managing your money "),c()(),s(82,"div",52),Ge(83,sz,10,4,"div",53,az),c()()(),s(85,"section",54)(86,"div",55)(87,"h2",56),d(88," Ready to Get Started? "),c(),s(89,"p",57),d(90," Join thousands of users who are already managing their money smarter. "),c(),s(91,"div",58)(92,"div",59)(93,"div",60)(94,"span",61),d(95,"\u2713"),c()(),s(96,"span",62),d(97,"Free to use"),c()(),s(98,"div",59)(99,"div",60)(100,"span",61),d(101,"\u2713"),c()(),s(102,"span",62),d(103,"Works offline"),c()(),s(104,"div",59)(105,"div",60)(106,"span",61),d(107,"\u2713"),c()(),s(108,"span",62),d(109,"No ads"),c()()(),s(110,"div",63)(111,"button",64),F("click",function(){return a.navigateToSignUp()}),s(112,"mat-icon",65),d(113,"person_add"),c(),s(114,"span",66),d(115,"Get Started Free"),c()()()()(),s(116,"footer",67)(117,"div",41)(118,"div",68)(119,"div",69)(120,"div",70)(121,"div",71),re(122,"img",72),c(),s(123,"div")(124,"h3",73),d(125,"Money Manager"),c(),s(126,"p",74),d(127,"Simple Money Management"),c()()(),s(128,"p",75),d(129," Track expenses, manage budgets, and organize your finances with ease. "),c()(),s(130,"div")(131,"h4",76),d(132,"Quick Links"),c(),s(133,"ul",28)(134,"li")(135,"a",77),d(136,"Features"),c()(),s(137,"li")(138,"a",78),d(139,"Privacy Policy"),c()(),s(140,"li")(141,"a",79),d(142,"Terms of Service"),c()(),s(143,"li")(144,"a",80),d(145,"Contact"),c()()()()(),s(146,"div",81)(147,"div",82)(148,"div",83)(149,"p"),d(150,"\xA9 2024 Money Manager. All rights reserved."),c()(),s(151,"div",84)(152,"span",85)(153,"mat-icon",86),d(154,"security"),c(),d(155," Secure "),c(),s(156,"span",85)(157,"mat-icon",86),d(158,"cloud_done"),c(),d(159," Cloud Sync "),c()()()()()()),r&2&&(u(73),He(a.features),u(10),He(a.howItWorks))},dependencies:[s0,Qe],styles:['[_ngcontent-%COMP%]:root{--primary: #46777f;--primary-50: #f0f4f5;--primary-100: #e1e9eb;--primary-200: #c3d3d7;--primary-300: #a5bdc3;--primary-400: #87a7af;--primary-500: #46777f;--primary-600: #3a636a;--primary-700: #2e4f55;--primary-800: #223b40;--primary-900: #16272b}@keyframes _ngcontent-%COMP%_blob{0%{transform:translate(0) scale(1)}33%{transform:translate(30px,-50px) scale(1.1)}66%{transform:translate(-20px,20px) scale(.9)}to{transform:translate(0) scale(1)}}.animate-blob[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_blob 7s infinite}.animation-delay-2000[_ngcontent-%COMP%]{animation-delay:2s}.animation-delay-4000[_ngcontent-%COMP%]{animation-delay:4s}.animation-delay-1000[_ngcontent-%COMP%]{animation-delay:1s}.hero-section[_ngcontent-%COMP%]{position:relative}.hero-section[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 20% 80%,rgba(70,119,127,.3) 0%,transparent 50%),radial-gradient(circle at 80% 20%,rgba(70,119,127,.3) 0%,transparent 50%),radial-gradient(circle at 40% 40%,rgba(70,119,127,.2) 0%,transparent 50%);pointer-events:none}html[_ngcontent-%COMP%]{scroll-behavior:smooth}.feature-card[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1)}.feature-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#46777f,#3a636a);transition:all .3s ease}.btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#3a636a,#2e4f55);transform:translateY(-2px);box-shadow:0 10px 20px #46777f66}.testimonial-card[_ngcontent-%COMP%]{transition:all .3s ease}.testimonial-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 10px 25px #0000001a}.phone-mockup[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_float 6s ease-in-out infinite}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0)}50%{transform:translateY(-20px)}}.floating-element[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_float-slow 8s ease-in-out infinite}@keyframes _ngcontent-%COMP%_float-slow{0%,to{transform:translateY(0) rotate(0)}50%{transform:translateY(-15px) rotate(5deg)}}.screenshot-carousel[_ngcontent-%COMP%]{transition:all .5s cubic-bezier(.4,0,.2,1)}.gradient-text[_ngcontent-%COMP%]{background:linear-gradient(135deg,#46777f,#3a636a);background-size:200% 200%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;animation:_ngcontent-%COMP%_gradient-shift 3s ease infinite}@keyframes _ngcontent-%COMP%_gradient-shift{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}.stat-number[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_count-up 2s ease-out}@keyframes _ngcontent-%COMP%_count-up{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}section[_ngcontent-%COMP%]{opacity:0;transform:translateY(30px);animation:_ngcontent-%COMP%_fade-in-up .8s ease-out forwards}@keyframes _ngcontent-%COMP%_fade-in-up{to{opacity:1;transform:translateY(0)}}.feature-card[_ngcontent-%COMP%]{animation-delay:calc(var(--animation-order) * .1s)}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#46777f,#3a636a);border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,#3a636a,#2e4f55)}button[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:focus{outline:2px solid #46777f;outline-offset:2px}.trust-badge[_ngcontent-%COMP%]{transition:all .3s ease}.trust-badge[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.download-btn[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1)}.download-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px) scale(1.02);box-shadow:0 10px 25px #0003}.connection-line[_ngcontent-%COMP%]{position:relative}.connection-line[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:100%;width:100%;height:2px;background:linear-gradient(90deg,#46777f,#3a636a);transform:translateY(-50%);z-index:-1}.rating-stars[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_star-glow 2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_star-glow{0%{filter:brightness(1)}to{filter:brightness(1.2)}}.carousel-dot[_ngcontent-%COMP%]{transition:all .3s ease}.carousel-dot[_ngcontent-%COMP%]:hover{transform:scale(1.2)}.carousel-dot.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#46777f,#3a636a)}.container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;width:100%}@media (max-width: 640px){.container[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}button[_ngcontent-%COMP%]{min-height:44px}}@media (min-width: 641px){.container[_ngcontent-%COMP%]{padding-left:2rem;padding-right:2rem}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}.install-btn[_ngcontent-%COMP%]{background-color:#fff;border-radius:16px;padding:5px;width:60px;height:59px}mat-icon[_ngcontent-%COMP%]{font-size:inherit;width:inherit;height:inherit;line-height:inherit}.group[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;line-height:3rem}.text-3xl[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2rem;width:2rem;height:2rem;line-height:2rem}.text-lg[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem;line-height:1.25rem}.text-lg[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem;line-height:1.125rem}']});let e=i;return e})();var Ky=(()=>{let i=class i{constructor(t,r,a){this.firestore=t,this.auth=r,this.dateService=a}createSubscription(t,r){return me(this,null,function*(){let a=Dt(this.firestore,`users/${t}/subscription`);yield Rr(a,le(oe({},r),{startDate:this.dateService.toTimestamp(r.startDate),endDate:this.dateService.toTimestamp(r.endDate)}))})}getSubscription(t){return me(this,null,function*(){let r=Dt(this.firestore,`users/${t}/subscription`),a=yield di(r);if(a.exists())return a.data()})}updateSubscriptionPlan(t,r){return me(this,null,function*(){let a=Dt(this.firestore,`users/${t}/subscription`);yield Fn(a,{plan:r})})}updateSubscriptionDates(t,r,a){return me(this,null,function*(){let o=Dt(this.firestore,`users/${t}/subscription`);yield Fn(o,{startDate:ei.fromDate(r),endDate:ei.fromDate(a)})})}deleteSubscription(t){return me(this,null,function*(){let r=Dt(this.firestore,`users/${t}/subscription`);yield zi(r)})}};i.\u0275fac=function(r){return new(r||i)(De(cr),De(xt),De(Vt))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();function lz(e,i){if(e&1){let n=ue();s(0,"div")(1,"p"),d(2),c(),s(3,"p"),d(4),ce(5,"date"),c(),s(6,"p"),d(7),ce(8,"date"),c(),s(9,"button",2),F("click",function(){R(n);let r=v();return B(r.updatePlan("premium"))}),d(10,"Upgrade to Premium"),c(),s(11,"button",2),F("click",function(){R(n);let r=v();return B(r.deleteSubscription())}),d(12,"Cancel Subscription"),c()()}if(e&2){let n=v();u(2),ne("Plan: ",n.subscription.plan,""),u(2),ne("Start Date: ",ht(5,3,n.dateService.toDate(n.subscription.startDate),"short"),""),u(3),ne("End Date: ",ht(8,6,n.dateService.toDate(n.subscription.endDate),"short"),"")}}function dz(e,i){if(e&1){let n=ue();s(0,"form",3),F("submit",function(){R(n);let r=v();return B(r.createSubscription())}),s(1,"label",4),d(2,"Plan:"),c(),s(3,"select",5),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.newSubscription.plan,r)||(a.newSubscription.plan=r),B(r)}),s(4,"option",6),d(5,"Free"),c(),s(6,"option",7),d(7,"Premium"),c()(),s(8,"label",8),d(9,"Start Date:"),c(),s(10,"input",9),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.newSubscription.startDate,r)||(a.newSubscription.startDate=r),B(r)}),c(),s(11,"label",10),d(12,"End Date:"),c(),s(13,"input",11),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.newSubscription.endDate,r)||(a.newSubscription.endDate=r),B(r)}),c(),s(14,"button",12),d(15,"Start Subscription"),c()()}if(e&2){let n=v();u(3),st("ngModel",n.newSubscription.plan),u(7),st("ngModel",n.newSubscription.startDate),u(3),st("ngModel",n.newSubscription.endDate)}}var Zy=(()=>{let i=class i{constructor(t,r,a,o,l){this.subscriptionService=t,this.auth=r,this.router=a,this.notificationService=o,this.dateService=l,this.userId="",this.newSubscription={userId:"",plan:"free",startDate:ei.fromDate(new Date),endDate:ei.fromDate(new Date)}}ngOnInit(){this.loadSubscription()}loadSubscription(){return me(this,null,function*(){let t=this.auth.currentUser;if(t)try{this.userId=t.uid,this.subscription=yield this.subscriptionService.getSubscription(this.userId)}catch(r){console.error("Error loading subscription:",r),this.notificationService.error("Failed to load subscription data")}else this.notificationService.error("User not authenticated")})}createSubscription(){return me(this,null,function*(){if(!this.newSubscription.plan){this.notificationService.warning("Please select a subscription plan");return}let t=this.auth.currentUser;if(t)try{this.newSubscription.userId=t.uid,yield this.subscriptionService.createSubscription(t.uid,this.newSubscription),this.notificationService.success("Subscription created successfully"),this.loadSubscription(),this.newSubscription={userId:"",plan:"free",startDate:ei.fromDate(new Date),endDate:ei.fromDate(new Date)}}catch(r){console.error("Error creating subscription:",r),this.notificationService.error("Failed to create subscription")}else this.notificationService.error("User not authenticated")})}updatePlan(t){return me(this,null,function*(){if(!t){this.notificationService.warning("Please select a valid plan");return}let r=this.auth.currentUser;if(r)try{yield this.subscriptionService.updateSubscriptionPlan(r.uid,t),this.notificationService.success(`Subscription plan updated to ${t}`),this.loadSubscription()}catch(a){console.error("Error updating subscription plan:",a),this.notificationService.error("Failed to update subscription plan")}else this.notificationService.error("User not authenticated")})}updateDates(t,r){return me(this,null,function*(){if(!t||!r){this.notificationService.warning("Please select valid start and end dates");return}if(t>=r){this.notificationService.warning("End date must be after start date");return}let a=this.auth.currentUser;if(a)try{yield this.subscriptionService.updateSubscriptionDates(a.uid,t,r),this.notificationService.success("Subscription dates updated successfully"),this.loadSubscription()}catch(o){console.error("Error updating subscription dates:",o),this.notificationService.error("Failed to update subscription dates")}else this.notificationService.error("User not authenticated")})}deleteSubscription(){return me(this,null,function*(){let t=this.auth.currentUser;if(t)try{yield this.subscriptionService.deleteSubscription(t.uid),this.subscription=void 0,this.notificationService.success("Subscription deleted successfully")}catch(r){console.error("Error deleting subscription:",r),this.notificationService.error("Failed to delete subscription")}else this.notificationService.error("User not authenticated")})}};i.\u0275fac=function(r){return new(r||i)(Y(Ky),Y(xt),Y(nn),Y(ft),Y(Vt))},i.\u0275cmp=Re({type:i,selectors:[["app-subscription"]],decls:5,vars:2,consts:[[4,"ngIf"],[3,"submit",4,"ngIf"],[3,"click"],[3,"submit"],["for","plan"],["id","plan","name","plan",3,"ngModelChange","ngModel"],["value","free"],["value","premium"],["for","startDate"],["type","date","id","startDate","name","startDate","required","",3,"ngModelChange","ngModel"],["for","endDate"],["type","date","id","endDate","name","endDate","required","",3,"ngModelChange","ngModel"],["type","submit"]],template:function(r,a){r&1&&(s(0,"div")(1,"h2"),d(2,"User Subscription"),c(),N(3,lz,13,9,"div",0)(4,dz,16,3,"form",1),c()),r&2&&(u(3),P("ngIf",a.subscription),u(),P("ngIf",!a.subscription))},dependencies:[dt,Wn,uc,pc,Nt,gc,At,Yn,fc,Jn,c0,_i]});let e=i;return e})();var Mf=d0("goals"),Pf=bo(Mf,e=>e.goals),Qy=bo(Mf,e=>e.loading),Jy=bo(Mf,e=>e.error);var kK=bo(Pf,e=>e.map(i=>le(oe({},i),{progress:i.currentAmount/i.targetAmount,percentage:Math.round(i.currentAmount/i.targetAmount*100)})));var gz=(e,i)=>i.goalId;function uz(e,i){if(e&1){let n=ue();s(0,"div")(1,"div")(2,"p"),d(3),c(),s(4,"p"),d(5),ce(6,"currency"),c(),s(7,"p"),d(8),ce(9,"currency"),c(),s(10,"p"),d(11),ce(12,"date"),c(),s(13,"button",8),F("click",function(){let r=R(n).$implicit,a=v();return B(a.deleteGoal(r.goalId))}),d(14,"Delete"),c(),s(15,"button",8),F("click",function(){let r=R(n).$implicit,a=v();return B(a.updateCurrentAmount(r.goalId,100))}),d(16,"Add 100 to current amount"),c()()()}if(e&2){let n=i.$implicit,t=v();u(3),ne("Title: ",n.title,""),u(2),ne("Target Amount: ",xe(6,4,n.targetAmount),""),u(3),ne("Current Amount: ",xe(9,6,n.currentAmount),""),u(3),ne("Deadline: ",ht(12,8,t.dateService.toDate(n.deadline),"short"),"")}}var e2=(()=>{let i=class i{constructor(t,r,a,o,l){this.auth=t,this.router=r,this.notificationService=a,this.store=o,this.dateService=l,this.userId="",this.goals=[],this.newGoal={goalId:"",userId:"",title:"",targetAmount:0,currentAmount:0,deadline:ei.fromDate(new Date)},this.destroy$=new Bt,this.subscriptions=new Ri,this.goals$=this.store.select(Pf),this.goalsLoading$=this.store.select(Qy),this.goalsError$=this.store.select(Jy)}ngOnInit(){this.loadGoals(),this.subscribeToStoreData()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.destroy$.next(),this.destroy$.complete()}loadGoals(){let t=this.auth.currentUser;t&&(this.userId=t.uid,this.store.dispatch(qa({userId:this.userId})))}subscribeToStoreData(){this.subscriptions.add(this.goals$.subscribe(t=>{this.goals=t})),this.subscriptions.add(this.goalsError$.subscribe(t=>{t&&(console.error("Error loading goals:",t),this.notificationService.error("Failed to load goals"))}))}createGoal(){if(!this.newGoal.title||!this.newGoal.targetAmount){this.notificationService.warning("Please fill in all required fields");return}let t=this.auth.currentUser;t&&(this.newGoal.userId=t.uid,this.newGoal.goalId=`${this.newGoal.userId}-${new Date().getTime()}`,this.store.dispatch(Vc({userId:t.uid,goal:this.newGoal})),this.notificationService.success("Goal created successfully"),this.newGoal={goalId:"",userId:"",title:"",targetAmount:0,currentAmount:0,deadline:ei.fromDate(new Date)})}deleteGoal(t){let r=this.auth.currentUser;r&&(this.store.dispatch(Uc({userId:r.uid,goalId:t})),this.notificationService.success("Goal deleted successfully"))}updateCurrentAmount(t,r){if(r<=0){this.notificationService.warning("Please enter a valid amount");return}let a=this.auth.currentUser;a&&(this.store.dispatch(zc({userId:a.uid,goalId:t,amount:r})),this.notificationService.success("Goal progress updated successfully"))}};i.\u0275fac=function(r){return new(r||i)(Y(xt),Y(nn),Y(ft),Y(pt),Y(Vt))},i.\u0275cmp=Re({type:i,selectors:[["app-goals"]],decls:17,vars:3,consts:[[3,"submit"],["for","title"],["type","text","id","title","name","title","required","",3,"ngModelChange","ngModel"],["for","targetAmount"],["type","number","id","targetAmount","name","targetAmount","required","",3,"ngModelChange","ngModel"],["for","deadline"],["type","date","id","deadline","name","deadline","required","",3,"ngModelChange","ngModel"],["type","submit"],[3,"click"]],template:function(r,a){r&1&&(s(0,"div")(1,"h2"),d(2,"User Goals"),c(),Ge(3,uz,17,11,"div",null,gz),s(5,"form",0),F("submit",function(){return a.createGoal()}),s(6,"label",1),d(7,"Title:"),c(),s(8,"input",2),lt("ngModelChange",function(l){return ct(a.newGoal.title,l)||(a.newGoal.title=l),l}),c(),s(9,"label",3),d(10,"Target Amount:"),c(),s(11,"input",4),lt("ngModelChange",function(l){return ct(a.newGoal.targetAmount,l)||(a.newGoal.targetAmount=l),l}),c(),s(12,"label",5),d(13,"Deadline:"),c(),s(14,"input",6),lt("ngModelChange",function(l){return ct(a.newGoal.deadline,l)||(a.newGoal.deadline=l),l}),c(),s(15,"button",7),d(16,"Add Goal"),c()()()),r&2&&(u(3),He(a.goals),u(5),st("ngModel",a.newGoal.title),u(3),st("ngModel",a.newGoal.targetAmount),u(3),st("ngModel",a.newGoal.deadline))},dependencies:[Wn,Nt,Ui,At,Yn,fc,Jn,c0,_i,Sr]});let e=i;return e})();var t2=(()=>{let i=class i extends qm{constructor(t,r){super(t,r),this.firestore=t,this.auth=r,this.COLLECTION_NAME="googleSheets"}extractSpreadsheetId(t){try{let r=new URL(t);if(r.hostname==="docs.google.com"&&r.pathname.includes("/spreadsheets/d/")){let a=r.pathname.split("/"),o=a.findIndex(l=>l==="d");if(o!==-1&&a[o+1])return a[o+1]}return null}catch(r){return console.error("Error extracting spreadsheet ID:",r),null}}validateSheetUrl(t){return!!this.extractSpreadsheetId(t)}getConnections(){try{let t=this.getCollectionRef(this.COLLECTION_NAME);return Dn(Va(t)).pipe(We(r=>r.docs.map(a=>oe({id:a.id},a.data()))),vt(r=>this.handleError(r,"getConnections")))}catch(t){return this.handleError(t,"getConnections")}}createConnection(t){try{let r=this.extractSpreadsheetId(t.spreadsheetUrl);if(!r)return Na(()=>new Error("Invalid Google Sheets URL"));let a=le(oe({},t),{spreadsheetId:r,id:this.generateId(),createdAt:new Date,updatedAt:new Date}),o=this.getDocumentRef(this.COLLECTION_NAME,a.id);return Dn(Rr(o,a)).pipe(We(()=>a),vt(l=>this.handleError(l,"createConnection")))}catch(r){return this.handleError(r,"createConnection")}}updateConnection(t,r){try{let a=this.getDocumentRef(this.COLLECTION_NAME,t),o=le(oe({},r),{updatedAt:new Date});return Dn(Fn(a,o)).pipe(vt(l=>this.handleError(l,"updateConnection")))}catch(a){return this.handleError(a,"updateConnection")}}deleteConnection(t){try{let r=this.getDocumentRef(this.COLLECTION_NAME,t);return Dn(zi(r)).pipe(vt(a=>this.handleError(a,"deleteConnection")))}catch(r){return this.handleError(r,"deleteConnection")}}testConnection(t){try{let r=`https://docs.google.com/spreadsheets/d/${t.spreadsheetId}/gviz/tq?tqx=out:csv&sheet=${t.sheetName}`;return Dn(fetch(r,{method:"HEAD"})).pipe(We(a=>a.ok),vt(a=>(console.error("Google Sheets connection test failed:",a),gt(!1))))}catch{return gt(!1)}}importFromSheet(t){try{let r=`https://docs.google.com/spreadsheets/d/${t.spreadsheetId}/gviz/tq?tqx=out:csv&sheet=${t.sheetName}`;return Dn(fetch(r)).pipe(wr(a=>{if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return Dn(a.text())}),We(a=>{if(!a||a.trim()==="")return[];let o=a.split(`
`);if(o.length<2)return[];let l=this.parseCSVLine(o[0]);return o.slice(1).filter(g=>g.trim()!=="").map(g=>{let f=this.parseCSVLine(g),h={};return l.forEach((x,C)=>{h[x]=f[C]||""}),h})}),vt(a=>this.handleError(a,"importFromSheet")))}catch(r){return this.handleError(r,"importFromSheet")}}parseCSVLine(t){let r=[],a="",o=!1;for(let l=0;l<t.length;l++){let m=t[l];m==='"'?o=!o:m===","&&!o?(r.push(a.trim()),a=""):a+=m}return r.push(a.trim()),r}exportToSheet(t,r){return Na(()=>new Error("Export is not supported in read-only mode. Please use the Google Sheets interface to edit data."))}getSetupInstructions(){return['1. Use the "Get Example Sheet" button below to open a template you can copy','2. In the example sheet, click "File" \u2192 "Make a copy" to create your own version',"3. Open your copied Google Sheet in the browser",'4. Click "Share" in the top right corner','5. Set sharing to "Anyone with the link can view"',"6. Copy the URL from your browser address bar",'7. Paste the URL in the "Sheet URL" field below','8. Enter the name of the specific sheet tab (e.g., "Sheet1", "Transactions")',"9. Test the connection to verify access","Note: This is read-only access for data import only"]}getApiDocsUrl(){return"https://support.google.com/docs/answer/2494822?hl=en"}};i.\u0275fac=function(r){return new(r||i)(De(cr),De(xt))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();function fz(e,i){if(e&1&&(s(0,"li"),d(1),c()),e&2){let n=i.$implicit;u(),L(n)}}function hz(e,i){if(e&1&&(s(0,"div",50),d(1),c()),e&2){let n=v();u(),L(n.getFieldError("name"))}}function _z(e,i){if(e&1&&(s(0,"div",50),d(1),c()),e&2){let n=v();u(),L(n.getFieldError("sheetName"))}}function xz(e,i){if(e&1&&(s(0,"div",50),d(1),c()),e&2){let n=v();u(),L(n.getFieldError("spreadsheetUrl"))}}function Cz(e,i){e&1&&re(0,"mat-spinner",51)}function vz(e,i){e&1&&(s(0,"mat-icon"),d(1,"wifi_tethering"),c())}function bz(e,i){e&1&&(s(0,"div",52),re(1,"mat-spinner",53),c())}function yz(e,i){e&1&&(s(0,"div",54)(1,"mat-icon",55),d(2,"table_chart"),c(),s(3,"h4",56),d(4,"No connections yet"),c(),s(5,"p",57),d(6,"Create your first Google Sheets connection to import data"),c()())}function Mz(e,i){e&1&&re(0,"mat-spinner",74)}function Pz(e,i){e&1&&(s(0,"mat-icon"),d(1,"download"),c())}function Oz(e,i){if(e&1){let n=ue();s(0,"div",60)(1,"div",61)(2,"div",35)(3,"div",62)(4,"mat-icon",4),d(5,"table_chart"),c()(),s(6,"div")(7,"h4",63),d(8),c(),s(9,"p",64),d(10),c()()(),s(11,"div",65)(12,"mat-slide-toggle",66),F("change",function(r){let a=R(n).$implicit,o=v(2);return a.isActive=r.checked,B(o.updateConnection(a))}),c(),s(13,"button",67),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.deleteConnection(r))}),s(14,"mat-icon"),d(15,"delete"),c()()()(),s(16,"div",68)(17,"div")(18,"span",57),d(19,"Sheet:"),c(),s(20,"span",69),d(21),c()(),s(22,"div")(23,"span",57),d(24,"Status:"),c(),s(25,"span",69),d(26),c()(),s(27,"div")(28,"span",57),d(29,"Last Sync:"),c(),s(30,"span",69),d(31),ce(32,"date"),c()()(),s(33,"div",70)(34,"button",71),F("click",function(){let r=R(n).$implicit,a=v(2);return B(a.importFromSheet(r))}),N(35,Mz,1,0,"mat-spinner",72)(36,Pz,2,0,"mat-icon",41),d(37),c(),s(38,"a",73)(39,"mat-icon"),d(40,"open_in_new"),c(),d(41," Open Sheet "),c()()()}if(e&2){let n=i.$implicit,t=v(2);u(8),L(n.name),u(2),L(n.spreadsheetId),u(2),P("checked",n.isActive),u(9),L(n.sheetName),u(4),jt(n.isActive?"text-green-600":"text-gray-500"),u(),ne(" ",n.isActive?"Active":"Inactive"," "),u(5),ne(" ",n.lastSync?ht(32,13,n.lastSync,"short"):"Never"," "),u(3),P("disabled",t.isImporting&&t.selectedSpreadsheetId===n.spreadsheetId),u(),P("ngIf",t.isImporting&&t.selectedSpreadsheetId===n.spreadsheetId),u(),P("ngIf",!t.isImporting&&t.selectedSpreadsheetId===n.spreadsheetId),u(),ne(" ",t.isImporting&&t.selectedSpreadsheetId===n.spreadsheetId?"Importing...":"Import Data"," "),u(),P("href",n.spreadsheetUrl,Zd)}}function wz(e,i){if(e&1&&(s(0,"div",58),N(1,Oz,42,16,"div",59),c()),e&2){let n=v();u(),P("ngForOf",n.connections)}}var n2=(()=>{let i=class i{constructor(t,r,a,o,l,m,g,f,h){this.googleSheetsService=t,this.formBuilder=r,this.dialog=a,this.snackBar=o,this.userService=l,this.breakpointService=m,this.transactionsService=g,this.store=f,this.auth=h,this.connections=[],this.isLoading=!1,this.isTestingConnection=!1,this.isImporting=!1,this.testConfig=null,this.destroy$=new Bt,this.selectedSpreadsheetId="",this.allCategories=[],this.connectionForm=this.formBuilder.group({name:["",[tt.required,tt.minLength(3)]],spreadsheetUrl:["",[tt.required,this.urlValidator.bind(this)]],sheetName:["Sheet1",[tt.required]],isActive:[!0]})}ngOnInit(){this.loadConnections(),this.store.select(un).subscribe(t=>{this.allCategories=t})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}urlValidator(t){return t.value?this.googleSheetsService.validateSheetUrl(t.value)?null:{invalidUrl:!0}:null}loadConnections(){this.isLoading=!0,this.googleSheetsService.getConnections().pipe(yt(this.destroy$)).subscribe({next:t=>{this.connections=t,this.isLoading=!1},error:t=>{console.error("Error loading connections:",t),this.showSnackBar("Error loading connections","error"),this.isLoading=!1}})}createConnection(){if(this.connectionForm.valid){let t=this.connectionForm.value;this.googleSheetsService.createConnection(t).pipe(yt(this.destroy$)).subscribe({next:r=>{this.connections.push(r),this.connectionForm.reset({sheetName:"Sheet1",isActive:!0}),this.showSnackBar("Connection created successfully","success")},error:r=>{console.error("Error creating connection:",r),this.showSnackBar("Error creating connection","error")}})}else this.markFormGroupTouched()}updateConnection(t){let r={name:t.name,isActive:t.isActive};this.googleSheetsService.updateConnection(t.id,r).pipe(yt(this.destroy$)).subscribe({next:()=>{this.showSnackBar("Connection updated successfully","success")},error:a=>{console.error("Error updating connection:",a),this.showSnackBar("Error updating connection","error")}})}deleteConnection(t){confirm(`Are you sure you want to delete the connection "${t.name}"?`)&&this.googleSheetsService.deleteConnection(t.id).pipe(yt(this.destroy$)).subscribe({next:()=>{this.connections=this.connections.filter(r=>r.id!==t.id),this.showSnackBar("Connection deleted successfully","success")},error:r=>{console.error("Error deleting connection:",r),this.showSnackBar("Error deleting connection","error")}})}testConnection(){if(this.connectionForm.valid){this.isTestingConnection=!0;let t=this.connectionForm.value,r=this.googleSheetsService.extractSpreadsheetId(t.spreadsheetUrl);if(!r){this.isTestingConnection=!1,this.showSnackBar("Invalid Google Sheets URL","error");return}this.testConfig={spreadsheetId:r,sheetName:t.sheetName},this.googleSheetsService.testConnection(this.testConfig).pipe(yt(this.destroy$)).subscribe({next:a=>{this.isTestingConnection=!1,a?this.showSnackBar("Connection test successful!","success"):this.showSnackBar('Connection test failed. Please check your URL and sheet name, and ensure the sheet is shared with "Anyone with the link can view".',"error")},error:a=>{this.isTestingConnection=!1,console.error("Connection test error:",a),this.showSnackBar("Connection test failed","error")}})}else this.markFormGroupTouched()}importFromSheet(t){this.isImporting=!0,this.selectedSpreadsheetId=t.spreadsheetId;let r={spreadsheetId:t.spreadsheetId,sheetName:t.sheetName};this.googleSheetsService.importFromSheet(r).pipe(yt(this.destroy$)).subscribe({next:a=>{if(this.isImporting=!1,a.length>0){let o=this.transformGoogleSheetsData(a);this.dialog.open(xl,{data:{transactions:o,categories:this.allCategories},panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"import-transactions-dialog"}).afterClosed().subscribe(m=>{m&&m.length>0&&this.createTransactionsFromImport(m)})}else this.showSnackBar("No data found in the specified sheet","warning")},error:a=>{this.isImporting=!1,console.error("Import error:",a),this.showSnackBar("Error importing data from Google Sheets","error")}})}transformGoogleSheetsData(t){return t.map(r=>{let a=this.extractNumberFromString(r.Amount);return{type:r.Type.toLowerCase(),category:r.Category.toLowerCase(),date:new Date(r.Date)||new Date,description:r.Description.toLowerCase(),amount:a}})}extractNumberFromString(t){let r=parseFloat(t.replace(/[^0-9.]/g,""));return console.log(r),isNaN(r)?0:r}createTransactionsFromImport(t){var m;let r=(m=this.auth.currentUser)==null?void 0:m.uid;if(!r){this.showSnackBar("User not authenticated","error");return}this.isImporting=!0;let a=0,o=0,l=t.map(g=>me(this,null,function*(){try{let f={userId:r,payee:g.description||"Imported Transaction",accountId:g.accountId||"default",amount:parseFloat(g.amount),category:g.category||"Uncategorized",categoryId:g.categoryId||"default",type:g.type==="income"?Lt.INCOME:Lt.EXPENSE,date:new Date(g.date),notes:g.notes||`Imported from Google Sheets - ${g.description}`,status:Xo.COMPLETED,isPending:!1,syncStatus:bi.PENDING,lastSyncedAt:new Date,createdAt:new Date,updatedAt:new Date,createdBy:r,updatedBy:r};yield this.transactionsService.createTransaction(r,f).toPromise(),a++}catch(f){console.error("Error creating transaction:",g,f),o++}}));Promise.all(l).then(()=>{this.isImporting=!1,a>0&&(this.showSnackBar(`Successfully imported ${a} transactions`,"success"),this.store.dispatch(li({userId:r}))),o>0&&this.showSnackBar(`${o} transactions failed to import`,"warning")}).catch(g=>{this.isImporting=!1,console.error("Error during import:",g),this.showSnackBar("Error during import process","error")})}getSetupInstructions(){return this.googleSheetsService.getSetupInstructions()}openApiDocs(){window.open(this.googleSheetsService.getApiDocsUrl(),"_blank")}openExampleSheet(){window.open("https://docs.google.com/spreadsheets/d/1EDhMkaFWOedDEQSn1TQsl011b-H-5_XAXSIpi31QwTM/edit?usp=sharing","_blank")}markFormGroupTouched(){Object.keys(this.connectionForm.controls).forEach(t=>{let r=this.connectionForm.get(t);r==null||r.markAsTouched()})}showSnackBar(t,r="success"){this.snackBar.open(t,"Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"bottom",panelClass:r==="error"?["error-snackbar"]:r==="warning"?["warning-snackbar"]:["success-snackbar"]})}getFieldError(t){let r=this.connectionForm.get(t);if(r!=null&&r.errors&&r.touched){if(r.errors.required)return"This field is required";if(r.errors.minlength)return`Minimum length is ${r.errors.minlength.requiredLength} characters`;if(r.errors.invalidUrl)return"Please enter a valid Google Sheets URL"}return""}};i.\u0275fac=function(r){return new(r||i)(Y(t2),Y(vi),Y(xn),Y(B_),Y(ni),Y(gr),Y(Ka),Y(pt),Y(xt))},i.\u0275cmp=Re({type:i,selectors:[["app-google-sheets"]],decls:80,vars:13,consts:[[1,"google-sheets-container","p-6","max-w-6xl","mx-auto"],[1,"mb-8"],[1,"flex","items-start","gap-3","mb-3"],[1,"w-10","h-10","bg-gradient-to-br","mt-2","from-green-500","to-blue-600","rounded-lg","flex","items-start","justify-start"],[1,"text-white"],[1,"text-2xl","!m-0","font-bold","text-gray-900"],[1,"text-gray-600","text-sm"],[1,"bg-blue-50","border","border-blue-200","rounded-xl","p-6","mb-8"],[1,"flex","items-center","gap-3","mb-4"],[1,"text-blue-600"],[1,"text-lg","font-semibold","text-blue-900"],[1,"bg-green-50","border","border-green-200","rounded-lg","p-4","mb-4"],[1,"flex","items-center","gap-2","mb-2"],[1,"text-green-600"],[1,"font-medium","text-green-800"],[1,"text-sm","text-green-700","mb-3"],[1,"space-y-2","text-sm","text-blue-800"],[1,"list-decimal","list-inside","space-y-1"],[4,"ngFor","ngForOf"],[1,"mt-4","flex","gap-3"],["mat-stroked-button","","color","primary",1,"text-blue-600","border-blue-600",3,"click"],[1,"mr-2"],["mat-raised-button","","color","accent",1,"bg-green-600","text-white",3,"click"],[1,"bg-white","border","border-gray-200","rounded-xl","p-6","mb-8","shadow-sm"],[1,"text-xl","font-semibold","text-gray-900","mb-6"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["for","name",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","name","type","text","formControlName","name","placeholder","My Google Sheets Connection",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors"],["class","text-red-600 text-sm mt-1",4,"ngIf"],["for","sheetName",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","sheetName","type","text","formControlName","sheetName","placeholder","Sheet1",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors"],["for","spreadsheetUrl",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","spreadsheetUrl","type","url","formControlName","spreadsheetUrl","placeholder","https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors"],[1,"text-gray-500","text-sm","mt-1"],[1,"flex","items-center","gap-3"],["formControlName","isActive","color","primary"],[1,"text-sm","font-medium","text-gray-700"],[1,"flex","gap-4"],["type","button","mat-stroked-button","","color","primary",1,"flex","items-center","gap-2",3,"click","disabled"],["diameter","20",4,"ngIf"],[4,"ngIf"],["type","submit","mat-raised-button","","color","primary",1,"flex","items-center","gap-2",3,"disabled"],[1,"bg-white","border","border-gray-200","rounded-xl","shadow-sm"],[1,"p-6","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-900"],[1,"p-6"],["class","flex justify-center py-8",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","space-y-4",4,"ngIf"],[1,"text-red-600","text-sm","mt-1"],["diameter","20"],[1,"flex","justify-center","py-8"],["diameter","40"],[1,"text-center","py-12"],[1,"text-gray-400","text-6xl","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"space-y-4"],["class","border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",4,"ngFor","ngForOf"],[1,"border","border-gray-200","rounded-lg","p-4","hover:shadow-md","transition-shadow"],[1,"flex","items-center","justify-between","mb-4"],[1,"w-10","h-10","bg-gradient-to-br","from-green-500","to-blue-600","rounded-lg","flex","items-center","justify-center"],[1,"font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","gap-2"],["color","primary",3,"change","checked"],["mat-icon-button","","color","warn","matTooltip","Delete Connection",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","text-sm"],[1,"font-medium","ml-1"],[1,"flex","gap-3","mt-4"],["mat-stroked-button","","color","primary",1,"flex","items-center","gap-2",3,"click","disabled"],["diameter","16",4,"ngIf"],["target","_blank","mat-stroked-button","","color","accent",1,"flex","items-center","gap-2",3,"href"],["diameter","16"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-icon",4),d(5,"table_chart"),c()(),s(6,"div")(7,"h1",5),d(8,"Google Sheets"),c(),s(9,"p",6),d(10,"Import your financial data from Google Sheets "),c()()()(),s(11,"div",7)(12,"div",8)(13,"mat-icon",9),d(14,"info"),c(),s(15,"h3",10),d(16,"Setup Instructions"),c()(),s(17,"div",11)(18,"div",12)(19,"mat-icon",13),d(20,"lightbulb"),c(),s(21,"span",14),d(22,"Quick Start"),c()(),s(23,"p",15),d(24,' Not sure how to format your Google Sheet? Click "Get Example Sheet" below to open a template you can copy and use as a starting point. '),c()(),s(25,"div",16)(26,"ol",17),N(27,fz,2,1,"li",18),c()(),s(28,"div",19)(29,"button",20),F("click",function(){return a.openApiDocs()}),s(30,"mat-icon",21),d(31,"open_in_new"),c(),d(32," View Google Sheets Help "),c(),s(33,"button",22),F("click",function(){return a.openExampleSheet()}),s(34,"mat-icon",21),d(35,"content_copy"),c(),d(36," Get Example Sheet "),c()()(),s(37,"div",23)(38,"h3",24),d(39,"Add New Connection"),c(),s(40,"form",25),F("ngSubmit",function(){return a.createConnection()}),s(41,"div",26)(42,"div")(43,"label",27),d(44,"Connection Name"),c(),re(45,"input",28),N(46,hz,2,1,"div",29),c(),s(47,"div")(48,"label",30),d(49,"Sheet Name"),c(),re(50,"input",31),N(51,_z,2,1,"div",29),c()(),s(52,"div")(53,"label",32),d(54,"Google Sheets URL"),c(),re(55,"input",33),N(56,xz,2,1,"div",29),s(57,"p",34),d(58,'Make sure your Google Sheet is shared with "Anyone with the link can view"'),c()(),s(59,"div",35),re(60,"mat-slide-toggle",36),s(61,"label",37),d(62,"Active Connection"),c()(),s(63,"div",38)(64,"button",39),F("click",function(){return a.testConnection()}),N(65,Cz,1,0,"mat-spinner",40)(66,vz,2,0,"mat-icon",41),d(67),c(),s(68,"button",42)(69,"mat-icon"),d(70,"add"),c(),d(71," Create Connection "),c()()()(),s(72,"div",43)(73,"div",44)(74,"h3",45),d(75,"Your Connections"),c()(),s(76,"div",46),N(77,bz,2,0,"div",47)(78,yz,7,0,"div",48)(79,wz,2,1,"div",49),c()()()),r&2&&(u(27),P("ngForOf",a.getSetupInstructions()),u(13),P("formGroup",a.connectionForm),u(6),P("ngIf",a.getFieldError("name")),u(5),P("ngIf",a.getFieldError("sheetName")),u(5),P("ngIf",a.getFieldError("spreadsheetUrl")),u(8),P("disabled",a.isTestingConnection||!a.connectionForm.valid),u(),P("ngIf",a.isTestingConnection),u(),P("ngIf",!a.isTestingConnection),u(),ne(" ",a.isTestingConnection?"Testing...":"Test Connection"," "),u(),P("disabled",!a.connectionForm.valid),u(9),P("ngIf",a.isLoading),u(),P("ngIf",!a.isLoading&&a.connections.length===0),u(),P("ngIf",!a.isLoading&&a.connections.length>0))},dependencies:[or,dt,Wn,Nt,At,Yn,xi,Ci,D_,Jt,gn,Qe,Br,Tn,ma,_i],styles:[".google-sheets-container[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#f8fafc,#e2e8f0)}  .success-snackbar{background:#10b981;color:#fff}  .success-snackbar .mat-simple-snackbar-action{color:#fff}  .error-snackbar{background:#ef4444;color:#fff}  .error-snackbar .mat-simple-snackbar-action{color:#fff}  .warning-snackbar{background:#f59e0b;color:#fff}  .warning-snackbar .mat-simple-snackbar-action{color:#fff}input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f61a}button[mat-raised-button][_ngcontent-%COMP%]{transition:all .2s ease-in-out}button[mat-raised-button][_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 12px #00000026}button[mat-stroked-button][_ngcontent-%COMP%]{transition:all .2s ease-in-out}button[mat-stroked-button][_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px)}.connection-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.connection-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a}.loading-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:200px}@media (max-width: 768px){.google-sheets-container[_ngcontent-%COMP%]{padding:1rem}.grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.flex[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.connection-item[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-out}.google-sheets-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.google-sheets-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:4px}.google-sheets-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}.google-sheets-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}"]});let e=i;return e})();var i2=(()=>{let i=class i{constructor(t){this.http=t,this.apiUrl="https://api.openai.com/v1/chat/completions",this.apiKey="",this.loadApiKey()}loadApiKey(){try{this.apiKey=localStorage.getItem("openai_api_key")||""}catch(t){console.error("Error loading OpenAI API key:",t)}}setApiKey(t){this.apiKey=t}removeApiKey(){this.apiKey=""}isApiKeySet(){return!!this.apiKey}sendMessage(t,r="gpt-3.5-turbo"){if(!this.apiKey)return Na(()=>new Error("OpenAI API key not set"));let a={model:r,messages:t,max_tokens:1e3,temperature:.7},o=new E1({"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`});return this.http.post(this.apiUrl,a,{headers:o}).pipe(We(l=>{if(l.choices&&l.choices.length>0)return l.choices[0].message.content;throw new Error("No response from OpenAI")}),vt(l=>Na(()=>{var m,g;return new Error(((g=(m=l==null?void 0:l.error)==null?void 0:m.error)==null?void 0:g.message)||"Failed to get response from OpenAI. Please try again.")})))}createFinancialAdvisorMessage(){return{role:"system",content:`You are a helpful financial advisor AI assistant. You provide personalized financial advice, 
      budget analysis, investment recommendations, tax optimization strategies, and debt management tips. 
      Always provide practical, actionable advice while reminding users to consult with qualified financial 
      professionals for personalized guidance. Be clear, concise, and focus on educational content that 
      helps users make informed financial decisions.`}}analyzeSpendingPatterns(t){let r=this.createFinancialAdvisorMessage(),a={role:"user",content:`Analyze these spending patterns and provide recommendations for budget optimization: ${JSON.stringify(t)}`};return this.sendMessage([r,a])}getInvestmentAdvice(t){let r=this.createFinancialAdvisorMessage(),a={role:"user",content:`Based on this financial profile, provide investment recommendations: ${JSON.stringify(t)}`};return this.sendMessage([r,a])}getTaxOptimizationAdvice(t){let r=this.createFinancialAdvisorMessage(),a={role:"user",content:`Provide tax optimization strategies based on this financial data: ${JSON.stringify(t)}`};return this.sendMessage([r,a])}};i.\u0275fac=function(r){return new(r||i)(De(I1))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();function kz(e,i){e&1&&(s(0,"mat-icon"),d(1,"wifi"),c())}function Tz(e,i){e&1&&re(0,"div",27)}function Ez(e,i){if(e&1){let n=ue();s(0,"button",24),F("click",function(){R(n);let r=v();return B(r.testConnection())}),N(1,kz,2,0,"mat-icon",25)(2,Tz,1,0,"div",26),s(3,"span"),d(4),c()()}if(e&2){let n=v();P("disabled",n.isTestingConnection),u(),P("ngIf",!n.isTestingConnection),u(),P("ngIf",n.isTestingConnection),u(2),L(n.isTestingConnection?"Testing...":"Test Connection")}}function Iz(e,i){if(e&1){let n=ue();s(0,"button",28),F("click",function(){R(n);let r=v();return B(r.isConfiguring=!0)}),s(1,"mat-icon"),d(2,"add"),c(),s(3,"span"),d(4,"Connect API Key"),c()()}}function Az(e,i){if(e&1){let n=ue();s(0,"div",29)(1,"button",30),F("click",function(){R(n);let r=v();return B(r.isConfiguring=!0)}),s(2,"mat-icon"),d(3,"edit"),c(),s(4,"span"),d(5,"Change Key"),c()(),s(6,"button",31),F("click",function(){R(n);let r=v();return B(r.removeApiKey())}),s(7,"mat-icon"),d(8,"delete"),c(),s(9,"span"),d(10,"Remove"),c()()()}}function Dz(e,i){e&1&&(s(0,"mat-icon"),d(1,"wifi"),c())}function Fz(e,i){e&1&&re(0,"div",27)}function Rz(e,i){e&1&&(s(0,"mat-icon"),d(1,"save"),c())}function Bz(e,i){e&1&&re(0,"div",27)}function Nz(e,i){if(e&1){let n=ue();s(0,"div",32)(1,"div",33)(2,"h3"),d(3,"Configure OpenAI API"),c(),s(4,"p"),d(5,"Enter your OpenAI API key to enable AI-powered features"),c()(),s(6,"form",34),F("ngSubmit",function(){R(n);let r=v();return B(r.saveApiKey())}),s(7,"div",35)(8,"label",36),d(9,"API Key"),c(),s(10,"div",37),re(11,"input",38),s(12,"mat-icon",39),d(13,"key"),c()(),s(14,"div",40)(15,"mat-icon"),d(16,"info"),c(),s(17,"a",41),d(18," Get your API key from OpenAI Platform "),c()()(),s(19,"div",42)(20,"button",43),F("click",function(){R(n);let r=v();return B(r.isConfiguring=!1)}),s(21,"span"),d(22,"Cancel"),c()(),s(23,"button",44),F("click",function(){R(n);let r=v();return B(r.testAndSaveApiKey())}),N(24,Dz,2,0,"mat-icon",25)(25,Fz,1,0,"div",26),s(26,"span"),d(27),c()(),s(28,"button",45),N(29,Rz,2,0,"mat-icon",25)(30,Bz,1,0,"div",26),s(31,"span"),d(32),c()()()()()}if(e&2){let n=v();u(6),P("formGroup",n.apiKeyForm),u(17),P("disabled",!n.apiKeyForm.valid||n.isTestingConnection),u(),P("ngIf",!n.isTestingConnection),u(),P("ngIf",n.isTestingConnection),u(2),L(n.isTestingConnection?"Testing...":"Test & Save"),u(),P("disabled",!n.apiKeyForm.valid||n.isSaving),u(),P("ngIf",!n.isSaving),u(),P("ngIf",n.isSaving),u(2),L(n.isSaving?"Saving...":"Save Key")}}var r2=(()=>{let i=class i{constructor(t,r,a,o,l){this.fb=t,this.notificationService=r,this.userService=a,this.openaiService=o,this.store=l,this.isConnected=!1,this.apiKey="",this.isConfiguring=!1,this.isTestingConnection=!1,this.isSaving=!1,this.apiKeyForm=this.fb.group({apiKey:["",[tt.required,tt.minLength(20)]]})}ngOnInit(){this.loadApiKey()}loadApiKey(){return me(this,null,function*(){var t;try{let r=yield this.userService.getCurrentUser();(t=r==null?void 0:r.preferences)!=null&&t.openaiApiKey?(this.apiKey=r.preferences.openaiApiKey,this.isConnected=!0,this.apiKeyForm.patchValue({apiKey:this.apiKey}),this.openaiService.setApiKey(this.apiKey)):this.isConnected=!1}catch(r){console.error("Error loading API key:",r),this.notificationService.error("Failed to load API key")}})}saveApiKey(){return me(this,null,function*(){var t;if(this.apiKeyForm.valid){this.isSaving=!0;try{let r=(t=this.apiKeyForm.get("apiKey"))==null?void 0:t.value,a=yield this.userService.getCurrentUser();if(!a)throw new Error("User not found");let o=le(oe({},a.preferences),{openaiApiKey:r});this.store.dispatch(yo({userId:a.uid,preferences:o})),this.openaiService.setApiKey(r),this.apiKey=r,this.isConnected=!0,this.isConfiguring=!1,this.notificationService.success("OpenAI API key saved successfully")}catch(r){console.error("Error saving API key:",r),this.notificationService.error("Failed to save API key")}finally{this.isSaving=!1}}else this.notificationService.warning("Please enter a valid API key")})}removeApiKey(){return me(this,null,function*(){try{let t=yield this.userService.getCurrentUser();if(!t)throw new Error("User not found");let r=le(oe({},t.preferences),{openaiApiKey:void 0});this.store.dispatch(yo({userId:t.uid,preferences:r})),this.openaiService.removeApiKey(),this.apiKey="",this.isConnected=!1,this.apiKeyForm.reset(),this.notificationService.success("API key removed successfully")}catch(t){console.error("Error removing API key:",t),this.notificationService.error("Failed to remove API key")}})}testConnection(){return me(this,null,function*(){if(!this.isConnected){this.notificationService.warning("Please connect your OpenAI API key first");return}this.isTestingConnection=!0;try{this.openaiService.sendMessage([{role:"user",content:"Hello, this is a test message to verify the connection."}]).subscribe({next:t=>{this.notificationService.success("OpenAI connection test successful!"),this.isTestingConnection=!1},error:t=>{this.notificationService.error(`Connection test failed: ${t.message}`),this.isTestingConnection=!1}})}catch{this.notificationService.error("Failed to test connection"),this.isTestingConnection=!1}})}testAndSaveApiKey(){return me(this,null,function*(){var t;if(this.apiKeyForm.valid){this.isTestingConnection=!0;try{let r=(t=this.apiKeyForm.get("apiKey"))==null?void 0:t.value;this.openaiService.setApiKey(r),this.openaiService.sendMessage([{role:"user",content:"Hello, this is a test message to verify the API key."}]).subscribe({next:a=>me(this,null,function*(){yield this.saveApiKey(),this.notificationService.success("API key tested and saved successfully!"),this.isTestingConnection=!1}),error:a=>{this.notificationService.error(`API key test failed: ${a.message}`),this.isTestingConnection=!1,this.openaiService.removeApiKey()}})}catch{this.notificationService.error("Failed to test API key"),this.isTestingConnection=!1}}else this.notificationService.warning("Please enter a valid API key")})}};i.\u0275fac=function(r){return new(r||i)(Y(vi),Y(ft),Y(ni),Y(i2),Y(pt))},i.\u0275cmp=Re({type:i,selectors:[["app-openai-interaction"]],decls:32,vars:8,consts:[[1,"professional-container"],[1,"main-card"],[1,"card-header"],[1,"header-content"],[1,"title-section"],[1,"icon-wrapper"],[1,"header-icon"],[1,"title-content"],[1,"subtitle"],[1,"header-actions"],["class","test-button",3,"disabled","click",4,"ngIf"],[1,"connection-section"],[1,"section-header"],[1,"status-card"],[1,"status-content"],[1,"status-indicator"],[1,"status-dot"],[1,"status-info"],[1,"status-text"],[1,"status-description"],[1,"action-buttons"],["class","connect-btn primary",3,"click",4,"ngIf"],["class","btn-group",4,"ngIf"],["class","form-section",4,"ngIf"],[1,"test-button",3,"click","disabled"],[4,"ngIf"],["class","spinner",4,"ngIf"],[1,"spinner"],[1,"connect-btn","primary",3,"click"],[1,"btn-group"],[1,"change-btn","secondary",3,"click"],[1,"remove-btn","danger",3,"click"],[1,"form-section"],[1,"form-header"],[3,"ngSubmit","formGroup"],[1,"input-group"],["for","apiKey"],[1,"input-wrapper"],["id","apiKey","type","password","formControlName","apiKey","placeholder","sk-...",1,"api-input"],[1,"input-icon"],[1,"input-help"],["href","https://platform.openai.com/api-keys","target","_blank",1,"help-link"],[1,"form-actions"],["type","button",1,"cancel-btn",3,"click"],["type","button",1,"test-btn","primary",3,"click","disabled"],["type","submit",1,"save-btn","success",3,"disabled"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"mat-icon",6),d(7,"smart_toy"),c()(),s(8,"div",7)(9,"h1"),d(10,"OpenAI Integration"),c(),s(11,"p",8),d(12,"Connect your OpenAI account to enable AI-powered financial insights"),c()()()(),s(13,"div",9),N(14,Ez,5,4,"button",10),c()(),s(15,"div",11)(16,"div",12)(17,"h2"),d(18,"Connection Status"),c()(),s(19,"div",13)(20,"div",14)(21,"div",15),re(22,"div",16),s(23,"div",17)(24,"span",18),d(25),c(),s(26,"span",19),d(27),c()()(),s(28,"div",20),N(29,Iz,5,0,"button",21)(30,Az,11,0,"div",22),c()()(),N(31,Nz,33,9,"div",23),c()()()),r&2&&(u(14),P("ngIf",a.isConnected),u(8),ze("connected",a.isConnected),u(3),L(a.isConnected?"Connected":"Not Connected"),u(2),ne(" ",a.isConnected?"Your OpenAI API is ready to use":"Connect your OpenAI API key to get started"," "),u(2),P("ngIf",!a.isConfiguring&&!a.isConnected),u(),P("ngIf",!a.isConfiguring&&a.isConnected),u(),P("ngIf",a.isConfiguring))},dependencies:[dt,Wn,Nt,At,Yn,xi,Ci,Qe],styles:[".professional-container[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto;padding:2rem;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;line-height:1.6;color:#1a202c}.main-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:0 4px 20px #00000014;border:1px solid #e2e8f0;overflow:hidden}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:2.5rem;background:linear-gradient(135deg,#f8fafc,#f1f5f9);border-bottom:1px solid #e2e8f0}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1.5rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:60px;height:60px;background:linear-gradient(135deg,#3b82f6,#2563eb);border-radius:12px;box-shadow:0 4px 12px #3b82f64d}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{color:#fff;font-size:2rem;width:2rem;height:2rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .title-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.25rem;font-weight:700;color:#1e293b;margin:0 0 .75rem;letter-spacing:-.025em;line-height:1.2}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .title-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1.125rem;color:#64748b;margin:0;font-weight:400}.card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .test-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.875rem 1.5rem;background:linear-gradient(135deg,#3b82f6,#2563eb);border:none;border-radius:10px;color:#fff;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 12px #3b82f64d}.card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .test-button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #3b82f666}.card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .test-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .test-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .test-button[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:1.125rem;height:1.125rem;border:2px solid rgba(255,255,255,.3);border-top:2px solid white;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.section-header[_ngcontent-%COMP%]{margin-bottom:2rem}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:#1e293b;margin:0 0 .5rem;letter-spacing:-.025em}.section-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;color:#64748b;margin:0;font-weight:400}.connection-section[_ngcontent-%COMP%]{padding:2.5rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;padding:2rem;margin-bottom:2rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;background:#ef4444;transition:background .3s ease;box-shadow:0 0 0 4px #ef44441a}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .status-dot.connected[_ngcontent-%COMP%]{background:#10b981;box-shadow:0 0 0 4px #10b9811a}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .status-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .status-info[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1e293b}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .status-info[_ngcontent-%COMP%]   .status-description[_ngcontent-%COMP%]{font-size:.875rem;color:#64748b}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:.75rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .connect-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.875rem 1.5rem;border:none;border-radius:10px;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .3s ease}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .connect-btn.primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;box-shadow:0 4px 12px #3b82f64d}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .connect-btn.primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #3b82f666}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .connect-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]{display:flex;gap:.75rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .change-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.875rem 1.5rem;border:1px solid #d1d5db;border-radius:10px;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .3s ease}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .change-btn.secondary[_ngcontent-%COMP%]{background:#fff;color:#374151}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .change-btn.secondary[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#9ca3af}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .change-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.875rem 1.5rem;border:1px solid #fecaca;border-radius:10px;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .3s ease}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .remove-btn.danger[_ngcontent-%COMP%]{background:#fff;color:#dc2626}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .remove-btn.danger[_ngcontent-%COMP%]:hover{background:#fef2f2;border-color:#fca5a5}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:2rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]{margin-bottom:2rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#1e293b;margin:0 0 .5rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;color:#64748b;margin:0}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{margin-bottom:2rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:600;color:#374151;margin-bottom:.75rem;font-size:.875rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{position:relative}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .api-input[_ngcontent-%COMP%]{width:100%;padding:1rem 3rem 1rem 1.25rem;border:2px solid #e2e8f0;border-radius:10px;font-family:SF Mono,Monaco,Inconsolata,Roboto Mono,Courier New,monospace;font-size:.875rem;transition:all .3s ease;background:#f8fafc}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .api-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;background:#fff;box-shadow:0 0 0 4px #3b82f61a}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .api-input[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{position:absolute;right:1rem;top:50%;transform:translateY(-50%);color:#94a3b8;font-size:1.25rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-help[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-top:.75rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-help[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:1rem;width:1rem;height:1rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-help[_ngcontent-%COMP%]   .help-link[_ngcontent-%COMP%]{color:#3b82f6;text-decoration:none;font-size:.875rem;font-weight:500}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-help[_ngcontent-%COMP%]   .help-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.875rem 1.5rem;background:#fff;border:2px solid #e2e8f0;border-radius:10px;color:#475569;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .3s ease}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .test-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.875rem 1.5rem;border:none;border-radius:10px;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .3s ease}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .test-btn.primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;box-shadow:0 4px 12px #3b82f64d}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .test-btn.primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #3b82f666}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .test-btn.primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .test-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .test-btn[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:1.125rem;height:1.125rem;border:2px solid rgba(255,255,255,.3);border-top:2px solid white;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.875rem 1.5rem;border:none;border-radius:10px;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .3s ease}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-btn.success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);color:#fff;box-shadow:0 4px 12px #10b9814d}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-btn.success[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #10b98166}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-btn.success[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:1.125rem;height:1.125rem;border:2px solid rgba(255,255,255,.3);border-top:2px solid white;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.features-section[_ngcontent-%COMP%]{padding:2.5rem;border-bottom:1px solid #e2e8f0}.features-section[_ngcontent-%COMP%]   .features-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.features-section[_ngcontent-%COMP%]   .features-grid[_ngcontent-%COMP%]   .feature-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:1.5rem;background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;transition:all .3s ease}.features-section[_ngcontent-%COMP%]   .features-grid[_ngcontent-%COMP%]   .feature-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a}.features-section[_ngcontent-%COMP%]   .features-grid[_ngcontent-%COMP%]   .feature-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:50px;height:50px;background:linear-gradient(135deg,#3b82f6,#2563eb);border-radius:10px;flex-shrink:0}.features-section[_ngcontent-%COMP%]   .features-grid[_ngcontent-%COMP%]   .feature-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:1.5rem;width:1.5rem;height:1.5rem}.features-section[_ngcontent-%COMP%]   .features-grid[_ngcontent-%COMP%]   .feature-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1e293b;margin:0 0 .5rem}.features-section[_ngcontent-%COMP%]   .features-grid[_ngcontent-%COMP%]   .feature-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem;color:#64748b;margin:0;line-height:1.5}.security-section[_ngcontent-%COMP%]{padding:2.5rem;border-bottom:1px solid #e2e8f0}.security-section[_ngcontent-%COMP%]   .security-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.security-section[_ngcontent-%COMP%]   .security-grid[_ngcontent-%COMP%]   .security-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:1.5rem;background:#f0fdf4;border:1px solid #bbf7d0;border-radius:12px;transition:all .3s ease}.security-section[_ngcontent-%COMP%]   .security-grid[_ngcontent-%COMP%]   .security-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #10b9811a}.security-section[_ngcontent-%COMP%]   .security-grid[_ngcontent-%COMP%]   .security-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:50px;height:50px;background:linear-gradient(135deg,#10b981,#059669);border-radius:10px;flex-shrink:0}.security-section[_ngcontent-%COMP%]   .security-grid[_ngcontent-%COMP%]   .security-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:1.5rem;width:1.5rem;height:1.5rem}.security-section[_ngcontent-%COMP%]   .security-grid[_ngcontent-%COMP%]   .security-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1e293b;margin:0 0 .5rem}.security-section[_ngcontent-%COMP%]   .security-grid[_ngcontent-%COMP%]   .security-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem;color:#64748b;margin:0;line-height:1.5}.steps-section[_ngcontent-%COMP%]{padding:2.5rem}.steps-section[_ngcontent-%COMP%]   .steps-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem}.steps-section[_ngcontent-%COMP%]   .steps-grid[_ngcontent-%COMP%]   .step-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:1.5rem;background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;transition:all .3s ease}.steps-section[_ngcontent-%COMP%]   .steps-grid[_ngcontent-%COMP%]   .step-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a}.steps-section[_ngcontent-%COMP%]   .steps-grid[_ngcontent-%COMP%]   .step-card[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;border-radius:10px;font-size:1rem;font-weight:700;flex-shrink:0}.steps-section[_ngcontent-%COMP%]   .steps-grid[_ngcontent-%COMP%]   .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]{flex:1}.steps-section[_ngcontent-%COMP%]   .steps-grid[_ngcontent-%COMP%]   .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1e293b;margin:0 0 .5rem}.steps-section[_ngcontent-%COMP%]   .steps-grid[_ngcontent-%COMP%]   .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem;color:#64748b;margin:0 0 1rem;line-height:1.5}.steps-section[_ngcontent-%COMP%]   .steps-grid[_ngcontent-%COMP%]   .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;color:#3b82f6;text-decoration:none;font-weight:500;font-size:.875rem;transition:all .3s ease}.steps-section[_ngcontent-%COMP%]   .steps-grid[_ngcontent-%COMP%]   .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]:hover{color:#2563eb;transform:translate(2px)}.steps-section[_ngcontent-%COMP%]   .steps-grid[_ngcontent-%COMP%]   .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media (max-width: 1200px){.professional-container[_ngcontent-%COMP%]{max-width:95%;padding:1.5rem}.features-grid[_ngcontent-%COMP%], .security-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(250px,1fr))}.steps-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}}@media (max-width: 1024px){.professional-container[_ngcontent-%COMP%]{padding:1.25rem}.card-header[_ngcontent-%COMP%]{flex-direction:column;gap:1.5rem;align-items:flex-start;padding:2rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{gap:1.25rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:50px;height:50px}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{font-size:1.75rem;width:1.75rem;height:1.75rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .title-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem}.card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{align-self:flex-start}.connection-section[_ngcontent-%COMP%]{padding:2rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]{flex-direction:column;gap:1.5rem;align-items:flex-start}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{width:100%;justify-content:flex-start;flex-wrap:wrap;gap:.5rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .connect-btn[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]{flex:1;min-width:200px}.features-section[_ngcontent-%COMP%], .security-section[_ngcontent-%COMP%], .steps-section[_ngcontent-%COMP%]{padding:2rem}.features-grid[_ngcontent-%COMP%], .security-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1.25rem}.steps-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}}@media (max-width: 768px){.professional-container[_ngcontent-%COMP%]{padding:1rem;max-width:100%}.main-card[_ngcontent-%COMP%]{border-radius:12px}.card-header[_ngcontent-%COMP%]{padding:1.5rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;text-align:center}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:45px;height:45px}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .title-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;margin-bottom:.5rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .title-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1rem}.card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .test-button[_ngcontent-%COMP%]{width:100%;justify-content:center;padding:1rem 1.5rem}.section-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}.section-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem}.connection-section[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]{padding:1.5rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]{gap:1.25rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]{gap:.75rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{width:10px;height:10px}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .status-info[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{font-size:1rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .status-info[_ngcontent-%COMP%]   .status-description[_ngcontent-%COMP%]{font-size:.8rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{flex-direction:column;gap:.75rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .connect-btn[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]{width:100%;min-width:unset}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]{display:flex;gap:.5rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .change-btn[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{flex:1}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]{padding:1.5rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .api-input[_ngcontent-%COMP%]{padding:.875rem 1rem;font-size:.8rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{flex-direction:column;gap:.75rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .test-btn[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{width:100%;justify-content:center;padding:1rem 1.5rem}.features-section[_ngcontent-%COMP%], .security-section[_ngcontent-%COMP%], .steps-section[_ngcontent-%COMP%]{padding:1.5rem}.features-grid[_ngcontent-%COMP%], .security-grid[_ngcontent-%COMP%], .steps-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.feature-card[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]{padding:1.25rem;gap:.875rem}.feature-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]{width:45px;height:45px}.feature-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.feature-card[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{width:35px;height:35px;font-size:.875rem}.feature-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:.375rem}.feature-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem;line-height:1.4}}@media (max-width: 480px){.professional-container[_ngcontent-%COMP%]{padding:.75rem}.card-header[_ngcontent-%COMP%]{padding:1.25rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:40px;height:40px}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .title-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .title-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:.875rem}.section-header[_ngcontent-%COMP%]{margin-bottom:1.25rem}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}.section-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem}.connection-section[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]{padding:1.25rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .status-info[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{font-size:.875rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .status-info[_ngcontent-%COMP%]   .status-description[_ngcontent-%COMP%]{font-size:.75rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .connect-btn[_ngcontent-%COMP%]   .change-btn[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .connect-btn[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .change-btn[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{padding:.75rem 1rem;font-size:.8rem}.connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .connect-btn[_ngcontent-%COMP%]   .change-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .connect-btn[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .change-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]{padding:1.25rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .api-input[_ngcontent-%COMP%]{padding:.75rem .875rem;font-size:.75rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-help[_ngcontent-%COMP%]   .help-link[_ngcontent-%COMP%]{font-size:.75rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .test-btn[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{padding:.875rem 1.25rem;font-size:.8rem}.connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .test-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .connection-section[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}.features-section[_ngcontent-%COMP%], .security-section[_ngcontent-%COMP%], .steps-section[_ngcontent-%COMP%]{padding:1.25rem}.feature-card[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]{padding:1rem;gap:.75rem}.feature-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]{width:40px;height:40px}.feature-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.feature-card[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{width:30px;height:30px;font-size:.8rem}.feature-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:.875rem}.feature-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]{font-size:.75rem}.feature-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:.875rem;width:.875rem;height:.875rem}}@media (max-width: 360px){.professional-container[_ngcontent-%COMP%]{padding:.5rem}.card-header[_ngcontent-%COMP%]{padding:1rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:35px;height:35px}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .title-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.25rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .title-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:.8rem}.connection-section[_ngcontent-%COMP%], .features-section[_ngcontent-%COMP%], .security-section[_ngcontent-%COMP%], .steps-section[_ngcontent-%COMP%], .status-card[_ngcontent-%COMP%], .form-section[_ngcontent-%COMP%]{padding:1rem}.feature-card[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]{padding:.875rem;gap:.625rem}.feature-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]{width:35px;height:35px}.feature-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .feature-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .security-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}.feature-card[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%], .security-card[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%], .step-card[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{width:28px;height:28px;font-size:.75rem}}@media (max-height: 600px) and (orientation: landscape){.professional-container[_ngcontent-%COMP%]{padding:1rem}.card-header[_ngcontent-%COMP%]{padding:1.5rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:45px;height:45px}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .title-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:.25rem}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .title-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:.875rem}.connection-section[_ngcontent-%COMP%], .features-section[_ngcontent-%COMP%], .security-section[_ngcontent-%COMP%], .steps-section[_ngcontent-%COMP%]{padding:1.5rem}.section-header[_ngcontent-%COMP%]{margin-bottom:1rem}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}}"]});let e=i;return e})();var Of=d0("budgets"),a2=bo(Of,e=>e.budgets),o2=bo(Of,e=>e.loading),s2=bo(Of,e=>e.error);var Vz=()=>({round:!0});function Uz(e,i){if(e&1&&(s(0,"div",31)(1,"p",32),d(2),ce(3,"currency"),c()()),e&2){let n=v(2);u(2),ne("Monthly average: ",xe(3,1,n.yearlyBudget.totalIncome/12),"")}}function zz(e,i){if(e&1){let n=ue();s(0,"div",23)(1,"mat-card",24)(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),d(5,"account_balance"),c(),d(6," Income Planning "),c(),s(7,"mat-card-subtitle"),d(8,"Set your total expected yearly income"),c()(),s(9,"mat-card-content")(10,"div",25)(11,"div",26)(12,"mat-form-field",27)(13,"mat-label"),d(14,"Total Expected Yearly Income"),c(),s(15,"input",28),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.yearlyBudget.totalIncome,r)||(a.yearlyBudget.totalIncome=r),B(r)}),F("input",function(){R(n);let r=v();return r.calculateMonthlyIncome(),B(r.updateYearlyIncome())}),c()(),N(16,Uz,4,3,"div",29),c(),s(17,"mat-checkbox",30),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.yearlyBudget.splitByMonth,r)||(a.yearlyBudget.splitByMonth=r),B(r)}),d(18," Split income by month (for irregular income) "),c()()()()()}if(e&2){let n=v();u(15),st("ngModel",n.yearlyBudget.totalIncome),u(),P("ngIf",n.yearlyBudget.totalIncome>0),u(),st("ngModel",n.yearlyBudget.splitByMonth)}}function jz(e,i){if(e&1){let n=ue();s(0,"div",61)(1,"mat-slider",62)(2,"input",63),lt("ngModelChange",function(r){R(n);let a=v().$implicit,o=v(2);return ct(o.categoryBudgets[a.id||""],r)||(o.categoryBudgets[a.id||""]=r),B(r)}),F("input",function(){R(n);let r=v().$implicit,a=v(2);return B(a.onCategoryBudgetChange(r.id||"",a.categoryBudgets[r.id||""]||0))}),c()()()}if(e&2){let n=v().$implicit,t=v(2);u(),P("max",t.yearlyBudget.totalIncome/12)("min",0)("step",50),u(),st("ngModel",t.categoryBudgets[n.id||""])}}function $z(e,i){if(e&1){let n=ue();s(0,"div",64)(1,"mat-form-field",65)(2,"input",66),F("input",function(r){R(n);let a=v().$implicit,o=v(2);return B(o.onCategoryBudgetInputChange(a.id||"",r))}),c()()()}if(e&2){let n=v().$implicit,t=v(2);u(2),P("value",t.getCategoryBudget(n.id||""))("max",t.yearlyBudget.totalIncome/12)}}function Yz(e,i){if(e&1&&(s(0,"div",51)(1,"div",52)(2,"mat-icon",53),d(3),c(),s(4,"span",54),d(5),c()(),N(6,jz,3,4,"div",55),s(7,"div",56),N(8,$z,3,2,"div",57),s(9,"div",58)(10,"span",59),d(11),ce(12,"number"),c(),s(13,"span",60),d(14),ce(15,"currency"),c()()()()),e&2){let n=i.$implicit,t=v(2);u(2),wt("color",n.color),u(),L(n.icon),u(2),L(n.name),u(),P("ngIf",t.inputMode==="slider"),u(2),P("ngIf",t.inputMode==="input"),u(3),ne("",ht(12,8,t.getCategoryPercentage(n.id||""),"1.0-0"),"%"),u(3),ne("",ht(15,11,t.getCategoryMonthly(n.id||""),ka(14,Vz)),"/month")}}function Wz(e,i){e&1&&(s(0,"div",67)(1,"mat-icon"),d(2,"warning"),c(),s(3,"span"),d(4,"Budget exceeded! Other categories will be adjusted automatically."),c()())}function Gz(e,i){if(e&1){let n=ue();s(0,"div",33)(1,"mat-card",24)(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),d(5,"category"),c(),d(6," Expense Planning "),c(),s(7,"mat-card-subtitle"),d(8,"Allocate your budget across different expense categories using the sliders or input fields below"),c()(),s(9,"mat-card-content")(10,"div",34)(11,"mat-button-toggle-group",35),lt("valueChange",function(r){R(n);let a=v();return ct(a.inputMode,r)||(a.inputMode=r),B(r)}),F("change",function(){R(n);let r=v();return B(r.onInputModeChange())}),s(12,"mat-button-toggle",36)(13,"mat-icon"),d(14,"linear_scale"),c(),d(15," Slider Mode "),c(),s(16,"mat-button-toggle",37)(17,"mat-icon"),d(18,"edit"),c(),d(19," Input Mode "),c()(),s(20,"div",38)(21,"p",39)(22,"mat-icon"),d(23),c(),d(24),c()()(),s(25,"div",40),N(26,Yz,16,15,"div",41),c(),s(27,"div",42)(28,"div",43)(29,"span",44),d(30,"Total Allocated:"),c(),s(31,"span",45),d(32),ce(33,"currency"),c()(),s(34,"div",43)(35,"span",44),d(36,"Remaining:"),c(),s(37,"span",45),d(38),ce(39,"currency"),c()(),N(40,Wz,5,0,"div",46),s(41,"div",47)(42,"button",48),F("click",function(){R(n);let r=v();return B(r.updateAllCategoryBudgets())}),s(43,"mat-icon"),d(44,"save"),c(),d(45," Update All Budgets "),c(),s(46,"button",49),F("click",function(){R(n);let r=v();return B(r.distributeRemainingBudget())}),s(47,"mat-icon"),d(48,"shuffle"),c(),d(49," Distribute Remaining "),c(),s(50,"button",50),F("click",function(){R(n);let r=v();return B(r.resetAllCategoryBudgets())}),s(51,"mat-icon"),d(52,"refresh"),c(),d(53," Reset All "),c()()()()()()}if(e&2){let n=v();u(11),st("value",n.inputMode),u(12),L(n.inputMode==="slider"?"linear_scale":"edit"),u(),ne(" ",n.inputMode==="slider"?"Use sliders for quick budget allocation":"Enter exact amounts for precise control"," "),u(2),P("ngForOf",n.getExpenseCategories())("ngForTrackBy",n.trackByCategoryId),u(),ze("over-budget",n.getTotalAllocated()>n.yearlyBudget.totalIncome),u(4),ze("over-budget",n.getTotalAllocated()>n.yearlyBudget.totalIncome),u(),ne(" ",xe(33,16,n.getTotalAllocated())," "),u(5),ze("negative",n.getRemainingBudget()<0),u(),L(xe(39,18,n.getRemainingBudget())),u(2),P("ngIf",n.getTotalAllocated()>n.yearlyBudget.totalIncome),u(2),P("disabled",n.getTotalAllocated()===0),u(4),P("disabled",n.getRemainingBudget()<=0)}}function Hz(e,i){if(e&1){let n=ue();s(0,"div",72)(1,"mat-form-field",73)(2,"mat-label"),d(3,"Goal Name"),c(),s(4,"input",74),lt("ngModelChange",function(r){let a=R(n).$implicit;return ct(a.name,r)||(a.name=r),B(r)}),c()(),s(5,"mat-form-field",73)(6,"mat-label"),d(7,"Target Amount"),c(),s(8,"input",75),lt("ngModelChange",function(r){let a=R(n).$implicit;return ct(a.targetAmount,r)||(a.targetAmount=r),B(r)}),c(),s(9,"mat-icon",76),d(10,"attach_money"),c()(),s(11,"mat-form-field",73)(12,"mat-label"),d(13,"Monthly Contribution"),c(),s(14,"input",75),lt("ngModelChange",function(r){let a=R(n).$implicit;return ct(a.monthlyContribution,r)||(a.monthlyContribution=r),B(r)}),c(),s(15,"mat-icon",76),d(16,"attach_money"),c()(),s(17,"button",77),F("click",function(){let r=R(n).index,a=v(2);return B(a.removeSavingsGoal(r))}),s(18,"mat-icon"),d(19,"delete"),c()()()}if(e&2){let n=i.$implicit,t=i.index;u(4),st("ngModel",n.name),P("name","goalName"+t),u(4),st("ngModel",n.targetAmount),P("name","goalAmount"+t),u(6),st("ngModel",n.monthlyContribution),P("name","goalContribution"+t)}}function qz(e,i){if(e&1){let n=ue();s(0,"div",68)(1,"mat-card",24)(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),d(5,"savings"),c(),d(6," Savings & Investment Goals "),c(),s(7,"mat-card-subtitle"),d(8,"Set aside money for your financial goals"),c()(),s(9,"mat-card-content")(10,"div",69),N(11,Hz,20,6,"div",70),s(12,"button",71),F("click",function(){R(n);let r=v();return B(r.addSavingsGoal())}),s(13,"mat-icon"),d(14,"add"),c(),d(15," Add Savings Goal "),c()()()()()}if(e&2){let n=v();u(11),P("ngForOf",n.yearlyBudget.savingsGoals)}}function Xz(e,i){if(e&1){let n=ue();s(0,"div",81)(1,"mat-form-field",73)(2,"mat-label"),d(3,"Debt Name"),c(),s(4,"input",82),lt("ngModelChange",function(r){let a=R(n).$implicit;return ct(a.name,r)||(a.name=r),B(r)}),c()(),s(5,"mat-form-field",73)(6,"mat-label"),d(7,"Current Balance"),c(),s(8,"input",75),lt("ngModelChange",function(r){let a=R(n).$implicit;return ct(a.currentBalance,r)||(a.currentBalance=r),B(r)}),c(),s(9,"mat-icon",76),d(10,"attach_money"),c()(),s(11,"mat-form-field",73)(12,"mat-label"),d(13,"Monthly Payment"),c(),s(14,"input",75),lt("ngModelChange",function(r){let a=R(n).$implicit;return ct(a.monthlyPayment,r)||(a.monthlyPayment=r),B(r)}),c(),s(15,"mat-icon",76),d(16,"attach_money"),c()(),s(17,"mat-form-field",73)(18,"mat-label"),d(19,"Interest Rate (%)"),c(),s(20,"input",83),lt("ngModelChange",function(r){let a=R(n).$implicit;return ct(a.interestRate,r)||(a.interestRate=r),B(r)}),c(),s(21,"mat-icon",76),d(22,"percent"),c()(),s(23,"button",77),F("click",function(){let r=R(n).index,a=v(2);return B(a.removeDebt(r))}),s(24,"mat-icon"),d(25,"delete"),c()()()}if(e&2){let n=i.$implicit,t=i.index;u(4),st("ngModel",n.name),P("name","debtName"+t),u(4),st("ngModel",n.currentBalance),P("name","debtBalance"+t),u(6),st("ngModel",n.monthlyPayment),P("name","debtPayment"+t),u(6),st("ngModel",n.interestRate),P("name","debtInterest"+t)}}function Kz(e,i){if(e&1){let n=ue();s(0,"div",78)(1,"mat-card",24)(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),d(5,"credit_card"),c(),d(6," Debt Management "),c(),s(7,"mat-card-subtitle"),d(8,"Plan your debt payments for the year"),c()(),s(9,"mat-card-content")(10,"div",79),N(11,Xz,26,8,"div",80),s(12,"button",71),F("click",function(){R(n);let r=v();return B(r.addDebt())}),s(13,"mat-icon"),d(14,"add"),c(),d(15," Add Debt "),c()()()()()}if(e&2){let n=v();u(11),P("ngForOf",n.yearlyBudget.debts)}}function Zz(e,i){if(e&1&&(s(0,"div",89)(1,"span"),d(2),c(),s(3,"span"),d(4),ce(5,"currency"),c()()),e&2){let n=i.$implicit,t=v(2);u(2),ne("",n.name,":"),u(2),L(xe(5,2,t.getCategoryBudget(n.id||"")))}}function Qz(e,i){if(e&1&&(s(0,"div",89)(1,"span"),d(2),c(),s(3,"span"),d(4),ce(5,"currency"),c()()),e&2){let n=i.$implicit;u(2),ne("",n.name,":"),u(2),L(xe(5,2,n.monthlyContribution*12))}}function Jz(e,i){if(e&1&&(s(0,"div",89)(1,"span"),d(2),c(),s(3,"span"),d(4),ce(5,"currency"),c()()),e&2){let n=i.$implicit;u(2),ne("",n.name,":"),u(2),L(xe(5,2,n.monthlyPayment*12))}}function ej(e,i){if(e&1&&(s(0,"div",84)(1,"mat-card",24)(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),d(5,"assessment"),c(),d(6," Budget Summary "),c(),s(7,"mat-card-subtitle"),d(8,"Review your complete yearly budget breakdown"),c()(),s(9,"mat-card-content")(10,"div",85)(11,"div",86)(12,"h3"),d(13,"Income"),c(),s(14,"div",87),d(15),ce(16,"currency"),c(),s(17,"div",88)(18,"div",89)(19,"span"),d(20,"Total Yearly Income:"),c(),s(21,"span"),d(22),ce(23,"currency"),c()()()(),s(24,"div",90)(25,"h3"),d(26,"Expenses"),c(),s(27,"div",87),d(28),ce(29,"currency"),c(),s(30,"div",88),N(31,Zz,6,4,"div",91),c()(),s(32,"div",92)(33,"h3"),d(34,"Savings"),c(),s(35,"div",87),d(36),ce(37,"currency"),c(),s(38,"div",88),N(39,Qz,6,4,"div",91),c()(),s(40,"div",93)(41,"h3"),d(42,"Debt Payments"),c(),s(43,"div",87),d(44),ce(45,"currency"),c(),s(46,"div",88),N(47,Jz,6,4,"div",91),c()()(),s(48,"div",94)(49,"div",95)(50,"span",44),d(51,"Total Income:"),c(),s(52,"span",96),d(53),ce(54,"currency"),c()(),s(55,"div",95)(56,"span",44),d(57,"Total Expenses:"),c(),s(58,"span",97),d(59),ce(60,"currency"),c()(),s(61,"div",95)(62,"span",44),d(63,"Total Savings:"),c(),s(64,"span",98),d(65),ce(66,"currency"),c()(),s(67,"div",95)(68,"span",44),d(69,"Total Debt Payments:"),c(),s(70,"span",99),d(71),ce(72,"currency"),c()(),s(73,"div",100)(74,"span",44),d(75,"Net Balance:"),c(),s(76,"span",45),d(77),ce(78,"currency"),c()()()()()()),e&2){let n=v();u(15),L(xe(16,17,n.yearlyBudget.totalIncome)),u(7),L(xe(23,19,n.yearlyBudget.totalIncome)),u(6),L(xe(29,21,n.getTotalAllocated())),u(3),P("ngForOf",n.getExpenseCategories()),u(5),L(xe(37,23,n.getTotalSavings())),u(3),P("ngForOf",n.yearlyBudget.savingsGoals),u(5),L(xe(45,25,n.getTotalDebtPayments())),u(3),P("ngForOf",n.yearlyBudget.debts),u(6),L(xe(54,27,n.yearlyBudget.totalIncome)),u(6),L(xe(60,29,n.getTotalAllocated())),u(6),L(xe(66,31,n.getTotalSavings())),u(6),L(xe(72,33,n.getTotalDebtPayments())),u(5),ze("positive",n.getNetBalance()>=0)("negative",n.getNetBalance()<0),u(),ne(" ",xe(78,35,n.getNetBalance())," ")}}function tj(e,i){if(e&1&&(s(0,"div",106)(1,"mat-icon",107),d(2,"check_circle"),c(),s(3,"p"),d(4),ce(5,"currency"),c()()),e&2){let n=v(2);u(4),ne("Great! Your budget is balanced. You have ",xe(5,1,n.getNetBalance())," remaining for additional savings or expenses.")}}function nj(e,i){if(e&1&&(s(0,"div",108)(1,"mat-icon",109),d(2,"warning"),c(),s(3,"p"),d(4),ce(5,"currency"),c()()),e&2){let n=v(2);u(4),ne("Your expenses exceed your income by ",xe(5,1,n.Math.abs(n.getNetBalance())),". Consider adjusting your budget.")}}function ij(e,i){if(e&1&&(s(0,"div",112)(1,"h4"),d(2),c(),s(3,"div",113)(4,"div",114)(5,"span"),d(6,"Income:"),c(),s(7,"span"),d(8),ce(9,"currency"),c()(),s(10,"div",114)(11,"span"),d(12,"Expenses:"),c(),s(13,"span"),d(14),ce(15,"currency"),c()(),s(16,"div",114)(17,"span"),d(18,"Savings:"),c(),s(19,"span"),d(20),ce(21,"currency"),c()(),s(22,"div",114)(23,"span"),d(24,"Debt:"),c(),s(25,"span"),d(26),ce(27,"currency"),c()(),s(28,"div",115)(29,"span"),d(30,"Balance:"),c(),s(31,"span"),d(32),ce(33,"currency"),c()()()()),e&2){let n=i.$implicit,t=i.index,r=v(3);u(2),L(r.getMonthName(t)),u(6),L(xe(9,10,n.income)),u(6),L(xe(15,12,n.expenses)),u(6),L(xe(21,14,n.savings)),u(6),L(xe(27,16,n.debt)),u(5),ze("positive",n.balance>=0)("negative",n.balance<0),u(),ne(" ",xe(33,18,n.balance)," ")}}function rj(e,i){if(e&1&&(s(0,"div",31)(1,"h3"),d(2,"Monthly Breakdown"),c(),s(3,"div",110),N(4,ij,34,20,"div",111),c()()),e&2){let n=v(2);u(4),P("ngForOf",n.getMonthlyBreakdown())}}function aj(e,i){if(e&1){let n=ue();s(0,"div",101)(1,"mat-card",24)(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),d(5,"check_circle"),c(),d(6," Review & Save "),c(),s(7,"mat-card-subtitle"),d(8,"Review your budget and save it for the year"),c()(),s(9,"mat-card-content")(10,"div",102),N(11,tj,6,3,"div",103)(12,nj,6,3,"ng-template",null,0,O1),s(14,"div",104)(15,"mat-checkbox",105),lt("ngModelChange",function(r){R(n);let a=v();return ct(a.showMonthlyView,r)||(a.showMonthlyView=r),B(r)}),d(16," Show monthly breakdown view "),c()(),N(17,rj,5,1,"div",29),c()()()()}if(e&2){let n=bn(13),t=v();u(11),P("ngIf",t.getNetBalance()>=0)("ngIfElse",n),u(4),st("ngModel",t.showMonthlyView),u(2),P("ngIf",t.showMonthlyView)}}function oj(e,i){if(e&1){let n=ue();s(0,"button",116),F("click",function(){R(n);let r=v();return B(r.saveYearlyBudget())}),s(1,"mat-icon"),d(2,"save"),c(),d(3," Save Complete Yearly Budget "),c()}if(e&2){let n=v();P("disabled",n.getNetBalance()<0||n.getTotalAllocated()===0)}}var c2=(()=>{let i=class i{constructor(t,r,a,o,l){this.auth=t,this.router=r,this.notificationService=a,this.store=o,this.dateService=l,this.userId="",this.budgets=[],this.categories=[],this.newBudget={budgetId:"",userId:"",category:"Groceries",limit:0,spent:0,startDate:ei.fromDate(new Date),endDate:ei.fromDate(new Date)},this.categoryBudgets={},this.showCategorySliders=!0,this.startDateModel=new Date,this.endDateModel=new Date,this.currentStep=1,this.totalSteps=6,this.showMonthlyView=!1,this.inputMode="slider",this.yearlyBudget={totalIncome:0,splitByMonth:!1,savingsGoals:[],debts:[]},this.Math=Math,this.destroy$=new Bt,this.subscriptions=new Ri,this.budgets$=this.store.select(a2),this.budgetsLoading$=this.store.select(o2),this.budgetsError$=this.store.select(s2),this.categories$=this.store.select(un),this.categoriesLoading$=this.store.select(Nr),this.monthlyIncome$=this.store.select(W_)}ngOnInit(){this.loadBudgets(),this.loadCategories(),this.subscribeToStoreData(),this.loadProfileIncome()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.destroy$.next(),this.destroy$.complete()}nextStep(){this.currentStep<this.totalSteps&&this.currentStep++}previousStep(){this.currentStep>1&&this.currentStep--}calculateMonthlyIncome(){}updateYearlyIncome(){this.ensureBudgetLimit()}addSavingsGoal(){this.yearlyBudget.savingsGoals.push({name:"",targetAmount:0,monthlyContribution:0})}removeSavingsGoal(t){this.yearlyBudget.savingsGoals.splice(t,1)}getTotalSavings(){return this.yearlyBudget.savingsGoals.reduce((t,r)=>t+r.monthlyContribution*12,0)}addDebt(){this.yearlyBudget.debts.push({name:"",currentBalance:0,monthlyPayment:0,interestRate:0})}removeDebt(t){this.yearlyBudget.debts.splice(t,1)}getTotalDebtPayments(){return this.yearlyBudget.debts.reduce((t,r)=>t+r.monthlyPayment*12,0)}getCategoryBudget(t){return this.categoryBudgets[t]||0}getCategoryPercentage(t){return this.yearlyBudget.totalIncome===0?0:this.getCategoryBudget(t)*12/this.yearlyBudget.totalIncome*100}getCategoryMonthly(t){return this.getCategoryBudget(t)}getTotalAllocated(){return Object.values(this.categoryBudgets).reduce((t,r)=>t+r,0)*12}ensureBudgetLimit(){let t=this.getTotalAllocated();if(t>this.yearlyBudget.totalIncome){let r=t-this.yearlyBudget.totalIncome;this.adjustAllCategories(r)}}adjustAllCategories(t){let r=this.getTotalAllocated();r!==0&&Object.keys(this.categoryBudgets).forEach(a=>{let o=this.categoryBudgets[a]||0,l=o*12/r,m=t*l/12;this.categoryBudgets[a]=Math.max(0,o-m)})}getRemainingBudget(){return this.yearlyBudget.totalIncome-this.getTotalAllocated()-this.getTotalSavings()-this.getTotalDebtPayments()}getNetBalance(){return this.yearlyBudget.totalIncome-this.getTotalAllocated()-this.getTotalSavings()-this.getTotalDebtPayments()}getMonthlyBreakdown(){let t=this.yearlyBudget.totalIncome/12,r=this.getTotalAllocated()/12,a=this.getTotalSavings()/12,o=this.getTotalDebtPayments()/12,l=t-r-a-o;return Array(12).fill(null).map(()=>({income:t,expenses:r,savings:a,debt:o,balance:l}))}getMonthName(t){return["January","February","March","April","May","June","July","August","September","October","November","December"][t]}saveYearlyBudget(){this.getExpenseCategories().forEach(t=>{let r=this.getCategoryBudget(t.id||"");if(r>0){let a=r*12;this.createBudgetForCategory(t.name,a,t)}}),this.notificationService.success("Yearly budget saved successfully!"),this.currentStep=1}loadBudgets(){let t=this.auth.currentUser;t&&(this.userId=t.uid,this.store.dispatch(Ha({userId:this.userId})))}loadCategories(){let t=this.auth.currentUser;t&&this.store.dispatch(Xi({userId:t.uid}))}subscribeToStoreData(){this.subscriptions.add(this.budgets$.subscribe(t=>{this.budgets=t,this.updateCategoryBudgets()})),this.subscriptions.add(this.categories$.subscribe(t=>{this.categories=t,this.initializeCategoryBudgets()})),this.subscriptions.add(this.budgetsError$.subscribe(t=>{t&&(console.error("Error loading budgets:",t),this.notificationService.error("Failed to load budgets"))}))}loadProfileIncome(){this.subscriptions.add(this.monthlyIncome$.pipe(yt(this.destroy$)).subscribe(t=>{t>0&&this.yearlyBudget.totalIncome===0&&(this.yearlyBudget.totalIncome=t*12)}))}useProfileIncome(t){this.yearlyBudget.totalIncome=t*12,this.notificationService.success("Profile income applied to yearly budget")}initializeCategoryBudgets(){this.getExpenseCategories().forEach(t=>{let r=this.budgets.find(a=>a.category===t.name);this.categoryBudgets[t.id||""]=r?r.limit/12:0})}updateCategoryBudgets(){this.getExpenseCategories().forEach(t=>{let r=this.budgets.find(a=>a.category===t.name);r&&(this.categoryBudgets[t.id||""]=r.limit/12)})}onCategoryBudgetChange(t,r){let a=this.getTotalAllocated(),o=this.categoryBudgets[t]||0,l=(r-o)*12;if(a+l>this.yearlyBudget.totalIncome){let m=a+l-this.yearlyBudget.totalIncome;this.categoryBudgets[t]=r,this.adjustOtherCategories(t,m)}else this.categoryBudgets[t]=r;this.saveCategoryBudget(t)}onCategoryBudgetInputChange(t,r){let a=Number(r.target.value)||0;this.onCategoryBudgetChange(t,a)}onInputModeChange(){console.log("Input mode changed to:",this.inputMode)}adjustOtherCategories(t,r){let a=Object.keys(this.categoryBudgets).filter(l=>l!==t),o=a.reduce((l,m)=>l+(this.categoryBudgets[m]||0),0);if(o===0){this.categoryBudgets[t]=Math.max(0,this.categoryBudgets[t]-r/12);return}a.forEach(l=>{let m=this.categoryBudgets[l]||0,g=m/o,f=r*g/12;this.categoryBudgets[l]=Math.max(0,m-f)})}saveCategoryBudget(t){let r=this.categories.find(m=>m.id===t);if(!r)return;let o=this.categoryBudgets[t]*12,l=this.budgets.find(m=>m.category===r.name);l?this.updateBudgetLimit(l.budgetId,o):this.createBudgetForCategory(r.name,o,r)}createBudgetForCategory(t,r,a){let o=this.auth.currentUser;if(o&&r>0){let l={budgetId:`${o.uid}-${t}-${new Date().getTime()}`,userId:o.uid,category:t,limit:r,spent:0,startDate:ei.fromDate(new Date),endDate:ei.fromDate(new Date(new Date().getFullYear(),11,31))};this.store.dispatch(ys({userId:o.uid,budget:l})),a.id&&a.type===Lt.EXPENSE&&this.store.dispatch(aa({userId:this.userId,categoryId:a.id,name:a.name,categoryType:a.type,icon:a.icon,color:a.color,budgetData:{hasBudget:!0,budgetAmount:r/12,budgetPeriod:"monthly",budgetStartDate:ei.fromDate(new Date),budgetEndDate:ei.fromDate(new Date(new Date().getFullYear(),11,31)),budgetAlertThreshold:80,budgetAlertEnabled:!0}})),this.notificationService.success(`Budget created for ${t}`)}}updateBudgetLimit(t,r){let a=this.auth.currentUser;if(a){let o=this.budgets.find(l=>l.budgetId===t);if(o){let l=le(oe({},o),{limit:r});this.store.dispatch(Bc({userId:a.uid,budgetId:t,budget:l})),this.notificationService.success(`Budget limit updated for ${o.category}`)}}}getBudgetForCategory(t){return this.budgets.find(r=>r.category===t)}getSpentForCategory(t){let r=this.getBudgetForCategory(t);return(r==null?void 0:r.spent)||0}getProgressPercentage(t){let r=this.getBudgetForCategory(t);return!r||r.limit===0?0:Math.min(r.spent/r.limit*100,100)}getProgressColor(t){return t>=90?"warn":t>=75?"accent":"primary"}createBudget(){if(!this.newBudget.category||!this.newBudget.limit){this.notificationService.warning("Please fill in all required fields");return}if(this.newBudget.limit<=0){this.notificationService.warning("Budget limit must be greater than 0");return}let t=this.auth.currentUser;t&&(this.newBudget.userId=t.uid,this.newBudget.budgetId=`${this.newBudget.userId}-${new Date().getTime()}`,this.newBudget.startDate=ei.fromDate(this.startDateModel),this.newBudget.endDate=ei.fromDate(this.endDateModel),this.store.dispatch(ys({userId:t.uid,budget:this.newBudget})),this.notificationService.success("Budget created successfully"),this.newBudget={budgetId:"",userId:"",category:"Groceries",limit:0,spent:0,startDate:ei.fromDate(new Date),endDate:ei.fromDate(new Date)},this.startDateModel=new Date,this.endDateModel=new Date)}deleteBudget(t){let r=this.auth.currentUser;r&&(this.store.dispatch(Nc({userId:r.uid,budgetId:t})),this.notificationService.success("Budget deleted successfully"))}updateSpent(t,r){if(r<0){this.notificationService.warning("Spent amount cannot be negative");return}let a=this.auth.currentUser;a&&(this.store.dispatch(Lc({userId:a.uid,budgetId:t,amount:r})),this.notificationService.success("Budget spent amount updated successfully"))}toggleCategorySliders(){this.showCategorySliders=!this.showCategorySliders}trackByCategoryId(t,r){return r.id||""}trackByBudgetId(t,r){return r.budgetId}getExpenseCategories(){return this.categories.filter(t=>t.type===Lt.EXPENSE)}updateAllCategoryBudgets(){this.getExpenseCategories().forEach(t=>{let r=t.id||"",a=this.categoryBudgets[r];a!==void 0&&a>0&&this.saveCategoryBudget(r)}),this.notificationService.success("All category budgets updated successfully!")}resetAllCategoryBudgets(){this.getExpenseCategories().forEach(t=>{let r=t.id||"";this.categoryBudgets[r]=0}),this.updateAllCategoryBudgets(),this.notificationService.info("All category budgets reset to zero")}distributeRemainingBudget(){let t=this.getRemainingBudget(),r=this.getExpenseCategories();if(t<=0||r.length===0){this.notificationService.warning("No remaining budget to distribute or no expense categories available");return}let a=t/12,o=a/r.length;r.forEach(l=>{let m=l.id||"";this.categoryBudgets[m]=o}),this.updateAllCategoryBudgets(),this.notificationService.success(`Distributed ${a.toFixed(2)} monthly budget equally among ${r.length} categories`)}};i.\u0275fac=function(r){return new(r||i)(Y(xt),Y(nn),Y(ft),Y(pt),Y(Vt))},i.\u0275cmp=Re({type:i,selectors:[["app-budgets"]],decls:34,vars:17,consts:[["negativeBalance",""],[1,"yearly-budget-container"],[1,"welcome-section"],[1,"welcome-card"],[1,"welcome-header"],[1,"main-headline"],[1,"subtext"],[1,"progress-section"],[1,"progress-info"],[1,"progress-text"],[1,"progress-percentage"],["color","primary",1,"setup-progress",3,"value"],["class","income-section",4,"ngIf"],["class","expense-planning-section",4,"ngIf"],["class","savings-section",4,"ngIf"],["class","debt-section",4,"ngIf"],["class","budget-summary-section",4,"ngIf"],["class","review-section",4,"ngIf"],[1,"navigation-section"],[1,"nav-buttons"],["mat-stroked-button","",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-raised-button","","color","accent",3,"disabled","click",4,"ngIf"],[1,"income-section"],[1,"section-card"],[1,"income-form"],[1,"total-income-section"],["appearance","fill",1,"full-width"],["matInput","","type","number","name","totalIncome","required","","min","0",3,"ngModelChange","input","ngModel"],["class","monthly-breakdown",4,"ngIf"],["name","splitByMonth",3,"ngModelChange","ngModel"],[1,"monthly-breakdown"],[1,"breakdown-text"],[1,"expense-planning-section"],[1,"input-mode-toggle"],[3,"valueChange","change","value"],["value","slider"],["value","input"],[1,"mode-info"],[1,"mode-description"],[1,"categories-container"],["class","category-row",4,"ngFor","ngForOf","ngForTrackBy"],[1,"budget-summary"],[1,"summary-row"],[1,"label"],[1,"amount"],["class","budget-warning",4,"ngIf"],[1,"budget-actions"],["mat-stroked-button","","color","primary",3,"click","disabled"],["mat-stroked-button","","color","accent",3,"click","disabled"],["mat-stroked-button","","color","warn",3,"click"],[1,"category-row"],[1,"category-info"],[1,"category-icon"],[1,"category-name"],["class","category-slider-container",4,"ngIf"],[1,"category-budget-info"],["class","budget-input-container",4,"ngIf"],[1,"budget-details"],[1,"budget-percentage"],[1,"budget-monthly"],[1,"category-slider-container"],[1,"budget-slider",3,"max","min","step"],["matSliderThumb","",3,"ngModelChange","input","ngModel"],[1,"budget-input-container"],["appearance","fill",1,"budget-input"],["matInput","","type","number","min","0","step","50",3,"input","value","max"],[1,"budget-warning"],[1,"savings-section"],[1,"savings-goals"],["class","savings-goal-item",4,"ngFor","ngForOf"],["mat-stroked-button","","color","primary",3,"click"],[1,"savings-goal-item"],["appearance","outline"],["matInput","","placeholder","e.g., Emergency Fund, Vacation, Down Payment",3,"ngModelChange","ngModel","name"],["matInput","","type","number","min","0",3,"ngModelChange","ngModel","name"],["matSuffix",""],["mat-icon-button","","color","warn",3,"click"],[1,"debt-section"],[1,"debt-items"],["class","debt-item",4,"ngFor","ngForOf"],[1,"debt-item"],["matInput","","placeholder","e.g., Credit Card, Student Loan, Car Loan",3,"ngModelChange","ngModel","name"],["matInput","","type","number","min","0","max","100","step","0.1",3,"ngModelChange","ngModel","name"],[1,"budget-summary-section"],[1,"summary-grid"],[1,"summary-card","income-summary"],[1,"summary-amount"],[1,"summary-breakdown"],[1,"breakdown-item"],[1,"summary-card","expenses-summary"],["class","breakdown-item",4,"ngFor","ngForOf"],[1,"summary-card","savings-summary"],[1,"summary-card","debt-summary"],[1,"final-summary"],[1,"summary-row","total-row"],[1,"amount","income"],[1,"amount","expenses"],[1,"amount","savings"],[1,"amount","debt"],[1,"summary-row","total-row","final-balance"],[1,"review-section"],[1,"review-content"],["class","review-message",4,"ngIf","ngIfElse"],[1,"monthly-view-toggle"],["name","showMonthlyView",3,"ngModelChange","ngModel"],[1,"review-message"],[1,"success-icon"],[1,"review-message","warning"],[1,"warning-icon"],[1,"monthly-grid"],["class","month-item",4,"ngFor","ngForOf"],[1,"month-item"],[1,"month-details"],[1,"month-row"],[1,"month-row","balance"],["mat-raised-button","","color","accent",3,"click","disabled"]],template:function(r,a){r&1&&(s(0,"div",1)(1,"div",2)(2,"mat-card",3)(3,"mat-card-content")(4,"div",4)(5,"h1",5),d(6,"Plan Your Yearly Budget"),c(),s(7,"p",6),d(8,"Set your income, allocate expenses, track savings and debt all in one place."),c()(),s(9,"div",7)(10,"div",8)(11,"span",9),d(12),c(),s(13,"span",10),d(14),ce(15,"number"),c()(),re(16,"mat-progress-bar",11),c()()()(),N(17,zz,19,3,"div",12)(18,Gz,54,20,"div",13)(19,qz,16,1,"div",14)(20,Kz,16,1,"div",15)(21,ej,79,37,"div",16)(22,aj,18,4,"div",17),s(23,"div",18)(24,"div",19)(25,"button",20),F("click",function(){return a.previousStep()}),s(26,"mat-icon"),d(27,"arrow_back"),c(),d(28," Previous "),c(),s(29,"button",21),F("click",function(){return a.nextStep()}),s(30,"mat-icon"),d(31,"arrow_forward"),c(),d(32),c(),N(33,oj,4,1,"button",22),c()()()),r&2&&(u(12),$t("Step ",a.currentStep," of ",a.totalSteps,""),u(2),ne("",ht(15,14,a.currentStep/a.totalSteps*100,"1.0-0"),"% Complete"),u(2),P("value",a.currentStep/a.totalSteps*100),u(),P("ngIf",a.currentStep>=1),u(),P("ngIf",a.currentStep>=2),u(),P("ngIf",a.currentStep>=3),u(),P("ngIf",a.currentStep>=4),u(),P("ngIf",a.currentStep>=5),u(),P("ngIf",a.currentStep>=6),u(3),P("disabled",a.currentStep<=1),u(4),P("disabled",a.currentStep>=a.totalSteps),u(3),ne(" ",a.currentStep>=a.totalSteps?"Complete":"Next"," "),u(),P("ngIf",a.currentStep>=a.totalSteps))},dependencies:[or,dt,Nt,Ui,At,fc,jo,zo,Jn,ji,bx,Mx,yx,vx,Jt,gn,Qe,Lx,Oi,Lr,$a,cm,lm,da,za,Vx,Ux,Vo,Sr],styles:[".yearly-budget-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto;min-height:100vh}.welcome-section[_ngcontent-%COMP%]{margin-bottom:32px}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:16px;overflow:hidden}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:40px}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]   .welcome-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]   .welcome-header[_ngcontent-%COMP%]   .main-headline[_ngcontent-%COMP%]{font-size:36px;font-weight:700;margin:0 0 16px;text-shadow:0 2px 4px rgba(0,0,0,.1)}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]   .welcome-header[_ngcontent-%COMP%]   .subtext[_ngcontent-%COMP%]{font-size:18px;opacity:.9;margin:0;line-height:1.6}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]   .progress-section[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]   .progress-section[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]   .progress-section[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]   .progress-percentage[_ngcontent-%COMP%]{font-size:14px;opacity:.8}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]   .progress-section[_ngcontent-%COMP%]   .setup-progress[_ngcontent-%COMP%]{height:8px;border-radius:4px}.section-card[_ngcontent-%COMP%]{margin-bottom:24px;border-radius:12px;box-shadow:0 4px 12px #0000001a;transition:all .3s ease}.section-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 24px #00000026;transform:translateY(-2px)}.section-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{padding:24px 24px 16px;border-bottom:1px solid rgba(0,0,0,.08)}.section-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:24px;font-weight:600;color:#333}.section-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}.section-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{color:#666;font-size:16px;margin-top:8px}.section-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:24px}.income-section[_ngcontent-%COMP%]   .income-form[_ngcontent-%COMP%]   .total-income-section[_ngcontent-%COMP%]{margin-bottom:32px}.income-section[_ngcontent-%COMP%]   .income-form[_ngcontent-%COMP%]   .total-income-section[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.income-section[_ngcontent-%COMP%]   .income-form[_ngcontent-%COMP%]   .total-income-section[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]{margin-top:16px;padding:16px;background:#f8f9fa;border-radius:8px;border-left:4px solid #2196f3}.income-section[_ngcontent-%COMP%]   .income-form[_ngcontent-%COMP%]   .total-income-section[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   .breakdown-text[_ngcontent-%COMP%]{margin:0;font-size:16px;color:#333;font-weight:500}.income-section[_ngcontent-%COMP%]   .income-form[_ngcontent-%COMP%]   .total-income-section[_ngcontent-%COMP%]   .profile-income-info[_ngcontent-%COMP%]{margin-top:12px}.income-section[_ngcontent-%COMP%]   .income-form[_ngcontent-%COMP%]   .total-income-section[_ngcontent-%COMP%]   .profile-income-info[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin:0;padding:12px;background:#e3f2fd;border-radius:6px;border-left:3px solid #1976d2;font-size:14px;color:#1565c0;font-weight:500;flex-wrap:wrap}.income-section[_ngcontent-%COMP%]   .income-form[_ngcontent-%COMP%]   .total-income-section[_ngcontent-%COMP%]   .profile-income-info[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#1976d2}.income-section[_ngcontent-%COMP%]   .income-form[_ngcontent-%COMP%]   .total-income-section[_ngcontent-%COMP%]   .profile-income-info[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto;font-size:12px;padding:4px 12px;min-width:auto;height:28px;line-height:20px}.expense-planning-section[_ngcontent-%COMP%]   .input-mode-toggle[_ngcontent-%COMP%]{margin-bottom:24px;text-align:center}.expense-planning-section[_ngcontent-%COMP%]   .input-mode-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.expense-planning-section[_ngcontent-%COMP%]   .input-mode-toggle[_ngcontent-%COMP%]   .mode-info[_ngcontent-%COMP%]{margin-top:16px}.expense-planning-section[_ngcontent-%COMP%]   .input-mode-toggle[_ngcontent-%COMP%]   .mode-info[_ngcontent-%COMP%]   .mode-description[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;margin:0;font-size:14px;color:#666;font-style:italic}.expense-planning-section[_ngcontent-%COMP%]   .input-mode-toggle[_ngcontent-%COMP%]   .mode-info[_ngcontent-%COMP%]   .mode-description[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#2196f3}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]{margin-bottom:24px}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:200px 1fr 150px;gap:16px;align-items:center;padding:10px 16px;border-bottom:1px solid rgba(0,0,0,.08);transition:all .3s ease}@media (max-width: 768px){.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px;padding:8px 12px}}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]:hover{background:#2196f30d;border-radius:6px}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#333}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-slider-container[_ngcontent-%COMP%]   .budget-slider[_ngcontent-%COMP%]{width:100%}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-budget-info[_ngcontent-%COMP%]{text-align:right}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-budget-info[_ngcontent-%COMP%]   .budget-input-container[_ngcontent-%COMP%]{margin-bottom:8px}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-budget-info[_ngcontent-%COMP%]   .budget-input-container[_ngcontent-%COMP%]   .budget-input[_ngcontent-%COMP%]{width:120px}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-budget-info[_ngcontent-%COMP%]   .budget-input-container[_ngcontent-%COMP%]   .budget-input[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-budget-info[_ngcontent-%COMP%]   .budget-input-container[_ngcontent-%COMP%]   .budget-input[_ngcontent-%COMP%]     .mat-mdc-text-field-wrapper{padding:0 8px}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-budget-info[_ngcontent-%COMP%]   .budget-input-container[_ngcontent-%COMP%]   .budget-input[_ngcontent-%COMP%]     .mat-mdc-form-field-infix{padding:8px 0;min-height:auto}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-budget-info[_ngcontent-%COMP%]   .budget-input-container[_ngcontent-%COMP%]   .budget-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:right;font-weight:600;color:#2196f3}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-budget-info[_ngcontent-%COMP%]   .budget-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1px}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-budget-info[_ngcontent-%COMP%]   .budget-details[_ngcontent-%COMP%]   .budget-percentage[_ngcontent-%COMP%]{font-size:12px;color:#666;font-weight:500}.expense-planning-section[_ngcontent-%COMP%]   .categories-container[_ngcontent-%COMP%]   .category-row[_ngcontent-%COMP%]   .category-budget-info[_ngcontent-%COMP%]   .budget-details[_ngcontent-%COMP%]   .budget-monthly[_ngcontent-%COMP%]{font-size:12px;color:#4caf50;font-weight:600}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]{padding:20px;background:#f8f9fa;border-radius:12px;border-left:4px solid #4caf50;transition:all .3s ease}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary.over-budget[_ngcontent-%COMP%]{border-left-color:#f44336;background:#fff5f5}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]:last-child{margin-bottom:0;padding-top:12px;border-top:1px solid rgba(0,0,0,.1);font-weight:600;font-size:18px}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:16px;color:#333}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600;font-size:18px;color:#4caf50;transition:color .3s ease}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .amount.negative[_ngcontent-%COMP%]{color:#f44336}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .amount.over-budget[_ngcontent-%COMP%]{color:#f44336;font-weight:700}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .budget-warning[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:12px;padding:12px;background:#fff3cd;border:1px solid #ffeaa7;border-radius:8px;color:#856404}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .budget-warning[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f39c12;font-size:20px;width:20px;height:20px}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .budget-warning[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .budget-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:20px;padding-top:20px;border-top:1px solid rgba(0,0,0,.1);flex-wrap:wrap}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .budget-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;border-radius:8px;font-weight:500;transition:all .2s ease}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .budget-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .budget-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.expense-planning-section[_ngcontent-%COMP%]   .budget-summary[_ngcontent-%COMP%]   .budget-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none;box-shadow:none}.savings-section[_ngcontent-%COMP%]   .savings-goals[_ngcontent-%COMP%]   .savings-goal-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr 1fr auto;gap:16px;align-items:center;padding:16px;border:1px solid rgba(0,0,0,.08);border-radius:8px;margin-bottom:12px;background:#fafafa;transition:all .3s ease}.savings-section[_ngcontent-%COMP%]   .savings-goals[_ngcontent-%COMP%]   .savings-goal-item[_ngcontent-%COMP%]:hover{background:#f5f5f5;border-color:#4caf50}@media (max-width: 768px){.savings-section[_ngcontent-%COMP%]   .savings-goals[_ngcontent-%COMP%]   .savings-goal-item[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}}.savings-section[_ngcontent-%COMP%]   .savings-goals[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:16px}.debt-section[_ngcontent-%COMP%]   .debt-items[_ngcontent-%COMP%]   .debt-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr 1fr 1fr auto;gap:16px;align-items:center;padding:16px;border:1px solid rgba(0,0,0,.08);border-radius:8px;margin-bottom:12px;background:#fafafa;transition:all .3s ease}.debt-section[_ngcontent-%COMP%]   .debt-items[_ngcontent-%COMP%]   .debt-item[_ngcontent-%COMP%]:hover{background:#f5f5f5;border-color:#ff9800}@media (max-width: 768px){.debt-section[_ngcontent-%COMP%]   .debt-items[_ngcontent-%COMP%]   .debt-item[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}}.debt-section[_ngcontent-%COMP%]   .debt-items[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:16px}.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:32px}@media (max-width: 768px){.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{padding:20px;border-radius:12px;border-left:4px solid;background:#fafafa;transition:all .3s ease}.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-card.income-summary[_ngcontent-%COMP%]{border-left-color:#4caf50}.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-card.expenses-summary[_ngcontent-%COMP%]{border-left-color:#ff9800}.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-card.savings-summary[_ngcontent-%COMP%]{border-left-color:#2196f3}.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-card.debt-summary[_ngcontent-%COMP%]{border-left-color:#f44336}.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin:0 0 16px;color:#333}.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-amount[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin-bottom:16px;color:#333}.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-breakdown[_ngcontent-%COMP%]   .breakdown-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;font-size:14px}.budget-summary-section[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-breakdown[_ngcontent-%COMP%]   .breakdown-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]{padding:24px;background:#f8f9fa;border-radius:12px;border-left:4px solid #333}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;font-size:16px}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]:last-child{margin-bottom:0;padding-top:16px;border-top:2px solid rgba(0,0,0,.1);font-weight:700;font-size:20px}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row.total-row[_ngcontent-%COMP%]{font-weight:500}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row.final-balance[_ngcontent-%COMP%]{font-size:24px;font-weight:700}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#333}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .amount.income[_ngcontent-%COMP%]{color:#4caf50}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .amount.expenses[_ngcontent-%COMP%]{color:#ff9800}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .amount.savings[_ngcontent-%COMP%]{color:#2196f3}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .amount.debt[_ngcontent-%COMP%]{color:#f44336}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .amount.positive[_ngcontent-%COMP%]{color:#4caf50}.budget-summary-section[_ngcontent-%COMP%]   .final-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .amount.negative[_ngcontent-%COMP%]{color:#f44336}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .review-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:20px;border-radius:12px;margin-bottom:24px;background:#e8f5e8;border-left:4px solid #4caf50}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .review-message.warning[_ngcontent-%COMP%]{background:#fff3e0;border-left-color:#ff9800}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .review-message[_ngcontent-%COMP%]   .success-icon[_ngcontent-%COMP%]{color:#4caf50;font-size:24px;width:24px;height:24px}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .review-message[_ngcontent-%COMP%]   .warning-icon[_ngcontent-%COMP%]{color:#ff9800;font-size:24px;width:24px;height:24px}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .review-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px;color:#333}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-view-toggle[_ngcontent-%COMP%]{margin-bottom:24px}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;margin-bottom:20px;color:#333}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   .monthly-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}@media (max-width: 768px){.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   .monthly-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(150px,1fr))}}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   .monthly-grid[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]{padding:16px;border:1px solid rgba(0,0,0,.08);border-radius:8px;background:#fafafa;transition:all .3s ease}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   .monthly-grid[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]:hover{background:#f5f5f5;transform:translateY(-2px)}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   .monthly-grid[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin:0 0 12px;color:#333;text-align:center}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   .monthly-grid[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]   .month-details[_ngcontent-%COMP%]   .month-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;font-size:12px}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   .monthly-grid[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]   .month-details[_ngcontent-%COMP%]   .month-row[_ngcontent-%COMP%]:last-child{margin-bottom:0;padding-top:8px;border-top:1px solid rgba(0,0,0,.1);font-weight:600}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   .monthly-grid[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]   .month-details[_ngcontent-%COMP%]   .month-row.balance[_ngcontent-%COMP%]{font-weight:600;font-size:14px}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   .monthly-grid[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]   .month-details[_ngcontent-%COMP%]   .month-row[_ngcontent-%COMP%]   .positive[_ngcontent-%COMP%]{color:#4caf50}.review-section[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]   .monthly-breakdown[_ngcontent-%COMP%]   .monthly-grid[_ngcontent-%COMP%]   .month-item[_ngcontent-%COMP%]   .month-details[_ngcontent-%COMP%]   .month-row[_ngcontent-%COMP%]   .negative[_ngcontent-%COMP%]{color:#f44336}.navigation-section[_ngcontent-%COMP%]{margin-top:32px;padding:24px 0;border-top:1px solid rgba(0,0,0,.08)}.navigation-section[_ngcontent-%COMP%]   .nav-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:16px}@media (max-width: 768px){.navigation-section[_ngcontent-%COMP%]   .nav-buttons[_ngcontent-%COMP%]{flex-direction:column;gap:12px}}.navigation-section[_ngcontent-%COMP%]   .nav-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:120px;padding:12px 24px;font-size:16px;font-weight:500;border-radius:8px;transition:all .3s ease}.navigation-section[_ngcontent-%COMP%]   .nav-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.navigation-section[_ngcontent-%COMP%]   .nav-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}@media (max-width: 768px){.yearly-budget-container[_ngcontent-%COMP%]{padding:16px}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:24px}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]   .welcome-header[_ngcontent-%COMP%]   .main-headline[_ngcontent-%COMP%]{font-size:28px}.welcome-section[_ngcontent-%COMP%]   .welcome-card[_ngcontent-%COMP%]   .welcome-header[_ngcontent-%COMP%]   .subtext[_ngcontent-%COMP%]{font-size:16px}.section-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{padding:16px}.section-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:20px}.section-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.section-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px}}"]});let e=i;return e})();var l2=Yr(Xr());var sj=(e,i)=>i.value,cj=(e,i)=>i.code;function lj(e,i){e&1&&(s(0,"div",14),re(1,"mat-spinner",15),s(2,"p",16),d(3,"Loading profile..."),c()())}function dj(e,i){e&1&&(s(0,"mat-error"),d(1," First name is required "),c())}function mj(e,i){e&1&&(s(0,"mat-error"),d(1," First name must be at least 2 characters "),c())}function gj(e,i){e&1&&(s(0,"mat-error"),d(1," Last name is required "),c())}function uj(e,i){e&1&&(s(0,"mat-error"),d(1," Last name must be at least 2 characters "),c())}function pj(e,i){e&1&&(s(0,"mat-error"),d(1," Email is required "),c())}function fj(e,i){e&1&&(s(0,"mat-error"),d(1," Please enter a valid email "),c())}function hj(e,i){e&1&&(s(0,"mat-error"),d(1," Please enter a valid phone number "),c())}function _j(e,i){e&1&&(s(0,"mat-error"),d(1," Income cannot be negative "),c())}function xj(e,i){if(e&1&&(s(0,"mat-option",36),d(1),c()),e&2){let n=i.$implicit;P("value",n),u(),ne(" ",n," ")}}function Cj(e,i){if(e&1&&(s(0,"mat-option",36),d(1),c()),e&2){let n=i.$implicit;P("value",n.value),u(),ne(" ",n.label," ")}}function vj(e,i){if(e&1&&(s(0,"mat-option",36),d(1),c()),e&2){let n=i.$implicit;P("value",n.code),u(),ne(" ",n.name," ")}}function bj(e,i){e&1&&(s(0,"mat-icon"),d(1,"hourglass_empty"),c())}function yj(e,i){e&1&&(s(0,"mat-icon"),d(1,"save"),c())}function Mj(e,i){if(e&1){let n=ue();s(0,"div",55)(1,"button",56),F("click",function(){R(n);let r=v(2);return B(r.cancelEdit())}),d(2," Cancel "),c(),s(3,"button",57),N(4,bj,2,0,"mat-icon",25)(5,yj,2,0,"mat-icon",25),d(6),c()()}if(e&2){let n=v(2);u(),P("disabled",n.isLoading),u(2),P("disabled",n.profileForm.invalid||n.isLoading),u(),P("ngIf",n.isLoading),u(),P("ngIf",!n.isLoading),u(),ne(" ",n.isLoading?"Saving...":"Save Changes"," ")}}function Pj(e,i){if(e&1){let n=ue();s(0,"div",17)(1,"form",18),F("ngSubmit",function(){R(n);let r=v();return B(r.saveProfile())}),s(2,"div",19)(3,"div",20)(4,"mat-icon",21),d(5,"person"),c(),s(6,"h2"),d(7,"Personal Information"),c()(),s(8,"div",22)(9,"mat-form-field",23)(10,"mat-label"),d(11,"First Name *"),c(),re(12,"input",24),N(13,dj,2,0,"mat-error",25)(14,mj,2,0,"mat-error",25),c(),s(15,"mat-form-field",23)(16,"mat-label"),d(17,"Last Name *"),c(),re(18,"input",26),N(19,gj,2,0,"mat-error",25)(20,uj,2,0,"mat-error",25),c(),s(21,"mat-form-field",23)(22,"mat-label"),d(23,"Email *"),c(),re(24,"input",27),N(25,pj,2,0,"mat-error",25)(26,fj,2,0,"mat-error",25),c(),s(27,"mat-form-field",23)(28,"mat-label"),d(29,"Phone Number"),c(),re(30,"input",28),N(31,hj,2,0,"mat-error",25),c(),s(32,"mat-form-field",23)(33,"mat-label"),d(34,"Date of Birth"),c(),re(35,"input",29)(36,"mat-datepicker-toggle",30)(37,"mat-datepicker",null,0),c(),s(39,"mat-form-field",23)(40,"mat-label"),d(41,"Occupation"),c(),re(42,"input",31),c(),s(43,"mat-form-field",23)(44,"mat-label"),d(45,"Monthly Income"),c(),re(46,"input",32),s(47,"span",33),d(48),c(),N(49,_j,2,0,"mat-error",25),c()()(),s(50,"div",34)(51,"div",20)(52,"mat-icon",21),d(53,"settings"),c(),s(54,"h2"),d(55,"Preferences"),c()(),s(56,"div",22)(57,"mat-form-field",23)(58,"mat-label"),d(59,"Default Currency *"),c(),s(60,"mat-select",35),Ge(61,xj,2,2,"mat-option",36,rr),c()(),s(63,"mat-form-field",23)(64,"mat-label"),d(65,"Timezone *"),c(),s(66,"mat-select",37),Ge(67,Cj,2,2,"mat-option",36,sj),c()(),s(69,"mat-form-field",23)(70,"mat-label"),d(71,"Language *"),c(),s(72,"mat-select",38),Ge(73,vj,2,2,"mat-option",36,cj),c()()(),s(75,"div",39)(76,"div",40)(77,"mat-slide-toggle",41)(78,"span",42),d(79,"Push Notifications"),c()(),s(80,"p",43),d(81,"Receive notifications about important updates"),c()(),s(82,"div",40)(83,"mat-slide-toggle",44)(84,"span",42),d(85,"Email Updates"),c()(),s(86,"p",43),d(87,"Receive weekly financial summaries via email"),c()(),s(88,"div",40)(89,"mat-slide-toggle",45)(90,"span",42),d(91,"Budget Alerts"),c()(),s(92,"p",43),d(93,"Get notified when you exceed budget limits"),c()(),s(94,"div",40)(95,"mat-slide-toggle",46)(96,"span",42),d(97,"Category List View"),c()(),s(98,"p",43),d(99,"Display categories in list view instead of grid view"),c()()()(),N(100,Mj,7,5,"div",47),c(),s(101,"div",48)(102,"div",20)(103,"mat-icon",21),d(104,"security"),c(),s(105,"h2"),d(106,"Account Actions"),c()(),s(107,"div",49)(108,"div",50)(109,"mat-icon",51),d(110,"lock"),c(),s(111,"h3"),d(112,"Change Password"),c(),s(113,"p"),d(114,"Update your account password for better security"),c(),s(115,"button",52),F("click",function(){R(n);let r=v();return B(r.changePassword())}),d(116," Change Password "),c()(),s(117,"div",50)(118,"mat-icon",51),d(119,"download"),c(),s(120,"h3"),d(121,"Export Data"),c(),s(122,"p"),d(123,"Download all your financial data as a backup"),c(),s(124,"button",52),F("click",function(){R(n);let r=v();return B(r.exportData())}),d(125," Export Data "),c()(),s(126,"div",53)(127,"mat-icon",51),d(128,"delete_forever"),c(),s(129,"h3"),d(130,"Delete Account"),c(),s(131,"p"),d(132,"Permanently delete your account and all associated data"),c(),s(133,"button",54),F("click",function(){R(n);let r=v();return B(r.deleteAccount())}),d(134," Delete Account "),c()()()()()}if(e&2){let n,t,r,a,o,l,m,g,f=bn(38),h=v();u(),P("formGroup",h.profileForm),u(11),P("readonly",!h.isEditing),u(),P("ngIf",(n=h.profileForm.get("firstName"))==null?null:n.hasError("required")),u(),P("ngIf",(t=h.profileForm.get("firstName"))==null?null:t.hasError("minlength")),u(4),P("readonly",!h.isEditing),u(),P("ngIf",(r=h.profileForm.get("lastName"))==null?null:r.hasError("required")),u(),P("ngIf",(a=h.profileForm.get("lastName"))==null?null:a.hasError("minlength")),u(4),P("readonly",!h.isEditing),u(),P("ngIf",(o=h.profileForm.get("email"))==null?null:o.hasError("required")),u(),P("ngIf",(l=h.profileForm.get("email"))==null?null:l.hasError("email")),u(4),P("readonly",!h.isEditing),u(),P("ngIf",(m=h.profileForm.get("phone"))==null?null:m.hasError("pattern")),u(4),P("matDatepicker",f)("readonly",!h.isEditing),u(),P("for",f)("disabled",!h.isEditing),u(6),P("readonly",!h.isEditing),u(4),P("readonly",!h.isEditing),u(2),ne("",h.userProfile.preferences==null?null:h.userProfile.preferences.defaultCurrency,"\xA0"),u(),P("ngIf",(g=h.profileForm.get("monthlyIncome"))==null?null:g.hasError("min")),u(11),P("disabled",!h.isEditing),u(),He(h.currencies),u(5),P("disabled",!h.isEditing),u(),He(h.timezones),u(5),P("disabled",!h.isEditing),u(),He(h.languages),u(4),P("disabled",!h.isEditing),u(6),P("disabled",!h.isEditing),u(6),P("disabled",!h.isEditing),u(6),P("disabled",!h.isEditing),u(5),P("ngIf",h.isEditing)}}var d2=(()=>{let i=class i{constructor(t,r,a,o,l,m,g,f,h){this.fb=t,this.auth=r,this.router=a,this.notificationService=o,this.validationService=l,this.dialog=m,this.dateService=g,this.store=f,this.breakpointObserver=h,this.isLoading=!1,this.isEditing=!1,this.userProfile=null,this.currencies=Object.values(S_),this.defaultCurrency=Ut.CURRENCY.DEFAULT,this.languages=Object.entries(Ut.LANGUAGE.NAMES).map(([x,C])=>({code:x,name:C})),this.fabConfig={title:"Profile",mainButtonIcon:"edit",mainButtonColor:"primary",mainButtonTooltip:"Edit Profile",showLabels:!1,animations:!0,autoHide:!1,autoHideDelay:3e3,theme:"auto",actions:[],onMainButtonClick:()=>this.toggleEdit()},this.validation=Ut.VALIDATION,this.timezones=T_,this.isMobile=!1,this.destroy$=new Bt,this.subscriptions=new Ri,this.currentUser=this.auth.currentUser,this.isMobile=this.breakpointObserver.isMatched("(max-width: 600px)"),this.profile$=this.store.select(j_),this.profileLoading$=this.store.select($_),this.profileError$=this.store.select(Y_),this.profileForm=this.fb.group({firstName:["",this.validationService.getProfileNameValidators()],lastName:["",this.validationService.getProfileNameValidators()],email:["",this.validationService.getProfileEmailValidators()],phone:["",this.validationService.getProfilePhoneValidators()],dateOfBirth:[""],occupation:["",this.validationService.getProfileOccupationValidators()],monthlyIncome:[0,this.validationService.getProfileIncomeValidators()],preferences:this.fb.group({defaultCurrency:[this.defaultCurrency,tt.required],timezone:["UTC",tt.required],language:[Ut.LANGUAGE.DEFAULT,tt.required],notifications:[!0],emailUpdates:[!0],budgetAlerts:[!0],categoryListViewMode:[!1]})})}ngOnInit(){this.subscribeToStoreData()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.destroy$.next(),this.destroy$.complete()}subscribeToStoreData(){this.subscriptions.add(this.profile$.subscribe(t=>{t&&(this.userProfile=this.mapUserToProfile(t),this.populateForm())})),this.subscriptions.add(this.profileLoading$.subscribe(t=>{this.isLoading=t})),this.subscriptions.add(this.profileError$.subscribe(t=>{t&&(console.error("Error loading profile:",t),this.notificationService.error(ti.NETWORK.SERVER_ERROR))}))}mapUserToProfile(t){var r,a,o,l,m,g,f;return{uid:t.uid,firstName:t.firstName||"",lastName:t.lastName||"",email:t.email,phone:t.phone||"",dateOfBirth:this.dateService.toDate(t.dateOfBirth||0)||new Date,occupation:t.occupation||"",monthlyIncome:t.monthlyIncome||0,preferences:{defaultCurrency:((r=t.preferences)==null?void 0:r.defaultCurrency)||this.defaultCurrency,timezone:((a=t.preferences)==null?void 0:a.timezone)||"UTC",language:((o=t.preferences)==null?void 0:o.language)||Ut.LANGUAGE.DEFAULT,notifications:((l=t.preferences)==null?void 0:l.notifications)||!0,emailUpdates:((m=t.preferences)==null?void 0:m.emailUpdates)||!0,budgetAlerts:((g=t.preferences)==null?void 0:g.budgetAlerts)||!0,categoryListViewMode:((f=t.preferences)==null?void 0:f.categoryListViewMode)||!1},role:t.role,createdAt:t.createdAt,updatedAt:this.dateService.toTimestamp(t.updatedAt)||new Date}}populateForm(){var t,r,a,o,l,m,g;this.userProfile&&this.profileForm.patchValue({firstName:this.userProfile.firstName,lastName:this.userProfile.lastName,email:this.userProfile.email,phone:this.userProfile.phone||"",dateOfBirth:this.userProfile.dateOfBirth||"",occupation:this.userProfile.occupation||"",monthlyIncome:this.userProfile.monthlyIncome||0,preferences:{defaultCurrency:((t=this.userProfile.preferences)==null?void 0:t.defaultCurrency)||this.defaultCurrency,timezone:((r=this.userProfile.preferences)==null?void 0:r.timezone)||"UTC",language:((a=this.userProfile.preferences)==null?void 0:a.language)||Ut.LANGUAGE.DEFAULT,notifications:((o=this.userProfile.preferences)==null?void 0:o.notifications)||!0,emailUpdates:((l=this.userProfile.preferences)==null?void 0:l.emailUpdates)||!0,budgetAlerts:((m=this.userProfile.preferences)==null?void 0:m.budgetAlerts)||!0,categoryListViewMode:((g=this.userProfile.preferences)==null?void 0:g.categoryListViewMode)||!1}})}toggleEdit(){this.isEditing=!this.isEditing,this.isEditing?(this.fabConfig.mainButtonIcon="save",this.fabConfig.mainButtonTooltip="Save Profile"):this.saveProfile()}saveProfile(){return me(this,null,function*(){if(this.profileForm.invalid){this.notificationService.warning(ti.VALIDATION.REQUIRED_FIELD);return}try{this.isLoading=!0;let t=this.profileForm.value;if(this.userProfile){let r={uid:this.userProfile.uid,email:t.email,role:w_.FREE,createdAt:this.userProfile.createdAt,preferences:t.preferences,firstName:t.firstName,lastName:t.lastName,phone:t.phone,dateOfBirth:t.dateOfBirth,occupation:t.occupation,monthlyIncome:t.monthlyIncome,updatedAt:new Date};this.store.dispatch(jc({userId:this.currentUser.uid,profile:r})),this.notificationService.success(k_.GENERAL.UPDATED),this.isEditing=!1}}catch(t){console.error("Error saving profile:",t),this.notificationService.error(ti.NETWORK.SERVER_ERROR)}finally{this.isLoading=!1}})}cancelEdit(){this.populateForm(),this.isEditing=!1,this.notificationService.info("Changes cancelled")}deleteAccount(){return me(this,null,function*(){this.dialog.open(Hr,{width:"400px",data:{title:"Delete Account",message:"Are you sure you want to delete your account? This action cannot be undone and all your data will be permanently lost.",confirmText:"Delete Account",cancelText:"Cancel",confirmColor:"warn"}}).afterClosed().subscribe(r=>me(this,null,function*(){if(r)try{this.isLoading=!0,yield this.currentUser.delete(),this.notificationService.success("Account deleted successfully"),this.router.navigate(["/sign-in"])}catch(a){console.error("Error deleting account:",a),this.notificationService.error(ti.NETWORK.SERVER_ERROR)}finally{this.isLoading=!1}}))})}changePassword(){return me(this,null,function*(){this.notificationService.info("Password change feature coming soon")})}exportData(){return me(this,null,function*(){try{if(!Ut.FEATURES.EXPORT_FUNCTIONALITY){this.notificationService.warning(ti.PERMISSION.FEATURE_NOT_AVAILABLE);return}this.notificationService.info("Data export feature coming soon")}catch(t){console.error("Error exporting data:",t),this.notificationService.error(ti.NETWORK.SERVER_ERROR)}})}getFullName(){return this.userProfile?`${this.userProfile.firstName} ${this.userProfile.lastName}`.trim():"User"}getTimezoneLabel(t){let r=this.timezones.find(a=>a.value===t);return r?r.label:t}getLanguageName(t){return Ut.LANGUAGE.NAMES[t]||t}getFormattedDate(t){return t?(0,l2.default)((t==null?void 0:t.seconds)*1e3).format("MMM DD, YYYY"):"N/A"}getFirstNameError(){let t=this.profileForm.get("firstName");return t?this.validationService.getProfileNameError(t):""}getLastNameError(){let t=this.profileForm.get("lastName");return t?this.validationService.getProfileNameError(t):""}getEmailError(){let t=this.profileForm.get("email");return t?this.validationService.getProfileEmailError(t):""}getPhoneError(){let t=this.profileForm.get("phone");return t?this.validationService.getProfilePhoneError(t):""}getOccupationError(){let t=this.profileForm.get("occupation");return t?this.validationService.getProfileOccupationError(t):""}getIncomeError(){let t=this.profileForm.get("monthlyIncome");return t?this.validationService.getProfileIncomeError(t):""}};i.\u0275fac=function(r){return new(r||i)(Y(vi),Y(xt),Y(nn),Y(ft),Y(sa),Y(xn),Y(Vt),Y(pt),Y(dr))},i.\u0275cmp=Re({type:i,selectors:[["app-profile"]],decls:17,vars:6,consts:[["dobPicker",""],[3,"config"],[1,"profile-container"],["class","loading-overlay",4,"ngIf"],[1,"profile-header"],[1,"header-content"],[1,"avatar-section"],[1,"avatar"],[1,"avatar-icon"],[1,"user-info"],[1,"user-name"],[1,"user-email"],[1,"user-role"],["class","profile-content",4,"ngIf"],[1,"loading-overlay"],["diameter","40"],[1,"mt-4","text-gray-600"],[1,"profile-content"],[1,"profile-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"section-header"],[1,"section-icon"],[1,"form-grid"],["appearance","fill",1,"form-field"],["matInput","","formControlName","firstName","autocomplete","given-name",3,"readonly"],[4,"ngIf"],["matInput","","formControlName","lastName","autocomplete","family-name",3,"readonly"],["matInput","","type","email","formControlName","email","autocomplete","email",3,"readonly"],["matInput","","formControlName","phone","placeholder","+1 (555) 123-4567","autocomplete","tel",3,"readonly"],["matInput","","formControlName","dateOfBirth","autocomplete","bday",3,"matDatepicker","readonly"],["matSuffix","",3,"for","disabled"],["matInput","","formControlName","occupation","placeholder","e.g., Software Engineer","autocomplete","organization-title",3,"readonly"],["matInput","","type","number","formControlName","monthlyIncome","step","0.01","autocomplete","off",3,"readonly"],["matTextPrefix",""],["formGroupName","preferences",1,"form-section"],["formControlName","defaultCurrency",3,"disabled"],[3,"value"],["formControlName","timezone",3,"disabled"],["formControlName","language",3,"disabled"],[1,"preferences-grid"],[1,"preference-item"],["formControlName","notifications","color","primary",3,"disabled"],[1,"toggle-label"],[1,"preference-description"],["formControlName","emailUpdates","color","primary",3,"disabled"],["formControlName","budgetAlerts","color","primary",3,"disabled"],["formControlName","categoryListViewMode","color","primary",3,"disabled"],["class","form-actions",4,"ngIf"],[1,"account-actions-section"],[1,"actions-grid"],[1,"action-card"],[1,"action-icon"],["mat-stroked-button","",1,"action-btn",3,"click"],[1,"action-card","danger"],["mat-stroked-button","","color","warn",1,"action-btn",3,"click"],[1,"form-actions"],["type","button","mat-stroked-button","",1,"cancel-btn",3,"click","disabled"],["type","submit","mat-raised-button","","color","primary",1,"save-btn",3,"disabled"]],template:function(r,a){r&1&&(re(0,"app-quick-actions-fab",1),s(1,"div",2),N(2,lj,4,0,"div",3),s(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7)(7,"mat-icon",8),d(8,"person"),c()(),s(9,"div",9)(10,"h1",10),d(11),c(),s(12,"p",11),d(13),c(),s(14,"p",12),d(15),c()()()()(),N(16,Pj,135,28,"div",13),c()),r&2&&(P("config",a.fabConfig),u(2),P("ngIf",a.isLoading),u(9),L(a.getFullName()),u(2),L(a.userProfile==null?null:a.userProfile.email),u(2),ne("Member since ",a.getFormattedDate(a.userProfile==null?null:a.userProfile.createdAt),""),u(),P("ngIf",a.userProfile))},dependencies:[dt,Wn,Nt,Ui,At,Yn,xi,Ci,j1,Jt,Qe,Br,am,om,sm,Oi,Lr,ja,rx,$a,wi,yi,da,ma,ns],styles:[".profile-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:24px;min-height:100vh;background:var(--background-color);color:var(--text-color)}@media (max-width: 1024px){.profile-container[_ngcontent-%COMP%]{padding:20px}}@media (max-width: 768px){.profile-container[_ngcontent-%COMP%]{padding:16px}}@media (max-width: 480px){.profile-container[_ngcontent-%COMP%]{padding:12px}}.loading-overlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;background:var(--background-color);border-radius:12px;box-shadow:0 2px 8px #0000001a}.profile-header[_ngcontent-%COMP%]{background:var(--card-background);border-radius:16px;padding:32px;margin-bottom:32px;box-shadow:0 4px 20px #00000014;border:1px solid var(--border-color)}@media (max-width: 1024px){.profile-header[_ngcontent-%COMP%]{padding:28px;margin-bottom:28px}}@media (max-width: 768px){.profile-header[_ngcontent-%COMP%]{padding:24px 20px;margin-bottom:24px}}@media (max-width: 480px){.profile-header[_ngcontent-%COMP%]{padding:20px 16px;margin-bottom:20px}}.header-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:24px}@media (max-width: 1024px){.header-content[_ngcontent-%COMP%]{gap:20px}}@media (max-width: 768px){.header-content[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:20px}}@media (max-width: 480px){.header-content[_ngcontent-%COMP%]{gap:16px}}.avatar-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;flex:1}@media (max-width: 768px){.avatar-section[_ngcontent-%COMP%]{width:100%;gap:16px}}@media (max-width: 480px){.avatar-section[_ngcontent-%COMP%]{gap:12px}}.avatar[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,var(--primary-color),var(--accent-color));display:flex;align-items:center;justify-content:center;box-shadow:0 4px 16px #00000026;flex-shrink:0}@media (max-width: 1024px){.avatar[_ngcontent-%COMP%]{width:70px;height:70px}}@media (max-width: 768px){.avatar[_ngcontent-%COMP%]{width:60px;height:60px}}@media (max-width: 480px){.avatar[_ngcontent-%COMP%]{width:50px;height:50px}}.avatar-icon[_ngcontent-%COMP%]{font-size:36px;width:36px;height:36px;color:#fff}@media (max-width: 1024px){.avatar-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}}@media (max-width: 768px){.avatar-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}}@media (max-width: 480px){.avatar-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}}.user-info[_ngcontent-%COMP%]{flex:1;min-width:0}.user-name[_ngcontent-%COMP%]{font-size:28px;font-weight:700;margin:0 0 8px;color:var(--text-color);word-wrap:break-word}@media (max-width: 1024px){.user-name[_ngcontent-%COMP%]{font-size:26px}}@media (max-width: 768px){.user-name[_ngcontent-%COMP%]{font-size:24px}}@media (max-width: 480px){.user-name[_ngcontent-%COMP%]{font-size:22px}}.user-email[_ngcontent-%COMP%]{font-size:16px;color:var(--text-secondary);margin:0 0 4px;word-wrap:break-word}@media (max-width: 480px){.user-email[_ngcontent-%COMP%]{font-size:14px}}.user-role[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted);margin:0}@media (max-width: 480px){.user-role[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 768px){.header-actions[_ngcontent-%COMP%]{width:100%}}.edit-btn[_ngcontent-%COMP%]{min-width:140px}@media (max-width: 1024px){.edit-btn[_ngcontent-%COMP%]{min-width:130px}}@media (max-width: 768px){.edit-btn[_ngcontent-%COMP%]{width:100%;min-width:unset}}.profile-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:32px}@media (max-width: 768px){.profile-content[_ngcontent-%COMP%]{gap:24px}}@media (max-width: 480px){.profile-content[_ngcontent-%COMP%]{gap:20px}}.profile-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:32px}@media (max-width: 768px){.profile-form[_ngcontent-%COMP%]{gap:24px}}@media (max-width: 480px){.profile-form[_ngcontent-%COMP%]{gap:20px}}.form-section[_ngcontent-%COMP%]{background:var(--card-background);border-radius:16px;padding:32px;box-shadow:0 4px 20px #00000014;border:1px solid var(--border-color)}@media (max-width: 1024px){.form-section[_ngcontent-%COMP%]{padding:28px}}@media (max-width: 768px){.form-section[_ngcontent-%COMP%]{padding:24px 20px}}@media (max-width: 480px){.form-section[_ngcontent-%COMP%]{padding:20px 16px}}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:24px;padding-bottom:16px;border-bottom:2px solid var(--border-color)}@media (max-width: 768px){.section-header[_ngcontent-%COMP%]{margin-bottom:20px;padding-bottom:12px}}@media (max-width: 480px){.section-header[_ngcontent-%COMP%]{margin-bottom:16px;padding-bottom:10px;gap:8px}}.section-icon[_ngcontent-%COMP%]{color:var(--primary-color);font-size:24px;width:24px;height:24px;flex-shrink:0}@media (max-width: 480px){.section-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:600;margin:0;color:var(--text-color)}@media (max-width: 768px){.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px}}@media (max-width: 480px){.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px}}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px}@media (max-width: 1024px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px}}@media (max-width: 768px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}}@media (max-width: 480px){.form-grid[_ngcontent-%COMP%]{gap:16px}}.form-field[_ngcontent-%COMP%]{width:100%}.preferences-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px;margin-top:24px}@media (max-width: 1024px){.preferences-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px}}@media (max-width: 768px){.preferences-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}}@media (max-width: 480px){.preferences-grid[_ngcontent-%COMP%]{gap:16px;margin-top:20px}}.preference-item[_ngcontent-%COMP%]{padding:20px;background:var(--background-color);border-radius:12px;border:1px solid var(--border-color);transition:all .3s ease}.preference-item[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a}@media (max-width: 768px){.preference-item[_ngcontent-%COMP%]{padding:16px}}@media (max-width: 480px){.preference-item[_ngcontent-%COMP%]{padding:14px}}.preference-item[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin-bottom:8px}.preference-description[_ngcontent-%COMP%]{font-size:14px;color:var(--text-secondary);margin:8px 0 0;line-height:1.4}@media (max-width: 480px){.preference-description[_ngcontent-%COMP%]{font-size:13px}}.toggle-label[_ngcontent-%COMP%]{font-weight:500;color:var(--text-color)}@media (max-width: 480px){.toggle-label[_ngcontent-%COMP%]{font-size:14px}}.form-actions[_ngcontent-%COMP%]{display:flex;gap:16px;justify-content:flex-end;padding:24px 0;border-top:1px solid var(--border-color)}@media (max-width: 768px){.form-actions[_ngcontent-%COMP%]{flex-direction:column;gap:12px;padding:20px 0}}@media (max-width: 480px){.form-actions[_ngcontent-%COMP%]{padding:16px 0;gap:10px}}.cancel-btn[_ngcontent-%COMP%]{min-width:120px}@media (max-width: 768px){.cancel-btn[_ngcontent-%COMP%]{width:100%;min-width:unset}}.save-btn[_ngcontent-%COMP%]{min-width:140px}@media (max-width: 1024px){.save-btn[_ngcontent-%COMP%]{min-width:130px}}@media (max-width: 768px){.save-btn[_ngcontent-%COMP%]{width:100%;min-width:unset}}.account-actions-section[_ngcontent-%COMP%]{background:var(--card-background);border-radius:16px;padding:32px;box-shadow:0 4px 20px #00000014;border:1px solid var(--border-color)}@media (max-width: 1024px){.account-actions-section[_ngcontent-%COMP%]{padding:28px}}@media (max-width: 768px){.account-actions-section[_ngcontent-%COMP%]{padding:24px 20px}}@media (max-width: 480px){.account-actions-section[_ngcontent-%COMP%]{padding:20px 16px}}.actions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:24px;margin-top:24px}@media (max-width: 1024px){.actions-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:20px}}@media (max-width: 768px){.actions-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}}@media (max-width: 480px){.actions-grid[_ngcontent-%COMP%]{gap:16px;margin-top:20px}}.action-card[_ngcontent-%COMP%]{padding:24px;background:var(--background-color);border-radius:12px;border:1px solid var(--border-color);text-align:center;transition:all .3s ease}.action-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 24px #0000001f}.action-card.danger[_ngcontent-%COMP%]{border-color:var(--warn-color);background:#f443360d}.action-card.danger[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{color:var(--warn-color)}@media (max-width: 768px){.action-card[_ngcontent-%COMP%]{padding:20px}}@media (max-width: 480px){.action-card[_ngcontent-%COMP%]{padding:16px}}.action-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:var(--primary-color);margin-bottom:16px}@media (max-width: 768px){.action-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px;margin-bottom:12px}}@media (max-width: 480px){.action-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;margin-bottom:10px}}.action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin:0 0 12px;color:var(--text-color)}@media (max-width: 768px){.action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;margin:0 0 10px}}@media (max-width: 480px){.action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px;margin:0 0 8px}}.action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-secondary);margin:0 0 20px;line-height:1.5}@media (max-width: 768px){.action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;margin:0 0 16px}}@media (max-width: 480px){.action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;margin:0 0 14px}}.action-btn[_ngcontent-%COMP%]{min-width:140px}@media (max-width: 1024px){.action-btn[_ngcontent-%COMP%]{min-width:130px}}@media (max-width: 768px){.action-btn[_ngcontent-%COMP%]{width:100%;min-width:unset}}.dark-theme[_nghost-%COMP%]   .profile-container[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .profile-container[_ngcontent-%COMP%]{background:var(--dark-background)}.dark-theme[_nghost-%COMP%]   .profile-header[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .profile-header[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   .form-section[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .form-section[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   .account-actions-section[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .account-actions-section[_ngcontent-%COMP%]{background:var(--dark-card-background);border-color:var(--dark-border-color)}.dark-theme[_nghost-%COMP%]   .preference-item[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .preference-item[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   .action-card[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .action-card[_ngcontent-%COMP%]{background:var(--dark-background);border-color:var(--dark-border-color)}.dark-theme[_nghost-%COMP%]   .user-name[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .user-name[_ngcontent-%COMP%]{color:var(--dark-text-color)}.dark-theme[_nghost-%COMP%]   .user-email[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .user-email[_ngcontent-%COMP%]{color:var(--dark-text-secondary)}.dark-theme[_nghost-%COMP%]   .user-role[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .user-role[_ngcontent-%COMP%]{color:var(--dark-text-muted)}.dark-theme[_nghost-%COMP%]   .section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--dark-text-color)}.dark-theme[_nghost-%COMP%]   .action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--dark-text-color)}.dark-theme[_nghost-%COMP%]   .action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dark-text-secondary)}.dark-theme[_nghost-%COMP%]   .preference-description[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .preference-description[_ngcontent-%COMP%]{color:var(--dark-text-secondary)}.form-field[_ngcontent-%COMP%]{transition:all .3s ease}.form-field.mat-focused[_ngcontent-%COMP%]{transform:scale(1.02)}@keyframes _ngcontent-%COMP%_pulse{0%{opacity:1}50%{opacity:.5}to{opacity:1}}.loading-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}@media (max-width: 640px){.form-grid[_ngcontent-%COMP%], .preferences-grid[_ngcontent-%COMP%], .actions-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.user-info[_ngcontent-%COMP%], .action-card[_ngcontent-%COMP%], .preference-item[_ngcontent-%COMP%]{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;hyphens:auto}button[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width: 480px){.profile-container[_ngcontent-%COMP%]{padding:12px}.profile-header[_ngcontent-%COMP%], .form-section[_ngcontent-%COMP%], .account-actions-section[_ngcontent-%COMP%]{padding:20px 16px}.user-name[_ngcontent-%COMP%]{font-size:22px}.avatar[_ngcontent-%COMP%]{width:50px;height:50px}.avatar-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.form-field[_ngcontent-%COMP%]{margin-bottom:8px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px 16px}}@media (max-width: 768px) and (orientation: landscape){.profile-container[_ngcontent-%COMP%]{padding:16px}.header-content[_ngcontent-%COMP%]{flex-direction:row;align-items:center}.avatar-section[_ngcontent-%COMP%], .header-actions[_ngcontent-%COMP%], .edit-btn[_ngcontent-%COMP%]{width:auto}}@media (max-width: 360px){.profile-container[_ngcontent-%COMP%]{padding:8px}.profile-header[_ngcontent-%COMP%], .form-section[_ngcontent-%COMP%], .account-actions-section[_ngcontent-%COMP%]{padding:16px 12px}.user-name[_ngcontent-%COMP%]{font-size:20px}.avatar[_ngcontent-%COMP%]{width:45px;height:45px}.avatar-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:15px}.action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14px}.action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 12px;font-size:14px}}@media (max-width: 768px){.mat-slide-toggle[_ngcontent-%COMP%]{min-height:48px}.action-btn[_ngcontent-%COMP%], .edit-btn[_ngcontent-%COMP%], .save-btn[_ngcontent-%COMP%], .cancel-btn[_ngcontent-%COMP%]{min-height:44px}.mat-form-field[_ngcontent-%COMP%]{margin-bottom:8px}}@media (min-width: 769px) and (max-width: 1024px){.form-grid[_ngcontent-%COMP%], .preferences-grid[_ngcontent-%COMP%], .actions-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}"]});let e=i;return e})();var u2="@firebase/installations",Tf="0.6.9";var p2=1e4,f2=`w:${Tf}`,h2="FIS_v2",Oj="https://firebaseinstallations.googleapis.com/v1",wj=60*60*1e3,Sj="installations",kj="Installations";var Tj={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ks=new $0(Sj,kj,Tj);function _2(e){return e instanceof d_&&e.code.includes("request-failed")}function x2({projectId:e}){return`${Oj}/projects/${e}/installations`}function C2(e){return{token:e.token,requestStatus:2,expiresIn:Ij(e.expiresIn),creationTime:Date.now()}}function v2(e,i){return me(this,null,function*(){let t=(yield i.json()).error;return Ks.create("request-failed",{requestName:e,serverCode:t.code,serverMessage:t.message,serverStatus:t.status})})}function b2({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function Ej(e,{refreshToken:i}){let n=b2(e);return n.append("Authorization",Aj(i)),n}function y2(e){return me(this,null,function*(){let i=yield e();return i.status>=500&&i.status<600?e():i})}function Ij(e){return Number(e.replace("s","000"))}function Aj(e){return`${h2} ${e}`}function Dj(t,r){return me(this,arguments,function*({appConfig:e,heartbeatServiceProvider:i},{fid:n}){let a=x2(e),o=b2(e),l=i.getImmediate({optional:!0});if(l){let h=yield l.getHeartbeatsHeader();h&&o.append("x-firebase-client",h)}let m={fid:n,authVersion:h2,appId:e.appId,sdkVersion:f2},g={method:"POST",headers:o,body:JSON.stringify(m)},f=yield y2(()=>fetch(a,g));if(f.ok){let h=yield f.json();return{fid:h.fid||n,registrationStatus:2,refreshToken:h.refreshToken,authToken:C2(h.authToken)}}else throw yield v2("Create Installation",f)})}function M2(e){return new Promise(i=>{setTimeout(i,e)})}function Fj(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}var Rj=/^[cdef][\w-]{21}$/,kf="";function Bj(){try{let e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;let n=Nj(e);return Rj.test(n)?n:kf}catch{return kf}}function Nj(e){return Fj(e).substr(0,22)}function $g(e){return`${e.appName}!${e.appId}`}var P2=new Map;function O2(e,i){let n=$g(e);w2(n,i),Lj(n,i)}function w2(e,i){let n=P2.get(e);if(n)for(let t of n)t(i)}function Lj(e,i){let n=Vj();n&&n.postMessage({key:e,fid:i}),Uj()}var Xs=null;function Vj(){return!Xs&&"BroadcastChannel"in self&&(Xs=new BroadcastChannel("[Firebase] FID Change"),Xs.onmessage=e=>{w2(e.data.key,e.data.fid)}),Xs}function Uj(){P2.size===0&&Xs&&(Xs.close(),Xs=null)}var zj="firebase-installations-database",jj=1,Zs="firebase-installations-store",wf=null;function Ef(){return wf||(wf=Rl(zj,jj,{upgrade:(e,i)=>{switch(i){case 0:e.createObjectStore(Zs)}}})),wf}function jg(e,i){return me(this,null,function*(){let n=$g(e),r=(yield Ef()).transaction(Zs,"readwrite"),a=r.objectStore(Zs),o=yield a.get(n);return yield a.put(i,n),yield r.done,(!o||o.fid!==i.fid)&&O2(e,i.fid),i})}function S2(e){return me(this,null,function*(){let i=$g(e),t=(yield Ef()).transaction(Zs,"readwrite");yield t.objectStore(Zs).delete(i),yield t.done})}function Yg(e,i){return me(this,null,function*(){let n=$g(e),r=(yield Ef()).transaction(Zs,"readwrite"),a=r.objectStore(Zs),o=yield a.get(n),l=i(o);return l===void 0?yield a.delete(n):yield a.put(l,n),yield r.done,l&&(!o||o.fid!==l.fid)&&O2(e,l.fid),l})}function If(e){return me(this,null,function*(){let i,n=yield Yg(e.appConfig,t=>{let r=$j(t),a=Yj(e,r);return i=a.registrationPromise,a.installationEntry});return n.fid===kf?{installationEntry:yield i}:{installationEntry:n,registrationPromise:i}})}function $j(e){let i=e||{fid:Bj(),registrationStatus:0};return k2(i)}function Yj(e,i){if(i.registrationStatus===0){if(!navigator.onLine){let r=Promise.reject(Ks.create("app-offline"));return{installationEntry:i,registrationPromise:r}}let n={fid:i.fid,registrationStatus:1,registrationTime:Date.now()},t=Wj(e,n);return{installationEntry:n,registrationPromise:t}}else return i.registrationStatus===1?{installationEntry:i,registrationPromise:Gj(e)}:{installationEntry:i}}function Wj(e,i){return me(this,null,function*(){try{let n=yield Dj(e,i);return jg(e.appConfig,n)}catch(n){throw _2(n)&&n.customData.serverCode===409?yield S2(e.appConfig):yield jg(e.appConfig,{fid:i.fid,registrationStatus:0}),n}})}function Gj(e){return me(this,null,function*(){let i=yield m2(e.appConfig);for(;i.registrationStatus===1;)yield M2(100),i=yield m2(e.appConfig);if(i.registrationStatus===0){let{installationEntry:n,registrationPromise:t}=yield If(e);return t||n}return i})}function m2(e){return Yg(e,i=>{if(!i)throw Ks.create("installation-not-found");return k2(i)})}function k2(e){return Hj(e)?{fid:e.fid,registrationStatus:0}:e}function Hj(e){return e.registrationStatus===1&&e.registrationTime+p2<Date.now()}function qj(t,r){return me(this,arguments,function*({appConfig:e,heartbeatServiceProvider:i},n){let a=Xj(e,n),o=Ej(e,n),l=i.getImmediate({optional:!0});if(l){let h=yield l.getHeartbeatsHeader();h&&o.append("x-firebase-client",h)}let m={installation:{sdkVersion:f2,appId:e.appId}},g={method:"POST",headers:o,body:JSON.stringify(m)},f=yield y2(()=>fetch(a,g));if(f.ok){let h=yield f.json();return C2(h)}else throw yield v2("Generate Auth Token",f)})}function Xj(e,{fid:i}){return`${x2(e)}/${i}/authTokens:generate`}function Af(e,i=!1){return me(this,null,function*(){let n,t=yield Yg(e.appConfig,a=>{if(!T2(a))throw Ks.create("not-registered");let o=a.authToken;if(!i&&Qj(o))return a;if(o.requestStatus===1)return n=Kj(e,i),a;{if(!navigator.onLine)throw Ks.create("app-offline");let l=e$(a);return n=Zj(e,l),l}});return n?yield n:t.authToken})}function Kj(e,i){return me(this,null,function*(){let n=yield g2(e.appConfig);for(;n.authToken.requestStatus===1;)yield M2(100),n=yield g2(e.appConfig);let t=n.authToken;return t.requestStatus===0?Af(e,i):t})}function g2(e){return Yg(e,i=>{if(!T2(i))throw Ks.create("not-registered");let n=i.authToken;return t$(n)?Object.assign(Object.assign({},i),{authToken:{requestStatus:0}}):i})}function Zj(e,i){return me(this,null,function*(){try{let n=yield qj(e,i),t=Object.assign(Object.assign({},i),{authToken:n});return yield jg(e.appConfig,t),n}catch(n){if(_2(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))yield S2(e.appConfig);else{let t=Object.assign(Object.assign({},i),{authToken:{requestStatus:0}});yield jg(e.appConfig,t)}throw n}})}function T2(e){return e!==void 0&&e.registrationStatus===2}function Qj(e){return e.requestStatus===2&&!Jj(e)}function Jj(e){let i=Date.now();return i<e.creationTime||e.creationTime+e.expiresIn<i+wj}function e$(e){let i={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:i})}function t$(e){return e.requestStatus===1&&e.requestTime+p2<Date.now()}function n$(e){return me(this,null,function*(){let i=e,{installationEntry:n,registrationPromise:t}=yield If(i);return t?t.catch(console.error):Af(i).catch(console.error),n.fid})}function i$(e,i=!1){return me(this,null,function*(){let n=e;return yield r$(n),(yield Af(n,i)).token})}function r$(e){return me(this,null,function*(){let{registrationPromise:i}=yield If(e);i&&(yield i)})}function a$(e){if(!e||!e.options)throw Sf("App Configuration");if(!e.name)throw Sf("App Name");let i=["projectId","apiKey","appId"];for(let n of i)if(!e.options[n])throw Sf(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function Sf(e){return Ks.create("missing-app-config-values",{valueName:e})}var E2="installations",o$="installations-internal",s$=e=>{let i=e.getProvider("app").getImmediate(),n=a$(i),t=Bl(i,"heartbeat");return{app:i,appConfig:n,heartbeatServiceProvider:t,_delete:()=>Promise.resolve()}},c$=e=>{let i=e.getProvider("app").getImmediate(),n=Bl(i,E2).getImmediate();return{getId:()=>n$(n),getToken:r=>i$(n,r)}};function l$(){Pc(new Mc(E2,s$,"PUBLIC")),Pc(new Mc(o$,c$,"PRIVATE"))}l$();Ho(u2,Tf);Ho(u2,Tf,"esm2017");var d$="/firebase-messaging-sw.js",m$="/firebase-cloud-messaging-push-scope",B2="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",g$="https://fcmregistrations.googleapis.com/v1",N2="google.c.a.c_id",u$="google.c.a.c_l",p$="google.c.a.ts",f$="google.c.a.e";var Wg=function(e){return e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked",e}(Wg||{});function Fo(e){let i=new Uint8Array(e);return btoa(String.fromCharCode(...i)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function h$(e){let i="=".repeat((4-e.length%4)%4),n=(e+i).replace(/\-/g,"+").replace(/_/g,"/"),t=atob(n),r=new Uint8Array(t.length);for(let a=0;a<t.length;++a)r[a]=t.charCodeAt(a);return r}var Df="fcm_token_details_db",_$=5,I2="fcm_token_object_Store";function x$(e){return me(this,null,function*(){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(a=>a.name).includes(Df))return null;let i=null;return(yield Rl(Df,_$,{upgrade:(t,r,a,o)=>me(this,null,function*(){var l;if(r<2||!t.objectStoreNames.contains(I2))return;let m=o.objectStore(I2),g=yield m.index("fcmSenderId").get(e);if(yield m.clear(),!!g){if(r===2){let f=g;if(!f.auth||!f.p256dh||!f.endpoint)return;i={token:f.fcmToken,createTime:(l=f.createTime)!==null&&l!==void 0?l:Date.now(),subscriptionOptions:{auth:f.auth,p256dh:f.p256dh,endpoint:f.endpoint,swScope:f.swScope,vapidKey:typeof f.vapidKey=="string"?f.vapidKey:Fo(f.vapidKey)}}}else if(r===3){let f=g;i={token:f.fcmToken,createTime:f.createTime,subscriptionOptions:{auth:Fo(f.auth),p256dh:Fo(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:Fo(f.vapidKey)}}}else if(r===4){let f=g;i={token:f.fcmToken,createTime:f.createTime,subscriptionOptions:{auth:Fo(f.auth),p256dh:Fo(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:Fo(f.vapidKey)}}}}})})).close(),yield W0(Df),yield W0("fcm_vapid_details_db"),yield W0("undefined"),C$(i)?i:null})}function C$(e){if(!e||!e.subscriptionOptions)return!1;let{subscriptionOptions:i}=e;return typeof e.createTime=="number"&&e.createTime>0&&typeof e.token=="string"&&e.token.length>0&&typeof i.auth=="string"&&i.auth.length>0&&typeof i.p256dh=="string"&&i.p256dh.length>0&&typeof i.endpoint=="string"&&i.endpoint.length>0&&typeof i.swScope=="string"&&i.swScope.length>0&&typeof i.vapidKey=="string"&&i.vapidKey.length>0}var v$="firebase-messaging-database",b$=1,Id="firebase-messaging-store",Ff=null;function L2(){return Ff||(Ff=Rl(v$,b$,{upgrade:(e,i)=>{switch(i){case 0:e.createObjectStore(Id)}}})),Ff}function y$(e){return me(this,null,function*(){let i=V2(e),t=yield(yield L2()).transaction(Id).objectStore(Id).get(i);if(t)return t;{let r=yield x$(e.appConfig.senderId);if(r)return yield Nf(e,r),r}})}function Nf(e,i){return me(this,null,function*(){let n=V2(e),r=(yield L2()).transaction(Id,"readwrite");return yield r.objectStore(Id).put(i,n),yield r.done,i})}function V2({appConfig:e}){return e.appId}var M$={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Mr=new $0("messaging","Messaging",M$);function P$(e,i){return me(this,null,function*(){let n=yield Vf(e),t=U2(i),r={method:"POST",headers:n,body:JSON.stringify(t)},a;try{a=yield(yield fetch(Lf(e.appConfig),r)).json()}catch(o){throw Mr.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(a.error){let o=a.error.message;throw Mr.create("token-subscribe-failed",{errorInfo:o})}if(!a.token)throw Mr.create("token-subscribe-no-token");return a.token})}function O$(e,i){return me(this,null,function*(){let n=yield Vf(e),t=U2(i.subscriptionOptions),r={method:"PATCH",headers:n,body:JSON.stringify(t)},a;try{a=yield(yield fetch(`${Lf(e.appConfig)}/${i.token}`,r)).json()}catch(o){throw Mr.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(a.error){let o=a.error.message;throw Mr.create("token-update-failed",{errorInfo:o})}if(!a.token)throw Mr.create("token-update-no-token");return a.token})}function w$(e,i){return me(this,null,function*(){let t={method:"DELETE",headers:yield Vf(e)};try{let a=yield(yield fetch(`${Lf(e.appConfig)}/${i}`,t)).json();if(a.error){let o=a.error.message;throw Mr.create("token-unsubscribe-failed",{errorInfo:o})}}catch(r){throw Mr.create("token-unsubscribe-failed",{errorInfo:r==null?void 0:r.toString()})}})}function Lf({projectId:e}){return`${g$}/projects/${e}/registrations`}function Vf(n){return me(this,arguments,function*({appConfig:e,installations:i}){let t=yield i.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})})}function U2({p256dh:e,auth:i,endpoint:n,vapidKey:t}){let r={web:{endpoint:n,auth:i,p256dh:e}};return t!==B2&&(r.web.applicationPubKey=t),r}var S$=7*24*60*60*1e3;function k$(e){return me(this,null,function*(){let i=yield E$(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:i.endpoint,auth:Fo(i.getKey("auth")),p256dh:Fo(i.getKey("p256dh"))},t=yield y$(e.firebaseDependencies);if(t){if(I$(t.subscriptionOptions,n))return Date.now()>=t.createTime+S$?T$(e,{token:t.token,createTime:Date.now(),subscriptionOptions:n}):t.token;try{yield w$(e.firebaseDependencies,t.token)}catch(r){console.warn(r)}return A2(e.firebaseDependencies,n)}else return A2(e.firebaseDependencies,n)})}function T$(e,i){return me(this,null,function*(){try{let n=yield O$(e.firebaseDependencies,i),t=Object.assign(Object.assign({},i),{token:n,createTime:Date.now()});return yield Nf(e.firebaseDependencies,t),n}catch(n){throw n}})}function A2(e,i){return me(this,null,function*(){let t={token:yield P$(e,i),createTime:Date.now(),subscriptionOptions:i};return yield Nf(e,t),t.token})}function E$(e,i){return me(this,null,function*(){let n=yield e.pushManager.getSubscription();return n||e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:h$(i)})})}function I$(e,i){let n=i.vapidKey===e.vapidKey,t=i.endpoint===e.endpoint,r=i.auth===e.auth,a=i.p256dh===e.p256dh;return n&&t&&r&&a}function D2(e){let i={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return A$(i,e),D$(i,e),F$(i,e),i}function A$(e,i){if(!i.notification)return;e.notification={};let n=i.notification.title;n&&(e.notification.title=n);let t=i.notification.body;t&&(e.notification.body=t);let r=i.notification.image;r&&(e.notification.image=r);let a=i.notification.icon;a&&(e.notification.icon=a)}function D$(e,i){i.data&&(e.data=i.data)}function F$(e,i){var n,t,r,a,o;if(!i.fcmOptions&&!(!((n=i.notification)===null||n===void 0)&&n.click_action))return;e.fcmOptions={};let l=(r=(t=i.fcmOptions)===null||t===void 0?void 0:t.link)!==null&&r!==void 0?r:(a=i.notification)===null||a===void 0?void 0:a.click_action;l&&(e.fcmOptions.link=l);let m=(o=i.fcmOptions)===null||o===void 0?void 0:o.analytics_label;m&&(e.fcmOptions.analyticsLabel=m)}function R$(e){return typeof e=="object"&&!!e&&N2 in e}B$("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function B$(e,i){let n=[];for(let t=0;t<e.length;t++)n.push(e.charAt(t)),t<i.length&&n.push(i.charAt(t));return n.join("")}function N$(e){if(!e||!e.options)throw Rf("App Configuration Object");if(!e.name)throw Rf("App Name");let i=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(let t of i)if(!n[t])throw Rf(t);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Rf(e){return Mr.create("missing-app-config-values",{valueName:e})}var Bf=class{constructor(i,n,t){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;let r=N$(i);this.firebaseDependencies={app:i,appConfig:r,installations:n,analyticsProvider:t}}_delete(){return Promise.resolve()}};function L$(e){return me(this,null,function*(){try{e.swRegistration=yield navigator.serviceWorker.register(d$,{scope:m$}),e.swRegistration.update().catch(()=>{})}catch(i){throw Mr.create("failed-service-worker-registration",{browserErrorMessage:i==null?void 0:i.message})}})}function V$(e,i){return me(this,null,function*(){if(!i&&!e.swRegistration&&(yield L$(e)),!(!i&&e.swRegistration)){if(!(i instanceof ServiceWorkerRegistration))throw Mr.create("invalid-sw-registration");e.swRegistration=i}})}function U$(e,i){return me(this,null,function*(){i?e.vapidKey=i:e.vapidKey||(e.vapidKey=B2)})}function z2(e,i){return me(this,null,function*(){if(!navigator)throw Mr.create("only-available-in-window");if(Notification.permission==="default"&&(yield Notification.requestPermission()),Notification.permission!=="granted")throw Mr.create("permission-blocked");return yield U$(e,i==null?void 0:i.vapidKey),yield V$(e,i==null?void 0:i.serviceWorkerRegistration),k$(e)})}function z$(e,i,n){return me(this,null,function*(){let t=j$(i);(yield e.firebaseDependencies.analyticsProvider.get()).logEvent(t,{message_id:n[N2],message_name:n[u$],message_time:n[p$],message_device_time:Math.floor(Date.now()/1e3)})})}function j$(e){switch(e){case Wg.NOTIFICATION_CLICKED:return"notification_open";case Wg.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function $$(e,i){return me(this,null,function*(){let n=i.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===Wg.PUSH_RECEIVED&&(typeof e.onMessageHandler=="function"?e.onMessageHandler(D2(n)):e.onMessageHandler.next(D2(n)));let t=n.data;R$(t)&&t[f$]==="1"&&(yield z$(e,n.messageType,t))})}var F2="@firebase/messaging",R2="0.12.12";var Y$=e=>{let i=new Bf(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>$$(i,n)),i},W$=e=>{let i=e.getProvider("messaging").getImmediate();return{getToken:t=>z2(i,t)}};function G$(){Pc(new Mc("messaging",Y$,"PUBLIC")),Pc(new Mc("messaging-internal",W$,"PRIVATE")),Ho(F2,R2),Ho(F2,R2,"esm2017")}function Uf(){return me(this,null,function*(){try{yield c_()}catch{return!1}return typeof window<"u"&&s_()&&l_()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})}function H$(e,i){if(!navigator)throw Mr.create("only-available-in-window");return e.onMessageHandler=i,()=>{e.onMessageHandler=null}}function j2(e=Eu()){return Uf().then(i=>{if(!i)throw Mr.create("unsupported-browser")},i=>{throw Mr.create("indexed-db-unsupported")}),Bl(Y0(e),"messaging").getImmediate()}function $2(e,i){return me(this,null,function*(){return e=Y0(e),z2(e,i)})}function Y2(e,i){return e=Y0(e),H$(e,i)}G$();var Ad=class{constructor(i){return i}},W2="messaging",zf=class{constructor(){return p_(W2)}};var Gg="__angularfire_symbol__messagingIsSupported",jf="__angularfire_symbol__messagingIsSupportedValue";globalThis[Gg]||(globalThis[Gg]=Uf().then(e=>globalThis[jf]=e).catch(()=>globalThis[jf]=!1));var Hg={async:()=>globalThis[Gg],sync:()=>{let e=globalThis[jf];if(e===void 0)throw new Error(g_("Messaging"));return e}},$f=new wa("angularfire2.messaging-instances");function q$(e,i){if(!Hg.sync())return null;let n=u_(W2,e,i);return n&&new Ad(n)}function X$(e){return(i,n)=>{if(!Hg.sync())return null;let t=i.runOutsideAngular(()=>e(n));return new Ad(t)}}var K$={provide:zf,deps:[[new Pu,$f]]},Z$={provide:Ad,useFactory:q$,deps:[[new Pu,$f],h_]};function G2(e,...i){return Ho("angularfire",m_.full,"fcm"),lc([Z$,K$,{provide:w1,useValue:Hg.async,multi:!0},{provide:$f,useFactory:X$(e),multi:!0,deps:[Dr,g1,f_,__,...i]}])}var UZ=Hg.async;var Cl=G0(j2,!0),Yf=G0($2,!0),qg=G0(Y2,!1);var Xg=(()=>{let i=class i{constructor(t,r){this.ngZone=t,this.platformId=r,this.tokenSubject=new on(null),this.permissionSubject=new on("default"),this.notificationSubject=new on(null),this.swRegistration=null,this.token$=this.tokenSubject.asObservable(),this.permission$=this.permissionSubject.asObservable(),this.notifications$=this.notificationSubject.asObservable(),this.platformInfo=this.detectPlatform(),this.initializeMessagingWithoutPermission()}detectPlatform(){if(Uo(this.platformId))return{isAndroid:!1,isIOS:!1,isChrome:!1,isSafari:!1,isFirefox:!1,isEdge:!1,isMobile:!1,isDesktop:!1,isPWA:!1,isStandalone:!1,supportsNotifications:!1,supportsServiceWorker:!1,supportsPushManager:!1};let t=navigator.userAgent,r=/Android/i.test(t),a=/iPad|iPhone|iPod/.test(t),o=/Chrome/.test(t)&&!/Edge/.test(t),l=/Safari/.test(t)&&!/Chrome/.test(t),m=/Firefox/.test(t),g=/Edge/.test(t),f=r||a||/webOS|BlackBerry|IEMobile|Opera Mini/i.test(t),h=!f,x=window.matchMedia("(display-mode: standalone)").matches,C=x||window.navigator.standalone===!0,y="Notification"in window,b="serviceWorker"in navigator,w="PushManager"in window;return{isAndroid:r,isIOS:a,isChrome:o,isSafari:l,isFirefox:m,isEdge:g,isMobile:f,isDesktop:h,isPWA:x,isStandalone:C,supportsNotifications:y,supportsServiceWorker:b,supportsPushManager:w}}getPlatformInfo(){return this.platformInfo}initializeMessagingWithoutPermission(){return me(this,null,function*(){try{if(Uo(this.platformId)){console.log("Skipping Firebase messaging initialization on server-side");return}if(!this.platformInfo.supportsNotifications){console.warn("This browser does not support notifications");return}if(!this.platformInfo.supportsServiceWorker){console.warn("Service Worker not supported");return}yield this.initializePlatformSpecific(),yield this.registerFirebaseMessagingSW(),this.messaging=Cl(),this.permissionSubject.next(Notification.permission),"permissions"in navigator&&navigator.permissions.query({name:"notifications"}).then(t=>{t.onchange=()=>{this.ngZone.run(()=>{this.permissionSubject.next(Notification.permission)})}}),qg(this.messaging,t=>{this.ngZone.run(()=>me(this,null,function*(){console.log("Foreground message received:",t),yield this.handleForegroundMessage(t)}))}),console.log("Firebase messaging initialized without automatic permission request")}catch(t){console.error("Failed to initialize Firebase messaging:",t)}})}initializeMessaging(){return me(this,null,function*(){try{if(Uo(this.platformId)){console.log("Skipping Firebase messaging initialization on server-side");return}if(!this.platformInfo.supportsNotifications){console.warn("This browser does not support notifications");return}if(!this.platformInfo.supportsServiceWorker){console.warn("Service Worker not supported");return}yield this.initializePlatformSpecific(),yield this.registerFirebaseMessagingSW(),this.messaging=Cl(),this.permissionSubject.next(Notification.permission),"permissions"in navigator&&navigator.permissions.query({name:"notifications"}).then(t=>{t.onchange=()=>{this.ngZone.run(()=>{this.permissionSubject.next(Notification.permission)})}}),qg(this.messaging,t=>{this.ngZone.run(()=>me(this,null,function*(){console.log("Foreground message received:",t),yield this.handleForegroundMessage(t)}))}),yield this.requestPermission()}catch(t){console.error("Failed to initialize Firebase messaging:",t)}})}initializePlatformSpecific(){return me(this,null,function*(){console.log("Platform info:",this.platformInfo),this.platformInfo.isIOS&&(console.log("Initializing for iOS platform"),yield this.initializeIOS()),this.platformInfo.isAndroid&&(console.log("Initializing for Android platform"),yield this.initializeAndroid()),this.platformInfo.isChrome&&this.platformInfo.isDesktop&&(console.log("Initializing for Chrome desktop platform"),yield this.initializeChromeDesktop()),this.platformInfo.isSafari&&(console.log("Initializing for Safari platform"),yield this.initializeSafari())})}initializeIOS(){return me(this,null,function*(){this.platformInfo.isStandalone||console.warn("iOS notifications work best when app is added to home screen");let t=this.getIOSVersion();t&&t<14&&console.warn("iOS version may have limited notification support")})}initializeAndroid(){return me(this,null,function*(){let t=this.getChromeVersion();t&&t<79&&console.warn("Chrome version may have limited notification support");let r=this.getAndroidVersion();r&&r<6&&console.warn("Android version may have limited notification support")})}initializeChromeDesktop(){return me(this,null,function*(){let t=this.getChromeVersion();t&&t<79&&console.warn("Chrome version may have limited notification support")})}initializeSafari(){return me(this,null,function*(){let t=this.getSafariVersion();t&&t<16.4&&console.warn("Safari version may have limited notification support")})}getIOSVersion(){let t=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/);return t?parseInt(t[1],10):null}getAndroidVersion(){let t=navigator.userAgent.match(/Android (\d+)/);return t?parseInt(t[1],10):null}getChromeVersion(){let t=navigator.userAgent.match(/Chrome\/(\d+)/);return t?parseInt(t[1],10):null}getSafariVersion(){let t=navigator.userAgent.match(/Version\/(\d+)/);return t?parseInt(t[1],10):null}registerFirebaseMessagingSW(){return me(this,null,function*(){try{let r=(yield navigator.serviceWorker.getRegistrations()).find(o=>{var l;return o.scope.includes(mi.serviceWorkerScope)||((l=o.active)==null?void 0:l.scriptURL.includes(mi.serviceWorkerScope+"firebase-messaging-sw.js"))});if(r){console.log("Firebase messaging service worker already registered"),this.swRegistration=r;return}let a=this.getServiceWorkerOptions();console.log("Registering Firebase messaging service worker..."),this.swRegistration=yield navigator.serviceWorker.register(mi.serviceWorkerScope+"firebase-messaging-sw.js",a),console.log("Firebase messaging service worker registered successfully:",this.swRegistration),yield this.swRegistration.update()}catch(t){throw console.error("Failed to register Firebase messaging service worker:",t),t}})}getServiceWorkerOptions(){let t={scope:mi.serviceWorkerScope};return this.platformInfo.isIOS||this.platformInfo.isAndroid||this.platformInfo.isChrome&&this.platformInfo.isDesktop,t}handleForegroundMessage(t){return me(this,null,function*(){var a,o,l,m,g,f,h,x,C;let r={title:((a=t.notification)==null?void 0:a.title)||"New Notification",body:((o=t.notification)==null?void 0:o.body)||"",icon:this.getPlatformSpecificIcon((l=t.notification)==null?void 0:l.icon),badge:this.getPlatformSpecificBadge((m=t.notification)==null?void 0:m.badge),image:(g=t.notification)==null?void 0:g.image,data:t.data||{},tag:(f=t.notification)==null?void 0:f.tag,requireInteraction:((h=t.notification)==null?void 0:h.requireInteraction)||!1,silent:((x=t.notification)==null?void 0:x.silent)||!1,timestamp:((C=t.notification)==null?void 0:C.timestamp)||Date.now()};this.notificationSubject.next(r),yield this.showNotification(r)})}getPlatformSpecificIcon(t){return t||(this.platformInfo.isIOS?mi.baseUrl+"/assets/icon/app-icon/icon-152x152.png":this.platformInfo.isAndroid?mi.baseUrl+"/assets/icon/app-icon/icon-192x192.png":mi.baseUrl+"/assets/icon/app-icon/icon-192x192.png")}getPlatformSpecificBadge(t){return t||(this.platformInfo.isIOS||this.platformInfo.isAndroid,"/icons/icon-72x72.png")}requestPermission(){return me(this,null,function*(){try{if(!this.platformInfo.supportsNotifications)throw new Error("Notifications not supported");let t=yield this.requestPlatformSpecificPermission();return this.permissionSubject.next(t),t==="granted"&&(yield this.getToken()),t}catch(t){return console.error("Error requesting notification permission:",t),"denied"}})}requestPlatformSpecificPermission(){return me(this,null,function*(){return this.platformInfo.isSafari?(console.log("Requesting permission for Safari"),Notification.requestPermission()):this.platformInfo.isAndroid?(console.log("Requesting permission for Android Chrome"),Notification.requestPermission()):(this.platformInfo.isChrome&&this.platformInfo.isDesktop&&console.log("Requesting permission for Chrome desktop"),Notification.requestPermission())})}getToken(){return me(this,null,function*(){try{if(!this.messaging)return console.warn("Messaging not initialized"),null;this.swRegistration&&(yield this.swRegistration.update());let t=this.getPlatformSpecificTokenOptions(),r=yield Yf(this.messaging,t);return r?(this.tokenSubject.next(r),localStorage.setItem("fcm-token",r),r):(console.warn("No registration token available"),null)}catch(t){return console.error("Error getting FCM token:",t),null}})}getPlatformSpecificTokenOptions(){let t={vapidKey:mi.vapidKey,serviceWorkerRegistration:this.swRegistration||void 0};return this.platformInfo.isIOS||this.platformInfo.isAndroid||this.platformInfo.isChrome&&this.platformInfo.isDesktop,t}refreshToken(){return me(this,null,function*(){try{if(!this.messaging)return null;let t=yield Yf(this.messaging,{vapidKey:mi.vapidKey,serviceWorkerRegistration:this.swRegistration||void 0});return t?(this.tokenSubject.next(t),localStorage.setItem("fcm-token",t),t):null}catch(t){return console.error("Error refreshing FCM token:",t),null}})}showNotification(t){return me(this,null,function*(){if(Notification.permission!=="granted"){console.warn("Notification permission not granted");return}this.platformInfo.isMobile||this.platformInfo.isAndroid?yield this.showNotificationViaServiceWorker(t):this.showNotificationDirect(t)})}showNotificationViaServiceWorker(t){return me(this,null,function*(){try{if(!this.swRegistration){console.warn("Service Worker not registered, falling back to direct notification"),this.showNotificationDirect(t);return}if(!this.swRegistration.active&&(console.warn("Service Worker not active, waiting for activation..."),yield this.swRegistration.update(),!this.swRegistration.active)){console.warn("Service Worker still not active, falling back to direct notification"),this.showNotificationDirect(t);return}let r={type:"SHOW_NOTIFICATION",notification:{title:t.title,body:t.body,icon:t.icon,badge:t.badge,image:t.image,data:t.data,tag:t.tag,requireInteraction:t.requireInteraction,silent:t.silent,timestamp:t.timestamp,actions:t.actions}};this.swRegistration.active.postMessage(r),console.log("Notification request sent to Service Worker")}catch(r){console.error("Error showing notification via Service Worker:",r),this.showNotificationDirect(t)}})}showNotificationDirect(t){try{let r={body:t.body,icon:t.icon,badge:t.badge,data:t.data,tag:t.tag,requireInteraction:t.requireInteraction,silent:t.silent},a=new Notification(t.title,r);a.onclick=o=>{o.preventDefault(),this.handleNotificationClick(t,o),a.close()},t.requireInteraction||setTimeout(()=>{a.close()},5e3),console.log("Notification shown directly")}catch(r){console.error("Error showing direct notification:",r)}}handleNotificationClick(t,r){var a,o;console.log("Notification clicked:",t),window.focus&&window.focus(),(a=t.data)!=null&&a.url?window.open(t.data.url,"_blank"):(o=t.data)!=null&&o.route&&(window.location.href=t.data.route),this.notificationSubject.next(le(oe({},t),{data:le(oe({},t.data),{action:"click"})}))}handleNotificationAction(t,r){var a;switch(console.log("Notification action clicked:",r.action,t),r.action){case"view":this.handleNotificationClick(t,r);break;case"dismiss":break;default:(a=t.data)!=null&&a.actionUrl&&window.open(t.data.actionUrl,"_blank")}this.notificationSubject.next(le(oe({},t),{data:le(oe({},t.data),{action:r.action})}))}getStoredToken(){return localStorage.getItem("fcm-token")}clearStoredToken(){localStorage.removeItem("fcm-token"),this.tokenSubject.next(null)}isSupported(){return this.platformInfo.supportsNotifications&&this.platformInfo.supportsServiceWorker}isPlatformSupported(){if(this.platformInfo.isAndroid||this.platformInfo.isChrome&&this.platformInfo.isDesktop)return!0;if(this.platformInfo.isIOS){let t=this.getIOSVersion();return t?t>=14:!1}if(this.platformInfo.isSafari){let t=this.getSafariVersion();return t?t>=16.4:!1}return!1}getPlatformSupportInfo(){if(this.platformInfo.isAndroid)return"Excellent support on Android Chrome";if(this.platformInfo.isChrome&&this.platformInfo.isDesktop)return"Excellent support on Chrome desktop";if(this.platformInfo.isIOS){let t=this.getIOSVersion();return t&&t>=14?"Good support on iOS (requires home screen installation for best results)":"Limited support on iOS (requires iOS 14+ and home screen installation)"}if(this.platformInfo.isSafari){let t=this.getSafariVersion();return t&&t>=16.4?"Good support on Safari 16.4+":"Limited support on Safari (requires Safari 16.4+)"}return"Limited or no support on this platform"}getServiceWorkerRegistration(){return this.swRegistration}initializeMessagingWithPermission(){return me(this,null,function*(){yield this.initializeMessaging()})}sendTestNotification(){return me(this,null,function*(){let t={title:"Test Notification",body:"This is a test notification from Money Manager",icon:mi.baseUrl+"/assets/icons/icon-192x192.png",badge:mi.baseUrl+"/assets/icons/icon-72x72.png",data:{type:"test",timestamp:Date.now().toString()},actions:[{action:"view",title:"View"},{action:"dismiss",title:"Dismiss"}]};yield this.showNotification(t)})}listenForMessages(){let t=Cl();qg(t,r=>{console.log("Message received: ",r),alert("Message received: "+r)})}};i.\u0275fac=function(r){return new(r||i)(De(Dr),De(Kd))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();function Q$(e,i){e&1&&re(0,"div",35)}function J$(e,i){if(e&1){let n=ue();s(0,"button",33),F("click",function(){R(n);let r=v();return B(r.requestPermission())}),s(1,"span",30),d(2,"\u{1F514}"),c(),s(3,"span",31),d(4,"Enable Notifications"),c(),N(5,Q$,1,0,"div",34),c()}if(e&2){let n=v();P("disabled",n.isLoading),u(5),P("ngIf",n.isLoading)}}function eY(e,i){if(e&1){let n=ue();s(0,"button",36),F("click",function(){R(n);let r=v();return B(r.openPermissionHelp())}),s(1,"span",30),d(2,"\u2753"),c(),s(3,"span",31),d(4,"How to Enable"),c()()}}function tY(e,i){e&1&&re(0,"div",35)}function nY(e,i){if(e&1){let n=ue();s(0,"button",37),F("click",function(){R(n);let r=v();return B(r.testNotification())}),s(1,"span",30),d(2,"\u{1F4E4}"),c(),s(3,"span",31),d(4,"Test Notification"),c(),N(5,tY,1,0,"div",34),c()}if(e&2){let n=v();P("disabled",n.isLoading),u(5),P("ngIf",n.isLoading)}}function iY(e,i){if(e&1){let n=ue();s(0,"div",41)(1,"div",42)(2,"div",43)(3,"span",13),d(4),c()(),s(5,"div",44)(6,"h4"),d(7),c(),s(8,"p"),d(9),c()()(),s(10,"mat-slide-toggle",45),F("change",function(r){let a=R(n).$implicit,o=v(2);return B(o.toggleNotificationType(a.key,r))}),c()()}if(e&2){let n=i.$implicit;u(4),L(n.icon),u(3),L(n.title),u(2),L(n.description),u(),P("checked",n.enabled)}}function rY(e,i){if(e&1&&(s(0,"div",38)(1,"div",27)(2,"h3"),d(3,"Notification Types"),c(),s(4,"p"),d(5,"Choose which types of notifications you want to receive"),c()(),s(6,"div",39),N(7,iY,11,4,"div",40),c()()),e&2){let n=v();u(7),P("ngForOf",n.notificationTypes)}}function aY(e,i){e&1&&re(0,"div",35)}function oY(e,i){if(e&1){let n=ue();s(0,"div",46)(1,"div",27)(2,"h3"),d(3,"Device Token"),c(),s(4,"p"),d(5,"Your device registration for push notifications"),c()(),s(6,"div",47)(7,"div",48)(8,"div",49),d(9,"Device Token:"),c(),s(10,"div",50)(11,"code"),d(12),c(),s(13,"button",51),F("click",function(){R(n);let r=v();return B(r.copyToken())}),s(14,"span",13),d(15,"\u{1F4CB}"),c()()()(),s(16,"button",52),F("click",function(){R(n);let r=v();return B(r.refreshToken())}),s(17,"span",30),d(18,"\u{1F504}"),c(),s(19,"span",31),d(20,"Refresh Token"),c(),N(21,aY,1,0,"div",34),c()()()}if(e&2){let n=v();u(12),L(n.fcmToken),u(4),P("disabled",n.isLoading),u(5),P("ngIf",n.isLoading)}}function sY(e,i){if(e&1){let n=ue();s(0,"div",55)(1,"div",56)(2,"div",57)(3,"span",13),d(4),c()(),s(5,"div",58)(6,"h4"),d(7),c(),s(8,"p"),d(9),c()()(),s(10,"mat-slide-toggle",59),F("change",function(r){let a=R(n).$implicit,o=v(2);return B(o.updateSetting(a.key,r))}),c()()}if(e&2){let n=i.$implicit,t=v(2);u(4),L(n.icon),u(3),L(n.title),u(2),L(n.description),u(),P("checked",t.getSettingValue(n.key))}}function cY(e,i){if(e&1&&(s(0,"div",38)(1,"div",27)(2,"h3"),d(3,"Advanced Settings"),c(),s(4,"p"),d(5,"Customize notification behavior"),c()(),s(6,"div",53),N(7,sY,11,4,"div",54),c()()),e&2){let n=v();u(7),P("ngForOf",n.advancedSettings)}}function lY(e,i){e&1&&(s(0,"div",60)(1,"div",61)(2,"div",62)(3,"span",13),d(4,"\u{1F515}"),c()(),s(5,"h3"),d(6,"Notifications Disabled"),c(),s(7,"p"),d(8,"Enable the master toggle above to configure your notification preferences."),c()()())}function dY(e,i){if(e&1&&(s(0,"div",63)(1,"h4"),d(2,"Debug Information"),c(),s(3,"pre"),d(4),ce(5,"json"),c()()),e&2){let n=v();u(4),L(xe(5,1,n.debugInfo))}}var q2=(()=>{let i=class i{constructor(t,r){this.messagingService=t,this.notificationService=r,this.destroy$=new Bt,this.APP_CONFIG=Ut,this.permissionStatus="default",this.fcmToken=null,this.isLoading=!1,this.notificationsEnabled=!0,this.debugInfo={},this.notificationTypes=[{key:"transactions",title:"Transaction Alerts",description:"Get notified about new transactions and spending limits",icon:"\u{1F4B0}",enabled:!0},{key:"budgets",title:"Budget Reminders",description:"Receive alerts when approaching budget limits",icon:"\u{1F4B3}",enabled:!0},{key:"goals",title:"Goal Updates",description:"Track progress on your financial goals",icon:"\u{1F3AF}",enabled:!0},{key:"bills",title:"Bill Reminders",description:"Never miss a bill payment",icon:"\u{1F4C5}",enabled:!0},{key:"security",title:"Security Alerts",description:"Important security notifications",icon:"\u{1F512}",enabled:!0}],this.advancedSettings=[{key:"soundEnabled",title:"Sound",description:"Play sound for notifications",icon:"\u{1F50A}",value:!0},{key:"vibrationEnabled",title:"Vibration",description:"Vibrate device for notifications",icon:"\u{1F4F3}",value:!0},{key:"requireInteraction",title:"Require Interaction",description:"Keep notifications until user interacts",icon:"\u{1F446}",value:!1}]}ngOnInit(){this.loadSettings(),this.subscribeToMessagingEvents(),this.collectDebugInfo()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadSettings(){this.notificationTypes.forEach(r=>{let a=localStorage.getItem(`notification_${r.key}`);r.enabled=a?JSON.parse(a):!0}),this.advancedSettings.forEach(r=>{let a=localStorage.getItem(`notification_advanced_${r.key}`);r.value=a?JSON.parse(a):r.value});let t=localStorage.getItem("notifications_enabled");this.notificationsEnabled=t?JSON.parse(t):!0}saveSettings(){this.notificationTypes.forEach(t=>{localStorage.setItem(`notification_${t.key}`,JSON.stringify(t.enabled))}),this.advancedSettings.forEach(t=>{localStorage.setItem(`notification_advanced_${t.key}`,JSON.stringify(t.value))}),localStorage.setItem("notifications_enabled",JSON.stringify(this.notificationsEnabled))}subscribeToMessagingEvents(){this.messagingService.permission$.pipe(yt(this.destroy$)).subscribe(t=>{this.permissionStatus=t,t==="denied"&&(this.notificationsEnabled=!1,this.saveNotificationsEnabled())}),this.messagingService.token$.pipe(yt(this.destroy$)).subscribe(t=>{this.fcmToken=t,this.collectDebugInfo()})}collectDebugInfo(){this.debugInfo={browser:navigator.userAgent,serviceWorker:"serviceWorker"in navigator,notifications:"Notification"in window,permission:Notification.permission,fcmToken:this.fcmToken,swRegistration:this.messagingService.getServiceWorkerRegistration(),isSupported:this.messagingService.isSupported(),storedToken:this.messagingService.getStoredToken(),timestamp:new Date().toISOString()}}requestPermission(){return me(this,null,function*(){this.isLoading=!0;try{yield this.messagingService.initializeMessagingWithPermission();let t=yield this.messagingService.requestPermission();console.log("Permission result:",t),t==="granted"?(this.notificationsEnabled=!0,this.saveNotificationsEnabled(),this.notificationService.success("Notifications enabled successfully!")):this.notificationService.error("Notification permission denied")}catch(t){console.error("Error requesting permission:",t),this.notificationService.error("Failed to request notification permission")}finally{this.isLoading=!1}})}testNotification(){return me(this,null,function*(){this.isLoading=!0;try{this.messagingService.sendTestNotification(),this.notificationService.success("Test notification sent!")}catch(t){console.error("Error sending test notification:",t),this.notificationService.error("Failed to send test notification")}finally{this.isLoading=!1}})}refreshToken(){return me(this,null,function*(){this.isLoading=!0;try{(yield this.messagingService.refreshToken())?this.notificationService.success("Token refreshed successfully!"):this.notificationService.error("Failed to refresh token")}catch(t){console.error("Error refreshing token:",t),this.notificationService.error("Failed to refresh token")}finally{this.isLoading=!1}})}copyToken(){this.fcmToken&&navigator.clipboard.writeText(this.fcmToken).then(()=>{this.notificationService.success("Token copied to clipboard!")}).catch(()=>{this.notificationService.error("Failed to copy token")})}toggleMasterNotifications(t){this.notificationsEnabled=t.checked,this.saveNotificationsEnabled(),this.notificationsEnabled&&this.permissionStatus==="default"&&this.requestPermission()}toggleNotificationType(t,r){let a=this.notificationTypes.find(o=>o.key===t);a&&(a.enabled=r.checked,this.saveSettings())}updateSetting(t,r){let a=this.advancedSettings.find(o=>o.key===t);a&&(a.value=r.checked,this.saveSettings())}getSettingValue(t){let r=this.advancedSettings.find(a=>a.key===t);return r?r.value:!1}saveNotificationsEnabled(){localStorage.setItem("notifications_enabled",JSON.stringify(this.notificationsEnabled))}getStatusIcon(){switch(this.permissionStatus){case"granted":return"\u2705";case"denied":return"\u274C";default:return"\u2753"}}getPermissionText(){switch(this.permissionStatus){case"granted":return"Granted";case"denied":return"Denied";default:return"Not Set"}}openPermissionHelp(){alert(`
To enable notifications:
1. Click the lock/info icon in your browser's address bar
2. Find "Notifications" in the site settings
3. Change it from "Block" to "Allow"
4. Refresh the page
    `)}debugServiceWorker(){return me(this,null,function*(){var t,r;try{let a=yield navigator.serviceWorker.getRegistrations();console.log("All service worker registrations:",a);let o=a.find(l=>{var m;return l.scope.includes(mi.serviceWorkerScope)||((m=l.active)==null?void 0:m.scriptURL.includes(mi.serviceWorkerScope+"firebase-messaging-sw.js"))});o?(console.log("Firebase SW found:",o),console.log("Firebase SW state:",(t=o.active)==null?void 0:t.state),console.log("Firebase SW script URL:",(r=o.active)==null?void 0:r.scriptURL)):console.log("No Firebase service worker found"),this.collectDebugInfo(),console.log("Debug info:",this.debugInfo)}catch(a){console.error("Debug error:",a)}})}forceServiceWorkerRegistration(){return me(this,null,function*(){try{let r=(yield navigator.serviceWorker.getRegistrations()).find(a=>a.scope.includes(mi.serviceWorkerScope));r&&(yield r.unregister(),console.log("Unregistered existing Firebase SW")),setTimeout(()=>me(this,null,function*(){yield this.messagingService.refreshToken(),this.collectDebugInfo()}),1e3)}catch(t){console.error("Force registration error:",t)}})}};i.\u0275fac=function(r){return new(r||i)(Y(Xg),Y(ft))},i.\u0275cmp=Re({type:i,selectors:[["app-notification-settings"]],decls:57,vars:20,consts:[[1,"notification-settings"],[1,"settings-header"],[1,"header-content"],[1,"header-text"],[1,"master-toggle-container"],["color","accent",1,"master-toggle",3,"change","checked","disabled"],[1,"toggle-icon"],[1,"master-label"],[1,"settings-content"],[1,"setting-section","permission-card"],[1,"card-header"],[1,"header-left"],[1,"status-icon"],[1,"icon"],[1,"header-info"],[1,"status-text"],[1,"permission-badge"],[1,"card-content"],[1,"description"],[1,"action-buttons"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"],["class","btn btn-warn",3,"click",4,"ngIf"],["class","btn btn-accent",3,"disabled","click",4,"ngIf"],["class","setting-section",4,"ngIf"],["class","setting-section token-card",4,"ngIf"],["class","setting-section disabled-state",4,"ngIf"],[1,"setting-section","debug-section"],[1,"section-header"],[1,"debug-buttons"],[1,"btn","btn-secondary",3,"click"],[1,"btn-icon"],[1,"btn-text"],["class","debug-info",4,"ngIf"],[1,"btn","btn-primary",3,"click","disabled"],["class","btn-loader",4,"ngIf"],[1,"btn-loader"],[1,"btn","btn-warn",3,"click"],[1,"btn","btn-accent",3,"click","disabled"],[1,"setting-section"],[1,"notification-types"],["class","notification-type",4,"ngFor","ngForOf"],[1,"notification-type"],[1,"type-content"],[1,"type-icon"],[1,"type-info"],["color","primary",3,"change","checked"],[1,"setting-section","token-card"],[1,"token-container"],[1,"token-display"],[1,"token-label"],[1,"token-value"],["title","Copy token",1,"copy-btn",3,"click"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"advanced-settings"],["class","setting-item",4,"ngFor","ngForOf"],[1,"setting-item"],[1,"setting-content"],[1,"setting-icon"],[1,"setting-info"],["color","accent",3,"change","checked"],[1,"setting-section","disabled-state"],[1,"disabled-content"],[1,"disabled-icon"],[1,"debug-info"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),d(5,"Notification Settings"),c(),s(6,"p"),d(7,"Manage your push notification preferences"),c()(),s(8,"div",4)(9,"mat-slide-toggle",5),F("change",function(l){return a.toggleMasterNotifications(l)}),s(10,"span",6),d(11),c()(),s(12,"span",7),d(13),c()()()(),s(14,"div",8)(15,"div",9)(16,"div",10)(17,"div",11)(18,"div",12)(19,"span",13),d(20),c()(),s(21,"div",14)(22,"h3"),d(23,"Notification Permission"),c(),s(24,"p",15),d(25),c()()(),s(26,"div",16),d(27),c()(),s(28,"div",17)(29,"p",18),d(30),c(),s(31,"div",19),N(32,J$,6,2,"button",20)(33,eY,5,0,"button",21)(34,nY,6,2,"button",22),c()()(),N(35,rY,8,1,"div",23)(36,oY,22,3,"div",24)(37,cY,8,1,"div",23)(38,lY,9,0,"div",25),s(39,"div",26)(40,"div",27)(41,"h3"),d(42,"Debug Tools"),c(),s(43,"p"),d(44,"Tools to help troubleshoot notification issues"),c()(),s(45,"div",28)(46,"button",29),F("click",function(){return a.debugServiceWorker()}),s(47,"span",30),d(48,"\u{1F50D}"),c(),s(49,"span",31),d(50,"Debug Service Worker"),c()(),s(51,"button",29),F("click",function(){return a.forceServiceWorkerRegistration()}),s(52,"span",30),d(53,"\u{1F504}"),c(),s(54,"span",31),d(55,"Force Re-registration"),c()()(),N(56,dY,6,3,"div",32),c()()()),r&2&&(u(9),P("checked",a.notificationsEnabled)("disabled",a.permissionStatus==="denied"),u(2),L(a.notificationsEnabled?"\u{1F514}":"\u{1F515}"),u(2),L(a.notificationsEnabled?"Enabled":"Disabled"),u(5),jt(a.permissionStatus),u(2),L(a.getStatusIcon()),u(5),L(a.getPermissionText()),u(),jt(a.permissionStatus),u(),ne(" ",a.getPermissionText()," "),u(3),ne(" Allow ",a.APP_CONFIG.APP_NAME," to send you notifications about important updates and reminders. "),u(2),P("ngIf",a.permissionStatus==="default"),u(),P("ngIf",a.permissionStatus==="denied"),u(),P("ngIf",a.permissionStatus==="granted"),u(),P("ngIf",a.permissionStatus==="granted"&&a.notificationsEnabled),u(),P("ngIf",a.permissionStatus==="granted"&&a.fcmToken&&a.notificationsEnabled),u(),P("ngIf",a.permissionStatus==="granted"&&a.notificationsEnabled),u(),P("ngIf",!a.notificationsEnabled),u(18),P("ngIf",a.debugInfo))},dependencies:[or,dt,ma,T1],styles:[".notification-settings[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:24px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.settings-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--primary-color, #3b82f6) 0%,var(--accent-color, #8b5cf6) 100%);border-radius:16px;padding:32px;margin-bottom:32px;color:#fff;box-shadow:0 8px 32px #3b82f64d}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:24px}.header-text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:32px;font-weight:700;margin:0 0 8px;color:#fff}.header-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin:0;opacity:.9}.master-toggle-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px}.toggle-icon[_ngcontent-%COMP%]{font-size:18px;z-index:1}.master-label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;opacity:.9}.setting-section[_ngcontent-%COMP%]{background:var(--surface-color, #ffffff);border:1px solid var(--border-color, #e2e8f0);border-radius:16px;padding:24px;margin-bottom:24px;box-shadow:0 2px 8px #0000000d;transition:all .2s ease}.setting-section[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #0000001a;transform:translateY(-1px)}.permission-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9);border:2px solid var(--primary-color, #3b82f6)}.token-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid #f59e0b}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.status-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px}.status-icon.granted[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.status-icon.denied[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.status-icon.default[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.header-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 4px}.status-text[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0}.permission-badge[_ngcontent-%COMP%]{padding:8px 16px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.permission-badge.granted[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.permission-badge.denied[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.permission-badge.default[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.section-header[_ngcontent-%COMP%]{margin-bottom:24px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 8px}.section-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0}.card-content[_ngcontent-%COMP%]{margin-bottom:20px}.description[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0 0 20px;line-height:1.6}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.btn[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border:none;border-radius:12px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s ease;text-decoration:none;min-width:140px;justify-content:center}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:var(--primary-color, #3b82f6);color:#fff;box-shadow:0 4px 12px #3b82f64d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary-color-dark, #2563eb);transform:translateY(-1px);box-shadow:0 6px 16px #3b82f666}.btn-secondary[_ngcontent-%COMP%]{background:var(--surface-hover-color, #f1f5f9);color:var(--text-color, #1e293b);border:1px solid var(--border-color, #e2e8f0)}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--surface-hover-color-dark, #e2e8f0);transform:translateY(-1px)}.btn-warn[_ngcontent-%COMP%]{background:var(--warn-color, #ef4444);color:#fff;box-shadow:0 4px 12px #ef44444d}.btn-warn[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--warn-color-dark, #dc2626);transform:translateY(-1px);box-shadow:0 6px 16px #ef444466}.btn-accent[_ngcontent-%COMP%]{background:var(--accent-color, #8b5cf6);color:#fff;box-shadow:0 4px 12px #8b5cf64d}.btn-accent[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--accent-color-dark, #7c3aed);transform:translateY(-1px);box-shadow:0 6px 16px #8b5cf666}.btn-icon[_ngcontent-%COMP%]{font-size:16px}.btn-text[_ngcontent-%COMP%]{font-weight:600}.btn-loader[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid transparent;border-top:2px solid currentColor;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.notification-types[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.notification-type[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border:1px solid var(--border-color, #e2e8f0);border-radius:12px;background:var(--surface-hover-color, #f8fafc);transition:all .2s ease}.notification-type[_ngcontent-%COMP%]:hover{background:var(--surface-hover-color-dark, #f1f5f9);border-color:var(--primary-color, #3b82f6)}.type-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;flex:1}.type-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;background:var(--primary-color, #3b82f6);display:flex;align-items:center;justify-content:center;color:#fff;font-size:20px}.type-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 4px}.type-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0;line-height:1.4}.token-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.token-display[_ngcontent-%COMP%]{background:var(--surface-hover-color, #f8fafc);border:1px solid var(--border-color, #e2e8f0);border-radius:12px;padding:16px}.token-label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:var(--text-muted, #64748b);margin-bottom:8px;text-transform:uppercase;letter-spacing:.5px}.token-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.token-value[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{flex:1;font-family:Courier New,monospace;font-size:12px;color:var(--text-color, #1e293b);word-break:break-all;background:#0000000d;padding:8px 12px;border-radius:6px}.copy-btn[_ngcontent-%COMP%]{background:var(--primary-color, #3b82f6);color:#fff;border:none;padding:8px;border-radius:6px;cursor:pointer;transition:all .2s ease}.copy-btn[_ngcontent-%COMP%]:hover{background:var(--primary-color-dark, #2563eb);transform:scale(1.05)}.advanced-settings[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.setting-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border:1px solid var(--border-color, #e2e8f0);border-radius:12px;background:var(--surface-hover-color, #f8fafc);transition:all .2s ease}.setting-item[_ngcontent-%COMP%]:hover{background:var(--surface-hover-color-dark, #f1f5f9);border-color:var(--primary-color, #3b82f6)}.setting-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;flex:1}.setting-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;background:var(--accent-color, #8b5cf6);display:flex;align-items:center;justify-content:center;color:#fff;font-size:18px}.setting-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 4px}.setting-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0;line-height:1.4}  .mat-mdc-slide-toggle .mdc-switch .mdc-switch__track{background-color:#cbd5e1;border-color:#cbd5e1}  .mat-mdc-slide-toggle .mdc-switch .mdc-switch__handle-track{background-color:var(--primary-color, #3b82f6)}  .mat-mdc-slide-toggle .mdc-switch .mdc-switch__handle{background-color:#fff;box-shadow:0 2px 4px #0003}  .mat-mdc-slide-toggle.mat-mdc-slide-toggle-checked .mdc-switch .mdc-switch__track{background-color:var(--primary-color, #3b82f6);border-color:var(--primary-color, #3b82f6)}  .mat-mdc-slide-toggle .mdc-form-field .mdc-form-field__label{display:none}.notification-type[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mdc-switch, .setting-item[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mdc-switch{width:48px;height:24px}.disabled-state[_ngcontent-%COMP%]{text-align:center;padding:48px 24px}.disabled-content[_ngcontent-%COMP%]{max-width:400px;margin:0 auto}.disabled-icon[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:var(--surface-hover-color, #f8fafc);display:flex;align-items:center;justify-content:center;margin:0 auto 24px;font-size:32px;color:var(--text-muted, #64748b)}.disabled-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 12px}.disabled-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0;line-height:1.5}@media (max-width: 768px){.notification-settings[_ngcontent-%COMP%]{padding:16px}.settings-header[_ngcontent-%COMP%]{padding:24px 20px}.header-content[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:20px}.header-text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px}.setting-section[_ngcontent-%COMP%]{padding:20px}.card-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.action-buttons[_ngcontent-%COMP%]{flex-direction:column}.action-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}.notification-type[_ngcontent-%COMP%], .setting-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.type-content[_ngcontent-%COMP%], .setting-content[_ngcontent-%COMP%]{width:100%}}"]});let e=i;return e})();function mY(e,i){if(e&1&&(s(0,"mat-error"),d(1),c()),e&2){let n=v();u(),L(n.getFieldError("name"))}}function gY(e,i){if(e&1&&(s(0,"mat-error"),d(1),c()),e&2){let n=v();u(),L(n.getFieldError("email"))}}function uY(e,i){if(e&1&&(s(0,"mat-error"),d(1),c()),e&2){let n=v();u(),L(n.getFieldError("subject"))}}function pY(e,i){if(e&1&&(s(0,"mat-option",39)(1,"div",40)(2,"mat-icon"),d(3),c(),s(4,"span"),d(5),c()()()),e&2){let n=i.$implicit;P("value",n.value),u(3),L(n.icon),u(2),L(n.label)}}function fY(e,i){if(e&1&&(s(0,"mat-error"),d(1),c()),e&2){let n=v();u(),L(n.getFieldError("category"))}}function hY(e,i){if(e&1&&(s(0,"mat-option",39)(1,"div",41),re(2,"div",42),s(3,"span"),d(4),c()()()),e&2){let n=i.$implicit;P("value",n.value),u(2),wt("background-color",n.color),u(2),L(n.label)}}function _Y(e,i){if(e&1&&(s(0,"mat-error"),d(1),c()),e&2){let n=v();u(),L(n.getFieldError("priority"))}}function xY(e,i){if(e&1){let n=ue();s(0,"button",43),F("click",function(){let r=R(n).$implicit,a=v();return B(a.setRating(r))})("mouseenter",function(){let r=R(n).$implicit,a=v();return B(a.setRating(r))})("mouseleave",function(){let r;R(n);let a=v();return B(a.setRating(((r=a.feedbackForm.get("rating"))==null?null:r.value)||0))}),s(1,"mat-icon"),d(2),c()()}if(e&2){let n,t,r=i.index,a=v();ze("active",((n=a.feedbackForm.get("rating"))==null?null:n.value)&&r<((n=a.feedbackForm.get("rating"))==null?null:n.value)),u(2),L(r<(((t=a.feedbackForm.get("rating"))==null?null:t.value)||0)?"star":"star_border")}}function CY(e,i){if(e&1&&(s(0,"span",44),d(1),c()),e&2){let n,t=v();u(),ne(" ",(n=t.feedbackForm.get("rating"))==null?null:n.value,"/5 stars ")}}function vY(e,i){if(e&1&&(s(0,"mat-error"),d(1),c()),e&2){let n=v();u(),L(n.getFieldError("message"))}}function bY(e,i){e&1&&(s(0,"mat-icon"),d(1,"send"),c())}function yY(e,i){e&1&&re(0,"mat-spinner",45)}var X2=(()=>{let i=class i{constructor(t,r,a,o,l,m,g){this.fb=t,this.dialog=r,this.breakpointObserver=a,this.auth=o,this.notificationService=l,this.hapticFeedback=m,this.feedbackService=g,this.isMobile=!1,this.isSubmitting=!1,this.currentUser=null,this.destroy$=new Bt,this.appName=Ut.APP_NAME,this.feedbackCategories=[{value:"bug",label:"Bug Report",icon:"bug_report"},{value:"feature",label:"Feature Request",icon:"lightbulb"},{value:"improvement",label:"Improvement Suggestion",icon:"trending_up"},{value:"general",label:"General Feedback",icon:"chat"},{value:"support",label:"Support Request",icon:"help"}],this.priorityLevels=[{value:"low",label:"Low",color:"#10b981"},{value:"medium",label:"Medium",color:"#f59e0b"},{value:"high",label:"High",color:"#ef4444"}],this.ratingOptions=[1,2,3,4,5],this.feedbackForm=this.createForm(),this.breakpointObserver.observe([Oc.Handset]).pipe(yt(this.destroy$)).subscribe(f=>{this.isMobile=f.matches})}ngOnInit(){this.initializeUser()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeUser(){return me(this,null,function*(){this.currentUser=yield this.auth.currentUser,this.currentUser&&this.feedbackForm.patchValue({name:this.currentUser.displayName||"",email:this.currentUser.email||""})})}createForm(){return this.fb.group({name:["",[tt.required,tt.minLength(2),tt.maxLength(50)]],email:["",[tt.required,tt.email]],subject:["",[tt.required,tt.minLength(5),tt.maxLength(100)]],message:["",[tt.required,tt.minLength(10),tt.maxLength(1e3)]],category:["general",tt.required],priority:["medium",tt.required],rating:[null]})}getCategoryIcon(t){let r=this.feedbackCategories.find(a=>a.value===t);return r?r.icon:"chat"}getPriorityColor(t){let r=this.priorityLevels.find(a=>a.value===t);return r?r.color:"#6b7280"}setRating(t){this.feedbackForm.patchValue({rating:t}),this.isMobile&&this.hapticFeedback.lightVibration()}getRatingStars(t){return Array.from({length:5},(r,a)=>a<t)}submitFeedback(){return me(this,null,function*(){var t;if(this.feedbackForm.invalid){this.markFormGroupTouched(),this.notificationService.warning("Please fill in all required fields correctly");return}if(!this.isSubmitting){this.isSubmitting=!0,this.isMobile&&this.hapticFeedback.lightVibration();try{let r=le(oe({},this.feedbackForm.value),{userId:((t=this.currentUser)==null?void 0:t.uid)||"anonymous"});yield this.feedbackService.submitFeedback(r),this.notificationService.success("Thank you for your feedback! We'll get back to you soon."),this.resetForm()}catch(r){console.error("Error submitting feedback:",r),this.notificationService.error("Failed to submit feedback. Please try again.")}finally{this.isSubmitting=!1}}})}resetForm(){this.feedbackForm.reset({category:"general",priority:"medium",rating:null}),this.currentUser&&this.feedbackForm.patchValue({name:this.currentUser.displayName||"",email:this.currentUser.email||""})}markFormGroupTouched(){Object.keys(this.feedbackForm.controls).forEach(t=>{let r=this.feedbackForm.get(t);r==null||r.markAsTouched()})}getFieldError(t){let r=this.feedbackForm.get(t);if(r!=null&&r.errors&&r.touched){if(r.errors.required)return`${this.getFieldLabel(t)} is required`;if(r.errors.email)return"Please enter a valid email address";if(r.errors.minlength)return`${this.getFieldLabel(t)} must be at least ${r.errors.minlength.requiredLength} characters`;if(r.errors.maxlength)return`${this.getFieldLabel(t)} must not exceed ${r.errors.maxlength.requiredLength} characters`}return""}getFieldLabel(t){return{name:"Name",email:"Email",subject:"Subject",message:"Message",category:"Category",priority:"Priority"}[t]||t}isFieldInvalid(t){let r=this.feedbackForm.get(t);return!!(r!=null&&r.invalid&&r.touched)}};i.\u0275fac=function(r){return new(r||i)(Y(vi),Y(xn),Y(dr),Y(xt),Y(ft),Y(mr),Y(zx))},i.\u0275cmp=Re({type:i,selectors:[["app-feedback"]],decls:117,vars:20,consts:[[1,"feedback-container"],[1,"feedback-header"],[1,"header-content"],[1,"page-title"],[1,"page-subtitle"],[1,"header-icon"],[1,"feedback-form-container"],[1,"feedback-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"section-title"],[1,"form-row"],["appearance","fill",1,"form-field"],["matInput","","formControlName","name","placeholder","Your name","maxlength","50"],[4,"ngIf"],["matInput","","formControlName","email","type","email","placeholder","your.email@example.com"],["matSuffix",""],["matInput","","formControlName","subject","placeholder","Brief description of your feedback","maxlength","100"],["appearance","fill",1,"form-field","category-field"],["formControlName","category"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill",1,"form-field","priority-field"],["formControlName","priority"],[1,"rating-section"],[1,"rating-label"],[1,"rating-stars"],["type","button","class","star-button",3,"active","click","mouseenter","mouseleave",4,"ngFor","ngForOf"],["class","rating-text",4,"ngIf"],["appearance","fill",1,"form-field","message-field"],["matInput","","formControlName","message","placeholder","Please provide detailed feedback, suggestions, or describe any issues you've encountered...","rows","6","maxlength","1000"],[1,"submit-section"],[1,"submit-info"],[1,"submit-actions"],["type","button","mat-stroked-button","",1,"reset-button",3,"click","disabled"],["type","submit","mat-raised-button","","color","primary",1,"submit-button",3,"disabled"],["diameter","20",4,"ngIf"],[1,"help-section"],[1,"help-title"],[1,"help-content"],[1,"help-item"],[3,"value"],[1,"category-option"],[1,"priority-option"],[1,"priority-indicator"],["type","button",1,"star-button",3,"click","mouseenter","mouseleave"],[1,"rating-text"],["diameter","20"]],template:function(r,a){if(r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),d(4,"Send Feedback"),c(),s(5,"p",4),d(6),c()(),s(7,"div",5)(8,"mat-icon"),d(9,"feedback"),c()()(),s(10,"div",6)(11,"form",7),F("ngSubmit",function(){return a.submitFeedback()}),s(12,"div",8)(13,"h3",9)(14,"mat-icon"),d(15,"person"),c(),d(16," Personal Information "),c(),s(17,"div",10)(18,"mat-form-field",11)(19,"mat-label"),d(20,"Name *"),c(),re(21,"input",12),N(22,mY,2,1,"mat-error",13),s(23,"mat-hint"),d(24),c()(),s(25,"mat-form-field",11)(26,"mat-label"),d(27,"Email *"),c(),re(28,"input",14),s(29,"mat-icon",15),d(30,"email"),c(),N(31,gY,2,1,"mat-error",13),c()()(),s(32,"div",8)(33,"h3",9)(34,"mat-icon"),d(35,"description"),c(),d(36," Feedback Details "),c(),s(37,"div",10)(38,"mat-form-field",11)(39,"mat-label"),d(40,"Subject *"),c(),re(41,"input",16),N(42,uY,2,1,"mat-error",13),s(43,"mat-hint"),d(44),c()()(),s(45,"div",10)(46,"mat-form-field",17)(47,"mat-label"),d(48,"Category *"),c(),s(49,"mat-select",18),N(50,pY,6,3,"mat-option",19),c(),N(51,fY,2,1,"mat-error",13),c(),s(52,"mat-form-field",20)(53,"mat-label"),d(54,"Priority *"),c(),s(55,"mat-select",21),N(56,hY,5,4,"mat-option",19),c(),N(57,_Y,2,1,"mat-error",13),c()(),s(58,"div",22)(59,"label",23),d(60,"How would you rate your experience? (Optional)"),c(),s(61,"div",24),N(62,xY,3,3,"button",25),c(),N(63,CY,2,1,"span",26),c(),s(64,"div",10)(65,"mat-form-field",27)(66,"mat-label"),d(67,"Message *"),c(),re(68,"textarea",28),N(69,vY,2,1,"mat-error",13),s(70,"mat-hint"),d(71),c()()()(),s(72,"div",29)(73,"div",30)(74,"mat-icon"),d(75,"info"),c(),s(76,"span"),d(77,"Your feedback will be sent to our team and we'll get back to you as soon as possible."),c()(),s(78,"div",31)(79,"button",32),F("click",function(){return a.resetForm()}),s(80,"mat-icon"),d(81,"refresh"),c(),d(82," Reset "),c(),s(83,"button",33),N(84,bY,2,0,"mat-icon",13)(85,yY,1,0,"mat-spinner",34),d(86),c()()()()(),s(87,"div",35)(88,"h3",36)(89,"mat-icon"),d(90,"help"),c(),d(91," Need Help? "),c(),s(92,"div",37)(93,"div",38)(94,"mat-icon"),d(95,"bug_report"),c(),s(96,"div")(97,"h4"),d(98,"Bug Report"),c(),s(99,"p"),d(100,"Found a bug? Please include steps to reproduce the issue and any error messages you see."),c()()(),s(101,"div",38)(102,"mat-icon"),d(103,"lightbulb"),c(),s(104,"div")(105,"h4"),d(106,"Feature Request"),c(),s(107,"p"),d(108,"Have an idea for a new feature? Let us know how it would help you manage your money better."),c()()(),s(109,"div",38)(110,"mat-icon"),d(111,"support"),c(),s(112,"div")(113,"h4"),d(114,"Support"),c(),s(115,"p"),d(116,"Need help using the app? We're here to assist you with any questions or concerns."),c()()()()()()),r&2){let o,l,m,g;u(6),ne("Help us improve ",a.appName," by sharing your thoughts, suggestions, or reporting issues."),u(5),P("formGroup",a.feedbackForm),u(11),P("ngIf",a.isFieldInvalid("name")),u(2),ne("",((o=a.feedbackForm.get("name"))==null||o.value==null?null:o.value.length)||0,"/50"),u(7),P("ngIf",a.isFieldInvalid("email")),u(11),P("ngIf",a.isFieldInvalid("subject")),u(2),ne("",((l=a.feedbackForm.get("subject"))==null||l.value==null?null:l.value.length)||0,"/100"),u(6),P("ngForOf",a.feedbackCategories),u(),P("ngIf",a.isFieldInvalid("category")),u(5),P("ngForOf",a.priorityLevels),u(),P("ngIf",a.isFieldInvalid("priority")),u(5),P("ngForOf",a.ratingOptions),u(),P("ngIf",(m=a.feedbackForm.get("rating"))==null?null:m.value),u(6),P("ngIf",a.isFieldInvalid("message")),u(2),ne("",((g=a.feedbackForm.get("message"))==null||g.value==null?null:g.value.length)||0,"/1000"),u(8),P("disabled",a.isSubmitting),u(4),P("disabled",a.feedbackForm.invalid||a.isSubmitting),u(),P("ngIf",!a.isSubmitting),u(),P("ngIf",a.isSubmitting),u(),ne(" ",a.isSubmitting?"Sending...":"Send Feedback"," ")}},dependencies:[or,dt,Wn,Nt,At,Yn,hc,xi,Ci,Jt,Qe,Br,Oi,Lr,nm,ja,$a,wi,yi,da],styles:["@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}.feedback-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:2rem;animation:_ngcontent-%COMP%_slideInUp .5s ease-out}@media (max-width: 768px){.feedback-container[_ngcontent-%COMP%]{padding:1rem}}.feedback-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:2rem;padding:1.5rem;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:16px;color:#fff;box-shadow:0 8px 32px #667eea4d}@media (max-width: 768px){.feedback-header[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:1rem}}.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1}.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin:0 0 .5rem;text-shadow:0 2px 4px rgba(0,0,0,.1)}@media (max-width: 768px){.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:1.5rem}}.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{font-size:1rem;margin:0;opacity:.9;line-height:1.5}@media (max-width: 768px){.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{font-size:.9rem}}.feedback-header[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;opacity:.8}@media (max-width: 768px){.feedback-header[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2.5rem;width:2.5rem;height:2.5rem}}.feedback-form-container[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:0 4px 20px #00000014;overflow:hidden;margin-bottom:2rem}.feedback-form-container[_ngcontent-%COMP%]   .feedback-form[_ngcontent-%COMP%]{padding:2rem}@media (max-width: 768px){.feedback-form-container[_ngcontent-%COMP%]   .feedback-form[_ngcontent-%COMP%]{padding:1.5rem}}.form-section[_ngcontent-%COMP%]{margin-bottom:2rem}.form-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.25rem;font-weight:600;color:#1f2937;margin:0 0 1.5rem;padding-bottom:.5rem;border-bottom:2px solid #e5e7eb}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1rem}@media (max-width: 768px){.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.75rem}}.form-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-field[_ngcontent-%COMP%]{width:100%}@media (max-width: 768px){.form-field.category-field[_ngcontent-%COMP%], .form-field.priority-field[_ngcontent-%COMP%]{grid-column:1}}.form-field.message-field[_ngcontent-%COMP%]{grid-column:1/-1}.category-option[_ngcontent-%COMP%], .priority-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.category-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .priority-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.2rem;width:1.2rem;height:1.2rem}.priority-indicator[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;flex-shrink:0}.rating-section[_ngcontent-%COMP%]{margin:1.5rem 0;padding:1rem;background:#f8fafc;border-radius:12px;border:1px solid #e2e8f0}.rating-section[_ngcontent-%COMP%]   .rating-label[_ngcontent-%COMP%]{display:block;font-weight:500;color:#374151;margin-bottom:.75rem}.rating-section[_ngcontent-%COMP%]   .rating-stars[_ngcontent-%COMP%]{display:flex;gap:.25rem;margin-bottom:.5rem}.rating-section[_ngcontent-%COMP%]   .rating-stars[_ngcontent-%COMP%]   .star-button[_ngcontent-%COMP%]{background:none;border:none;padding:.25rem;cursor:pointer;border-radius:4px;transition:all .2s ease}.rating-section[_ngcontent-%COMP%]   .rating-stars[_ngcontent-%COMP%]   .star-button[_ngcontent-%COMP%]:hover{background:#667eea1a;transform:scale(1.1)}.rating-section[_ngcontent-%COMP%]   .rating-stars[_ngcontent-%COMP%]   .star-button.active[_ngcontent-%COMP%]{color:#fbbf24}.rating-section[_ngcontent-%COMP%]   .rating-stars[_ngcontent-%COMP%]   .star-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem}.rating-section[_ngcontent-%COMP%]   .rating-text[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.submit-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:1.5rem;border-top:1px solid #e5e7eb}.submit-section[_ngcontent-%COMP%]   .submit-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:1.5rem;padding:1rem;background:#eff6ff;border-radius:8px;border-left:4px solid #3b82f6}.submit-section[_ngcontent-%COMP%]   .submit-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#3b82f6;flex-shrink:0}.submit-section[_ngcontent-%COMP%]   .submit-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;color:#1e40af;line-height:1.4}.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end}@media (max-width: 768px){.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]{flex-direction:column;gap:.75rem}}.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]   .reset-button[_ngcontent-%COMP%]{min-width:120px}@media (max-width: 768px){.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]   .reset-button[_ngcontent-%COMP%]{order:2}}.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]{min-width:160px;height:48px}@media (max-width: 768px){.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]{order:1}}.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-right:.5rem}.help-section[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:0 4px 20px #00000014;padding:2rem}@media (max-width: 768px){.help-section[_ngcontent-%COMP%]{padding:1.5rem}}.help-section[_ngcontent-%COMP%]   .help-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.25rem;font-weight:600;color:#1f2937;margin:0 0 1.5rem}.help-section[_ngcontent-%COMP%]   .help-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea}.help-section[_ngcontent-%COMP%]   .help-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}@media (max-width: 768px){.help-section[_ngcontent-%COMP%]   .help-content[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}}.help-section[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:1rem;background:#f8fafc;border-radius:12px;border:1px solid #e2e8f0;transition:all .2s ease}.help-section[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.help-section[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea;font-size:1.5rem;width:1.5rem;height:1.5rem;flex-shrink:0;margin-top:.125rem}.help-section[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#1f2937;margin:0 0 .5rem}.help-section[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin:0;line-height:1.5}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .feedback-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4c1d95,#7c3aed)}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .feedback-form-container[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .help-section[_ngcontent-%COMP%]{background:#1f2937;box-shadow:0 4px 20px #0000004d}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{color:#f9fafb;border-bottom-color:#374151}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .rating-section[_ngcontent-%COMP%]{background:#374151;border-color:#4b5563}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .rating-section[_ngcontent-%COMP%]   .rating-label[_ngcontent-%COMP%]{color:#f9fafb}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .submit-section[_ngcontent-%COMP%]{border-top-color:#374151}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .submit-section[_ngcontent-%COMP%]   .submit-info[_ngcontent-%COMP%]{background:#1e3a8a;border-left-color:#3b82f6}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .submit-section[_ngcontent-%COMP%]   .submit-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#dbeafe}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .help-section[_ngcontent-%COMP%]   .help-title[_ngcontent-%COMP%]{color:#f9fafb}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]{background:#374151;border-color:#4b5563}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#f9fafb}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#9ca3af}@media (max-width: 480px){.feedback-container[_ngcontent-%COMP%]{padding:.5rem}.feedback-header[_ngcontent-%COMP%]{padding:1rem}.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:1.25rem}.feedback-header[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2rem;width:2rem;height:2rem}.feedback-form-container[_ngcontent-%COMP%]   .feedback-form[_ngcontent-%COMP%], .help-section[_ngcontent-%COMP%]{padding:1rem}}.star-button[_ngcontent-%COMP%]:focus{outline:2px solid #667eea;outline-offset:2px}.form-field[_ngcontent-%COMP%]:focus-within   .mat-form-field-outline[_ngcontent-%COMP%]{color:#667eea}.submit-button[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.form-field.mat-form-field-disabled[_ngcontent-%COMP%]{opacity:.6}"]});let e=i;return e})();var K2=(()=>{let i=class i{};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=Re({type:i,selectors:[["app-app-shell"]],decls:23,vars:0,consts:[["id","app-shell",1,"app-shell"],[1,"app-shell-header"],[1,"app-shell-logo"],[1,"app-shell-logo-icon"],["src","assets/images/logo.svg","alt","Money Manager Logo",1,"logo-image"],[1,"font-heading","font-semibold","text-xl"],[1,"app-shell-skeleton","w-10","h-10","rounded-full"],[1,"app-shell-content"],[1,"app-shell-loading"],[1,"app-shell-spinner"],[1,"font-heading","font-semibold","text-2xl","mb-2"],[1,"text-sm","opacity-80"],[1,"w-full","max-w-md","mt-8"],[1,"app-shell-skeleton","app-shell-skeleton-header"],[1,"app-shell-skeleton","app-shell-skeleton-text"],[1,"app-shell-skeleton","app-shell-skeleton-text",2,"width","120px"],[1,"app-shell-skeleton","app-shell-skeleton-text",2,"width","180px"],[1,"app-shell-footer"],[1,"m-0","text-sm"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3),re(4,"img",4),c(),s(5,"span",5),d(6,"Money Manager"),c()(),re(7,"div",6),c(),s(8,"main",7)(9,"div",8),re(10,"div",9),s(11,"h2",10),d(12,"Loading Money Manager"),c(),s(13,"p",11),d(14,"Preparing your financial dashboard..."),c()(),s(15,"div",12),re(16,"div",13)(17,"div",14)(18,"div",15)(19,"div",16),c()(),s(20,"footer",17)(21,"p",18),d(22,"\xA9 2024 Money Manager - Your Personal Finance Assistant"),c()()())},styles:[".app-shell[_ngcontent-%COMP%]{font-family:Inter,sans-serif;background:#f9fafb;min-height:100vh;display:flex;flex-direction:column;color:#1f2937}.app-shell-header[_ngcontent-%COMP%]{background:#fff;padding:1rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e5e7eb;box-shadow:0 1px 3px #0000001a}.app-shell-logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-weight:600;font-size:1.25rem}.app-shell-logo-icon[_ngcontent-%COMP%]{width:32px;height:32px;background:#46777f;border-radius:8px;display:flex;align-items:center;justify-content:center}.app-shell-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;text-align:center}.app-shell-loading[_ngcontent-%COMP%]{margin:2rem 0}.app-shell-spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid #e5e7eb;border-top:4px solid #46777f;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}.app-shell-skeleton[_ngcontent-%COMP%]{background:#e5e7eb;border-radius:8px;margin:.5rem 0;animation:_ngcontent-%COMP%_pulse 2s cubic-bezier(.4,0,.6,1) infinite}.app-shell-skeleton-header[_ngcontent-%COMP%]{height:20px;width:200px;margin:0 auto 1rem}.app-shell-skeleton-text[_ngcontent-%COMP%]{height:16px;width:150px;margin:.5rem auto}.app-shell-footer[_ngcontent-%COMP%]{background:#fff;padding:1rem;text-align:center;font-size:.875rem;color:#6b7280;border-top:1px solid #e5e7eb}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}@media (max-width: 768px){.app-shell-content[_ngcontent-%COMP%]{padding:1rem}.app-shell-logo[_ngcontent-%COMP%]{font-size:1rem}.app-shell-logo-icon[_ngcontent-%COMP%]{width:28px;height:28px}}"]});let e=i;return e})();var Z2=(()=>{let i=class i{constructor(){this.lastUpdated="December 2024"}navigateBack(){window.history.back()}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=Re({type:i,selectors:[["app-privacy-policy"]],decls:182,vars:2,consts:[[1,"min-h-screen","bg-gray-50"],[1,"bg-white","shadow-sm","border-b"],[1,"container","mx-auto","px-4","py-4"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"p-2","rounded-lg","hover:bg-gray-100","transition-colors","duration-200",3,"click"],[1,"w-8","h-8","rounded-lg","flex","items-center","justify-center","bg-gradient-to-r","from-primary","to-primary-600"],["src","assets/icon/app-icon/icon-192x192.png","alt","Money Manager",1,"w-6","h-6"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"container","mx-auto","px-4","py-8","overflow-y-auto","h-screen"],[1,"max-w-4xl","mx-auto","bg-white","rounded-xl","shadow-sm","p-8"],[1,"mb-8"],[1,"text-2xl","font-bold","text-gray-900","mb-4"],[1,"text-gray-700","leading-relaxed","mb-4"],[1,"text-gray-700","leading-relaxed"],[1,"text-lg","font-semibold","text-gray-800","mb-3"],[1,"list-disc","list-inside","text-gray-700","mb-4","space-y-2"],[1,"list-disc","list-inside","text-gray-700","space-y-2"],[1,"bg-gray-50","rounded-lg","p-4"],[1,"space-y-2","text-gray-700"],[1,"border-t","pt-6","mt-8"],[1,"text-sm","text-gray-500","text-center"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),F("click",function(){return a.navigateBack()}),s(6,"mat-icon"),d(7,"arrow_back"),c()(),s(8,"div",4)(9,"div",6),re(10,"img",7),c(),s(11,"h1",8),d(12,"Privacy Policy"),c()()(),s(13,"div",9),d(14),c()()()(),s(15,"div",10)(16,"div",11)(17,"section",12)(18,"h2",13),d(19,"Introduction"),c(),s(20,"p",14),d(21,' Money Manager ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our money management application. '),c(),s(22,"p",15),d(23," By using our application, you agree to the collection and use of information in accordance with this policy. "),c()(),s(24,"section",12)(25,"h2",13),d(26,"Information We Collect"),c(),s(27,"h3",16),d(28,"Personal Information"),c(),s(29,"ul",17)(30,"li"),d(31,"Name and email address when you create an account"),c(),s(32,"li"),d(33,"Profile information you choose to provide"),c(),s(34,"li"),d(35,"Financial data you input (transactions, budgets, goals)"),c(),s(36,"li"),d(37,"Account preferences and settings"),c()(),s(38,"h3",16),d(39,"Usage Information"),c(),s(40,"ul",17)(41,"li"),d(42,"App usage patterns and features accessed"),c(),s(43,"li"),d(44,"Device information and browser type"),c(),s(45,"li"),d(46,"IP address and general location data"),c(),s(47,"li"),d(48,"Error logs and performance data"),c()()(),s(49,"section",12)(50,"h2",13),d(51,"How We Use Your Information"),c(),s(52,"ul",18)(53,"li"),d(54,"Provide and maintain our money management services"),c(),s(55,"li"),d(56,"Process your transactions and financial data"),c(),s(57,"li"),d(58,"Generate reports and insights about your finances"),c(),s(59,"li"),d(60,"Improve our application and user experience"),c(),s(61,"li"),d(62,"Send important updates and notifications"),c(),s(63,"li"),d(64,"Provide customer support and respond to inquiries"),c(),s(65,"li"),d(66,"Ensure security and prevent fraud"),c()()(),s(67,"section",12)(68,"h2",13),d(69,"Data Storage and Security"),c(),s(70,"p",14),d(71," We implement industry-standard security measures to protect your personal and financial information: "),c(),s(72,"ul",17)(73,"li"),d(74,"End-to-end encryption for sensitive data"),c(),s(75,"li"),d(76,"Secure cloud storage with regular backups"),c(),s(77,"li"),d(78,"Multi-factor authentication for account access"),c(),s(79,"li"),d(80,"Regular security audits and updates"),c(),s(81,"li"),d(82,"Limited access to personal data by authorized personnel only"),c()(),s(83,"p",15),d(84," Your data is stored securely and we never share your financial information with third parties without your explicit consent. "),c()(),s(85,"section",12)(86,"h2",13),d(87,"Data Sharing"),c(),s(88,"p",14),d(89," We do not sell, trade, or rent your personal information to third parties. We may share your information only in the following circumstances: "),c(),s(90,"ul",18)(91,"li"),d(92,"With your explicit consent"),c(),s(93,"li"),d(94,"To comply with legal obligations"),c(),s(95,"li"),d(96,"To protect our rights and prevent fraud"),c(),s(97,"li"),d(98,"With trusted service providers who assist in app operations (under strict confidentiality agreements)"),c()()(),s(99,"section",12)(100,"h2",13),d(101,"Your Rights"),c(),s(102,"p",14),d(103," You have the following rights regarding your personal information: "),c(),s(104,"ul",18)(105,"li")(106,"strong"),d(107,"Access:"),c(),d(108," Request a copy of your personal data"),c(),s(109,"li")(110,"strong"),d(111,"Correction:"),c(),d(112," Update or correct inaccurate information"),c(),s(113,"li")(114,"strong"),d(115,"Deletion:"),c(),d(116," Request deletion of your account and data"),c(),s(117,"li")(118,"strong"),d(119,"Portability:"),c(),d(120," Export your data in a standard format"),c(),s(121,"li")(122,"strong"),d(123,"Opt-out:"),c(),d(124," Unsubscribe from marketing communications"),c()()(),s(125,"section",12)(126,"h2",13),d(127,"Cookies and Tracking"),c(),s(128,"p",14),d(129," We use cookies and similar technologies to: "),c(),s(130,"ul",17)(131,"li"),d(132,"Remember your preferences and settings"),c(),s(133,"li"),d(134,"Analyze app usage and performance"),c(),s(135,"li"),d(136,"Provide personalized features"),c(),s(137,"li"),d(138,"Ensure security and prevent fraud"),c()(),s(139,"p",15),d(140," You can control cookie settings through your browser preferences. "),c()(),s(141,"section",12)(142,"h2",13),d(143,"Children's Privacy"),c(),s(144,"p",15),d(145," Our application is not intended for children under 13 years of age. We do not knowingly collect personal information from children under 13. If you are a parent or guardian and believe your child has provided us with personal information, please contact us immediately. "),c()(),s(146,"section",12)(147,"h2",13),d(148,"Changes to This Privacy Policy"),c(),s(149,"p",14),d(150," We may update this Privacy Policy from time to time. We will notify you of any changes by: "),c(),s(151,"ul",17)(152,"li"),d(153,"Posting the new Privacy Policy on this page"),c(),s(154,"li"),d(155,"Sending you an email notification"),c(),s(156,"li"),d(157,"Displaying a notice in the application"),c()(),s(158,"p",15),d(159," Your continued use of the application after any changes constitutes acceptance of the updated Privacy Policy. "),c()(),s(160,"section",12)(161,"h2",13),d(162,"Contact Us"),c(),s(163,"p",14),d(164," If you have any questions about this Privacy Policy or our data practices, please contact us: "),c(),s(165,"div",19)(166,"div",20)(167,"p")(168,"strong"),d(169,"Email:"),c(),d(170," Prashiln79@gmail.com"),c(),s(171,"p")(172,"strong"),d(173,"Address:"),c(),d(174," Goa, India"),c(),s(175,"p")(176,"strong"),d(177,"Response Time:"),c(),d(178," We aim to respond to all privacy-related inquiries within 48 hours."),c()()()(),s(179,"div",21)(180,"p",22),d(181),c()()()()()),r&2&&(u(14),ne(" Last updated: ",a.lastUpdated," "),u(167),ne(" This Privacy Policy is effective as of ",a.lastUpdated," and will remain in effect except with respect to any changes in its provisions in the future. "))},dependencies:[Qe],styles:[".privacy-policy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.privacy-policy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9}.privacy-policy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}.privacy-policy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}button[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}button[_ngcontent-%COMP%]:active{transform:translateY(0)}@media print{.bg-gray-50[_ngcontent-%COMP%]{background-color:#fff!important}.shadow-sm[_ngcontent-%COMP%]{box-shadow:none!important}button[_ngcontent-%COMP%]{display:none!important}}"]});let e=i;return e})();var Q2=(()=>{let i=class i{constructor(){this.lastUpdated="December 2024"}navigateBack(){window.history.back()}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=Re({type:i,selectors:[["app-terms-conditions"]],decls:224,vars:2,consts:[[1,"min-h-screen","bg-gray-50"],[1,"bg-white","shadow-sm","border-b"],[1,"container","mx-auto","px-4","py-4"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"p-2","rounded-lg","hover:bg-gray-100","transition-colors","duration-200",3,"click"],[1,"w-8","h-8","rounded-lg","flex","items-center","justify-center","bg-gradient-to-r","from-primary","to-primary-600"],["src","assets/icon/app-icon/icon-192x192.png","alt","Money Manager",1,"w-6","h-6"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"container","mx-auto","px-4","py-8","overflow-y-auto","h-screen"],[1,"max-w-4xl","mx-auto","bg-white","rounded-xl","shadow-sm","p-8"],[1,"mb-8"],[1,"text-2xl","font-bold","text-gray-900","mb-4"],[1,"text-gray-700","leading-relaxed","mb-4"],[1,"text-gray-700","leading-relaxed"],[1,"list-disc","list-inside","text-gray-700","mb-4","space-y-2"],[1,"text-lg","font-semibold","text-gray-800","mb-3"],[1,"bg-gray-50","rounded-lg","p-4"],[1,"space-y-2","text-gray-700"],[1,"border-t","pt-6","mt-8"],[1,"text-sm","text-gray-500","text-center"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),F("click",function(){return a.navigateBack()}),s(6,"mat-icon"),d(7,"arrow_back"),c()(),s(8,"div",4)(9,"div",6),re(10,"img",7),c(),s(11,"h1",8),d(12,"Terms & Conditions"),c()()(),s(13,"div",9),d(14),c()()()(),s(15,"div",10)(16,"div",11)(17,"section",12)(18,"h2",13),d(19,"Introduction"),c(),s(20,"p",14),d(21,' Welcome to Money Manager. These Terms and Conditions ("Terms") govern your use of our money management application and services. By accessing or using our application, you agree to be bound by these Terms. '),c(),s(22,"p",15),d(23," If you do not agree with any part of these Terms, you may not access or use our application. "),c()(),s(24,"section",12)(25,"h2",13),d(26,"Acceptance of Terms"),c(),s(27,"p",14),d(28," By creating an account, downloading, installing, or using the Money Manager application, you acknowledge that you have read, understood, and agree to be bound by these Terms and Conditions. "),c(),s(29,"p",15),d(30," These Terms constitute a legally binding agreement between you and Money Manager regarding your use of our services. "),c()(),s(31,"section",12)(32,"h2",13),d(33,"Description of Service"),c(),s(34,"p",14),d(35," Money Manager is a personal finance management application that allows users to: "),c(),s(36,"ul",16)(37,"li"),d(38,"Track income and expenses"),c(),s(39,"li"),d(40,"Manage multiple accounts and budgets"),c(),s(41,"li"),d(42,"Set financial goals and monitor progress"),c(),s(43,"li"),d(44,"Generate financial reports and insights"),c(),s(45,"li"),d(46,"Categorize transactions"),c(),s(47,"li"),d(48,"Import and export financial data"),c()(),s(49,"p",15),d(50," We reserve the right to modify, suspend, or discontinue any part of our service at any time with reasonable notice. "),c()(),s(51,"section",12)(52,"h2",13),d(53,"User Accounts"),c(),s(54,"h3",17),d(55,"Account Creation"),c(),s(56,"p",14),d(57," To use our services, you must create an account by providing accurate, current, and complete information. You are responsible for maintaining the confidentiality of your account credentials. "),c(),s(58,"h3",17),d(59,"Account Responsibilities"),c(),s(60,"ul",16)(61,"li"),d(62,"You are responsible for all activities that occur under your account"),c(),s(63,"li"),d(64,"You must notify us immediately of any unauthorized use of your account"),c(),s(65,"li"),d(66,"You must be at least 18 years old to create an account"),c(),s(67,"li"),d(68,"You may not share your account credentials with others"),c(),s(69,"li"),d(70,"You are responsible for maintaining the security of your device"),c()()(),s(71,"section",12)(72,"h2",13),d(73,"Acceptable Use"),c(),s(74,"p",14),d(75," You agree to use our application only for lawful purposes and in accordance with these Terms. You agree not to: "),c(),s(76,"ul",16)(77,"li"),d(78,"Use the service for any illegal or unauthorized purpose"),c(),s(79,"li"),d(80,"Attempt to gain unauthorized access to our systems or other users' accounts"),c(),s(81,"li"),d(82,"Interfere with or disrupt the service or servers"),c(),s(83,"li"),d(84,"Upload or transmit viruses, malware, or other harmful code"),c(),s(85,"li"),d(86,"Violate any applicable laws or regulations"),c(),s(87,"li"),d(88,"Use the service to store or transmit illegal content"),c(),s(89,"li"),d(90,"Reverse engineer, decompile, or disassemble the application"),c()()(),s(91,"section",12)(92,"h2",13),d(93,"Financial Information"),c(),s(94,"h3",17),d(95,"Data Accuracy"),c(),s(96,"p",14),d(97," You are responsible for the accuracy and completeness of all financial information you enter into the application. We are not responsible for any errors, omissions, or inaccuracies in your financial data. "),c(),s(98,"h3",17),d(99,"No Financial Advice"),c(),s(100,"p",14),d(101," Money Manager is a financial tracking tool and does not provide financial advice, investment recommendations, or tax advice. You should consult with qualified professionals for financial, investment, or tax advice. "),c(),s(102,"h3",17),d(103,"Third-Party Services"),c(),s(104,"p",15),d(105," Our application may integrate with third-party financial institutions or services. We are not responsible for the accuracy, availability, or security of these third-party services. "),c()(),s(106,"section",12)(107,"h2",13),d(108,"Privacy and Data Protection"),c(),s(109,"p",14),d(110," Your privacy is important to us. Our collection and use of your personal information is governed by our Privacy Policy, which is incorporated into these Terms by reference. "),c(),s(111,"p",15),d(112," By using our service, you consent to the collection and use of your information as described in our Privacy Policy. "),c()(),s(113,"section",12)(114,"h2",13),d(115,"Subscription and Payment"),c(),s(116,"h3",17),d(117,"Free and Premium Plans"),c(),s(118,"p",14),d(119," We offer both free and premium subscription plans. Premium features require a paid subscription. Subscription fees are billed in advance and are non-refundable except as required by law. "),c(),s(120,"h3",17),d(121,"Payment Terms"),c(),s(122,"ul",16)(123,"li"),d(124,"All fees are exclusive of applicable taxes"),c(),s(125,"li"),d(126,"Subscriptions automatically renew unless cancelled"),c(),s(127,"li"),d(128,"You may cancel your subscription at any time"),c(),s(129,"li"),d(130,"No refunds for partial months or unused periods"),c(),s(131,"li"),d(132,"We may change subscription fees with 30 days' notice"),c()()(),s(133,"section",12)(134,"h2",13),d(135,"Intellectual Property"),c(),s(136,"p",14),d(137," The Money Manager application, including its content, features, and functionality, is owned by us and is protected by copyright, trademark, and other intellectual property laws. "),c(),s(138,"p",14),d(139," You may not copy, modify, distribute, sell, or lease any part of our application without our written permission. "),c(),s(140,"p",15),d(141," You retain ownership of your financial data and content, but grant us a license to use it to provide our services. "),c()(),s(142,"section",12)(143,"h2",13),d(144,"Limitation of Liability"),c(),s(145,"p",14),d(146," To the maximum extent permitted by law, Money Manager shall not be liable for any indirect, incidental, special, consequential, or punitive damages, including but not limited to: "),c(),s(147,"ul",16)(148,"li"),d(149,"Loss of profits, data, or use"),c(),s(150,"li"),d(151,"Business interruption"),c(),s(152,"li"),d(153,"Financial losses"),c(),s(154,"li"),d(155,"Security breaches"),c(),s(156,"li"),d(157,"Service interruptions"),c()(),s(158,"p",15),d(159," Our total liability shall not exceed the amount you paid for our services in the 12 months preceding the claim. "),c()(),s(160,"section",12)(161,"h2",13),d(162,"Disclaimers"),c(),s(163,"p",14),d(164,' THE SERVICE IS PROVIDED "AS IS" AND "AS AVAILABLE" WITHOUT WARRANTIES OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO: '),c(),s(165,"ul",16)(166,"li"),d(167,"Warranties of merchantability or fitness for a particular purpose"),c(),s(168,"li"),d(169,"Warranties that the service will be uninterrupted or error-free"),c(),s(170,"li"),d(171,"Warranties regarding the accuracy or reliability of financial data"),c(),s(172,"li"),d(173,"Warranties that defects will be corrected"),c()()(),s(174,"section",12)(175,"h2",13),d(176,"Termination"),c(),s(177,"p",14),d(178," We may terminate or suspend your account and access to our services at any time, with or without cause, with or without notice. "),c(),s(179,"p",14),d(180," Upon termination, your right to use the service will cease immediately. We may delete your account and data, though we will provide reasonable notice before permanent deletion. "),c(),s(181,"p",15),d(182," You may terminate your account at any time by contacting us or using the account deletion feature in the application. "),c()(),s(183,"section",12)(184,"h2",13),d(185,"Governing Law"),c(),s(186,"p",15),d(187," These Terms shall be governed by and construed in accordance with the laws of India. Any disputes arising from these Terms or your use of our service shall be resolved in the courts of Goa, India. "),c()(),s(188,"section",12)(189,"h2",13),d(190,"Changes to These Terms"),c(),s(191,"p",14),d(192," We reserve the right to modify these Terms at any time. We will notify you of any changes by: "),c(),s(193,"ul",16)(194,"li"),d(195,"Posting the updated Terms in the application"),c(),s(196,"li"),d(197,"Sending you an email notification"),c(),s(198,"li"),d(199,"Displaying a notice when you next access the service"),c()(),s(200,"p",15),d(201," Your continued use of the service after any changes constitutes acceptance of the updated Terms. "),c()(),s(202,"section",12)(203,"h2",13),d(204,"Contact Us"),c(),s(205,"p",14),d(206," If you have any questions about these Terms and Conditions, please contact us: "),c(),s(207,"div",18)(208,"div",19)(209,"p")(210,"strong"),d(211,"Email:"),c(),d(212," Prashiln79@gmail.com"),c(),s(213,"p")(214,"strong"),d(215,"Address:"),c(),d(216," Goa, India"),c(),s(217,"p")(218,"strong"),d(219,"Response Time:"),c(),d(220," We aim to respond to all inquiries within 48 hours."),c()()()(),s(221,"div",20)(222,"p",21),d(223),c()()()()()),r&2&&(u(14),ne(" Last updated: ",a.lastUpdated," "),u(209),ne(" These Terms and Conditions are effective as of ",a.lastUpdated," and will remain in effect except with respect to any changes in its provisions in the future. "))},dependencies:[Qe],styles:["[_nghost-%COMP%]{display:block;height:100vh;overflow-y:auto}[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.dark[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#374151}.dark[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#6b7280}.dark[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.max-w-4xl[_ngcontent-%COMP%]{margin-left:.5rem;margin-right:.5rem}}"]});let e=i;return e})();var J2=(()=>{let i=class i{constructor(t,r){this.commonSyncService=t,this.ssrService=r}retryConnection(){this.commonSyncService.isCurrentlyOnline()?this.ssrService.isClientSide()&&(window.location.href="/dashboard"):alert("Still offline. Please check your internet connection.")}openOfflineData(){this.ssrService.isClientSide()&&(window.location.href="/dashboard")}};i.\u0275fac=function(r){return new(r||i)(Y(qr),Y(Vr))},i.\u0275cmp=Re({type:i,selectors:[["app-offline-page"]],decls:37,vars:0,consts:[[1,"min-h-screen","bg-gray-50","flex","items-center","justify-center","px-4"],[1,"max-w-md","w-full","text-center"],[1,"mb-8"],[1,"mx-auto","w-24","h-24","bg-yellow-100","rounded-full","flex","items-center","justify-center"],[1,"text-4xl","text-yellow-600"],[1,"text-2xl","font-bold","text-gray-900","mb-4"],[1,"text-gray-600","mb-8"],[1,"bg-white","rounded-lg","p-4","mb-6","shadow-sm","border"],[1,"flex","items-center","justify-between"],[1,"text-sm","text-gray-600"],[1,"text-sm","font-medium","text-yellow-600"],[1,"space-y-3"],["mat-raised-button","","color","primary",1,"w-full",3,"click"],[1,"mr-2"],["mat-stroked-button","",1,"w-full",3,"click"],[1,"mt-8","p-4","bg-blue-50","rounded-lg"],[1,"text-sm","font-medium","text-blue-900","mb-2"],[1,"text-xs","text-blue-800","space-y-1"]],template:function(r,a){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-icon",4),d(5,"wifi_off"),c()()(),s(6,"h1",5),d(7," You're Offline "),c(),s(8,"p",6),d(9," It looks like you don't have an internet connection right now. Don't worry - your data is saved locally and will sync when you're back online. "),c(),s(10,"div",7)(11,"div",8)(12,"span",9),d(13,"Connection Status:"),c(),s(14,"span",10),d(15,"Offline"),c()()(),s(16,"div",11)(17,"button",12),F("click",function(){return a.retryConnection()}),s(18,"mat-icon",13),d(19,"refresh"),c(),d(20," Try Again "),c(),s(21,"button",14),F("click",function(){return a.openOfflineData()}),s(22,"mat-icon",13),d(23,"storage"),c(),d(24," View Offline Data "),c()(),s(25,"div",15)(26,"h3",16),d(27,"Offline Tips:"),c(),s(28,"ul",17)(29,"li"),d(30,"\u2022 Your transactions are saved locally"),c(),s(31,"li"),d(32,"\u2022 Changes will sync when connection is restored"),c(),s(33,"li"),d(34,"\u2022 Check your internet connection"),c(),s(35,"li"),d(36,"\u2022 Try refreshing the page"),c()()()()())},dependencies:[Jt,Qe],styles:["[_nghost-%COMP%]{display:block}"]});let e=i;return e})();var MY=[{path:"shell",component:K2},{path:"landing",component:Xy},{path:"privacy-policy",component:Z2},{path:"terms-conditions",component:Q2},{path:"offline",component:J2},{path:"sign-in",component:Vu},{path:"sign-up",component:Vu},{path:"register",component:L_},{path:"dashboard",component:mC,canActivate:[Bu],data:{requireEmailVerification:!0,requireActiveSession:!0},children:[{path:"",component:Qu},{path:"home",component:Qu},{path:"accounts",component:Zm,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"category",component:tg,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"reports",component:ag,data:{roles:["premium","admin"],requireEmailVerification:!0}},{path:"transactions",component:qy,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"tax",component:Ug,data:{roles:["premium","admin"],requireEmailVerification:!0}},{path:"subscription",component:Zy,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"goals",component:e2,data:{roles:["premium","admin"],requireEmailVerification:!0}},{path:"splitwise",loadChildren:()=>import("./chunk-LDB22UV3.js").then(e=>e.SplitwiseModule),data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"google-sheets",component:n2,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"openai-interaction",component:r2,data:{roles:["premium","admin"],requireEmailVerification:!0}},{path:"budgets",component:c2,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"notes",component:zg,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"import",component:xl,data:{roles:["premium","admin"],requireEmailVerification:!0}},{path:"profile",component:d2,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"notifications",component:q2,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"feedback",component:X2,data:{roles:["free","premium","admin"],requireEmailVerification:!0}}]},{path:"admin",loadChildren:()=>import("./chunk-HIXKF422.js").then(e=>e.AdminModule),canActivate:[Bu,_x],data:{requireEmailVerification:!0,requireActiveSession:!0,roles:["admin"]}},{path:"",redirectTo:"/dashboard",pathMatch:"full"}],eM=(()=>{let i=class i{};i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=ir({type:i}),i.\u0275inj=nr({imports:[Al.forRoot(MY,{useHash:!0}),Al]});let e=i;return e})();var Kg=(()=>{let i=class i{constructor(t,r,a,o,l){this.location=t,this.router=r,this.platform=a,this.ngZone=o,this.platformId=l,this.navigationStateSubject=new on({canGoBack:!1,currentRoute:"",previousRoute:"",navigationStack:[],isStandalone:!1,isMobile:!1}),this.destroy$=new Bt,this.navigationStack=[],this.maxStackSize=50,this.navigationState$=this.navigationStateSubject.asObservable(),this.canGoBack$=this.navigationState$.pipe(Bi(m=>m.canGoBack),We(m=>m.canGoBack)),Uo(this.platformId)||this.initializePwaNavigation()}initializePwaNavigation(){let t=this.isStandalonePwa(),r=this.isMobileDevice();this.navigationStack=[],this.router.events.pipe(Bi(o=>o instanceof a0),yt(this.destroy$)).subscribe(o=>{this.ngZone.run(()=>{this.handleNavigationEnd(o)})}),this.router.events.pipe(Bi(o=>o instanceof N1),yt(this.destroy$)).subscribe(o=>{this.ngZone.run(()=>{this.handleNavigationStart(o)})});let a=()=>{this.ngZone.run(()=>{this.handlePopState()})};typeof window<"u"&&(window.addEventListener("popstate",a),this.destroy$.subscribe(()=>{window.removeEventListener("popstate",a)})),r&&this.setupHardwareBackButton(),this.setupKeyboardNavigation(),this.updateNavigationState({isStandalone:t,isMobile:r,currentRoute:this.router.url})}isStandalonePwa(){return Uo(this.platformId)?!1:window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}isMobileDevice(){return Uo(this.platformId)?!1:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}handleNavigationStart(t){t.url!==this.navigationStateSubject.value.currentRoute&&this.addToNavigationStack(this.navigationStateSubject.value.currentRoute)}handleNavigationEnd(t){let a=this.navigationStateSubject.value.currentRoute;this.updateNavigationState({currentRoute:t.url,previousRoute:a,canGoBack:this.navigationStack.length>0||this.canNavigateBack()})}handlePopState(){let t=this.router.url,r=this.navigationStateSubject.value;t!==r.currentRoute&&this.updateNavigationState({currentRoute:t,previousRoute:r.currentRoute,canGoBack:this.navigationStack.length>0||this.canNavigateBack()})}setupHardwareBackButton(){if(this.platform.ANDROID){let t=r=>{r.preventDefault(),this.ngZone.run(()=>{this.handleHardwareBackButton()})};document.addEventListener("backbutton",t,!1),this.destroy$.subscribe(()=>{document.removeEventListener("backbutton",t)})}this.platform.IOS&&this.setupIosBackGesture()}setupIosBackGesture(){let t=0,r=0,a=50,o=m=>{t=m.touches[0].clientX,r=m.touches[0].clientY},l=m=>{let g=m.changedTouches[0].clientX,f=m.changedTouches[0].clientY,h=t-g,x=Math.abs(r-f);h>a&&x<a&&t<50&&this.ngZone.run(()=>{this.handleHardwareBackButton()})};document.addEventListener("touchstart",o,{passive:!0}),document.addEventListener("touchend",l,{passive:!0}),this.destroy$.subscribe(()=>{document.removeEventListener("touchstart",o),document.removeEventListener("touchend",l)})}setupKeyboardNavigation(){let t=r=>{r.altKey&&r.key==="ArrowLeft"&&(r.preventDefault(),this.ngZone.run(()=>{this.goBack()})),r.key==="Escape"&&this.ngZone.run(()=>{this.handleEscapeKey()})};document.addEventListener("keydown",t),this.destroy$.subscribe(()=>{document.removeEventListener("keydown",t)})}handleHardwareBackButton(){let t=this.navigationStateSubject.value;if(this.isInModal()){this.closeModal();return}t.canGoBack?this.goBack():this.showExitConfirmation()}handleEscapeKey(){this.isInModal()&&this.closeModal()}isInModal(){return document.querySelectorAll('.modal, .dialog, [role="dialog"]').length>0}closeModal(){let t=document.querySelectorAll('.modal, .dialog, [role="dialog"]');if(t.length>0){let a=t[t.length-1].querySelector('[data-dismiss="modal"], .close, .modal-close');a&&a.click()}}showExitConfirmation(){this.navigationStateSubject.value.isStandalone&&confirm("Do you want to exit the app?")&&this.exitApp()}exitApp(){this.navigationStateSubject.value.isStandalone&&window.close()}addToNavigationStack(t){t&&t!=="/"&&(this.navigationStack.push(t),this.navigationStack.length>this.maxStackSize&&this.navigationStack.shift())}canNavigateBack(){return this.navigationStack.length>0||window.history.length>1}goBack(){let t=this.navigationStateSubject.value;if(this.navigationStack.length>0){let r=this.navigationStack.pop();if(r){this.router.navigateByUrl(r);return}}window.history.length>1?this.location.back():this.router.navigate(["/dashboard"])}goForward(){this.location.forward()}navigateTo(t){this.router.navigateByUrl(t)}clearNavigationStack(){this.navigationStack=[],this.updateNavigationState({canGoBack:!1,navigationStack:[]})}getNavigationStack(){return[...this.navigationStack]}isStandaloneMode(){return this.navigationStateSubject.value.isStandalone}isMobileMode(){return this.navigationStateSubject.value.isMobile}updateNavigationState(t){let r=this.navigationStateSubject.value,a=oe(oe({},r),t);t.navigationStack&&(this.navigationStack=t.navigationStack),this.navigationStateSubject.next(a)}destroy(){this.destroy$.next(),this.destroy$.complete(),this.navigationStack=[],this.navigationStateSubject.next({canGoBack:!1,currentRoute:"",previousRoute:"",navigationStack:[],isStandalone:!1,isMobile:!1})}};i.\u0275fac=function(r){return new(r||i)(De(n0),De(nn),De(A_),De(Dr),De(Kd))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();function PY(e,i){e&1&&(s(0,"div",1)(1,"div",2),re(2,"div",3),s(3,"span",4),d(4,"Offline"),c()()()),e&2&&P("@slideDown",void 0)}function OY(e,i){e&1&&(s(0,"div",1)(1,"div",5),re(2,"div",6),s(3,"span",7),d(4,"Connected"),c()()()),e&2&&P("@slideDown",void 0)}var tM=(()=>{let i=class i{constructor(t,r){this.commonSyncService=t,this.notificationService=r,this.isOnline=!0,this.showOnlineBanner=!1,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.commonSyncService.networkStatus$.subscribe(t=>{let r=this.isOnline;this.isOnline=t.online,this.isOnline||console.log("You are offline. Please check your internet connection."),!r&&this.isOnline&&(this.showOnlineBanner=!0,console.log("Connection restored. Syncing data..."),setTimeout(()=>{this.showOnlineBanner=!1},Ut.NOTIFICATIONS.AUTO_HIDE_DELAY))}))}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}dismissOfflineBanner(){}dismissOnlineBanner(){this.showOnlineBanner=!1}};i.\u0275fac=function(r){return new(r||i)(Y(qr),Y(ft))},i.\u0275cmp=Re({type:i,selectors:[["app-offline-indicator"]],decls:2,vars:2,consts:[["class","fixed top-3 left-12 z-50",4,"ngIf"],[1,"fixed","top-3","left-12","z-50"],[1,"flex","items-center","space-x-2","bg-gray-800","bg-opacity-50","rounded-full","px-3","py-1","shadow-lg"],[1,"w-2","h-2","bg-red-500","rounded-full"],[1,"text-white","text-xm","font-medium"],[1,"flex","items-center","space-x-2","bg-green-500","bg-opacity-90","rounded-full","px-3","py-1","shadow-lg"],[1,"w-2","h-2","bg-white","rounded-full"],[1,"text-white","text-sm","font-medium"]],template:function(r,a){r&1&&N(0,PY,5,1,"div",0)(1,OY,5,1,"div",0),r&2&&(P("ngIf",!a.isOnline),u(),P("ngIf",a.showOnlineBanner))},dependencies:[dt],styles:["[_nghost-%COMP%]{display:block}.offline-banner[_ngcontent-%COMP%]{transition:all .3s ease}.offline-banner[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026}.online-banner[_ngcontent-%COMP%]{transition:all .3s ease}.online-banner[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026}.connection-indicator[_ngcontent-%COMP%]{transition:all .2s ease}.connection-indicator[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.close-button[_ngcontent-%COMP%]{transition:all .2s ease}.close-button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}"],data:{animation:[K0("slideDown",[kc("void",Sc({transform:"translateY(-100%)",opacity:0})),kc("*",Sc({transform:"translateY(0)",opacity:1})),Tc("void => *",[wc("0.3s ease-out")]),Tc("* => void",[wc("0.2s ease-in")])])]}});let e=i;return e})();var nM=(()=>{let i=class i{constructor(t){this.swUpdate=t,this.updateInfoSubject=new on({available:!1,currentVersion:"",newVersion:"",updateReady:!1}),this.updateInfo$=this.updateInfoSubject.asObservable(),this.initializeServiceWorker()}initializeServiceWorker(){if(this.swUpdate.isEnabled){this.checkForUpdates(),this.swUpdate.versionUpdates.pipe(Bi(r=>r.type==="VERSION_READY")).subscribe(r=>{console.log("New version ready:",r),this.handleVersionReady(r)}),this.swUpdate.unrecoverable.subscribe(r=>{console.error("Unrecoverable service worker error:",r),this.handleUnrecoverableError(r)});let t=Ut.PWA.UPDATE_CHECK_INTERVAL;setInterval(()=>{this.checkForUpdates()},t),document.addEventListener("visibilitychange",()=>{document.hidden||this.checkForUpdates()})}}checkForUpdates(){this.swUpdate.checkForUpdate().then(()=>{console.log("Service worker update check completed")}).catch(t=>{console.error("Service worker update check failed:",t)})}handleVersionReady(t){let r={available:!0,currentVersion:this.getVersionFromAppData(t.currentVersion.appData)||"unknown",newVersion:this.getVersionFromAppData(t.latestVersion.appData)||"unknown",updateReady:!0};this.updateInfoSubject.next(r),this.activateUpdateSilently()}getVersionFromAppData(t){if(t&&typeof t=="object")return t.version||t.version}handleUnrecoverableError(t){window.location.reload()}activateUpdateSilently(){return this.swUpdate.activateUpdate().then(()=>(console.log("Service worker update activated silently"),this.updateInfoSubject.next({available:!1,currentVersion:"",newVersion:"",updateReady:!1}),window.location.reload(),!0)).catch(t=>(console.error("Failed to activate service worker update:",t),!1))}activateUpdate(){return this.activateUpdateSilently()}checkForUpdate(){return this.swUpdate.checkForUpdate().then(t=>(console.log(t?"Update available":"No update available"),t)).catch(t=>(console.error("Update check failed:",t),!1))}getCurrentVersion(){return this.updateInfoSubject.value.currentVersion}isUpdateAvailable(){return this.updateInfoSubject.value.available}isUpdateReady(){return this.updateInfoSubject.value.updateReady}handleNavigationEvent(t){t&&t.type==="NAVIGATION"&&console.log("Navigation event received:",t)}registerCustomHandlers(){"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",t=>{if(t.data&&t.data.type)switch(t.data.type){case"NAVIGATION":this.handleNavigationEvent(t.data);break;case"CACHE_UPDATED":console.log("Cache updated:",t.data);break;case"OFFLINE_MODE":console.log("Offline mode activated");break;default:console.log("Unknown service worker message:",t.data)}})}sendMessageToSw(t){"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage(t)}handleInstallPrompt(){console.log("App ready for installation")}isAppInstalled(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}handleVisibilityChange(){document.hidden?(console.log("App went to background"),this.saveAppState()):(console.log("App came to foreground"),this.checkForUpdates())}saveAppState(){let t={timestamp:Date.now(),url:window.location.href,scrollPosition:window.scrollY};try{localStorage.setItem("app-background-state",JSON.stringify(t))}catch(r){console.warn("Failed to save app state:",r)}}};i.\u0275fac=function(r){return new(r||i)(De(Z_))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();function kY(e,i){if(e&1){let n=ue();s(0,"div",1)(1,"div",2)(2,"div",3),Ii(),s(3,"svg",4),re(4,"path",5)(5,"path",6)(6,"path",7),c()(),na(),s(7,"div",8)(8,"h3"),d(9),c(),s(10,"p"),d(11,"Add to your home screen for quick access and offline functionality"),c()(),s(12,"div",9)(13,"button",10),F("click",function(){R(n);let r=v();return B(r.installApp())}),d(14," Install App "),c(),s(15,"button",11),F("click",function(){R(n);let r=v();return B(r.dismissPrompt())}),d(16," Not Now "),c()(),s(17,"button",12),F("click",function(){R(n);let r=v();return B(r.dismissPrompt())}),Ii(),s(18,"svg",13),re(19,"path",14),c()()()()}if(e&2){let n=v();u(9),ne("Install ",n.APP_CONFIG.APP_NAME,""),u(8),Wr("aria-label","Close install prompt")}}var iM=(()=>{let i=class i{constructor(t,r){this.pwaSwService=t,this.ssrService=r,this.installClicked=new _n,this.dismissClicked=new _n,this.APP_CONFIG=Ut,this.showInstallPrompt=!1,this.destroy$=new Bt}ngOnInit(){this.setupInstallPrompt()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setupInstallPrompt(){this.ssrService.isClientSide()&&(window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),this.deferredPrompt=t;let r=localStorage.getItem("pwa-install-dismissed"),a=localStorage.getItem("pwa-install-dismissed-time"),o=!0;if(r&&a){let l=Date.now(),m=parseInt(a,10);o=(l-m)/(1e3*60*60*24)>=Ut.install_prompt_dismissed_days}o&&!this.pwaSwService.isAppInstalled()?(this.showInstallPrompt=!0,console.log("Install prompt ready and showing")):console.log("Install prompt ready but not showing (either dismissed or already installed)")}),window.addEventListener("appinstalled",()=>{this.showInstallPrompt=!1,this.deferredPrompt=null,console.log("App installed successfully")}),this.pwaSwService.isAppInstalled()&&(this.showInstallPrompt=!1))}installApp(){return me(this,null,function*(){if(this.deferredPrompt){this.installClicked.emit(),this.deferredPrompt.prompt();let{outcome:t}=yield this.deferredPrompt.userChoice;t==="accepted"?(console.log("User accepted the install prompt"),this.showInstallPrompt=!1):(console.log("User dismissed the install prompt"),this.dismissPrompt()),this.deferredPrompt=null}})}dismissPrompt(){this.dismissClicked.emit(),this.showInstallPrompt=!1,localStorage.setItem("pwa-install-dismissed","true"),localStorage.setItem("pwa-install-dismissed-time",Date.now().toString())}};i.\u0275fac=function(r){return new(r||i)(Y(nM),Y(Vr))},i.\u0275cmp=Re({type:i,selectors:[["app-pwa-install-prompt"]],outputs:{installClicked:"installClicked",dismissClicked:"dismissClicked"},decls:1,vars:1,consts:[["class","pwa-install-prompt",4,"ngIf"],[1,"pwa-install-prompt"],[1,"install-content"],[1,"install-icon"],["width","48","height","48","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M12 2L2 7L12 12L22 7L12 2Z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M2 17L12 22L22 17","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M2 12L12 17L22 12","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"install-text"],[1,"install-actions"],["type","button",1,"install-btn","primary",3,"click"],["type","button",1,"install-btn","secondary",3,"click"],["type","button",1,"close-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M18 6L6 18M6 6L18 18","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"]],template:function(r,a){r&1&&N(0,kY,20,2,"div",0),r&2&&P("ngIf",a.showInstallPrompt)},dependencies:[dt],styles:[".pwa-install-prompt[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:20px;right:20px;z-index:1000;animation:_ngcontent-%COMP%_slideUp .3s ease-out}.install-content[_ngcontent-%COMP%]{background:var(--surface-color, #ffffff);border:1px solid var(--border-color, #e2e8f0);border-radius:16px;padding:20px;box-shadow:0 10px 25px #0000001a;position:relative;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.install-icon[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:16px;color:var(--primary-color, #3b82f6)}.install-text[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.install-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 8px}.install-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0;line-height:1.5}.install-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.install-btn[_ngcontent-%COMP%]{padding:12px 24px;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;min-width:100px}.install-btn.primary[_ngcontent-%COMP%]{background:var(--primary-color, #3b82f6);color:#fff}.install-btn.primary[_ngcontent-%COMP%]:hover{background:var(--primary-color-dark, #2563eb);transform:translateY(-1px)}.install-btn.secondary[_ngcontent-%COMP%]{background:var(--surface-color, #f8fafc);color:var(--text-color, #1e293b);border:1px solid var(--border-color, #e2e8f0)}.install-btn.secondary[_ngcontent-%COMP%]:hover{background:var(--surface-hover-color, #f1f5f9)}.close-btn[_ngcontent-%COMP%]{position:absolute;top:12px;right:12px;width:32px;height:32px;border:none;border-radius:50%;background:var(--surface-color, #f8fafc);color:var(--text-muted, #64748b);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.close-btn[_ngcontent-%COMP%]:hover{background:var(--surface-hover-color, #f1f5f9);color:var(--text-color, #1e293b)}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(100%);opacity:0}to{transform:translateY(0);opacity:1}}@media (max-width: 768px){.pwa-install-prompt[_ngcontent-%COMP%]{bottom:16px;left:16px;right:16px}.install-content[_ngcontent-%COMP%]{padding:16px}.install-actions[_ngcontent-%COMP%]{flex-direction:column}.install-btn[_ngcontent-%COMP%]{width:100%}}@media (max-width: 480px){.pwa-install-prompt[_ngcontent-%COMP%]{bottom:12px;left:12px;right:12px}.install-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px}.install-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}}@media (prefers-color-scheme: dark){.install-content[_ngcontent-%COMP%]{background:#0f172af2;border-color:#334155}.install-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#f1f5f9}.install-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#94a3b8}.install-btn.secondary[_ngcontent-%COMP%]{background:#1e293b;color:#f1f5f9;border-color:#334155}.install-btn.secondary[_ngcontent-%COMP%]:hover{background:#334155}.close-btn[_ngcontent-%COMP%]{background:#1e293b;color:#94a3b8}.close-btn[_ngcontent-%COMP%]:hover{background:#334155;color:#f1f5f9}}"]});let e=i;return e})();var rM=(()=>{let i=class i{constructor(t,r,a,o,l,m){this.location=t,this.loaderService=r,this.pwaNavigationService=a,this.commonSyncService=o,this.ssrService=l,this.firebaseMessagingService=m,this.title=Ut.APP_NAME,this.isOnline=!1,this.destroy$=new Bt,this.navigationState={canGoBack:!1,currentRoute:"",previousRoute:"",navigationStack:[],isStandalone:!1,isMobile:!1}}ngOnInit(){this.ssrService.isClientSide()&&(this.isOnline=navigator.onLine),this.initializePwaFeatures(),this.setupEventListeners(),this.firebaseMessagingService.listenForMessages()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.pwaNavigationService.destroy()}initializePwaFeatures(){this.pwaNavigationService.navigationState$.pipe(yt(this.destroy$)).subscribe(t=>{this.navigationState=t}),this.commonSyncService.isOnline$.pipe(yt(this.destroy$)).subscribe(t=>{this.isOnline=t})}setupEventListeners(){this.ssrService.isClientSide()&&(window.addEventListener("online",()=>this.isOnline=!0),window.addEventListener("offline",()=>this.isOnline=!1),window.addEventListener("beforeunload",t=>{this.navigationState.isStandalone&&this.saveAppState()}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this.handleAppBackground():document.visibilityState==="visible"&&this.handleAppForeground()}))}saveAppState(){let t={currentRoute:this.navigationState.currentRoute,navigationStack:this.navigationState.navigationStack,timestamp:Date.now()};try{localStorage.setItem("app-state",JSON.stringify(t))}catch(r){console.warn("Failed to save app state:",r)}}handleAppBackground(){this.saveAppState(),this.loaderService.hide()}handleAppForeground(){this.isOnline&&this.refreshDataIfNeeded()}refreshDataIfNeeded(){let t=localStorage.getItem("last-data-refresh"),r=Date.now(),a=Ut.OFFLINE.SYNC_INTERVAL;(!t||r-parseInt(t)>a)&&localStorage.setItem("last-data-refresh",r.toString())}goBack(){this.pwaNavigationService.goBack()}goForward(){this.pwaNavigationService.goForward()}handlePwaAction(t){if(this.ssrService.isClientSide())switch(t){case"back":this.goBack();break;case"forward":this.goForward();break;case"home":this.pwaNavigationService.navigateTo("/dashboard");break;case"refresh":window.location.reload();break;default:console.warn("Unknown PWA action:",t)}}onInstallClicked(){console.log("PWA install clicked")}onDismissClicked(){console.log("PWA install dismissed")}};i.\u0275fac=function(r){return new(r||i)(Y(n0),Y(Ac),Y(Kg),Y(qr),Y(Vr),Y(Xg))},i.\u0275cmp=Re({type:i,selectors:[["app-root"]],decls:5,vars:0,consts:[[3,"installClicked","dismissClicked"]],template:function(r,a){r&1&&(re(0,"app-offline-indicator"),s(1,"app-pwa-install-prompt",0),F("installClicked",function(){return a.onInstallClicked()})("dismissClicked",function(){return a.onDismissClicked()}),c(),s(2,"div"),re(3,"app-loader")(4,"router-outlet"),c())},dependencies:[o0,$x,tM,iM],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.content[_ngcontent-%COMP%]{padding:16px}.offline-banner[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;background:red;color:#fff;text-align:center;padding:5px}"]});let e=i;return e})();var EY="@",IY=(()=>{let i=class i{constructor(t,r,a,o,l){this.doc=t,this.delegate=r,this.zone=a,this.animationType=o,this.moduleImpl=l,this._rendererFactoryPromise=null,this.scheduler=ta(h1,{optional:!0})}ngOnDestroy(){var t;(t=this._engine)==null||t.flush()}loadImpl(){var r;return((r=this.moduleImpl)!=null?r:import("./chunk-MFYJVG7S.js").then(a=>a)).catch(a=>{throw new l1(5300,!1)}).then(({\u0275createEngine:a,\u0275AnimationRendererFactory:o})=>{this._engine=a(this.animationType,this.doc);let l=new o(this.delegate,this._engine,this.zone);return this.delegate=l,l})}createRenderer(t,r){var l,m;let a=this.delegate.createRenderer(t,r);if(a.\u0275type===0)return a;typeof a.throwOnSyntheticProps=="boolean"&&(a.throwOnSyntheticProps=!1);let o=new Gf(a);return(l=r==null?void 0:r.data)!=null&&l.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),(m=this._rendererFactoryPromise)==null||m.then(g=>{var h;let f=g.createRenderer(t,r);o.use(f),(h=this.scheduler)==null||h.notify(9)}).catch(g=>{o.use(a)}),o}begin(){var t,r;(r=(t=this.delegate).begin)==null||r.call(t)}end(){var t,r;(r=(t=this.delegate).end)==null||r.call(t)}whenRenderingDone(){var t,r,a;return(a=(r=(t=this.delegate).whenRenderingDone)==null?void 0:r.call(t))!=null?a:Promise.resolve()}};i.\u0275fac=function(r){f1()},i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})(),Gf=class{constructor(i){this.delegate=i,this.replay=[],this.\u0275type=1}use(i){if(this.delegate=i,this.replay!==null){for(let n of this.replay)n(i);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(i,n){return this.delegate.createElement(i,n)}createComment(i){return this.delegate.createComment(i)}createText(i){return this.delegate.createText(i)}get destroyNode(){return this.delegate.destroyNode}appendChild(i,n){this.delegate.appendChild(i,n)}insertBefore(i,n,t,r){this.delegate.insertBefore(i,n,t,r)}removeChild(i,n,t){this.delegate.removeChild(i,n,t)}selectRootElement(i,n){return this.delegate.selectRootElement(i,n)}parentNode(i){return this.delegate.parentNode(i)}nextSibling(i){return this.delegate.nextSibling(i)}setAttribute(i,n,t,r){this.delegate.setAttribute(i,n,t,r)}removeAttribute(i,n,t){this.delegate.removeAttribute(i,n,t)}addClass(i,n){this.delegate.addClass(i,n)}removeClass(i,n){this.delegate.removeClass(i,n)}setStyle(i,n,t,r){this.delegate.setStyle(i,n,t,r)}removeStyle(i,n,t){this.delegate.removeStyle(i,n,t)}setProperty(i,n,t){this.shouldReplay(n)&&this.replay.push(r=>r.setProperty(i,n,t)),this.delegate.setProperty(i,n,t)}setValue(i,n){this.delegate.setValue(i,n)}listen(i,n,t){return this.shouldReplay(n)&&this.replay.push(r=>r.listen(i,n,t)),this.delegate.listen(i,n,t)}shouldReplay(i){return this.replay!==null&&i.startsWith(EY)}};function aM(e="animations"){return wu("NgAsyncAnimations"),lc([{provide:Jd,useFactory:(i,n,t)=>new IY(i,n,t,e),deps:[t0,i0,Dr]},{provide:Il,useValue:e==="noop"?"NoopAnimations":"BrowserAnimations"}])}var AY=(()=>{let i=class i extends um{constructor(t,r,a){super(t,r,a)}ngOnDestroy(){this.flush()}};i.\u0275fac=function(r){return new(r||i)(De(t0),De(Vl),De(gm))},i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})();function DY(){return new Hx}function FY(e,i,n){return new Xx(e,i,n)}var sM=[{provide:gm,useFactory:DY},{provide:um,useClass:AY},{provide:Jd,useFactory:FY,deps:[i0,um,Dr]}],oM=[{provide:Vl,useFactory:()=>new qx},{provide:Il,useValue:"BrowserAnimations"},...sM],RY=[{provide:Vl,useClass:Gx},{provide:Il,useValue:"NoopAnimations"},...sM],cM=(()=>{let i=class i{static withConfig(t){return{ngModule:i,providers:t.disableAnimations?RY:oM}}};i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=ir({type:i}),i.\u0275inj=nr({providers:oM,imports:[r0]});let e=i;return e})();var BY=Yr(lM(),1),dM=(()=>{let i=class i{constructor(){this._papa=BY}parse(t,r){return this._papa.parse(t,r)}unparse(t,r){return this._papa.unparse(t,r)}setLocalChunkSize(t){this._papa.LocalChunkSize=t}setRemoteChunkSize(t){this._papa.RemoteChunkSize=t}setDefaultDelimiter(t){this._papa.DefaultDelimiter=t}get badDelimiters(){return this._papa.BAD_DELIMITERS}get recordSeparator(){return this._papa.RECORD_SEP}get unitSeparator(){return this._papa.UNIT_SEP}get workersSupported(){return this._papa.WORKERS_SUPPORTED}};i.\u0275fac=function(r){return new(r||i)},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var mM=(()=>{let i=class i{constructor(t,r){this.matIconRegistry=t,this.domSanitizer=r,this.matIconRegistry.addSvgIconSet(this.domSanitizer.bypassSecurityTrustResourceUrl("assets/icon/system-uicons.svg")),this.matIconRegistry.addSvgIcon("test",this.domSanitizer.bypassSecurityTrustResourceUrl("assets/icon/test.svg")),this.matIconRegistry.addSvgIcon("add-txn",this.domSanitizer.bypassSecurityTrustResourceUrl("assets/icon/add-txn.svg"))}};i.\u0275fac=function(r){return new(r||i)(De(N_),De(R1))},i.\u0275mod=ir({type:i}),i.\u0275inj=nr({});let e=i;return e})();var Fd="PERFORM_ACTION",UY="REFRESH",_M="RESET",xM="ROLLBACK",CM="COMMIT",vM="SWEEP",bM="TOGGLE_ACTION",zY="SET_ACTIONS_ACTIVE",yM="JUMP_TO_STATE",MM="JUMP_TO_ACTION",sh="IMPORT_STATE",PM="LOCK_CHANGES",OM="PAUSE_RECORDING",vl=class{constructor(i,n){if(this.action=i,this.timestamp=n,this.type=Fd,typeof i.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?')}},Xf=class{constructor(){this.type=UY}},Kf=class{constructor(i){this.timestamp=i,this.type=_M}},Zf=class{constructor(i){this.timestamp=i,this.type=xM}},Qf=class{constructor(i){this.timestamp=i,this.type=CM}},Jf=class{constructor(){this.type=vM}},eh=class{constructor(i){this.id=i,this.type=bM}};var th=class{constructor(i){this.index=i,this.type=yM}},nh=class{constructor(i){this.actionId=i,this.type=MM}},ih=class{constructor(i){this.nextLiftedState=i,this.type=sh}},rh=class{constructor(i){this.status=i,this.type=PM}},ah=class{constructor(i){this.status=i,this.type=OM}};var eu=new wa("@ngrx/store-devtools Options"),gM=new wa("@ngrx/store-devtools Initial Config");function wM(){return null}var jY="NgRx Store DevTools";function $Y(e){let i={maxAge:!1,monitor:wM,actionSanitizer:void 0,stateSanitizer:void 0,name:jY,serialize:!1,logOnly:!1,autoPause:!1,trace:!1,traceLimit:75,features:{pause:!0,lock:!0,persist:!0,export:!0,import:"custom",jump:!0,skip:!0,reorder:!0,dispatch:!0,test:!0},connectInZone:!1},n=typeof e=="function"?e():e,t=n.logOnly?{pause:!0,export:!0,test:!0}:!1,r=n.features||t||i.features;r.import===!0&&(r.import="custom");let a=Object.assign({},i,{features:r},n);if(a.maxAge&&a.maxAge<2)throw new Error(`Devtools 'maxAge' cannot be less than 2, got ${a.maxAge}`);return a}function uM(e,i){return e.filter(n=>i.indexOf(n)<0)}function SM(e){let{computedStates:i,currentStateIndex:n}=e;if(n>=i.length){let{state:r}=i[i.length-1];return r}let{state:t}=i[n];return t}function Dd(e){return new vl(e,+Date.now())}function YY(e,i){return Object.keys(i).reduce((n,t)=>{let r=Number(t);return n[r]=kM(e,i[r],r),n},{})}function kM(e,i,n){return le(oe({},i),{action:e(i.action,n)})}function WY(e,i){return i.map((n,t)=>({state:TM(e,n.state,t),error:n.error}))}function TM(e,i,n){return e(i,n)}function EM(e){return e.predicate||e.actionsSafelist||e.actionsBlocklist}function GY(e,i,n,t){let r=[],a={},o=[];return e.stagedActionIds.forEach((l,m)=>{let g=e.actionsById[l];g&&(m&&ch(e.computedStates[m],g,i,n,t)||(a[l]=g,r.push(l),o.push(e.computedStates[m])))}),le(oe({},e),{stagedActionIds:r,actionsById:a,computedStates:o})}function ch(e,i,n,t,r){let a=n&&!n(e,i.action),o=t&&!i.action.type.match(t.map(m=>pM(m)).join("|")),l=r&&i.action.type.match(r.map(m=>pM(m)).join("|"));return a||o||l}function pM(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function IM(e){return{ngZone:e?ta(Dr):null,connectInZone:e}}var tu=(()=>{let i=class i extends l0{};i.\u0275fac=(()=>{let t;return function(a){return(t||(t=m1(i)))(a||i)}})(),i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})(),Zg={START:"START",DISPATCH:"DISPATCH",STOP:"STOP",ACTION:"ACTION"},oh=new wa("@ngrx/store-devtools Redux Devtools Extension"),AM=(()=>{let i=class i{constructor(t,r,a){this.config=r,this.dispatcher=a,this.zoneConfig=IM(this.config.connectInZone),this.devtoolsExtension=t,this.createActionStreams()}notify(t,r){if(this.devtoolsExtension)if(t.type===Fd){if(r.isLocked||r.isPaused)return;let a=SM(r);if(EM(this.config)&&ch(a,t,this.config.predicate,this.config.actionsSafelist,this.config.actionsBlocklist))return;let o=this.config.stateSanitizer?TM(this.config.stateSanitizer,a,r.currentStateIndex):a,l=this.config.actionSanitizer?kM(this.config.actionSanitizer,t,r.nextActionId):t;this.sendToReduxDevtools(()=>this.extensionConnection.send(l,o))}else{let a=le(oe({},r),{stagedActionIds:r.stagedActionIds,actionsById:this.config.actionSanitizer?YY(this.config.actionSanitizer,r.actionsById):r.actionsById,computedStates:this.config.stateSanitizer?WY(this.config.stateSanitizer,r.computedStates):r.computedStates});this.sendToReduxDevtools(()=>this.devtoolsExtension.send(null,a,this.getExtensionConfig(this.config)))}}createChangesObservable(){return this.devtoolsExtension?new tn(t=>{let r=this.zoneConfig.connectInZone?this.zoneConfig.ngZone.runOutsideAngular(()=>this.devtoolsExtension.connect(this.getExtensionConfig(this.config))):this.devtoolsExtension.connect(this.getExtensionConfig(this.config));return this.extensionConnection=r,r.init(),r.subscribe(a=>t.next(a)),r.unsubscribe}):Zh}createActionStreams(){let t=this.createChangesObservable().pipe(r1()),r=t.pipe(Bi(f=>f.type===Zg.START)),a=t.pipe(Bi(f=>f.type===Zg.STOP)),o=t.pipe(Bi(f=>f.type===Zg.DISPATCH),We(f=>this.unwrapAction(f.payload)),e1(f=>f.type===sh?this.dispatcher.pipe(Bi(h=>h.type===Tu),Jh(1e3),El(1e3),We(()=>f),vt(()=>gt(f)),tr(1)):gt(f))),m=t.pipe(Bi(f=>f.type===Zg.ACTION),We(f=>this.unwrapAction(f.payload))).pipe(yt(a)),g=o.pipe(yt(a));this.start$=r.pipe(yt(a)),this.actions$=this.start$.pipe(wr(()=>m)),this.liftedActions$=this.start$.pipe(wr(()=>g))}unwrapAction(t){return typeof t=="string"?(0,eval)(`(${t})`):t}getExtensionConfig(t){var a,o,l;let r={name:t.name,features:t.features,serialize:t.serialize,autoPause:(a=t.autoPause)!=null?a:!1,trace:(o=t.trace)!=null?o:!1,traceLimit:(l=t.traceLimit)!=null?l:75};return t.maxAge!==!1&&(r.maxAge=t.maxAge),r}sendToReduxDevtools(t){try{t()}catch(r){console.warn("@ngrx/store-devtools: something went wrong inside the redux devtools",r)}}};i.\u0275fac=function(r){return new(r||i)(De(oh),De(eu),De(tu))},i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})(),Jg={type:ku},HY="@ngrx/store-devtools/recompute",qY={type:HY};function DM(e,i,n,t,r){if(t)return{state:n,error:"Interrupted by an error up the chain"};let a=n,o;try{a=e(n,i)}catch(l){o=l.toString(),r.handleError(l)}return{state:a,error:o}}function Qg(e,i,n,t,r,a,o,l,m){if(i>=e.length&&e.length===a.length)return e;let g=e.slice(0,i),f=a.length-(m?1:0);for(let h=i;h<f;h++){let x=a[h],C=r[x].action,y=g[h-1],b=y?y.state:t,w=y?y.error:void 0,E=o.indexOf(x)>-1?y:DM(n,C,b,w,l);g.push(E)}return m&&g.push(e[e.length-1]),g}function XY(e,i){return{monitorState:i(void 0,{}),nextActionId:1,actionsById:{0:Dd(Jg)},stagedActionIds:[0],skippedActionIds:[],committedState:e,currentStateIndex:0,computedStates:[],isLocked:!1,isPaused:!1}}function KY(e,i,n,t,r={}){return a=>(o,l)=>{let{monitorState:m,actionsById:g,nextActionId:f,stagedActionIds:h,skippedActionIds:x,committedState:C,currentStateIndex:y,computedStates:b,isLocked:w,isPaused:A}=o||i;o||(g=Object.create(g));function E(Z){let k=Z,S=h.slice(1,k+1);for(let V=0;V<S.length;V++)if(b[V+1].error){k=V,S=h.slice(1,k+1);break}else delete g[S[V]];x=x.filter(V=>S.indexOf(V)===-1),h=[0,...h.slice(k+1)],C=b[k].state,b=b.slice(k),y=y>k?y-k:0}function I(){g={0:Dd(Jg)},f=1,h=[0],x=[],C=b[y].state,y=0,b=[]}let K=0;switch(l.type){case PM:{w=l.status,K=1/0;break}case OM:{A=l.status,A?(h=[...h,f],g[f]=new vl({type:"@ngrx/devtools/pause"},+Date.now()),f++,K=h.length-1,b=b.concat(b[b.length-1]),y===h.length-2&&y++,K=1/0):I();break}case _M:{g={0:Dd(Jg)},f=1,h=[0],x=[],C=e,y=0,b=[];break}case CM:{I();break}case xM:{g={0:Dd(Jg)},f=1,h=[0],x=[],y=0,b=[];break}case bM:{let{id:Z}=l;x.indexOf(Z)===-1?x=[Z,...x]:x=x.filter(S=>S!==Z),K=h.indexOf(Z);break}case zY:{let{start:Z,end:k,active:S}=l,V=[];for(let W=Z;W<k;W++)V.push(W);S?x=uM(x,V):x=[...x,...V],K=h.indexOf(Z);break}case yM:{y=l.index,K=1/0;break}case MM:{let Z=h.indexOf(l.actionId);Z!==-1&&(y=Z),K=1/0;break}case vM:{h=uM(h,x),x=[],y=Math.min(y,h.length-1);break}case Fd:{if(w)return o||i;if(A||o&&ch(o.computedStates[y],l,r.predicate,r.actionsSafelist,r.actionsBlocklist)){let k=b[b.length-1];b=[...b.slice(0,-1),DM(a,l.action,k.state,k.error,n)],K=1/0;break}r.maxAge&&h.length===r.maxAge&&E(1),y===h.length-1&&y++;let Z=f++;g[Z]=l,h=[...h,Z],K=h.length-1;break}case sh:{({monitorState:m,actionsById:g,nextActionId:f,stagedActionIds:h,skippedActionIds:x,committedState:C,currentStateIndex:y,computedStates:b,isLocked:w,isPaused:A}=l.nextLiftedState);break}case ku:{K=0,r.maxAge&&h.length>r.maxAge&&(b=Qg(b,K,a,C,g,h,x,n,A),E(h.length-r.maxAge),K=1/0);break}case Tu:{if(b.filter(k=>k.error).length>0)K=0,r.maxAge&&h.length>r.maxAge&&(b=Qg(b,K,a,C,g,h,x,n,A),E(h.length-r.maxAge),K=1/0);else{if(!A&&!w){y===h.length-1&&y++;let k=f++;g[k]=new vl(l,+Date.now()),h=[...h,k],K=h.length-1,b=Qg(b,K,a,C,g,h,x,n,A)}b=b.map(k=>le(oe({},k),{state:a(k.state,qY)})),y=h.length-1,r.maxAge&&h.length>r.maxAge&&E(h.length-r.maxAge),K=1/0}break}default:{K=1/0;break}}return b=Qg(b,K,a,C,g,h,x,n,A),m=t(m,l),{monitorState:m,actionsById:g,nextActionId:f,stagedActionIds:h,skippedActionIds:x,committedState:C,currentStateIndex:y,computedStates:b,isLocked:w,isPaused:A}}}var fM=(()=>{let i=class i{constructor(t,r,a,o,l,m,g,f){let h=XY(g,f.monitor),x=KY(g,h,m,f.monitor,f),C=yu(yu(r.asObservable().pipe(a1(1)),o.actions$).pipe(We(Dd)),t,o.liftedActions$).pipe(Qh(Kh)),y=a.pipe(We(x)),b=IM(f.connectInZone),w=new ho(1);this.liftedStateSubscription=C.pipe(c1(y),hM(b),i1(({state:I},[K,Z])=>{let k=Z(I,K);return K.type!==Fd&&EM(f)&&(k=GY(k,f.predicate,f.actionsSafelist,f.actionsBlocklist)),o.notify(K,k),{state:k,action:K}},{state:h,action:null})).subscribe(({state:I,action:K})=>{if(w.next(I),K.type===Fd){let Z=K.action;l.next(Z)}}),this.extensionStartSubscription=o.start$.pipe(hM(b)).subscribe(()=>{this.refresh()});let A=w.asObservable(),E=A.pipe(We(SM));Object.defineProperty(E,"state",{value:W1(E,{manualCleanup:!0,requireSync:!0})}),this.dispatcher=t,this.liftedState=A,this.state=E}ngOnDestroy(){this.liftedStateSubscription.unsubscribe(),this.extensionStartSubscription.unsubscribe()}dispatch(t){this.dispatcher.next(t)}next(t){this.dispatcher.next(t)}error(t){}complete(){}performAction(t){this.dispatch(new vl(t,+Date.now()))}refresh(){this.dispatch(new Xf)}reset(){this.dispatch(new Kf(+Date.now()))}rollback(){this.dispatch(new Zf(+Date.now()))}commit(){this.dispatch(new Qf(+Date.now()))}sweep(){this.dispatch(new Jf)}toggleAction(t){this.dispatch(new eh(t))}jumpToAction(t){this.dispatch(new nh(t))}jumpToState(t){this.dispatch(new th(t))}importState(t){this.dispatch(new ih(t))}lockChanges(t){this.dispatch(new rh(t))}pauseRecording(t){this.dispatch(new ah(t))}};i.\u0275fac=function(r){return new(r||i)(De(tu),De(l0),De(H1),De(AM),De(X1),De(u1),De(G1),De(eu))},i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})();function hM({ngZone:e,connectInZone:i}){return n=>i?new tn(t=>n.subscribe({next:r=>e.run(()=>t.next(r)),error:r=>e.run(()=>t.error(r)),complete:()=>e.run(()=>t.complete())})):n}var ZY=new wa("@ngrx/store-devtools Is Devtools Extension or Monitor Present");function QY(e,i){return!!e||i.monitor!==wM}function JY(){let e="__REDUX_DEVTOOLS_EXTENSION__";return typeof window=="object"&&typeof window[e]<"u"?window[e]:null}function eW(e={}){return lc([AM,tu,fM,{provide:gM,useValue:e},{provide:ZY,deps:[oh,eu],useFactory:QY},{provide:oh,useFactory:JY},{provide:eu,deps:[gM],useFactory:$Y},{provide:K1,deps:[fM],useFactory:tW},{provide:q1,useExisting:tu}])}function tW(e){return e.state}var FM=(()=>{let i=class i{static instrument(t={}){return{ngModule:i,providers:[eW(t)]}}};i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=ir({type:i}),i.\u0275inj=nr({});let e=i;return e})();var lh={entities:{},ids:[],loading:!1,error:null,selectedTransactionId:null};var RM=ra(lh,Ie(li,e=>le(oe({},e),{loading:!0,error:null})),Ie(B0,(e,{transactions:i})=>{let n=i.reduce((r,a)=>(a.id&&(r[a.id]=a),r),{}),t=i.map(r=>r.id).filter(r=>r);return le(oe({},e),{entities:n,ids:t,loading:!1,error:null})}),Ie(N0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(Yo,e=>le(oe({},e),{loading:!0,error:null})),Ie(vc,(e,{transaction:i})=>i.id?le(oe({},e),{entities:le(oe({},e.entities),{[i.id]:i}),ids:[...e.ids,i.id],loading:!1,error:null}):e),Ie(L0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(Wo,e=>le(oe({},e),{loading:!0,error:null})),Ie(bc,(e,{transaction:i})=>i.id?le(oe({},e),{entities:le(oe({},e.entities),{[i.id]:i}),loading:!1,error:null}):e),Ie(V0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(yc,e=>le(oe({},e),{loading:!0,error:null})),Ie(Go,(e,{transactionId:i})=>{let r=e.entities,{[i]:n}=r,t=sc(r,[oc(i)]);return le(oe({},e),{entities:t,ids:e.ids.filter(a=>a!==i),loading:!1,error:null})}),Ie(U0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(z0,e=>le(oe({},e),{loading:!0,error:null})),Ie(j0,(e,{transaction:i})=>i.id?le(oe({},e),{entities:le(oe({},e.entities),{[i.id]:i}),ids:e.ids.includes(i.id)?e.ids:[...e.ids,i.id],selectedTransactionId:i.id,loading:!1,error:null}):e),Ie(Fl,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(o_,()=>lh));var dh={entities:{},ids:[],loading:!1,error:null};var BM=ra(dh,Ie(Xi,e=>le(oe({},e),{loading:!0,error:null})),Ie(k0,(e,{categories:i})=>{let n=i.reduce((r,a)=>(a.id&&(r[a.id]=a),r),{}),t=i.map(r=>r.id).filter(r=>r);return le(oe({},e),{entities:n,ids:t,loading:!1,error:null})}),Ie(T0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(xc,e=>le(oe({},e),{loading:!0,error:null})),Ie(n_,(e,{category:i})=>i.id?le(oe({},e),{entities:le(oe({},e.entities),{[i.id]:i}),ids:[...e.ids,i.id],loading:!1,error:null}):e),Ie(E0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(aa,e=>le(oe({},e),{loading:!0,error:null})),Ie(i_,(e,{category:i})=>i.id?le(oe({},e),{entities:le(oe({},e.entities),{[i.id]:i}),loading:!1,error:null}):e),Ie(I0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(Cc,e=>le(oe({},e),{loading:!0,error:null})),Ie(A0,(e,{categoryId:i})=>{let r=e.entities,{[i]:n}=r,t=sc(r,[oc(i)]);return le(oe({},e),{entities:t,ids:e.ids.filter(a=>a!==i),loading:!1,error:null})}),Ie(D0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(F0,e=>le(oe({},e),{loading:!0,error:null})),Ie(r_,(e,{categoryId:i})=>{let n=e.entities[i];return n?le(oe({},e),{entities:le(oe({},e.entities),{[i]:le(oe({},n),{parentCategoryId:void 0,isSubCategory:!1})}),loading:!1,error:null}):e}),Ie(R0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(a_,()=>dh));var mh={entities:{},ids:[],loading:!1,error:null,selectedAccountId:null};var NM=ra(mh,Ie(Fr,e=>le(oe({},e),{loading:!0,error:null})),Ie(m0,(e,{accounts:i})=>{let n=i.reduce((r,a)=>(r[a.accountId]=a,r),{}),t=i.map(r=>r.accountId);return le(oe({},e),{entities:n,ids:t,loading:!1,error:null})}),Ie(g0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(u0,e=>le(oe({},e),{loading:!0,error:null})),Ie(Q1,(e,{account:i})=>le(oe({},e),{entities:le(oe({},e.entities),{[i.accountId]:i}),ids:[...e.ids,i.accountId],loading:!1,error:null})),Ie(p0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(f0,e=>le(oe({},e),{loading:!0,error:null})),Ie(J1,(e,{account:i})=>le(oe({},e),{entities:le(oe({},e.entities),{[i.accountId]:i}),loading:!1,error:null})),Ie(h0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(_c,e=>le(oe({},e),{loading:!0,error:null})),Ie(_0,(e,{accountId:i})=>{let r=e.entities,{[i]:n}=r,t=sc(r,[oc(i)]);return le(oe({},e),{entities:t,ids:e.ids.filter(a=>a!==i),loading:!1,error:null})}),Ie(x0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(C0,e=>le(oe({},e),{loading:!0,error:null})),Ie(v0,(e,{account:i})=>le(oe({},e),{entities:le(oe({},e.entities),{[i.accountId]:i}),ids:e.ids.includes(i.accountId)?e.ids:[...e.ids,i.accountId],selectedAccountId:i.accountId,loading:!1,error:null})),Ie(Dl,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie($o,e=>le(oe({},e),{loading:!0,error:null})),Ie(b0,(e,{accountId:i,newBalance:n})=>{let t=e.entities[i];return t?le(oe({},e),{entities:le(oe({},e.entities),{[i]:le(oe({},t),{balance:n,updatedAt:new Date})}),loading:!1,error:null}):e}),Ie(y0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(M0,e=>le(oe({},e),{loading:!0,error:null})),Ie(P0,e=>le(oe({},e),{loading:!1,error:null})),Ie(O0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(w0,e=>le(oe({},e),{loading:!0,error:null})),Ie(e_,e=>le(oe({},e),{loading:!1,error:null})),Ie(S0,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(t_,()=>mh));var LM={budgets:[],loading:!1,error:null};var VM=ra(LM,Ie(Ha,e=>le(oe({},e),{loading:!0,error:null})),Ie(pm,(e,{budgets:i})=>le(oe({},e),{budgets:i,loading:!1,error:null})),Ie(fm,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(ys,e=>le(oe({},e),{loading:!0,error:null})),Ie(hm,(e,{budget:i})=>le(oe({},e),{budgets:[...e.budgets,i],loading:!1,error:null})),Ie(_m,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(Bc,e=>le(oe({},e),{loading:!0,error:null})),Ie(xm,(e,{budget:i})=>le(oe({},e),{budgets:e.budgets.map(n=>n.budgetId===i.budgetId?i:n),loading:!1,error:null})),Ie(Cm,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(Nc,e=>le(oe({},e),{loading:!0,error:null})),Ie(vm,(e,{budgetId:i})=>le(oe({},e),{budgets:e.budgets.filter(n=>n.budgetId!==i),loading:!1,error:null})),Ie(bm,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(Lc,e=>le(oe({},e),{loading:!0,error:null})),Ie(ym,(e,{budget:i})=>le(oe({},e),{budgets:e.budgets.map(n=>n.budgetId===i.budgetId?i:n),loading:!1,error:null})),Ie(Mm,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})));var UM={goals:[],loading:!1,error:null};var zM=ra(UM,Ie(qa,e=>le(oe({},e),{loading:!0,error:null})),Ie(Pm,(e,{goals:i})=>le(oe({},e),{goals:i,loading:!1,error:null})),Ie(Om,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(Vc,e=>le(oe({},e),{loading:!0,error:null})),Ie(wm,(e,{goal:i})=>le(oe({},e),{goals:[...e.goals,i],loading:!1,error:null})),Ie(Sm,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(km,e=>le(oe({},e),{loading:!0,error:null})),Ie(Tm,(e,{goal:i})=>le(oe({},e),{goals:e.goals.map(n=>n.goalId===i.goalId?i:n),loading:!1,error:null})),Ie(Em,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(Uc,e=>le(oe({},e),{loading:!0,error:null})),Ie(Im,(e,{goalId:i})=>le(oe({},e),{goals:e.goals.filter(n=>n.goalId!==i),loading:!1,error:null})),Ie(Am,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(zc,e=>le(oe({},e),{loading:!0,error:null})),Ie(Dm,(e,{goal:i})=>le(oe({},e),{goals:e.goals.map(n=>n.goalId===i.goalId?i:n),loading:!1,error:null})),Ie(Fm,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})));var jM={profile:null,loading:!1,error:null};var $M=ra(jM,Ie(Xa,e=>le(oe({},e),{loading:!0,error:null})),Ie(Rm,(e,{profile:i})=>le(oe({},e),{profile:i,loading:!1,error:null})),Ie(Bm,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(jc,e=>le(oe({},e),{loading:!0,error:null})),Ie(Nm,(e,{profile:i})=>le(oe({},e),{profile:i,loading:!1,error:null})),Ie(Lm,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(Vm,e=>le(oe({},e),{loading:!0,error:null})),Ie(Um,(e,{profile:i})=>le(oe({},e),{profile:i,loading:!1,error:null})),Ie(zm,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(jm,e=>le(oe({},e),{loading:!0,error:null})),Ie($m,e=>le(oe({},e),{profile:null,loading:!1,error:null})),Ie(Ym,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})),Ie(yo,e=>le(oe({},e),{loading:!0,error:null})),Ie(Wm,(e,{profile:i})=>le(oe({},e),{profile:i,loading:!1,error:null})),Ie(Gm,(e,{error:i})=>le(oe({},e),{loading:!1,error:i})));var YM=(()=>{let i=class i{constructor(t,r){this.actions$=t,this.transactionsService=r,this.loadTransactions$=qt(()=>this.actions$.pipe(Xt(li),Gt(({userId:a})=>this.transactionsService.getTransactions(a).pipe(We(o=>B0({transactions:o})),vt(o=>gt(N0({error:o}))))))),this.createTransaction$=qt(()=>this.actions$.pipe(Xt(Yo),Gt(({userId:a,transaction:o})=>this.transactionsService.createTransaction(a,o).pipe(We(()=>li({userId:a})),vt(l=>gt(L0({error:l}))))))),this.updateTransaction$=qt(()=>this.actions$.pipe(Xt(Wo),Gt(({userId:a,transactionId:o,transaction:l})=>this.transactionsService.updateTransaction(a,o,l).pipe(We(()=>li({userId:a})),vt(m=>gt(V0({error:m}))))))),this.deleteTransaction$=qt(()=>this.actions$.pipe(Xt(yc),Gt(({userId:a,transactionId:o})=>this.transactionsService.deleteTransaction(a,o).pipe(We(()=>Go({transactionId:o})),vt(l=>gt(U0({error:l}))))))),this.getTransaction$=qt(()=>this.actions$.pipe(Xt(z0),Gt(({userId:a,transactionId:o})=>this.transactionsService.getTransaction(a,o).pipe(We(l=>l?j0({transaction:l}):Fl({error:"Transaction not found"})),vt(l=>gt(Fl({error:l})))))))}};i.\u0275fac=function(r){return new(r||i)(De(ga),De(Ka))},i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})();var WM=(()=>{let i=class i{constructor(t,r){this.actions$=t,this.categoryService=r,this.loadCategories$=qt(()=>this.actions$.pipe(Xt(Xi),Gt(({userId:a})=>this.categoryService.getCategories(a).pipe(We(o=>k0({categories:o})),vt(o=>gt(T0({error:o}))))))),this.createCategory$=qt(()=>this.actions$.pipe(Xt(xc),Gt(({userId:a,name:o,categoryType:l,icon:m,color:g})=>this.categoryService.createCategory(a,o,l,m,g).pipe(We(()=>Xi({userId:a})),vt(f=>gt(E0({error:f}))))))),this.updateCategory$=qt(()=>this.actions$.pipe(Xt(aa),Gt(({userId:a,categoryId:o,name:l,categoryType:m,icon:g,color:f,budgetData:h,parentCategoryId:x,isSubCategory:C})=>this.categoryService.updateCategory(a,o,l,m,g,f,h,x,C).pipe(We(()=>Xi({userId:a})),vt(y=>gt(I0({error:y}))))))),this.deleteCategory$=qt(()=>this.actions$.pipe(Xt(Cc),Gt(({userId:a,categoryId:o})=>this.categoryService.deleteCategory(a,o).pipe(We(()=>A0({categoryId:o})),vt(l=>gt(D0({error:l}))))))),this.removeFromParentCategory$=qt(()=>this.actions$.pipe(Xt(F0),Gt(({userId:a,categoryId:o})=>this.categoryService.removeFromParentCategory(a,o).pipe(We(()=>Xi({userId:a})),vt(l=>gt(R0({error:l})))))))}};i.\u0275fac=function(r){return new(r||i)(De(ga),De(Za))},i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})();var GM=(()=>{let i=class i{constructor(t,r){this.actions$=t,this.accountsService=r,this.loadAccounts$=qt(()=>this.actions$.pipe(Xt(Fr),Gt(({userId:a})=>this.accountsService.getAccounts(a).pipe(We(o=>m0({accounts:o})),vt(o=>gt(g0({error:o}))))))),this.createAccount$=qt(()=>this.actions$.pipe(Xt(u0),Gt(({userId:a,accountData:o})=>this.accountsService.createAccount(a,o).pipe(We(l=>Fr({userId:a})),vt(l=>gt(p0({error:l}))))))),this.updateAccount$=qt(()=>this.actions$.pipe(Xt(f0),Gt(({userId:a,accountId:o,accountData:l})=>this.accountsService.updateAccount(a,o,l).pipe(We(()=>Fr({userId:a})),vt(m=>gt(h0({error:m}))))))),this.deleteAccount$=qt(()=>this.actions$.pipe(Xt(_c),Gt(({userId:a,accountId:o})=>this.accountsService.deleteAccount(a,o).pipe(We(()=>_0({accountId:o})),vt(l=>gt(x0({error:l}))))))),this.getAccount$=qt(()=>this.actions$.pipe(Xt(C0),Gt(({userId:a,accountId:o})=>this.accountsService.getAccount(a,o).pipe(We(l=>l?v0({account:l}):Dl({error:"Account not found"})),vt(l=>gt(Dl({error:l}))))))),this.updateAccountBalanceForTransaction$=qt(()=>this.actions$.pipe(Xt($o),Gt(({userId:a,accountId:o,transactionType:l,oldTransaction:m,newTransaction:g})=>this.accountsService.updateAccountBalanceForTransaction(a,o,l,m,g).pipe(We(f=>b0({accountId:o,newBalance:f})),vt(f=>gt(y0({error:f}))))))),this.updateAccountBalanceForTransactions$=qt(()=>this.actions$.pipe(Xt(M0),Gt(({userId:a,transactions:o})=>this.accountsService.updateAccountBalanceForTransactions(a,o).pipe(We(()=>P0()),vt(l=>gt(O0({error:l}))))))),this.updateAccountBalanceForAccountTransfer$=qt(()=>this.actions$.pipe(Xt(w0),Gt(({userId:a,oldAccountId:o,newAccountId:l,transaction:m})=>this.accountsService.updateAccountBalanceForAccountTransfer(a,o,l,m).pipe(We(()=>Fr({userId:a})),vt(g=>gt(S0({error:g})))))))}};i.\u0275fac=function(r){return new(r||i)(De(ga),De($c))},i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})();var HM=(()=>{let i=class i{constructor(t,r,a){this.firestore=t,this.auth=r,this.dateService=a}createBudget(t,r){return me(this,null,function*(){let a=Dt(this.firestore,`users/${t}/budgets/${r.budgetId}`);yield Rr(a,le(oe({},r),{startDate:this.dateService.toTimestamp(r.startDate),endDate:this.dateService.toTimestamp(r.endDate),spent:0}))})}getBudgets(t){let r=Gr(this.firestore,`users/${t}/budgets`);return new tn(a=>{Va(r).then(o=>{let l=[];o.forEach(m=>{l.push(m.data())}),a.next(l)})})}getBudget(t,r){return me(this,null,function*(){let a=Dt(this.firestore,`users/${t}/budgets/${r}`),o=yield di(a);if(o.exists())return o.data()})}updateBudget(t,r,a){return me(this,null,function*(){let o=Dt(this.firestore,`users/${t}/budgets/${r}`);yield Fn(o,a)})}deleteBudget(t,r){return me(this,null,function*(){let a=Dt(this.firestore,`users/${t}/budgets/${r}`);yield zi(a)})}updateSpent(t,r,a){return me(this,null,function*(){var m;let o=Dt(this.firestore,`users/${t}/budgets/${r}`),l=yield di(o);if(l.exists()){let f=(((m=l.data())==null?void 0:m.spent)||0)+a;yield Fn(o,{spent:f})}})}};i.\u0275fac=function(r){return new(r||i)(De(cr),De(xt),De(Vt))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var qM=(()=>{let i=class i{constructor(t,r){this.actions$=t,this.budgetsService=r,this.loadBudgets$=qt(()=>this.actions$.pipe(Xt(Ha),Gt(({userId:a})=>this.budgetsService.getBudgets(a).pipe(We(o=>pm({budgets:o})),vt(o=>gt(fm({error:o}))))))),this.createBudget$=qt(()=>this.actions$.pipe(Xt(ys),Gt(({userId:a,budget:o})=>Dn(this.budgetsService.createBudget(a,o)).pipe(We(()=>hm({budget:o})),vt(l=>gt(_m({error:l}))))))),this.updateBudget$=qt(()=>this.actions$.pipe(Xt(Bc),Gt(({userId:a,budgetId:o,budget:l})=>Dn(this.budgetsService.updateBudget(a,o,l)).pipe(We(()=>xm({budget:le(oe({},l),{budgetId:o})})),vt(m=>gt(Cm({error:m}))))))),this.deleteBudget$=qt(()=>this.actions$.pipe(Xt(Nc),Gt(({userId:a,budgetId:o})=>Dn(this.budgetsService.deleteBudget(a,o)).pipe(We(()=>vm({budgetId:o})),vt(l=>gt(bm({error:l}))))))),this.updateSpent$=qt(()=>this.actions$.pipe(Xt(Lc),Gt(({userId:a,budgetId:o,amount:l})=>Dn(this.budgetsService.updateSpent(a,o,l)).pipe(We(()=>ym({budget:{budgetId:o,spent:l}})),vt(m=>gt(Mm({error:m})))))))}};i.\u0275fac=function(r){return new(r||i)(De(ga),De(HM))},i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})();var XM=(()=>{let i=class i{constructor(t,r,a){this.firestore=t,this.auth=r,this.dateService=a}createGoal(t,r){return me(this,null,function*(){let a=Dt(this.firestore,`users/${t}/goals/${r.goalId}`);yield Rr(a,le(oe({},r),{deadline:this.dateService.toTimestamp(r.deadline),currentAmount:0}))})}getGoals(t){let r=Gr(this.firestore,`users/${t}/goals`);return new tn(a=>{Va(r).then(o=>{let l=[];o.forEach(m=>{l.push(m.data())}),a.next(l)})})}getGoal(t,r){return me(this,null,function*(){let a=Dt(this.firestore,`users/${t}/goals/${r}`),o=yield di(a);if(o.exists())return o.data()})}updateGoal(t,r,a){return me(this,null,function*(){let o=Dt(this.firestore,`users/${t}/goals/${r}`);yield Fn(o,a)})}deleteGoal(t,r){return me(this,null,function*(){let a=Dt(this.firestore,`users/${t}/goals/${r}`);yield zi(a)})}updateCurrentAmount(t,r,a){return me(this,null,function*(){var m;let o=Dt(this.firestore,`users/${t}/goals/${r}`),l=yield di(o);if(l.exists()){let f=(((m=l.data())==null?void 0:m.currentAmount)||0)+a;yield Fn(o,{currentAmount:f})}})}};i.\u0275fac=function(r){return new(r||i)(De(cr),De(xt),De(Vt))},i.\u0275prov=ut({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var KM=(()=>{let i=class i{constructor(t,r){this.actions$=t,this.goalsService=r,this.loadGoals$=qt(()=>this.actions$.pipe(Xt(qa),Gt(({userId:a})=>this.goalsService.getGoals(a).pipe(We(o=>Pm({goals:o})),vt(o=>gt(Om({error:o}))))))),this.createGoal$=qt(()=>this.actions$.pipe(Xt(Vc),Gt(({userId:a,goal:o})=>Dn(this.goalsService.createGoal(a,o)).pipe(We(()=>wm({goal:o})),vt(l=>gt(Sm({error:l}))))))),this.updateGoal$=qt(()=>this.actions$.pipe(Xt(km),Gt(({userId:a,goalId:o,goal:l})=>Dn(this.goalsService.updateGoal(a,o,l)).pipe(We(()=>Tm({goal:le(oe({},l),{goalId:o})})),vt(m=>gt(Em({error:m}))))))),this.deleteGoal$=qt(()=>this.actions$.pipe(Xt(Uc),Gt(({userId:a,goalId:o})=>Dn(this.goalsService.deleteGoal(a,o)).pipe(We(()=>Im({goalId:o})),vt(l=>gt(Am({error:l}))))))),this.updateCurrentAmount$=qt(()=>this.actions$.pipe(Xt(zc),Gt(({userId:a,goalId:o,amount:l})=>Dn(this.goalsService.updateCurrentAmount(a,o,l)).pipe(We(()=>Dm({goal:{goalId:o,currentAmount:l}})),vt(m=>gt(Fm({error:m})))))))}};i.\u0275fac=function(r){return new(r||i)(De(ga),De(XM))},i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})();var ZM=(()=>{let i=class i{constructor(t,r){this.actions$=t,this.userService=r,this.loadProfile$=qt(()=>this.actions$.pipe(Xt(Xa),Gt(({userId:a})=>Dn(this.userService.getCurrentUser()).pipe(We(o=>{if(o)return Rm({profile:o});throw new Error("Profile not found")}),vt(o=>gt(Bm({error:o}))))))),this.updateProfile$=qt(()=>this.actions$.pipe(Xt(jc),Gt(({userId:a,profile:o})=>Dn(this.userService.createOrUpdateUser(o)).pipe(We(()=>Nm({profile:o})),vt(l=>gt(Lm({error:l}))))))),this.createProfile$=qt(()=>this.actions$.pipe(Xt(Vm),Gt(({userId:a,profile:o})=>Dn(this.userService.createOrUpdateUser(o)).pipe(We(()=>Um({profile:o})),vt(l=>gt(zm({error:l}))))))),this.deleteProfile$=qt(()=>this.actions$.pipe(Xt(jm),Gt(({userId:a})=>Dn(this.userService.signOut()).pipe(We(()=>$m()),vt(o=>gt(Ym({error:o}))))))),this.updatePreferences$=qt(()=>this.actions$.pipe(Xt(yo),Gt(({userId:a,preferences:o})=>Dn(this.userService.getCurrentUser()).pipe(Gt(l=>{if(l){let m=le(oe({},l),{preferences:o});return Dn(this.userService.createOrUpdateUser(m))}else throw new Error("User not found")}),We(()=>Wm({profile:{preferences:o}})),vt(l=>gt(Gm({error:l})))))))}};i.\u0275fac=function(r){return new(r||i)(De(ga),De(ni))},i.\u0275prov=ut({token:i,factory:i.\u0275fac});let e=i;return e})();var QM=(()=>{let i=class i{};i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=ir({type:i}),i.\u0275inj=nr({imports:[Z1.forRoot({transactions:RM,categories:BM,accounts:NM,budgets:VM,goals:zM,profile:$M}),jx.forRoot([YM,WM,GM,qM,KM,ZM]),FM.instrument({maxAge:25,logOnly:mi.production})]});let e=i;return e})();function JM(e,i){let n=ta(nn),t=ta(ni),r=ta(ft);if(rW(e))return i(e);let a=aW(e),o=oW(a,t);return i(o).pipe(n1(1),vt(l=>sW(l,e,n,t,r)))}function rW(e){return!!e.url.toLowerCase().includes("api.openai.com")}function aW(e){let i={"X-Content-Type-Options":"nosniff","X-Frame-Options":"DENY","X-XSS-Protection":"1; mode=block","Referrer-Policy":"strict-origin-when-cross-origin","Permissions-Policy":"geolocation=(), microphone=(), camera=()","Strict-Transport-Security":"max-age=31536000; includeSubDomains","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"};return e.clone({setHeaders:i})}function oW(e,i){let n=i.userAuth$.value;return n&&n.uid?e.clone({setHeaders:{Authorization:`Bearer ${n.uid}`}}):e}function sW(e,i,n,t,r){switch(console.error("Security interceptor error:",e),console.log("Request URL that caused error:",i.url),e.status){case 401:cW(n,t,r);break;case 403:lW(r);break;case 429:dW(r);break;case 500:mW(r);break;default:gW(e,r)}return Na(()=>e)}function cW(e,i,n){var t;console.warn("Unauthorized request detected"),Bd("UNAUTHORIZED_REQUEST",{url:((t=window==null?void 0:window.location)==null?void 0:t.href)||"",timestamp:new Date().toISOString()}),i.forceLogout("Unauthorized request detected"),n.error("Session expired. Please log in again."),e.navigate(["/landing"],{queryParams:{error:"unauthorized",redirect:e.url}})}function lW(e){var i;console.warn("Forbidden request detected"),Bd("FORBIDDEN_REQUEST",{url:((i=window==null?void 0:window.location)==null?void 0:i.href)||"",timestamp:new Date().toISOString()}),e.error("Access denied. You do not have permission to perform this action.")}function dW(e){var i;console.warn("Rate limit exceeded"),Bd("RATE_LIMIT_EXCEEDED",{url:((i=window==null?void 0:window.location)==null?void 0:i.href)||"",timestamp:new Date().toISOString()}),e.warning("Too many requests. Please wait a moment before trying again.")}function mW(e){var i;console.error("Server error detected"),Bd("SERVER_ERROR",{url:((i=window==null?void 0:window.location)==null?void 0:i.href)||"",timestamp:new Date().toISOString()}),e.error("Server error. Please try again later.")}function gW(e,i){var n;console.error("Generic HTTP error:",e),Bd("HTTP_ERROR",{status:e.status,statusText:e.statusText,url:e.url||((n=window==null?void 0:window.location)==null?void 0:n.href)||"",timestamp:new Date().toISOString()}),e.status>=500?i.error("Server error. Please try again later."):e.status>=400&&i.error("Request failed. Please check your input and try again.")}function Bd(e,i){var t;let n={type:e,data:i,userAgent:navigator.userAgent,timestamp:new Date().toISOString(),url:((t=window==null?void 0:window.location)==null?void 0:t.href)||""};console.log("Security Event:",n)}var eP=(()=>{let i=class i{};i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=ir({type:i,bootstrap:[rM]}),i.\u0275inj=nr({providers:[aM(),A1(D1([JM])),dM,B1(),qr,x_(()=>C_(mi.firebaseConfig)),b_(()=>{let t=y_();return t.setPersistence(v_).then(()=>console.log("\u2705 Auth persistence enabled")).catch(r=>console.warn("\u26A0\uFE0F Auth persistence error:",r.message)),t}),M_(()=>{let t=O_();return P_(t).then(()=>{console.log("\u2705 Firestore offline persistence enabled")}).catch(r=>{r.code==="failed-precondition"?console.warn("\u26A0\uFE0F Multiple tabs detected. Persistence disabled to avoid conflicts."):r.code==="unimplemented"&&console.warn("\u26A0\uFE0F IndexedDB persistence not supported. Falling back to cache.")}),t}),G2(()=>{let t=Cl();return console.log("\u2705 Firebase Cloud Messaging initialized"),t})],imports:[r0,eM,cM,Yx,mM,OC.forRoot({echarts:()=>import("./chunk-BDRRPAEY.js")}),QM,Wx,Xc,Rc,dm,Kc,Zc,Qc,ns,sC,Q_.register("ngsw-worker.js",{enabled:!S1(),registrationStrategy:"registerImmediately",scope:"./"}),Al]});let e=i;return e})();b1(Qm,function(){return[or,dt,gn,q0,Qe,Dc,Fc,Jm]},function(){return[sr,_i,Sr]});function uW(){if(typeof window>"u")return;let e;window.addEventListener("beforeinstallprompt",i=>{i.preventDefault(),e=i,console.log("PWA install prompt ready")}),window.addEventListener("appinstalled",()=>{console.log("PWA installed successfully"),e=null}),window.addEventListener("popstate",i=>{console.log("Navigation event:",i)}),document.addEventListener("visibilitychange",()=>{document.hidden?console.log("App went to background"):console.log("App came to foreground")}),window.addEventListener("beforeunload",i=>{let n={timestamp:Date.now(),url:window.location.href,scrollPosition:window.scrollY};try{localStorage.setItem("app-state",JSON.stringify(n))}catch(t){console.warn("Failed to save app state:",t)}})}function pW(){if(typeof window>"u")return;if(typeof navigator<"u"&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){let i=new Date,n=Math.ceil(i.getDate()/7),t=i.getMonth()+1,a=`${i.getFullYear()}-${t.toString().padStart(2,"0")}-W${n}`,o=localStorage.getItem("app-version");o&&o!==a?(console.log("App version changed on mobile, performing smart cache update"),fW(o,a)):localStorage.setItem("app-version",a)}}function fW(e,i){return me(this,null,function*(){if(!(typeof window>"u"))try{console.log(`Performing smart cache update from ${e} to ${i}`);let n=hW();yield xW(),_W(n),localStorage.setItem("app-version",i),console.log("Smart cache update completed successfully")}catch(n){console.error("Smart cache update failed:",n)}})}function hW(){if(typeof window>"u")return{};let e={};return localStorage.getItem("firebase:authUser:")&&Object.keys(localStorage).filter(t=>t.startsWith("firebase:authUser:")||t.startsWith("firebase:persistence:")).forEach(t=>{e[t]=localStorage.getItem(t)}),["theme","language","user-settings"].forEach(n=>{let t=localStorage.getItem(n);t&&(e[n]=t)}),e}function _W(e){typeof window>"u"||Object.keys(e).forEach(i=>{localStorage.setItem(i,e[i])})}function xW(){return me(this,null,function*(){if(!(typeof window>"u"))try{if("caches"in window){let n=(yield caches.keys()).filter(t=>!t.includes("firebase")&&!t.includes("auth")&&!t.includes("user"));yield Promise.all(n.map(t=>caches.delete(t)))}Object.keys(localStorage).filter(i=>!i.startsWith("firebase:")&&!i.startsWith("user")&&!i.startsWith("theme")&&!i.startsWith("language")&&i!=="app-version").forEach(i=>localStorage.removeItem(i)),console.log("Application caches cleared successfully")}catch(e){throw console.error("Failed to clear application caches:",e),e}})}uW();pW();F1().bootstrapModule(eP,{ngZoneEventCoalescing:!0}).catch(e=>console.error(e));
