import{Bb as be,Cb as B,Db as _e,Eb as V,Ed as we,Fd as ke,Hb as Se,Kb as Ie,Lb as xe,Mb as q,Mc as Pe,Nd as Ce,Ob as ye,Pd as Ee,Qd as Oe,Rd as Ae,Sc as Te,Tc as ze,l as A,nd as M,ub as D,vd as L,wb as he,xb as fe,zb as ve}from"./chunk-BDW4GXKK.js";import{$b as l,Aa as te,Ba as ie,Ec as me,Id as ge,J as Q,Ka as I,La as x,Ma as y,Na as ae,Nb as oe,Qb as P,Rb as b,Sb as h,Xb as _,Ya as ne,Yb as se,Zb as ce,_b as le,ac as m,bb as re,bc as T,bd as ue,c as H,f as Y,fc as C,gd as O,h as $,hd as w,ic as f,kc as g,p as X,pa as u,q as U,qa as W,sa as Z,u as K,ua as d,ub as p,uc as de,vb as k,vc as z,wc as pe,xa as J,xc as E,ya as ee}from"./chunk-6PX2HEG6.js";import{a as N,b as j,k as c}from"./chunk-LKDXID24.js";function De(n,a){if(n&1&&(l(0,"mat-option",17),z(1),m()),n&2){let o=a.$implicit;h("value",o),p(),E(" ",o," ")}}function Me(n,a){if(n&1){let o=C();l(0,"mat-form-field",14)(1,"mat-select",16,0),f("selectionChange",function(t){I(o);let i=g(2);return x(i._changePageSize(t.value))}),ce(3,De,2,2,"mat-option",17,se),m(),l(5,"div",18),f("click",function(){I(o);let t=de(2);return x(t.open())}),m()()}if(n&2){let o=g(2);h("appearance",o._formFieldAppearance)("color",o.color),p(),h("value",o.pageSize)("disabled",o.disabled)("aria-labelledby",o._pageSizeLabelId)("panelClass",o.selectConfig.panelClass||"")("disableOptionCentering",o.selectConfig.disableOptionCentering),p(2),le(o._displayedPageSizeOptions)}}function Le(n,a){if(n&1&&(l(0,"div",15),z(1),m()),n&2){let o=g(2);p(),pe(o.pageSize)}}function Fe(n,a){if(n&1&&(l(0,"div",3)(1,"div",13),z(2),m(),P(3,Me,6,7,"mat-form-field",14)(4,Le,2,1,"div",15),m()),n&2){let o=g();p(),b("id",o._pageSizeLabelId),p(),E(" ",o._intl.itemsPerPageLabel," "),p(),_(o._displayedPageSizeOptions.length>1?3:-1),p(),_(o._displayedPageSizeOptions.length<=1?4:-1)}}function Re(n,a){if(n&1){let o=C();l(0,"button",19),f("click",function(){I(o);let t=g();return x(t.firstPage())}),y(),l(1,"svg",8),T(2,"path",20),m()()}if(n&2){let o=g();h("matTooltip",o._intl.firstPageLabel)("matTooltipDisabled",o._previousButtonsDisabled())("matTooltipPosition","above")("disabled",o._previousButtonsDisabled()),b("aria-label",o._intl.firstPageLabel)}}function Ne(n,a){if(n&1){let o=C();l(0,"button",21),f("click",function(){I(o);let t=g();return x(t.lastPage())}),y(),l(1,"svg",8),T(2,"path",22),m()()}if(n&2){let o=g();h("matTooltip",o._intl.lastPageLabel)("matTooltipDisabled",o._nextButtonsDisabled())("matTooltipPosition","above")("disabled",o._nextButtonsDisabled()),b("aria-label",o._intl.lastPageLabel)}}var F=(()=>{let a=class a{constructor(){this.changes=new Y,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(e,t,i)=>{if(i==0||t==0)return`0 of ${i}`;i=Math.max(i,0);let r=e*t,s=r<i?Math.min(r+t,i):r+t;return`${r+1} \u2013 ${s} of ${i}`}}};a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"});let n=a;return n})();function je(n){return n||new F}var Ue={provide:F,deps:[[new J,new ee,F]],useFactory:je},Be=50;var Ve=new Z("MAT_PAGINATOR_DEFAULT_OPTIONS"),qe=0,Ge=(()=>{let a=class a{get pageIndex(){return this._pageIndex}set pageIndex(e){this._pageIndex=Math.max(e||0,0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(e){this._length=e||0,this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(e){this._pageSize=Math.max(e||0,0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(e){this._pageSizeOptions=(e||[]).map(t=>w(t,0)),this._updateDisplayedPageSizeOptions()}constructor(e,t,i){if(this._intl=e,this._changeDetectorRef=t,this._pageSizeLabelId=`mat-paginator-page-size-label-${qe++}`,this._isInitialized=!1,this._initializedStream=new $(1),this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this.hidePageSize=!1,this.showFirstLastButtons=!1,this.selectConfig={},this.disabled=!1,this.page=new ne,this.initialized=this._initializedStream,this._intlChanges=e.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),i){let{pageSize:r,pageSizeOptions:s,hidePageSize:v,showFirstLastButtons:S}=i;r!=null&&(this._pageSize=r),s!=null&&(this._pageSizeOptions=s),v!=null&&(this.hidePageSize=v),S!=null&&(this.showFirstLastButtons=S)}this._formFieldAppearance=(i==null?void 0:i.formFieldAppearance)||"outline"}ngOnInit(){this._isInitialized=!0,this._updateDisplayedPageSizeOptions(),this._initializedStream.next()}ngOnDestroy(){this._initializedStream.complete(),this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;let e=this.pageIndex;this.pageIndex=this.pageIndex+1,this._emitPageEvent(e)}previousPage(){if(!this.hasPreviousPage())return;let e=this.pageIndex;this.pageIndex=this.pageIndex-1,this._emitPageEvent(e)}firstPage(){if(!this.hasPreviousPage())return;let e=this.pageIndex;this.pageIndex=0,this._emitPageEvent(e)}lastPage(){if(!this.hasNextPage())return;let e=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(e)}hasPreviousPage(){return this.pageIndex>=1&&this.pageSize!=0}hasNextPage(){let e=this.getNumberOfPages()-1;return this.pageIndex<e&&this.pageSize!=0}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(e){let t=this.pageIndex*this.pageSize,i=this.pageIndex;this.pageIndex=Math.floor(t/e)||0,this.pageSize=e,this._emitPageEvent(i)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._isInitialized&&(this.pageSize||(this._pageSize=this.pageSizeOptions.length!=0?this.pageSizeOptions[0]:Be),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),this._displayedPageSizeOptions.indexOf(this.pageSize)===-1&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((e,t)=>e-t),this._changeDetectorRef.markForCheck())}_emitPageEvent(e){this.page.emit({previousPageIndex:e,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}};a.\u0275fac=function(t){return new(t||a)(k(F),k(ue),k(Ve,8))},a.\u0275cmp=te({type:a,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-mdc-paginator"],inputs:{color:"color",pageIndex:[2,"pageIndex","pageIndex",w],length:[2,"length","length",w],pageSize:[2,"pageSize","pageSize",w],pageSizeOptions:"pageSizeOptions",hidePageSize:[2,"hidePageSize","hidePageSize",O],showFirstLastButtons:[2,"showFirstLastButtons","showFirstLastButtons",O],selectConfig:"selectConfig",disabled:[2,"disabled","disabled",O]},outputs:{page:"page"},exportAs:["matPaginator"],standalone:!0,features:[oe,me],decls:14,vars:14,consts:[["selectRef",""],[1,"mat-mdc-paginator-outer-container"],[1,"mat-mdc-paginator-container"],[1,"mat-mdc-paginator-page-size"],[1,"mat-mdc-paginator-range-actions"],["aria-live","polite",1,"mat-mdc-paginator-range-label"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-previous",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true",1,"mat-mdc-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-next",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],[1,"mat-mdc-paginator-page-size-label"],[1,"mat-mdc-paginator-page-size-select",3,"appearance","color"],[1,"mat-mdc-paginator-page-size-value"],["hideSingleSelectionIndicator","",3,"selectionChange","value","disabled","aria-labelledby","panelClass","disableOptionCentering"],[3,"value"],[1,"mat-mdc-paginator-touch-target",3,"click"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-first",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-last",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(t,i){t&1&&(l(0,"div",1)(1,"div",2),P(2,Fe,5,4,"div",3),l(3,"div",4)(4,"div",5),z(5),m(),P(6,Re,3,5,"button",6),l(7,"button",7),f("click",function(){return i.previousPage()}),y(),l(8,"svg",8),T(9,"path",9),m()(),ae(),l(10,"button",10),f("click",function(){return i.nextPage()}),y(),l(11,"svg",8),T(12,"path",11),m()(),P(13,Ne,3,5,"button",12),m()()()),t&2&&(p(2),_(i.hidePageSize?-1:2),p(3),E(" ",i._intl.getRangeLabel(i.pageIndex,i.pageSize,i.length)," "),p(),_(i.showFirstLastButtons?6:-1),p(),h("matTooltip",i._intl.previousPageLabel)("matTooltipDisabled",i._previousButtonsDisabled())("matTooltipPosition","above")("disabled",i._previousButtonsDisabled()),b("aria-label",i._intl.previousPageLabel),p(3),h("matTooltip",i._intl.nextPageLabel)("matTooltipDisabled",i._nextButtonsDisabled())("matTooltipPosition","above")("disabled",i._nextButtonsDisabled()),b("aria-label",i._intl.nextPageLabel),p(3),_(i.showFirstLastButtons?13:-1))},dependencies:[Ce,Ee,Pe,Te,we],styles:[".mat-mdc-paginator{display:block;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-paginator-container-text-color, var(--mat-app-on-surface));background-color:var(--mat-paginator-container-background-color, var(--mat-app-surface));font-family:var(--mat-paginator-container-text-font, var(--mat-app-body-small-font));line-height:var(--mat-paginator-container-text-line-height, var(--mat-app-body-small-line-height));font-size:var(--mat-paginator-container-text-size, var(--mat-app-body-small-size));font-weight:var(--mat-paginator-container-text-weight, var(--mat-app-body-small-weight));letter-spacing:var(--mat-paginator-container-text-tracking, var(--mat-app-body-small-tracking));--mat-form-field-container-height:var(--mat-paginator-form-field-container-height);--mat-form-field-container-vertical-padding:var(--mat-paginator-form-field-container-vertical-padding)}.mat-mdc-paginator .mat-mdc-select-value{font-size:var(--mat-paginator-select-trigger-text-size, var(--mat-app-body-small-size))}.mat-mdc-paginator .mat-mdc-form-field-subscript-wrapper{display:none}.mat-mdc-paginator .mat-mdc-select{line-height:1.5}.mat-mdc-paginator-outer-container{display:flex}.mat-mdc-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap;width:100%;min-height:var(--mat-paginator-container-size)}.mat-mdc-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-mdc-paginator-page-size{margin-right:0;margin-left:8px}.mat-mdc-paginator-page-size-label{margin:0 4px}.mat-mdc-paginator-page-size-select{margin:0 4px;width:84px}.mat-mdc-paginator-range-label{margin:0 32px 0 24px}.mat-mdc-paginator-range-actions{display:flex;align-items:center}.mat-mdc-paginator-icon{display:inline-block;width:28px;fill:var(--mat-paginator-enabled-icon-color, var(--mat-app-on-surface-variant))}.mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon{fill:var(--mat-paginator-disabled-icon-color)}[dir=rtl] .mat-mdc-paginator-icon{transform:rotate(180deg)}.cdk-high-contrast-active .mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon,.cdk-high-contrast-active .mat-mdc-paginator-icon{fill:currentColor;fill:CanvasText}.cdk-high-contrast-active .mat-mdc-paginator-range-actions .mat-mdc-icon-button{outline:solid 1px}.mat-mdc-paginator-touch-target{display:var(--mat-paginator-touch-target-display);position:absolute;top:50%;left:50%;width:84px;height:48px;background-color:rgba(0,0,0,0);transform:translate(-50%, -50%);cursor:pointer}"],encapsulation:2,changeDetection:0});let n=a;return n})(),dt=(()=>{let a=class a{};a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=ie({type:a}),a.\u0275inj=W({providers:[Ue],imports:[ze,Oe,ke,Ge]});let n=a;return n})();var ft=(()=>{let a=class a{constructor(e){this.platformId=e}isClientSide(){return!ge(this.platformId)}};a.\u0275fac=function(t){return new(t||a)(d(re))},a.\u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"});let n=a;return n})();var G={SESSION_TIMEOUT:30*60*1e3,INACTIVITY_TIMEOUT:60*60*1e3,MAX_LOGIN_ATTEMPTS:5,LOCKOUT_DURATION:15*60*1e3,PASSWORD_MIN_LENGTH:8,REQUIRE_EMAIL_VERIFICATION:!0,ENABLE_RATE_LIMITING:!0,SECURE_HEADERS:!0},xt=(()=>{let a=class a{constructor(e,t,i,r){this.router=e,this.userService=t,this.notificationService=i,this.loaderService=r,this.sessionStartTime=new Map,this.initializeSecurityHeaders(),this.startSessionMonitoring()}canActivate(e,t){return this.performSecurityCheck(e,t)}canActivateChild(e,t){return this.performSecurityCheck(e,t)}performSecurityCheck(e,t){this.loaderService.show();let i=he(),r=i.currentUser;return r?(this.backgroundSecurityCheck(e,t,r),U(!0)):new H(s=>{let v=fe(i,S=>{v(),S?(this.backgroundSecurityCheck(e,t,S),s.next(!0),this.loaderService.hide()):this.handleUnauthenticatedUser(t).then(()=>{this.loaderService.hide(),s.next(!1)})})}).pipe(K(1e4),Q(s=>(console.error("[AuthGuard] Timeout or error:",s),this.router.navigate(["/sign-in"],{queryParams:{error:"auth_timeout",redirect:t.url}}),U(!1))))}backgroundSecurityCheck(e,t,i){setTimeout(()=>c(this,null,function*(){try{if(this.sessionStartTime.has(i.uid)||this.updateSessionTimestamp(i.uid),this.isSessionExpired(i.uid)){yield this.handleSessionExpired(i,t);return}let r=yield this.userService.getCurrentUser();if(!r){yield this.handleInvalidUserData(i,t);return}if(!(yield this.checkRoutePermissions(e,r,i))){yield this.handleInsufficientPermissions(r,t);return}this.updateSessionTimestamp(i.uid)}catch(r){console.error("[AuthGuard] Background error:",r),yield this.handleSecurityError(r,t)}finally{this.loaderService.hide()}}),0)}checkRoutePermissions(e,t,i){return c(this,null,function*(){var s;let r=e.data;return r!=null&&r.requireEmailVerification&&!i.emailVerified?(console.warn("[AuthGuard] Email not verified"),!1):((s=r==null?void 0:r.roles)==null?void 0:s.length)>0&&!r.roles.includes(t.role)?(console.warn("[AuthGuard] Insufficient role:",t.role),!1):r!=null&&r.requireTwoFactor&&!this.hasTwoFactorEnabled(t)?(console.warn("[AuthGuard] Two-factor required"),!1):!0})}isSessionExpired(e){let t=this.sessionStartTime.get(e),i=Date.now();return!!t&&i-t>G.SESSION_TIMEOUT}updateSessionTimestamp(e){this.sessionStartTime.set(e,Date.now())}handleUnauthenticatedUser(e){return c(this,null,function*(){this.router.navigate(["/sign-in"],{queryParams:{session:"expired",redirect:e.url}})})}handleSessionExpired(e,t){return c(this,null,function*(){this.sessionStartTime.delete(e.uid),this.userService.clearCachedUserData(),yield this.userService.signOut(),this.router.navigate(["/sign-in"],{queryParams:{session:"expired",redirect:t.url,reason:"timeout"}})})}handleInvalidUserData(e,t){return c(this,null,function*(){this.userService.clearCachedUserData(),yield this.userService.signOut(),this.router.navigate(["/sign-in"],{queryParams:{error:"invalid_user_data",redirect:t.url}})})}handleInsufficientPermissions(e,t){return c(this,null,function*(){this.notificationService.error("Access Denied: You do not have permission to access this page."),this.router.navigate(["/dashboard"],{queryParams:{error:"insufficient_permissions",requestedRoute:t.url}})})}handleSecurityError(e,t){return c(this,null,function*(){this.router.navigate(["/sign-in"],{queryParams:{error:"security_error",redirect:t.url,message:e.message||"Unknown error"}})})}startSessionMonitoring(){let e,t=()=>{clearTimeout(e),e=setTimeout(()=>{this.handleInactivity()},G.INACTIVITY_TIMEOUT)};["mousedown","mousemove","keypress","scroll","touchstart"].forEach(i=>{document.addEventListener(i,t,!0)}),t()}handleInactivity(){let e=this.userService.getUser();e&&(console.log("[AuthGuard] Inactivity detected. Logging out user:",e.uid),this.userService.signOut())}hasTwoFactorEnabled(e){return!1}initializeSecurityHeaders(){if(!G.SECURE_HEADERS)return;new Map([["X-Content-Type-Options","nosniff"],["X-Frame-Options","DENY"],["X-XSS-Protection","1; mode=block"],["Referrer-Policy","strict-origin-when-cross-origin"],["Permissions-Policy","geolocation=(), microphone=(), camera=()"]]).forEach((t,i)=>{if(typeof document<"u"){let r=document.createElement("meta");r.httpEquiv=i,r.content=t,document.head.appendChild(r)}})}};a.\u0275fac=function(t){return new(t||a)(d(A),d(L),d(M),d(Ae))},a.\u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"});let n=a;return n})();var zt=(()=>{let a=class a{constructor(e,t,i,r){this.auth=e,this.router=t,this.notificationService=i,this.userService=r}canActivate(e,t){return X(this.checkAdminAccess())}checkAdminAccess(){return c(this,null,function*(){try{return(yield this.auth.currentUser)?(yield this.isUserAdmin())?!0:(this.notificationService.error("Admin access required"),this.router.navigate(["/dashboard"]),!1):(this.notificationService.error("Authentication required"),this.router.navigate(["/sign-in"]),!1)}catch(e){return console.error("Error checking admin access:",e),this.notificationService.error("Failed to verify admin access"),this.router.navigate(["/dashboard"]),!1}})}isUserAdmin(){return c(this,null,function*(){return this.userService.isAdmin})}};a.\u0275fac=function(t){return new(t||a)(d(D),d(A),d(M),d(L))},a.\u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"});let n=a;return n})();var Ot=(()=>{let a=class a{constructor(e,t){this.firestore=e,this.auth=t}submitFeedback(e){return c(this,null,function*(){var t;try{let i=j(N({},e),{userId:((t=this.auth.currentUser)==null?void 0:t.uid)||"anonymous",timestamp:q(),status:"pending",userAgent:navigator.userAgent,appVersion:"1.0.0"}),r=B(this.firestore,"feedback"),s=yield be(r,i);console.log("Feedback submitted successfully:",s.id)}catch(i){throw console.error("Error submitting feedback:",i),i}})}getCategoryLabel(e){return{bug:"Bug Report",feature:"Feature Request",improvement:"Improvement Suggestion",general:"General Feedback",support:"Support Request"}[e]||e}getAllFeedback(){return c(this,null,function*(){try{let e=B(this.firestore,"feedback"),t=xe(e,Ie("timestamp","desc")),i=yield Se(t),r=[];return i.forEach(s=>{let v=s.data();r.push(j(N({},v),{id:s.id}))}),r}catch(e){throw console.error("Error fetching feedback:",e),e}})}updateFeedbackStatus(e,t){return c(this,null,function*(){try{let i=V(this.firestore,"feedback",e);yield ye(i,{status:t,updatedAt:q()})}catch(i){throw console.error("Error updating feedback status:",i),i}})}deleteFeedback(e){return c(this,null,function*(){try{let t=V(this.firestore,"feedback",e);yield _e(t)}catch(t){throw console.error("Error deleting feedback:",t),t}})}};a.\u0275fac=function(t){return new(t||a)(d(ve),d(D))},a.\u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"});let n=a;return n})();export{ft as a,xt as b,zt as c,Ge as d,dt as e,Ot as f};
