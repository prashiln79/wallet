import{$ as Bd,A as Cx,B as vx,C as Qi,D as Jr,E as bx,F as yx,G as Mx,H as Sx,I as ko,J as Eo,K as Px,L as Fd,M as Rd,N as Nd,O as kx,P as Ex,Q as Tx,R as Ix,S as Ax,T as Dx,U as Fx,V as Rx,W as Nx,X as Bx,Y as xl,Z as Lx,_ as Vx,a as Sd,aa as Ux,b as tx,ba as Wt,c as nx,ca as Qr,d as ix,da as Yt,e as At,ea as Yx,f as Sr,fa as $x,g as gc,ga as Gx,h as rx,ha as Hx,i as ax,j as ox,k as wa,l as Ed,m as sx,n as cx,o as lx,p as dx,q as gx,r as fx,s as px,t as Ri,u as Id,v as hx,w as xx,x as yo,y as Mo,z as Wi}from"./chunk-LGWKDAJN.js";import{a as ri,b as md,c as gd,d as ho,e as ic,f as fd,g as xo,h as rc,i as pd,j as ac,k as _o,l as hd,m as xd,n as _d,o as gl,p as w1,q as ux,r as mx,s as Rr,t as Pr,u as sg,v as wx,w as Wx}from"./chunk-2ANBHGFW.js";import{$ as g1,$a as k1,$b as Y1,$d as Ni,A as ki,Aa as J0,Ab as j1,Ba as Q0,Bd as ex,C as Ei,Ca as ed,Cb as Fr,Cd as gi,D as s1,Da as td,Db as Di,Dd as fi,Ea as nd,Eb as Md,Ed as pi,F as Ti,Fa as _1,Fb as Et,Fd as fn,G as Gs,Ga as id,Gb as z1,H as Hs,Ha as C1,Hb as ai,Hd as Pd,I as qs,Ia as mr,Ib as ya,Id as Od,J as Xs,Ja as rd,Jb as W1,Jd as kd,K as Ks,Ka as ad,Kb as ng,L as Zs,La as tc,Lb as ig,Ld as Kr,M as Js,Ma as v1,Mb as rg,Md as Td,N as Ii,Na as od,Nb as hl,Oa as ba,Ob as wr,Od as Jn,Pa as b1,Pb as kn,Q as zt,Qa as sd,Qc as Fi,Qd as Ad,R as c1,Ra as nc,Rb as ag,S as l1,Sa as cd,T as Mt,Ta as ld,Tc as Ht,Td as Zr,U as Pt,Ua as dd,Uc as K1,Ud as Sa,V as Qm,Va as y1,Vc as Ma,Vd as Dd,W as U0,Wa as ud,Wb as og,Wc as Z1,Wd as _x,X as d1,Xa as M1,Xb as Za,Xc as bn,Xd as wo,Y as u1,Ya as S1,Yb as en,Z as m1,Za as P1,Zb as Hr,Zd as Ji,_ as eg,_a as O1,_b as mi,a as Jh,aa as f1,ab as Cd,ac as vo,b as Qh,ba as wt,bb as vd,bc as bo,c as R0,ca as gn,cb as oc,cc as Dt,ce as Pa,d as e1,da as Qs,db as fl,dc as zn,e as N0,eb as bd,ec as $1,ee as fc,f as t1,fb as sc,fc as G1,fe as So,g as n1,ga as p1,gb as pl,gc as H1,ge as Po,h as i1,ha as Te,hb as tg,hc as q1,he as Oo,i as B0,ia as Gr,ib as Co,ic as oi,j as r1,ja as Mr,jb as E1,jc as X1,je as To,k as L0,ka as j0,kb as T1,l as Kt,la as z0,lb as I1,m as V0,ma as W0,mb as A1,n as a1,na as h1,nb as D1,o as ul,oa as Y0,ob as yd,pa as $0,pb as F1,pe as Ox,q as o1,qa as x1,qb as R1,r as Vt,ra as G0,rb as N1,re as jx,sa as ec,sb as B1,sd as J1,se as zx,t as Qe,ta as H0,tb as L1,tc as Zi,u as Ut,ua as q0,ub as pt,uc as cc,ud as ht,v as Un,va as X0,vb as V1,vd as qr,w as $s,wa as K0,wb as U1,wd as Q1,xa as ml,xd as at,y as Zn,ya as po,yb as Ai,z as jn,za as Z0,zb as Ki,zd as Xr}from"./chunk-PRBXNMPP.js";import{f as qx,g as _l,h as Ld,m as Xx,n as Vd,p as Kx,u as Zx}from"./chunk-LFIQVDMY.js";import{$ as Ah,$b as l,Aa as Cr,Ac as mt,Ad as go,Ba as S0,Bb as Jm,Bc as gt,Bd as yr,Cb as vr,Cd as Vn,Da as zs,Dd as Zh,E as Xm,Ec as $h,Ed as Ys,Fc as A0,G as Xi,Gc as dl,Hc as Gh,I as _t,Ia as P0,Ic as Hh,Id as fo,J as Ih,Ja as G,Jc as pe,K as cl,Ka as H,Kc as Ee,La as yi,Lc as yt,M as qa,Ma as Yr,Na as Vh,Nd as wd,Od as lc,Pa as Uh,Pb as X,Qa as jh,Qb as ga,Qd as dc,R as js,Rb as w,Rd as uc,Sb as Xt,Ta as Zm,Tb as Je,Td as mc,Ua as Ka,Ub as Lt,Va as Ws,Vc as qh,Wb as ot,Xa as $n,Xb as Oi,Yb as Ge,Zb as He,_b as c,a as Pi,aa as Dh,ab as O0,ac as se,ad as Xh,ba as Fh,bb as ll,bc as ts,bd as Kh,c as qt,cc as ns,da as Rh,ec as be,f as vn,fa as zr,g as mn,ga as Qt,h as sl,hc as N,j as Sh,ja as Nh,jc as S,k as Ph,ka as Bh,l as Oh,la as Lh,mc as fa,n as kh,oa as dt,ob as k0,oc as Ir,p as On,pa as _r,pc as Ar,pd as D0,q as lt,qb as zh,qc as Dr,r as es,ra as Xa,rb as E0,ta as De,tb as p,tc as Gn,u as Eh,ua as Wr,ub as q,uc as d,ud as F0,v as rt,vb as Wh,vc as z,w as Th,wa as Km,wc as oe,wd as br,x as Bt,xb as Yh,xc as jt,xd as $r,yc as I0,yd as ct,za as Ve,zb as T0,zc as ut}from"./chunk-QDIMVJ4X.js";import{a as ae,b as le,c as Mh,d as Vs,e as Us,f as wh,h as Tr,k as ue}from"./chunk-LKDXID24.js";var Nr=wh((fg,Mc)=>{"use strict";(function(e,n){typeof fg=="object"&&typeof Mc<"u"?Mc.exports=n():typeof define=="function"&&define.amd?define(n):e.moment=n()})(fg,function(){"use strict";var e;function n(){return e.apply(null,arguments)}function i(g){e=g}function t(g){return g instanceof Array||Object.prototype.toString.call(g)==="[object Array]"}function r(g){return g!=null&&Object.prototype.toString.call(g)==="[object Object]"}function a(g,x){return Object.prototype.hasOwnProperty.call(g,x)}function o(g){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(g).length===0;var x;for(x in g)if(a(g,x))return!1;return!0}function s(g){return g===void 0}function u(g){return typeof g=="number"||Object.prototype.toString.call(g)==="[object Number]"}function m(g){return g instanceof Date||Object.prototype.toString.call(g)==="[object Date]"}function f(g,x){var b=[],M,A=g.length;for(M=0;M<A;++M)b.push(x(g[M],M));return b}function h(g,x){for(var b in x)a(x,b)&&(g[b]=x[b]);return a(x,"toString")&&(g.toString=x.toString),a(x,"valueOf")&&(g.valueOf=x.valueOf),g}function _(g,x,b,M){return eh(g,x,b,M,!0).utc()}function y(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function v(g){return g._pf==null&&(g._pf=y()),g._pf}var C;Array.prototype.some?C=Array.prototype.some:C=function(g){var x=Object(this),b=x.length>>>0,M;for(M=0;M<b;M++)if(M in x&&g.call(this,x[M],M,x))return!0;return!1};function P(g){var x=null,b=!1,M=g._d&&!isNaN(g._d.getTime());if(M&&(x=v(g),b=C.call(x.parsedDateParts,function(A){return A!=null}),M=x.overflow<0&&!x.empty&&!x.invalidEra&&!x.invalidMonth&&!x.invalidWeekday&&!x.weekdayMismatch&&!x.nullInput&&!x.invalidFormat&&!x.userInvalidated&&(!x.meridiem||x.meridiem&&b),g._strict&&(M=M&&x.charsLeftOver===0&&x.unusedTokens.length===0&&x.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(g))g._isValid=M;else return M;return g._isValid}function D(g){var x=_(NaN);return g!=null?h(v(x),g):v(x).userInvalidated=!0,x}var T=n.momentProperties=[],I=!1;function K(g,x){var b,M,A,ne=T.length;if(s(x._isAMomentObject)||(g._isAMomentObject=x._isAMomentObject),s(x._i)||(g._i=x._i),s(x._f)||(g._f=x._f),s(x._l)||(g._l=x._l),s(x._strict)||(g._strict=x._strict),s(x._tzm)||(g._tzm=x._tzm),s(x._isUTC)||(g._isUTC=x._isUTC),s(x._offset)||(g._offset=x._offset),s(x._pf)||(g._pf=v(x)),s(x._locale)||(g._locale=x._locale),ne>0)for(b=0;b<ne;b++)M=T[b],A=x[M],s(A)||(g[M]=A);return g}function ee(g){K(this,g),this._d=new Date(g._d!=null?g._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),I===!1&&(I=!0,n.updateOffset(this),I=!1)}function k(g){return g instanceof ee||g!=null&&g._isAMomentObject!=null}function O(g){n.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+g)}function R(g,x){var b=!0;return h(function(){if(n.deprecationHandler!=null&&n.deprecationHandler(null,g),b){var M=[],A,ne,ve,et=arguments.length;for(ne=0;ne<et;ne++){if(A="",typeof arguments[ne]=="object"){A+=`
[`+ne+"] ";for(ve in arguments[0])a(arguments[0],ve)&&(A+=ve+": "+arguments[0][ve]+", ");A=A.slice(0,-2)}else A=arguments[ne];M.push(A)}O(g+`
Arguments: `+Array.prototype.slice.call(M).join("")+`
`+new Error().stack),b=!1}return x.apply(this,arguments)},x)}var U={};function Q(g,x){n.deprecationHandler!=null&&n.deprecationHandler(g,x),U[g]||(O(x),U[g]=!0)}n.suppressDeprecationWarnings=!1,n.deprecationHandler=null;function re(g){return typeof Function<"u"&&g instanceof Function||Object.prototype.toString.call(g)==="[object Function]"}function ie(g){var x,b;for(b in g)a(g,b)&&(x=g[b],re(x)?this[b]=x:this["_"+b]=x);this._config=g,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Pe(g,x){var b=h({},g),M;for(M in x)a(x,M)&&(r(g[M])&&r(x[M])?(b[M]={},h(b[M],g[M]),h(b[M],x[M])):x[M]!=null?b[M]=x[M]:delete b[M]);for(M in g)a(g,M)&&!a(x,M)&&r(g[M])&&(b[M]=h({},b[M]));return b}function Re(g){g!=null&&this.set(g)}var xe;Object.keys?xe=Object.keys:xe=function(g){var x,b=[];for(x in g)a(g,x)&&b.push(x);return b};var Be={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function we(g,x,b){var M=this._calendar[g]||this._calendar.sameElse;return re(M)?M.call(x,b):M}function $e(g,x,b){var M=""+Math.abs(g),A=x-M.length,ne=g>=0;return(ne?b?"+":"":"-")+Math.pow(10,Math.max(0,A)).toString().substr(1)+M}var Se=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ae=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ce={},Y={};function te(g,x,b,M){var A=M;typeof M=="string"&&(A=function(){return this[M]()}),g&&(Y[g]=A),x&&(Y[x[0]]=function(){return $e(A.apply(this,arguments),x[1],x[2])}),b&&(Y[b]=function(){return this.localeData().ordinal(A.apply(this,arguments),g)})}function Z(g){return g.match(/\[[\s\S]/)?g.replace(/^\[|\]$/g,""):g.replace(/\\/g,"")}function J(g){var x=g.match(Se),b,M;for(b=0,M=x.length;b<M;b++)Y[x[b]]?x[b]=Y[x[b]]:x[b]=Z(x[b]);return function(A){var ne="",ve;for(ve=0;ve<M;ve++)ne+=re(x[ve])?x[ve].call(A,g):x[ve];return ne}}function de(g,x){return g.isValid()?(x=Oe(x,g.localeData()),ce[x]=ce[x]||J(x),ce[x](g)):g.localeData().invalidDate()}function Oe(g,x){var b=5;function M(A){return x.longDateFormat(A)||A}for(Ae.lastIndex=0;b>=0&&Ae.test(g);)g=g.replace(Ae,M),Ae.lastIndex=0,b-=1;return g}var ke={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Me(g){var x=this._longDateFormat[g],b=this._longDateFormat[g.toUpperCase()];return x||!b?x:(this._longDateFormat[g]=b.match(Se).map(function(M){return M==="MMMM"||M==="MM"||M==="DD"||M==="dddd"?M.slice(1):M}).join(""),this._longDateFormat[g])}var _e="Invalid date";function it(){return this._invalidDate}var j="%d",st=/\d{1,2}/;function qe(g){return this._ordinal.replace("%d",g)}var bt={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Ze(g,x,b,M){var A=this._relativeTime[b];return re(A)?A(g,x,b,M):A.replace(/%d/i,g)}function Fe(g,x){var b=this._relativeTime[g>0?"future":"past"];return re(b)?b(x):b.replace(/%s/i,x)}var Tt={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function an(g){return typeof g=="string"?Tt[g]||Tt[g.toLowerCase()]:void 0}function Sn(g){var x={},b,M;for(M in g)a(g,M)&&(b=an(M),b&&(x[b]=g[M]));return x}var zi={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Nn(g){var x=[],b;for(b in g)a(g,b)&&x.push({unit:b,priority:zi[b]});return x.sort(function(M,A){return M.priority-A.priority}),x}var Xn=/\d/,Ot=/\d\d/,Mn=/\d{3}/,Kn=/\d{4}/,pr=/[+-]?\d{6}/,It=/\d\d?/,ui=/\d\d\d\d?/,xt=/\d\d\d\d\d\d?/,on=/\d{1,3}/,bi=/\d{1,4}/,Bn=/[+-]?\d{1,6}/,hr=/\d+/,qo=/[+-]?\d+/,Em=/Z|[+-]\d\d:?\d\d/gi,Is=/Z|[+-]\d\d(?::?\d\d)?/gi,g0=/[+-]?\d+(\.\d{1,3})?/,co=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ua=/^[1-9]\d?/,Jc=/^([1-9]\d|\d)/,As;As={};function Ke(g,x,b){As[g]=re(x)?x:function(M,A){return M&&b?b:x}}function Tm(g,x){return a(As,g)?As[g](x._strict,x._locale):new RegExp(Im(g))}function Im(g){return la(g.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(x,b,M,A,ne){return b||M||A||ne}))}function la(g){return g.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function xr(g){return g<0?Math.ceil(g)||0:Math.floor(g)}function Gt(g){var x=+g,b=0;return x!==0&&isFinite(x)&&(b=xr(x)),b}var Qc={};function un(g,x){var b,M=x,A;for(typeof g=="string"&&(g=[g]),u(x)&&(M=function(ne,ve){ve[x]=Gt(ne)}),A=g.length,b=0;b<A;b++)Qc[g[b]]=M}function Xo(g,x){un(g,function(b,M,A,ne){A._w=A._w||{},x(b,A._w,A,ne)})}function el(g,x,b){x!=null&&a(Qc,g)&&Qc[g](x,b._a,b,g)}function Ds(g){return g%4===0&&g%100!==0||g%400===0}var Si=0,da=1,E=2,L=3,F=4,B=5,V=6,W=7,me=8;te("Y",0,0,function(){var g=this.year();return g<=9999?$e(g,4):"+"+g}),te(0,["YY",2],0,function(){return this.year()%100}),te(0,["YYYY",4],0,"year"),te(0,["YYYYY",5],0,"year"),te(0,["YYYYYY",6,!0],0,"year"),Ke("Y",qo),Ke("YY",It,Ot),Ke("YYYY",bi,Kn),Ke("YYYYY",Bn,pr),Ke("YYYYYY",Bn,pr),un(["YYYYY","YYYYYY"],Si),un("YYYY",function(g,x){x[Si]=g.length===2?n.parseTwoDigitYear(g):Gt(g)}),un("YY",function(g,x){x[Si]=n.parseTwoDigitYear(g)}),un("Y",function(g,x){x[Si]=parseInt(g,10)});function Ce(g){return Ds(g)?366:365}n.parseTwoDigitYear=function(g){return Gt(g)+(Gt(g)>68?1900:2e3)};var ge=he("FullYear",!0);function fe(){return Ds(this.year())}function he(g,x){return function(b){return b!=null?(Ue(this,g,b),n.updateOffset(this,x),this):Ne(this,g)}}function Ne(g,x){if(!g.isValid())return NaN;var b=g._d,M=g._isUTC;switch(x){case"Milliseconds":return M?b.getUTCMilliseconds():b.getMilliseconds();case"Seconds":return M?b.getUTCSeconds():b.getSeconds();case"Minutes":return M?b.getUTCMinutes():b.getMinutes();case"Hours":return M?b.getUTCHours():b.getHours();case"Date":return M?b.getUTCDate():b.getDate();case"Day":return M?b.getUTCDay():b.getDay();case"Month":return M?b.getUTCMonth():b.getMonth();case"FullYear":return M?b.getUTCFullYear():b.getFullYear();default:return NaN}}function Ue(g,x,b){var M,A,ne,ve,et;if(!(!g.isValid()||isNaN(b))){switch(M=g._d,A=g._isUTC,x){case"Milliseconds":return void(A?M.setUTCMilliseconds(b):M.setMilliseconds(b));case"Seconds":return void(A?M.setUTCSeconds(b):M.setSeconds(b));case"Minutes":return void(A?M.setUTCMinutes(b):M.setMinutes(b));case"Hours":return void(A?M.setUTCHours(b):M.setHours(b));case"Date":return void(A?M.setUTCDate(b):M.setDate(b));case"FullYear":break;default:return}ne=b,ve=g.month(),et=g.date(),et=et===29&&ve===1&&!Ds(ne)?28:et,A?M.setUTCFullYear(ne,ve,et):M.setFullYear(ne,ve,et)}}function tt(g){return g=an(g),re(this[g])?this[g]():this}function je(g,x){if(typeof g=="object"){g=Sn(g);var b=Nn(g),M,A=b.length;for(M=0;M<A;M++)this[b[M].unit](g[b[M].unit])}else if(g=an(g),re(this[g]))return this[g](x);return this}function Ye(g,x){return(g%x+x)%x}var nt;Array.prototype.indexOf?nt=Array.prototype.indexOf:nt=function(g){var x;for(x=0;x<this.length;++x)if(this[x]===g)return x;return-1};function hn(g,x){if(isNaN(g)||isNaN(x))return NaN;var b=Ye(x,12);return g+=(x-b)/12,b===1?Ds(g)?29:28:31-b%7%2}te("M",["MM",2],"Mo",function(){return this.month()+1}),te("MMM",0,0,function(g){return this.localeData().monthsShort(this,g)}),te("MMMM",0,0,function(g){return this.localeData().months(this,g)}),Ke("M",It,Ua),Ke("MM",It,Ot),Ke("MMM",function(g,x){return x.monthsShortRegex(g)}),Ke("MMMM",function(g,x){return x.monthsRegex(g)}),un(["M","MM"],function(g,x){x[da]=Gt(g)-1}),un(["MMM","MMMM"],function(g,x,b,M){var A=b._locale.monthsParse(g,M,b._strict);A!=null?x[da]=A:v(b).invalidMonth=g});var Hi="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Yn="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),qi=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ko=co,Zo=co;function ja(g,x){return g?t(this._months)?this._months[g.month()]:this._months[(this._months.isFormat||qi).test(x)?"format":"standalone"][g.month()]:t(this._months)?this._months:this._months.standalone}function tl(g,x){return g?t(this._monthsShort)?this._monthsShort[g.month()]:this._monthsShort[qi.test(x)?"format":"standalone"][g.month()]:t(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ua(g,x,b){var M,A,ne,ve=g.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],M=0;M<12;++M)ne=_([2e3,M]),this._shortMonthsParse[M]=this.monthsShort(ne,"").toLocaleLowerCase(),this._longMonthsParse[M]=this.months(ne,"").toLocaleLowerCase();return b?x==="MMM"?(A=nt.call(this._shortMonthsParse,ve),A!==-1?A:null):(A=nt.call(this._longMonthsParse,ve),A!==-1?A:null):x==="MMM"?(A=nt.call(this._shortMonthsParse,ve),A!==-1?A:(A=nt.call(this._longMonthsParse,ve),A!==-1?A:null)):(A=nt.call(this._longMonthsParse,ve),A!==-1?A:(A=nt.call(this._shortMonthsParse,ve),A!==-1?A:null))}function eM(g,x,b){var M,A,ne;if(this._monthsParseExact)return ua.call(this,g,x,b);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),M=0;M<12;M++){if(A=_([2e3,M]),b&&!this._longMonthsParse[M]&&(this._longMonthsParse[M]=new RegExp("^"+this.months(A,"").replace(".","")+"$","i"),this._shortMonthsParse[M]=new RegExp("^"+this.monthsShort(A,"").replace(".","")+"$","i")),!b&&!this._monthsParse[M]&&(ne="^"+this.months(A,"")+"|^"+this.monthsShort(A,""),this._monthsParse[M]=new RegExp(ne.replace(".",""),"i")),b&&x==="MMMM"&&this._longMonthsParse[M].test(g))return M;if(b&&x==="MMM"&&this._shortMonthsParse[M].test(g))return M;if(!b&&this._monthsParse[M].test(g))return M}}function zp(g,x){if(!g.isValid())return g;if(typeof x=="string"){if(/^\d+$/.test(x))x=Gt(x);else if(x=g.localeData().monthsParse(x),!u(x))return g}var b=x,M=g.date();return M=M<29?M:Math.min(M,hn(g.year(),b)),g._isUTC?g._d.setUTCMonth(b,M):g._d.setMonth(b,M),g}function Wp(g){return g!=null?(zp(this,g),n.updateOffset(this,!0),this):Ne(this,"Month")}function tM(){return hn(this.year(),this.month())}function nM(g){return this._monthsParseExact?(a(this,"_monthsRegex")||Yp.call(this),g?this._monthsShortStrictRegex:this._monthsShortRegex):(a(this,"_monthsShortRegex")||(this._monthsShortRegex=Ko),this._monthsShortStrictRegex&&g?this._monthsShortStrictRegex:this._monthsShortRegex)}function iM(g){return this._monthsParseExact?(a(this,"_monthsRegex")||Yp.call(this),g?this._monthsStrictRegex:this._monthsRegex):(a(this,"_monthsRegex")||(this._monthsRegex=Zo),this._monthsStrictRegex&&g?this._monthsStrictRegex:this._monthsRegex)}function Yp(){function g(kt,Zt){return Zt.length-kt.length}var x=[],b=[],M=[],A,ne,ve,et;for(A=0;A<12;A++)ne=_([2e3,A]),ve=la(this.monthsShort(ne,"")),et=la(this.months(ne,"")),x.push(ve),b.push(et),M.push(et),M.push(ve);x.sort(g),b.sort(g),M.sort(g),this._monthsRegex=new RegExp("^("+M.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+b.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+x.join("|")+")","i")}function rM(g,x,b,M,A,ne,ve){var et;return g<100&&g>=0?(et=new Date(g+400,x,b,M,A,ne,ve),isFinite(et.getFullYear())&&et.setFullYear(g)):et=new Date(g,x,b,M,A,ne,ve),et}function nl(g){var x,b;return g<100&&g>=0?(b=Array.prototype.slice.call(arguments),b[0]=g+400,x=new Date(Date.UTC.apply(null,b)),isFinite(x.getUTCFullYear())&&x.setUTCFullYear(g)):x=new Date(Date.UTC.apply(null,arguments)),x}function f0(g,x,b){var M=7+x-b,A=(7+nl(g,0,M).getUTCDay()-x)%7;return-A+M-1}function $p(g,x,b,M,A){var ne=(7+b-M)%7,ve=f0(g,M,A),et=1+7*(x-1)+ne+ve,kt,Zt;return et<=0?(kt=g-1,Zt=Ce(kt)+et):et>Ce(g)?(kt=g+1,Zt=et-Ce(g)):(kt=g,Zt=et),{year:kt,dayOfYear:Zt}}function il(g,x,b){var M=f0(g.year(),x,b),A=Math.floor((g.dayOfYear()-M-1)/7)+1,ne,ve;return A<1?(ve=g.year()-1,ne=A+za(ve,x,b)):A>za(g.year(),x,b)?(ne=A-za(g.year(),x,b),ve=g.year()+1):(ve=g.year(),ne=A),{week:ne,year:ve}}function za(g,x,b){var M=f0(g,x,b),A=f0(g+1,x,b);return(Ce(g)-M+A)/7}te("w",["ww",2],"wo","week"),te("W",["WW",2],"Wo","isoWeek"),Ke("w",It,Ua),Ke("ww",It,Ot),Ke("W",It,Ua),Ke("WW",It,Ot),Xo(["w","ww","W","WW"],function(g,x,b,M){x[M.substr(0,1)]=Gt(g)});function aM(g){return il(g,this._week.dow,this._week.doy).week}var oM={dow:0,doy:6};function sM(){return this._week.dow}function cM(){return this._week.doy}function lM(g){var x=this.localeData().week(this);return g==null?x:this.add((g-x)*7,"d")}function dM(g){var x=il(this,1,4).week;return g==null?x:this.add((g-x)*7,"d")}te("d",0,"do","day"),te("dd",0,0,function(g){return this.localeData().weekdaysMin(this,g)}),te("ddd",0,0,function(g){return this.localeData().weekdaysShort(this,g)}),te("dddd",0,0,function(g){return this.localeData().weekdays(this,g)}),te("e",0,0,"weekday"),te("E",0,0,"isoWeekday"),Ke("d",It),Ke("e",It),Ke("E",It),Ke("dd",function(g,x){return x.weekdaysMinRegex(g)}),Ke("ddd",function(g,x){return x.weekdaysShortRegex(g)}),Ke("dddd",function(g,x){return x.weekdaysRegex(g)}),Xo(["dd","ddd","dddd"],function(g,x,b,M){var A=b._locale.weekdaysParse(g,M,b._strict);A!=null?x.d=A:v(b).invalidWeekday=g}),Xo(["d","e","E"],function(g,x,b,M){x[M]=Gt(g)});function uM(g,x){return typeof g!="string"?g:isNaN(g)?(g=x.weekdaysParse(g),typeof g=="number"?g:null):parseInt(g,10)}function mM(g,x){return typeof g=="string"?x.weekdaysParse(g)%7||7:isNaN(g)?null:g}function Am(g,x){return g.slice(x,7).concat(g.slice(0,x))}var gM="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Gp="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),fM="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),pM=co,hM=co,xM=co;function _M(g,x){var b=t(this._weekdays)?this._weekdays:this._weekdays[g&&g!==!0&&this._weekdays.isFormat.test(x)?"format":"standalone"];return g===!0?Am(b,this._week.dow):g?b[g.day()]:b}function CM(g){return g===!0?Am(this._weekdaysShort,this._week.dow):g?this._weekdaysShort[g.day()]:this._weekdaysShort}function vM(g){return g===!0?Am(this._weekdaysMin,this._week.dow):g?this._weekdaysMin[g.day()]:this._weekdaysMin}function bM(g,x,b){var M,A,ne,ve=g.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],M=0;M<7;++M)ne=_([2e3,1]).day(M),this._minWeekdaysParse[M]=this.weekdaysMin(ne,"").toLocaleLowerCase(),this._shortWeekdaysParse[M]=this.weekdaysShort(ne,"").toLocaleLowerCase(),this._weekdaysParse[M]=this.weekdays(ne,"").toLocaleLowerCase();return b?x==="dddd"?(A=nt.call(this._weekdaysParse,ve),A!==-1?A:null):x==="ddd"?(A=nt.call(this._shortWeekdaysParse,ve),A!==-1?A:null):(A=nt.call(this._minWeekdaysParse,ve),A!==-1?A:null):x==="dddd"?(A=nt.call(this._weekdaysParse,ve),A!==-1||(A=nt.call(this._shortWeekdaysParse,ve),A!==-1)?A:(A=nt.call(this._minWeekdaysParse,ve),A!==-1?A:null)):x==="ddd"?(A=nt.call(this._shortWeekdaysParse,ve),A!==-1||(A=nt.call(this._weekdaysParse,ve),A!==-1)?A:(A=nt.call(this._minWeekdaysParse,ve),A!==-1?A:null)):(A=nt.call(this._minWeekdaysParse,ve),A!==-1||(A=nt.call(this._weekdaysParse,ve),A!==-1)?A:(A=nt.call(this._shortWeekdaysParse,ve),A!==-1?A:null))}function yM(g,x,b){var M,A,ne;if(this._weekdaysParseExact)return bM.call(this,g,x,b);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),M=0;M<7;M++){if(A=_([2e3,1]).day(M),b&&!this._fullWeekdaysParse[M]&&(this._fullWeekdaysParse[M]=new RegExp("^"+this.weekdays(A,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[M]=new RegExp("^"+this.weekdaysShort(A,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[M]=new RegExp("^"+this.weekdaysMin(A,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[M]||(ne="^"+this.weekdays(A,"")+"|^"+this.weekdaysShort(A,"")+"|^"+this.weekdaysMin(A,""),this._weekdaysParse[M]=new RegExp(ne.replace(".",""),"i")),b&&x==="dddd"&&this._fullWeekdaysParse[M].test(g))return M;if(b&&x==="ddd"&&this._shortWeekdaysParse[M].test(g))return M;if(b&&x==="dd"&&this._minWeekdaysParse[M].test(g))return M;if(!b&&this._weekdaysParse[M].test(g))return M}}function MM(g){if(!this.isValid())return g!=null?this:NaN;var x=Ne(this,"Day");return g!=null?(g=uM(g,this.localeData()),this.add(g-x,"d")):x}function wM(g){if(!this.isValid())return g!=null?this:NaN;var x=(this.day()+7-this.localeData()._week.dow)%7;return g==null?x:this.add(g-x,"d")}function SM(g){if(!this.isValid())return g!=null?this:NaN;if(g!=null){var x=mM(g,this.localeData());return this.day(this.day()%7?x:x-7)}else return this.day()||7}function PM(g){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Dm.call(this),g?this._weekdaysStrictRegex:this._weekdaysRegex):(a(this,"_weekdaysRegex")||(this._weekdaysRegex=pM),this._weekdaysStrictRegex&&g?this._weekdaysStrictRegex:this._weekdaysRegex)}function OM(g){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Dm.call(this),g?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(a(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=hM),this._weekdaysShortStrictRegex&&g?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function kM(g){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Dm.call(this),g?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(a(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=xM),this._weekdaysMinStrictRegex&&g?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Dm(){function g(ur,Ha){return Ha.length-ur.length}var x=[],b=[],M=[],A=[],ne,ve,et,kt,Zt;for(ne=0;ne<7;ne++)ve=_([2e3,1]).day(ne),et=la(this.weekdaysMin(ve,"")),kt=la(this.weekdaysShort(ve,"")),Zt=la(this.weekdays(ve,"")),x.push(et),b.push(kt),M.push(Zt),A.push(et),A.push(kt),A.push(Zt);x.sort(g),b.sort(g),M.sort(g),A.sort(g),this._weekdaysRegex=new RegExp("^("+A.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+M.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+b.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+x.join("|")+")","i")}function Fm(){return this.hours()%12||12}function EM(){return this.hours()||24}te("H",["HH",2],0,"hour"),te("h",["hh",2],0,Fm),te("k",["kk",2],0,EM),te("hmm",0,0,function(){return""+Fm.apply(this)+$e(this.minutes(),2)}),te("hmmss",0,0,function(){return""+Fm.apply(this)+$e(this.minutes(),2)+$e(this.seconds(),2)}),te("Hmm",0,0,function(){return""+this.hours()+$e(this.minutes(),2)}),te("Hmmss",0,0,function(){return""+this.hours()+$e(this.minutes(),2)+$e(this.seconds(),2)});function Hp(g,x){te(g,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),x)})}Hp("a",!0),Hp("A",!1);function qp(g,x){return x._meridiemParse}Ke("a",qp),Ke("A",qp),Ke("H",It,Jc),Ke("h",It,Ua),Ke("k",It,Ua),Ke("HH",It,Ot),Ke("hh",It,Ot),Ke("kk",It,Ot),Ke("hmm",ui),Ke("hmmss",xt),Ke("Hmm",ui),Ke("Hmmss",xt),un(["H","HH"],L),un(["k","kk"],function(g,x,b){var M=Gt(g);x[L]=M===24?0:M}),un(["a","A"],function(g,x,b){b._isPm=b._locale.isPM(g),b._meridiem=g}),un(["h","hh"],function(g,x,b){x[L]=Gt(g),v(b).bigHour=!0}),un("hmm",function(g,x,b){var M=g.length-2;x[L]=Gt(g.substr(0,M)),x[F]=Gt(g.substr(M)),v(b).bigHour=!0}),un("hmmss",function(g,x,b){var M=g.length-4,A=g.length-2;x[L]=Gt(g.substr(0,M)),x[F]=Gt(g.substr(M,2)),x[B]=Gt(g.substr(A)),v(b).bigHour=!0}),un("Hmm",function(g,x,b){var M=g.length-2;x[L]=Gt(g.substr(0,M)),x[F]=Gt(g.substr(M))}),un("Hmmss",function(g,x,b){var M=g.length-4,A=g.length-2;x[L]=Gt(g.substr(0,M)),x[F]=Gt(g.substr(M,2)),x[B]=Gt(g.substr(A))});function TM(g){return(g+"").toLowerCase().charAt(0)==="p"}var IM=/[ap]\.?m?\.?/i,AM=he("Hours",!0);function DM(g,x,b){return g>11?b?"pm":"PM":b?"am":"AM"}var Xp={calendar:Be,longDateFormat:ke,invalidDate:_e,ordinal:j,dayOfMonthOrdinalParse:st,relativeTime:bt,months:Hi,monthsShort:Yn,week:oM,weekdays:gM,weekdaysMin:fM,weekdaysShort:Gp,meridiemParse:IM},Ln={},rl={},al;function FM(g,x){var b,M=Math.min(g.length,x.length);for(b=0;b<M;b+=1)if(g[b]!==x[b])return b;return M}function Kp(g){return g&&g.toLowerCase().replace("_","-")}function RM(g){for(var x=0,b,M,A,ne;x<g.length;){for(ne=Kp(g[x]).split("-"),b=ne.length,M=Kp(g[x+1]),M=M?M.split("-"):null;b>0;){if(A=p0(ne.slice(0,b).join("-")),A)return A;if(M&&M.length>=b&&FM(ne,M)>=b-1)break;b--}x++}return al}function NM(g){return!!(g&&g.match("^[^/\\\\]*$"))}function p0(g){var x=null,b;if(Ln[g]===void 0&&typeof Mc<"u"&&Mc&&Mc.exports&&NM(g))try{x=al._abbr,b=Mh,b("./locale/"+g),lo(x)}catch{Ln[g]=null}return Ln[g]}function lo(g,x){var b;return g&&(s(x)?b=Wa(g):b=Rm(g,x),b?al=b:typeof console<"u"&&console.warn&&console.warn("Locale "+g+" not found. Did you forget to load it?")),al._abbr}function Rm(g,x){if(x!==null){var b,M=Xp;if(x.abbr=g,Ln[g]!=null)Q("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),M=Ln[g]._config;else if(x.parentLocale!=null)if(Ln[x.parentLocale]!=null)M=Ln[x.parentLocale]._config;else if(b=p0(x.parentLocale),b!=null)M=b._config;else return rl[x.parentLocale]||(rl[x.parentLocale]=[]),rl[x.parentLocale].push({name:g,config:x}),null;return Ln[g]=new Re(Pe(M,x)),rl[g]&&rl[g].forEach(function(A){Rm(A.name,A.config)}),lo(g),Ln[g]}else return delete Ln[g],null}function BM(g,x){if(x!=null){var b,M,A=Xp;Ln[g]!=null&&Ln[g].parentLocale!=null?Ln[g].set(Pe(Ln[g]._config,x)):(M=p0(g),M!=null&&(A=M._config),x=Pe(A,x),M==null&&(x.abbr=g),b=new Re(x),b.parentLocale=Ln[g],Ln[g]=b),lo(g)}else Ln[g]!=null&&(Ln[g].parentLocale!=null?(Ln[g]=Ln[g].parentLocale,g===lo()&&lo(g)):Ln[g]!=null&&delete Ln[g]);return Ln[g]}function Wa(g){var x;if(g&&g._locale&&g._locale._abbr&&(g=g._locale._abbr),!g)return al;if(!t(g)){if(x=p0(g),x)return x;g=[g]}return RM(g)}function LM(){return xe(Ln)}function Nm(g){var x,b=g._a;return b&&v(g).overflow===-2&&(x=b[da]<0||b[da]>11?da:b[E]<1||b[E]>hn(b[Si],b[da])?E:b[L]<0||b[L]>24||b[L]===24&&(b[F]!==0||b[B]!==0||b[V]!==0)?L:b[F]<0||b[F]>59?F:b[B]<0||b[B]>59?B:b[V]<0||b[V]>999?V:-1,v(g)._overflowDayOfYear&&(x<Si||x>E)&&(x=E),v(g)._overflowWeeks&&x===-1&&(x=W),v(g)._overflowWeekday&&x===-1&&(x=me),v(g).overflow=x),g}var VM=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,UM=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,jM=/Z|[+-]\d\d(?::?\d\d)?/,h0=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Bm=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],zM=/^\/?Date\((-?\d+)/i,WM=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,YM={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Zp(g){var x,b,M=g._i,A=VM.exec(M)||UM.exec(M),ne,ve,et,kt,Zt=h0.length,ur=Bm.length;if(A){for(v(g).iso=!0,x=0,b=Zt;x<b;x++)if(h0[x][1].exec(A[1])){ve=h0[x][0],ne=h0[x][2]!==!1;break}if(ve==null){g._isValid=!1;return}if(A[3]){for(x=0,b=ur;x<b;x++)if(Bm[x][1].exec(A[3])){et=(A[2]||" ")+Bm[x][0];break}if(et==null){g._isValid=!1;return}}if(!ne&&et!=null){g._isValid=!1;return}if(A[4])if(jM.exec(A[4]))kt="Z";else{g._isValid=!1;return}g._f=ve+(et||"")+(kt||""),Vm(g)}else g._isValid=!1}function $M(g,x,b,M,A,ne){var ve=[GM(g),Yn.indexOf(x),parseInt(b,10),parseInt(M,10),parseInt(A,10)];return ne&&ve.push(parseInt(ne,10)),ve}function GM(g){var x=parseInt(g,10);return x<=49?2e3+x:x<=999?1900+x:x}function HM(g){return g.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function qM(g,x,b){if(g){var M=Gp.indexOf(g),A=new Date(x[0],x[1],x[2]).getDay();if(M!==A)return v(b).weekdayMismatch=!0,b._isValid=!1,!1}return!0}function XM(g,x,b){if(g)return YM[g];if(x)return 0;var M=parseInt(b,10),A=M%100,ne=(M-A)/100;return ne*60+A}function Jp(g){var x=WM.exec(HM(g._i)),b;if(x){if(b=$M(x[4],x[3],x[2],x[5],x[6],x[7]),!qM(x[1],b,g))return;g._a=b,g._tzm=XM(x[8],x[9],x[10]),g._d=nl.apply(null,g._a),g._d.setUTCMinutes(g._d.getUTCMinutes()-g._tzm),v(g).rfc2822=!0}else g._isValid=!1}function KM(g){var x=zM.exec(g._i);if(x!==null){g._d=new Date(+x[1]);return}if(Zp(g),g._isValid===!1)delete g._isValid;else return;if(Jp(g),g._isValid===!1)delete g._isValid;else return;g._strict?g._isValid=!1:n.createFromInputFallback(g)}n.createFromInputFallback=R("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(g){g._d=new Date(g._i+(g._useUTC?" UTC":""))});function Fs(g,x,b){return g!=null?g:x!=null?x:b}function ZM(g){var x=new Date(n.now());return g._useUTC?[x.getUTCFullYear(),x.getUTCMonth(),x.getUTCDate()]:[x.getFullYear(),x.getMonth(),x.getDate()]}function Lm(g){var x,b,M=[],A,ne,ve;if(!g._d){for(A=ZM(g),g._w&&g._a[E]==null&&g._a[da]==null&&JM(g),g._dayOfYear!=null&&(ve=Fs(g._a[Si],A[Si]),(g._dayOfYear>Ce(ve)||g._dayOfYear===0)&&(v(g)._overflowDayOfYear=!0),b=nl(ve,0,g._dayOfYear),g._a[da]=b.getUTCMonth(),g._a[E]=b.getUTCDate()),x=0;x<3&&g._a[x]==null;++x)g._a[x]=M[x]=A[x];for(;x<7;x++)g._a[x]=M[x]=g._a[x]==null?x===2?1:0:g._a[x];g._a[L]===24&&g._a[F]===0&&g._a[B]===0&&g._a[V]===0&&(g._nextDay=!0,g._a[L]=0),g._d=(g._useUTC?nl:rM).apply(null,M),ne=g._useUTC?g._d.getUTCDay():g._d.getDay(),g._tzm!=null&&g._d.setUTCMinutes(g._d.getUTCMinutes()-g._tzm),g._nextDay&&(g._a[L]=24),g._w&&typeof g._w.d<"u"&&g._w.d!==ne&&(v(g).weekdayMismatch=!0)}}function JM(g){var x,b,M,A,ne,ve,et,kt,Zt;x=g._w,x.GG!=null||x.W!=null||x.E!=null?(ne=1,ve=4,b=Fs(x.GG,g._a[Si],il(Pn(),1,4).year),M=Fs(x.W,1),A=Fs(x.E,1),(A<1||A>7)&&(kt=!0)):(ne=g._locale._week.dow,ve=g._locale._week.doy,Zt=il(Pn(),ne,ve),b=Fs(x.gg,g._a[Si],Zt.year),M=Fs(x.w,Zt.week),x.d!=null?(A=x.d,(A<0||A>6)&&(kt=!0)):x.e!=null?(A=x.e+ne,(x.e<0||x.e>6)&&(kt=!0)):A=ne),M<1||M>za(b,ne,ve)?v(g)._overflowWeeks=!0:kt!=null?v(g)._overflowWeekday=!0:(et=$p(b,M,A,ne,ve),g._a[Si]=et.year,g._dayOfYear=et.dayOfYear)}n.ISO_8601=function(){},n.RFC_2822=function(){};function Vm(g){if(g._f===n.ISO_8601){Zp(g);return}if(g._f===n.RFC_2822){Jp(g);return}g._a=[],v(g).empty=!0;var x=""+g._i,b,M,A,ne,ve,et=x.length,kt=0,Zt,ur;for(A=Oe(g._f,g._locale).match(Se)||[],ur=A.length,b=0;b<ur;b++)ne=A[b],M=(x.match(Tm(ne,g))||[])[0],M&&(ve=x.substr(0,x.indexOf(M)),ve.length>0&&v(g).unusedInput.push(ve),x=x.slice(x.indexOf(M)+M.length),kt+=M.length),Y[ne]?(M?v(g).empty=!1:v(g).unusedTokens.push(ne),el(ne,M,g)):g._strict&&!M&&v(g).unusedTokens.push(ne);v(g).charsLeftOver=et-kt,x.length>0&&v(g).unusedInput.push(x),g._a[L]<=12&&v(g).bigHour===!0&&g._a[L]>0&&(v(g).bigHour=void 0),v(g).parsedDateParts=g._a.slice(0),v(g).meridiem=g._meridiem,g._a[L]=QM(g._locale,g._a[L],g._meridiem),Zt=v(g).era,Zt!==null&&(g._a[Si]=g._locale.erasConvertYear(Zt,g._a[Si])),Lm(g),Nm(g)}function QM(g,x,b){var M;return b==null?x:g.meridiemHour!=null?g.meridiemHour(x,b):(g.isPM!=null&&(M=g.isPM(b),M&&x<12&&(x+=12),!M&&x===12&&(x=0)),x)}function ew(g){var x,b,M,A,ne,ve,et=!1,kt=g._f.length;if(kt===0){v(g).invalidFormat=!0,g._d=new Date(NaN);return}for(A=0;A<kt;A++)ne=0,ve=!1,x=K({},g),g._useUTC!=null&&(x._useUTC=g._useUTC),x._f=g._f[A],Vm(x),P(x)&&(ve=!0),ne+=v(x).charsLeftOver,ne+=v(x).unusedTokens.length*10,v(x).score=ne,et?ne<M&&(M=ne,b=x):(M==null||ne<M||ve)&&(M=ne,b=x,ve&&(et=!0));h(g,b||x)}function tw(g){if(!g._d){var x=Sn(g._i),b=x.day===void 0?x.date:x.day;g._a=f([x.year,x.month,b,x.hour,x.minute,x.second,x.millisecond],function(M){return M&&parseInt(M,10)}),Lm(g)}}function nw(g){var x=new ee(Nm(Qp(g)));return x._nextDay&&(x.add(1,"d"),x._nextDay=void 0),x}function Qp(g){var x=g._i,b=g._f;return g._locale=g._locale||Wa(g._l),x===null||b===void 0&&x===""?D({nullInput:!0}):(typeof x=="string"&&(g._i=x=g._locale.preparse(x)),k(x)?new ee(Nm(x)):(m(x)?g._d=x:t(b)?ew(g):b?Vm(g):iw(g),P(g)||(g._d=null),g))}function iw(g){var x=g._i;s(x)?g._d=new Date(n.now()):m(x)?g._d=new Date(x.valueOf()):typeof x=="string"?KM(g):t(x)?(g._a=f(x.slice(0),function(b){return parseInt(b,10)}),Lm(g)):r(x)?tw(g):u(x)?g._d=new Date(x):n.createFromInputFallback(g)}function eh(g,x,b,M,A){var ne={};return(x===!0||x===!1)&&(M=x,x=void 0),(b===!0||b===!1)&&(M=b,b=void 0),(r(g)&&o(g)||t(g)&&g.length===0)&&(g=void 0),ne._isAMomentObject=!0,ne._useUTC=ne._isUTC=A,ne._l=b,ne._i=g,ne._f=x,ne._strict=M,nw(ne)}function Pn(g,x,b,M){return eh(g,x,b,M,!1)}var rw=R("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var g=Pn.apply(null,arguments);return this.isValid()&&g.isValid()?g<this?this:g:D()}),aw=R("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var g=Pn.apply(null,arguments);return this.isValid()&&g.isValid()?g>this?this:g:D()});function th(g,x){var b,M;if(x.length===1&&t(x[0])&&(x=x[0]),!x.length)return Pn();for(b=x[0],M=1;M<x.length;++M)(!x[M].isValid()||x[M][g](b))&&(b=x[M]);return b}function ow(){var g=[].slice.call(arguments,0);return th("isBefore",g)}function sw(){var g=[].slice.call(arguments,0);return th("isAfter",g)}var cw=function(){return Date.now?Date.now():+new Date},ol=["year","quarter","month","week","day","hour","minute","second","millisecond"];function lw(g){var x,b=!1,M,A=ol.length;for(x in g)if(a(g,x)&&!(nt.call(ol,x)!==-1&&(g[x]==null||!isNaN(g[x]))))return!1;for(M=0;M<A;++M)if(g[ol[M]]){if(b)return!1;parseFloat(g[ol[M]])!==Gt(g[ol[M]])&&(b=!0)}return!0}function dw(){return this._isValid}function uw(){return ma(NaN)}function x0(g){var x=Sn(g),b=x.year||0,M=x.quarter||0,A=x.month||0,ne=x.week||x.isoWeek||0,ve=x.day||0,et=x.hour||0,kt=x.minute||0,Zt=x.second||0,ur=x.millisecond||0;this._isValid=lw(x),this._milliseconds=+ur+Zt*1e3+kt*6e4+et*1e3*60*60,this._days=+ve+ne*7,this._months=+A+M*3+b*12,this._data={},this._locale=Wa(),this._bubble()}function _0(g){return g instanceof x0}function Um(g){return g<0?Math.round(-1*g)*-1:Math.round(g)}function mw(g,x,b){var M=Math.min(g.length,x.length),A=Math.abs(g.length-x.length),ne=0,ve;for(ve=0;ve<M;ve++)(b&&g[ve]!==x[ve]||!b&&Gt(g[ve])!==Gt(x[ve]))&&ne++;return ne+A}function nh(g,x){te(g,0,0,function(){var b=this.utcOffset(),M="+";return b<0&&(b=-b,M="-"),M+$e(~~(b/60),2)+x+$e(~~b%60,2)})}nh("Z",":"),nh("ZZ",""),Ke("Z",Is),Ke("ZZ",Is),un(["Z","ZZ"],function(g,x,b){b._useUTC=!0,b._tzm=jm(Is,g)});var gw=/([\+\-]|\d\d)/gi;function jm(g,x){var b=(x||"").match(g),M,A,ne;return b===null?null:(M=b[b.length-1]||[],A=(M+"").match(gw)||["-",0,0],ne=+(A[1]*60)+Gt(A[2]),ne===0?0:A[0]==="+"?ne:-ne)}function zm(g,x){var b,M;return x._isUTC?(b=x.clone(),M=(k(g)||m(g)?g.valueOf():Pn(g).valueOf())-b.valueOf(),b._d.setTime(b._d.valueOf()+M),n.updateOffset(b,!1),b):Pn(g).local()}function Wm(g){return-Math.round(g._d.getTimezoneOffset())}n.updateOffset=function(){};function fw(g,x,b){var M=this._offset||0,A;if(!this.isValid())return g!=null?this:NaN;if(g!=null){if(typeof g=="string"){if(g=jm(Is,g),g===null)return this}else Math.abs(g)<16&&!b&&(g=g*60);return!this._isUTC&&x&&(A=Wm(this)),this._offset=g,this._isUTC=!0,A!=null&&this.add(A,"m"),M!==g&&(!x||this._changeInProgress?oh(this,ma(g-M,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?M:Wm(this)}function pw(g,x){return g!=null?(typeof g!="string"&&(g=-g),this.utcOffset(g,x),this):-this.utcOffset()}function hw(g){return this.utcOffset(0,g)}function xw(g){return this._isUTC&&(this.utcOffset(0,g),this._isUTC=!1,g&&this.subtract(Wm(this),"m")),this}function _w(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var g=jm(Em,this._i);g!=null?this.utcOffset(g):this.utcOffset(0,!0)}return this}function Cw(g){return this.isValid()?(g=g?Pn(g).utcOffset():0,(this.utcOffset()-g)%60===0):!1}function vw(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function bw(){if(!s(this._isDSTShifted))return this._isDSTShifted;var g={},x;return K(g,this),g=Qp(g),g._a?(x=g._isUTC?_(g._a):Pn(g._a),this._isDSTShifted=this.isValid()&&mw(g._a,x.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function yw(){return this.isValid()?!this._isUTC:!1}function Mw(){return this.isValid()?this._isUTC:!1}function ih(){return this.isValid()?this._isUTC&&this._offset===0:!1}var ww=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Sw=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ma(g,x){var b=g,M=null,A,ne,ve;return _0(g)?b={ms:g._milliseconds,d:g._days,M:g._months}:u(g)||!isNaN(+g)?(b={},x?b[x]=+g:b.milliseconds=+g):(M=ww.exec(g))?(A=M[1]==="-"?-1:1,b={y:0,d:Gt(M[E])*A,h:Gt(M[L])*A,m:Gt(M[F])*A,s:Gt(M[B])*A,ms:Gt(Um(M[V]*1e3))*A}):(M=Sw.exec(g))?(A=M[1]==="-"?-1:1,b={y:Jo(M[2],A),M:Jo(M[3],A),w:Jo(M[4],A),d:Jo(M[5],A),h:Jo(M[6],A),m:Jo(M[7],A),s:Jo(M[8],A)}):b==null?b={}:typeof b=="object"&&("from"in b||"to"in b)&&(ve=Pw(Pn(b.from),Pn(b.to)),b={},b.ms=ve.milliseconds,b.M=ve.months),ne=new x0(b),_0(g)&&a(g,"_locale")&&(ne._locale=g._locale),_0(g)&&a(g,"_isValid")&&(ne._isValid=g._isValid),ne}ma.fn=x0.prototype,ma.invalid=uw;function Jo(g,x){var b=g&&parseFloat(g.replace(",","."));return(isNaN(b)?0:b)*x}function rh(g,x){var b={};return b.months=x.month()-g.month()+(x.year()-g.year())*12,g.clone().add(b.months,"M").isAfter(x)&&--b.months,b.milliseconds=+x-+g.clone().add(b.months,"M"),b}function Pw(g,x){var b;return g.isValid()&&x.isValid()?(x=zm(x,g),g.isBefore(x)?b=rh(g,x):(b=rh(x,g),b.milliseconds=-b.milliseconds,b.months=-b.months),b):{milliseconds:0,months:0}}function ah(g,x){return function(b,M){var A,ne;return M!==null&&!isNaN(+M)&&(Q(x,"moment()."+x+"(period, number) is deprecated. Please use moment()."+x+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),ne=b,b=M,M=ne),A=ma(b,M),oh(this,A,g),this}}function oh(g,x,b,M){var A=x._milliseconds,ne=Um(x._days),ve=Um(x._months);g.isValid()&&(M=M==null?!0:M,ve&&zp(g,Ne(g,"Month")+ve*b),ne&&Ue(g,"Date",Ne(g,"Date")+ne*b),A&&g._d.setTime(g._d.valueOf()+A*b),M&&n.updateOffset(g,ne||ve))}var Ow=ah(1,"add"),kw=ah(-1,"subtract");function sh(g){return typeof g=="string"||g instanceof String}function Ew(g){return k(g)||m(g)||sh(g)||u(g)||Iw(g)||Tw(g)||g===null||g===void 0}function Tw(g){var x=r(g)&&!o(g),b=!1,M=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],A,ne,ve=M.length;for(A=0;A<ve;A+=1)ne=M[A],b=b||a(g,ne);return x&&b}function Iw(g){var x=t(g),b=!1;return x&&(b=g.filter(function(M){return!u(M)&&sh(g)}).length===0),x&&b}function Aw(g){var x=r(g)&&!o(g),b=!1,M=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],A,ne;for(A=0;A<M.length;A+=1)ne=M[A],b=b||a(g,ne);return x&&b}function Dw(g,x){var b=g.diff(x,"days",!0);return b<-6?"sameElse":b<-1?"lastWeek":b<0?"lastDay":b<1?"sameDay":b<2?"nextDay":b<7?"nextWeek":"sameElse"}function Fw(g,x){arguments.length===1&&(arguments[0]?Ew(arguments[0])?(g=arguments[0],x=void 0):Aw(arguments[0])&&(x=arguments[0],g=void 0):(g=void 0,x=void 0));var b=g||Pn(),M=zm(b,this).startOf("day"),A=n.calendarFormat(this,M)||"sameElse",ne=x&&(re(x[A])?x[A].call(this,b):x[A]);return this.format(ne||this.localeData().calendar(A,this,Pn(b)))}function Rw(){return new ee(this)}function Nw(g,x){var b=k(g)?g:Pn(g);return this.isValid()&&b.isValid()?(x=an(x)||"millisecond",x==="millisecond"?this.valueOf()>b.valueOf():b.valueOf()<this.clone().startOf(x).valueOf()):!1}function Bw(g,x){var b=k(g)?g:Pn(g);return this.isValid()&&b.isValid()?(x=an(x)||"millisecond",x==="millisecond"?this.valueOf()<b.valueOf():this.clone().endOf(x).valueOf()<b.valueOf()):!1}function Lw(g,x,b,M){var A=k(g)?g:Pn(g),ne=k(x)?x:Pn(x);return this.isValid()&&A.isValid()&&ne.isValid()?(M=M||"()",(M[0]==="("?this.isAfter(A,b):!this.isBefore(A,b))&&(M[1]===")"?this.isBefore(ne,b):!this.isAfter(ne,b))):!1}function Vw(g,x){var b=k(g)?g:Pn(g),M;return this.isValid()&&b.isValid()?(x=an(x)||"millisecond",x==="millisecond"?this.valueOf()===b.valueOf():(M=b.valueOf(),this.clone().startOf(x).valueOf()<=M&&M<=this.clone().endOf(x).valueOf())):!1}function Uw(g,x){return this.isSame(g,x)||this.isAfter(g,x)}function jw(g,x){return this.isSame(g,x)||this.isBefore(g,x)}function zw(g,x,b){var M,A,ne;if(!this.isValid())return NaN;if(M=zm(g,this),!M.isValid())return NaN;switch(A=(M.utcOffset()-this.utcOffset())*6e4,x=an(x),x){case"year":ne=C0(this,M)/12;break;case"month":ne=C0(this,M);break;case"quarter":ne=C0(this,M)/3;break;case"second":ne=(this-M)/1e3;break;case"minute":ne=(this-M)/6e4;break;case"hour":ne=(this-M)/36e5;break;case"day":ne=(this-M-A)/864e5;break;case"week":ne=(this-M-A)/6048e5;break;default:ne=this-M}return b?ne:xr(ne)}function C0(g,x){if(g.date()<x.date())return-C0(x,g);var b=(x.year()-g.year())*12+(x.month()-g.month()),M=g.clone().add(b,"months"),A,ne;return x-M<0?(A=g.clone().add(b-1,"months"),ne=(x-M)/(M-A)):(A=g.clone().add(b+1,"months"),ne=(x-M)/(A-M)),-(b+ne)||0}n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Ww(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Yw(g){if(!this.isValid())return null;var x=g!==!0,b=x?this.clone().utc():this;return b.year()<0||b.year()>9999?de(b,x?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):re(Date.prototype.toISOString)?x?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",de(b,"Z")):de(b,x?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function $w(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var g="moment",x="",b,M,A,ne;return this.isLocal()||(g=this.utcOffset()===0?"moment.utc":"moment.parseZone",x="Z"),b="["+g+'("]',M=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",A="-MM-DD[T]HH:mm:ss.SSS",ne=x+'[")]',this.format(b+M+A+ne)}function Gw(g){g||(g=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var x=de(this,g);return this.localeData().postformat(x)}function Hw(g,x){return this.isValid()&&(k(g)&&g.isValid()||Pn(g).isValid())?ma({to:this,from:g}).locale(this.locale()).humanize(!x):this.localeData().invalidDate()}function qw(g){return this.from(Pn(),g)}function Xw(g,x){return this.isValid()&&(k(g)&&g.isValid()||Pn(g).isValid())?ma({from:this,to:g}).locale(this.locale()).humanize(!x):this.localeData().invalidDate()}function Kw(g){return this.to(Pn(),g)}function ch(g){var x;return g===void 0?this._locale._abbr:(x=Wa(g),x!=null&&(this._locale=x),this)}var lh=R("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(g){return g===void 0?this.localeData():this.locale(g)});function dh(){return this._locale}var v0=1e3,Rs=60*v0,b0=60*Rs,uh=(365*400+97)*24*b0;function Ns(g,x){return(g%x+x)%x}function mh(g,x,b){return g<100&&g>=0?new Date(g+400,x,b)-uh:new Date(g,x,b).valueOf()}function gh(g,x,b){return g<100&&g>=0?Date.UTC(g+400,x,b)-uh:Date.UTC(g,x,b)}function Zw(g){var x,b;if(g=an(g),g===void 0||g==="millisecond"||!this.isValid())return this;switch(b=this._isUTC?gh:mh,g){case"year":x=b(this.year(),0,1);break;case"quarter":x=b(this.year(),this.month()-this.month()%3,1);break;case"month":x=b(this.year(),this.month(),1);break;case"week":x=b(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":x=b(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":x=b(this.year(),this.month(),this.date());break;case"hour":x=this._d.valueOf(),x-=Ns(x+(this._isUTC?0:this.utcOffset()*Rs),b0);break;case"minute":x=this._d.valueOf(),x-=Ns(x,Rs);break;case"second":x=this._d.valueOf(),x-=Ns(x,v0);break}return this._d.setTime(x),n.updateOffset(this,!0),this}function Jw(g){var x,b;if(g=an(g),g===void 0||g==="millisecond"||!this.isValid())return this;switch(b=this._isUTC?gh:mh,g){case"year":x=b(this.year()+1,0,1)-1;break;case"quarter":x=b(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":x=b(this.year(),this.month()+1,1)-1;break;case"week":x=b(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":x=b(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":x=b(this.year(),this.month(),this.date()+1)-1;break;case"hour":x=this._d.valueOf(),x+=b0-Ns(x+(this._isUTC?0:this.utcOffset()*Rs),b0)-1;break;case"minute":x=this._d.valueOf(),x+=Rs-Ns(x,Rs)-1;break;case"second":x=this._d.valueOf(),x+=v0-Ns(x,v0)-1;break}return this._d.setTime(x),n.updateOffset(this,!0),this}function Qw(){return this._d.valueOf()-(this._offset||0)*6e4}function eS(){return Math.floor(this.valueOf()/1e3)}function tS(){return new Date(this.valueOf())}function nS(){var g=this;return[g.year(),g.month(),g.date(),g.hour(),g.minute(),g.second(),g.millisecond()]}function iS(){var g=this;return{years:g.year(),months:g.month(),date:g.date(),hours:g.hours(),minutes:g.minutes(),seconds:g.seconds(),milliseconds:g.milliseconds()}}function rS(){return this.isValid()?this.toISOString():null}function aS(){return P(this)}function oS(){return h({},v(this))}function sS(){return v(this).overflow}function cS(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}te("N",0,0,"eraAbbr"),te("NN",0,0,"eraAbbr"),te("NNN",0,0,"eraAbbr"),te("NNNN",0,0,"eraName"),te("NNNNN",0,0,"eraNarrow"),te("y",["y",1],"yo","eraYear"),te("y",["yy",2],0,"eraYear"),te("y",["yyy",3],0,"eraYear"),te("y",["yyyy",4],0,"eraYear"),Ke("N",Ym),Ke("NN",Ym),Ke("NNN",Ym),Ke("NNNN",CS),Ke("NNNNN",vS),un(["N","NN","NNN","NNNN","NNNNN"],function(g,x,b,M){var A=b._locale.erasParse(g,M,b._strict);A?v(b).era=A:v(b).invalidEra=g}),Ke("y",hr),Ke("yy",hr),Ke("yyy",hr),Ke("yyyy",hr),Ke("yo",bS),un(["y","yy","yyy","yyyy"],Si),un(["yo"],function(g,x,b,M){var A;b._locale._eraYearOrdinalRegex&&(A=g.match(b._locale._eraYearOrdinalRegex)),b._locale.eraYearOrdinalParse?x[Si]=b._locale.eraYearOrdinalParse(g,A):x[Si]=parseInt(g,10)});function lS(g,x){var b,M,A,ne=this._eras||Wa("en")._eras;for(b=0,M=ne.length;b<M;++b){switch(typeof ne[b].since){case"string":A=n(ne[b].since).startOf("day"),ne[b].since=A.valueOf();break}switch(typeof ne[b].until){case"undefined":ne[b].until=1/0;break;case"string":A=n(ne[b].until).startOf("day").valueOf(),ne[b].until=A.valueOf();break}}return ne}function dS(g,x,b){var M,A,ne=this.eras(),ve,et,kt;for(g=g.toUpperCase(),M=0,A=ne.length;M<A;++M)if(ve=ne[M].name.toUpperCase(),et=ne[M].abbr.toUpperCase(),kt=ne[M].narrow.toUpperCase(),b)switch(x){case"N":case"NN":case"NNN":if(et===g)return ne[M];break;case"NNNN":if(ve===g)return ne[M];break;case"NNNNN":if(kt===g)return ne[M];break}else if([ve,et,kt].indexOf(g)>=0)return ne[M]}function uS(g,x){var b=g.since<=g.until?1:-1;return x===void 0?n(g.since).year():n(g.since).year()+(x-g.offset)*b}function mS(){var g,x,b,M=this.localeData().eras();for(g=0,x=M.length;g<x;++g)if(b=this.clone().startOf("day").valueOf(),M[g].since<=b&&b<=M[g].until||M[g].until<=b&&b<=M[g].since)return M[g].name;return""}function gS(){var g,x,b,M=this.localeData().eras();for(g=0,x=M.length;g<x;++g)if(b=this.clone().startOf("day").valueOf(),M[g].since<=b&&b<=M[g].until||M[g].until<=b&&b<=M[g].since)return M[g].narrow;return""}function fS(){var g,x,b,M=this.localeData().eras();for(g=0,x=M.length;g<x;++g)if(b=this.clone().startOf("day").valueOf(),M[g].since<=b&&b<=M[g].until||M[g].until<=b&&b<=M[g].since)return M[g].abbr;return""}function pS(){var g,x,b,M,A=this.localeData().eras();for(g=0,x=A.length;g<x;++g)if(b=A[g].since<=A[g].until?1:-1,M=this.clone().startOf("day").valueOf(),A[g].since<=M&&M<=A[g].until||A[g].until<=M&&M<=A[g].since)return(this.year()-n(A[g].since).year())*b+A[g].offset;return this.year()}function hS(g){return a(this,"_erasNameRegex")||$m.call(this),g?this._erasNameRegex:this._erasRegex}function xS(g){return a(this,"_erasAbbrRegex")||$m.call(this),g?this._erasAbbrRegex:this._erasRegex}function _S(g){return a(this,"_erasNarrowRegex")||$m.call(this),g?this._erasNarrowRegex:this._erasRegex}function Ym(g,x){return x.erasAbbrRegex(g)}function CS(g,x){return x.erasNameRegex(g)}function vS(g,x){return x.erasNarrowRegex(g)}function bS(g,x){return x._eraYearOrdinalRegex||hr}function $m(){var g=[],x=[],b=[],M=[],A,ne,ve,et,kt,Zt=this.eras();for(A=0,ne=Zt.length;A<ne;++A)ve=la(Zt[A].name),et=la(Zt[A].abbr),kt=la(Zt[A].narrow),x.push(ve),g.push(et),b.push(kt),M.push(ve),M.push(et),M.push(kt);this._erasRegex=new RegExp("^("+M.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+x.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+g.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+b.join("|")+")","i")}te(0,["gg",2],0,function(){return this.weekYear()%100}),te(0,["GG",2],0,function(){return this.isoWeekYear()%100});function y0(g,x){te(0,[g,g.length],0,x)}y0("gggg","weekYear"),y0("ggggg","weekYear"),y0("GGGG","isoWeekYear"),y0("GGGGG","isoWeekYear"),Ke("G",qo),Ke("g",qo),Ke("GG",It,Ot),Ke("gg",It,Ot),Ke("GGGG",bi,Kn),Ke("gggg",bi,Kn),Ke("GGGGG",Bn,pr),Ke("ggggg",Bn,pr),Xo(["gggg","ggggg","GGGG","GGGGG"],function(g,x,b,M){x[M.substr(0,2)]=Gt(g)}),Xo(["gg","GG"],function(g,x,b,M){x[M]=n.parseTwoDigitYear(g)});function yS(g){return fh.call(this,g,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function MS(g){return fh.call(this,g,this.isoWeek(),this.isoWeekday(),1,4)}function wS(){return za(this.year(),1,4)}function SS(){return za(this.isoWeekYear(),1,4)}function PS(){var g=this.localeData()._week;return za(this.year(),g.dow,g.doy)}function OS(){var g=this.localeData()._week;return za(this.weekYear(),g.dow,g.doy)}function fh(g,x,b,M,A){var ne;return g==null?il(this,M,A).year:(ne=za(g,M,A),x>ne&&(x=ne),kS.call(this,g,x,b,M,A))}function kS(g,x,b,M,A){var ne=$p(g,x,b,M,A),ve=nl(ne.year,0,ne.dayOfYear);return this.year(ve.getUTCFullYear()),this.month(ve.getUTCMonth()),this.date(ve.getUTCDate()),this}te("Q",0,"Qo","quarter"),Ke("Q",Xn),un("Q",function(g,x){x[da]=(Gt(g)-1)*3});function ES(g){return g==null?Math.ceil((this.month()+1)/3):this.month((g-1)*3+this.month()%3)}te("D",["DD",2],"Do","date"),Ke("D",It,Ua),Ke("DD",It,Ot),Ke("Do",function(g,x){return g?x._dayOfMonthOrdinalParse||x._ordinalParse:x._dayOfMonthOrdinalParseLenient}),un(["D","DD"],E),un("Do",function(g,x){x[E]=Gt(g.match(It)[0])});var ph=he("Date",!0);te("DDD",["DDDD",3],"DDDo","dayOfYear"),Ke("DDD",on),Ke("DDDD",Mn),un(["DDD","DDDD"],function(g,x,b){b._dayOfYear=Gt(g)});function TS(g){var x=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return g==null?x:this.add(g-x,"d")}te("m",["mm",2],0,"minute"),Ke("m",It,Jc),Ke("mm",It,Ot),un(["m","mm"],F);var IS=he("Minutes",!1);te("s",["ss",2],0,"second"),Ke("s",It,Jc),Ke("ss",It,Ot),un(["s","ss"],B);var AS=he("Seconds",!1);te("S",0,0,function(){return~~(this.millisecond()/100)}),te(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),te(0,["SSS",3],0,"millisecond"),te(0,["SSSS",4],0,function(){return this.millisecond()*10}),te(0,["SSSSS",5],0,function(){return this.millisecond()*100}),te(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),te(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),te(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),te(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),Ke("S",on,Xn),Ke("SS",on,Ot),Ke("SSS",on,Mn);var uo,hh;for(uo="SSSS";uo.length<=9;uo+="S")Ke(uo,hr);function DS(g,x){x[V]=Gt(("0."+g)*1e3)}for(uo="S";uo.length<=9;uo+="S")un(uo,DS);hh=he("Milliseconds",!1),te("z",0,0,"zoneAbbr"),te("zz",0,0,"zoneName");function FS(){return this._isUTC?"UTC":""}function RS(){return this._isUTC?"Coordinated Universal Time":""}var Le=ee.prototype;Le.add=Ow,Le.calendar=Fw,Le.clone=Rw,Le.diff=zw,Le.endOf=Jw,Le.format=Gw,Le.from=Hw,Le.fromNow=qw,Le.to=Xw,Le.toNow=Kw,Le.get=tt,Le.invalidAt=sS,Le.isAfter=Nw,Le.isBefore=Bw,Le.isBetween=Lw,Le.isSame=Vw,Le.isSameOrAfter=Uw,Le.isSameOrBefore=jw,Le.isValid=aS,Le.lang=lh,Le.locale=ch,Le.localeData=dh,Le.max=aw,Le.min=rw,Le.parsingFlags=oS,Le.set=je,Le.startOf=Zw,Le.subtract=kw,Le.toArray=nS,Le.toObject=iS,Le.toDate=tS,Le.toISOString=Yw,Le.inspect=$w,typeof Symbol<"u"&&Symbol.for!=null&&(Le[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Le.toJSON=rS,Le.toString=Ww,Le.unix=eS,Le.valueOf=Qw,Le.creationData=cS,Le.eraName=mS,Le.eraNarrow=gS,Le.eraAbbr=fS,Le.eraYear=pS,Le.year=ge,Le.isLeapYear=fe,Le.weekYear=yS,Le.isoWeekYear=MS,Le.quarter=Le.quarters=ES,Le.month=Wp,Le.daysInMonth=tM,Le.week=Le.weeks=lM,Le.isoWeek=Le.isoWeeks=dM,Le.weeksInYear=PS,Le.weeksInWeekYear=OS,Le.isoWeeksInYear=wS,Le.isoWeeksInISOWeekYear=SS,Le.date=ph,Le.day=Le.days=MM,Le.weekday=wM,Le.isoWeekday=SM,Le.dayOfYear=TS,Le.hour=Le.hours=AM,Le.minute=Le.minutes=IS,Le.second=Le.seconds=AS,Le.millisecond=Le.milliseconds=hh,Le.utcOffset=fw,Le.utc=hw,Le.local=xw,Le.parseZone=_w,Le.hasAlignedHourOffset=Cw,Le.isDST=vw,Le.isLocal=yw,Le.isUtcOffset=Mw,Le.isUtc=ih,Le.isUTC=ih,Le.zoneAbbr=FS,Le.zoneName=RS,Le.dates=R("dates accessor is deprecated. Use date instead.",ph),Le.months=R("months accessor is deprecated. Use month instead",Wp),Le.years=R("years accessor is deprecated. Use year instead",ge),Le.zone=R("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",pw),Le.isDSTShifted=R("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",bw);function NS(g){return Pn(g*1e3)}function BS(){return Pn.apply(null,arguments).parseZone()}function xh(g){return g}var sn=Re.prototype;sn.calendar=we,sn.longDateFormat=Me,sn.invalidDate=it,sn.ordinal=qe,sn.preparse=xh,sn.postformat=xh,sn.relativeTime=Ze,sn.pastFuture=Fe,sn.set=ie,sn.eras=lS,sn.erasParse=dS,sn.erasConvertYear=uS,sn.erasAbbrRegex=xS,sn.erasNameRegex=hS,sn.erasNarrowRegex=_S,sn.months=ja,sn.monthsShort=tl,sn.monthsParse=eM,sn.monthsRegex=iM,sn.monthsShortRegex=nM,sn.week=aM,sn.firstDayOfYear=cM,sn.firstDayOfWeek=sM,sn.weekdays=_M,sn.weekdaysMin=vM,sn.weekdaysShort=CM,sn.weekdaysParse=yM,sn.weekdaysRegex=PM,sn.weekdaysShortRegex=OM,sn.weekdaysMinRegex=kM,sn.isPM=TM,sn.meridiem=DM;function M0(g,x,b,M){var A=Wa(),ne=_().set(M,x);return A[b](ne,g)}function _h(g,x,b){if(u(g)&&(x=g,g=void 0),g=g||"",x!=null)return M0(g,x,b,"month");var M,A=[];for(M=0;M<12;M++)A[M]=M0(g,M,b,"month");return A}function Gm(g,x,b,M){typeof g=="boolean"?(u(x)&&(b=x,x=void 0),x=x||""):(x=g,b=x,g=!1,u(x)&&(b=x,x=void 0),x=x||"");var A=Wa(),ne=g?A._week.dow:0,ve,et=[];if(b!=null)return M0(x,(b+ne)%7,M,"day");for(ve=0;ve<7;ve++)et[ve]=M0(x,(ve+ne)%7,M,"day");return et}function LS(g,x){return _h(g,x,"months")}function VS(g,x){return _h(g,x,"monthsShort")}function US(g,x,b){return Gm(g,x,b,"weekdays")}function jS(g,x,b){return Gm(g,x,b,"weekdaysShort")}function zS(g,x,b){return Gm(g,x,b,"weekdaysMin")}lo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(g){var x=g%10,b=Gt(g%100/10)===1?"th":x===1?"st":x===2?"nd":x===3?"rd":"th";return g+b}}),n.lang=R("moment.lang is deprecated. Use moment.locale instead.",lo),n.langData=R("moment.langData is deprecated. Use moment.localeData instead.",Wa);var Ya=Math.abs;function WS(){var g=this._data;return this._milliseconds=Ya(this._milliseconds),this._days=Ya(this._days),this._months=Ya(this._months),g.milliseconds=Ya(g.milliseconds),g.seconds=Ya(g.seconds),g.minutes=Ya(g.minutes),g.hours=Ya(g.hours),g.months=Ya(g.months),g.years=Ya(g.years),this}function Ch(g,x,b,M){var A=ma(x,b);return g._milliseconds+=M*A._milliseconds,g._days+=M*A._days,g._months+=M*A._months,g._bubble()}function YS(g,x){return Ch(this,g,x,1)}function $S(g,x){return Ch(this,g,x,-1)}function vh(g){return g<0?Math.floor(g):Math.ceil(g)}function GS(){var g=this._milliseconds,x=this._days,b=this._months,M=this._data,A,ne,ve,et,kt;return g>=0&&x>=0&&b>=0||g<=0&&x<=0&&b<=0||(g+=vh(Hm(b)+x)*864e5,x=0,b=0),M.milliseconds=g%1e3,A=xr(g/1e3),M.seconds=A%60,ne=xr(A/60),M.minutes=ne%60,ve=xr(ne/60),M.hours=ve%24,x+=xr(ve/24),kt=xr(bh(x)),b+=kt,x-=vh(Hm(kt)),et=xr(b/12),b%=12,M.days=x,M.months=b,M.years=et,this}function bh(g){return g*4800/146097}function Hm(g){return g*146097/4800}function HS(g){if(!this.isValid())return NaN;var x,b,M=this._milliseconds;if(g=an(g),g==="month"||g==="quarter"||g==="year")switch(x=this._days+M/864e5,b=this._months+bh(x),g){case"month":return b;case"quarter":return b/3;case"year":return b/12}else switch(x=this._days+Math.round(Hm(this._months)),g){case"week":return x/7+M/6048e5;case"day":return x+M/864e5;case"hour":return x*24+M/36e5;case"minute":return x*1440+M/6e4;case"second":return x*86400+M/1e3;case"millisecond":return Math.floor(x*864e5)+M;default:throw new Error("Unknown unit "+g)}}function $a(g){return function(){return this.as(g)}}var yh=$a("ms"),qS=$a("s"),XS=$a("m"),KS=$a("h"),ZS=$a("d"),JS=$a("w"),QS=$a("M"),eP=$a("Q"),tP=$a("y"),nP=yh;function iP(){return ma(this)}function rP(g){return g=an(g),this.isValid()?this[g+"s"]():NaN}function Qo(g){return function(){return this.isValid()?this._data[g]:NaN}}var aP=Qo("milliseconds"),oP=Qo("seconds"),sP=Qo("minutes"),cP=Qo("hours"),lP=Qo("days"),dP=Qo("months"),uP=Qo("years");function mP(){return xr(this.days()/7)}var Ga=Math.round,Bs={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function gP(g,x,b,M,A){return A.relativeTime(x||1,!!b,g,M)}function fP(g,x,b,M){var A=ma(g).abs(),ne=Ga(A.as("s")),ve=Ga(A.as("m")),et=Ga(A.as("h")),kt=Ga(A.as("d")),Zt=Ga(A.as("M")),ur=Ga(A.as("w")),Ha=Ga(A.as("y")),mo=ne<=b.ss&&["s",ne]||ne<b.s&&["ss",ne]||ve<=1&&["m"]||ve<b.m&&["mm",ve]||et<=1&&["h"]||et<b.h&&["hh",et]||kt<=1&&["d"]||kt<b.d&&["dd",kt];return b.w!=null&&(mo=mo||ur<=1&&["w"]||ur<b.w&&["ww",ur]),mo=mo||Zt<=1&&["M"]||Zt<b.M&&["MM",Zt]||Ha<=1&&["y"]||["yy",Ha],mo[2]=x,mo[3]=+g>0,mo[4]=M,gP.apply(null,mo)}function pP(g){return g===void 0?Ga:typeof g=="function"?(Ga=g,!0):!1}function hP(g,x){return Bs[g]===void 0?!1:x===void 0?Bs[g]:(Bs[g]=x,g==="s"&&(Bs.ss=x-1),!0)}function xP(g,x){if(!this.isValid())return this.localeData().invalidDate();var b=!1,M=Bs,A,ne;return typeof g=="object"&&(x=g,g=!1),typeof g=="boolean"&&(b=g),typeof x=="object"&&(M=Object.assign({},Bs,x),x.s!=null&&x.ss==null&&(M.ss=x.s-1)),A=this.localeData(),ne=fP(this,!b,M,A),b&&(ne=A.pastFuture(+this,ne)),A.postformat(ne)}var qm=Math.abs;function Ls(g){return(g>0)-(g<0)||+g}function w0(){if(!this.isValid())return this.localeData().invalidDate();var g=qm(this._milliseconds)/1e3,x=qm(this._days),b=qm(this._months),M,A,ne,ve,et=this.asSeconds(),kt,Zt,ur,Ha;return et?(M=xr(g/60),A=xr(M/60),g%=60,M%=60,ne=xr(b/12),b%=12,ve=g?g.toFixed(3).replace(/\.?0+$/,""):"",kt=et<0?"-":"",Zt=Ls(this._months)!==Ls(et)?"-":"",ur=Ls(this._days)!==Ls(et)?"-":"",Ha=Ls(this._milliseconds)!==Ls(et)?"-":"",kt+"P"+(ne?Zt+ne+"Y":"")+(b?Zt+b+"M":"")+(x?ur+x+"D":"")+(A||M||g?"T":"")+(A?Ha+A+"H":"")+(M?Ha+M+"M":"")+(g?Ha+ve+"S":"")):"P0D"}var Jt=x0.prototype;Jt.isValid=dw,Jt.abs=WS,Jt.add=YS,Jt.subtract=$S,Jt.as=HS,Jt.asMilliseconds=yh,Jt.asSeconds=qS,Jt.asMinutes=XS,Jt.asHours=KS,Jt.asDays=ZS,Jt.asWeeks=JS,Jt.asMonths=QS,Jt.asQuarters=eP,Jt.asYears=tP,Jt.valueOf=nP,Jt._bubble=GS,Jt.clone=iP,Jt.get=rP,Jt.milliseconds=aP,Jt.seconds=oP,Jt.minutes=sP,Jt.hours=cP,Jt.days=lP,Jt.weeks=mP,Jt.months=dP,Jt.years=uP,Jt.humanize=xP,Jt.toISOString=w0,Jt.toString=w0,Jt.toJSON=w0,Jt.locale=ch,Jt.localeData=dh,Jt.toIsoString=R("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",w0),Jt.lang=lh,te("X",0,0,"unix"),te("x",0,0,"valueOf"),Ke("x",qo),Ke("X",g0),un("X",function(g,x,b){b._d=new Date(parseFloat(g)*1e3)}),un("x",function(g,x,b){b._d=new Date(Gt(g))});return n.version="2.30.1",i(Pn),n.fn=Le,n.min=ow,n.max=sw,n.now=cw,n.utc=_,n.unix=NS,n.months=LS,n.isDate=m,n.locale=lo,n.invalid=D,n.duration=ma,n.isMoment=k,n.weekdays=US,n.parseZone=BS,n.localeData=Wa,n.isDuration=_0,n.monthsShort=VS,n.weekdaysMin=zS,n.defineLocale=Rm,n.updateLocale=BM,n.locales=LM,n.weekdaysShort=jS,n.normalizeUnits=an,n.relativeTimeRounding=pP,n.relativeTimeThreshold=hP,n.calendarFormat=Dw,n.prototype=Le,n.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},n})});var cy=wh((Mp,wp)=>{"use strict";((e,n)=>{typeof define=="function"&&define.amd?define([],n):typeof wp=="object"&&typeof Mp<"u"?wp.exports=n():e.Papa=n()})(Mp,function e(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,t=!n.document&&!!n.postMessage,r=n.IS_PAPA_WORKER||!1,a={},o=0,s={};function u(k){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(O){var R=I(O);R.chunkSize=parseInt(R.chunkSize),O.step||O.chunk||(R.chunkSize=null),this._handle=new y(R),(this._handle.streamer=this)._config=R}).call(this,k),this.parseChunk=function(O,R){var U=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<U){let re=this._config.newline;re||(Q=this._config.quoteChar||'"',re=this._handle.guessLineEndings(O,Q)),O=[...O.split(re).slice(U)].join(re)}this.isFirstChunk&&ee(this._config.beforeFirstChunk)&&(Q=this._config.beforeFirstChunk(O))!==void 0&&(O=Q),this.isFirstChunk=!1,this._halted=!1;var U=this._partialLine+O,Q=(this._partialLine="",this._handle.parse(U,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(O=Q.meta.cursor,U=(this._finished||(this._partialLine=U.substring(O-this._baseIndex),this._baseIndex=O),Q&&Q.data&&(this._rowCount+=Q.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),r)n.postMessage({results:Q,workerId:s.WORKER_ID,finished:U});else if(ee(this._config.chunk)&&!R){if(this._config.chunk(Q,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=Q=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(Q.data),this._completeResults.errors=this._completeResults.errors.concat(Q.errors),this._completeResults.meta=Q.meta),this._completed||!U||!ee(this._config.complete)||Q&&Q.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),U||Q&&Q.meta.paused||this._nextChunk(),Q}this._halted=!0},this._sendError=function(O){ee(this._config.error)?this._config.error(O):r&&this._config.error&&n.postMessage({workerId:s.WORKER_ID,error:O,finished:!1})}}function m(k){var O;(k=k||{}).chunkSize||(k.chunkSize=s.RemoteChunkSize),u.call(this,k),this._nextChunk=t?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(R){this._input=R,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(O=new XMLHttpRequest,this._config.withCredentials&&(O.withCredentials=this._config.withCredentials),t||(O.onload=K(this._chunkLoaded,this),O.onerror=K(this._chunkError,this)),O.open(this._config.downloadRequestBody?"POST":"GET",this._input,!t),this._config.downloadRequestHeaders){var R,U=this._config.downloadRequestHeaders;for(R in U)O.setRequestHeader(R,U[R])}var Q;this._config.chunkSize&&(Q=this._start+this._config.chunkSize-1,O.setRequestHeader("Range","bytes="+this._start+"-"+Q));try{O.send(this._config.downloadRequestBody)}catch(re){this._chunkError(re.message)}t&&O.status===0&&this._chunkError()}},this._chunkLoaded=function(){O.readyState===4&&(O.status<200||400<=O.status?this._chunkError():(this._start+=this._config.chunkSize||O.responseText.length,this._finished=!this._config.chunkSize||this._start>=(R=>(R=R.getResponseHeader("Content-Range"))!==null?parseInt(R.substring(R.lastIndexOf("/")+1)):-1)(O),this.parseChunk(O.responseText)))},this._chunkError=function(R){R=O.statusText||R,this._sendError(new Error(R))}}function f(k){(k=k||{}).chunkSize||(k.chunkSize=s.LocalChunkSize),u.call(this,k);var O,R,U=typeof FileReader<"u";this.stream=function(Q){this._input=Q,R=Q.slice||Q.webkitSlice||Q.mozSlice,U?((O=new FileReader).onload=K(this._chunkLoaded,this),O.onerror=K(this._chunkError,this)):O=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var Q=this._input,re=(this._config.chunkSize&&(re=Math.min(this._start+this._config.chunkSize,this._input.size),Q=R.call(Q,this._start,re)),O.readAsText(Q,this._config.encoding));U||this._chunkLoaded({target:{result:re}})},this._chunkLoaded=function(Q){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(Q.target.result)},this._chunkError=function(){this._sendError(O.error)}}function h(k){var O;u.call(this,k=k||{}),this.stream=function(R){return O=R,this._nextChunk()},this._nextChunk=function(){var R,U;if(!this._finished)return R=this._config.chunkSize,O=R?(U=O.substring(0,R),O.substring(R)):(U=O,""),this._finished=!O,this.parseChunk(U)}}function _(k){u.call(this,k=k||{});var O=[],R=!0,U=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(Q){this._input=Q,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){U&&O.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),O.length?this.parseChunk(O.shift()):R=!0},this._streamData=K(function(Q){try{O.push(typeof Q=="string"?Q:Q.toString(this._config.encoding)),R&&(R=!1,this._checkIsFinished(),this.parseChunk(O.shift()))}catch(re){this._streamError(re)}},this),this._streamError=K(function(Q){this._streamCleanUp(),this._sendError(Q)},this),this._streamEnd=K(function(){this._streamCleanUp(),U=!0,this._streamData("")},this),this._streamCleanUp=K(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function y(k){var O,R,U,Q,re=Math.pow(2,53),ie=-re,Pe=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Re=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,xe=this,Be=0,we=0,$e=!1,Se=!1,Ae=[],ce={data:[],errors:[],meta:{}};function Y(de){return k.skipEmptyLines==="greedy"?de.join("").trim()==="":de.length===1&&de[0].length===0}function te(){if(ce&&U&&(J("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),U=!1),k.skipEmptyLines&&(ce.data=ce.data.filter(function(_e){return!Y(_e)})),Z()){let _e=function(it,j){ee(k.transformHeader)&&(it=k.transformHeader(it,j)),Ae.push(it)};var Me=_e;if(ce)if(Array.isArray(ce.data[0])){for(var de=0;Z()&&de<ce.data.length;de++)ce.data[de].forEach(_e);ce.data.splice(0,1)}else ce.data.forEach(_e)}function Oe(_e,it){for(var j=k.header?{}:[],st=0;st<_e.length;st++){var qe=st,bt=_e[st],bt=((Ze,Fe)=>(Tt=>(k.dynamicTypingFunction&&k.dynamicTyping[Tt]===void 0&&(k.dynamicTyping[Tt]=k.dynamicTypingFunction(Tt)),(k.dynamicTyping[Tt]||k.dynamicTyping)===!0))(Ze)?Fe==="true"||Fe==="TRUE"||Fe!=="false"&&Fe!=="FALSE"&&((Tt=>{if(Pe.test(Tt)&&(Tt=parseFloat(Tt),ie<Tt&&Tt<re))return 1})(Fe)?parseFloat(Fe):Re.test(Fe)?new Date(Fe):Fe===""?null:Fe):Fe)(qe=k.header?st>=Ae.length?"__parsed_extra":Ae[st]:qe,bt=k.transform?k.transform(bt,qe):bt);qe==="__parsed_extra"?(j[qe]=j[qe]||[],j[qe].push(bt)):j[qe]=bt}return k.header&&(st>Ae.length?J("FieldMismatch","TooManyFields","Too many fields: expected "+Ae.length+" fields but parsed "+st,we+it):st<Ae.length&&J("FieldMismatch","TooFewFields","Too few fields: expected "+Ae.length+" fields but parsed "+st,we+it)),j}var ke;ce&&(k.header||k.dynamicTyping||k.transform)&&(ke=1,!ce.data.length||Array.isArray(ce.data[0])?(ce.data=ce.data.map(Oe),ke=ce.data.length):ce.data=Oe(ce.data,0),k.header&&ce.meta&&(ce.meta.fields=Ae),we+=ke)}function Z(){return k.header&&Ae.length===0}function J(de,Oe,ke,Me){de={type:de,code:Oe,message:ke},Me!==void 0&&(de.row=Me),ce.errors.push(de)}ee(k.step)&&(Q=k.step,k.step=function(de){ce=de,Z()?te():(te(),ce.data.length!==0&&(Be+=de.data.length,k.preview&&Be>k.preview?R.abort():(ce.data=ce.data[0],Q(ce,xe))))}),this.parse=function(de,Oe,ke){var Me=k.quoteChar||'"',Me=(k.newline||(k.newline=this.guessLineEndings(de,Me)),U=!1,k.delimiter?ee(k.delimiter)&&(k.delimiter=k.delimiter(de),ce.meta.delimiter=k.delimiter):((Me=((_e,it,j,st,qe)=>{var bt,Ze,Fe,Tt;qe=qe||[",","	","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var an=0;an<qe.length;an++){for(var Sn,zi=qe[an],Nn=0,Xn=0,Ot=0,Mn=(Fe=void 0,new C({comments:st,delimiter:zi,newline:it,preview:10}).parse(_e)),Kn=0;Kn<Mn.data.length;Kn++)j&&Y(Mn.data[Kn])?Ot++:(Sn=Mn.data[Kn].length,Xn+=Sn,Fe===void 0?Fe=Sn:0<Sn&&(Nn+=Math.abs(Sn-Fe),Fe=Sn));0<Mn.data.length&&(Xn/=Mn.data.length-Ot),(Ze===void 0||Nn<=Ze)&&(Tt===void 0||Tt<Xn)&&1.99<Xn&&(Ze=Nn,bt=zi,Tt=Xn)}return{successful:!!(k.delimiter=bt),bestDelimiter:bt}})(de,k.newline,k.skipEmptyLines,k.comments,k.delimitersToGuess)).successful?k.delimiter=Me.bestDelimiter:(U=!0,k.delimiter=s.DefaultDelimiter),ce.meta.delimiter=k.delimiter),I(k));return k.preview&&k.header&&Me.preview++,O=de,R=new C(Me),ce=R.parse(O,Oe,ke),te(),$e?{meta:{paused:!0}}:ce||{meta:{paused:!1}}},this.paused=function(){return $e},this.pause=function(){$e=!0,R.abort(),O=ee(k.chunk)?"":O.substring(R.getCharIndex())},this.resume=function(){xe.streamer._halted?($e=!1,xe.streamer.parseChunk(O,!0)):setTimeout(xe.resume,3)},this.aborted=function(){return Se},this.abort=function(){Se=!0,R.abort(),ce.meta.aborted=!0,ee(k.complete)&&k.complete(ce),O=""},this.guessLineEndings=function(_e,Me){_e=_e.substring(0,1048576);var Me=new RegExp(v(Me)+"([^]*?)"+v(Me),"gm"),ke=(_e=_e.replace(Me,"")).split("\r"),Me=_e.split(`
`),_e=1<Me.length&&Me[0].length<ke[0].length;if(ke.length===1||_e)return`
`;for(var it=0,j=0;j<ke.length;j++)ke[j][0]===`
`&&it++;return it>=ke.length/2?`\r
`:"\r"}}function v(k){return k.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function C(k){var O=(k=k||{}).delimiter,R=k.newline,U=k.comments,Q=k.step,re=k.preview,ie=k.fastMode,Pe=null,Re=!1,xe=k.quoteChar==null?'"':k.quoteChar,Be=xe;if(k.escapeChar!==void 0&&(Be=k.escapeChar),(typeof O!="string"||-1<s.BAD_DELIMITERS.indexOf(O))&&(O=","),U===O)throw new Error("Comment character same as delimiter");U===!0?U="#":(typeof U!="string"||-1<s.BAD_DELIMITERS.indexOf(U))&&(U=!1),R!==`
`&&R!=="\r"&&R!==`\r
`&&(R=`
`);var we=0,$e=!1;this.parse=function(Se,Ae,ce){if(typeof Se!="string")throw new Error("Input must be a string");var Y=Se.length,te=O.length,Z=R.length,J=U.length,de=ee(Q),Oe=[],ke=[],Me=[],_e=we=0;if(!Se)return Nn();if(ie||ie!==!1&&Se.indexOf(xe)===-1){for(var it=Se.split(R),j=0;j<it.length;j++){if(Me=it[j],we+=Me.length,j!==it.length-1)we+=R.length;else if(ce)return Nn();if(!U||Me.substring(0,J)!==U){if(de){if(Oe=[],Tt(Me.split(O)),Xn(),$e)return Nn()}else Tt(Me.split(O));if(re&&re<=j)return Oe=Oe.slice(0,re),Nn(!0)}}return Nn()}for(var st=Se.indexOf(O,we),qe=Se.indexOf(R,we),bt=new RegExp(v(Be)+v(xe),"g"),Ze=Se.indexOf(xe,we);;)if(Se[we]===xe)for(Ze=we,we++;;){if((Ze=Se.indexOf(xe,Ze+1))===-1)return ce||ke.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Oe.length,index:we}),Sn();if(Ze===Y-1)return Sn(Se.substring(we,Ze).replace(bt,xe));if(xe===Be&&Se[Ze+1]===Be)Ze++;else if(xe===Be||Ze===0||Se[Ze-1]!==Be){st!==-1&&st<Ze+1&&(st=Se.indexOf(O,Ze+1));var Fe=an((qe=qe!==-1&&qe<Ze+1?Se.indexOf(R,Ze+1):qe)===-1?st:Math.min(st,qe));if(Se.substr(Ze+1+Fe,te)===O){Me.push(Se.substring(we,Ze).replace(bt,xe)),Se[we=Ze+1+Fe+te]!==xe&&(Ze=Se.indexOf(xe,we)),st=Se.indexOf(O,we),qe=Se.indexOf(R,we);break}if(Fe=an(qe),Se.substring(Ze+1+Fe,Ze+1+Fe+Z)===R){if(Me.push(Se.substring(we,Ze).replace(bt,xe)),zi(Ze+1+Fe+Z),st=Se.indexOf(O,we),Ze=Se.indexOf(xe,we),de&&(Xn(),$e))return Nn();if(re&&Oe.length>=re)return Nn(!0);break}ke.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Oe.length,index:we}),Ze++}}else if(U&&Me.length===0&&Se.substring(we,we+J)===U){if(qe===-1)return Nn();we=qe+Z,qe=Se.indexOf(R,we),st=Se.indexOf(O,we)}else if(st!==-1&&(st<qe||qe===-1))Me.push(Se.substring(we,st)),we=st+te,st=Se.indexOf(O,we);else{if(qe===-1)break;if(Me.push(Se.substring(we,qe)),zi(qe+Z),de&&(Xn(),$e))return Nn();if(re&&Oe.length>=re)return Nn(!0)}return Sn();function Tt(Ot){Oe.push(Ot),_e=we}function an(Ot){var Mn=0;return Mn=Ot!==-1&&(Ot=Se.substring(Ze+1,Ot))&&Ot.trim()===""?Ot.length:Mn}function Sn(Ot){return ce||(Ot===void 0&&(Ot=Se.substring(we)),Me.push(Ot),we=Y,Tt(Me),de&&Xn()),Nn()}function zi(Ot){we=Ot,Tt(Me),Me=[],qe=Se.indexOf(R,we)}function Nn(Ot){if(k.header&&!Ae&&Oe.length&&!Re){var Mn=Oe[0],Kn=Object.create(null),pr=new Set(Mn);let It=!1;for(let ui=0;ui<Mn.length;ui++){let xt=Mn[ui];if(Kn[xt=ee(k.transformHeader)?k.transformHeader(xt,ui):xt]){let on,bi=Kn[xt];for(;on=xt+"_"+bi,bi++,pr.has(on););pr.add(on),Mn[ui]=on,Kn[xt]++,It=!0,(Pe=Pe===null?{}:Pe)[on]=xt}else Kn[xt]=1,Mn[ui]=xt;pr.add(xt)}It&&console.warn("Duplicate headers found and renamed."),Re=!0}return{data:Oe,errors:ke,meta:{delimiter:O,linebreak:R,aborted:$e,truncated:!!Ot,cursor:_e+(Ae||0),renamedHeaders:Pe}}}function Xn(){Q(Nn()),Oe=[],ke=[]}},this.abort=function(){$e=!0},this.getCharIndex=function(){return we}}function P(k){var O=k.data,R=a[O.workerId],U=!1;if(O.error)R.userError(O.error,O.file);else if(O.results&&O.results.data){var Q={abort:function(){U=!0,D(O.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:T,resume:T};if(ee(R.userStep)){for(var re=0;re<O.results.data.length&&(R.userStep({data:O.results.data[re],errors:O.results.errors,meta:O.results.meta},Q),!U);re++);delete O.results}else ee(R.userChunk)&&(R.userChunk(O.results,Q,O.file),delete O.results)}O.finished&&!U&&D(O.workerId,O.results)}function D(k,O){var R=a[k];ee(R.userComplete)&&R.userComplete(O),R.terminate(),delete a[k]}function T(){throw new Error("Not implemented.")}function I(k){if(typeof k!="object"||k===null)return k;var O,R=Array.isArray(k)?[]:{};for(O in k)R[O]=I(k[O]);return R}function K(k,O){return function(){k.apply(O,arguments)}}function ee(k){return typeof k=="function"}return s.parse=function(k,O){var R=(O=O||{}).dynamicTyping||!1;if(ee(R)&&(O.dynamicTypingFunction=R,R={}),O.dynamicTyping=R,O.transform=!!ee(O.transform)&&O.transform,!O.worker||!s.WORKERS_SUPPORTED)return R=null,s.NODE_STREAM_INPUT,typeof k=="string"?(k=(U=>U.charCodeAt(0)!==65279?U:U.slice(1))(k),R=new(O.download?m:h)(O)):k.readable===!0&&ee(k.read)&&ee(k.on)?R=new _(O):(n.File&&k instanceof File||k instanceof Object)&&(R=new f(O)),R.stream(k);(R=(()=>{var U;return!!s.WORKERS_SUPPORTED&&(U=(()=>{var Q=n.URL||n.webkitURL||null,re=e.toString();return s.BLOB_URL||(s.BLOB_URL=Q.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",re,")();"],{type:"text/javascript"})))})(),(U=new n.Worker(U)).onmessage=P,U.id=o++,a[U.id]=U)})()).userStep=O.step,R.userChunk=O.chunk,R.userComplete=O.complete,R.userError=O.error,O.step=ee(O.step),O.chunk=ee(O.chunk),O.complete=ee(O.complete),O.error=ee(O.error),delete O.worker,R.postMessage({input:k,config:O,workerId:R.id})},s.unparse=function(k,O){var R=!1,U=!0,Q=",",re=`\r
`,ie='"',Pe=ie+ie,Re=!1,xe=null,Be=!1,we=((()=>{if(typeof O=="object"){if(typeof O.delimiter!="string"||s.BAD_DELIMITERS.filter(function(Ae){return O.delimiter.indexOf(Ae)!==-1}).length||(Q=O.delimiter),typeof O.quotes!="boolean"&&typeof O.quotes!="function"&&!Array.isArray(O.quotes)||(R=O.quotes),typeof O.skipEmptyLines!="boolean"&&typeof O.skipEmptyLines!="string"||(Re=O.skipEmptyLines),typeof O.newline=="string"&&(re=O.newline),typeof O.quoteChar=="string"&&(ie=O.quoteChar),typeof O.header=="boolean"&&(U=O.header),Array.isArray(O.columns)){if(O.columns.length===0)throw new Error("Option columns is empty");xe=O.columns}O.escapeChar!==void 0&&(Pe=O.escapeChar+ie),O.escapeFormulae instanceof RegExp?Be=O.escapeFormulae:typeof O.escapeFormulae=="boolean"&&O.escapeFormulae&&(Be=/^[=+\-@\t\r].*$/)}})(),new RegExp(v(ie),"g"));if(typeof k=="string"&&(k=JSON.parse(k)),Array.isArray(k)){if(!k.length||Array.isArray(k[0]))return $e(null,k,Re);if(typeof k[0]=="object")return $e(xe||Object.keys(k[0]),k,Re)}else if(typeof k=="object")return typeof k.data=="string"&&(k.data=JSON.parse(k.data)),Array.isArray(k.data)&&(k.fields||(k.fields=k.meta&&k.meta.fields||xe),k.fields||(k.fields=Array.isArray(k.data[0])?k.fields:typeof k.data[0]=="object"?Object.keys(k.data[0]):[]),Array.isArray(k.data[0])||typeof k.data[0]=="object"||(k.data=[k.data])),$e(k.fields||[],k.data||[],Re);throw new Error("Unable to serialize unrecognized input");function $e(Ae,ce,Y){var te="",Z=(typeof Ae=="string"&&(Ae=JSON.parse(Ae)),typeof ce=="string"&&(ce=JSON.parse(ce)),Array.isArray(Ae)&&0<Ae.length),J=!Array.isArray(ce[0]);if(Z&&U){for(var de=0;de<Ae.length;de++)0<de&&(te+=Q),te+=Se(Ae[de],de);0<ce.length&&(te+=re)}for(var Oe=0;Oe<ce.length;Oe++){var ke=(Z?Ae:ce[Oe]).length,Me=!1,_e=Z?Object.keys(ce[Oe]).length===0:ce[Oe].length===0;if(Y&&!Z&&(Me=Y==="greedy"?ce[Oe].join("").trim()==="":ce[Oe].length===1&&ce[Oe][0].length===0),Y==="greedy"&&Z){for(var it=[],j=0;j<ke;j++){var st=J?Ae[j]:j;it.push(ce[Oe][st])}Me=it.join("").trim()===""}if(!Me){for(var qe=0;qe<ke;qe++){0<qe&&!_e&&(te+=Q);var bt=Z&&J?Ae[qe]:qe;te+=Se(ce[Oe][bt],qe)}Oe<ce.length-1&&(!Y||0<ke&&!_e)&&(te+=re)}}return te}function Se(Ae,ce){var Y,te;return Ae==null?"":Ae.constructor===Date?JSON.stringify(Ae).slice(1,25):(te=!1,Be&&typeof Ae=="string"&&Be.test(Ae)&&(Ae="'"+Ae,te=!0),Y=Ae.toString().replace(we,Pe),(te=te||R===!0||typeof R=="function"&&R(Ae,ce)||Array.isArray(R)&&R[ce]||((Z,J)=>{for(var de=0;de<J.length;de++)if(-1<Z.indexOf(J[de]))return!0;return!1})(Y,s.BAD_DELIMITERS)||-1<Y.indexOf(Q)||Y.charAt(0)===" "||Y.charAt(Y.length-1)===" ")?ie+Y+ie:Y)}},s.RECORD_SEP="",s.UNIT_SEP="",s.BYTE_ORDER_MARK="\uFEFF",s.BAD_DELIMITERS=["\r",`
`,'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!t&&!!n.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=C,s.ParserHandle=y,s.NetworkStreamer=m,s.FileStreamer=f,s.StringStreamer=h,s.ReadableStreamStreamer=_,n.jQuery&&((i=n.jQuery).fn.parse=function(k){var O=k.config||{},R=[];return this.each(function(re){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var ie=0;ie<this.files.length;ie++)R.push({file:this.files[ie],inputElem:this,instanceConfig:i.extend({},O)})}),U(),this;function U(){if(R.length===0)ee(k.complete)&&k.complete();else{var re,ie,Pe,Re,xe=R[0];if(ee(k.before)){var Be=k.before(xe.file,xe.inputElem);if(typeof Be=="object"){if(Be.action==="abort")return re="AbortError",ie=xe.file,Pe=xe.inputElem,Re=Be.reason,void(ee(k.error)&&k.error({name:re},ie,Pe,Re));if(Be.action==="skip")return void Q();typeof Be.config=="object"&&(xe.instanceConfig=i.extend(xe.instanceConfig,Be.config))}else if(Be==="skip")return void Q()}var we=xe.instanceConfig.complete;xe.instanceConfig.complete=function($e){ee(we)&&we($e,xe.file,xe.inputElem),Q()},s.parse(xe.file,xe.instanceConfig)}}function Q(){R.splice(0,1),U()}}),r&&(n.onmessage=function(k){k=k.data,s.WORKER_ID===void 0&&k&&(s.WORKER_ID=k.workerId),typeof k.input=="string"?n.postMessage({workerId:s.WORKER_ID,results:s.parse(k.input,k.config),finished:!0}):(n.File&&k.input instanceof File||k.input instanceof Object)&&(k=s.parse(k.input,k.config))&&n.postMessage({workerId:s.WORKER_ID,results:k,finished:!0})}),(m.prototype=Object.create(u.prototype)).constructor=m,(f.prototype=Object.create(u.prototype)).constructor=f,(h.prototype=Object.create(h.prototype)).constructor=h,(_.prototype=Object.create(u.prototype)).constructor=_,s})});var Oa=Mt("[Budgets] Load Budgets",Pt()),Ud=Mt("[Budgets] Load Budgets Success",Pt()),jd=Mt("[Budgets] Load Budgets Failure",Pt()),pc=Mt("[Budgets] Create Budget",Pt()),zd=Mt("[Budgets] Create Budget Success",Pt()),Wd=Mt("[Budgets] Create Budget Failure",Pt()),Yd=Mt("[Budgets] Update Budget",Pt()),$d=Mt("[Budgets] Update Budget Success",Pt()),Gd=Mt("[Budgets] Update Budget Failure",Pt()),hc=Mt("[Budgets] Delete Budget",Pt()),Hd=Mt("[Budgets] Delete Budget Success",Pt()),qd=Mt("[Budgets] Delete Budget Failure",Pt()),xc=Mt("[Budgets] Update Spent",Pt()),Xd=Mt("[Budgets] Update Spent Success",Pt()),Kd=Mt("[Budgets] Update Spent Failure",Pt());var ka=Mt("[Goals] Load Goals",Pt()),Zd=Mt("[Goals] Load Goals Success",Pt()),Jd=Mt("[Goals] Load Goals Failure",Pt()),_c=Mt("[Goals] Create Goal",Pt()),Qd=Mt("[Goals] Create Goal Success",Pt()),eu=Mt("[Goals] Create Goal Failure",Pt()),tu=Mt("[Goals] Update Goal",Pt()),nu=Mt("[Goals] Update Goal Success",Pt()),iu=Mt("[Goals] Update Goal Failure",Pt()),Cc=Mt("[Goals] Delete Goal",Pt()),ru=Mt("[Goals] Delete Goal Success",Pt()),au=Mt("[Goals] Delete Goal Failure",Pt()),vc=Mt("[Goals] Update Current Amount",Pt()),ou=Mt("[Goals] Update Current Amount Success",Pt()),su=Mt("[Goals] Update Current Amount Failure",Pt());var Ea=Mt("[Profile] Load Profile",Pt()),cu=Mt("[Profile] Load Profile Success",Pt()),lu=Mt("[Profile] Load Profile Failure",Pt()),bc=Mt("[Profile] Update Profile",Pt()),du=Mt("[Profile] Update Profile Success",Pt()),uu=Mt("[Profile] Update Profile Failure",Pt()),mu=Mt("[Profile] Create Profile",Pt()),gu=Mt("[Profile] Create Profile Success",Pt()),fu=Mt("[Profile] Create Profile Failure",Pt()),pu=Mt("[Profile] Delete Profile",Pt()),hu=Mt("[Profile] Delete Profile Success"),xu=Mt("[Profile] Delete Profile Failure",Pt()),_u=Mt("[Profile] Update Preferences",Pt()),Cu=Mt("[Profile] Update Preferences Success",Pt()),vu=Mt("[Profile] Update Preferences Failure",Pt());var En=function(e){return e.LOGIN_ATTEMPT="LOGIN_ATTEMPT",e.LOGIN_SUCCESS="LOGIN_SUCCESS",e.LOGIN_FAILED="LOGIN_FAILED",e.LOGOUT="LOGOUT",e.PASSWORD_CHANGE="PASSWORD_CHANGE",e.PASSWORD_RESET="PASSWORD_RESET",e.SUSPICIOUS_ACTIVITY="SUSPICIOUS_ACTIVITY",e.RATE_LIMIT_EXCEEDED="RATE_LIMIT_EXCEEDED",e.UNAUTHORIZED_ACCESS="UNAUTHORIZED_ACCESS",e.SESSION_EXPIRED="SESSION_EXPIRED",e.ACCOUNT_LOCKED="ACCOUNT_LOCKED",e.ACCOUNT_UNLOCKED="ACCOUNT_UNLOCKED",e.FORCE_LOGOUT="FORCE_LOGOUT",e.SECURITY_ALERT="SECURITY_ALERT",e}(En||{}),Tn=function(e){return e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.CRITICAL="critical",e}(Tn||{}),Jx=(()=>{let n=class n{constructor(t,r,a){this.router=t,this.userService=r,this.notificationService=a,this.securityEvents=new mn([]),this.securityStatus=new mn(null),this.securityConfig={SESSION_TIMEOUT:30*60*1e3,MAX_LOGIN_ATTEMPTS:5,LOCKOUT_DURATION:15*60*1e3,PASSWORD_MIN_LENGTH:8,REQUIRE_EMAIL_VERIFICATION:!0,ENABLE_TWO_FACTOR:!1,ENABLE_RATE_LIMITING:!0,ENABLE_AUDIT_LOGGING:!0,ENABLE_SECURITY_HEADERS:!0,ALLOWED_ORIGINS:["localhost","127.0.0.1","yourdomain.com"],BLOCKED_IPS:[]},this.securityEvents$=this.securityEvents.asObservable(),this.securityStatus$=this.securityStatus.asObservable(),this.initializeSecurityMonitoring()}initializeSecurityMonitoring(){this.userService.userAuth$.subscribe(t=>{this.updateSecurityStatus()}),setInterval(()=>{},6e4),this.monitorSuspiciousActivity()}logSecurityEvent(t,r,a={},o){let s={id:this.generateEventId(),type:t,level:r,userId:o,timestamp:new Date,details:a,userAgent:navigator.userAgent,ipAddress:this.getClientIP(),location:window.location.href,resolved:!1},u=this.securityEvents.value;u.push(s),u.length>1e3&&u.shift(),this.securityEvents.next(u),r===Tn.CRITICAL&&this.handleCriticalSecurityEvent(s),console.log("Security Event:",s)}handleCriticalSecurityEvent(t){switch(t.type){case En.SUSPICIOUS_ACTIVITY:this.notificationService.error("Suspicious activity detected. Please review your account.");break;case En.UNAUTHORIZED_ACCESS:this.forceLogout("Unauthorized access detected");break;case En.ACCOUNT_LOCKED:this.notificationService.warning("Account locked due to multiple failed login attempts.");break;case En.SECURITY_ALERT:this.notificationService.error("Security alert: Please review your account immediately.");break}}updateSecurityStatus(){let t=this.userService.userAuth$.value,r=this.userService.getSecurityStatus(),a={isAuthenticated:!!t,sessionActive:(r==null?void 0:r.sessionActive)||!1,sessionAge:(r==null?void 0:r.sessionAge)||0,loginAttempts:(r==null?void 0:r.loginAttempts)||0,isAccountLocked:(r==null?void 0:r.isLocked)||!1,isEmailVerified:(r==null?void 0:r.isEmailVerified)||!1,twoFactorEnabled:!1,lastLoginTime:r!=null&&r.lastLogin?new Date(r.lastLogin):void 0,securityLevel:this.calculateSecurityLevel(r),recentSecurityEvents:this.getRecentSecurityEvents()};this.securityStatus.next(a)}calculateSecurityLevel(t){if(!t)return Tn.LOW;let r=0;return t.isEmailVerified&&(r+=2),t.isLocked||(r+=1),t.loginAttempts<2&&(r+=1),t.sessionActive&&(r+=1),r>=4?Tn.HIGH:r>=2?Tn.MEDIUM:Tn.LOW}getRecentSecurityEvents(){let t=this.securityEvents.value,r=new Date(Date.now()-60*60*1e3);return t.filter(a=>a.timestamp>r)}performSecurityChecks(){let t=this.userService.userAuth$.value;if(!t)return;let r=this.userService.getSecurityStatus();r&&!r.sessionActive&&(this.logSecurityEvent(En.SESSION_EXPIRED,Tn.HIGH,{userId:t.uid},t.uid),this.forceLogout("Session expired")),this.detectSuspiciousActivityPatterns()}detectSuspiciousActivityPatterns(){let t=this.getRecentSecurityEvents(),r=this.userService.userAuth$.value;if(!r)return;let a=t.filter(s=>s.type===En.LOGIN_FAILED&&s.userId===r.uid);a.length>=3&&this.logSecurityEvent(En.SUSPICIOUS_ACTIVITY,Tn.HIGH,{reason:"multiple_failed_logins",count:a.length},r.uid);let o=t.filter(s=>s.timestamp>new Date(Date.now()-5*60*1e3));o.length>10&&this.logSecurityEvent(En.SUSPICIOUS_ACTIVITY,Tn.MEDIUM,{reason:"rapid_activity",count:o.length})}monitorSuspiciousActivity(){let t=0,r=Date.now();this.router.events.subscribe(()=>{let a=Date.now();a-r<1e3?(t++,t>10&&this.logSecurityEvent(En.SUSPICIOUS_ACTIVITY,Tn.MEDIUM,{reason:"rapid_navigation",count:t})):t=0,r=a})}forceLogout(t){this.logSecurityEvent(En.FORCE_LOGOUT,Tn.CRITICAL,{reason:t}),this.userService.forceLogout(t)}validateSecurityConfig(){let t=[];return this.securityConfig.PASSWORD_MIN_LENGTH<8&&t.push("Password minimum length should be at least 8 characters"),this.securityConfig.SESSION_TIMEOUT<5*60*1e3&&t.push("Session timeout should be at least 5 minutes"),this.securityConfig.MAX_LOGIN_ATTEMPTS<3&&t.push("Maximum login attempts should be at least 3"),t.length>0?(console.warn("Security configuration issues:",t),!1):!0}getSecurityConfig(){return ae({},this.securityConfig)}updateSecurityConfig(t){Object.assign(this.securityConfig,t),this.logSecurityEvent(En.SECURITY_ALERT,Tn.MEDIUM,{reason:"config_updated",updates:t})}getSecurityEventsByType(t){return this.securityEvents.value.filter(r=>r.type===t)}getSecurityEventsByLevel(t){return this.securityEvents.value.filter(r=>r.level===t)}resolveSecurityEvent(t){let r=this.securityEvents.value,a=r.findIndex(o=>o.id===t);a!==-1&&(r[a].resolved=!0,this.securityEvents.next(r))}clearResolvedEvents(){let t=this.securityEvents.value.filter(r=>!r.resolved);this.securityEvents.next(t)}generateEventId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}getClientIP(){return"client-side"}isOriginAllowed(t){return this.securityConfig.ALLOWED_ORIGINS.some(r=>t.includes(r))}isIPBlocked(t){return this.securityConfig.BLOCKED_IPS.includes(t)}blockIP(t,r){this.securityConfig.BLOCKED_IPS.includes(t)||(this.securityConfig.BLOCKED_IPS.push(t),this.logSecurityEvent(En.SECURITY_ALERT,Tn.HIGH,{reason:r,ip:t}))}unblockIP(t){let r=this.securityConfig.BLOCKED_IPS.indexOf(t);r!==-1&&(this.securityConfig.BLOCKED_IPS.splice(r,1),this.logSecurityEvent(En.SECURITY_ALERT,Tn.MEDIUM,{reason:"ip_unblocked",ip:t}))}};n.\u0275fac=function(r){return new(r||n)(De(Kt),De(gi),De(ht))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var vP=(e,n,i,t)=>({"bg-red-500":e,"bg-yellow-500":n,"bg-blue-500":i,"bg-green-500":t});function bP(e,n){if(e&1&&(c(0,"p",41),d(1),l()),e&2){let i=S(2);p(),oe(" Time remaining: ",i.getLockoutTimeRemaining()," minutes ")}}function yP(e,n){if(e&1&&(c(0,"div",36)(1,"div",37),yi(),c(2,"svg",38),se(3,"path",39),l(),Yr(),c(4,"span",40),d(5,"Account Temporarily Locked"),l()(),c(6,"p",41),d(7,"Too many failed login attempts. Please try again later."),l(),X(8,bP,2,1,"p",42),l()),e&2){let i=S();p(8),w("ngIf",i.lockoutTimeRemaining>0)}}function MP(e,n){if(e&1&&(c(0,"div",43)(1,"div",37),yi(),c(2,"svg",38),se(3,"path",44),l(),Yr(),c(4,"span",40),d(5,"Login Attempts"),l()(),c(6,"p",41),d(7),l()()),e&2){let i=S();p(7),jt(" Failed attempts: ",i.loginAttempts," / ",i.maxLoginAttempts," ")}}function wP(e,n){e&1&&(c(0,"span"),d(1),pe(2,"translate"),l()),e&2&&(p(),z(Ee(2,1,"emailRequired")))}function SP(e,n){e&1&&(c(0,"span"),d(1,"Please enter a valid email address"),l())}function PP(e,n){e&1&&(c(0,"span"),d(1,"Disposable email addresses are not allowed"),l())}function OP(e,n){if(e&1&&(c(0,"div",45),X(1,wP,3,3,"span",15)(2,SP,2,0,"span",15)(3,PP,2,0,"span",15),l()),e&2){let i,t,r,a=S();p(),w("ngIf",(i=a.signInForm.get("email"))==null||i.errors==null?null:i.errors.required),p(),w("ngIf",(t=a.signInForm.get("email"))==null||t.errors==null?null:t.errors.email),p(),w("ngIf",(r=a.signInForm.get("email"))==null||r.errors==null?null:r.errors.disposableEmail)}}function kP(e,n){e&1&&(c(0,"span"),d(1,"Full name is required"),l())}function EP(e,n){e&1&&(c(0,"span"),d(1,"Name must be at least 2 characters long"),l())}function TP(e,n){if(e&1&&(c(0,"div",45),X(1,kP,2,0,"span",15)(2,EP,2,0,"span",15),l()),e&2){let i,t,r=S(2);p(),w("ngIf",(i=r.signInForm.get("name"))==null||i.errors==null?null:i.errors.required),p(),w("ngIf",(t=r.signInForm.get("name"))==null||t.errors==null?null:t.errors.minLength)}}function IP(e,n){if(e&1&&(c(0,"div")(1,"label",46),d(2,"Full Name"),l(),se(3,"input",47),X(4,TP,3,2,"div",14),l()),e&2){let i,t=S();p(3),ga("data-security-level",t.securityLevel),p(),w("ngIf",((i=t.signInForm.get("name"))==null?null:i.invalid)&&((i=t.signInForm.get("name"))==null?null:i.touched))}}function AP(e,n){e&1&&(c(0,"a",48),d(1,"Forget Password?"),l())}function DP(e,n){e&1&&(yi(),c(0,"svg",49),se(1,"path",50)(2,"path",51),l())}function FP(e,n){e&1&&(yi(),c(0,"svg",49),se(1,"path",52),l())}function RP(e,n){e&1&&(c(0,"span"),d(1,"Password must be at least 8 characters with uppercase, lowercase, number, and special character"),l())}function NP(e,n){if(e&1&&(c(0,"div",53)(1,"div",54)(2,"span"),d(3,"Password strength:"),l(),c(4,"span"),d(5),l()(),c(6,"div",55),se(7,"div",56),l(),c(8,"div",57),X(9,RP,2,0,"span",15),l()()),e&2){let i=S();p(4),Lt(i.getPasswordStrengthColor()),p(),z(i.getPasswordStrengthText()),p(2),Xt("width",i.passwordStrength/4*100,"%"),w("ngClass",Hh(7,vP,i.passwordStrength<=1,i.passwordStrength===2,i.passwordStrength===3,i.passwordStrength>=4)),p(2),w("ngIf",i.passwordStrength<3)}}function BP(e,n){e&1&&(c(0,"span"),d(1),pe(2,"translate"),l()),e&2&&(p(),z(Ee(2,1,"passwordRequired")))}function LP(e,n){e&1&&(c(0,"span"),d(1,"Password must be at least 8 characters long"),l())}function VP(e,n){e&1&&(c(0,"span"),d(1,"Password must contain uppercase, lowercase, number, and special character"),l())}function UP(e,n){if(e&1&&(c(0,"div",45),X(1,BP,3,3,"span",15)(2,LP,2,0,"span",15)(3,VP,2,0,"span",15),l()),e&2){let i,t,r,a=S();p(),w("ngIf",(i=a.signInForm.get("password"))==null||i.errors==null?null:i.errors.required),p(),w("ngIf",(t=a.signInForm.get("password"))==null||t.errors==null?null:t.errors.minLength),p(),w("ngIf",(r=a.signInForm.get("password"))==null||r.errors==null?null:r.errors.passwordStrength)}}function jP(e,n){e&1&&(yi(),c(0,"svg",49),se(1,"path",50)(2,"path",51),l())}function zP(e,n){e&1&&(yi(),c(0,"svg",49),se(1,"path",52),l())}function WP(e,n){e&1&&(c(0,"span"),d(1),pe(2,"translate"),l()),e&2&&(p(),oe("",Ee(2,1,"confirmPassword")," is required"))}function YP(e,n){e&1&&(c(0,"span"),d(1,"Passwords do not match"),l())}function $P(e,n){if(e&1&&(c(0,"div",45),X(1,WP,3,3,"span",15)(2,YP,2,0,"span",15),l()),e&2){let i,t,r=S(2);p(),w("ngIf",(i=r.signInForm.get("confirmPassword"))==null||i.errors==null?null:i.errors.required),p(),w("ngIf",(t=r.signInForm.get("confirmPassword"))==null||t.errors==null?null:t.errors.notMatch)}}function GP(e,n){if(e&1){let i=be();c(0,"div")(1,"label",58),d(2),pe(3,"translate"),l(),c(4,"div",19),se(5,"input",59),c(6,"button",21),N("click",function(){G(i);let r=S();return H(r.toggleConfirmPasswordVisibility())}),X(7,jP,3,0,"svg",22)(8,zP,2,0,"svg",22),l()(),X(9,$P,3,2,"div",14),l()}if(e&2){let i,t=S();p(2),z(Ee(3,6,"confirmPassword")),p(3),w("type",t.showConfirmPassword?"text":"password"),ga("data-security-level",t.securityLevel),p(2),w("ngIf",!t.showConfirmPassword),p(),w("ngIf",t.showConfirmPassword),p(),w("ngIf",((i=t.signInForm.get("confirmPassword"))==null?null:i.invalid)&&((i=t.signInForm.get("confirmPassword"))==null?null:i.touched))}}function HP(e,n){e&1&&se(0,"mat-spinner",60)}function qP(e,n){if(e&1&&(c(0,"span"),d(1),pe(2,"translate"),pe(3,"translate"),l()),e&2){let i=S();p(),z(i.isSignInPage?Ee(2,1,"signIn"):Ee(3,3,"signUp"))}}function XP(e,n){if(e&1&&(c(0,"span"),d(1),l()),e&2){let i=S();p(),z(i.isSignInPage?"Signing in...":"Creating account...")}}function KP(e,n){e&1&&(yi(),c(0,"svg",61),se(1,"path",62)(2,"path",63)(3,"path",64)(4,"path",65),l())}function ZP(e,n){e&1&&se(0,"mat-spinner",66)}function JP(e,n){e&1&&(c(0,"div",67)(1,"div",37),yi(),c(2,"svg",68),se(3,"path",69)(4,"path",70),l(),Yr(),c(5,"span",71),d(6,"Security"),l()(),c(7,"p",72),d(8," Enterprise-grade encryption and secure authentication protect your data. "),l()())}var ug=(()=>{let n=class n{constructor(t,r,a,o,s,u,m,f){this.fb=t,this.router=r,this.route=a,this.userService=o,this.notificationService=s,this.securityService=u,this.validationService=m,this.store=f,this.isSignInPage=!0,this.isLoading=!1,this.isAccountLocked=!1,this.lockoutTimeRemaining=0,this.loginAttempts=0,this.maxLoginAttempts=5,this.showPassword=!1,this.showConfirmPassword=!1,this.passwordStrength=0,this.securityLevel="moderate",this.showSecurityNotice=!1,this.destroy$=new vn,this.loginAttemptCount=0,this.lastLoginAttempt=0,this.rateLimitWindow=6e4,this.maxAttemptsPerWindow=3,this.initializeForm(),this._setIsSignInPage(this.router.url.includes("/sign-in")),this.checkQueryParams()}ngOnInit(){this.setupFormValidation(),this.checkSecurityStatus(),this.startSecurityMonitoring(),setTimeout(()=>{this.showSecurityNotice=!0},100)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeForm(){this.signInForm=this.fb.group({email:["",[...this.validationService.getProfileEmailValidators(),this.emailDomainValidator.bind(this)]],password:["",[...this.validationService.getAuthPasswordValidators(),this.passwordStrengthValidator.bind(this)]]})}setupFormValidation(){var t,r;(t=this.signInForm.get("password"))==null||t.valueChanges.pipe(Qt(this.destroy$),cl(300),js()).subscribe(a=>{this.passwordStrength=this.calculatePasswordStrength(a)}),(r=this.signInForm.get("email"))==null||r.valueChanges.pipe(Qt(this.destroy$),cl(500),js()).subscribe(a=>{this.monitorEmailInput(a)})}checkQueryParams(){this.route.queryParams.subscribe(t=>{t.error&&this.handleSecurityError(t.error,t.message),t.session==="expired"&&this.notificationService.warning("Your session has expired. Please sign in again."),t.cacheUpdate==="true"&&this.notificationService.info("Application updated. Please sign in again.")})}checkSecurityStatus(){let t=this.userService.getSecurityStatus();t&&(this.isAccountLocked=t.isLocked,this.loginAttempts=t.loginAttempts,this.maxLoginAttempts=t.remainingAttempts+t.loginAttempts,this.isAccountLocked&&this.calculateLockoutTime())}startSecurityMonitoring(){setInterval(()=>{this.checkSecurityStatus()},1e4)}onSignIn(){return ue(this,null,function*(){var a,o;if(!this.signInForm.valid){this.notificationService.error("Please fill all required fields correctly"),this.markFormGroupTouched();return}if(this.isRateLimited()){this.notificationService.error("Too many login attempts. Please wait before trying again.");return}if(this.isAccountLocked){this.notificationService.error(`Account is temporarily locked. Please try again in ${Math.ceil(this.lockoutTimeRemaining/6e4)} minutes.`);return}let t=(a=this.signInForm.get("email"))==null?void 0:a.value,r=(o=this.signInForm.get("password"))==null?void 0:o.value;this.securityService.logSecurityEvent(En.LOGIN_ATTEMPT,Tn.MEDIUM,{email:t,timestamp:new Date().toISOString()});try{this.isLoading=!0,this.loginAttemptCount++,this.lastLoginAttempt=Date.now(),yield this.userService.signIn(t,r),this.securityService.logSecurityEvent(En.LOGIN_SUCCESS,Tn.LOW,{email:t,timestamp:new Date().toISOString()}),this.notificationService.success("Successfully signed in!"),yield this.loadUserData(),this.router.navigate(["/dashboard"])}catch(s){this.handleSignInError(s,t)}finally{this.isLoading=!1}})}onSignUp(){return ue(this,null,function*(){var o,s,u,m,f,h;if(!this.signInForm.valid){this.notificationService.error("Please fill all required fields correctly"),this.markFormGroupTouched();return}if(this.passwordStrength<3){this.notificationService.error("Password is too weak. Please choose a stronger password.");return}if(((o=this.signInForm.get("password"))==null?void 0:o.value)!==((s=this.signInForm.get("confirmPassword"))==null?void 0:s.value)){this.notificationService.error("Passwords do not match"),(u=this.signInForm.get("confirmPassword"))==null||u.setErrors({notMatch:!0});return}let t=(m=this.signInForm.get("email"))==null?void 0:m.value,r=(f=this.signInForm.get("password"))==null?void 0:f.value,a=((h=this.signInForm.get("name"))==null?void 0:h.value)||"User";this.securityService.logSecurityEvent(En.SECURITY_ALERT,Tn.MEDIUM,{type:"registration_attempt",email:t,timestamp:new Date().toISOString()});try{this.isLoading=!0,yield this.userService.signUp(t,r,a),this.securityService.logSecurityEvent(En.SECURITY_ALERT,Tn.LOW,{type:"registration_success",email:t,timestamp:new Date().toISOString()}),this.notificationService.success("Account created successfully! Please check your email for verification."),this._setIsSignInPage(!0)}catch(_){this.handleSignUpError(_,t)}finally{this.isLoading=!1}})}signInWithGoogle(){return ue(this,null,function*(){if(this.isRateLimited()){this.notificationService.error("Too many sign-in attempts. Please wait before trying again.");return}try{this.isLoading=!0,this.securityService.logSecurityEvent(En.LOGIN_ATTEMPT,Tn.MEDIUM,{method:"google",timestamp:new Date().toISOString()}),yield this.userService.signInWithGoogle(),this.securityService.logSecurityEvent(En.LOGIN_SUCCESS,Tn.LOW,{method:"google",timestamp:new Date().toISOString()}),this.notificationService.success("Successfully signed in with Google!"),yield this.loadUserData(),this.router.navigate(["/dashboard"])}catch(t){this.handleGoogleSignInError(t)}finally{this.isLoading=!1}})}loadUserData(){return ue(this,null,function*(){try{let t=this.userService.userAuth$.value;if(!(t!=null&&t.uid)){console.warn("No user ID available for loading data");return}yield Promise.all([this.store.dispatch(ri({userId:t.uid})),this.store.dispatch(mr({userId:t.uid})),this.store.dispatch(Mr({userId:t.uid})),this.store.dispatch(Oa({userId:t.uid})),this.store.dispatch(ka({userId:t.uid})),this.store.dispatch(Ea({userId:t.uid}))])}catch(t){console.error("Error loading user data:",t)}})}handleSignInError(t,r){switch(console.error("Sign-in error:",t),this.securityService.logSecurityEvent(En.LOGIN_FAILED,Tn.HIGH,{email:r,error:t.message||"Unknown error",timestamp:new Date().toISOString()}),t.code){case"auth/user-not-found":this.notificationService.error("No account found with this email address.");break;case"auth/wrong-password":this.notificationService.error("Incorrect password. Please try again.");break;case"auth/too-many-requests":this.notificationService.error("Too many failed attempts. Please try again later."),this.isAccountLocked=!0;break;case"auth/user-disabled":this.notificationService.error("This account has been disabled. Please contact support.");break;case"auth/invalid-email":this.notificationService.error("Invalid email address format.");break;default:this.notificationService.error(t.message||"Sign-in failed. Please try again.")}}handleSignUpError(t,r){switch(console.error("Sign-up error:",t),this.securityService.logSecurityEvent(En.SECURITY_ALERT,Tn.HIGH,{type:"registration_failed",email:r,error:t.message||"Unknown error",timestamp:new Date().toISOString()}),t.code){case"auth/email-already-in-use":this.notificationService.error("An account with this email already exists.");break;case"auth/weak-password":this.notificationService.error("Password is too weak. Please choose a stronger password.");break;case"auth/invalid-email":this.notificationService.error("Invalid email address format.");break;default:this.notificationService.error(t.message||"Registration failed. Please try again.")}}handleGoogleSignInError(t){console.error("Google sign-in error:",t),this.securityService.logSecurityEvent(En.LOGIN_FAILED,Tn.MEDIUM,{method:"google",error:t.message||"Unknown error",timestamp:new Date().toISOString()}),t.code==="auth/popup-closed-by-user"?this.notificationService.error("Sign-in was cancelled. Please try again."):t.code==="auth/popup-blocked"?this.notificationService.error("Popup was blocked. Please allow popups for this site and try again."):t.code==="auth/cancelled-popup-request"?this.notificationService.error("Sign-in request was cancelled. Please try again."):this.notificationService.error("Google sign-in failed. Please try again or use email sign-in.")}handleSecurityError(t,r){switch(t){case"unauthorized":this.notificationService.error("Session expired. Please sign in again.");break;case"insufficient_permissions":this.notificationService.error("You do not have permission to access that page.");break;case"security_error":this.notificationService.error(r||"A security error occurred.");break;case"auth_failed":this.notificationService.error("Authentication failed. Please try again.");break;default:this.notificationService.error("An error occurred. Please try again.")}}isRateLimited(){let r=Date.now()-this.lastLoginAttempt;return r<this.rateLimitWindow&&this.loginAttemptCount>=this.maxAttemptsPerWindow?!0:(r>=this.rateLimitWindow&&(this.loginAttemptCount=0),!1)}calculateLockoutTime(){let t=this.userService.getSecurityStatus();if(t&&t.lockoutTime){let r=Date.now();this.lockoutTimeRemaining=Math.max(0,t.lockoutTime-r)}}calculatePasswordStrength(t){if(!t)return 0;let r=0;return t.length>=8&&r++,/[a-z]/.test(t)&&r++,/[A-Z]/.test(t)&&r++,/[0-9]/.test(t)&&r++,/[^A-Za-z0-9]/.test(t)&&r++,Math.min(r,4)}monitorEmailInput(t){if(!t)return;[/test/i,/admin/i,/root/i,/temp/i,/fake/i].some(a=>a.test(t))&&this.securityService.logSecurityEvent(En.SUSPICIOUS_ACTIVITY,Tn.MEDIUM,{type:"suspicious_email",email:t,timestamp:new Date().toISOString()})}emailDomainValidator(t){if(!t.value)return null;let r=t.value.toLowerCase(),a=["tempmail.org","10minutemail.com","guerrillamail.com","mailinator.com","throwaway.email","temp-mail.org"],o=r.split("@")[1];return a.includes(o)?{disposableEmail:!0}:null}passwordStrengthValidator(t){if(!t.value)return null;let r=t.value,a=8,o=/[A-Z]/.test(r),s=/[a-z]/.test(r),u=/\d/.test(r),m=/[!@#$%^&*(),.?":{}|<>]/.test(r);return r.length<a?{minLength:{requiredLength:a,actualLength:r.length}}:!o||!s||!u||!m?{passwordStrength:!0}:null}markFormGroupTouched(){Object.keys(this.signInForm.controls).forEach(t=>{let r=this.signInForm.get(t);r==null||r.markAsTouched()})}togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}getPasswordStrengthText(){switch(this.passwordStrength){case 0:return"Very Weak";case 1:return"Weak";case 2:return"Fair";case 3:return"Good";case 4:return"Strong";default:return"Very Weak"}}getPasswordStrengthColor(){switch(this.passwordStrength){case 0:return"text-red-500";case 1:return"text-orange-500";case 2:return"text-yellow-500";case 3:return"text-blue-500";case 4:return"text-green-500";default:return"text-red-500"}}getLockoutTimeRemaining(){return Math.ceil(this.lockoutTimeRemaining/6e4)}gotoPage(){this._setIsSignInPage(!this.isSignInPage)}_setIsSignInPage(t){this.isSignInPage=t,this.isSignInPage?(this.signInForm.removeControl("confirmPassword"),this.signInForm.removeControl("name")):(this.signInForm.addControl("confirmPassword",this.fb.control("",[Qe.required])),this.signInForm.addControl("name",this.fb.control("",[Qe.required,Qe.minLength(2)])))}};n.\u0275fac=function(r){return new(r||n)(q(Ii),q(Kt),q(r1),q(gi),q(ht),q(Jx),q(qr),q(wt))},n.\u0275cmp=Ve({type:n,selectors:[["app-sign-in"]],decls:56,vars:39,consts:[[1,"flex","items-center","min-h-screen","bg-blue-100","p-4"],[1,"flex","w-full","max-w-sm","mx-auto","bg-white","rounded-lg","shadow-lg","dark:bg-gray-800","lg:max-w-4xl","min-h-[600px]","max-h-[90vh]","overflow-hidden"],[1,"hidden","bg-cover","lg:flex","lg:w-1/2","items-center","bg-blue-50"],[1,"bg"],[1,"w-full","px-4","py-6","md:px-6","lg:w-1/2","lg:px-8","overflow-y-auto"],[1,"flex","justify-center","mx-auto"],["src","assets/images/logo.svg","alt","Logo","loading","eager",1,"w-auto","h-16","md:h-20"],[1,"mt-3","text-lg","md:text-xl","text-center","text-gray-600","dark:text-gray-200"],["class","mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg",4,"ngIf"],["class","mt-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded-lg",4,"ngIf"],["appSecurity","moderate",1,"form-container","mt-6",3,"formGroup"],[1,"space-y-4"],["for","LoggingEmailAddress",1,"block","mb-2","text-sm","font-medium","text-gray-600","dark:text-gray-200"],["id","LoggingEmailAddress","formControlName","email","type","email","autocomplete","email",1,"block","w-full","px-4","py-2","text-gray-700","bg-white","border","rounded-lg","dark:bg-gray-800","dark:text-gray-300","dark:border-gray-600","focus:border-blue-400","focus:ring-opacity-40","dark:focus:border-blue-300","focus:outline-none","focus:ring","focus:ring-blue-300"],["class","text-red-500 text-sm mt-1",4,"ngIf"],[4,"ngIf"],[1,"flex","justify-between","items-center","mb-2"],["for","loggingPassword",1,"block","text-sm","font-medium","text-gray-600","dark:text-gray-200"],["class","text-xs text-gray-500 dark:text-gray-300 hover:underline",4,"ngIf"],[1,"relative"],["id","loggingPassword","formControlName","password","autocomplete","current-password",1,"block","w-full","px-4","py-2","pr-10","text-gray-700","bg-white","border","rounded-lg","dark:bg-gray-800","dark:text-gray-300","dark:border-gray-600","focus:border-blue-400","focus:ring-opacity-40","dark:focus:border-blue-300","focus:outline-none","focus:ring","focus:ring-blue-300",3,"type"],["type","button",1,"absolute","inset-y-0","right-0","pr-3","flex","items-center","text-gray-400","hover:text-gray-600",3,"click"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","mt-2",4,"ngIf"],[1,"mt-6","space-y-4"],[1,"w-full","px-6","py-3","text-sm","font-medium","tracking-wide","text-white","capitalize","transition-colors","duration-300","transform","bg-primary","rounded-lg","hover:bg-primary800","focus:outline-none","focus:ring","focus:ring-gray-300","focus:ring-opacity-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-center"],["diameter","20","class","mr-2",4,"ngIf"],["type","button",1,"w-full","px-6","py-3","text-sm","font-medium","tracking-wide","text-gray-600","capitalize","transition-colors","duration-300","transform","border","border-gray-300","rounded-lg","hover:bg-gray-50","dark:border-gray-600","dark:text-gray-200","dark:hover:bg-gray-700","focus:outline-none","focus:ring","focus:ring-gray-300","focus:ring-opacity-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","w-5 h-5 mr-2 flex-shrink-0","viewBox","0 0 40 40",4,"ngIf"],["diameter","20","class","mr-2 text-blue-500",4,"ngIf"],[1,"whitespace-nowrap"],[1,"flex","items-center","justify-between","mt-6"],[1,"w-1/5","border-b","dark:border-gray-600","md:w-1/4"],[1,"text-xs","text-gray-500","uppercase","dark:text-gray-400","hover:underline","cursor-pointer",3,"click"],["class","mt-4 p-2 bg-gray-50 border border-gray-200 rounded-md security-notice",4,"ngIf"],[1,"mt-4","p-3","bg-red-100","border","border-red-400","text-red-700","rounded-lg"],[1,"flex","items-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","mr-2","flex-shrink-0"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"font-medium"],[1,"mt-1","text-sm"],["class","mt-1 text-sm",4,"ngIf"],[1,"mt-4","p-3","bg-yellow-100","border","border-yellow-400","text-yellow-700","rounded-lg"],["fill-rule","evenodd","d","M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"text-red-500","text-sm","mt-1"],["for","userName",1,"block","mb-2","text-sm","font-medium","text-gray-600","dark:text-gray-200"],["id","userName","formControlName","name","type","text","autocomplete","name",1,"block","w-full","px-4","py-2","text-gray-700","bg-white","border","rounded-lg","dark:bg-gray-800","dark:text-gray-300","dark:border-gray-600","focus:border-blue-400","focus:ring-opacity-40","dark:focus:border-blue-300","focus:outline-none","focus:ring","focus:ring-blue-300"],[1,"text-xs","text-gray-500","dark:text-gray-300","hover:underline"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"],[1,"mt-2"],[1,"flex","items-center","justify-between","text-sm"],[1,"mt-1","w-full","bg-gray-200","rounded-full","h-2"],[1,"h-2","rounded-full","transition-all","duration-300",3,"ngClass"],[1,"mt-1","text-xs","text-gray-500"],["for","confirmPassword",1,"block","mb-2","text-sm","font-medium","text-gray-600","dark:text-gray-200"],["id","confirmPassword","formControlName","confirmPassword","autocomplete","new-password",1,"block","w-full","px-4","py-2","pr-10","text-gray-700","bg-white","border","rounded-lg","dark:bg-gray-800","dark:text-gray-300","dark:border-gray-600","focus:border-blue-400","focus:ring-opacity-40","dark:focus:border-blue-300","focus:outline-none","focus:ring","focus:ring-blue-300",3,"type"],["diameter","20",1,"mr-2"],["viewBox","0 0 40 40",1,"w-5","h-5","mr-2","flex-shrink-0"],["d","M36.3425 16.7358H35V16.6667H20V23.3333H29.4192C28.045 27.2142 24.3525 30 20 30C14.4775 30 10 25.5225 10 20C10 14.4775 14.4775 9.99999 20 9.99999C22.5492 9.99999 24.8683 10.9617 26.6342 12.5325L31.3483 7.81833C28.3717 5.04416 24.39 3.33333 20 3.33333C10.7958 3.33333 3.33335 10.7958 3.33335 20C3.33335 29.2042 10.7958 36.6667 20 36.6667C29.2042 36.6667 36.6667 29.2042 36.6667 20C36.6667 18.8825 36.5517 17.7917 36.3425 16.7358Z","fill","#FFC107"],["d","M5.25497 12.2425L10.7308 16.2583C12.2125 12.59 15.8008 9.99999 20 9.99999C22.5491 9.99999 24.8683 10.9617 26.6341 12.5325L31.3483 7.81833C28.3716 5.04416 24.39 3.33333 20 3.33333C13.5983 3.33333 8.04663 6.94749 5.25497 12.2425Z","fill","#FF3D00"],["d","M20 36.6667C24.305 36.6667 28.2167 35.0192 31.1742 32.34L26.0159 27.975C24.3425 29.2425 22.2625 30 20 30C15.665 30 11.9842 27.2359 10.5975 23.3784L5.16254 27.5659C7.92087 32.9634 13.5225 36.6667 20 36.6667Z","fill","#4CAF50"],["d","M36.3425 16.7358H35V16.6667H20V23.3333H29.4192C28.7592 25.1975 27.56 26.805 26.0133 27.9758C26.0142 27.975 26.015 27.975 26.0158 27.9742L31.1742 32.3392C30.8092 32.6708 36.6667 28.3333 36.6667 20C36.6667 18.8825 36.5517 17.7917 36.3425 16.7358Z","fill","#1976D2"],["diameter","20",1,"mr-2","text-blue-500"],[1,"mt-4","p-2","bg-gray-50","border","border-gray-200","rounded-md","security-notice"],["fill","currentColor","viewBox","0 0 16 16",1,"w-3","h-3","mr-1.5","text-gray-500","flex-shrink-0"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0-1A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"],["d","M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"],[1,"text-xs","text-gray-600","font-medium"],[1,"mt-0.5","text-xs","text-gray-500"]],template:function(r,a){if(r&1&&(c(0,"section",0)(1,"div",1)(2,"div",2),se(3,"div",3),l(),c(4,"div",4)(5,"div",5),se(6,"img",6),l(),c(7,"p",7),d(8),pe(9,"translate"),l(),X(10,yP,9,1,"div",8)(11,MP,8,2,"div",9),c(12,"form",10)(13,"div",11)(14,"div")(15,"label",12),d(16),pe(17,"translate"),l(),se(18,"input",13),X(19,OP,4,3,"div",14),l(),X(20,IP,5,2,"div",15),c(21,"div")(22,"div",16)(23,"label",17),d(24),pe(25,"translate"),l(),X(26,AP,2,0,"a",18),l(),c(27,"div",19),se(28,"input",20),c(29,"button",21),N("click",function(){return a.togglePasswordVisibility()}),X(30,DP,3,0,"svg",22)(31,FP,2,0,"svg",22),l()(),X(32,NP,10,12,"div",23)(33,UP,4,3,"div",14),l(),X(34,GP,10,8,"div",15),l(),c(35,"div",24)(36,"button",25),N("click",function(){return a.isSignInPage?a.onSignIn():a.onSignUp()}),c(37,"div",26),X(38,HP,1,0,"mat-spinner",27)(39,qP,4,5,"span",15)(40,XP,2,1,"span",15),l()(),c(41,"button",28),N("click",function(){return a.signInWithGoogle()}),c(42,"div",26),X(43,KP,5,0,"svg",29)(44,ZP,1,0,"mat-spinner",30),c(45,"span",31),d(46),pe(47,"translate"),l()()()(),c(48,"div",32),se(49,"span",33),c(50,"a",34),N("click",function(){return a.gotoPage()}),d(51),pe(52,"translate"),pe(53,"translate"),l(),se(54,"span",33),l(),X(55,JP,9,0,"div",35),l()()()()),r&2){let o,s,u;p(8),oe(" ",Ee(9,27,"welcomeBack")," "),p(2),w("ngIf",a.isAccountLocked),p(),w("ngIf",!a.isAccountLocked&&a.loginAttempts>0),p(),w("formGroup",a.signInForm),p(4),oe(" ",Ee(17,29,"email")," Address "),p(2),ga("data-security-level",a.securityLevel),p(),w("ngIf",((o=a.signInForm.get("email"))==null?null:o.invalid)&&((o=a.signInForm.get("email"))==null?null:o.touched)),p(),w("ngIf",!a.isSignInPage),p(4),z(Ee(25,31,"password")),p(2),w("ngIf",a.isSignInPage),p(2),w("type",a.showPassword?"text":"password"),ga("data-security-level",a.securityLevel),p(2),w("ngIf",!a.showPassword),p(),w("ngIf",a.showPassword),p(),w("ngIf",!a.isSignInPage&&((s=a.signInForm.get("password"))==null?null:s.value)),p(),w("ngIf",((u=a.signInForm.get("password"))==null?null:u.invalid)&&((u=a.signInForm.get("password"))==null?null:u.touched)),p(),w("ngIf",!a.isSignInPage),p(2),w("disabled",a.isLoading||a.isAccountLocked||a.signInForm.invalid),p(2),w("ngIf",a.isLoading),p(),w("ngIf",!a.isLoading),p(),w("ngIf",a.isLoading),p(),w("disabled",a.isLoading||a.isAccountLocked),p(2),w("ngIf",!a.isLoading),p(),w("ngIf",a.isLoading),p(2),z(a.isLoading?"Signing in...":Ee(47,33,"signIn")+" with Google"),p(5),oe("or ",a.isSignInPage?Ee(52,35,"signUp"):Ee(53,37,"signIn"),""),p(4),w("ngIf",a.showSecurityNotice)}},dependencies:[br,ct,jn,Vt,Ut,Un,Ei,Ti,Xr,Sd],styles:['.bg[_ngcontent-%COMP%]{background-image:url("./media/sign-in-TAB6YH4B.png");background-size:contain;background-repeat:no-repeat;background-position:center;height:100%;width:100%;min-height:400px}.security-notice[_ngcontent-%COMP%]{opacity:0;transform:translateY(10px);animation:_ngcontent-%COMP%_fadeInUp .3s ease-out forwards}@keyframes _ngcontent-%COMP%_fadeInUp{to{opacity:1;transform:translateY(0)}}.form-container[_ngcontent-%COMP%]{will-change:transform;contain:layout style paint}@media (max-width: 768px){.bg[_ngcontent-%COMP%]{min-height:300px}}@media (max-width: 480px){.bg[_ngcontent-%COMP%]{min-height:250px}}']});let e=n;return e})();var e_=(()=>{let n=class n{constructor(t,r,a,o,s){this.dialog=t,this.store=r,this.splitwiseService=a,this.userService=o,this.dateService=s}checkAndShowInvitations(){return ue(this,null,function*(){try{let t=yield this.userService.getCurrentUser();if(!(t!=null&&t.uid))return;let r=yield this.splitwiseService.getUserInvitations(t.uid).toPromise();if(r&&r.length>0){let a=r.filter(o=>!this.isInvitationExpired(o));a.length>0&&this.showInvitationPopup(a)}}catch(t){console.error("Error checking invitations:",t)}})}showInvitationPopup(t){if(!t||t.length===0)return;let r=this.dialog.open(Kr,{data:{title:"Invitations",message:`You have invitations to Splitwise Groups - ${t.map(a=>a.groupName).join(", ")}. Please accept or decline them.`,confirmText:"Accept",cancelText:"Decline",type:"warning"}});r.afterClosed().subscribe(()=>{r.componentInstance.data.confirmText==="Accept"?this.store.dispatch(nx({invitationId:t[0].id})):r.componentInstance.data.confirmText==="Decline"&&this.store.dispatch(ix({invitationId:t[0].id}))})}isInvitationExpired(t){if(!t.expiresAt)return!1;let r=null;return t.expiresAt instanceof Date?r=t.expiresAt:t.expiresAt.toDate?r=t.expiresAt.toDate():r=this.dateService.toDate(t.expiresAt),r?r<new Date:!1}showInvitationsAfterLogin(){return ue(this,null,function*(){setTimeout(()=>{this.checkAndShowInvitations()},1e3)})}};n.\u0275fac=function(r){return new(r||n)(De(fn),De(wt),De(gc),De(gi),De(At))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var bu=(()=>{let n=class n{constructor(t,r){this.firestore=t,this.auth=r,this.isOnlineSubject=new mn(!0),this.isOnline$=this.isOnlineSubject.asObservable()}getCurrentUserId(){var t;return((t=this.auth.currentUser)==null?void 0:t.uid)||null}isAuthenticated(){return!!this.auth.currentUser}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}getCollectionRef(t){let r=this.getCurrentUserId();if(!r)throw new Error(zn.AUTH.SESSION_EXPIRED);return Fr(this.firestore,`users/${r}/${t}`)}getDocumentRef(t,r){let a=this.getCurrentUserId();if(!a)throw new Error(zn.AUTH.SESSION_EXPIRED);return Et(this.firestore,`users/${a}/${t}/${r}`)}handleError(t,r){console.error(`Error in ${r}:`,t);let a=zn.NETWORK.SERVER_ERROR;if(t.code)switch(t.code){case"auth/user-not-found":a=zn.AUTH.USER_NOT_FOUND;break;case"auth/wrong-password":a=zn.AUTH.INVALID_CREDENTIALS;break;case"auth/email-already-in-use":a=zn.AUTH.EMAIL_ALREADY_EXISTS;break;case"auth/weak-password":a=zn.AUTH.WEAK_PASSWORD;break;case"permission-denied":a=zn.PERMISSION.ACCESS_DENIED;break;case"unavailable":a=zn.NETWORK.CONNECTION_ERROR;break;default:a=t.message||zn.NETWORK.SERVER_ERROR}return es(()=>new Error(a))}validateRequiredFields(t,r){let a=r.filter(o=>!t[o]);if(a.length>0)throw new Error(`${zn.VALIDATION.REQUIRED_FIELD}: ${a.join(", ")}`)}validateAmount(t){if(t<Dt.VALIDATION.MIN_AMOUNT||t>Dt.VALIDATION.MAX_AMOUNT)throw new Error(zn.VALIDATION.INVALID_AMOUNT)}validateStringLength(t,r,a,o){if(t.length<r)throw new Error(`${zn.VALIDATION.MIN_LENGTH.replace("{min}",r.toString())} for ${o}`);if(t.length>a)throw new Error(`${zn.VALIDATION.MAX_LENGTH.replace("{max}",a.toString())} for ${o}`)}addSyncStatus(t,r=mi.SYNCED){return le(ae({},t),{syncStatus:r,lastSyncedAt:hl()})}addMetadata(t,r){return le(ae({},t),{createdAt:hl(),updatedAt:hl(),createdBy:r,updatedBy:r})}updateMetadata(t,r){return le(ae({},t),{updatedAt:hl(),updatedBy:r})}cacheData(t,r){try{let a={data:r,timestamp:Date.now(),expiry:Date.now()+Dt.OFFLINE.CACHE_EXPIRY};localStorage.setItem(t,JSON.stringify(a))}catch(a){console.error("Failed to cache data:",a)}}getCachedData(t){try{let r=localStorage.getItem(t);if(!r)return null;let a=JSON.parse(r);return Date.now()>a.expiry?(localStorage.removeItem(t),null):a.data}catch(r){return console.error("Failed to get cached data:",r),null}}clearCachedData(t){try{localStorage.removeItem(t)}catch(r){console.error("Failed to clear cached data:",r)}}debounce(t,r=Dt.PERFORMANCE.DEBOUNCE_DELAY){let a;return(...o)=>{clearTimeout(a),a=setTimeout(()=>t(...o),r)}}throttle(t,r=Dt.PERFORMANCE.THROTTLE_DELAY){let a=0;return(...o)=>{let s=Date.now();s-a>=r&&(a=s,t(...o))}}formatCurrency(t,r="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:r}).format(t)}formatDate(t,r="MM/dd/yyyy"){let a={year:"numeric",month:"2-digit",day:"2-digit"};return new Intl.DateTimeFormat("en-US",a).format(t)}isDataExpired(t,r=Dt.OFFLINE.CACHE_EXPIRY){return Date.now()-t>r}retryOperation(o){return ue(this,arguments,function*(t,r=Dt.OFFLINE.MAX_RETRY_ATTEMPTS,a=1e3){let s;for(let u=0;u<=r;u++)try{return yield t()}catch(m){if(s=m,u===r)throw m;let f=a*Math.pow(2,u);yield new Promise(h=>setTimeout(h,f))}throw s})}};n.\u0275fac=function(r){return new(r||n)(De(Ki),De(pt))},n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})();var yc=(()=>{let n=class n{constructor(t,r){this.firestore=t,this.auth=r}createAccount(t,r){return new qt(a=>{let o=this.generateAccountId(),s=le(ae({accountId:o,userId:t},r),{createdAt:new Date,isActive:!0}),u=Et(this.firestore,`users/${t}/accounts/${o}`);wr(u,s).then(()=>{a.next(o),a.complete()}).catch(m=>{a.error(m)})})}getAccounts(t){let r=Fr(this.firestore,`users/${t}/accounts`);return new qt(a=>{ya(r).then(o=>{let s=[];o.forEach(u=>{s.push(u.data())}),a.next(s)})})}getAccount(t,r){return new qt(a=>{let o=Et(this.firestore,`users/${t}/accounts/${r}`);ai(o).then(s=>{s.exists()?a.next(s.data()):a.next(void 0),a.complete()}).catch(s=>{a.error(s)})})}updateAccount(t,r,a){return new qt(o=>{let s=Et(this.firestore,`users/${t}/accounts/${r}`),u=le(ae({},a),{updatedAt:new Date});kn(s,u).then(()=>{o.next(),o.complete()}).catch(m=>{o.error(m)})})}deleteAccount(t,r){return new qt(a=>{let o=Et(this.firestore,`users/${t}/accounts/${r}`);Di(o).then(()=>{a.next(),a.complete()}).catch(s=>{a.error(s)})})}updateAccountBalanceForTransaction(t,r,a,o,s){return new qt(u=>{ue(this,null,function*(){try{let f=Et(this.firestore,`users/${t}/accounts/${r}`),h=yield ai(f);if(!h.exists()){u.error("Account not found");return}let _=h.data(),y=0,v=0;switch(a){case"create":s&&(y=s.type==="income"?s.amount:-s.amount,_.type==="loan"&&s.type==="expense"&&(v=-s.amount));break;case"update":if(o&&s){let P=o.type==="income"?o.amount:-o.amount;if(y=(s.type==="income"?s.amount:-s.amount)-P,_.type==="loan"){let T=o.type==="expense"?-o.amount:0;v=(s.type==="expense"?-s.amount:0)-T}}break;case"delete":o&&(y=o.type==="income"?-o.amount:o.amount,_.type==="loan"&&o.type==="expense"&&(v=o.amount));break}let C={balance:(_.balance||0)+y,updatedAt:new Date};if(_.type==="loan"&&_.loanDetails&&v!==0){let P=_.loanDetails.remainingBalance||0,D=Math.max(0,P+v);C["loanDetails.remainingBalance"]=D}yield kn(f,C),u.next(C.balance),u.complete()}catch(f){u.error(f)}})})}updateAccountBalanceForTransactions(t,r){return new qt(a=>{ue(this,null,function*(){try{let s=ag(this.firestore),u=new Map,m=new Map;r.forEach(f=>{let h=u.get(f.accountId)||0,_=f.type==="income"?f.amount:-f.amount;if(u.set(f.accountId,h+_),f.type==="expense"){let y=m.get(f.accountId)||0;m.set(f.accountId,y+f.amount)}});for(let[f,h]of u){let _=Et(this.firestore,`users/${t}/accounts/${f}`),y=yield ai(_);if(y.exists()){let v=y.data(),P={balance:(v.balance||0)+h,updatedAt:new Date};if(v.type==="loan"&&v.loanDetails){let D=m.get(f)||0;if(D>0){let T=v.loanDetails.remainingBalance||0,I=Math.max(0,T-D);P["loanDetails.remainingBalance"]=I}}s.update(_,P)}}yield s.commit(),a.next(),a.complete()}catch(s){a.error(s)}})})}updateAccountBalanceForAccountTransfer(t,r,a,o){return new qt(s=>{ue(this,null,function*(){try{let m=ag(this.firestore),f=Et(this.firestore,`users/${t}/accounts/${r}`),h=Et(this.firestore,`users/${t}/accounts/${a}`),[_,y]=yield Promise.all([ai(f),ai(h)]);if(!_.exists()||!y.exists()){s.error("One or both accounts not found");return}let v=_.data(),C=y.data(),P=o.type==="income"?o.amount:-o.amount,D={balance:(v.balance||0)-P,updatedAt:new Date};if(v.type==="loan"&&v.loanDetails&&o.type==="expense"){let K=(v.loanDetails.remainingBalance||0)+o.amount;D["loanDetails.remainingBalance"]=K}let T={balance:(C.balance||0)+P,updatedAt:new Date};if(C.type==="loan"&&C.loanDetails&&o.type==="expense"){let I=C.loanDetails.remainingBalance||0,K=Math.max(0,I-o.amount);T["loanDetails.remainingBalance"]=K}m.update(f,D),m.update(h,T),yield m.commit(),s.next(),s.complete()}catch(m){s.error(m)}})})}generateAccountId(){return"acc_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}};n.\u0275fac=function(r){return new(r||n)(De(Ki),De(pt))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var Ao=(()=>{let n=class n extends bu{constructor(t,r,a,o,s,u,m){super(t,r),this.dateService=a,this.store=o,this.accountsService=s,this.splitwiseService=u,this.commonSyncService=m,this.transactionsSubject=new mn([])}createTransaction(t,r){return new qt(a=>{let o=this.generateId(),s=le(ae({},r),{id:o,date:this.dateService.toDate(r.date),syncStatus:this.commonSyncService.isCurrentlyOnline()?"synced":"pending"});ue(this,null,function*(){try{if(this.commonSyncService.isCurrentlyOnline())try{let m=Et(this.firestore,`users/${t}/transactions/${o}`);yield wr(m,s),r.isSplitTransaction&&r.splitGroupId&&(yield this.createSplitTransaction(r.splitGroupId,r,m.id,t)),this.store.dispatch(po({userId:t,accountId:r.accountId,transactionType:"create",newTransaction:s})),this.store.dispatch(ic({transaction:s})),this.updateTransactionCache(t,"create",s),a.next(),a.complete()}catch(m){console.error("Failed to create transaction online:",m),yield this.addToSyncQueue("create",s),this.store.dispatch(ic({transaction:s})),this.updateTransactionCache(t,"create",s),a.next(),a.complete()}else yield this.addToSyncQueue("create",s),this.store.dispatch(ic({transaction:s})),this.updateTransactionCache(t,"create",s),a.next(),a.complete()}catch(m){console.error("Error in createTransaction:",m),a.error(m)}})})}updateTransaction(t,r,a){return new qt(o=>{ue(this,null,function*(){try{let u=le(ae({},a),{updatedAt:new Date,updatedBy:t,syncStatus:this.commonSyncService.isCurrentlyOnline()?"synced":"pending"});if(this.commonSyncService.isCurrentlyOnline())try{let m=Et(this.firestore,`users/${t}/transactions/${r}`);yield kn(m,u),(a.amount||a.accountId)&&this.store.dispatch(po({userId:t,accountId:a.accountId||"",transactionType:"update",oldTransaction:{id:r},newTransaction:u})),this.store.dispatch(rc({transaction:ae({id:r},u)})),this.updateTransactionCache(t,"update",ae({id:r},u)),o.next(),o.complete()}catch(m){console.error("Failed to update transaction online:",m),yield this.addToSyncQueue("update",ae({id:r},u)),this.store.dispatch(rc({transaction:ae({id:r},u)})),this.updateTransactionCache(t,"update",ae({id:r},u)),o.next(),o.complete()}else yield this.addToSyncQueue("update",ae({id:r},u)),this.store.dispatch(rc({transaction:ae({id:r},u)})),this.updateTransactionCache(t,"update",ae({id:r},u)),o.next(),o.complete()}catch(u){o.error(u)}})})}deleteTransaction(t,r){return new qt(a=>{ue(this,null,function*(){try{let s=Et(this.firestore,`users/${t}/transactions/${r}`),u=yield ai(s),m=u.exists()?ae({id:u.id},u.data()):null;if(this.commonSyncService.isCurrentlyOnline())try{yield Di(s),m&&(this.store.dispatch(po({userId:t,accountId:m.accountId,transactionType:"delete",oldTransaction:m})),m.isSplitTransaction&&(yield this.splitwiseService.deleteSplitTransaction(m.id,t))),this.store.dispatch(_o({transactionId:r})),this.updateTransactionCache(t,"delete",{id:r}),a.next(),a.complete()}catch(f){console.error("Failed to delete transaction online:",f),yield this.addToSyncQueue("delete",{id:r}),this.store.dispatch(_o({transactionId:r})),this.updateTransactionCache(t,"delete",{id:r}),a.next(),a.complete()}else yield this.addToSyncQueue("delete",{id:r}),this.store.dispatch(_o({transactionId:r})),this.updateTransactionCache(t,"delete",{id:r}),a.next(),a.complete()}catch(s){a.error(s)}})})}getTransactions(t){let r=rg(Fr(this.firestore,`users/${t}/transactions`),ig("date","desc"));return new qt(a=>{let o=ng(r,s=>{let u=[];if(s.forEach(m=>{let f=ae({id:m.id},m.data());u.push(f)}),!this.commonSyncService.isCurrentlyOnline()){let m=this.getCachedTransactions(t),f=m.map(y=>y.id),h=u.map(y=>y.id),_=m.filter(y=>y.id&&!h.includes(y.id));u.push(..._)}this.cacheTransactions(t,u),this.transactionsSubject.next(u),a.next(u)},s=>{if(console.error("Failed to fetch transactions:",s),this.commonSyncService.isCurrentlyOnline())a.next([]);else{let u=this.getCachedTransactions(t);this.transactionsSubject.next(u),a.next(u)}});return()=>o()})}getTransaction(t,r){return new qt(a=>{ue(this,null,function*(){try{let s=Et(this.firestore,`users/${t}/transactions/${r}`),u=yield ai(s);if(u.exists()){let m=ae({id:u.id},u.data());a.next(m)}else a.next(void 0);a.complete()}catch(s){a.error(s)}})})}getSyncStatus(){let t=this.commonSyncService.syncStatus;return{count:t.pendingItems,hasPendingOperations:t.pendingItems>0}}forceSync(){return ue(this,null,function*(){yield this.commonSyncService.manualSync()})}getRecurringTransactions(t){let r=rg(Fr(this.firestore,`users/${t}/transactions`),ig("date","desc"));return new qt(a=>{let o=ng(r,s=>{let u=[];s.forEach(f=>{let h=ae({id:f.id},f.data());u.push(h)});let m=u.filter(f=>f.isRecurring===!0);a.next(m)},s=>{console.error("Failed to fetch recurring transactions:",s),a.next([])});return()=>o()})}getDueRecurringTransactions(t){return this.getRecurringTransactions(t).pipe(rt(r=>{let a=new Date;return a.setHours(0,0,0,0),r.filter(o=>{if(!o.nextOccurrence)return!1;let s=o.nextOccurrence instanceof Date?o.nextOccurrence:this.dateService.toDate(o.nextOccurrence);return s==null||s.setHours(0,0,0,0),s&&s<=a})}))}processRecurringTransaction(t,r){return new qt(a=>{ue(this,null,function*(){try{let s=le(ae({},r),{date:new Date,nextOccurrence:void 0,isRecurring:!1,recurringInterval:void 0,recurringEndDate:void 0,createdAt:new Date,updatedAt:new Date,createdBy:t,updatedBy:t,syncStatus:mi.SYNCED,isPending:!1,lastSyncedAt:new Date});if(yield this.createTransaction(t,s).toPromise(),r.recurringInterval&&r.nextOccurrence){let u=this.calculateNextOccurrence(r.recurringInterval,r.nextOccurrence),m={nextOccurrence:u,updatedAt:new Date,updatedBy:t};r.recurringEndDate&&u>r.recurringEndDate&&(m.isRecurring=!1,m.recurringInterval=void 0,m.recurringEndDate=void 0),yield this.updateTransaction(t,r.id,m).toPromise()}a.next(),a.complete()}catch(s){console.error("Failed to process recurring transaction:",s),a.error(s)}})})}calculateNextOccurrence(t,r){let a=r instanceof Date?r:r.toDate(),o=new Date(a);switch(t){case Hr.DAILY:o.setDate(o.getDate()+1);break;case Hr.WEEKLY:o.setDate(o.getDate()+7);break;case Hr.MONTHLY:o.setMonth(o.getMonth()+1);break;case Hr.YEARLY:o.setFullYear(o.getFullYear()+1);break;default:o.setDate(o.getDate()+1)}return o}createSplitTransaction(t,r,a,o){return ue(this,null,function*(){try{let s={groupId:t,originalTransactionId:a,amount:r.amount,splits:r.splits||[]};yield this.splitwiseService.createSplitTransaction(s,o).toPromise()}catch(s){console.error("Failed to create split transaction:",s)}})}addToSyncQueue(t,r){return ue(this,null,function*(){let a={id:this.generateId(),type:"transaction",operation:t,data:r,maxRetries:3},o=yield this.commonSyncService.registerSyncItem(a);o.success||console.error("Failed to register transaction for sync:",o.errors)})}getCachedTransactions(t){try{let r=localStorage.getItem(`transactions-cache-${t}`);if(r)return JSON.parse(r).filter(o=>o&&o.id)}catch(r){console.error("Error loading cached transactions:",r)}return[]}cacheTransactions(t,r){try{localStorage.setItem(`transactions-cache-${t}`,JSON.stringify(r))}catch(a){console.error("Error caching transactions:",a)}}updateTransactionCache(t,r,a){try{let o=this.getCachedTransactions(t);switch(r){case"create":a&&o.push(a);break;case"update":if(a){let s=o.findIndex(u=>u.id===a.id);s!==-1&&(o[s]=a)}break;case"delete":if(a){let s=o.findIndex(u=>u.id===a.id);s!==-1&&o.splice(s,1)}break}this.cacheTransactions(t,o)}catch(o){console.error("Error updating transaction cache:",o)}}isFirebaseValidationError(t){var r,a;return t&&(t.code==="permission-denied"||t.code==="unavailable"||t.code==="invalid-argument"||((r=t.message)==null?void 0:r.includes("permission"))||((a=t.message)==null?void 0:a.includes("validation")))}};n.\u0275fac=function(r){return new(r||n)(De(Ki),De(pt),De(At),De(wt),De(yc),De(gc),De(Rr))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var t_=(()=>{let n=class n{constructor(t,r,a,o){this.transactionsService=t,this.userService=r,this.notificationService=a,this.dialog=o}checkDueRecurringTransactions(){var r;let t=(r=this.userService.userAuth$.value)==null?void 0:r.uid;return t?this.transactionsService.getDueRecurringTransactions(t).pipe(zr(a=>a.length===0?lt(void 0):this.showRecurringTransactionConfirmation(a))):lt(void 0)}showRecurringTransactionConfirmation(t){return new qt(r=>{this.dialog.open(dx,{width:"400px",data:{transactions:t},disableClose:!0}).afterClosed().subscribe(o=>{o&&o.action==="confirm"?this.processConfirmedTransactions(o.transactions).subscribe({next:()=>{this.notificationService.success("Recurring transactions processed successfully"),r.next(),r.complete()},error:s=>{this.notificationService.error("Failed to process recurring transactions"),r.error(s)}}):(r.next(),r.complete())})})}processConfirmedTransactions(t){var a;let r=(a=this.userService.userAuth$.value)==null?void 0:a.uid;return r?new qt(o=>{let s=0,u=t.length,m=()=>{if(s>=u){o.next(),o.complete();return}let f=t[s];this.transactionsService.processRecurringTransaction(r,f).subscribe({next:()=>{s++,m()},error:h=>{console.error(`Failed to process transaction ${f.id}:`,h),s++,m()}})};m()}):lt(void 0)}getRecurringTransactions(t){return this.transactionsService.getRecurringTransactions(t)}getRecurringTransactionsSummary(t){return this.transactionsService.getRecurringTransactions(t).pipe(rt(r=>{let a=new Date;a.setHours(0,0,0,0);let o=r.filter(u=>{if(!u.nextOccurrence)return!1;let m=u.nextOccurrence instanceof Date?u.nextOccurrence:u.nextOccurrence.toDate();return m.setHours(0,0,0,0),m<=a}).length,s=r.filter(u=>{if(!u.nextOccurrence)return!1;let m=u.nextOccurrence instanceof Date?u.nextOccurrence:u.nextOccurrence.toDate();return m.setHours(0,0,0,0),m>a}).length;return{total:r.length,due:o,upcoming:s}}))}};n.\u0275fac=function(r){return new(r||n)(De(Ao),De(gi),De(ht),De(fn))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var tO=[{label:"Navigation",icon:"navigation",order:1,isExpanded:!0,isCollapsible:!0,children:[{label:"dashboard",route:"/dashboard/home",icon:"dashboard",order:1},{label:"accounts",route:"/dashboard/accounts",icon:"account_balance",order:2},{label:"transactions",route:"/dashboard/transactions",icon:"receipt_long",order:3},{label:"categories",route:"/dashboard/category",icon:"category",order:4},{label:"reports",route:"/dashboard/reports",icon:"analytics",order:7}]},{label:"Tools",icon:"build",order:2,isExpanded:!0,isCollapsible:!0,children:[{label:"tax",route:"/dashboard/tax",icon:"calculate",order:3},{label:"Splitwise",route:"/dashboard/splitwise",icon:"group",order:4},{label:"Google Sheets",route:"/dashboard/google-sheets",icon:"table_chart",order:5}]},{label:"Account",icon:"person",order:3,isExpanded:!0,isCollapsible:!0,children:[{label:"Profile",route:"/dashboard/profile",icon:"account_circle",order:1},{label:"Notifications",route:"/dashboard/notifications",icon:"notifications",order:3},{label:"Feedback",route:"/dashboard/feedback",icon:"feedback",order:4}]},{label:"Admin",icon:"admin_panel_settings",order:4,isExpanded:!1,isCollapsible:!0,children:[{label:"admin_panel",route:"/admin",icon:"admin_panel_settings",order:1}]}],n_=()=>tO.sort((e,n)=>e.order-n.order);var nO=["drawer"],iO=(e,n)=>n.label,rO=(e,n)=>n.route;function aO(e,n){if(e&1&&(c(0,"mat-icon",32),d(1," expand_more "),l()),e&2){let i=S(2).$implicit;Je("rotate-180",!i.isExpanded)}}function oO(e,n){if(e&1){let i=be();c(0,"div",27),N("click",function(){G(i);let r=S().$implicit,a=S();return H(a.toggleSection(r))}),c(1,"div",28)(2,"mat-icon",29),d(3),l(),c(4,"h6",30),d(5),l()(),X(6,aO,2,2,"mat-icon",31),l()}if(e&2){let i=S().$implicit;Je("cursor-pointer",i.isCollapsible)("cursor-default",!i.isCollapsible)("hover:bg-blue-50",i.isCollapsible),p(3),z(i.icon),p(2),z(i.label),p(),w("ngIf",i.isCollapsible)}}function sO(e,n){e&1&&(c(0,"div",38)(1,"mat-icon",39),d(2,"star"),l()())}function cO(e,n){if(e&1){let i=be();c(0,"a",33),N("click",function(){G(i),S(2);let r=Gn(2);return H(r.toggle())}),se(1,"div",34),c(2,"mat-icon",35),d(3),l(),c(4,"span",36),d(5),pe(6,"translate"),l(),X(7,sO,3,0,"div",37),l()}if(e&2){let i=n.$implicit,t=S(2);w("routerLink",i.route),p(),Je("opacity-100",t.router.isActive(i.route,!1)),p(2),z(i.icon),p(2),z(Ee(6,6,i.label)),p(2),w("ngIf",t.isPremiumRoute(i.route))}}function lO(e,n){e&1&&se(0,"div",40)}function dO(e,n){if(e&1&&(c(0,"div",12),X(1,oO,7,9,"div",23),c(2,"div",24),Ge(3,cO,8,8,"a",25,rO),l(),X(5,lO,1,0,"div",26),l()),e&2){let i=n.$implicit,t=S();p(),w("ngIf",i.label=="Admin"&&t.isAdmin),p(),Je("max-h-0",!i.isExpanded)("max-h-96",i.isExpanded)("opacity-0",!i.isExpanded)("opacity-100",i.isExpanded),p(),He(i.children),p(2),w("ngIf",i!==t.navigationSections[t.navigationSections.length-1])}}var i_=(()=>{let n=class n{constructor(t,r,a,o){this.auth=t,this.router=r,this.elementRef=a,this.userService=o,this.isAdmin=!1,this.navigationSections=[],this.navigationSections=n_()}ngOnInit(){this.isAdmin=this.userService.isAdmin}toggleSection(t){t.isCollapsible&&(t.isExpanded=!t.isExpanded)}ngAfterViewInit(){document.addEventListener("click",this.handleDocumentClick.bind(this))}handleKeyDown(t){t.key==="Escape"&&this.drawer&&this.drawer.opened&&this.drawer.close()}handleDocumentClick(t){if(this.drawer&&this.drawer.opened){let r=t.target;this.elementRef.nativeElement.contains(r)||r.closest('button[aria-label="Open sidebar"]')||this.drawer.close()}}logout(){return ue(this,null,function*(){yield this.auth.signOut(),this.router.navigate(["/sign-in"],{queryParams:{loggedOut:"true"}})})}isPremiumRoute(t){return["/dashboard/google-sheets","/dashboard/reports","/dashboard/tax","/dashboard/goals","/dashboard/budgets"].includes(t)}};n.\u0275fac=function(r){return new(r||n)(q(pt),q(Kt),q(Ws),q(gi))},n.\u0275cmp=Ve({type:n,selectors:[["side-bar"]],viewQuery:function(r,a){if(r&1&&Ir(nO,5),r&2){let o;Ar(o=Dr())&&(a.drawer=o.first)}},hostBindings:function(r,a){r&1&&N("keydown",function(s){return a.handleKeyDown(s)},!1,E0)},decls:38,vars:7,consts:[["drawer",""],[1,"example-container","!z-[999]","h-screen"],[1,"!fixed","bg-white","shadow-2xl","w-72","border-r","border-gray-100","backdrop-blur-sm",3,"mode"],[1,"h-full","flex","flex-col","overflow-auto"],[1,"flex","items-center","justify-between","p-5","border-b","border-gray-100","bg-gradient-to-r","from-gray-50","to-white"],[1,"flex","items-center","gap-3"],["routerLink","/dashboard",1,"w-8","h-8","bg-gradient-to-br","bg-primary","rounded-lg","flex","items-center","justify-center","cursor-pointer"],[1,"text-[2rem]","!h-[33px]","!w-[33px]"],[1,"text-lg","font-semibold","text-gray-900"],["mat-icon-button","","routerLink","/dashboard","aria-label","Close sidebar",1,"text-gray-400","hover:text-gray-600","hover:bg-gray-50","rounded-lg","transition-colors",3,"click"],["mat-icon-button","","aria-label","Close sidebar",1,"text-gray-400","hover:text-gray-600","hover:bg-gray-50","rounded-lg","transition-colors",3,"click"],[1,"flex-1","p-4"],[1,"mb-6"],[1,"p-5","border-t","border-gray-100","bg-gradient-to-r","from-white","to-gray-50"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-2"],[1,"text-gray-400","text-sm"],[1,"text-xs","text-gray-500"],["mat-icon-button","","matTooltip","Logout",1,"text-gray-400","hover:text-red-600","hover:bg-red-50","rounded-lg","transition-colors",3,"click"],[1,"text-sm"],[1,"!overflow-hidden"],["aria-label","Open sidebar",1,"flex","items-center","gap-2","px-3","py-2","rounded-lg","hover:bg-gray-200","transition-colors",3,"click"],[1,"text-gray-600"],["class","flex items-center justify-between mb-3 cursor-pointer hover:bg-gray-50 rounded-lg p-2.5 transition-all duration-200 group",3,"cursor-pointer","cursor-default","hover:bg-blue-50","click",4,"ngIf"],[1,"space-y-1","overflow-hidden","transition-all","duration-300","ease-in-out"],["routerLinkActive","bg-blue-50 text-blue-700 border-r-2 border-blue-600 shadow-sm",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-lg","hover:bg-gray-50","hover:shadow-sm","transition-all","duration-200","group","relative",3,"routerLink"],["class","mt-6 pt-4 border-t border-gray-100",4,"ngIf"],[1,"flex","items-center","justify-between","mb-3","cursor-pointer","hover:bg-gray-50","rounded-lg","p-2.5","transition-all","duration-200","group",3,"click"],[1,"flex","items-center","gap-2.5"],[1,"text-gray-500","text-[1.5rem]","group-hover:text-blue-600","transition-colors","relative","top-[-7px]"],[1,"text-xs","font-semibold","text-gray-600","uppercase","tracking-wider","group-hover:text-blue-700","transition-colors"],["class","text-gray-400 text-sm transition-all duration-200 group-hover:text-blue-600",3,"rotate-180",4,"ngIf"],[1,"text-gray-400","text-sm","transition-all","duration-200","group-hover:text-blue-600"],["routerLinkActive","bg-blue-50 text-blue-700 border-r-2 border-blue-600 shadow-sm",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-lg","hover:bg-gray-50","hover:shadow-sm","transition-all","duration-200","group","relative",3,"click","routerLink"],[1,"absolute","left-0","top-1/2","transform","-translate-y-1/2","w-1","h-6","bg-blue-600","rounded-r-full","opacity-0","transition-opacity","duration-200"],[1,"text-gray-400","group-hover:text-blue-600","transition-colors","text-lg","ml-1"],[1,"font-medium","text-sm","text-gray-700","group-hover:text-blue-700","transition-colors"],["class","ml-auto",4,"ngIf"],[1,"ml-auto"],[1,"text-yellow-500","text-sm"],[1,"mt-6","pt-4","border-t","border-gray-100"]],template:function(r,a){if(r&1){let o=be();c(0,"mat-drawer-container",1)(1,"mat-drawer",2,0)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"mat-icon",7),d(8,"account_balance_wallet"),l()(),c(9,"span",8),d(10),pe(11,"translate"),l()(),c(12,"div",5)(13,"button",9),N("click",function(){G(o);let u=Gn(2);return H(u.toggle())}),c(14,"mat-icon"),d(15,"home"),l()(),c(16,"button",10),N("click",function(){G(o);let u=Gn(2);return H(u.toggle())}),c(17,"mat-icon"),d(18,"close"),l()()()(),c(19,"nav",11),Ge(20,dO,6,10,"div",12,iO),l(),c(22,"div",13)(23,"div",14)(24,"div",15)(25,"mat-icon",16),d(26,"settings"),l(),c(27,"span",17),d(28),pe(29,"translate"),l()(),c(30,"button",18),N("click",function(){return G(o),H(a.logout())}),c(31,"mat-icon",19),d(32,"logout"),l()()()()()(),c(33,"mat-drawer-content",20)(34,"div")(35,"button",21),N("click",function(){G(o);let u=Gn(2);return H(u.toggle())}),c(36,"mat-icon",22),d(37,"menu"),l()()()()()}r&2&&(p(),w("mode","over"),p(9),z(Ee(11,3,"moneyManager")),p(10),He(a.navigationSections),p(8),z(Ee(29,5,"settings")))},dependencies:[ct,V0,a1,bn,at,fx,px,gx,Jn,Sd],styles:[".full-height[_ngcontent-%COMP%]{height:100vh}.color-ball[_ngcontent-%COMP%]{height:3rem;width:3rem;font-size:clamp(2.5rem,6vw,4rem)}"]});let e=n;return e})();var r_=(()=>{let n=class n{constructor(t){this.elementRef=t,this.clickOutside=new $n}onClick(t){this.elementRef.nativeElement.contains(t)||this.clickOutside.emit()}};n.\u0275fac=function(r){return new(r||n)(q(Ws))},n.\u0275dir=S0({type:n,selectors:[["","clickOutside",""]],hostBindings:function(r,a){r&1&&N("click",function(s){return a.onClick(s.target)},!1,E0)},outputs:{clickOutside:"clickOutside"}});let e=n;return e})();function gO(e,n){if(e&1&&se(0,"img",6),e&2){let i=S();fa("src",i.user.photoURL,k0)}}function fO(e,n){if(e&1&&(c(0,"span",7),d(1),pe(2,"titlecase"),l()),e&2){let i=S();p(),z(Ee(2,1,i.user.displayName?i.user.displayName:"User"))}}function pO(e,n){if(e&1&&(yi(),c(0,"svg",8),se(1,"path",9),l()),e&2){let i=S();Je("rotate-180",i.isOpen)}}function hO(e,n){if(e&1){let i=be();c(0,"div",10)(1,"div",11)(2,"button",12),N("click",function(){G(i);let r=S();return H(r.viewProfile())}),yi(),c(3,"svg",13),se(4,"path",14)(5,"path",15),l(),Yr(),c(6,"span"),d(7,"View Profile"),l()(),c(8,"button",12),N("click",function(){G(i);let r=S();return H(r.openSettings())}),yi(),c(9,"svg",13),se(10,"path",16),l(),Yr(),c(11,"span"),d(12,"Settings"),l()(),c(13,"button",12),N("click",function(){G(i);let r=S();return H(r.openCacheManager())}),yi(),c(14,"svg",13),se(15,"path",17),l(),Yr(),c(16,"span"),d(17,"Cache Management"),l()(),c(18,"button",12),N("click",function(){G(i);let r=S();return H(r.shareApp())}),c(19,"mat-icon",18),d(20,"share"),l(),c(21,"span"),d(22,"Share App"),l()(),c(23,"button",12),N("click",function(){G(i);let r=S();return H(r.openHelp())}),yi(),c(24,"svg",13),se(25,"path",19),l(),Yr(),c(26,"span"),d(27,"Help"),l()()(),se(28,"div",20),c(29,"div",11)(30,"button",21),N("click",function(r){G(i);let a=S();return H(a.signOut(r))}),yi(),c(31,"svg",13),se(32,"path",22),l(),Yr(),c(33,"span"),d(34,"Sign Out"),l()()()()}e&2&&w("@slideDown",void 0)}var a_=(()=>{let n=class n{constructor(t,r,a,o,s){this.userService=t,this.notificationService=r,this.router=a,this.breakpointObserver=o,this.splitwiseService=s,this.isOpen=!1,this.isMobile=!1,this.user={displayName:"",photoURL:""},this.breakpointObserver.observe(cc.Handset).subscribe(u=>{this.isMobile=u.matches})}ngOnInit(){this.userService.userAuth$.pipe(qa(1)).subscribe(t=>{this.user={displayName:t==null?void 0:t.displayName,photoURL:t==null?void 0:t.photoURL}})}toggle(t){t&&t.stopPropagation(),console.log("toggling"),this.isOpen=!this.isOpen}close(){this.isOpen=!1}viewProfile(){console.log("View profile clicked"),this.router.navigate(["/dashboard/profile"]),this.close()}openSettings(){console.log("Settings clicked"),this.notificationService.info("Settings feature coming soon"),this.close()}openCacheManager(){console.log("Cache management clicked"),this.notificationService.info("Opening cache management"),this.showCacheManagerDialog(),this.close()}showCacheManagerDialog(){let t=document.createElement("div");t.className="fixed inset-0 z-[9999] bg-black bg-opacity-50 flex items-center justify-center p-4",t.innerHTML=`
      <div class="bg-white rounded-lg shadow-xl max-w-md w-full max-h-[80vh] overflow-y-auto">
        <div class="p-6">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-gray-900">Cache Management</h3>
            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          
          <div class="space-y-4">
            <!-- Clear Cache Button -->
            <button 
              onclick="clearAppCache()"
              class="w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
              </svg>
              <span>Clear Cache</span>
            </button>

            <!-- Force Update Button -->
            <button 
              onclick="forceAppUpdate()"
              class="w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
              </svg>
              <span>Force Update</span>
            </button>

            <!-- App Info -->
            <div class="p-3 bg-gray-50 rounded-lg">
              <h4 class="font-medium text-gray-900 mb-2">App Information</h4>
              <div class="space-y-1">
                <div class="flex justify-between">
                  <span class="text-sm text-gray-600">Version:</span>
                  <span class="text-sm font-medium">${new Date().toISOString().split("T")[0]}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm text-gray-600">Last Updated:</span>
                  <span class="text-sm font-medium">${new Date(localStorage.getItem("app-version")||new Date().toISOString().split("T")[0]).toLocaleDateString()}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    `,window.clearAppCache=()=>ue(this,null,function*(){try{if("caches"in window){let r=yield caches.keys();yield Promise.all(r.map(a=>caches.delete(a)))}"indexedDB"in window&&(yield indexedDB.databases()).forEach(a=>{a.name&&indexedDB.deleteDatabase(a.name)}),this.notificationService.success("Cache cleared successfully!"),t.remove()}catch(r){console.error("Failed to clear cache:",r),this.notificationService.error("Failed to clear cache. Please try again.")}}),window.forceAppUpdate=()=>{localStorage.setItem("app-version",new Date().toISOString().split("T")[0]),this.notificationService.info("App update initiated"),window.location.reload()},document.body.appendChild(t),t.addEventListener("click",r=>{r.target===t&&t.remove()})}openHelp(){console.log("Help clicked"),this.notificationService.info("Help feature coming soon"),this.close()}signOut(t){return ue(this,null,function*(){console.log("signing out");try{yield this.userService.signOut(),this.notificationService.success("Signed out successfully"),t.stopPropagation(),this.close()}catch(r){console.error("Error signing out:",r),this.notificationService.error("Failed to sign out")}})}shareApp(){this.splitwiseService.sharePWA(),this.close()}};n.\u0275fac=function(r){return new(r||n)(q(gi),q(ht),q(Kt),q(Zi),q(gc))},n.\u0275cmp=Ve({type:n,selectors:[["app-user"]],decls:6,vars:4,consts:[[1,"relative","inline-block",3,"clickOutside"],["type","button",1,"relative","z-10","flex","items-center","p-2","text-sm","text-gray-600","bg-transparent","border","border-transparent","rounded-md","focus:border-blue-500","focus:ring-opacity-40","dark:focus:ring-opacity-40","focus:ring-blue-300","dark:focus:ring-blue-400","focus:ring","dark:text-white","dark:bg-gray-800","focus:outline-none","hover:bg-gray-100","dark:hover:bg-gray-700","transition-colors",3,"click"],["class","flex-shrink-0 object-cover mx-1 rounded-full w-9 h-9 border-2 border-gray-200 dark:border-gray-600","alt","avatar",3,"src",4,"ngIf"],["class","mx-1 truncate max-w-100",4,"ngIf"],["class","w-5 h-5 mx-1 transition-transform duration-200","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",3,"rotate-180",4,"ngIf"],["class","absolute right-0 z-20 w-64 py-2 mt-2 overflow-hidden origin-top-right bg-white rounded-lg shadow-xl dark:bg-gray-800 border border-gray-200 dark:border-gray-700",4,"ngIf"],["alt","avatar",1,"flex-shrink-0","object-cover","mx-1","rounded-full","w-9","h-9","border-2","border-gray-200","dark:border-gray-600",3,"src"],[1,"mx-1","truncate","max-w-100"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"w-5","h-5","mx-1","transition-transform","duration-200"],["d","M12 15.713L18.01 9.70299L16.597 8.28799L12 12.888L7.40399 8.28799L5.98999 9.70199L12 15.713Z","fill","currentColor"],[1,"absolute","right-0","z-20","w-64","py-2","mt-2","overflow-hidden","origin-top-right","bg-white","rounded-lg","shadow-xl","dark:bg-gray-800","border","border-gray-200","dark:border-gray-700"],[1,"py-1"],[1,"flex","items-center","w-full","px-4","py-2","text-sm","text-gray-600","capitalize","transition-colors","duration-200","dark:text-gray-300","hover:bg-gray-100","dark:hover:bg-gray-700","dark:hover:text-white","focus:outline-none","focus:bg-gray-100","dark:focus:bg-gray-700",3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"w-4","h-4","mr-3"],["d","M7 8C7 5.23858 9.23858 3 12 3C14.7614 3 17 5.23858 17 8C17 10.7614 14.7614 13 12 13C9.23858 13 7 10.7614 7 8ZM12 11C13.6569 11 15 9.65685 15 8C15 6.34315 13.6569 5 12 5C10.3431 5 9 6.34315 9 8C9 9.65685 10.3431 11 12 11Z","fill","currentColor"],["d","M6.34315 16.3431C4.84285 17.8434 4 19.8783 4 22H6C6 20.4087 6.63214 18.8826 7.75736 17.7574C8.88258 16.6321 10.4087 16 12 16C13.5913 16 15.1174 16.6321 16.2426 17.7574C17.3679 18.8826 18 20.4087 18 22H20C20 19.8783 19.1571 17.8434 17.6569 16.3431C16.1566 14.8429 14.1217 14 12 14C9.87827 14 7.84344 14.8429 6.34315 16.3431Z","fill","currentColor"],["d","M13.8199 22H10.1799C9.71003 22 9.30347 21.673 9.20292 21.214L8.79592 19.33C8.25297 19.0921 7.73814 18.7946 7.26092 18.443L5.42392 19.028C4.97592 19.1709 4.48891 18.9823 4.25392 18.575L2.42992 15.424C2.19751 15.0165 2.27758 14.5025 2.62292 14.185L4.04792 12.885C3.98312 12.2961 3.98312 11.7019 4.04792 11.113L2.62292 9.816C2.27707 9.49837 2.19697 8.98372 2.42992 8.576L4.24992 5.423C4.48491 5.0157 4.97192 4.82714 5.41992 4.97L7.25692 5.555C7.50098 5.37416 7.75505 5.20722 8.01792 5.055C8.27026 4.91269 8.52995 4.78385 8.79592 4.669L9.20392 2.787C9.30399 2.32797 9.71011 2.00049 10.1799 2H13.8199C14.2897 2.00049 14.6958 2.32797 14.7959 2.787L15.2079 4.67C15.4887 4.79352 15.7622 4.93308 16.0269 5.088C16.2739 5.23081 16.5126 5.38739 16.7419 5.557L18.5799 4.972C19.0276 4.82967 19.514 5.01816 19.7489 5.425L21.5689 8.578C21.8013 8.98548 21.7213 9.49951 21.3759 9.817L19.9509 11.117C20.0157 11.7059 20.0157 12.3001 19.9509 12.889L21.3759 14.189C21.7213 14.5065 21.8013 15.0205 21.5689 15.428L19.7489 18.581C19.514 18.9878 19.0276 19.1763 18.5799 19.034L16.7419 18.449C16.5093 18.6203 16.2677 18.7789 16.0179 18.924C15.7557 19.0759 15.4853 19.2131 15.2079 19.335L14.7959 21.214C14.6954 21.6726 14.2894 21.9996 13.8199 22ZM7.61992 16.229L8.43992 16.829C8.62477 16.9652 8.81743 17.0904 9.01692 17.204C9.20462 17.3127 9.39788 17.4115 9.59592 17.5L10.5289 17.909L10.9859 20H13.0159L13.4729 17.908L14.4059 17.499C14.8132 17.3194 15.1998 17.0961 15.5589 16.833L16.3799 16.233L18.4209 16.883L19.4359 15.125L17.8529 13.682L17.9649 12.67C18.0141 12.2274 18.0141 11.7806 17.9649 11.338L17.8529 10.326L19.4369 8.88L18.4209 7.121L16.3799 7.771L15.5589 7.171C15.1997 6.90671 14.8132 6.68175 14.4059 6.5L13.4729 6.091L13.0159 4H10.9859L10.5269 6.092L9.59592 6.5C9.39772 6.58704 9.20444 6.68486 9.01692 6.793C8.81866 6.90633 8.62701 7.03086 8.44292 7.166L7.62192 7.766L5.58192 7.116L4.56492 8.88L6.14792 10.321L6.03592 11.334C5.98672 11.7766 5.98672 12.2234 6.03592 12.666L6.14792 13.678L4.56492 15.121L5.57992 16.879L7.61992 16.229ZM11.9959 16C9.78678 16 7.99592 14.2091 7.99592 12C7.99592 9.79086 9.78678 8 11.9959 8C14.2051 8 15.9959 9.79086 15.9959 12C15.9932 14.208 14.2039 15.9972 11.9959 16ZM11.9959 10C10.9033 10.0011 10.0138 10.8788 9.99815 11.9713C9.98249 13.0638 10.8465 13.9667 11.9386 13.9991C13.0307 14.0315 13.9468 13.1815 13.9959 12.09V12.49V12C13.9959 10.8954 13.1005 10 11.9959 10Z","fill","currentColor"],["d","M19 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V5C21 3.89543 20.1046 3 19 3ZM19 19H5V5H19V19ZM17 13H7V11H17V13ZM13 17H7V15H13V17ZM7 9V7H17V9H7Z","fill","currentColor"],[1,"text-sm","mr-1"],["d","M12 22C6.47967 21.9939 2.00606 17.5203 2 12V11.8C2.10993 6.30452 6.63459 1.92794 12.1307 2.00087C17.6268 2.07379 22.0337 6.56887 21.9978 12.0653C21.9619 17.5618 17.4966 21.9989 12 22ZM11.984 20H12C16.4167 19.9956 19.9942 16.4127 19.992 11.996C19.9898 7.57928 16.4087 3.99999 11.992 3.99999C7.57528 3.99999 3.99421 7.57928 3.992 11.996C3.98979 16.4127 7.56729 19.9956 11.984 20ZM13 18H11V16H13V18ZM13 15H11C10.9684 13.6977 11.6461 12.4808 12.77 11.822C13.43 11.316 14 10.88 14 9.99999C14 8.89542 13.1046 7.99999 12 7.99999C10.8954 7.99999 10 8.89542 10 9.99999H8V9.90999C8.01608 8.48093 8.79333 7.16899 10.039 6.46839C11.2846 5.76778 12.8094 5.78493 14.039 6.51339C15.2685 7.24184 16.0161 8.57093 16 9.99999C15.9284 11.079 15.3497 12.0602 14.44 12.645C13.6177 13.1612 13.0847 14.0328 13 15Z","fill","currentColor"],[1,"border-t","border-gray-100","dark:border-gray-700","my-1"],[1,"flex","items-center","w-full","px-4","py-2","text-sm","text-red-600","capitalize","transition-colors","duration-200","dark:text-red-400","hover:bg-red-50","dark:hover:bg-red-900/20","focus:outline-none","focus:bg-red-50","dark:focus:bg-red-900/20",3,"click"],["d","M19 21H10C8.89543 21 8 20.1046 8 19V15H10V19H19V5H10V9H8V5C8 3.89543 8.89543 3 10 3H19C20.1046 3 21 3.89543 21 5V19C21 20.1046 20.1046 21 19 21ZM12 16V13H3V11H12V8L17 12L12 16Z","fill","currentColor"]],template:function(r,a){r&1&&(c(0,"div",0),N("clickOutside",function(){return a.close()}),c(1,"button",1),N("click",function(s){return a.toggle(s)}),X(2,gO,1,1,"img",2)(3,fO,3,3,"span",3)(4,pO,2,2,"svg",4),l(),X(5,hO,35,1,"div",5),l()),r&2&&(p(2),w("ngIf",a.user==null?null:a.user.photoURL),p(),w("ngIf",!a.isMobile||!(a.user!=null&&a.user.photoURL)),p(),w("ngIf",!a.isMobile),p(),w("ngIf",a.isOpen))},dependencies:[ct,at,r_,yr],data:{animation:[wd("slideDown",[uc("void",dc({opacity:0,transform:"translateY(-10px) scale(0.95)"})),uc("*",dc({opacity:1,transform:"translateY(0) scale(1)"})),mc("void => *",[lc("200ms ease-out")]),mc("* => void",[lc("150ms ease-in")])])]}});let e=n;return e})();var o_=(()=>{let n=class n{};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=Ve({type:n,selectors:[["app-header"]],decls:3,vars:0,consts:[[1,"header","flex","justify-between","p-2"]],template:function(r,a){r&1&&(c(0,"header",0),se(1,"side-bar")(2,"app-user"),l())},dependencies:[i_,a_]});let e=n;return e})();var xg=Tr(Nr());function CO(e,n){if(e&1){let i=be();c(0,"mat-list-item",7),N("click",function(){let r=G(i).$implicit,a=S();return H(a.selectCategory(r))}),c(1,"div",8)(2,"div",9)(3,"mat-icon",10),d(4),l()(),c(5,"div",11)(6,"span",12),d(7),l(),c(8,"span",13),d(9),pe(10,"titlecase"),l()(),c(11,"mat-icon",14),d(12,"arrow_forward_ios"),l()()()}if(e&2){let i=n.$implicit,t=S();Je("selected",t.selectedCategory===i),p(3),Xt("color",i.color),p(),oe(" ",i.icon," "),p(3),z(i.name),p(2),z(Ee(10,7,i.type))}}function vO(e,n){e&1&&(c(0,"div",15)(1,"mat-icon",16),d(2,"category"),l(),c(3,"p"),d(4,"No categories available"),l()())}var s_=(()=>{let n=class n{constructor(t,r){this.dialogRef=t,this.data=r,this.selectedCategory=null}ngOnInit(){}selectCategory(t){this.selectedCategory=t,this.dialogRef.close(t)}onCancel(){this.dialogRef.close(null)}trackByCategory(t,r){return r.id||t.toString()}};n.\u0275fac=function(r){return new(r||n)(q(fi),q(pi))},n.\u0275cmp=Ve({type:n,selectors:[["app-parent-category-selector-dialog"]],decls:9,vars:6,consts:[[3,"closeButtonClick","title","showCloseButton"],[1,"dialog-message"],[1,"categories-container"],[1,"categories-list"],[1,"category-list"],["class","category-item",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","no-categories",4,"ngIf"],[1,"category-item",3,"click"],[1,"category-info"],[1,"category-icon-wrapper"],[1,"category-icon"],[1,"category-details"],[1,"category-name"],[1,"category-type"],[1,"select-icon"],[1,"no-categories"],[1,"no-categories-icon"]],template:function(r,a){r&1&&(c(0,"app-common-header",0),N("closeButtonClick",function(){return a.onCancel()}),l(),c(1,"app-common-body-content")(2,"p",1),d(3),l(),c(4,"div",2)(5,"div",3)(6,"mat-list",4),X(7,CO,13,9,"mat-list-item",5),l()(),X(8,vO,5,0,"div",6),l()()),r&2&&(w("title",a.data.title)("showCloseButton",!0),p(3),z(a.data.message),p(4),w("ngForOf",a.data.categories)("ngForTrackBy",a.trackByCategory),p(),w("ngIf",(a.data==null||a.data.categories==null?null:a.data.categories.length)===0))},dependencies:[$r,ct,hx,xx,at,yo,Mo,yr],styles:[".parent-category-dialog[_ngcontent-%COMP%]{min-width:320px;max-width:90vw;width:100%;border-radius:12px;overflow:hidden;box-shadow:0 4px 20px #0000001a}@media (max-width: 599px){.parent-category-dialog[_ngcontent-%COMP%]{min-width:280px;max-width:95vw}}@media (min-width: 600px) and (max-width: 959px){.parent-category-dialog[_ngcontent-%COMP%]{min-width:400px;max-width:500px}}@media (min-width: 960px){.parent-category-dialog[_ngcontent-%COMP%]{min-width:450px;max-width:550px}}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px 16px;border-bottom:1px solid #e0e0e0;background:linear-gradient(135deg,#f8f9fa,#fff)}@media (max-width: 599px){.dialog-header[_ngcontent-%COMP%]{padding:16px 20px 12px}}.dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:#333}@media (max-width: 599px){.dialog-title[_ngcontent-%COMP%]{font-size:1.25rem}}.close-button[_ngcontent-%COMP%]{color:#666;transition:all .2s ease}.close-button[_ngcontent-%COMP%]:hover{color:#333;background-color:#0000000a;transform:scale(1.1)}.close-button[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 2px #1976d233}.dialog-content[_ngcontent-%COMP%]{padding:20px 24px}@media (max-width: 599px){.dialog-content[_ngcontent-%COMP%]{padding:16px 20px}}.dialog-message[_ngcontent-%COMP%]{margin:0 0 20px;color:#666;font-size:.95rem;line-height:1.5}@media (max-width: 599px){.dialog-message[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:16px}}.categories-container[_ngcontent-%COMP%]{position:relative}.categories-list[_ngcontent-%COMP%]{max-height:350px;overflow-y:auto}@media (max-width: 599px){.categories-list[_ngcontent-%COMP%]{max-height:300px}}.categories-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.categories-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.categories-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.categories-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.category-list[_ngcontent-%COMP%]{padding:0}.category-item[_ngcontent-%COMP%]{cursor:pointer;border-radius:12px;margin-bottom:8px;transition:all .2s ease;border:1px solid transparent}.category-item[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;border-color:#e9ecef;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.category-item.selected[_ngcontent-%COMP%]{background-color:#1976d214;border-color:#1976d2}.category-item.selected[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{color:#1976d2;font-weight:600}.category-item.selected[_ngcontent-%COMP%]   .select-icon[_ngcontent-%COMP%]{color:#1976d2;transform:translate(2px)}.category-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}@media (max-width: 599px){.category-item[_ngcontent-%COMP%]{margin-bottom:6px}}.category-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;width:100%;padding:4px 0}@media (max-width: 599px){.category-info[_ngcontent-%COMP%]{gap:12px}}.category-icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;background-color:#0000000a;flex-shrink:0}@media (max-width: 599px){.category-icon-wrapper[_ngcontent-%COMP%]{width:36px;height:36px}}.category-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}@media (max-width: 599px){.category-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}}.category-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;min-width:0}.category-name[_ngcontent-%COMP%]{font-weight:500;font-size:1rem;color:#333;margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width: 599px){.category-name[_ngcontent-%COMP%]{font-size:.95rem}}.category-type[_ngcontent-%COMP%]{color:#666;font-size:.8rem;text-transform:uppercase;letter-spacing:.5px;font-weight:500}@media (max-width: 599px){.category-type[_ngcontent-%COMP%]{font-size:.75rem}}.select-icon[_ngcontent-%COMP%]{color:#ccc;font-size:16px;transition:all .2s ease;flex-shrink:0}@media (max-width: 599px){.select-icon[_ngcontent-%COMP%]{font-size:14px}}.no-categories[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;text-align:center;color:#666}@media (max-width: 599px){.no-categories[_ngcontent-%COMP%]{padding:30px 16px}}.no-categories-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;opacity:.5}@media (max-width: 599px){.no-categories-icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px;margin-bottom:12px}}.no-categories[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1rem}@media (max-width: 599px){.no-categories[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem}}.dialog-actions[_ngcontent-%COMP%]{padding:16px 24px 20px;justify-content:flex-end;border-top:1px solid #e0e0e0;background-color:#fafafa}@media (max-width: 599px){.dialog-actions[_ngcontent-%COMP%]{padding:12px 20px 16px}}.cancel-button[_ngcontent-%COMP%]{min-width:80px;font-weight:500;border-radius:6px;transition:all .2s ease}.cancel-button[_ngcontent-%COMP%]:hover{background-color:#0000000a}@media (max-width: 599px){.cancel-button[_ngcontent-%COMP%]{min-width:70px;font-size:.9rem}}"]});let e=n;return e})();var Do=(()=>{let n=class n{constructor(t,r,a){this.firestore=t,this.store=r,this.dialog=a,this.categories={},this.store.select(Ri).subscribe(o=>{o.forEach(s=>{s.id&&(this.categories[s.id]=s)})})}getUserCategoriesCollection(t){return Fr(this.firestore,`users/${t}/categories`)}getCategories(t){let r=this.getUserCategoriesCollection(t);return new qt(a=>{ya(r).then(o=>{let s=[];o.forEach(u=>{let m=u.data(),f={id:u.id,name:m==null?void 0:m.name,type:m==null?void 0:m.type,icon:(m==null?void 0:m.icon)||"category",color:(m==null?void 0:m.color)||"#46777f",createdAt:m==null?void 0:m.createdAt,budget:(m==null?void 0:m.budget)||null,parentCategoryId:(m==null?void 0:m.parentCategoryId)||null,isSubCategory:(m==null?void 0:m.isSubCategory)||!1,subCategories:(m==null?void 0:m.subCategories)||[]};s.push(f)}),a.next(s),a.complete()}).catch(o=>{a.error(o)})})}createCategory(t,r,a,o,s){return new qt(u=>{let m=this.generateCategoryId(),f=Et(this.firestore,`users/${t}/categories/${m}`);wr(f,{name:r,type:a,icon:o,color:s,createdAt:Date.now()}).then(()=>{u.next(m),u.complete()}).catch(h=>{u.error(h)})})}updateCategory(t,r,a,o,s,u,m,f,h){return new qt(_=>{let y=Et(this.firestore,`users/${t}/categories/${r}`);ai(y).then(v=>{if(v.exists()){let C=v.data(),P={name:a,type:o,icon:s,color:u};if(m&&(P.budget=m),f!==void 0)if(f==null){if(C.parentCategoryId){let D=this.categories[C.parentCategoryId];if(D&&D.subCategories){let T=D.subCategories.filter(I=>I!==r);kn(Et(this.firestore,`users/${t}/categories/${C.parentCategoryId}`),{subCategories:T})}}P.parentCategoryId=Md()}else{if(C.parentCategoryId&&C.parentCategoryId!==f){let T=this.categories[C.parentCategoryId];if(T&&T.subCategories){let I=T.subCategories.filter(K=>K!==r);kn(Et(this.firestore,`users/${t}/categories/${C.parentCategoryId}`),{subCategories:I})}}let D=this.categories[f];if(D){let T=[...D.subCategories||[],r];kn(Et(this.firestore,`users/${t}/categories/${f}`),{subCategories:T})}P.parentCategoryId=f}h!==void 0&&(P.isSubCategory=h),kn(y,P).then(()=>{_.next(),_.complete()}).catch(D=>{_.error(D)})}else _.error(new Error("Category not found"))}).catch(v=>{_.error(v)})})}deleteCategory(t,r){return new qt(a=>{let o=Et(this.firestore,`users/${t}/categories/${r}`);ai(o).then(s=>{if(s.exists()){let u=s.data();if(u.isSubCategory&&u.parentCategoryId){let m=this.categories[u.parentCategoryId];if(m&&m.subCategories){let f=m.subCategories.filter(h=>h!==r);kn(Et(this.firestore,`users/${t}/categories/${u.parentCategoryId}`),{subCategories:f}).then(()=>{Di(o).then(()=>{a.next(),a.complete()}).catch(h=>{a.error(h)})}).catch(h=>{a.error(h)})}else Di(o).then(()=>{a.next(),a.complete()}).catch(f=>{a.error(f)})}else if(u.subCategories&&u.subCategories.length>0){let m=u.subCategories.map(f=>Di(Et(this.firestore,`users/${t}/categories/${f}`)));Promise.all(m).then(()=>{Di(o).then(()=>{a.next(),a.complete()}).catch(f=>{a.error(f)})}).catch(f=>{a.error(f)})}else Di(o).then(()=>{a.next(),a.complete()}).catch(m=>{a.error(m)})}else a.next(),a.complete()}).catch(s=>{a.error(s)})})}getCategoryNameById(t){var r;return((r=this.categories[t])==null?void 0:r.name)||""}removeFromParentCategory(t,r){return new qt(a=>{let o=Et(this.firestore,`users/${t}/categories/${r}`);ai(o).then(s=>{if(s.exists()){let u=s.data();if(u.parentCategoryId){let m=this.categories[u.parentCategoryId];if(m&&m.subCategories){let f=m.subCategories.filter(h=>h!==r);kn(Et(this.firestore,`users/${t}/categories/${u.parentCategoryId}`),{subCategories:f}).then(()=>{kn(o,{parentCategoryId:Md(),isSubCategory:!1}).then(()=>{a.next(),a.complete()}).catch(h=>{a.error(h)})}).catch(h=>{a.error(h)})}else kn(o,{parentCategoryId:Md(),isSubCategory:!1}).then(()=>{a.next(),a.complete()}).catch(f=>{a.error(f)})}else a.next(),a.complete()}else a.error(new Error("Category not found"))}).catch(s=>{a.error(s)})})}getCategoryWithSubCategories(t,r){return new qt(a=>{this.getCategories(t).subscribe(o=>{a.next(o.find(s=>s.id===r)||null),a.complete()},o=>{a.error(o)})})}hasSubCategories(t){let r=this.categories[t];return(r==null?void 0:r.subCategories)&&r.subCategories.length>0||!1}getSubCategoriesCount(t){var a;let r=this.categories[t];return((a=r==null?void 0:r.subCategories)==null?void 0:a.length)||0}openParentCategorySelectorDialog(t){return new qt(r=>{try{let o=Object.values(this.categories).filter(u=>u.id!==t.id&&!u.isSubCategory&&!u.parentCategoryId);this.dialog.open(s_,{width:"500px",maxWidth:"90vw",data:{title:"Select Parent Category",message:`Select a parent category for "${t.name}"`,categories:o},disableClose:!1}).afterClosed().subscribe(u=>{r.next(u),r.complete()})}catch(a){console.error("Error opening parent category selector dialog:",a),r.error(a)}})}generateCategoryId(){return"cat_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}};n.\u0275fac=function(r){return new(r||n)(De(Ki),De(wt),De(fn))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var _g=(e,n)=>n.value;function bO(e,n){e&1&&(c(0,"p",6),d(1,"Account name is required"),l())}function yO(e,n){e&1&&(c(0,"p",6),d(1,"Account name must be less than 50 characters"),l())}function MO(e,n){if(e&1&&(c(0,"mat-option",10),d(1),l()),e&2){let i=n.$implicit;w("value",i.value),p(),z(i.label)}}function wO(e,n){e&1&&(c(0,"mat-error"),d(1,"Account type is required"),l())}function SO(e,n){if(e&1&&(c(0,"p",12),d(1),l()),e&2){let i=S();p(),z(i.getBalanceError())}}function PO(e,n){e&1&&(c(0,"p",12),d(1,"Lender name is required"),l())}function OO(e,n){if(e&1&&(c(0,"p",12),d(1),l()),e&2){let i=S(2);p(),z(i.getLoanAmountError())}}function kO(e,n){if(e&1&&(c(0,"p",12),d(1),l()),e&2){let i=S(2);p(),z(i.getInterestRateError())}}function EO(e,n){if(e&1&&(c(0,"p",12),d(1),l()),e&2){let i=S(2);p(),z(i.getDurationError())}}function TO(e,n){if(e&1&&(c(0,"div",38)(1,"span",39),d(2),pe(3,"currency"),l(),c(4,"mat-icon",17),d(5,"calculate"),l()(),c(6,"p",33),d(7," Calculated using loan amortization formula "),l()),e&2){let i=S(2);p(2),oe(" ",Ee(3,1,i.getCalculatedMonthlyPayment())," ")}}function IO(e,n){e&1&&(se(0,"input",40),c(1,"p",33),d(2," Enter your actual monthly payment amount "),l())}function AO(e,n){if(e&1&&(c(0,"mat-option",10),d(1),l()),e&2){let i=n.$implicit;w("value",i.value),p(),z(i.label)}}function DO(e,n){if(e&1&&(c(0,"mat-option",10),d(1),l()),e&2){let i=n.$implicit;w("value",i.value),p(),z(i.label)}}function FO(e,n){if(e&1){let i=be();c(0,"div",13)(1,"h4",16)(2,"mat-icon",17),d(3,"account_balance_wallet"),l(),d(4," Loan Details "),l(),c(5,"div",18)(6,"label",3),d(7," Lender Name * "),l(),se(8,"input",19),X(9,PO,2,0,"p",12),l(),c(10,"div",18)(11,"label",3),d(12," Loan Amount * "),l(),se(13,"input",20),X(14,OO,2,1,"p",12),l(),c(15,"div",18)(16,"label",3),d(17," Annual Interest Rate (%) * "),l(),se(18,"input",21),X(19,kO,2,1,"p",12),l(),c(20,"div",18)(21,"label",3),d(22," Loan Start Date * "),l(),se(23,"input",22),l(),c(24,"div",18)(25,"label",3),d(26," Loan Duration (months) * "),l(),se(27,"input",23),X(28,EO,2,1,"p",12),l(),c(29,"div",18)(30,"label",3),d(31," Monthly Payment Amount "),l(),c(32,"div",24)(33,"label",25),se(34,"input",26),c(35,"span",27),d(36," Use calculated payment amount "),l()()(),X(37,TO,8,3)(38,IO,3,0),l(),c(39,"div",18)(40,"label",3),d(41," Repayment Frequency * "),l(),c(42,"mat-form-field",8)(43,"mat-label"),d(44,"Select frequency"),l(),c(45,"mat-select",28),Ge(46,AO,2,2,"mat-option",10,_g),l()()(),c(48,"div",18)(49,"label",3),d(50," Loan Status * "),l(),c(51,"mat-form-field",8)(52,"mat-label"),d(53,"Select status"),l(),c(54,"mat-select",29),Ge(55,DO,2,2,"mat-option",10,_g),l()()(),c(57,"div",18)(58,"label",3),d(59," Calculated Remaining Balance "),l(),c(60,"div",30),se(61,"input",31),c(62,"button",32),N("click",function(){G(i);let r=S();return H(r.updateRemainingBalance())}),d(63," Recalculate "),l()(),c(64,"p",33),d(65," Automatically calculated based on time elapsed since loan start date "),l()(),c(66,"div",18)(67,"label",3),d(68," Next Payment Due Date * "),l(),se(69,"input",34),l(),c(70,"div",18)(71,"label",25),se(72,"input",35),c(73,"span",27),d(74," Show payment reminders "),l()()(),c(75,"div",18)(76,"label",25),se(77,"input",36),c(78,"span",27),d(79," Create recurring transaction for loan payments "),l()(),c(80,"p",37),d(81," Automatically creates a recurring transaction for monthly loan payments "),l()()()}if(e&2){let i,t,r,a=S();p(9),ot((i=a.accountForm.get("lenderName"))!=null&&i.hasError("required")&&((i=a.accountForm.get("lenderName"))!=null&&i.touched)?9:-1),p(5),ot(a.getLoanAmountError()?14:-1),p(5),ot(a.getInterestRateError()?19:-1),p(9),ot(a.getDurationError()?28:-1),p(9),ot((t=a.accountForm.get("useCalculatedPayment"))!=null&&t.value?37:-1),p(),ot((r=a.accountForm.get("useCalculatedPayment"))!=null&&r.value?-1:38),p(8),He(a.repaymentFrequencies),p(9),He(a.loanStatuses)}}function RO(e,n){e&1&&(c(0,"p",12),d(1,"Due date is required"),l())}function NO(e,n){e&1&&(c(0,"p",12),d(1,"Due date must be between 1 and 31"),l())}function BO(e,n){e&1&&(c(0,"p",12),d(1,"Billing cycle start is required"),l())}function LO(e,n){e&1&&(c(0,"p",12),d(1,"Billing cycle start must be between 1 and 31"),l())}function VO(e,n){if(e&1&&(c(0,"div",14)(1,"h4",41)(2,"mat-icon",42),d(3,"credit_card"),l(),d(4," Credit Card Details "),l(),c(5,"div",18)(6,"label",3),d(7," Payment Due Date (Day of Month) * "),l(),se(8,"input",43),X(9,RO,2,0,"p",12)(10,NO,2,0,"p",12),l(),c(11,"div",18)(12,"label",3),d(13," Billing Cycle Start (Day of Month) * "),l(),se(14,"input",44),X(15,BO,2,0,"p",12)(16,LO,2,0,"p",12),l(),c(17,"div",18)(18,"label",3),d(19," Credit Limit "),l(),se(20,"input",45),c(21,"p",33),d(22," Optional: Set your credit limit for tracking "),l()(),c(23,"div",18)(24,"label",3),d(25," Minimum Payment "),l(),se(26,"input",46),c(27,"p",33),d(28," Optional: Set your typical minimum payment amount "),l()(),c(29,"div",18)(30,"label",25),se(31,"input",47),c(32,"span",27),d(33," Show payment reminders "),l()()()()),e&2){let i,t,r,a,o=S();p(9),ot((i=o.accountForm.get("dueDate"))!=null&&i.hasError("required")&&((i=o.accountForm.get("dueDate"))!=null&&i.touched)?9:-1),p(),ot((t=o.accountForm.get("dueDate"))!=null&&t.hasError("min")||(t=o.accountForm.get("dueDate"))!=null&&t.hasError("max")?10:-1),p(5),ot((r=o.accountForm.get("billingCycleStart"))!=null&&r.hasError("required")&&((r=o.accountForm.get("billingCycleStart"))!=null&&r.touched)?15:-1),p(),ot((a=o.accountForm.get("billingCycleStart"))!=null&&a.hasError("min")||(a=o.accountForm.get("billingCycleStart"))!=null&&a.hasError("max")?16:-1)}}var yl=(()=>{let n=class n{constructor(t,r,a,o,s,u,m,f,h,_,y){var v,C,P,D,T,I,K,ee,k,O,R;this.dialogData=t,this.fb=r,this.dialogRef=a,this.auth=o,this.notificationService=s,this.hapticFeedback=u,this.validationService=m,this.store=f,this.transactionsService=h,this.categoryService=_,this.accountsService=y,this.isSubmitting=!1,this.accountTypes=[{value:Za.BANK,label:"Bank Account (Checking/Savings)"},{value:Za.CASH,label:"Cash"},{value:Za.CREDIT,label:"Credit Card"},{value:Za.LOAN,label:"Loan"},{value:Za.INVESTMENT,label:"Investment"}],this.repaymentFrequencies=[{value:"monthly",label:"Monthly"},{value:"weekly",label:"Weekly"}],this.loanStatuses=[{value:"active",label:"Active"},{value:"closed",label:"Closed"},{value:"defaulted",label:"Defaulted"}],this.accountForm=this.fb.group({name:["",this.validationService.getAccountNameValidators()],type:["bank",Qe.required],balance:[0,this.validationService.getAccountBalanceValidators()],description:[""],lenderName:[""],loanAmount:[0,this.validationService.getLoanAmountValidators()],interestRate:[0,this.validationService.getInterestRateValidators()],startDate:[new Date],durationMonths:[12,this.validationService.getDurationMonthsValidators()],repaymentFrequency:["monthly"],status:["active"],remainingBalance:[0,[Qe.min(0)]],nextDueDate:[new Date],showReminder:[!0],useCalculatedPayment:[!0],customMonthlyPayment:[0,[Qe.min(0)]],createRecurringTransaction:[!0],dueDate:[15,[Qe.required,Qe.min(1),Qe.max(31)]],billingCycleStart:[1,[Qe.required,Qe.min(1),Qe.max(31)]],creditLimit:[0,[Qe.min(0)]],minimumPayment:[0,[Qe.min(0)]],creditCardShowReminder:[!0]}),this.dialogData&&(this.accountForm.patchValue(ae(ae({name:this.dialogData.name,type:this.dialogData.type,balance:this.dialogData.balance||0,description:this.dialogData.description},this.dialogData.loanDetails&&{lenderName:this.dialogData.loanDetails.lenderName,loanAmount:this.dialogData.loanDetails.loanAmount,interestRate:this.dialogData.loanDetails.interestRate,startDate:this.dialogData.loanDetails.startDate,durationMonths:this.dialogData.loanDetails.durationMonths,repaymentFrequency:this.dialogData.loanDetails.repaymentFrequency,status:this.dialogData.loanDetails.status,remainingBalance:this.dialogData.loanDetails.remainingBalance,nextDueDate:this.dialogData.loanDetails.nextDueDate,showReminder:this.dialogData.loanDetails.showReminder,useCalculatedPayment:!0,customMonthlyPayment:this.dialogData.loanDetails.monthlyPayment||0,createRecurringTransaction:!0}),this.dialogData.creditCardDetails&&{dueDate:this.dialogData.creditCardDetails.dueDate,billingCycleStart:this.dialogData.creditCardDetails.billingCycleStart,creditLimit:this.dialogData.creditCardDetails.creditLimit,minimumPayment:this.dialogData.creditCardDetails.minimumPayment,creditCardShowReminder:this.dialogData.creditCardDetails.showReminder})),setTimeout(()=>{this.updateRemainingBalance()},100),(v=this.accountForm.get("loanAmount"))==null||v.valueChanges.subscribe(U=>{var Q;((Q=this.accountForm.get("type"))==null?void 0:Q.value)==="loan"&&this.accountForm.patchValue({balance:-U},{emitEvent:!1})}),(C=this.accountForm.get("type"))==null||C.valueChanges.subscribe(U=>{let Q=this.accountForm.get("lenderName"),re=this.accountForm.get("loanAmount"),ie=this.accountForm.get("interestRate"),Pe=this.accountForm.get("durationMonths"),Re=this.accountForm.get("nextDueDate"),xe=this.accountForm.get("dueDate"),Be=this.accountForm.get("billingCycleStart"),we=this.accountForm.get("creditLimit"),$e=this.accountForm.get("minimumPayment");U==="loan"?(Q==null||Q.setValidators([Qe.required]),re==null||re.setValidators([Qe.required,...this.validationService.getLoanAmountValidators()]),ie==null||ie.setValidators([Qe.required,...this.validationService.getInterestRateValidators()]),Pe==null||Pe.setValidators([Qe.required,...this.validationService.getDurationMonthsValidators()]),Re==null||Re.setValidators([Qe.required]),xe==null||xe.clearValidators(),Be==null||Be.clearValidators(),we==null||we.clearValidators(),$e==null||$e.clearValidators()):U==="credit"?(Q==null||Q.clearValidators(),re==null||re.clearValidators(),ie==null||ie.clearValidators(),Pe==null||Pe.clearValidators(),Re==null||Re.clearValidators(),xe==null||xe.setValidators([Qe.required,Qe.min(1),Qe.max(31)]),Be==null||Be.setValidators([Qe.required,Qe.min(1),Qe.max(31)]),we==null||we.setValidators([Qe.min(0)]),$e==null||$e.setValidators([Qe.min(0)])):(Q==null||Q.clearValidators(),re==null||re.clearValidators(),ie==null||ie.clearValidators(),Pe==null||Pe.clearValidators(),Re==null||Re.clearValidators(),xe==null||xe.clearValidators(),Be==null||Be.clearValidators(),we==null||we.clearValidators(),$e==null||$e.clearValidators()),Q==null||Q.updateValueAndValidity(),re==null||re.updateValueAndValidity(),ie==null||ie.updateValueAndValidity(),Pe==null||Pe.updateValueAndValidity(),Re==null||Re.updateValueAndValidity(),xe==null||xe.updateValueAndValidity(),Be==null||Be.updateValueAndValidity(),we==null||we.updateValueAndValidity(),$e==null||$e.updateValueAndValidity()}),(P=this.accountForm.get("loanAmount"))==null||P.valueChanges.subscribe(()=>{this.updateRemainingBalance()}),(D=this.accountForm.get("startDate"))==null||D.valueChanges.subscribe(()=>{this.updateRemainingBalance()}),(T=this.accountForm.get("interestRate"))==null||T.valueChanges.subscribe(()=>{this.updateRemainingBalance()}),(I=this.accountForm.get("durationMonths"))==null||I.valueChanges.subscribe(()=>{this.updateRemainingBalance()}),(K=this.accountForm.get("repaymentFrequency"))==null||K.valueChanges.subscribe(()=>{this.updateRemainingBalance()}),(ee=this.accountForm.get("useCalculatedPayment"))==null||ee.valueChanges.subscribe(U=>{if(U){let Q=this.getCalculatedMonthlyPayment();this.accountForm.patchValue({customMonthlyPayment:Q},{emitEvent:!1})}}),(k=this.accountForm.get("loanAmount"))==null||k.valueChanges.subscribe(()=>{var U;if((U=this.accountForm.get("useCalculatedPayment"))!=null&&U.value){let Q=this.getCalculatedMonthlyPayment();this.accountForm.patchValue({customMonthlyPayment:Q},{emitEvent:!1})}}),(O=this.accountForm.get("interestRate"))==null||O.valueChanges.subscribe(()=>{var U;if((U=this.accountForm.get("useCalculatedPayment"))!=null&&U.value){let Q=this.getCalculatedMonthlyPayment();this.accountForm.patchValue({customMonthlyPayment:Q},{emitEvent:!1})}}),(R=this.accountForm.get("durationMonths"))==null||R.valueChanges.subscribe(()=>{var U;if((U=this.accountForm.get("useCalculatedPayment"))!=null&&U.value){let Q=this.getCalculatedMonthlyPayment();this.accountForm.patchValue({customMonthlyPayment:Q},{emitEvent:!1})}}))}ngOnInit(){var t,r;this.userId=(t=this.auth.currentUser)==null?void 0:t.uid,!this.dialogData&&((r=this.accountForm.get("type"))==null?void 0:r.value)==="loan"&&this.updateRemainingBalance()}onSubmit(){return ue(this,null,function*(){var t,r,a;if(this.accountForm.valid&&!this.isSubmitting){this.isSubmitting=!0;try{let o=this.accountForm.value,s=o.type==="loan",u={name:o.name.trim(),type:o.type,balance:Number(o.balance)||0,description:o.description||""};if(s&&(u.loanDetails={lenderName:o.lenderName.trim(),loanAmount:Number(o.loanAmount)||0,interestRate:Number(o.interestRate)||0,startDate:o.startDate,durationMonths:Number(o.durationMonths)||12,repaymentFrequency:o.repaymentFrequency,status:o.status,remainingBalance:Number(o.remainingBalance)+this.getCalculatedMonthlyPayment()||0,nextDueDate:o.nextDueDate,showReminder:o.showReminder}),o.type==="credit"&&(u.creditCardDetails={dueDate:Number(o.dueDate)||15,billingCycleStart:Number(o.billingCycleStart)||1,creditLimit:Number(o.creditLimit)||0,minimumPayment:Number(o.minimumPayment)||0,showReminder:o.creditCardShowReminder}),(t=this.dialogData)!=null&&t.accountId)yield this.accountsService.updateAccount(this.userId,this.dialogData.accountId,u).toPromise(),this.notificationService.success("Account updated successfully");else{let m=yield this.accountsService.createAccount(this.userId,u).toPromise();s&&u.loanDetails&&((r=this.accountForm.get("createRecurringTransaction"))!=null&&r.value)&&m&&this.createLoanPaymentRecurringTransactionAfterAccountCreation(u,m),s&&((a=this.accountForm.get("createRecurringTransaction"))!=null&&a.value)?this.notificationService.success("Loan account created successfully! A recurring transaction for loan payments has been set up."):s?this.notificationService.success("Loan account created successfully!"):this.notificationService.success("Account added successfully"),this.hapticFeedback.successVibration()}this.dialogRef.close(!0)}catch(o){this.notificationService.error("Failed to save account"),console.error("Error saving account:",o)}finally{this.isSubmitting=!1}}})}onClose(){this.dialogRef.close()}getNameError(){let t=this.accountForm.get("name");return t?this.validationService.getAccountNameError(t):""}getBalanceError(){let t=this.accountForm.get("balance");return t?this.validationService.getAccountBalanceError(t):""}isLoanAccount(){var t;return((t=this.accountForm.get("type"))==null?void 0:t.value)==="loan"}isCreditCardAccount(){var t;return((t=this.accountForm.get("type"))==null?void 0:t.value)==="credit"}getLoanAmountError(){let t=this.accountForm.get("loanAmount");return t?this.validationService.getLoanAmountError(t):""}getInterestRateError(){let t=this.accountForm.get("interestRate");return t?this.validationService.getInterestRateError(t):""}getDurationError(){let t=this.accountForm.get("durationMonths");return t?this.validationService.getDurationError(t):""}getCalculatedMonthlyPayment(){var s,u,m,f,h;if(!this.isLoanAccount())return 0;if(!((s=this.accountForm.get("useCalculatedPayment"))==null?void 0:s.value))return((u=this.accountForm.get("customMonthlyPayment"))==null?void 0:u.value)||0;let r=((m=this.accountForm.get("loanAmount"))==null?void 0:m.value)||0,a=((f=this.accountForm.get("interestRate"))==null?void 0:f.value)||0,o=((h=this.accountForm.get("durationMonths"))==null?void 0:h.value)||12;return this.calculateMonthlyPayment(r,a,o)}getCurrentRemainingBalance(){var t;return((t=this.accountForm.get("remainingBalance"))==null?void 0:t.value)||0}updateRemainingBalance(){var u,m,f,h;if(!this.isLoanAccount())return;let t=((u=this.accountForm.get("loanAmount"))==null?void 0:u.value)||0,r=(m=this.accountForm.get("startDate"))==null?void 0:m.value,a=((f=this.accountForm.get("durationMonths"))==null?void 0:f.value)||12,o=((h=this.accountForm.get("repaymentFrequency"))==null?void 0:h.value)||"monthly";if(console.log("Updating remaining balance:",{loanAmount:t,startDate:r,durationMonths:a,repaymentFrequency:o}),!r||t<=0){this.accountForm.patchValue({remainingBalance:t},{emitEvent:!1}),console.log("Setting remaining balance to loan amount:",t);return}let s=this.calculateRemainingBalance(t,r,a,o);console.log("Calculated remaining balance:",s),this.accountForm.patchValue({remainingBalance:s,balance:-s},{emitEvent:!1})}calculateRemainingBalance(t,r,a,o){var C;let s=new Date,u=new Date(r),m=Math.round((0,xg.default)(s).diff((0,xg.default)(u),"months",!0)),f=0;if(o==="weekly"){let P=Math.floor((s.getTime()-u.getTime())/6048e5);f=Math.max(0,P)}else f=Math.max(0,m);let h=((C=this.accountForm.get("interestRate"))==null?void 0:C.value)||0,_=this.calculateMonthlyPayment(t,h,a),y=f*_,v=Math.max(0,t-y);return console.log("Remaining balance calculation details:",{today:s.toISOString(),start:u.toISOString(),monthsElapsed:m,paymentsMade:f,interestRate:h,monthlyPayment:_,totalPaid:y,remainingBalance:v}),Math.round(v*100)/100}findOrCreateLoanPaymentCategory(t){return this.categoryService.getCategories(t).pipe(zr(r=>{let a=r.find(o=>o.name.toLowerCase().includes("loan")&&o.type===en.EXPENSE);return a!=null&&a.id?lt(a.id):this.categoryService.createCategory(t,"Loan Payment",en.EXPENSE,"account_balance","#ef4444")}))}calculateMonthlyPayment(t,r,a){if(a<=0||r<=0)return t/a;let o=r/(12*100),s=o*Math.pow(1+o,a),u=Math.pow(1+o,a)-1;if(u===0)return t/a;let m=t*(s/u);return Math.round(m*100)/100}createLoanPaymentRecurringTransaction(t,r,a){return this.findOrCreateLoanPaymentCategory(t).pipe(zr(o=>{if(!o)throw new Error("Failed to create loan payment category");let s=this.getCalculatedMonthlyPayment(),u={userId:t,accountId:r,categoryId:o,category:"Loan Payment",payee:a.lenderName,amount:s,type:en.EXPENSE,date:new Date,notes:`Monthly payment for ${a.lenderName} loan`,status:bo.COMPLETED,paymentMethod:vo.BANK_TRANSFER,isRecurring:!0,recurringInterval:a.repaymentFrequency==="weekly"?Hr.WEEKLY:Hr.MONTHLY,recurringEndDate:this.calculateLoanEndDate(a.startDate,a.durationMonths),nextOccurrence:a.nextDueDate,createdAt:new Date,updatedAt:new Date,createdBy:t,updatedBy:t,syncStatus:"synced",isPending:!1,lastSyncedAt:new Date};return this.transactionsService.createTransaction(t,u)}))}calculateLoanEndDate(t,r){let a=new Date(t);return a.setMonth(a.getMonth()+r),a}createLoanPaymentRecurringTransactionAfterAccountCreation(t,r){this.createLoanPaymentRecurringTransaction(this.userId,r,t.loanDetails).subscribe({next:()=>{this.notificationService.success("Loan payment recurring transaction created successfully")},error:a=>{console.error("Failed to create loan payment recurring transaction:",a),this.notificationService.warning("Account created but failed to create loan payment recurring transaction")}})}};n.\u0275fac=function(r){return new(r||n)(q(pi),q(Ii),q(fi),q(pt),q(ht),q(Sr),q(qr),q(wt),q(Ao),q(Do),q(yc))},n.\u0275cmp=Ve({type:n,selectors:[["app-add-account-dialog"]],decls:30,vars:13,consts:[["addButtonTooltip","Save Account",3,"addButtonClick","closeButtonClick","title","showAddButton","addButtonDisabled","isSubmitting"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"bg-white","dark:bg-gray-800","rounded-lg","p-4","shadow-sm"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],["type","text","formControlName","name","placeholder","e.g., Chase Checking",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"maxlength"],[1,"flex","justify-between","items-center","mt-1"],[1,"text-red-500","text-sm"],[1,"text-xs","text-gray-500"],["appearance","fill",1,"w-full"],["formControlName","type"],[3,"value"],["type","number","formControlName","balance","placeholder","0.00","step","0.01",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"text-red-500","text-sm","mt-1"],[1,"bg-amber-50","dark:bg-amber-900/20","border","border-amber-200","dark:border-amber-800","rounded-lg","p-4"],[1,"bg-blue-50","dark:bg-blue-900/20","border","border-blue-200","dark:border-blue-800","rounded-lg","p-4"],[1,"h-20"],[1,"text-sm","font-semibold","text-amber-800","dark:text-amber-200","mb-4","flex","items-center","gap-2"],[1,"text-amber-600","dark:text-amber-400"],[1,"mb-4"],["type","text","formControlName","lenderName","placeholder","e.g., Bank of America",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],["type","number","formControlName","loanAmount","placeholder","0.00","step","0.01",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],["type","number","formControlName","interestRate","placeholder","5.5","step","0.1",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],["type","date","formControlName","startDate",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],["type","number","formControlName","durationMonths","placeholder","12",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],[1,"mb-3"],[1,"flex","items-center","gap-2"],["type","checkbox","formControlName","useCalculatedPayment",1,"w-4","h-4","text-amber-600","bg-gray-100","border-gray-300","rounded","focus:ring-amber-500","dark:focus:ring-amber-600","dark:ring-offset-gray-800","focus:ring-2","dark:bg-gray-700","dark:border-gray-600"],[1,"text-sm","font-medium","text-gray-700","dark:text-gray-300"],["formControlName","repaymentFrequency"],["formControlName","status"],[1,"flex","gap-2"],["type","number","formControlName","remainingBalance","readonly","",1,"flex-1","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-gray-100","dark:bg-gray-700","text-gray-600","dark:text-gray-400"],["type","button",1,"px-4","py-3","bg-amber-600","text-white","rounded-lg","hover:bg-amber-700","focus:outline-none","focus:ring-2","focus:ring-amber-500",3,"click"],[1,"text-xs","text-gray-500","dark:text-gray-400","mt-1"],["type","date","formControlName","nextDueDate",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],["type","checkbox","formControlName","showReminder",1,"w-4","h-4","text-amber-600","bg-gray-100","border-gray-300","rounded","focus:ring-amber-500","dark:focus:ring-amber-600","dark:ring-offset-gray-800","focus:ring-2","dark:bg-gray-700","dark:border-gray-600"],["type","checkbox","formControlName","createRecurringTransaction",1,"w-4","h-4","text-amber-600","bg-gray-100","border-gray-300","rounded","focus:ring-amber-500","dark:focus:ring-amber-600","dark:ring-offset-gray-800","focus:ring-2","dark:bg-gray-700","dark:border-gray-600"],[1,"text-xs","text-gray-500","dark:text-gray-400","mt-1","ml-6"],[1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-gray-100","dark:bg-gray-700","text-gray-600","dark:text-gray-400","flex","items-center","justify-between"],[1,"text-lg","font-semibold","text-amber-600","dark:text-amber-400"],["type","number","formControlName","customMonthlyPayment","placeholder","0.00","step","0.01",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-amber-500","focus:border-transparent"],[1,"text-sm","font-semibold","text-blue-800","dark:text-blue-200","mb-4","flex","items-center","gap-2"],[1,"text-blue-600","dark:text-blue-400"],["type","number","formControlName","dueDate","placeholder","15","min","1","max","31",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","number","formControlName","billingCycleStart","placeholder","1","min","1","max","31",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","number","formControlName","creditLimit","placeholder","0.00","step","0.01","min","0",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","number","formControlName","minimumPayment","placeholder","0.00","step","0.01","min","0",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","checkbox","formControlName","creditCardShowReminder",1,"w-4","h-4","text-blue-600","bg-gray-100","border-gray-300","rounded","focus:ring-blue-500","dark:focus:ring-blue-600","dark:ring-offset-gray-800","focus:ring-2","dark:bg-gray-700","dark:border-gray-600"]],template:function(r,a){if(r&1&&(c(0,"app-common-header",0),N("addButtonClick",function(){return a.onSubmit()})("closeButtonClick",function(){return a.onClose()}),l(),c(1,"app-common-body-content")(2,"form",1),N("ngSubmit",function(){return a.onSubmit()}),c(3,"div",2)(4,"label",3),d(5," Account Name * "),l(),se(6,"input",4),c(7,"div",5),X(8,bO,2,0,"p",6)(9,yO,2,0,"p",6),c(10,"span",7),d(11),l()()(),c(12,"div",2)(13,"label",3),d(14," Account Type * "),l(),c(15,"mat-form-field",8)(16,"mat-label"),d(17,"Select account type"),l(),c(18,"mat-select",9),Ge(19,MO,2,2,"mat-option",10,_g),l(),X(21,wO,2,0,"mat-error"),l()(),c(22,"div",2)(23,"label",3),d(24," Initial Balance * "),l(),se(25,"input",11),X(26,SO,2,1,"p",12),l(),X(27,FO,82,6,"div",13)(28,VO,34,4,"div",14),se(29,"div",15),l()()),r&2){let o,s,u,m;w("title",(a.dialogData!=null&&a.dialogData.accountId?"Edit":"Add")+" Account")("showAddButton",!0)("addButtonDisabled",a.accountForm.invalid)("isSubmitting",a.isSubmitting),p(2),w("formGroup",a.accountForm),p(4),w("maxlength",50),p(2),ot((o=a.accountForm.get("name"))!=null&&o.hasError("required")&&((o=a.accountForm.get("name"))!=null&&o.touched)?8:-1),p(),ot((s=a.accountForm.get("name"))!=null&&s.hasError("maxlength")?9:-1),p(2),oe(" ",((u=a.accountForm.get("name"))==null||u.value==null?null:u.value.length)||0,"/50 "),p(8),He(a.accountTypes),p(2),ot((m=a.accountForm.get("type"))!=null&&m.hasError("required")&&((m=a.accountForm.get("type"))!=null&&m.touched)?21:-1),p(5),ot(a.getBalanceError()?26:-1),p(),ot(a.isLoanAccount()?27:-1),p(),ot(a.isCreditCardAccount()?28:-1)}},dependencies:[jn,Vt,ki,o1,Ut,Un,Js,Ks,Xs,Ei,Ti,at,Ji,Zr,Sa,Ni,Fi,yo,Mo,Wi],styles:["[_nghost-%COMP%]{display:block;max-width:600px;width:100%}mat-form-field[_ngcontent-%COMP%]{width:100%}button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}button[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}button[_ngcontent-%COMP%]:active{transform:translateY(0)}button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.text-red-500[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shake .5s ease-in-out}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}25%{transform:translate(-5px)}75%{transform:translate(5px)}}.text-green-500[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse .5s ease-in-out}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1)}50%{transform:scale(1.05)}to{transform:scale(1)}}*[_ngcontent-%COMP%]{transition:background-color .3s ease,color .3s ease,border-color .3s ease}"]});let e=n;return e})();function UO(e,n){if(e&1){let i=be();c(0,"button",14),N("click",function(){G(i);let r=S();return H(r.clearSearch())}),c(1,"mat-icon"),d(2,"clear"),l()()}}function jO(e,n){if(e&1){let i=be();c(0,"div",15)(1,"mat-icon",16),d(2,"search_off"),l(),c(3,"p",17),d(4,"No icons found"),l(),c(5,"button",18),N("click",function(){G(i);let r=S();return H(r.clearSearch())}),d(6," Clear Search "),l()()}}function zO(e,n){if(e&1){let i=be();c(0,"button",21),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.selectIcon(r))}),c(1,"mat-icon",22),d(2),l(),c(3,"span",23),d(4),l()()}if(e&2){let i=n.$implicit,t=S(2);Je("selected",t.selectedIcon===i),ga("aria-label","Select "+i+" icon"),p(2),z(i),p(2),z(i)}}function WO(e,n){if(e&1&&(c(0,"div",19),X(1,zO,5,5,"button",20),l()),e&2){let i=S();p(),w("ngForOf",i.filteredIcons)("ngForTrackBy",i.trackByIcon)}}var c_=(()=>{let n=class n{constructor(t,r){this.dialogRef=t,this.data=r,this.availableIcons=H1,this.searchTerm="",this.filteredIcons=[],this.selectedIcon=r.currentIcon||"category",this.filteredIcons=[...this.availableIcons]}ngOnInit(){this.data.availableIcons&&(this.availableIcons=this.data.availableIcons,this.filteredIcons=[...this.availableIcons])}selectIcon(t){this.selectedIcon=t,this.dialogRef.close(t)}onSearchChange(){this.searchTerm.trim()?this.filteredIcons=this.availableIcons.filter(t=>t.toLowerCase().includes(this.searchTerm.toLowerCase())):this.filteredIcons=[...this.availableIcons]}clearSearch(){this.searchTerm="",this.filteredIcons=[...this.availableIcons]}onCancel(){this.dialogRef.close()}trackByIcon(t,r){return r}};n.\u0275fac=function(r){return new(r||n)(q(fi),q(pi))},n.\u0275cmp=Ve({type:n,selectors:[["app-icon-selector-dialog"]],decls:19,vars:4,consts:[[1,"icon-selector-dialog"],[1,"dialog-header"],[1,"dialog-title"],["mat-icon-button","","aria-label","Close",1,"close-button",3,"click"],[1,"search-container"],[1,"search-input-wrapper"],[1,"search-icon"],["type","text","placeholder","Search icons...","autocomplete","off","spellcheck","false",1,"search-input",3,"ngModelChange","input","ngModel"],["mat-icon-button","","class","clear-search-button","type","button","aria-label","Clear search",3,"click",4,"ngIf"],[1,"icons-container"],["class","no-results",4,"ngIf"],["class","icons-grid",4,"ngIf"],[1,"dialog-actions"],["mat-stroked-button","",1,"cancel-button",3,"click"],["mat-icon-button","","type","button","aria-label","Clear search",1,"clear-search-button",3,"click"],[1,"no-results"],[1,"no-results-icon"],[1,"no-results-text"],["mat-stroked-button","",1,"clear-search-btn",3,"click"],[1,"icons-grid"],["type","button","class","icon-option",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"icon-option",3,"click"],[1,"icon"],[1,"icon-name"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"h2",2),d(3,"Choose Icon"),l(),c(4,"button",3),N("click",function(){return a.onCancel()}),c(5,"mat-icon"),d(6,"close"),l()()(),c(7,"div",4)(8,"div",5)(9,"mat-icon",6),d(10,"search"),l(),c(11,"input",7),gt("ngModelChange",function(s){return mt(a.searchTerm,s)||(a.searchTerm=s),s}),N("input",function(){return a.onSearchChange()}),l(),X(12,UO,3,0,"button",8),l()(),c(13,"div",9),X(14,jO,7,0,"div",10)(15,WO,2,2,"div",11),l(),c(16,"div",12)(17,"button",13),N("click",function(){return a.onCancel()}),d(18," Cancel "),l()()()),r&2&&(p(11),ut("ngModel",a.searchTerm),p(),w("ngIf",a.searchTerm),p(2),w("ngIf",a.filteredIcons&&a.filteredIcons.length===0),p(),w("ngIf",a.filteredIcons&&a.filteredIcons.length>0))},dependencies:[$r,ct,Vt,Ut,Zn,Ht,bn,at],styles:[".icon-selector-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:90vh;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 10px 25px #0000001a}@media (max-width: 640px){.icon-selector-dialog[_ngcontent-%COMP%]{height:100vh;max-height:100vh;border-radius:0}}.dialog-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.25rem 1.5rem;border-bottom:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.dialog-header[_ngcontent-%COMP%]{padding:1rem}}.dialog-header[_ngcontent-%COMP%]   .dialog-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1e293b;margin:0}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#64748b;min-width:40px;min-height:40px;border-radius:8px}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#334155;background:#f8fafc}.search-container[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-bottom:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.search-container[_ngcontent-%COMP%]{padding:.75rem 1rem}}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:.75rem;color:#94a3b8;font-size:1.125rem;width:1.125rem;height:1.125rem;pointer-events:none}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:.75rem .75rem .75rem 2.25rem;border:1px solid #e2e8f0;border-radius:8px;font-size:.875rem;background:#f8fafc;transition:all .2s ease;min-height:40px}@media (max-width: 640px){.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{min-height:44px;font-size:16px}}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;background:#fff;box-shadow:0 0 0 3px #3b82f61a}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .clear-search-button[_ngcontent-%COMP%]{position:absolute;right:.5rem;color:#94a3b8;min-width:28px;min-height:28px;border-radius:6px}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .clear-search-button[_ngcontent-%COMP%]:hover{color:#64748b;background:#f1f5f9}.icons-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:1rem 1.5rem;background:#fafafa}@media (max-width: 640px){.icons-container[_ngcontent-%COMP%]{padding:.75rem 1rem}}.icons-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.icons-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.icons-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:2px}.icons-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.icons-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.icons-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .no-results-icon[_ngcontent-%COMP%]{font-size:2.5rem;width:2.5rem;height:2.5rem;color:#94a3b8;margin-bottom:.75rem}.icons-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .no-results-text[_ngcontent-%COMP%]{color:#64748b;font-size:.875rem;margin:0 0 1rem}.icons-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .clear-search-btn[_ngcontent-%COMP%]{min-height:36px;padding:.5rem 1rem;font-size:.875rem}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(72px,1fr));gap:.5rem}@media (min-width: 768px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:.75rem}}@media (max-width: 640px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(64px,1fr));gap:.5rem}}@media (max-width: 480px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(56px,1fr));gap:.5rem}}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:.75rem;border:1px solid #e2e8f0;border-radius:8px;background:#fff;cursor:pointer;transition:all .15s ease;min-height:72px;text-decoration:none}@media (min-width: 768px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{min-height:90px;padding:.75rem .5rem;justify-content:space-between}}@media (max-width: 640px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{min-height:64px;padding:.5rem}}@media (max-width: 480px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{min-height:56px;padding:.5rem}}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#f0f9ff;transform:translateY(-1px);box-shadow:0 2px 8px #3b82f61a}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option.selected[_ngcontent-%COMP%]{border-color:#3b82f6;background:#dbeafe;color:#1d4ed8;transform:translateY(-1px);box-shadow:0 2px 8px #3b82f626}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.75rem;width:1.75rem;height:1.75rem;color:inherit}@media (min-width: 768px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:2rem;width:2rem;height:2rem;margin-bottom:.25rem}}@media (max-width: 640px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem}}@media (max-width: 480px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}}.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{display:none;font-size:.75rem;font-weight:500;color:#64748b;text-align:center;word-break:break-word;line-height:1.2;text-transform:capitalize;margin-top:.25rem}@media (min-width: 768px){.icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{display:block}}.icon-option.selected[_ngcontent-%COMP%]   .icons-container[_ngcontent-%COMP%]   .icons-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{color:#1d4ed8;font-weight:600}.dialog-actions[_ngcontent-%COMP%]{display:flex;padding:1rem 1.5rem;border-top:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.dialog-actions[_ngcontent-%COMP%]{padding:.75rem 1rem}}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{width:100%;min-height:40px;padding:.75rem 1.5rem;font-weight:500;color:#64748b;border-color:#e2e8f0}@media (max-width: 640px){.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{min-height:44px}}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]:hover{color:#334155;border-color:#cbd5e1;background:#f8fafc}@keyframes _ngcontent-%COMP%_fadeInUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.icon-selector-dialog[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .2s ease-out}"]});let e=n;return e})();function YO(e,n){if(e&1){let i=be();c(0,"button",14),N("click",function(){G(i);let r=S();return H(r.clearSearch())}),c(1,"mat-icon"),d(2,"clear"),l()()}}function $O(e,n){if(e&1){let i=be();c(0,"div",15)(1,"mat-icon",16),d(2,"search_off"),l(),c(3,"p",17),d(4,"No colors found"),l(),c(5,"button",18),N("click",function(){G(i);let r=S();return H(r.clearSearch())}),d(6," Clear Search "),l()()}}function GO(e,n){e&1&&(c(0,"mat-icon",23),d(1,"check"),l())}function HO(e,n){if(e&1){let i=be();c(0,"button",21),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.selectColor(r.value))}),c(1,"span",22),d(2),l(),X(3,GO,2,0,"mat-icon",23),l()}if(e&2){let i=n.$implicit,t=S(2);Xt("background-color",i.value),Je("selected",t.selectedColor===i.value),ga("aria-label","Select "+i.label+" color"),p(2),z(i.label),p(),ot(t.selectedColor===i.value?3:-1)}}function qO(e,n){if(e&1&&(c(0,"div",19),Ge(1,HO,4,7,"button",20,Oi),l()),e&2){let i=S();p(),He(i.filteredColors)}}var l_=(()=>{let n=class n{constructor(t,r){this.dialogRef=t,this.data=r,this.availableColors=q1,this.searchTerm="",this.filteredColors=[],this.selectedColor=r.currentColor||"#46777f",this.filteredColors=[...this.availableColors]}ngOnInit(){}selectColor(t){this.selectedColor=t,this.dialogRef.close(t)}onSearchChange(){this.searchTerm.trim()?this.filteredColors=this.availableColors.filter(t=>t.label.toLowerCase().includes(this.searchTerm.toLowerCase())):this.filteredColors=[...this.availableColors]}clearSearch(){this.searchTerm="",this.filteredColors=[...this.availableColors]}onCancel(){this.dialogRef.close()}trackByColor(t,r){return r}};n.\u0275fac=function(r){return new(r||n)(q(fi),q(pi))},n.\u0275cmp=Ve({type:n,selectors:[["app-color-selector-dialog"]],decls:19,vars:4,consts:[[1,"color-selector-dialog"],[1,"dialog-header"],[1,"dialog-title"],["mat-icon-button","","aria-label","Close",1,"close-button",3,"click"],[1,"search-container"],[1,"search-input-wrapper"],[1,"search-icon"],["type","text","placeholder","Search colors...","autocomplete","off","spellcheck","false",1,"search-input",3,"ngModelChange","input","ngModel"],["mat-icon-button","","class","clear-search-button","type","button","aria-label","Clear search",3,"click",4,"ngIf"],[1,"colors-container"],["class","no-results",4,"ngIf"],["class","colors-grid",4,"ngIf"],[1,"dialog-actions"],["mat-stroked-button","",1,"cancel-button",3,"click"],["mat-icon-button","","type","button","aria-label","Clear search",1,"clear-search-button",3,"click"],[1,"no-results"],[1,"no-results-icon"],[1,"no-results-text"],["mat-stroked-button","",1,"clear-search-btn",3,"click"],[1,"colors-grid"],["type","button",1,"color-option",3,"selected","background-color"],["type","button",1,"color-option",3,"click"],[1,"color-name"],[1,"check-icon"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"h2",2),d(3,"Choose Color"),l(),c(4,"button",3),N("click",function(){return a.onCancel()}),c(5,"mat-icon"),d(6,"close"),l()()(),c(7,"div",4)(8,"div",5)(9,"mat-icon",6),d(10,"search"),l(),c(11,"input",7),gt("ngModelChange",function(s){return mt(a.searchTerm,s)||(a.searchTerm=s),s}),N("input",function(){return a.onSearchChange()}),l(),X(12,YO,3,0,"button",8),l()(),c(13,"div",9),X(14,$O,7,0,"div",10)(15,qO,3,0,"div",11),l(),c(16,"div",12)(17,"button",13),N("click",function(){return a.onCancel()}),d(18," Cancel "),l()()()),r&2&&(p(11),ut("ngModel",a.searchTerm),p(),w("ngIf",a.searchTerm),p(2),w("ngIf",a.filteredColors.length===0),p(),w("ngIf",a.filteredColors.length>0))},dependencies:[ct,Vt,Ut,Zn,Ht,bn,at],styles:[".color-selector-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:90vh;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 10px 25px #0000001a}@media (max-width: 640px){.color-selector-dialog[_ngcontent-%COMP%]{height:100vh;max-height:100vh;border-radius:0}}.dialog-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.25rem 1.5rem;border-bottom:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.dialog-header[_ngcontent-%COMP%]{padding:1rem}}.dialog-header[_ngcontent-%COMP%]   .dialog-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1e293b;margin:0}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#64748b;min-width:40px;min-height:40px;border-radius:8px}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#334155;background:#f8fafc}.search-container[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-bottom:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.search-container[_ngcontent-%COMP%]{padding:.75rem 1rem}}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:.75rem;color:#94a3b8;font-size:1.125rem;width:1.125rem;height:1.125rem;pointer-events:none}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:.75rem .75rem .75rem 2.25rem;border:1px solid #e2e8f0;border-radius:8px;font-size:.875rem;background:#f8fafc;transition:all .2s ease;min-height:40px}@media (max-width: 640px){.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{min-height:44px;font-size:16px}}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;background:#fff;box-shadow:0 0 0 3px #3b82f61a}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .clear-search-button[_ngcontent-%COMP%]{position:absolute;right:.5rem;color:#94a3b8;min-width:28px;min-height:28px;border-radius:6px}.search-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .clear-search-button[_ngcontent-%COMP%]:hover{color:#64748b;background:#f1f5f9}.colors-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:1rem 1.5rem;background:#fafafa}@media (max-width: 640px){.colors-container[_ngcontent-%COMP%]{padding:.75rem 1rem}}.colors-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.colors-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.colors-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:2px}.colors-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.colors-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.colors-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .no-results-icon[_ngcontent-%COMP%]{font-size:2.5rem;width:2.5rem;height:2.5rem;color:#94a3b8;margin-bottom:.75rem}.colors-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .no-results-text[_ngcontent-%COMP%]{color:#64748b;font-size:.875rem;margin:0 0 1rem}.colors-container[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   .clear-search-btn[_ngcontent-%COMP%]{min-height:36px;padding:.5rem 1rem;font-size:.875rem}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(72px,1fr));gap:.5rem}@media (min-width: 768px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:.75rem}}@media (max-width: 640px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(64px,1fr));gap:.5rem}}@media (max-width: 480px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(56px,1fr));gap:.5rem}}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:.75rem;border:1px solid #e2e8f0;border-radius:8px;background:#fff;cursor:pointer;transition:all .15s ease;min-height:72px;position:relative}@media (min-width: 768px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{min-height:90px;padding:.75rem .5rem;justify-content:space-between}}@media (max-width: 640px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{min-height:64px;padding:.5rem}}@media (max-width: 480px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{min-height:56px;padding:.5rem}}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#f0f9ff;transform:translateY(-1px);box-shadow:0 2px 8px #3b82f61a}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option.selected[_ngcontent-%COMP%]{border-color:#3b82f6;transform:translateY(-1px);box-shadow:0 2px 8px #3b82f626}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option.selected[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{opacity:1;transform:scale(1)}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:1.75rem;height:1.75rem;border-radius:50%;border:2px solid white;box-shadow:0 2px 4px #0000001a}@media (min-width: 768px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:2rem;height:2rem;margin-bottom:.25rem}}@media (max-width: 640px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem}}@media (max-width: 480px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:1.25rem;height:1.25rem}}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{display:none;font-size:.75rem;font-weight:500;font-family:Roboto Mono,monospace;color:#64748b;text-align:center;word-break:break-word;line-height:1.2;margin-top:.25rem;background-color:#ffffff80;padding:5px;border-radius:5px}@media (min-width: 768px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{display:block}}.color-option.selected[_ngcontent-%COMP%]   .colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{color:#1d4ed8;font-weight:600}.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{position:absolute;top:.25rem;right:.25rem;color:#fff;font-size:.875rem;width:.875rem;height:.875rem;background:#000000b3;border-radius:50%;padding:.125rem;opacity:0;transform:scale(0);transition:all .15s ease}@media (min-width: 768px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}}@media (max-width: 640px){.colors-container[_ngcontent-%COMP%]   .colors-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{font-size:.75rem;width:.75rem;height:.75rem}}.dialog-actions[_ngcontent-%COMP%]{display:flex;padding:1rem 1.5rem;border-top:1px solid #f1f5f9;background:#fff}@media (max-width: 640px){.dialog-actions[_ngcontent-%COMP%]{padding:.75rem 1rem}}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{width:100%;min-height:40px;padding:.75rem 1.5rem;font-weight:500;color:#64748b;border-color:#e2e8f0}@media (max-width: 640px){.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{min-height:44px}}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]:hover{color:#334155;border-color:#cbd5e1;background:#f8fafc}@keyframes _ngcontent-%COMP%_fadeInUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.color-selector-dialog[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .2s ease-out}"]});let e=n;return e})();function XO(e,n){if(e&1&&(c(0,"p",9),d(1),l()),e&2){let i=S();p(),z(i.getNameError())}}function KO(e,n){if(e&1&&(c(0,"p",9),d(1),l()),e&2){let i=S();p(),z(i.getTypeError())}}var ss=(()=>{let n=class n{constructor(t,r,a,o,s,u,m,f,h,_,y){this.dialogData=t,this.store=r,this.fb=a,this.dialogRef=o,this.auth=s,this.notificationService=u,this.router=m,this.hapticFeedback=f,this.dialog=h,this.validationService=_,this.ssrService=y,this.isSubmitting=!1,this.userId="",this.categoryForm=this.fb.group({name:["",this.validationService.getCategoryNameValidators()],type:["expense",Qe.required],icon:["category",Qe.required],color:["#46777f",Qe.required]})}ngOnInit(){var t;this.userId=((t=this.auth.currentUser)==null?void 0:t.uid)||"",this.ssrService.isClientSide()&&window.addEventListener("popstate",r=>{this.dialogRef.close(),r.preventDefault()}),this.dialogData&&this.categoryForm.patchValue({name:this.dialogData.name,type:this.dialogData.type,icon:this.dialogData.icon||"category",color:this.dialogData.color||"#46777f"})}onSubmit(){return ue(this,null,function*(){var t;if(this.categoryForm.valid&&!this.isSubmitting){this.isSubmitting=!0;try{let r=this.categoryForm.value;(t=this.dialogData)!=null&&t.id?(yield this.store.dispatch(ba({userId:this.userId,categoryId:this.dialogData.id,name:r.name.trim(),categoryType:r.type,icon:r.icon,color:r.color})),this.notificationService.success("Category updated successfully")):(yield this.store.dispatch(tc({userId:this.userId,name:r.name.trim(),categoryType:r.type,icon:r.icon,color:r.color})),this.notificationService.success("Category added successfully"),this.hapticFeedback.successVibration()),this.dialogRef.close(!0)}catch(r){this.notificationService.error("Failed to save category"),console.error("Error saving category:",r)}finally{this.isSubmitting=!1}}})}onCancel(){this.dialogRef.close(!1)}selectType(t){this.categoryForm.patchValue({type:t})}getNameError(){let t=this.categoryForm.get("name");return t?this.validationService.getAccountNameError(t):""}getTypeError(){let t=this.categoryForm.get("type");return t!=null&&t.hasError("required")?"Category type is required":""}openIconSelectorDialog(){var t;this.dialog.open(c_,{width:"90vw",maxWidth:"500px",height:"80vh",maxHeight:"600px",data:{currentIcon:(t=this.categoryForm.get("icon"))==null?void 0:t.value},disableClose:!1,autoFocus:!1}).afterClosed().subscribe(r=>{r&&(this.categoryForm.patchValue({icon:r}),this.hapticFeedback.lightVibration())})}openColorSelectorDialog(){var r;this.dialog.open(l_,{width:"90vw",maxWidth:"500px",height:"80vh",maxHeight:"600px",data:{currentColor:(r=this.categoryForm.get("color"))==null?void 0:r.value},disableClose:!1,autoFocus:!1}).afterClosed().subscribe(a=>{a&&(this.categoryForm.patchValue({color:a}),this.hapticFeedback.lightVibration())})}};n.\u0275fac=function(r){return new(r||n)(q(pi),q(wt),q(Ii),q(fi),q(pt),q(ht),q(Kt),q(Sr),q(fn),q(qr),q(Pr))},n.\u0275cmp=Ve({type:n,selectors:[["app-mobile-category-add-edit-popup"]],decls:60,vars:24,consts:[[3,"addButtonClick","closeButtonClick","title","isSubmitting","showCloseButton","showAddButton","addButtonTooltip","addButtonDisabled","closeButtonTooltip"],[1,"mobile-content"],[1,"form-container"],[1,"category-form",3,"ngSubmit","formGroup"],[1,"form-field"],[1,"field-label"],[1,"field-icon"],["type","text","formControlName","name","placeholder","e.g., Groceries","autofocus","",1,"form-input"],[1,"field-footer"],[1,"error-message"],[1,"character-count"],[1,"type-selector"],["type","button",1,"type-option",3,"click"],[1,"icon-selector"],["type","button",1,"icon-preview-button",3,"click"],[1,"icon-preview"],[1,"selected-icon"],[1,"icon-name"],[1,"dropdown-icon"],[1,"color-selector"],["type","button",1,"color-preview-button",3,"click"],[1,"color-preview"],[1,"color-swatch"],[1,"color-name"],[1,"bottom-spacing"]],template:function(r,a){if(r&1&&(c(0,"app-common-header",0),N("addButtonClick",function(){return a.onSubmit()})("closeButtonClick",function(){return a.onCancel()}),l(),c(1,"app-common-body-content")(2,"div",1)(3,"div",2)(4,"form",3),N("ngSubmit",function(){return a.onSubmit()}),c(5,"div",4)(6,"label",5)(7,"mat-icon",6),d(8,"label"),l(),d(9," Category Name * "),l(),se(10,"input",7),c(11,"div",8),X(12,XO,2,1,"p",9),c(13,"span",10),d(14),l()()(),c(15,"div",4)(16,"label",5)(17,"mat-icon",6),d(18,"category"),l(),d(19," Category Type * "),l(),c(20,"div",11)(21,"button",12),N("click",function(){return a.selectType("expense")}),c(22,"mat-icon"),d(23,"trending_down"),l(),c(24,"span"),d(25,"Expense"),l()(),c(26,"button",12),N("click",function(){return a.selectType("income")}),c(27,"mat-icon"),d(28,"trending_up"),l(),c(29,"span"),d(30,"Income"),l()()(),X(31,KO,2,1,"p",9),l(),c(32,"div",4)(33,"label",5)(34,"mat-icon",6),d(35,"emoji_emotions"),l(),d(36," Category Icon * "),l(),c(37,"div",13)(38,"button",14),N("click",function(){return a.openIconSelectorDialog()}),c(39,"div",15)(40,"mat-icon",16),d(41),l(),c(42,"span",17),d(43),l()(),c(44,"mat-icon",18),d(45,"expand_more"),l()()()(),c(46,"div",4)(47,"label",5)(48,"mat-icon",6),d(49,"palette"),l(),d(50," Category Color * "),l(),c(51,"div",19)(52,"button",20),N("click",function(){return a.openColorSelectorDialog()}),c(53,"div",21),se(54,"div",22),c(55,"span",23),d(56),l()(),c(57,"mat-icon",18),d(58,"expand_more"),l()()()(),se(59,"div",24),l()()()()),r&2){let o,s,u,m,f,h,_,y,v,C,P;w("title",a.dialogData!=null&&a.dialogData.id?"Edit":"Add Category")("isSubmitting",a.isSubmitting)("showCloseButton",!0)("showAddButton",!0)("addButtonTooltip",a.isSubmitting?"Saving...":"Save Category")("addButtonDisabled",a.categoryForm.invalid||a.isSubmitting)("closeButtonTooltip",a.isSubmitting?"Saving...":"Close"),p(4),w("formGroup",a.categoryForm),p(8),ot(a.getNameError()&&((o=a.categoryForm.get("name"))!=null&&o.touched)?12:-1),p(2),oe(" ",((s=a.categoryForm.get("name"))==null||s.value==null?null:s.value.length)||0,"/50 "),p(7),Je("selected",((u=a.categoryForm.get("type"))==null?null:u.value)==="expense"),p(5),Je("selected",((m=a.categoryForm.get("type"))==null?null:m.value)==="income"),p(5),ot(a.getTypeError()&&((f=a.categoryForm.get("type"))!=null&&f.touched)?31:-1),p(7),Je("active",(h=a.categoryForm.get("icon"))==null?null:h.value),p(3),z(((_=a.categoryForm.get("icon"))==null?null:_.value)||"category"),p(2),z(((y=a.categoryForm.get("icon"))==null?null:y.value)||"category"),p(9),Je("active",(v=a.categoryForm.get("color"))==null?null:v.value),p(2),Xt("background-color",((C=a.categoryForm.get("color"))==null?null:C.value)||"#005cbb"),p(2),z(((P=a.categoryForm.get("color"))==null?null:P.value)||"#005cbb")}},dependencies:[jn,Vt,Ut,Un,Ei,Ti,at,yo,Mo],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:flex;flex-direction:column;height:100vh;background-color:#f9fafb;max-width:100vw;overflow:hidden}.dark   [_nghost-%COMP%]{background-color:#111827}.mobile-header[_ngcontent-%COMP%]{position:sticky;top:0;z-index:20;background:#fff;border-bottom:1px solid #e5e7eb;box-shadow:0 1px 3px #0000001a}.dark[_ngcontent-%COMP%]   .mobile-header[_ngcontent-%COMP%]{background:#1f2937;border-color:#374151}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;min-height:60px}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{padding:.5rem .75rem;min-height:56px}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;flex:1}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{gap:.5rem}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{min-width:44px;min-height:44px;color:#6b7280}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{min-width:40px;min-height:40px}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.dark[_ngcontent-%COMP%]   .mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#9ca3af}.dark[_ngcontent-%COMP%]   .mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{background:#374151;color:#f3f4f6}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .mobile-only[_ngcontent-%COMP%]{display:flex}@media (min-width: 768px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .mobile-only[_ngcontent-%COMP%]{display:none}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .desktop-only[_ngcontent-%COMP%]{display:none}@media (min-width: 768px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .desktop-only[_ngcontent-%COMP%]{display:flex}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .desktop-only[_ngcontent-%COMP%]{display:none}@media (min-width: 768px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .desktop-only[_ngcontent-%COMP%]{display:flex}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .mobile-only[_ngcontent-%COMP%]{display:flex}@media (min-width: 768px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .mobile-only[_ngcontent-%COMP%]{display:none}}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1f2937;margin:0}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:1rem}}@media (max-width: 360px){.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:.875rem}}.dark[_ngcontent-%COMP%]   .mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{color:#f9fafb}.mobile-header[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{min-height:44px;padding:.5rem 1rem;display:flex;align-items:center;gap:.5rem;font-weight:500}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{min-height:40px;padding:.5rem .75rem;font-size:.875rem}}@media (max-width: 360px){.mobile-header[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{padding:.5rem;font-size:.75rem}}.mobile-header[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:disabled{opacity:.6}.mobile-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;background:#f9fafb;-webkit-overflow-scrolling:touch}.dark[_ngcontent-%COMP%]   .mobile-content[_ngcontent-%COMP%]{background:#111827}.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:1rem;max-width:600px;margin:0 auto;margin-bottom:2rem}@media (max-width: 480px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:.75rem}}@media (max-width: 360px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:.5rem}}.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .category-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}@media (max-width: 480px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .category-form[_ngcontent-%COMP%]{gap:1.25rem}}@media (max-width: 360px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .category-form[_ngcontent-%COMP%]{gap:1rem}}.form-field[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.25rem;box-shadow:0 1px 3px #0000001a;border:1px solid #e5e7eb}@media (max-width: 480px){.form-field[_ngcontent-%COMP%]{padding:1rem;border-radius:10px}}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]{padding:.875rem;border-radius:8px}}.dark[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{background:#1f2937;border-color:#374151}.form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.75rem}@media (max-width: 480px){.form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]{font-size:.8rem;margin-bottom:.625rem}}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]{font-size:.75rem;margin-bottom:.5rem}}.dark[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]{color:#f3f4f6}.form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]   .field-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem;color:#6b7280}@media (max-width: 480px){.form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]   .field-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}}.form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem;border:1px solid #d1d5db;border-radius:8px;background:transparent;font-size:16px;min-height:48px;transition:all .2s ease}@media (max-width: 480px){.form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding:.75rem .875rem;min-height:44px;font-size:15px}}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding:.625rem .75rem;min-height:40px;font-size:14px}}.dark[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{border-color:#4b5563;color:#f9fafb}.form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.form-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:.5rem}@media (max-width: 480px){.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]{margin-top:.375rem}}.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#dc2626;font-size:.75rem;margin:0}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{font-size:.7rem}}.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]   .character-count[_ngcontent-%COMP%]{color:#6b7280;font-size:.75rem}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]   .field-footer[_ngcontent-%COMP%]   .character-count[_ngcontent-%COMP%]{font-size:.7rem}}.form-field[_ngcontent-%COMP%]   .field-hint[_ngcontent-%COMP%]{color:#6b7280;font-size:.75rem;margin-top:.25rem;font-style:italic}@media (max-width: 360px){.form-field[_ngcontent-%COMP%]   .field-hint[_ngcontent-%COMP%]{font-size:.7rem}}.type-selector[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}@media (max-width: 480px){.type-selector[_ngcontent-%COMP%]{gap:.5rem}}@media (max-width: 360px){.type-selector[_ngcontent-%COMP%]{gap:.375rem}}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.5rem;padding:1rem;border:2px solid #e5e7eb;border-radius:8px;background:transparent;cursor:pointer;transition:all .2s ease;min-height:80px}@media (max-width: 480px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{padding:.75rem;min-height:70px;gap:.375rem}}@media (max-width: 360px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{padding:.625rem;min-height:60px;gap:.25rem}}.dark[_ngcontent-%COMP%]   .type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{border-color:#4b5563}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#eff6ff}.type-selector[_ngcontent-%COMP%]   .type-option.selected[_ngcontent-%COMP%]{border-color:#3b82f6;background:#dbeafe;color:#1d4ed8}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem}@media (max-width: 480px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}}@media (max-width: 360px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500}@media (max-width: 480px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem}}@media (max-width: 360px){.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.7rem}}.icon-selector[_ngcontent-%COMP%]{position:relative}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;padding:.875rem 1rem;border:1px solid #d1d5db;border-radius:8px;background:transparent;cursor:pointer;transition:all .2s ease;min-height:48px}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]{padding:.75rem .875rem;min-height:44px}}@media (max-width: 360px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]{padding:.625rem .75rem;min-height:40px}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]{border-color:#4b5563}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button.active[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]{gap:.5rem}}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .selected-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem;color:#3b82f6}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .selected-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{color:#374151;font-family:Roboto Mono,monospace;font-size:.875rem}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 360px){.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{font-size:.75rem}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .icon-preview[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{color:#f3f4f6}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button[_ngcontent-%COMP%]   .dropdown-icon[_ngcontent-%COMP%]{color:#6b7280;transition:transform .2s ease}.icon-selector[_ngcontent-%COMP%]   .icon-preview-button.active[_ngcontent-%COMP%]   .dropdown-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;z-index:50;margin-top:.25rem;background:#fff;border:1px solid #d1d5db;border-radius:8px;box-shadow:0 10px 25px #00000026;max-height:300px;overflow:hidden;animation:_ngcontent-%COMP%_slideDown .2s ease-out}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]{max-height:250px}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]{background:#1f2937;border-color:#4b5563}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;border-bottom:1px solid #e5e7eb}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]{padding:.625rem .875rem}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]{border-color:#374151}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151;margin:0}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:.8rem}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#f3f4f6}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{min-width:32px;min-height:32px;color:#6b7280}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{min-width:28px;min-height:28px}}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]:hover{background:#f3f4f6}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{color:#9ca3af}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]:hover{background:#374151}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(6,1fr);gap:.5rem;padding:1rem;max-height:250px;overflow-y:auto}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(5,1fr);gap:.375rem;padding:.75rem;max-height:200px}}@media (max-width: 360px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr);gap:.25rem;padding:.625rem}}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:.75rem;border:1px solid #e5e7eb;border-radius:8px;background:transparent;cursor:pointer;transition:all .2s ease;min-height:44px}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{padding:.625rem;min-height:40px}}@media (max-width: 360px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{padding:.5rem;min-height:36px}}.dark[_ngcontent-%COMP%]   .icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]{border-color:#4b5563}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#eff6ff;transform:scale(1.05)}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option.selected[_ngcontent-%COMP%]{border-color:#3b82f6;background:#dbeafe;color:#1d4ed8}.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}@media (max-width: 480px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}}@media (max-width: 360px){.icon-selector[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}}.color-selector[_ngcontent-%COMP%]{position:relative}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;padding:.875rem 1rem;border:1px solid #d1d5db;border-radius:8px;background:transparent;cursor:pointer;transition:all .2s ease;min-height:48px}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]{padding:.75rem .875rem;min-height:44px}}@media (max-width: 360px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]{padding:.625rem .75rem;min-height:40px}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]{border-color:#4b5563}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.color-selector[_ngcontent-%COMP%]   .color-preview-button.active[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{gap:.5rem}}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-swatch[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:6px;border:2px solid #e5e7eb;flex-shrink:0}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-swatch[_ngcontent-%COMP%]{width:20px;height:20px}}@media (max-width: 360px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-swatch[_ngcontent-%COMP%]{width:18px;height:18px}}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{color:#374151;font-family:Roboto Mono,monospace;font-size:.875rem}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 360px){.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{font-size:.75rem}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-name[_ngcontent-%COMP%]{color:#f3f4f6}.color-selector[_ngcontent-%COMP%]   .color-preview-button[_ngcontent-%COMP%]   .dropdown-icon[_ngcontent-%COMP%]{color:#6b7280;transition:transform .2s ease}.color-selector[_ngcontent-%COMP%]   .color-preview-button.active[_ngcontent-%COMP%]   .dropdown-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;z-index:50;margin-top:.25rem;background:#fff;border:1px solid #d1d5db;border-radius:8px;box-shadow:0 10px 25px #00000026;max-height:300px;overflow:hidden;animation:_ngcontent-%COMP%_slideDown .2s ease-out}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]{max-height:250px}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]{background:#1f2937;border-color:#4b5563}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;border-bottom:1px solid #e5e7eb}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]{padding:.625rem .875rem}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]{border-color:#374151}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151;margin:0}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:.8rem}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#f3f4f6}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{min-width:32px;min-height:32px;color:#6b7280}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{min-width:28px;min-height:28px}}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]:hover{background:#f3f4f6}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]{color:#9ca3af}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-picker-header[_ngcontent-%COMP%]   .close-picker[_ngcontent-%COMP%]:hover{background:#374151}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(8,1fr);gap:.5rem;padding:1rem;max-height:250px;overflow-y:auto}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(6,1fr);gap:.375rem;padding:.75rem;max-height:200px}}@media (max-width: 360px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(5,1fr);gap:.25rem;padding:.625rem}}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:.75rem;border:2px solid #e5e7eb;border-radius:8px;cursor:pointer;transition:all .2s ease;min-height:44px;position:relative}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{padding:.625rem;min-height:40px}}@media (max-width: 360px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{padding:.5rem;min-height:36px}}.dark[_ngcontent-%COMP%]   .color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{border-color:#4b5563}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]:hover{border-color:#3b82f6;transform:scale(1.1);box-shadow:0 4px 12px #00000026}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option.selected[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f64d}.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option.selected[_ngcontent-%COMP%]:after{content:"\\2713";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-weight:700;font-size:14px;text-shadow:0 1px 2px rgba(0,0,0,.5)}@media (max-width: 480px){.color-selector[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-option.selected[_ngcontent-%COMP%]:after{font-size:12px}}.bottom-spacing[_ngcontent-%COMP%]{height:2rem}@media (max-width: 480px){.bottom-spacing[_ngcontent-%COMP%]{height:1.5rem}}@media (max-width: 360px){.bottom-spacing[_ngcontent-%COMP%]{height:1rem}}.icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar, .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track, .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.dark[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track, .dark[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#374151}.icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.dark[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .dark[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#6b7280}.icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.dark[_ngcontent-%COMP%]   .icon-picker-dropdown[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .dark[_ngcontent-%COMP%]   .color-picker-dropdown[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;padding:1rem;border:2px solid #e5e7eb;border-radius:8px;background:transparent;cursor:pointer;transition:all .2s ease;min-height:48px}@media (max-width: 480px){.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]{padding:.875rem;min-height:44px}}@media (max-width: 360px){.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]{padding:.75rem;min-height:40px}}.dark[_ngcontent-%COMP%]   .budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]{border-color:#4b5563}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#f0f9ff}.dark[_ngcontent-%COMP%]   .budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]:hover{background:#1e3a8a}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button.active[_ngcontent-%COMP%]{border-color:#3b82f6;background:#f0f9ff}.dark[_ngcontent-%COMP%]   .budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button.active[_ngcontent-%COMP%]{background:#1e3a8a}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{color:#6b7280;transition:transform .2s ease}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .toggle-text[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151}@media (max-width: 480px){.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .toggle-text[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 360px){.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .toggle-text[_ngcontent-%COMP%]{font-size:.75rem}}.dark[_ngcontent-%COMP%]   .budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .toggle-text[_ngcontent-%COMP%]{color:#f3f4f6}.budget-toggle-section[_ngcontent-%COMP%]   .budget-toggle-button[_ngcontent-%COMP%]   .budget-icon[_ngcontent-%COMP%]{color:#3b82f6}.budget-section[_ngcontent-%COMP%]{background:#f8fafc;border-radius:8px;padding:1rem;margin-top:.5rem;border:1px solid #e2e8f0}@media (max-width: 480px){.budget-section[_ngcontent-%COMP%]{padding:.875rem;margin-top:.375rem}}@media (max-width: 360px){.budget-section[_ngcontent-%COMP%]{padding:.75rem;margin-top:.25rem}}.dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]{background:#1e293b;border-color:#334155}.budget-section[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}@media (max-width: 480px){.budget-section[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{gap:.875rem}}@media (max-width: 360px){.budget-section[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{gap:.75rem}}.budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]{width:100%}.budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151}@media (max-width: 480px){.budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 360px){.budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:.75rem}}.dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]   .budget-enable-toggle[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]   .alert-toggle-section[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{color:#f3f4f6}.budget-section[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem;border:1px solid #d1d5db;border-radius:8px;background:transparent;font-size:16px;min-height:48px;transition:all .2s ease}@media (max-width: 480px){.budget-section[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{padding:.75rem .875rem;min-height:44px;font-size:15px}}@media (max-width: 360px){.budget-section[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{padding:.625rem .75rem;min-height:40px;font-size:14px}}.dark[_ngcontent-%COMP%]   .budget-section[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{border-color:#4b5563;color:#f9fafb}.budget-section[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}@media (max-width: 480px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:.75rem}.form-field[_ngcontent-%COMP%]{padding:1rem}.type-selector[_ngcontent-%COMP%]{gap:.5rem}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{padding:.75rem;min-height:70px}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem}.budget-section[_ngcontent-%COMP%]{padding:.75rem}.budget-section[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{gap:.75rem}}@media (max-width: 360px){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:.5rem}.form-field[_ngcontent-%COMP%]{padding:.875rem}.type-selector[_ngcontent-%COMP%]{gap:.375rem}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{padding:.625rem;min-height:60px}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.7rem}.budget-section[_ngcontent-%COMP%]{padding:.625rem}.budget-section[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{gap:.625rem}}@media (max-height: 500px) and (orientation: landscape){.mobile-content[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{padding:.5rem}.form-field[_ngcontent-%COMP%]{padding:.75rem}.type-selector[_ngcontent-%COMP%]   .type-option[_ngcontent-%COMP%]{min-height:60px;padding:.5rem}.budget-section[_ngcontent-%COMP%]{padding:.75rem}}@media (-webkit-min-device-pixel-ratio: 2),(min-resolution: 192dpi){.form-field[_ngcontent-%COMP%], .mobile-header[_ngcontent-%COMP%]{box-shadow:0 .5px 1.5px #0000001a}}@media (hover: none) and (pointer: coarse){.type-option[_ngcontent-%COMP%], .icon-option[_ngcontent-%COMP%], .color-option[_ngcontent-%COMP%], .budget-toggle-button[_ngcontent-%COMP%]{min-height:44px}.type-option[_ngcontent-%COMP%]:hover, .icon-option[_ngcontent-%COMP%]:hover, .color-option[_ngcontent-%COMP%]:hover, .budget-toggle-button[_ngcontent-%COMP%]:hover{transform:none}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{min-height:44px}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}']});let e=n;return e})();var Br=Tr(Nr());var Ml=Qs("transactions"),An=gn(Ml,e=>e.ids.map(n=>e.entities[n]).filter(Boolean)),Su=gn(Ml,e=>e.loading),d_=gn(Ml,e=>e.error),ZO=gn(Ml,e=>e.selectedTransactionId),HW=gn(Ml,ZO,(e,n)=>n?e.entities[n]:null);var Cg=e=>e instanceof Ai?new Date(e.seconds*1e3):e instanceof Date?e:new Date(e);var u_=(e,n,i)=>{let t=Cg(e);return t.getMonth()===n&&t.getFullYear()===i};var m_=gn(An,e=>e.filter(n=>n.type===en.INCOME)),vg=gn(m_,e=>e.reduce((n,i)=>n+i.amount,0)),g_=(e,n)=>gn(m_,i=>i.filter(t=>t.date&&u_(t.date,e,n)).reduce((t,r)=>t+r.amount,0)),f_=gn(An,e=>e.filter(n=>n.type===en.EXPENSE)),bg=gn(f_,e=>e.reduce((n,i)=>n+i.amount,0)),p_=(e,n)=>gn(f_,i=>i.filter(t=>t.date&&u_(t.date,e,n)).reduce((t,r)=>t+r.amount,0)),JO=gn(An,e=>e.filter(n=>n.type===en.TRANSFER)),qW=gn(JO,e=>e.reduce((n,i)=>n+i.amount,0)),h_=gn(vg,bg,(e,n)=>e-n);var x_=gn(An,e=>e.length&&e.filter(n=>n.date).sort((n,i)=>{let t=Cg(n.date);return Cg(i.date).getTime()-t.getTime()})[0]||null);var XW=gn(An,e=>{let n=new Map;return e.forEach(i=>{let t=i.categoryId;n.has(t)||n.set(t,{categoryId:i.categoryId,categoryName:i.category,totalAmount:0,transactionCount:0});let r=n.get(t);r.totalAmount+=i.amount,r.transactionCount+=1}),Array.from(n.values()).sort((i,t)=>t.totalAmount-i.totalAmount)}),KW=gn(An,e=>{let n=new Map;return e.forEach(i=>{let t=i.accountId;n.has(t)||n.set(t,{accountId:i.accountId,totalAmount:0,transactionCount:0});let r=n.get(t);r.totalAmount+=i.amount,r.transactionCount+=1}),Array.from(n.values()).sort((i,t)=>t.totalAmount-i.totalAmount)}),ZW=gn(An,e=>e.reduce((n,i)=>n+(i.taxAmount||0),0));var JW=gn(An,e=>e.filter(n=>n.status==="pending")),QW=gn(An,e=>e.filter(n=>n.isRecurring===!0));var QO=["amountInput"],e4=(e,n)=>n.accountId,t4=(e,n)=>n.value,n4=(e,n)=>n.id,i4=(e,n)=>n.categoryId;function r4(e,n){if(e&1&&(c(0,"p",6),d(1),l()),e&2){let i=S();p(),z(i.getAmountError())}}function a4(e,n){e&1&&(c(0,"p",9),d(1,"Description is required"),l())}function o4(e,n){if(e&1){let i=be();c(0,"button",42),N("click",function(){G(i);let r=S();return H(r.openNewCategoryDialog())}),c(1,"mat-icon",43),d(2,"add"),l(),d(3,"Add "),l()}}function s4(e,n){if(e&1&&(c(0,"mat-option",16),d(1),l()),e&2){let i=n.$implicit;w("value",i.id),p(),z(i==null?null:i.name)}}function c4(e,n){if(e&1&&(c(0,"p",6),d(1),l()),e&2){let i=S();p(),z(i.getDateError())}}function l4(e,n){if(e&1){let i=be();c(0,"button",42),N("click",function(){G(i);let r=S();return H(r.openNewAccountDialog())}),c(1,"mat-icon",43),d(2,"add"),l(),d(3," Add "),l()}}function d4(e,n){if(e&1&&(c(0,"mat-option",16),d(1),pe(2,"titlecase"),l()),e&2){let i=n.$implicit;w("value",i.accountId),p(),jt("",i.name," (",Ee(2,3,i.type),")")}}function u4(e,n){e&1&&(c(0,"mat-error"),d(1,"Account is required"),l())}function m4(e,n){if(e&1&&(c(0,"mat-option",16)(1,"div",32)(2,"mat-icon",43),d(3),l(),c(4,"span"),d(5),l()()()),e&2){let i=n.$implicit;w("value",i.value),p(3),z(i.icon),p(2),z(i.label)}}function g4(e,n){if(e&1&&(c(0,"div",20)(1,"label",4),d(2," Payment Method "),l(),c(3,"mat-form-field",14)(4,"mat-label"),d(5,"Select payment method"),l(),c(6,"mat-select",44)(7,"mat-option",45),d(8,"None"),l(),Ge(9,m4,6,3,"mat-option",16,t4),l()()()),e&2){let i=S();p(6),w("disabled",i.viewMode),p(3),He(i.paymentMethods)}}function f4(e,n){if(e&1&&(c(0,"mat-option",16)(1,"div",47)(2,"span"),d(3),l(),c(4,"span",10),d(5),l()()()),e&2){let i=n.$implicit;w("value",i.id),p(3),z(i.name),p(2),oe("",i.members.length," members")}}function p4(e,n){e&1&&(c(0,"mat-error"),d(1,"Please select a group for split transaction"),l())}function h4(e,n){if(e&1&&(c(0,"div",27)(1,"div")(2,"label",4),d(3," Select Group * "),l(),c(4,"mat-form-field",14)(5,"mat-label"),d(6,"Choose a group to split with"),l(),c(7,"mat-select",46),Ge(8,f4,6,3,"mat-option",16,n4),pe(10,"async"),l(),X(11,p4,2,0,"mat-error"),l()()()),e&2){let i,t=S();p(7),w("disabled",t.viewMode),p(),He(Ee(10,2,t.groups$)),p(3),ot((i=t.transactionForm.get("splitGroupId"))!=null&&i.hasError("required")&&((i=t.transactionForm.get("splitGroupId"))!=null&&i.touched)?11:-1)}}function x4(e,n){if(e&1&&(c(0,"div",53)(1,"span"),d(2),l(),c(3,"span",58),d(4),l()()),e&2){let i=n.$implicit;p(2),z(i.categoryName),p(2),jt("\u20B9",i.amount.toFixed(2)," (",i.percentage.toFixed(1),"%)")}}function _4(e,n){if(e&1){let i=be();c(0,"div",27)(1,"div",48)(2,"div",49)(3,"mat-icon",50),d(4,"category"),l(),c(5,"span",51),d(6,"Category Splits"),l()(),c(7,"div",52),Ge(8,x4,5,3,"div",53,i4),c(10,"div",54)(11,"div",55)(12,"span"),d(13,"Total"),l(),c(14,"span"),d(15),l()()()()(),c(16,"div",56)(17,"button",57),N("click",function(){G(i);let r=S();return H(r.openCategorySplitDialog())}),c(18,"mat-icon",43),d(19,"edit"),l(),d(20," Edit Category Splits "),l()()()}if(e&2){let i=S();p(8),He(i.categorySplits),p(7),oe("\u20B9",i.getTotalSplitAmount().toFixed(2),"")}}function C4(e,n){if(e&1&&(c(0,"p"),d(1),l()),e&2){let i,t=S(2);p(),oe("\u2022 Until ",(i=t.transactionForm.get("recurringEndDate"))==null?null:i.value,"")}}function v4(e,n){if(e&1&&(c(0,"div",27)(1,"div")(2,"label",4),d(3," Repeat Every "),l(),c(4,"mat-form-field",14)(5,"mat-label"),d(6,"Select interval"),l(),c(7,"mat-select",59)(8,"mat-option",16),d(9,"Daily"),l(),c(10,"mat-option",16),d(11,"Weekly"),l(),c(12,"mat-option",16),d(13,"Monthly"),l(),c(14,"mat-option",16),d(15,"Yearly"),l()()()(),c(16,"div")(17,"label",4),d(18," Start Date "),l(),se(19,"input",60),l(),c(20,"div")(21,"label",4),d(22," End Date (Optional) "),l(),se(23,"input",61),c(24,"p",62),d(25,"Leave empty for unlimited recurrence"),l()(),c(26,"div",63)(27,"div",49)(28,"mat-icon",64),d(29,"info"),l(),c(30,"span",65),d(31,"Recurring Details"),l()(),c(32,"div",66)(33,"p"),d(34),l(),c(35,"p"),d(36),l(),X(37,C4,2,1,"p"),c(38,"p"),d(39,"\u2022 You'll be notified when each occurrence is due"),l()()()()),e&2){let i,t,r,a=S();p(7),w("disabled",a.viewMode),p(),w("value","daily"),p(2),w("value","weekly"),p(2),w("value","monthly"),p(2),w("value","yearly"),p(5),Je("bg-gray-100",a.viewMode),w("min",a.recurringMinDate)("max",a.recurringMaxDate)("disabled",a.viewMode),p(4),Je("bg-gray-100",a.viewMode),w("min",a.recurringMinDate)("max",a.recurringMaxDate)("disabled",a.viewMode),p(11),oe("\u2022 Transaction will repeat ",((i=a.transactionForm.get("recurringInterval"))==null?null:i.value)||"monthly",""),p(2),oe("\u2022 Starting from ",((t=a.transactionForm.get("recurringStartDate"))==null?null:t.value)||"today",""),p(),ot((r=a.transactionForm.get("recurringEndDate"))!=null&&r.value?37:-1)}}function b4(e,n){if(e&1&&(c(0,"span",35),d(1),l()),e&2){let i,t=S();p(),oe(" \u20B9",(((i=t.transactionForm.get("taxAmount"))==null?null:i.value)||0).toFixed(2)," ")}}function y4(e,n){if(e&1&&(c(0,"div",70)(1,"span",68),d(2,"Tax Amount:"),l(),c(3,"span",71),d(4),l()(),c(5,"div",72)(6,"span",73),d(7,"Total Amount:"),l(),c(8,"span",74),d(9),l()()),e&2){let i,t,r=S(2);p(4),oe(" +\u20B9",(((i=r.transactionForm.get("taxAmount"))==null?null:i.value)||0).toFixed(2)," "),p(5),oe(" \u20B9",((((t=r.transactionForm.get("amount"))==null?null:t.value)||0)+(((t=r.transactionForm.get("taxAmount"))==null?null:t.value)||0)).toFixed(2)," ")}}function M4(e,n){if(e&1&&(c(0,"div",37)(1,"div",67)(2,"span",68),d(3,"Transaction Amount:"),l(),c(4,"span",69),d(5),l()(),X(6,y4,10,2),l()),e&2){let i,t,r=S();p(5),oe(" \u20B9",(((i=r.transactionForm.get("amount"))==null?null:i.value)||0).toFixed(2)," "),p(),ot((((t=r.transactionForm.get("taxAmount"))==null?null:t.value)||0)>0?6:-1)}}function w4(e,n){e&1&&(c(0,"p",6),d(1,"Tax amount cannot be negative"),l())}function S4(e,n){e&1&&(c(0,"p",9),d(1,"Tax percentage cannot be negative"),l())}function P4(e,n){e&1&&(c(0,"p",9),d(1,"Tax percentage cannot exceed 100%"),l())}function O4(e,n){if(e&1){let i=be();c(0,"button",76),N("click",function(){G(i);let r=S(2);return H(r.clearTaxFields())}),c(1,"mat-icon",77),d(2,"clear"),l(),d(3," Clear Tax Fields "),l()}}function k4(e,n){if(e&1&&(c(0,"div",40),X(1,O4,4,0,"button",75),l()),e&2){let i=S();p(),w("ngIf",!i.viewMode)}}var ls=(()=>{let n=class n{constructor(t,r,a,o,s,u,m,f,h,_,y,v,C,P){this.dialogData=t,this.store=r,this.fb=a,this.dialogRef=o,this.auth=s,this.notificationService=u,this.router=m,this.hapticFeedback=f,this.dialog=h,this.loaderService=_,this.dateService=y,this.validationService=v,this.breakpointObserver=C,this.breakpointService=P,this.isSubmitting=!1,this.isMobile=!1,this.paymentMethods=[{value:vo.CREDIT_CARD,label:"Credit Card",icon:"credit_card"},{value:vo.DEBIT_CARD,label:"Debit Card",icon:"credit_card"},{value:vo.BANK_TRANSFER,label:"Bank Transfer",icon:"account_balance"},{value:vo.CASH,label:"Cash",icon:"money"},{value:vo.DIGITAL_WALLET,label:"Digital Wallet",icon:"account_balance_wallet"}],this.editMode=!1,this.viewMode=!1,this.TransactionType=en,this.categorySplits=[],this.isCategorySplit=!1,this.recurringMinDate=(0,Br.default)().add(1,"day").format("YYYY-MM-DD"),this.recurringMaxDate=(0,Br.default)().add(1,"year").format("YYYY-MM-DD"),this.store.dispatch(tx()),this.groups$=this.store.select(Cx),this.categoryList$=this.store.select(Ri),this.accountList$=this.store.select(wa),this.transactionForm=this.fb.group({payee:["",this.validationService.getTransactionPayeeValidators()],amount:["",this.validationService.getTransactionAmountValidators()],date:[(0,Br.default)().format("YYYY-MM-DD"),Qe.required],description:[""],categoryId:[""],categoryName:[""],categoryType:[""],accountId:["",Qe.required],taxAmount:[0,[Qe.min(0)]],taxPercentage:[0,[Qe.min(0),Qe.max(100)]],taxes:[[]],paymentMethod:[""],isRecurring:[!1],recurringInterval:[Hr.MONTHLY],recurringStartDate:[(0,Br.default)().format("YYYY-MM-DD")],recurringEndDate:[(0,Br.default)().add(1,"year").format("YYYY-MM-DD")],recurringAmount:[0],recurringNotes:[""],recurringCategoryId:[""],recurringCategoryName:[""],isSplitTransaction:[!1],splitGroupId:[""],splitAmount:[0],isCategorySplit:[!1]}),this.isMobile=this.breakpointObserver.isMatched("(max-width: 640px)")}ngOnInit(){var t;this.userId=(t=this.auth.currentUser)==null?void 0:t.uid,this.initializeFormData(),window.addEventListener("popstate",r=>{this.dialogRef.close(),r.preventDefault()})}patchTransactionForm(t){var r,a,o;this.transactionForm.patchValue({payee:t.payee||"",amount:t.amount||"",date:t.date?(0,Br.default)(this.dateService.toDate(t.date)).format("YYYY-MM-DD"):(0,Br.default)().format("YYYY-MM-DD"),description:t.notes||"",categoryId:t.categoryId||"",categoryName:t.categoryName||"",categoryType:t.categoryType||t.type||"",accountId:t.accountId||"",taxAmount:t.taxAmount||0,taxPercentage:t.taxPercentage||0,taxes:t.taxes||[],paymentMethod:t.paymentMethod||"",isRecurring:t.isRecurring||!1,recurringInterval:t.recurringInterval||Hr.MONTHLY,recurringStartDate:t.nextOccurrence?(0,Br.default)(this.dateService.toDate(t.nextOccurrence)).format("YYYY-MM-DD"):(0,Br.default)().format("YYYY-MM-DD"),recurringEndDate:t.recurringEndDate?(0,Br.default)(this.dateService.toDate(t.recurringEndDate)).format("YYYY-MM-DD"):(0,Br.default)().add(1,"year").format("YYYY-MM-DD")}),(r=this.transactionForm.get("isSplitTransaction"))==null||r.setValue(t.isSplitTransaction||!1),(a=this.transactionForm.get("splitGroupId"))==null||a.setValue(t.splitGroupId||""),(o=this.transactionForm.get("splitAmount"))==null||o.setValue(t.splitAmount||0),this.onCategoryChange(t.categoryId)}initializeFormData(){var t,r,a;((t=this.dialogData)==null?void 0:t.mode)==="view"&&((r=this.dialogData)!=null&&r.transaction)?(this.viewMode=!0,this.editMode=!1,this.patchTransactionForm(this.dialogData.transaction),this.transactionForm.disable()):(a=this.dialogData)!=null&&a.id?(this.editMode=!0,this.patchTransactionForm(this.dialogData)):(this.transactionForm.patchValue({payee:"",amount:"",date:(0,Br.default)().format("YYYY-MM-DD"),description:"",categoryId:"",categoryName:"",categoryType:"",accountId:"",taxAmount:0,taxPercentage:0,taxes:[],paymentMethod:""}),this.getRecentTransaction())}getRecentTransaction(){this.store.select(x_).pipe(qa(1)).subscribe(t=>{t&&this.transactionForm.patchValue({categoryName:t.category,categoryType:t.type,categoryId:t.categoryId,payee:t.payee,accountId:t.accountId,isSplitTransaction:t.isSplitTransaction,splitGroupId:t.splitGroupId})})}ngAfterViewInit(){this.viewMode||setTimeout(()=>{this.amountInput&&this.amountInput.nativeElement.focus()},200)}onSubmit(){return ue(this,null,function*(){var t,r,a;if(!this.viewMode){if(this.transactionForm.markAllAsTouched(),(t=this.transactionForm.get("isSplitTransaction"))!=null&&t.value&&!((r=this.transactionForm.get("splitGroupId"))!=null&&r.value)){this.notificationService.error("Please select a group for split transaction");return}if(this.transactionForm.valid&&!this.isSubmitting){this.isSubmitting=!0;try{this.loaderService.show();let o=this.transactionForm.value,s={payee:o.payee,accountId:o.accountId,amount:parseFloat(o.amount),category:o.categoryName,categoryId:o.categoryId,type:o.categoryType,date:new Date(o.date+" "+this.dateService.now().toDate().toLocaleTimeString()),notes:o.description,taxAmount:o.taxAmount||0,taxPercentage:o.taxPercentage||0,taxes:o.taxes||[],paymentMethod:o.paymentMethod||"",isRecurring:o.isRecurring||!1,recurringInterval:o.recurringInterval||Hr.MONTHLY,recurringEndDate:o.recurringEndDate?new Date(o.recurringEndDate):null,nextOccurrence:o.isRecurring?new Date(o.recurringStartDate||o.date):null,status:bo.COMPLETED,isSplitTransaction:o.isSplitTransaction||!1,splitGroupId:o.splitGroupId||"",isCategorySplit:this.isCategorySplit,categorySplits:this.categorySplits,totalSplitAmount:this.categorySplits.reduce((u,m)=>u+m.amount,0),updatedBy:this.userId,updatedAt:new Date};if((a=this.dialogData)!=null&&a.id)yield this.store.dispatch(xo({userId:this.userId,transactionId:this.dialogData.id,transaction:s})),this.notificationService.success("Transaction updated successfully");else{let u=yield this.store.dispatch(ho({userId:this.userId,transaction:le(ae({userId:this.userId},s),{syncStatus:mi.PENDING,createdAt:new Date,updatedAt:new Date,createdBy:this.userId,updatedBy:this.userId})}));this.notificationService.success("Transaction added successfully"),this.hapticFeedback.successVibration()}o.isSplitTransaction&&this.router.navigate(["/dashboard/splitwise/group",o.splitGroupId]),this.dialogRef.close(!0)}catch(o){console.error("Error saving transaction:",o),this.notificationService.error("Failed to save transaction")}finally{this.isSubmitting=!1,this.loaderService.hide()}}}})}onClose(){this.dialogRef.close()}getAmountError(){let t=this.transactionForm.get("amount");return t?this.validationService.getTransactionAmountError(t):""}getDateError(){let t=this.transactionForm.get("date");return t!=null&&t.hasError("required")?"Date is required":""}openNewAccountDialog(){this.dialog.open(yl,{data:null,disableClose:!0,panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog"})}openEditAccountDialog(t){this.dialog.open(yl,{data:t,disableClose:!0,panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog"})}openNewCategoryDialog(){this.dialog.open(ss,{data:null,disableClose:!0,panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog"})}onCategoryChange(t){t&&this.categoryList$.pipe(qa(1),rt(r=>r.find(a=>a.id===t)),Xi(r=>!!r)).subscribe(r=>{this.transactionForm.patchValue({categoryName:r.name,categoryType:r.type,payee:this.editMode?this.dialogData.payee:r.name})})}onTaxPercentageChange(){var a,o;let t=((a=this.transactionForm.get("amount"))==null?void 0:a.value)||0,r=((o=this.transactionForm.get("taxPercentage"))==null?void 0:o.value)||0;if(t>0&&r>0){let s=t*r/100;this.transactionForm.patchValue({taxAmount:parseFloat(s.toFixed(2))},{emitEvent:!1})}}onTaxAmountChange(){var a,o;let t=((a=this.transactionForm.get("amount"))==null?void 0:a.value)||0,r=((o=this.transactionForm.get("taxAmount"))==null?void 0:o.value)||0;if(t>0&&r>0){let s=r/t*100;this.transactionForm.patchValue({taxPercentage:parseFloat(s.toFixed(2))},{emitEvent:!1})}}onAmountChange(){var a,o;let t=((a=this.transactionForm.get("amount"))==null?void 0:a.value)||0,r=((o=this.transactionForm.get("taxAmount"))==null?void 0:o.value)||0;if(t>0&&r>0){let s=r/t*100;this.transactionForm.patchValue({taxPercentage:parseFloat(s.toFixed(2))},{emitEvent:!1})}}clearTaxFields(){this.transactionForm.patchValue({taxAmount:0,taxPercentage:0,taxes:[]})}toggleSplitTransaction(){var r;let t=this.transactionForm.get("splitGroupId");(r=this.transactionForm.get("isSplitTransaction"))!=null&&r.value?t==null||t.setValidators([Qe.required]):(t==null||t.clearValidators(),t==null||t.setValue("")),t==null||t.updateValueAndValidity()}openSplitwise(){this.router.navigate(["/dashboard/splitwise"])}openCategorySplitDialog(){var r,a;this.dialog.open(vx,{width:"600px",maxWidth:"90vw",data:{totalAmount:((r=this.transactionForm.get("amount"))==null?void 0:r.value)||0,existingSplits:this.categorySplits,transactionType:((a=this.transactionForm.get("categoryType"))==null?void 0:a.value)||"expense"}}).afterClosed().subscribe(o=>{o&&(this.categorySplits=o,this.isCategorySplit=!0,this.transactionForm.patchValue({isCategorySplit:!0}),this.notificationService.success("Category splits configured successfully"))})}clearCategorySplits(){this.categorySplits=[],this.isCategorySplit=!1,this.transactionForm.patchValue({isCategorySplit:!1})}getTotalSplitAmount(){return this.categorySplits.reduce((t,r)=>t+r.amount,0)}};n.\u0275fac=function(r){return new(r||n)(q(pi),q(wt),q(Ii),q(fi),q(pt),q(ht),q(Kt),q(Sr),q(fn),q(fc),q(At),q(qr),q(Zi),q(Qi))},n.\u0275cmp=Ve({type:n,selectors:[["app-mobile-add-transaction"]],viewQuery:function(r,a){if(r&1&&Ir(QO,5),r&2){let o;Ar(o=Dr())&&(a.amountInput=o.first)}},decls:101,vars:52,consts:[["amountInput",""],["addButtonTooltip","Save Transaction",3,"addButtonClick","closeButtonClick","title","showAddButton","addButtonDisabled","isSubmitting"],[1,"space-y-6",3,"ngSubmit","keydown.enter","formGroup"],[1,"bg-white","dark:bg-gray-800","rounded-lg","p-4","shadow-sm","space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],["type","number","formControlName","amount","placeholder","0.00","step","0.01",1,"w-full","text-2xl","font-bold","text-center","py-3","px-4","border-0","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","rounded-lg",3,"input","disabled"],[1,"text-red-500","text-sm","mt-1"],["type","text","formControlName","payee","placeholder","Enter description",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"maxlength","disabled"],[1,"flex","justify-between","items-center","mt-1"],[1,"text-red-500","text-sm"],[1,"text-xs","text-gray-500"],[1,"flex","items-center","justify-between","mb-2"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","button","class","text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium flex items-center gap-1",3,"click",4,"ngIf"],["appearance","fill",1,"w-full"],["formControlName","categoryId",3,"selectionChange","disabled"],[3,"value"],[1,"relative"],["type","date","formControlName","date",1,"w-full","py-3","px-4","pr-10","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","[&::-webkit-calendar-picker-indicator]:bg-none","[&::-webkit-calendar-picker-indicator]:bg-transparent","[&::-webkit-calendar-picker-indicator]:opacity-0","[&::-webkit-calendar-picker-indicator]:absolute","[&::-webkit-calendar-picker-indicator]:right-0","[&::-webkit-calendar-picker-indicator]:top-0","[&::-webkit-calendar-picker-indicator]:w-full","[&::-webkit-calendar-picker-indicator]:h-full","[&::-webkit-calendar-picker-indicator]:cursor-pointer",3,"disabled"],[1,"absolute","right-3","top-1/2","transform","-translate-y-1/2","text-gray-400","pointer-events-none"],[1,"bg-white","dark:bg-gray-800","rounded-lg","p-4","shadow-sm"],[1,"space-y-2"],["formControlName","accountId",3,"disabled"],["class","bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm",4,"ngIf"],["formControlName","description","placeholder","Add any additional notes...",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","resize-none",3,"rows","disabled"],[1,"flex","items-center","justify-between","mb-4"],["formControlName","isSplitTransaction",3,"change","disabled"],[1,"space-y-4"],["formControlName","isCategorySplit",3,"change","disabled"],["formControlName","isRecurring",3,"disabled"],[1,"bg-white","dark:bg-gray-800","shadow-sm","border-0"],[1,"px-4","py-3"],[1,"flex","items-center","gap-2"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"text-sm","font-medium","text-gray-700","dark:text-gray-300"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800","dark:bg-blue-900","dark:text-blue-200"],[1,"space-y-4","px-4","pb-4"],[1,"bg-gray-50","dark:bg-gray-700","rounded-lg","p-3"],["type","number","formControlName","taxAmount","placeholder","0.00","step","0.01",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"input","disabled"],["type","number","formControlName","taxPercentage","placeholder","0","step","0.01","min","0","max","100",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"input","disabled"],[1,"pt-2"],[1,"h-20"],["type","button",1,"text-xs","text-blue-600","dark:text-blue-400","hover:text-blue-800","dark:hover:text-blue-300","font-medium","flex","items-center","gap-1",3,"click"],[1,"text-sm"],["formControlName","paymentMethod",3,"disabled"],["value",""],["formControlName","splitGroupId",3,"disabled"],[1,"flex","items-center","justify-between","w-full"],[1,"bg-green-50","dark:bg-green-900/20","rounded-lg","p-3"],[1,"flex","items-center","gap-2","mb-2"],[1,"text-sm","text-green-600","dark:text-green-400"],[1,"text-sm","font-medium","text-green-800","dark:text-green-200"],[1,"text-sm","text-green-700","dark:text-green-300","space-y-1"],[1,"flex","justify-between","items-center"],[1,"border-t","border-green-200","dark:border-green-700","mt-2","pt-2"],[1,"flex","justify-between","items-center","font-medium"],[1,"flex","justify-center"],["type","button",1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","text-blue-600","bg-blue-50","hover:bg-blue-100","dark:text-blue-400","dark:bg-blue-900/20","dark:hover:bg-blue-900/40","rounded-lg","transition-colors","duration-200",3,"click"],[1,"font-medium"],["formControlName","recurringInterval",3,"disabled"],["type","date","formControlName","recurringStartDate",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"min","max","disabled"],["type","date","formControlName","recurringEndDate",1,"w-full","py-3","px-4","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-transparent","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"min","max","disabled"],[1,"text-xs","text-gray-500","mt-1"],[1,"bg-blue-50","dark:bg-blue-900/20","rounded-lg","p-3"],[1,"text-sm","text-blue-600","dark:text-blue-400"],[1,"text-sm","font-medium","text-blue-800","dark:text-blue-200"],[1,"text-sm","text-blue-700","dark:text-blue-300","space-y-1"],[1,"flex","justify-between","items-center","text-sm"],[1,"text-gray-600","dark:text-gray-300"],[1,"font-medium","text-gray-900","dark:text-gray-100"],[1,"flex","justify-between","items-center","text-sm","mt-1"],[1,"font-medium","text-red-600","dark:text-red-400"],[1,"flex","justify-between","items-center","text-sm","mt-2","pt-2","border-t","border-gray-200","dark:border-gray-600"],[1,"font-medium","text-gray-700","dark:text-gray-300"],[1,"font-bold","text-green-600","dark:text-green-400"],["type","button","class","w-full py-2 px-4 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200",3,"click",4,"ngIf"],["type","button",1,"w-full","py-2","px-4","text-sm","text-gray-600","dark:text-gray-400","hover:text-gray-800","dark:hover:text-gray-200","border","border-gray-300","dark:border-gray-600","rounded-lg","hover:bg-gray-50","dark:hover:bg-gray-700","transition-colors","duration-200",3,"click"],[1,"text-sm","mr-2"]],template:function(r,a){if(r&1){let o=be();c(0,"app-common-header",1),N("addButtonClick",function(){return G(o),H(a.onSubmit())})("closeButtonClick",function(){return G(o),H(a.onClose())}),l(),c(1,"app-common-body-content")(2,"form",2),N("ngSubmit",function(){return G(o),H(a.onSubmit())})("keydown.enter",function(){return G(o),H(!a.viewMode&&a.onSubmit())}),c(3,"div",3)(4,"div")(5,"label",4),d(6," Amount * "),l(),c(7,"input",5,0),N("input",function(){return G(o),H(a.onAmountChange())}),l(),X(9,r4,2,1,"p",6),l(),c(10,"div")(11,"label",4),d(12," Description * "),l(),se(13,"input",7),c(14,"div",8),X(15,a4,2,0,"p",9),c(16,"span",10),d(17),l()()(),c(18,"div")(19,"div",11)(20,"label",12),d(21," Category "),l(),X(22,o4,4,0,"button",13),l(),c(23,"mat-form-field",14)(24,"mat-label"),d(25,"Select a category"),l(),c(26,"mat-select",15),N("selectionChange",function(u){return G(o),H(a.onCategoryChange(u.value))}),Ge(27,s4,2,2,"mat-option",16,Oi),pe(29,"async"),l()()(),c(30,"div")(31,"label",4),d(32," Date * "),l(),c(33,"div",17),se(34,"input",18),c(35,"mat-icon",19),d(36," calendar_today "),l()(),X(37,c4,2,1,"p",6),l()(),c(38,"div",20)(39,"div",11)(40,"label",12),d(41," Account * "),l(),X(42,l4,4,0,"button",13),l(),c(43,"div",21)(44,"mat-form-field",14)(45,"mat-label"),d(46,"Select an account"),l(),c(47,"mat-select",22),Ge(48,d4,3,5,"mat-option",16,e4),pe(50,"async"),l(),X(51,u4,2,0,"mat-error"),l()()(),X(52,g4,11,1,"div",23),c(53,"div",20)(54,"label",4),d(55," Notes "),l(),se(56,"textarea",24),l(),c(57,"div",20)(58,"div",25)(59,"label",12),d(60," Split with Group "),l(),c(61,"mat-slide-toggle",26),N("change",function(){return G(o),H(a.toggleSplitTransaction())}),l()(),X(62,h4,12,4,"div",27),l(),c(63,"div",20)(64,"div",25)(65,"label",12),d(66," Split by Category "),l(),c(67,"mat-slide-toggle",28),N("change",function(){let u;return G(o),H((u=a.transactionForm.get("isCategorySplit"))!=null&&u.value?a.openCategorySplitDialog():a.clearCategorySplits())}),l()(),X(68,_4,21,1,"div",27),l(),c(69,"div",20)(70,"div",25)(71,"label",12),d(72," Recurring Transaction "),l(),se(73,"mat-slide-toggle",29),l(),X(74,v4,40,18,"div",27),l(),c(75,"mat-expansion-panel",30)(76,"mat-expansion-panel-header",31)(77,"mat-panel-title",32)(78,"mat-icon",33),d(79,"receipt"),l(),c(80,"span",34),d(81," Tax Information (Optional) "),l(),X(82,b4,2,1,"span",35),l()(),c(83,"div",36),X(84,M4,7,2,"div",37),c(85,"div")(86,"label",4),d(87," Tax Amount "),l(),c(88,"input",38),N("input",function(){return G(o),H(a.onTaxAmountChange())}),l(),X(89,w4,2,0,"p",6),l(),c(90,"div")(91,"label",4),d(92," Tax Percentage (%) "),l(),c(93,"input",39),N("input",function(){return G(o),H(a.onTaxPercentageChange())}),l(),c(94,"div",8),X(95,S4,2,0,"p",9)(96,P4,2,0,"p",9),c(97,"span",10),d(98),l()()(),X(99,k4,2,1,"div",40),l()(),se(100,"div",41),l()()}if(r&2){let o,s,u,m,f,h,_,y,v,C,P,D,T,I;w("title",a.viewMode?"View":(a.dialogData!=null&&a.dialogData.id?"Edit":"Add")+" Transaction")("showAddButton",!a.viewMode)("addButtonDisabled",a.transactionForm.invalid)("isSubmitting",a.isSubmitting),p(2),w("formGroup",a.transactionForm),p(5),Je("bg-gray-100",a.viewMode),w("disabled",a.viewMode),p(2),ot(a.getAmountError()&&((o=a.transactionForm.get("amount"))!=null&&o.touched)?9:-1),p(4),Je("bg-gray-100",a.viewMode),w("maxlength",45)("disabled",a.viewMode),p(2),ot((s=a.transactionForm.get("payee"))!=null&&s.hasError("required")&&((s=a.transactionForm.get("payee"))!=null&&s.touched)?15:-1),p(2),oe(" ",((u=a.transactionForm.get("payee"))==null||u.value==null?null:u.value.length)||0,"/45 "),p(5),w("ngIf",!a.viewMode),p(4),w("disabled",a.viewMode),p(),He(Ee(29,48,a.categoryList$)),p(7),Je("bg-gray-100",a.viewMode),w("disabled",a.viewMode),p(3),ot(a.getDateError()?37:-1),p(5),w("ngIf",!a.viewMode),p(5),w("disabled",a.viewMode),p(),He(Ee(50,50,a.accountList$)),p(3),ot((m=a.transactionForm.get("accountId"))!=null&&m.hasError("required")&&((m=a.transactionForm.get("accountId"))!=null&&m.touched)?51:-1),p(),w("ngIf",((f=a.transactionForm.get("type"))==null?null:f.value)===a.TransactionType.EXPENSE),p(4),Je("bg-gray-100",a.viewMode),w("rows",3)("disabled",a.viewMode),p(5),w("disabled",a.viewMode),p(),ot((h=a.transactionForm.get("isSplitTransaction"))!=null&&h.value?62:-1),p(5),w("disabled",a.viewMode),p(),ot(a.isCategorySplit&&a.categorySplits.length>0?68:-1),p(5),w("disabled",a.viewMode),p(),ot((_=a.transactionForm.get("isRecurring"))!=null&&_.value?74:-1),p(8),ot((((y=a.transactionForm.get("taxAmount"))==null?null:y.value)||0)>0||(((y=a.transactionForm.get("taxPercentage"))==null?null:y.value)||0)>0?82:-1),p(2),ot((((v=a.transactionForm.get("amount"))==null?null:v.value)||0)>0?84:-1),p(4),Je("bg-gray-100",a.viewMode),w("disabled",a.viewMode),p(),ot((C=a.transactionForm.get("taxAmount"))!=null&&C.hasError("min")&&((C=a.transactionForm.get("taxAmount"))!=null&&C.touched)?89:-1),p(4),Je("bg-gray-100",a.viewMode),w("disabled",a.viewMode),p(2),ot((P=a.transactionForm.get("taxPercentage"))!=null&&P.hasError("min")&&((P=a.transactionForm.get("taxPercentage"))!=null&&P.touched)?95:-1),p(),ot((D=a.transactionForm.get("taxPercentage"))!=null&&D.hasError("max")&&((D=a.transactionForm.get("taxPercentage"))!=null&&D.touched)?96:-1),p(2),oe(" ",((T=a.transactionForm.get("taxPercentage"))==null?null:T.value)||0,"% "),p(),ot((((I=a.transactionForm.get("taxAmount"))==null?null:I.value)||0)>0||(((I=a.transactionForm.get("taxPercentage"))==null?null:I.value)||0)>0?99:-1)}},dependencies:[ct,jn,Vt,ki,Ut,Un,Js,Ks,Xs,Ei,Ti,at,Ji,Zr,Sa,Ni,Fi,Jr,bx,yx,Mx,yo,Mo,go,yr],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100vh;background-color:#f9fafb;font-size:16px}.dark   [_nghost-%COMP%]{background-color:#111827}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{outline:none;transform:scale(1.01);transition:transform .15s ease-out}button[_ngcontent-%COMP%]{transition:transform .15s ease-out,opacity .15s ease-out;will-change:transform}button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px)}button[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield;-webkit-appearance:none;appearance:none}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;margin:0}.overflow-y-auto[_ngcontent-%COMP%]{scroll-behavior:smooth;-webkit-overflow-scrolling:touch;overscroll-behavior:contain}.bg-white[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]{transition:transform .15s ease-out,box-shadow .15s ease-out;will-change:transform}.bg-white[_ngcontent-%COMP%]:hover, .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000014}button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important}.text-red-500[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shake .4s ease-out}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}25%{transform:translate(-3px)}75%{transform:translate(3px)}}.text-green-500[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse .4s ease-out}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1)}50%{transform:scale(1.02)}to{transform:scale(1)}}@media (max-width: 768px){[_nghost-%COMP%]{font-size:16px}button[_ngcontent-%COMP%]{min-height:44px;min-width:44px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font-size:16px;padding:12px 16px;border-radius:8px}.text-2xl[_ngcontent-%COMP%]{font-size:1.75rem;line-height:1.2}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{transform:none}button[_ngcontent-%COMP%]:hover:not(:disabled){transform:none}.bg-white[_ngcontent-%COMP%]:hover, .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]:hover{transform:none}}@media (max-width: 480px){[_nghost-%COMP%]{font-size:16px}.p-4[_ngcontent-%COMP%]{padding:1rem}button[_ngcontent-%COMP%]{min-height:48px;min-width:48px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font-size:16px;padding:14px 16px}}@media (min-width: 769px){button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px)}.bg-white[_ngcontent-%COMP%]:hover, .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000014}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{transform:scale(1.01)}}@media (-webkit-min-device-pixel-ratio: 2),(min-resolution: 192dpi){.bg-white[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%], .bg-white[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .bg-gray-800[_ngcontent-%COMP%]{transform:none!important;transition:none!important}}*[_ngcontent-%COMP%]{transition:background-color .2s ease,color .2s ease,border-color .2s ease}button[_ngcontent-%COMP%]:focus-visible, input[_ngcontent-%COMP%]:focus-visible, select[_ngcontent-%COMP%]:focus-visible, textarea[_ngcontent-%COMP%]:focus-visible{outline:2px solid #3b82f6;outline-offset:2px}"]});let e=n;return e})();function E4(e,n){if(e&1&&(c(0,"footer",0)(1,"div",2)(2,"div",3)(3,"mat-icon",4),d(4,"account_balance_wallet"),l(),c(5,"span",5),d(6,"Money Manager"),l(),c(7,"span",6),d(8),l()(),c(9,"div",7)(10,"span"),d(11,"\xA9 2024 Money Manager"),l(),c(12,"span",8),d(13,"\u2022"),l(),c(14,"span",8),d(15,"All rights reserved"),l(),c(16,"span",8),d(17,"\u2022"),l()()()()),e&2){let i=S();p(8),oe("v",i.getAppVersion(),"")}}function T4(e,n){if(e&1){let i=be();c(0,"footer",1)(1,"div",9)(2,"div",10)(3,"button",11),N("click",function(){G(i);let r=S();return H(r.home())}),c(4,"div",12),N("click",function(){G(i);let r=S();return H(r.home())}),c(5,"mat-icon",13),d(6,"home"),l()(),c(7,"span",14),d(8,"Home"),l()(),c(9,"button",11),N("click",function(){G(i);let r=S();return H(r.quickExpense())}),c(10,"div",12),N("click",function(){G(i);let r=S();return H(r.quickExpense())}),c(11,"mat-icon",13),d(12,"trending_down"),l()(),c(13,"span",14),d(14,"Expense"),l()(),c(15,"button",11),N("click",function(){G(i);let r=S();return H(r.addTransaction())}),c(16,"div",15)(17,"mat-icon",16),d(18,"add_circle"),l()(),c(19,"span",17),d(20,"Add"),l()(),c(21,"button",11),N("click",function(){G(i);let r=S();return H(r.navigateTo("/dashboard/category"))}),c(22,"div",12),N("click",function(){G(i);let r=S();return H(r.navigateTo("/dashboard/category"))}),c(23,"mat-icon",13),d(24,"layers"),l()(),c(25,"span",14),d(26,"Category"),l()(),c(27,"button",11),N("click",function(){G(i);let r=S();return H(r.navigateTo("/dashboard/accounts"))}),c(28,"div",12),N("click",function(){G(i);let r=S();return H(r.navigateTo("/dashboard/accounts"))}),c(29,"mat-icon",13),d(30,"account_balance"),l()(),c(31,"span",14),d(32,"Accounts"),l()()()()()}if(e&2){let i=S();p(4),Lt(i.isHomeActive()?"bg-primary text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"),p(),Lt(i.isHomeActive()?"text-white":"text-gray-600 dark:text-gray-400"),p(2),Lt(i.isHomeActive()?"text-primary dark:text-primary":"text-gray-700 dark:text-gray-300"),p(3),Lt(i.isExpenseActive()?"bg-primary text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"),p(),Lt(i.isExpenseActive()?"text-white":"text-gray-600 dark:text-gray-400"),p(2),Lt(i.isExpenseActive()?"text-primary dark:text-primary":"text-gray-700 dark:text-gray-300"),p(9),Lt(i.isCategoryActive()?"bg-primary text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"),p(),Lt(i.isCategoryActive()?"text-white":"text-gray-600 dark:text-gray-400"),p(2),Lt(i.isCategoryActive()?"text-primary dark:text-primary":"text-gray-700 dark:text-gray-300"),p(3),Lt(i.isAccountsActive()?"bg-primary text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"),p(),Lt(i.isAccountsActive()?"text-white":"text-gray-600 dark:text-gray-400"),p(2),Lt(i.isAccountsActive()?"text-primary dark:text-primary":"text-gray-700 dark:text-gray-300")}}var C_=(()=>{let n=class n{constructor(t,r,a,o,s,u){this.commonSyncService=t,this.router=r,this._dialog=a,this.hapticFeedback=o,this.cdr=s,this.breakpointService=u}ngOnInit(){this.routeSubscription=this.router.events.pipe(Xi(t=>t instanceof B0)).subscribe(()=>{this.cdr.detectChanges()})}ngOnDestroy(){var t;(t=this.routeSubscription)==null||t.unsubscribe()}isHomeActive(){return this.router.url==="/dashboard"||this.router.url==="/dashboard/home"}isExpenseActive(){return this.router.url==="/dashboard/transactions"}isReportsActive(){return this.router.url==="/dashboard/reports"}isCategoryActive(){return this.router.url==="/dashboard/category"}isAccountsActive(){return this.router.url==="/dashboard/accounts"}isMoreActive(){return["/dashboard/accounts","/dashboard/budgets","/dashboard/goals","/dashboard/notes","/dashboard/tax","/dashboard/subscription"].includes(this.router.url)}addTransaction(){this._dialog.open(ls,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog"})}home(){this.router.navigate(["/dashboard/home"])}quickExpense(){this.router.navigate(["/dashboard/transactions"])}reports(){console.log("Quick transfer clicked"),this.router.navigate(["/dashboard/reports"])}scanReceipt(){console.log("Scan receipt clicked"),alert("Receipt scanning feature coming soon!")}openAddTransactionModal(){console.log("Open add transaction modal clicked"),this.router.navigate(["/dashboard/add-transaction"])}openSettings(){console.log("Settings clicked"),this.router.navigate(["/dashboard/settings"])}openReports(){console.log("Reports clicked"),this.router.navigate(["/dashboard/reports"])}openSearch(){console.log("Search clicked"),alert("Search feature coming soon!")}onMoreMenuClick(){this.hapticFeedback.buttonClick(),console.log("More menu clicked")}navigateTo(t){this.router.navigate([t])}getAppVersion(){return new Date().toISOString().split("T")[0]}getNetworkStatusClass(){let t=this.commonSyncService.getCurrentNetworkStatus();return t.online?t.effectiveType==="4g"?"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-300":t.effectiveType==="3g"?"bg-yellow-100 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300":"bg-gray-100 dark:bg-gray-900/20 text-gray-700 dark:text-gray-300":"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300"}getNetworkIndicatorClass(){let t=this.commonSyncService.getCurrentNetworkStatus();return t.online?t.effectiveType==="4g"?"bg-green-500":t.effectiveType==="3g"?"bg-yellow-500":"bg-gray-500":"bg-red-500"}getNetworkStatusText(){let t=this.commonSyncService.getCurrentNetworkStatus();return t.online?t.effectiveType==="4g"?"4G":t.effectiveType==="3g"?"3G":t.effectiveType==="2g"?"2G":"Online":"Offline"}};n.\u0275fac=function(r){return new(r||n)(q(Rr),q(Kt),q(fn),q(Sr),q(Kh),q(Qi))},n.\u0275cmp=Ve({type:n,selectors:[["app-footer"]],decls:2,vars:2,consts:[[1,"hidden","md:flex","flex-shrink-0","bg-white","dark:bg-gray-800","border-t","border-gray-200","dark:border-gray-700","shadow-sm"],[1,"flex-shrink-0","bg-white","dark:bg-gray-800","border-t","border-gray-200","dark:border-gray-700","shadow-lg"],[1,"flex","items-center","justify-between","px-6","py-4","w-full"],[1,"flex","items-center","gap-3","text-sm","text-gray-600","dark:text-gray-300"],[1,"text-gray-400","dark:text-gray-500"],[1,"font-medium"],[1,"text-xs","text-gray-400","dark:text-gray-500"],[1,"flex","items-center","gap-1","text-xs","text-gray-500","dark:text-gray-400"],[1,"hidden","lg:inline"],[1,"px-2","py-3"],[1,"grid","grid-cols-5","gap-2"],[1,"group","flex","flex-col","items-center","gap-2",3,"click"],[1,"w-10","h-10","rounded-xl","flex","items-center","justify-center","shadow-md","transition-all","duration-200",3,"click"],[1,"text-lg","relative","bottom-1"],[1,"text-xs","font-medium","transition-colors","duration-200"],[1,"w-12","h-12","bg-gray-500","rounded-xl","flex","items-center","justify-center","shadow-md","hover:scale-105","transition-all","duration-200"],[1,"text-white","text-lg","relative","bottom-1"],[1,"text-xs","font-medium","text-gray-700","dark:text-gray-300"]],template:function(r,a){r&1&&X(0,E4,18,1,"footer",0)(1,T4,33,24,"footer",1),r&2&&(ot(!a.breakpointService.device.isTablePortrait&&!a.breakpointService.device.isMobile?0:-1),p(),ot(a.breakpointService.device.isMobile||a.breakpointService.device.isTablePortrait?1:-1))},dependencies:[at],styles:["[_nghost-%COMP%]{display:block}footer[_ngcontent-%COMP%]{transition:all .3s ease}footer[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #0000001a}.hidden.md\\:flex[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:#fffffff2}.dark[_ngcontent-%COMP%]   .hidden.md\\:flex[_ngcontent-%COMP%]{background:#1f2937f2}.md\\:hidden[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:#fffffffa}.dark[_ngcontent-%COMP%]   .md\\:hidden[_ngcontent-%COMP%]{background:#1f2937fa}.md\\:hidden[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]{box-shadow:0 4px 12px #3b82f64d}.md\\:hidden[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]:hover{box-shadow:0 6px 16px #3b82f666}.md\\:hidden[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]:active{box-shadow:0 2px 8px #3b82f64d}.md\\:hidden[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]{transition:all .2s ease}.md\\:hidden[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.md\\:hidden[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]:active{transform:translateY(0)}.md\\:hidden[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{transition:all .2s ease}.md\\:hidden[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]:hover   .action-icon[_ngcontent-%COMP%]{transform:scale(1.1)}.md\\:hidden[_ngcontent-%COMP%]   .network-status[_ngcontent-%COMP%]{transition:all .3s ease}.md\\:hidden[_ngcontent-%COMP%]   .network-status[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.action-income[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669)}.action-income[_ngcontent-%COMP%]:hover{background:#10b9811a}.action-expense[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626)}.action-expense[_ngcontent-%COMP%]:hover{background:#ef44441a}.action-scan[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#8b5cf6,#7c3aed)}.action-scan[_ngcontent-%COMP%]:hover{background:#8b5cf61a}.action-search[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563)}.action-search[_ngcontent-%COMP%]:hover{background:#6b72801a}.action-more[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563)}.action-more[_ngcontent-%COMP%]:hover{background:#6b72801a}.network-online[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669)}.network-offline[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626)}.network-slow[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b,#d97706)}@media (max-width: 640px){.mobile-footer[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]{padding:.75rem 1.5rem;font-size:.875rem}.mobile-footer[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]{gap:.25rem}.mobile-footer[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{width:2rem;height:2rem}}.dark[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]{border-color:#4b556380}.dark[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]   .network-status[_ngcontent-%COMP%]{background:#4b556333}.dark[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]   .quick-action[_ngcontent-%COMP%]:hover{background:#4b55631a}@keyframes _ngcontent-%COMP%_networkPulse{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.network-status-changing[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_networkPulse .6s ease-in-out}button[_ngcontent-%COMP%]{transition:all .2s ease}button[_ngcontent-%COMP%]:focus{outline:none;ring:2px;ring-color:rgba(59,130,246,.5)}.footer-button[_ngcontent-%COMP%]{transition:all .2s ease}.footer-button.active[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);box-shadow:0 4px 12px #3b82f64d}.footer-button.active[_ngcontent-%COMP%]   .action-label[_ngcontent-%COMP%]{color:#3b82f6;font-weight:600}.footer-button[_ngcontent-%COMP%]:hover:not(.active)   .action-icon[_ngcontent-%COMP%]{transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-panel[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 8px 32px #0000001f;border:1px solid rgba(0,0,0,.08)}.dark[_ngcontent-%COMP%]   .more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-panel[_ngcontent-%COMP%]{background:#1f2937;border-color:#ffffff1a;box-shadow:0 8px 32px #0000004d}.more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;font-size:14px;font-weight:500;color:#374151;transition:all .2s ease}.dark[_ngcontent-%COMP%]   .more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]{color:#d1d5db}.more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]:hover{background:#3b82f614}.dark[_ngcontent-%COMP%]   .more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]:hover{background:#3b82f626}.more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280;font-size:20px;width:20px;height:20px}.dark[_ngcontent-%COMP%]   .more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#9ca3af}.more-menu-panel[_ngcontent-%COMP%]   .mat-mdc-menu-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}.menu-item[_ngcontent-%COMP%]{background-color:#ffffff80;border-radius:12px;margin:4px}.menu-item[_ngcontent-%COMP%]:hover{background-color:#ffffff80}"]});let e=n;return e})();var v_=(()=>{let n=class n{constructor(t,r,a,o,s){this.breakpointObserver=t,this.store=r,this.userService=a,this.invitationPopupService=o,this.recurringTransactionService=s,this.isMobile=!1,this.breakpointObserver.observe([cc.Handset]).subscribe(u=>{this.isMobile=u.matches})}ngOnInit(){var t,r,a,o,s,u;this.store.dispatch(Ea({userId:((t=this.userService.userAuth$.value)==null?void 0:t.uid)||""})),this.store.dispatch(Mr({userId:((r=this.userService.userAuth$.value)==null?void 0:r.uid)||""})),this.store.dispatch(mr({userId:((a=this.userService.userAuth$.value)==null?void 0:a.uid)||""})),this.store.dispatch(Oa({userId:((o=this.userService.userAuth$.value)==null?void 0:o.uid)||""})),this.store.dispatch(ka({userId:((s=this.userService.userAuth$.value)==null?void 0:s.uid)||""})),this.store.dispatch(ri({userId:((u=this.userService.userAuth$.value)==null?void 0:u.uid)||""})),this.invitationPopupService.showInvitationsAfterLogin(),setTimeout(()=>{this.recurringTransactionService.checkDueRecurringTransactions().subscribe()},2e3)}};n.\u0275fac=function(r){return new(r||n)(q(Zi),q(wt),q(gi),q(e_),q(t_))},n.\u0275cmp=Ve({type:n,selectors:[["app-dashboard"]],decls:6,vars:0,consts:[[1,"h-[100vh]","flex","flex-col","bg-gray-50"],[1,"flex-1","overflow-y-auto"],[1,"mx-auto","px-4","py-1","lg:py-2"]],template:function(r,a){r&1&&(c(0,"div",0),se(1,"app-header"),c(2,"main",1)(3,"div",2),se(4,"router-outlet"),l()(),se(5,"app-footer"),l())},dependencies:[L0,o_,C_]});let e=n;return e})();var D4=(e,n)=>n.accountId,F4=(e,n)=>n.id,R4=e=>({"!max-h-[100vh]":e}),N4=e=>({"mt-[-12px] m-1":e});function B4(e,n){if(e&1){let i=be();c(0,"div",11)(1,"p",12),d(2),l(),c(3,"button",13),N("click",function(){G(i);let r=S();return H(r.clearError())}),c(4,"mat-icon"),d(5,"close"),l()()()}if(e&2){let i=S();p(2),z(i.errorMessage)}}function L4(e,n){if(e&1){let i=be();c(0,"button",14),N("click",function(){G(i);let r=S();return H(r.addAccount())}),c(1,"mat-icon"),d(2,"add"),l()()}}function V4(e,n){if(e&1){let i=be();c(0,"div",15)(1,"button",16),N("click",function(){G(i);let r=S();return H(r.addAccount())}),c(2,"mat-icon"),d(3,"add"),l()()()}}function U4(e,n){if(e&1&&(c(0,"div",17)(1,"div",18)(2,"h2",19),d(3,"Manage Accounts"),l(),c(4,"p",20),d(5),pe(6,"async"),pe(7,"async"),l()()()),e&2){let i,t=S();p(5),jt("(",((i=Ee(6,2,t.accounts$))==null?null:i.length)||0," account",(((i=Ee(7,4,t.accounts$))==null?null:i.length)||0)!==1?"s":"",")")}}function j4(e,n){if(e&1&&(c(0,"div",29)(1,"span",30),d(2,"Assets:"),l(),c(3,"span",31),d(4),pe(5,"currency"),l()()),e&2){let i=S(2);p(4),z(Ee(5,1,i.getTotalPositiveBalance()))}}function z4(e,n){if(e&1&&(c(0,"div",32)(1,"span",30),d(2,"Liabilities:"),l(),c(3,"span",31),d(4),pe(5,"currency"),l()()),e&2){let i=S(2);p(4),z(Ee(5,1,i.getTotalNegativeBalance()))}}function W4(e,n){if(e&1&&(c(0,"div",21)(1,"div",22)(2,"mat-icon",23),d(3,"account_balance"),l(),c(4,"h3",24),d(5,"Total Balance "),c(6,"span",25),pe(7,"async"),d(8),pe(9,"async"),pe(10,"currency"),l()()(),c(11,"div",26),X(12,j4,6,3,"div",27)(13,z4,6,3,"div",28),l()()),e&2){let i,t,r,a,o=S();w("ngClass",dl(12,N4,o.home)),p(6),Lt(((i=Ee(7,6,o.totalBalance$))!==null&&i!==void 0?i:0)>=0?"positive":"negative"),p(2),oe(" ",Ee(10,10,(t=Ee(9,8,o.totalBalance$))!==null&&t!==void 0?t:0)," "),p(4),w("ngIf",(r=o.getPositiveAccounts())==null?null:r.length),p(),w("ngIf",(a=o.getNegativeAccounts())==null?null:a.length)}}function Y4(e,n){if(e&1){let i=be();c(0,"button",38),N("click",function(){G(i);let r=S(2);return H(r.addAccount())}),c(1,"mat-icon"),d(2,"add"),l(),d(3," Add Account "),l()}}function $4(e,n){if(e&1&&(c(0,"div",33)(1,"div",34)(2,"mat-icon"),d(3,"account_balance"),l()(),c(4,"h3",35),d(5,"No accounts yet"),l(),c(6,"p",36),d(7,"Add your first account to get started"),l(),X(8,Y4,4,0,"button",37),l()),e&2){let i=S();p(8),w("ngIf",i.breakpointService.device.isMobile)}}function G4(e,n){if(e&1&&(c(0,"div",51)(1,"span",63),d(2,"Loan Interest Rate:"),l(),c(3,"span",64),d(4),l()()),e&2){let i,t=S().$implicit,r=S(2);p(4),oe("",(i=r.getLoanDetails(t))==null?null:i.interestRate,"%")}}function H4(e,n){if(e&1&&(c(0,"span",52),d(1),pe(2,"titlecase"),l()),e&2){let i=S().$implicit;p(),z(Ee(2,1,i.type))}}function q4(e,n){if(e&1&&(c(0,"div",69)(1,"span",70),d(2,"Description:"),l(),c(3,"span",71),d(4),l()()),e&2){let i=S(2).$implicit;p(4),z(i.description)}}function X4(e,n){if(e&1&&(c(0,"div",69)(1,"span",70),d(2,"Created:"),l(),c(3,"span",71),d(4),pe(5,"date"),l()()),e&2){let i=S(2).$implicit,t=S(2);p(4),z(yt(5,1,t.dateService.toDate(i.createdAt),"shortDate"))}}function K4(e,n){if(e&1&&(c(0,"div",69)(1,"span",70),d(2,"Loan Term:"),l(),c(3,"span",71),d(4),l()()),e&2){let i,t=S(3).$implicit,r=S(2);p(4),oe("",(i=r.getLoanDetails(t))==null?null:i.durationMonths," months")}}function Z4(e,n){if(e&1&&(c(0,"mat-tab",81)(1,"div",68)(2,"div",69)(3,"span",70),d(4,"Lender Name:"),l(),c(5,"span",71),d(6),l()(),c(7,"div",69)(8,"span",70),d(9,"Interest Rate:"),l(),c(10,"span",71),d(11),l()(),c(12,"div",69)(13,"span",70),d(14,"Monthly Interest:"),l(),c(15,"span",82),d(16),pe(17,"currency"),l()(),c(18,"div",69)(19,"span",70),d(20,"Next Due Date:"),l(),c(21,"span",71),d(22),pe(23,"date"),l()(),c(24,"div",69)(25,"span",70),d(26,"Remaining Balance:"),l(),c(27,"span",71),d(28),pe(29,"currency"),l()(),c(30,"div",69)(31,"span",70),d(32,"Monthly Payment:"),l(),c(33,"span",71),d(34),pe(35,"currency"),l()(),X(36,K4,5,1,"div",72),l()()),e&2){let i,t,r,a,o,s,u=S(2).$implicit,m=S(2);p(6),z(((i=m.getLoanDetails(u))==null?null:i.lenderName)||"N/A"),p(5),oe("",(t=m.getLoanDetails(u))==null?null:t.interestRate,"%"),p(5),z(Ee(17,7,m.calculateMonthlyInterest(u))),p(6),z(yt(23,9,(r=m.getLoanDetails(u))==null?null:r.nextDueDate,"fullDate")),p(6),z(Ee(29,12,(a=m.getLoanDetails(u))==null?null:a.remainingBalance)),p(6),z(Ee(35,14,(o=m.getLoanDetails(u))==null?null:o.monthlyPayment)),p(2),w("ngIf",(s=m.getLoanDetails(u))==null?null:s.durationMonths)}}function J4(e,n){if(e&1&&(c(0,"div",69)(1,"span",70),d(2,"Credit Limit:"),l(),c(3,"span",71),d(4),pe(5,"currency"),l()()),e&2){let i,t=S(3).$implicit,r=S(2);p(4),z(Ee(5,1,(i=r.getCreditCardDetails(t))==null?null:i.creditLimit))}}function Q4(e,n){if(e&1&&(c(0,"div",69)(1,"span",70),d(2,"Minimum Payment:"),l(),c(3,"span",71),d(4),pe(5,"currency"),l()()),e&2){let i,t=S(3).$implicit,r=S(2);p(4),z(Ee(5,1,(i=r.getCreditCardDetails(t))==null?null:i.minimumPayment))}}function e3(e,n){if(e&1&&(c(0,"mat-tab",83)(1,"div",68)(2,"div",69)(3,"span",70),d(4,"Payment Due Date:"),l(),c(5,"span",71),d(6),l()(),c(7,"div",69)(8,"span",70),d(9,"Billing Cycle Start:"),l(),c(10,"span",71),d(11),l()(),X(12,J4,6,3,"div",72)(13,Q4,6,3,"div",72),c(14,"div",69)(15,"span",70),d(16,"Next Due Date:"),l(),c(17,"span",71),d(18),pe(19,"date"),l()(),c(20,"div",69)(21,"span",70),d(22,"Next Billing Date:"),l(),c(23,"span",71),d(24),pe(25,"date"),l()()()()),e&2){let i,t,r,a,o=S(2).$implicit,s=S(2);p(6),jt("",(i=s.getCreditCardDetails(o))==null?null:i.dueDate,"",s.getDaySuffix((i=s.getCreditCardDetails(o))==null?null:i.dueDate)," of each month"),p(5),jt("",(t=s.getCreditCardDetails(o))==null?null:t.billingCycleStart,"",s.getDaySuffix((t=s.getCreditCardDetails(o))==null?null:t.billingCycleStart)," of each month"),p(),w("ngIf",(r=s.getCreditCardDetails(o))==null?null:r.creditLimit),p(),w("ngIf",(a=s.getCreditCardDetails(o))==null?null:a.minimumPayment),p(5),z(yt(19,8,s.calculateNextDueDate(o),"fullDate")),p(6),z(yt(25,11,s.calculateNextBillingDate(o),"fullDate"))}}function t3(e,n){e&1&&(c(0,"div",84)(1,"mat-icon"),d(2,"receipt_long"),l(),c(3,"p"),d(4,"No recent transactions"),l()())}function n3(e,n){if(e&1&&(c(0,"div",86)(1,"div",87)(2,"span",88),d(3),l(),c(4,"span",89),d(5),pe(6,"date"),l()(),c(7,"span",90),d(8),pe(9,"currency"),l()()),e&2){let i=n.$implicit;p(3),z(i.description),p(2),z(yt(6,5,i.date,"shortDate")),p(2),Lt(i.amount>=0?"positive":"negative"),p(),oe(" ",Ee(9,8,i.amount)," ")}}function i3(e,n){if(e&1&&(c(0,"div",85),Ge(1,n3,10,10,"div",86,F4),l()),e&2){let i=S(2).$implicit,t=S(2);p(),He(t.getRecentTransactions(i))}}function r3(e,n){if(e&1&&(c(0,"div",65)(1,"mat-tab-group",66)(2,"mat-tab",67)(3,"div",68)(4,"div",69)(5,"span",70),d(6,"Account Name:"),l(),c(7,"span",71),d(8),l()(),c(9,"div",69)(10,"span",70),d(11,"Account Type:"),l(),c(12,"span",71),d(13),pe(14,"titlecase"),l()(),c(15,"div",69)(16,"span",70),d(17,"Current Balance:"),l(),c(18,"span",71),d(19),pe(20,"currency"),l()(),X(21,q4,5,1,"div",72)(22,X4,6,4,"div",72),l()(),X(23,Z4,37,16,"mat-tab",73)(24,e3,26,14,"mat-tab",74),c(25,"mat-tab",75)(26,"div",68),X(27,t3,5,0,"div",76)(28,i3,3,0,"div",77),l()(),c(29,"mat-tab",78)(30,"div",68)(31,"div",69)(32,"span",70),d(33,"Total Transactions:"),l(),c(34,"span",71),d(35),l()(),c(36,"div",69)(37,"span",70),d(38,"Total Deposits:"),l(),c(39,"span",79),d(40),pe(41,"currency"),l()(),c(42,"div",69)(43,"span",70),d(44,"Total Withdrawals:"),l(),c(45,"span",80),d(46),pe(47,"currency"),l()(),c(48,"div",69)(49,"span",70),d(50,"Average Transaction:"),l(),c(51,"span",71),d(52),pe(53,"currency"),l()(),c(54,"div",69)(55,"span",70),d(56,"Largest Transaction:"),l(),c(57,"span",71),d(58),pe(59,"currency"),l()(),c(60,"div",69)(61,"span",70),d(62,"This Month:"),l(),c(63,"span",71),d(64),pe(65,"currency"),l()(),c(66,"div",69)(67,"span",70),d(68,"Last Month:"),l(),c(69,"span",71),d(70),pe(71,"currency"),l()()()()()()),e&2){let i,t,r,a,o,s,u,m,f,h=S().$implicit,_=S(2);p(8),z(h.name),p(5),z(Ee(14,18,h.type)),p(5),Lt(h.balance>=0?"positive":"negative"),p(),oe(" ",Ee(20,20,h.balance)," "),p(2),w("ngIf",h.description),p(),w("ngIf",h.createdAt),p(),w("ngIf",_.isLoanAccount(h)),p(),w("ngIf",_.isCreditCardAccount(h)),p(3),w("ngIf",!((i=_.getRecentTransactions(h))!=null&&i.length)),p(),w("ngIf",(t=_.getRecentTransactions(h))==null?null:t.length),p(7),z(((r=_.getAccountStats(h))==null?null:r.totalTransactions)||0),p(5),z(Ee(41,22,(a=_.getAccountStats(h))==null?null:a.totalDeposits)),p(6),z(Ee(47,24,(o=_.getAccountStats(h))==null?null:o.totalWithdrawals)),p(6),z(Ee(53,26,(s=_.getAccountStats(h))==null?null:s.averageTransaction)),p(6),z(Ee(59,28,(u=_.getAccountStats(h))==null?null:u.largestTransaction)),p(6),z(Ee(65,30,(m=_.getAccountStats(h))==null?null:m.thisMonth)),p(6),z(Ee(71,32,(f=_.getAccountStats(h))==null?null:f.lastMonth))}}function a3(e,n){if(e&1){let i=be();c(0,"div",41)(1,"div",42)(2,"div",43)(3,"div",44)(4,"div",45)(5,"mat-icon",46),d(6),l()(),c(7,"div",47)(8,"div",48)(9,"h3",49),d(10),pe(11,"titlecase"),l()(),c(12,"div",50),X(13,G4,5,1,"div",51)(14,H4,3,3,"span",52),l(),c(15,"div",53)(16,"span",54),d(17,"Balance:"),l(),c(18,"span",55),d(19),pe(20,"currency"),pe(21,"currency"),l()()()()(),c(22,"div",56)(23,"mat-menu",null,0)(25,"button",57),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.editAccount(r))}),c(26,"mat-icon"),d(27,"edit"),l(),d(28," Edit "),l(),c(29,"button",58),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.deleteAccount(r))}),c(30,"mat-icon"),d(31,"delete"),l(),d(32," Delete "),l()(),c(33,"button",59)(34,"mat-icon"),d(35,"more_vert"),l()()()(),c(36,"div",60)(37,"button",61),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.toggleAccountExpansion(r))}),c(38,"mat-icon"),d(39),l(),c(40,"span"),d(41),l()()(),X(42,r3,72,34,"div",62),l()}if(e&2){let i,t=n.$implicit,r=Gn(24),a=S(2);Lt(a.getBalanceClass(t)),Je("expanded",(a.expandedAccount==null?null:a.expandedAccount.accountId)===t.accountId),p(6),z(a.getAccountIcon(t.type)),p(4),z(Ee(11,14,t.name)),p(3),ot(a.isLoanAccount(t)?13:14),p(5),Lt(t.balance>=0?"positive":"negative"),p(),oe(" ",a.isLoanAccount(t)?Ee(20,16,(i=a.getLoanDetails(t))==null?null:i.remainingBalance):Ee(21,18,t.balance)," "),p(14),w("matMenuTriggerFor",r),p(6),z((a.expandedAccount==null?null:a.expandedAccount.accountId)===t.accountId?"expand_less":"expand_more"),p(2),z((a.expandedAccount==null?null:a.expandedAccount.accountId)===t.accountId?"Show Less":"Show More"),p(),w("ngIf",(a.expandedAccount==null?null:a.expandedAccount.accountId)===t.accountId)}}function o3(e,n){if(e&1&&(c(0,"div",39),Ge(1,a3,43,20,"div",40,D4),l()),e&2){let i=n.ngIf;p(),He(i)}}var Oc=(()=>{let n=class n{constructor(t,r,a,o,s,u,m,f){this.auth=t,this.router=r,this.dialog=a,this.breakpointObserver=o,this.notificationService=s,this.store=u,this.dateService=m,this.breakpointService=f,this.home=!1,this.accounts$=lt([]),this.accounts=[],this.isLoading=!1,this.errorMessage="",this.selectedAccount=null,this.expandedAccount=null,this.userId="",this.destroy$=new vn,this.accounts$=this.store.select(wa)||lt([]),this.isLoading$=this.store.select(Ed),this.error$=this.store.select(sx),this.totalBalance$=this.store.select(cx)}ngOnInit(){this.initializeComponent()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeComponent(){return ue(this,null,function*(){let t=this.auth.currentUser;if(!t){this.errorMessage="User not authenticated";return}this.userId=t.uid,this.loadUserAccounts()})}loadUserAccounts(){this.store.dispatch(Mr({userId:this.userId})),this.accounts$.pipe(Qt(this.destroy$)).subscribe(t=>{this.accounts=t}),this.isLoading$.pipe(Qt(this.destroy$)).subscribe(t=>{this.isLoading=t}),this.error$.pipe(Qt(this.destroy$)).subscribe(t=>{t&&(this.errorMessage="Failed to load accounts",console.error("Error loading accounts:",t))})}clearError(){this.errorMessage=""}trackByAccountId(t,r){return r.accountId}openAccountDialog(t){this.dialog.open(yl,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog",data:t||null}).afterClosed().subscribe(a=>{a&&this.store.dispatch(Mr({userId:this.userId}))})}editAccount(t){this.openAccountDialog(t)}deleteAccount(t){return ue(this,null,function*(){this.dialog.open(Kr,{width:"400px",data:{title:"Delete Account",message:`Are you sure you want to delete "${t.name}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",confirmColor:"warn"}}).afterClosed().subscribe(a=>ue(this,null,function*(){if(a)try{this.store.dispatch(ec({userId:this.userId,accountId:t.accountId})),this.notificationService.success("Account deleted successfully")}catch(o){this.notificationService.error("Failed to delete account"),console.error("Error deleting account:",o)}}))})}addAccount(){this.openAccountDialog()}calculateMonthlyInterest(t){if(t.type!=="loan"||!t.loanDetails)return 0;let{interestRate:r,remainingBalance:a}=t.loanDetails;return r/12/100*a}isLoanAccount(t){return t.type==="loan"&&!!t.loanDetails}getLoanDetails(t){return t.loanDetails}isCreditCardAccount(t){return t.type===Za.CREDIT}getCreditCardDetails(t){return t.creditCardDetails}getDaySuffix(t){if(t>=11&&t<=13)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}calculateNextDueDate(t){var m;if(!((m=t.creditCardDetails)!=null&&m.dueDate))return new Date;let r=t.creditCardDetails.dueDate,a=new Date,o=a.getMonth(),s=a.getFullYear(),u=new Date(s,o,r);return u<a&&(u=new Date(s,o+1,r)),u}calculateNextBillingDate(t){var m;if(!((m=t.creditCardDetails)!=null&&m.billingCycleStart))return new Date;let r=t.creditCardDetails.billingCycleStart,a=new Date,o=a.getMonth(),s=a.getFullYear(),u=new Date(s,o,r);return u<a&&(u=new Date(s,o+1,r)),u}onAccountClick(t){var r;((r=this.selectedAccount)==null?void 0:r.accountId)===t.accountId?this.selectedAccount=null:this.selectedAccount=t}getBalanceClass(t){return t.type==="loan"?"loan-account":t.balance>=0?"positive-balance":"negative-balance"}getAccountIcon(t){switch(t){case"bank":return"account_balance";case"cash":return"payments";case"credit":return"credit_card";case"loan":return"account_balance_wallet";default:return"account_balance"}}toggleAccountExpansion(t){var r;((r=this.expandedAccount)==null?void 0:r.accountId)===t.accountId?this.expandedAccount=null:this.expandedAccount=t}getRecentTransactions(t){return[]}getPositiveAccounts(){return this.accounts.filter(t=>t.balance>0)}getNegativeAccounts(){return this.accounts.filter(t=>t.balance<0)}getTotalPositiveBalance(){return this.getPositiveAccounts().reduce((t,r)=>t+r.balance,0)}getTotalNegativeBalance(){return this.getNegativeAccounts().reduce((t,r)=>{if(r.type===Za.LOAN){let a=r.loanDetails;return t-a.remainingBalance}return t+r.balance},0)}getAccountStats(t){return{totalTransactions:0,totalDeposits:0,totalWithdrawals:0,averageTransaction:0,largestTransaction:0,thisMonth:0,lastMonth:0}}};n.\u0275fac=function(r){return new(r||n)(q(pt),q(Kt),q(fn),q(Zi),q(ht),q(wt),q(At),q(Qi))},n.\u0275cmp=Ve({type:n,selectors:[["user-accounts"]],inputs:{home:"home"},decls:13,vars:16,consts:[["menu","matMenu"],[1,"accounts-container"],["class","error-message mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center justify-between",4,"ngIf"],["mat-fab","","color","primary","class","add-account-btn z-[100]",3,"click",4,"ngIf"],["class","fab-button",4,"ngIf"],[1,"accounts-grid"],[1,"accounts-list",3,"ngClass"],["class","section-header",4,"ngIf"],["class","balance-summary-card",3,"ngClass",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","accounts-grid-list",4,"ngIf"],[1,"error-message","mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg","flex","items-center","justify-between"],[1,"text-red-700","text-sm"],["mat-icon-button","",1,"error-close-button",3,"click"],["mat-fab","","color","primary",1,"add-account-btn","z-[100]",3,"click"],[1,"fab-button"],["mat-fab","","color","primary",1,"desktop-fab-btn",3,"click"],[1,"section-header"],[1,"header-content"],[1,"section-title"],[1,"section-subtitle"],[1,"balance-summary-card",3,"ngClass"],[1,"balance-summary-header"],[1,"balance-icon"],[1,"balance-summary-title","flex","justify-between","w-full"],[1,"balance-stat-value","pr-2"],[1,"balance-breakdown"],["class","breakdown-item positive",4,"ngIf"],["class","breakdown-item negative",4,"ngIf"],[1,"breakdown-item","positive"],[1,"breakdown-label"],[1,"breakdown-value"],[1,"breakdown-item","negative"],[1,"empty-state"],[1,"empty-icon"],[1,"empty-title"],[1,"empty-text"],["mat-raised-button","","color","primary","class","empty-state-button",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"empty-state-button",3,"click"],[1,"accounts-grid-list"],[1,"account-item",3,"class","expanded"],[1,"account-item"],[1,"account-content"],[1,"account-info"],[1,"account-icon-name"],[1,"account-icon-container"],[1,"account-icon"],[1,"account-details"],[1,"account-header"],[1,"account-name"],[1,"account-type-info"],[1,"loan-info"],[1,"account-type"],[1,"account-balance-info"],[1,"balance-label"],[1,"balance-value"],[1,"account-actions"],["mat-menu-item","","matTooltip","Edit account",1,"action-button","edit-button",3,"click"],["mat-menu-item","","matTooltip","Delete account",1,"action-button","delete-button",3,"click"],["matIconButton","",3,"matMenuTriggerFor"],[1,"expand-section"],["mat-button","",1,"expand-btn",3,"click"],["class","account-details-expanded",4,"ngIf"],[1,"loan-label"],[1,"loan-value"],[1,"account-details-expanded"],[1,"details-tabs"],["label","Basic Details"],[1,"tab-content"],[1,"detail-row"],[1,"detail-label"],[1,"detail-value"],["class","detail-row",4,"ngIf"],["label","Loan Details",4,"ngIf"],["label","Credit Card Details",4,"ngIf"],["label","Recent Transactions"],["class","no-transactions",4,"ngIf"],["class","transaction-list",4,"ngIf"],["label","Statistics"],[1,"detail-value","positive"],[1,"detail-value","negative"],["label","Loan Details"],[1,"detail-value","interest-amount"],["label","Credit Card Details"],[1,"no-transactions"],[1,"transaction-list"],[1,"transaction-item"],[1,"transaction-info"],[1,"transaction-description"],[1,"transaction-date"],[1,"transaction-amount"]],template:function(r,a){if(r&1&&(c(0,"div",1),X(1,B4,6,1,"div",2)(2,L4,3,0,"button",3)(3,V4,4,0,"div",4),c(4,"div",5)(5,"section",6),X(6,U4,8,6,"div",7)(7,W4,14,14,"div",8),pe(8,"async"),X(9,$4,9,1,"div",9),pe(10,"async"),X(11,o3,3,0,"div",10),pe(12,"async"),l()()()),r&2){let o,s;p(),w("ngIf",a.errorMessage),p(),w("ngIf",(a.breakpointService.device.isMobile||a.breakpointService.device.isTablePortrait)&&!a.home),p(),w("ngIf",!a.breakpointService.device.isMobile),p(2),w("ngClass",dl(14,R4,a.breakpointService.device.isTablePortrait)),p(),w("ngIf",!a.home),p(),w("ngIf",((o=(o=Ee(8,8,a.accounts$))==null?null:o.length)!==null&&o!==void 0?o:0)>0),p(2),w("ngIf",((s=Ee(10,10,a.accounts$))==null?null:s.length)===0&&!a.home),p(2),w("ngIf",!a.home&&Ee(12,12,a.accounts$))}},dependencies:[br,ct,Ht,bn,Ma,at,Po,So,Oo,ko,Eo,Jn,go,yr,Vn,Wi],styles:["@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideDown{0%{transform:translateY(-100%);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:-200% 0}to{background-position:200% 0}}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.accounts-container[_ngcontent-%COMP%]{padding:1rem;background:inherit;overflow:auto}@media (max-width: 640px){.accounts-container[_ngcontent-%COMP%]{padding:.5rem}}.error-message[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease}.error-message[_ngcontent-%COMP%]   .error-close-button[_ngcontent-%COMP%]{color:#dc2626;min-width:44px;min-height:44px}.add-account-btn[_ngcontent-%COMP%]{position:fixed;bottom:8rem;right:1rem;z-index:100;box-shadow:0 4px 12px #00000026;transition:all .2s ease}.add-account-btn[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 6px 16px #0003}.accounts-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:2rem;max-width:1200px;margin:0 auto;transition:opacity .3s ease}.accounts-grid.loading[_ngcontent-%COMP%]{opacity:.7;pointer-events:none}@media (min-width: 768px){.accounts-grid[_ngcontent-%COMP%]{flex-wrap:nowrap;gap:3rem}}@media (max-width: 640px){.accounts-grid[_ngcontent-%COMP%]{gap:1.5rem}}.accounts-list[_ngcontent-%COMP%]{width:100%;padding:.2rem;max-height:calc(90vh - 200px)}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]{max-height:100vh}}.accounts-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{margin-bottom:1.5rem;position:relative}.accounts-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;flex:1}.accounts-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:clamp(1.25rem,3vw,2rem);font-weight:600;color:#1f2937;margin:0 0 .25rem;height:35px}.accounts-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{color:#6b7280;font-size:clamp(.75rem,2vw,1rem);margin:0}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;border:1px solid #e5e7eb;margin-bottom:1.5rem;box-shadow:0 1px 3px #0000001a;border-left:4px solid #4d98a4}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]{padding:.5rem}}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-summary-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-summary-header[_ngcontent-%COMP%]   .balance-icon[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(70 119 127 / var(--tw-text-opacity));font-size:1.5rem;width:1.5rem;height:1.5rem}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-summary-header[_ngcontent-%COMP%]   .balance-summary-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#1f2937;margin:0;display:flex;justify-content:space-between;align-items:center;width:100%}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-summary-header[_ngcontent-%COMP%]   .balance-summary-title[_ngcontent-%COMP%]   .balance-stat-value[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:700}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-summary-header[_ngcontent-%COMP%]   .balance-summary-title[_ngcontent-%COMP%]   .balance-stat-value.positive[_ngcontent-%COMP%]{color:#10b981}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-summary-header[_ngcontent-%COMP%]   .balance-summary-title[_ngcontent-%COMP%]   .balance-stat-value.negative[_ngcontent-%COMP%]{color:#ef4444}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-summary-stats[_ngcontent-%COMP%]{margin-bottom:1rem}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-summary-stats[_ngcontent-%COMP%]   .balance-stat-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:5px}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-summary-stats[_ngcontent-%COMP%]   .balance-stat-item[_ngcontent-%COMP%]   .balance-stat-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-breakdown[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap;justify-content:flex-start}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-breakdown[_ngcontent-%COMP%]   .breakdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem .75rem;border-radius:6px;font-size:.875rem}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-breakdown[_ngcontent-%COMP%]   .breakdown-item[_ngcontent-%COMP%]{justify-content:space-between}}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-breakdown[_ngcontent-%COMP%]   .breakdown-item.positive[_ngcontent-%COMP%]{background:#f0fdf4;color:#166534}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-breakdown[_ngcontent-%COMP%]   .breakdown-item.positive[_ngcontent-%COMP%]   .breakdown-label[_ngcontent-%COMP%]{font-weight:500}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-breakdown[_ngcontent-%COMP%]   .breakdown-item.positive[_ngcontent-%COMP%]   .breakdown-value[_ngcontent-%COMP%]{font-weight:600}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-breakdown[_ngcontent-%COMP%]   .breakdown-item.negative[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-breakdown[_ngcontent-%COMP%]   .breakdown-item.negative[_ngcontent-%COMP%]   .breakdown-label[_ngcontent-%COMP%]{font-weight:500}.accounts-list[_ngcontent-%COMP%]   .balance-summary-card[_ngcontent-%COMP%]   .balance-breakdown[_ngcontent-%COMP%]   .breakdown-item.negative[_ngcontent-%COMP%]   .breakdown-value[_ngcontent-%COMP%]{font-weight:600}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem;background:#fff;border-radius:12px;border:2px dashed #d1d5db}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{margin-bottom:1rem}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:clamp(2.5rem,6vw,4rem);width:clamp(2.5rem,6vw,4rem);height:clamp(2.5rem,6vw,4rem);color:#9ca3af}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-title[_ngcontent-%COMP%]{font-size:clamp(1rem,2.5vw,1.5rem);font-weight:500;color:#374151;margin:0 0 .5rem}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-text[_ngcontent-%COMP%]{color:#6b7280;font-size:clamp(.75rem,2vw,1rem);margin:0 0 1.5rem}.accounts-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-state-button[_ngcontent-%COMP%]{min-height:44px;padding:.75rem 1.5rem;display:inline-flex;align-items:center;gap:.5rem}.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;scrollbar-width:thin;scrollbar-color:#cbd5e1 #f1f5f9}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]{gap:.75rem;max-height:60vh}}.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.accounts-list[_ngcontent-%COMP%]   .accounts-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]{width:100%;max-width:48%;background:#fff;border-radius:12px;padding:1.25rem;border:1px solid #e5e7eb;cursor:pointer;transition:all .2s ease;border-left:4px solid transparent}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]{padding:1rem;border-radius:10px;max-width:100%}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a;border-color:#d1d5db}.accounts-list[_ngcontent-%COMP%]   .account-item.positive-balance[_ngcontent-%COMP%]{border-left-color:#10b981}.accounts-list[_ngcontent-%COMP%]   .account-item.negative-balance[_ngcontent-%COMP%]{border-left-color:#ef4444}.accounts-list[_ngcontent-%COMP%]   .account-item.loan-account[_ngcontent-%COMP%]{border-left-color:#f59e0b}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem;position:relative}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-content[_ngcontent-%COMP%]{gap:.75rem}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]{padding:0 10px 10px;flex:1}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]{gap:.5rem}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-icon-container[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0;background:#f3f4f6}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-icon-container[_ngcontent-%COMP%]{width:2rem;height:2rem}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-icon-container[_ngcontent-%COMP%]   .account-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem;color:#6b7280}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:.5rem}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]{gap:.375rem}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-header[_ngcontent-%COMP%]{gap:.125rem}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-header[_ngcontent-%COMP%]   .account-name[_ngcontent-%COMP%]{padding-top:8px;font-size:clamp(1rem,2.5vw,1.25rem);font-weight:600;color:#1f2937;margin:0;line-height:1.2;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:80%}@media (max-width: 640px){.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-header[_ngcontent-%COMP%]   .account-name[_ngcontent-%COMP%]{font-size:1rem}}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-type-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-type-info[_ngcontent-%COMP%]   .account-type[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-type-info[_ngcontent-%COMP%]   .loan-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;flex-wrap:wrap}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-type-info[_ngcontent-%COMP%]   .loan-info[_ngcontent-%COMP%]   .loan-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-type-info[_ngcontent-%COMP%]   .loan-info[_ngcontent-%COMP%]   .loan-value[_ngcontent-%COMP%]{font-size:.75rem;color:#dc2626;font-weight:600}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-balance-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;flex-wrap:wrap}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-balance-info[_ngcontent-%COMP%]   .balance-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-balance-info[_ngcontent-%COMP%]   .balance-value[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-balance-info[_ngcontent-%COMP%]   .balance-value.positive[_ngcontent-%COMP%]{color:#10b981}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   .account-icon-name[_ngcontent-%COMP%]   .account-details[_ngcontent-%COMP%]   .account-balance-info[_ngcontent-%COMP%]   .balance-value.negative[_ngcontent-%COMP%]{color:#ef4444}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-actions[_ngcontent-%COMP%]   .action-button.edit-button[_ngcontent-%COMP%]{color:#3b82f6}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-actions[_ngcontent-%COMP%]   .action-button.edit-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#3b82f6}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-actions[_ngcontent-%COMP%]   .action-button.delete-button[_ngcontent-%COMP%]{color:#dc2626}.accounts-list[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   .account-actions[_ngcontent-%COMP%]   .action-button.delete-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#dc2626}.expand-section[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:8px 0;border-top:1px solid #e5e7eb}.expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem}.expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]:hover{color:#374151;background:#f3f4f6}.account-details-expanded[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb;background:#f9fafb;animation:_ngcontent-%COMP%_slideDown .3s ease}.account-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-header{background:#fff;border-bottom:1px solid #e5e7eb}.account-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-label{color:#6b7280;font-weight:500}.account-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-label.mat-mdc-tab-label-active{color:#3b82f6}.account-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-ink-bar{background-color:#3b82f6}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding:16px;background:#fff;min-height:200px}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #f3f4f6}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{font-weight:500;color:#6b7280;font-size:.875rem}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-weight:600;color:#111827;font-size:.875rem}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.positive[_ngcontent-%COMP%]{color:#10b981}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.negative[_ngcontent-%COMP%]{color:#ef4444}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.interest-amount[_ngcontent-%COMP%]{color:#dc2626;font-weight:700}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]{text-align:center;padding:32px 16px;color:#6b7280}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2rem;width:2rem;height:2rem;margin-bottom:8px;opacity:.5}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:#f9fafb;border-radius:6px;transition:background .2s ease}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .transaction-description[_ngcontent-%COMP%]{font-weight:500;color:#111827;font-size:.875rem}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .transaction-date[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount[_ngcontent-%COMP%]{font-weight:600;font-size:.875rem}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount.positive[_ngcontent-%COMP%]{color:#10b981}.account-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount.negative[_ngcontent-%COMP%]{color:#ef4444}@media (max-width: 768px){.accounts-container[_ngcontent-%COMP%]{padding:.5rem}.accounts-grid[_ngcontent-%COMP%]{gap:1rem}.balance-summary-card[_ngcontent-%COMP%]{padding:1rem}.balance-summary-card[_ngcontent-%COMP%]   .balance-breakdown[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}@media (max-width: 480px){.accounts-container[_ngcontent-%COMP%]{padding:.25rem}.balance-summary-card[_ngcontent-%COMP%]{padding:.5rem;margin:0}.balance-summary-card[_ngcontent-%COMP%]   .balance-summary-header[_ngcontent-%COMP%]   .balance-summary-title[_ngcontent-%COMP%]{font-size:1rem}.account-item[_ngcontent-%COMP%]{padding:.75rem}.account-item[_ngcontent-%COMP%]   .account-content[_ngcontent-%COMP%]{gap:.5rem}.account-item[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]{padding:0 5px 5px}}"]});let e=n;return e})();var Sg=Tr(Nr());var kc=(()=>{let n=class n{constructor(t,r,a){this.fb=t,this.dateService=r,this.validationService=a}createBudgetForm(){return this.fb.group({hasBudget:[!1],budgetAmount:[0,this.validationService.getBudgetAmountValidators()],budgetPeriod:["monthly",Qe.required],budgetStartDate:[new Date,Qe.required],budgetEndDate:[null],budgetAlertThreshold:[80,this.validationService.getBudgetThresholdValidators()],budgetAlertEnabled:[!0]})}initializeBudgetForm(t,r){var a,o,s,u,m,f,h,_,y,v;(a=r==null?void 0:r.budget)!=null&&a.hasBudget&&t.patchValue({hasBudget:(o=r.budget)==null?void 0:o.hasBudget,budgetAmount:((s=r.budget)==null?void 0:s.budgetAmount)||0,budgetPeriod:((u=r.budget)==null?void 0:u.budgetPeriod)||"monthly",budgetStartDate:(m=r.budget)!=null&&m.budgetStartDate?this.dateService.toDate((f=r.budget)==null?void 0:f.budgetStartDate):new Date,budgetEndDate:(h=r.budget)!=null&&h.budgetEndDate?this.dateService.toDate((_=r.budget)==null?void 0:_.budgetEndDate):null,budgetAlertThreshold:((y=r.budget)==null?void 0:y.budgetAlertThreshold)||80,budgetAlertEnabled:((v=r.budget)==null?void 0:v.budgetAlertEnabled)!==!1}),this.setupBudgetFormValidation(t)}setupBudgetFormValidation(t){var r,a;(r=t.get("hasBudget"))==null||r.valueChanges.subscribe(o=>{var s,u,m,f,h,_,y,v,C,P,D,T;o?((s=t.get("budgetAmount"))==null||s.enable(),(u=t.get("budgetPeriod"))==null||u.enable(),(m=t.get("budgetStartDate"))==null||m.enable(),(f=t.get("budgetEndDate"))==null||f.enable(),(h=t.get("budgetAlertThreshold"))==null||h.enable(),(_=t.get("budgetAlertEnabled"))==null||_.enable()):((y=t.get("budgetAmount"))==null||y.disable(),(v=t.get("budgetPeriod"))==null||v.disable(),(C=t.get("budgetStartDate"))==null||C.disable(),(P=t.get("budgetEndDate"))==null||P.disable(),(D=t.get("budgetAlertThreshold"))==null||D.disable(),(T=t.get("budgetAlertEnabled"))==null||T.disable())}),(a=t.get("hasBudget"))==null||a.updateValueAndValidity()}getBudgetDataFromForm(t){var a;let r=t.value;return{hasBudget:r.hasBudget||!1,budgetAmount:r.hasBudget&&(r==null?void 0:r.budgetAmount)||0,budgetPeriod:r.hasBudget&&(r==null?void 0:r.budgetPeriod)||"monthly",budgetStartDate:r.hasBudget&&((a=r==null?void 0:r.budgetStartDate)==null?void 0:a.getTime())||null,budgetEndDate:r.hasBudget&&r.budgetEndDate?r.budgetEndDate.getTime():null,budgetAlertThreshold:r.hasBudget&&(r==null?void 0:r.budgetAlertThreshold)||80,budgetAlertEnabled:r.hasBudget&&(r==null?void 0:r.budgetAlertEnabled)||!0}}isBudgetFormValid(t){var r;return(r=t.get("hasBudget"))!=null&&r.value?t.valid:!0}getBudgetPeriods(){return[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}]}formatBudgetAmount(t){return t?t.toLocaleString(Dt.LANGUAGE.DEFAULT,{minimumFractionDigits:2,maximumFractionDigits:2}):"0"}formatBudgetPeriod(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}getBudgetProgressColor(t,r,a){var o;return!((o=t.budget)!=null&&o.hasBudget)||!r?"#6b7280":r>=100?"#ef4444":r>=a?"#f59e0b":r>=60?"#3b82f6":"#10b981"}};n.\u0275fac=function(r){return new(r||n)(De(Ii),De(At),De(qr))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var y_=(e,n)=>n.id,s3=()=>[];function c3(e,n){if(e&1&&(c(0,"div",14)(1,"div",15)(2,"mat-icon"),d(3,"account_balance_wallet"),l(),c(4,"h3"),d(5,"Budget Summary"),l()(),c(6,"div",39)(7,"div",40)(8,"span",41),d(9),pe(10,"currency"),l(),c(11,"span",42),d(12),l()(),c(13,"div",43)(14,"div",44),se(15,"div",45),l(),c(16,"div",46)(17,"span",47),d(18),pe(19,"currency"),l(),c(20,"span",48),d(21),l()()(),c(22,"div",49)(23,"div",50)(24,"span",18),d(25,"Remaining"),l(),c(26,"span",19),d(27),pe(28,"currency"),l()()()()()),e&2){let i=S();p(9),z(Ee(10,11,i.data.category.budget==null?null:i.data.category.budget.budgetAmount)),p(3),oe("/ ",i.formatBudgetPeriod(i.data.category.budget==null?null:i.data.category.budget.budgetPeriod),""),p(3),Xt("width",i.Math.min(i.calculateBudgetProgressPercentage(i.data.category),100),"%")("background-color",i.getBudgetProgressColor(i.data.category)),p(3),oe("",Ee(19,13,i.calculateBudgetSpent(i.data.category))," spent"),p(3),oe("",i.calculateBudgetProgressPercentage(i.data.category).toFixed(1),"%"),p(5),Lt(i.getRemainingBudgetClass(i.data.category)),p(),oe(" ",Ee(28,15,i.calculateBudgetRemaining(i.data.category))," ")}}function l3(e,n){if(e&1&&(c(0,"div",17)(1,"span",18),d(2,"Transactions"),l(),c(3,"span",19),d(4),l()()),e&2){let i=S();p(4),z(i.data.categoryStats.totalTransactions)}}function d3(e,n){if(e&1&&(c(0,"div",21),se(1,"app-category-card",51),l()),e&2){let i=n.$implicit,t=S();p(),w("category",i)("isMobile",!0)("home",!0)("recentTransactions",t.data.recentTransactions)("categoryStats",t.data.categoryStats)("allTransactions",t.data.allTransactions)("subCategories",A0(9,s3))("subCategoryCount",0)("Math",t.Math)}}function u3(e,n){e&1&&(c(0,"div",24)(1,"span",18),d(2,"Parent Category"),l(),c(3,"span",19)(4,"mat-icon"),d(5,"account_tree"),l(),d(6," Subcategory "),l()())}function m3(e,n){if(e&1&&(c(0,"div",24)(1,"span",18),d(2,"Start Date"),l(),c(3,"span",19),d(4),pe(5,"date"),l()()),e&2){let i=S(2);p(4),z(yt(5,1,i.dateService.toDate(i.data.category.budget==null?null:i.data.category.budget.budgetStartDate),"shortDate"))}}function g3(e,n){if(e&1&&(c(0,"div",23)(1,"h4"),d(2,"Budget Details"),l(),c(3,"div",24)(4,"span",18),d(5,"Budget Amount"),l(),c(6,"span",19),d(7),pe(8,"currency"),l()(),c(9,"div",24)(10,"span",18),d(11,"Period"),l(),c(12,"span",19),d(13),l()(),X(14,m3,6,4,"div",26),l()),e&2){let i=S();p(7),z(Ee(8,3,i.data.category.budget==null?null:i.data.category.budget.budgetAmount)),p(6),z(i.formatBudgetPeriod(i.data.category.budget==null?null:i.data.category.budget.budgetPeriod)),p(),w("ngIf",i.data.category.budget==null?null:i.data.category.budget.budgetStartDate)}}function f3(e,n){if(e&1&&se(0,"app-category-card",51),e&2){let i=n.$implicit,t=S(2);w("category",i)("isMobile",!0)("home",!0)("recentTransactions",t.data.recentTransactions)("categoryStats",t.data.categoryStats)("allTransactions",t.data.allTransactions)("subCategories",t.data.subCategories)("subCategoryCount",t.data.subCategories.length)("Math",t.Math)}}function p3(e,n){if(e&1&&(c(0,"mat-tab",52)(1,"div",12)(2,"div",53),Ge(3,f3,1,9,"app-category-card",51,y_),l()()()),e&2){let i=S();p(3),He(i.data.subCategories)}}function h3(e,n){e&1&&(c(0,"div",54)(1,"mat-icon"),d(2,"receipt_long"),l(),c(3,"p"),d(4,"No recent transactions"),l()())}function x3(e,n){if(e&1&&(c(0,"div",57)(1,"div",58)(2,"span",59),d(3),l(),c(4,"span",60),d(5),pe(6,"date"),l()(),c(7,"span",41),d(8),pe(9,"currency"),l()()),e&2){let i=n.$implicit,t=S(2);p(3),z(i.payee),p(2),z(yt(6,5,t.dateService.toDate(i.date),"shortDate")),p(2),Lt(i.amount>=0?"positive":"negative"),p(),oe(" ",Ee(9,8,i.amount)," ")}}function _3(e,n){if(e&1&&(c(0,"div",55),X(1,x3,10,10,"div",56),l()),e&2){let i=S();p(),w("ngForOf",i.data.recentTransactions)}}var Pu=(()=>{let n=class n{constructor(t,r,a){this.dialogRef=t,this.data=r,this.dateService=a,this.selectedTabIndex=0,this.Math=Math}ngOnInit(){}onClose(){this.dialogRef.close()}calculateBudgetSpent(t){var u,m;if(!((u=t.budget)!=null&&u.hasBudget)||!((m=t.budget)!=null&&m.budgetAmount))return 0;let r=this.data.allTransactions.filter(f=>f.categoryId===t.id&&f.type===en.EXPENSE),a=t.budget.budgetStartDate,o=t.budget.budgetEndDate,s=r;if(a){let f=this.dateService.toDate(a);if(!f)return 0;s=s.filter(h=>{let _=this.dateService.toDate(h.date);return _&&_>=f})}if(o){let f=this.dateService.toDate(o);if(!f)return 0;s=s.filter(h=>{let _=this.dateService.toDate(h.date);return _&&_<=f})}return s.reduce((f,h)=>f+Math.abs(h.amount),0)}calculateBudgetRemaining(t){var a,o;if(!((a=t.budget)!=null&&a.hasBudget)||!((o=t.budget)!=null&&o.budgetAmount))return 0;let r=this.calculateBudgetSpent(t);return Math.max(0,(t.budget.budgetAmount||0)-r)}calculateBudgetProgressPercentage(t){var o,s;if(!((o=t.budget)!=null&&o.hasBudget)||!((s=t.budget)!=null&&s.budgetAmount))return 0;let r=this.calculateBudgetSpent(t),a=t.budget.budgetAmount||0;return a===0?0:r/a*100}getBudgetProgressColor(t){var o;let r=this.calculateBudgetProgressPercentage(t),a=((o=t.budget)==null?void 0:o.budgetAlertThreshold)||80;return r>=100?"#f44336":r>=a?"#ff9800":"#4caf50"}formatBudgetPeriod(t){return t?{daily:"Day",weekly:"Week",monthly:"Month",yearly:"Year"}[t]||t:""}getBudgetStatusClass(t){var o;let r=this.calculateBudgetProgressPercentage(t),a=((o=t.budget)==null?void 0:o.budgetAlertThreshold)||80;return r>=100?"budget-exceeded":r>=a?"budget-warning":"budget-ok"}getRemainingBudgetClass(t){return this.calculateBudgetRemaining(t)<=0?"budget-exceeded":"budget-ok"}calculateTotalSpentPerMonth(t){let r=this.data.allTransactions.filter(s=>s.categoryId===t.id&&s.type===en.EXPENSE),a=new Date().getMonth(),o=new Date().getFullYear();return r.filter(s=>{let u=this.dateService.toDate(s.date);return u&&u.getMonth()===a&&u.getFullYear()===o}).reduce((s,u)=>s+Math.abs(u.amount),0)}calculateTotalIncomePerMonth(t){let r=this.data.allTransactions.filter(s=>s.categoryId===t.id&&s.type===en.INCOME),a=new Date().getMonth(),o=new Date().getFullYear();return r.filter(s=>{let u=this.dateService.toDate(s.date);return u&&u.getMonth()===a&&u.getFullYear()===o}).reduce((s,u)=>s+u.amount,0)}getSubCategoryStats(t){let r=this.data.allTransactions.filter(y=>y.categoryId===t.id),a=r.length,o=r.filter(y=>y.type===en.EXPENSE).reduce((y,v)=>y+Math.abs(v.amount),0),s=a>0?o/a:0,u=r.length>0?Math.max(...r.map(y=>Math.abs(y.amount))):0,m=new Date().getMonth(),f=new Date().getFullYear(),h=r.filter(y=>{let v=this.dateService.toDate(y.date);return v&&v.getMonth()===m&&v.getFullYear()===f}).filter(y=>y.type===en.EXPENSE).reduce((y,v)=>y+Math.abs(v.amount),0),_=r.filter(y=>{let v=this.dateService.toDate(y.date);return v&&v.getMonth()===(m-1+12)%12&&v.getFullYear()===f}).filter(y=>y.type===en.EXPENSE).reduce((y,v)=>y+Math.abs(v.amount),0);return{totalTransactions:a,totalSpent:o,averageTransaction:s,largestTransaction:u,thisMonth:h,lastMonth:_}}};n.\u0275fac=function(r){return new(r||n)(q(fi),q(pi),q(At))},n.\u0275cmp=Ve({type:n,selectors:[["app-category-details-dialog"]],decls:113,vars:50,consts:[[1,"category-details-dialog"],["mat-fab","","aria-label","Close dialog",1,"floating-close-button",3,"click"],[1,"dialog-header"],[1,"category-header-info"],[1,"category-icon-container"],[1,"category-icon"],[1,"category-title"],[1,"category-type"],["mat-icon-button","",1,"close-button","desktop-close",3,"click"],[1,"dialog-content"],[1,"details-tabs",3,"selectedIndexChange","selectedIndex"],["label","Overview"],[1,"tab-content"],["class","summary-card",4,"ngIf"],[1,"summary-card"],[1,"card-header"],[1,"monthly-summary"],[1,"stat-row"],[1,"label"],[1,"value"],["class","stat-row",4,"ngIf"],[1,"mb-2"],["label","Details"],[1,"details-section"],[1,"detail-item"],[1,"color-preview"],["class","detail-item",4,"ngIf"],["class","details-section",4,"ngIf"],["label","Subcategories",4,"ngIf"],["label","Transactions"],[1,"transactions-section"],["class","no-transactions",4,"ngIf"],["class","transaction-list",4,"ngIf"],["label","Statistics"],[1,"statistics-grid"],[1,"stat-card"],[1,"stat-label"],[1,"stat-value"],[1,"stat-value","negative"],[1,"budget-overview"],[1,"budget-amount"],[1,"amount"],[1,"period"],[1,"budget-progress"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-info"],[1,"spent"],[1,"percentage"],[1,"budget-stats"],[1,"stat"],[3,"category","isMobile","home","recentTransactions","categoryStats","allTransactions","subCategories","subCategoryCount","Math"],["label","Subcategories"],[1,"subcategories-list"],[1,"no-transactions"],[1,"transaction-list"],["class","transaction-item",4,"ngFor","ngForOf"],[1,"transaction-item"],[1,"transaction-info"],[1,"description"],[1,"date"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"button",1),N("click",function(){return a.onClose()}),c(2,"mat-icon"),d(3,"close"),l()(),c(4,"div",2)(5,"div",3)(6,"div",4)(7,"mat-icon",5),d(8),l()(),c(9,"div",6)(10,"h2"),d(11),l(),c(12,"span",7),d(13),pe(14,"titlecase"),l()()(),c(15,"button",8),N("click",function(){return a.onClose()}),c(16,"mat-icon"),d(17,"close"),l()()(),c(18,"div",9)(19,"mat-tab-group",10),gt("selectedIndexChange",function(s){return mt(a.selectedTabIndex,s)||(a.selectedTabIndex=s),s}),c(20,"mat-tab",11)(21,"div",12),X(22,c3,29,17,"div",13),c(23,"div",14)(24,"div",15)(25,"mat-icon"),d(26,"calendar_today"),l(),c(27,"h3"),d(28,"This Month"),l()(),c(29,"div",16)(30,"div",17)(31,"span",18),d(32),l(),c(33,"span",19),d(34),pe(35,"currency"),pe(36,"currency"),l()(),X(37,l3,5,1,"div",20),l()(),Ge(38,d3,2,10,"div",21,y_),l()(),c(40,"mat-tab",22)(41,"div",12)(42,"div",23)(43,"div",24)(44,"span",18),d(45,"Category Name"),l(),c(46,"span",19),d(47),l()(),c(48,"div",24)(49,"span",18),d(50,"Type"),l(),c(51,"span",19),d(52),pe(53,"titlecase"),l()(),c(54,"div",24)(55,"span",18),d(56,"Icon"),l(),c(57,"span",19)(58,"mat-icon"),d(59),l(),d(60),l()(),c(61,"div",24)(62,"span",18),d(63,"Color"),l(),c(64,"span",19),se(65,"div",25),d(66),l()(),X(67,u3,7,0,"div",26),l(),X(68,g3,15,5,"div",27),l()(),X(69,p3,5,0,"mat-tab",28),c(70,"mat-tab",29)(71,"div",12)(72,"div",30),X(73,h3,5,0,"div",31)(74,_3,2,1,"div",32),l()()(),c(75,"mat-tab",33)(76,"div",12)(77,"div",34)(78,"div",35)(79,"span",36),d(80,"Total Transactions"),l(),c(81,"span",37),d(82),l()(),c(83,"div",35)(84,"span",36),d(85,"Total Spent"),l(),c(86,"span",38),d(87),pe(88,"currency"),l()(),c(89,"div",35)(90,"span",36),d(91,"Average Transaction"),l(),c(92,"span",37),d(93),pe(94,"currency"),l()(),c(95,"div",35)(96,"span",36),d(97,"Largest Transaction"),l(),c(98,"span",38),d(99),pe(100,"currency"),l()(),c(101,"div",35)(102,"span",36),d(103,"This Month"),l(),c(104,"span",38),d(105),pe(106,"currency"),l()(),c(107,"div",35)(108,"span",36),d(109,"Last Month"),l(),c(110,"span",38),d(111),pe(112,"currency"),l()()()()()()()()),r&2&&(p(7),Xt("color",a.data.category.color),p(),oe(" ",a.data.category.icon||"category"," "),p(3),z(a.data.category.name),p(2),z(Ee(14,32,a.data.category.type)),p(6),ut("selectedIndex",a.selectedTabIndex),p(3),w("ngIf",a.data.category==null||a.data.category.budget==null?null:a.data.category.budget.hasBudget),p(10),z(a.data.category.type==="expense"?"Spent":"Earned"),p(),Lt(a.data.category.type==="expense"?"negative":"positive"),p(),oe(" ",a.data.category.type==="expense"?Ee(35,34,a.calculateTotalSpentPerMonth(a.data.category)):Ee(36,36,a.calculateTotalIncomePerMonth(a.data.category))," "),p(3),w("ngIf",a.data.categoryStats==null?null:a.data.categoryStats.totalTransactions),p(),He(a.data.subCategories),p(9),z(a.data.category.name),p(5),z(Ee(53,38,a.data.category.type)),p(6),Xt("color",a.data.category.color),p(),z(a.data.category.icon||"category"),p(),oe(" ",a.data.category.icon||"category"," "),p(5),Xt("background-color",a.data.category.color),p(),oe(" ",a.data.category.color," "),p(),w("ngIf",a.data.category.parentCategoryId),p(),w("ngIf",a.data.category==null||a.data.category.budget==null?null:a.data.category.budget.hasBudget),p(),w("ngIf",a.data.subCategories==null?null:a.data.subCategories.length),p(4),w("ngIf",!(a.data.recentTransactions!=null&&a.data.recentTransactions.length)),p(),w("ngIf",a.data.recentTransactions==null?null:a.data.recentTransactions.length),p(8),z((a.data.categoryStats==null?null:a.data.categoryStats.totalTransactions)||0),p(5),z(Ee(88,40,a.data.categoryStats==null?null:a.data.categoryStats.totalSpent)),p(6),z(Ee(94,42,a.data.categoryStats==null?null:a.data.categoryStats.averageTransaction)),p(6),z(Ee(100,44,a.data.categoryStats==null?null:a.data.categoryStats.largestTransaction)),p(6),z(Ee(106,46,a.data.categoryStats==null?null:a.data.categoryStats.thisMonth)),p(6),z(Ee(112,48,a.data.categoryStats==null?null:a.data.categoryStats.lastMonth)))},styles:[".category-details-dialog[_ngcontent-%COMP%]{max-width:700px;width:90vw;max-height:85vh;display:flex;flex-direction:column;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 20px 40px #0000001a;position:relative}.category-details-dialog[_ngcontent-%COMP%]   .floating-close-button[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;z-index:1000;background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(0,0,0,.1);box-shadow:0 4px 12px #00000026;width:48px;height:48px;display:none}.category-details-dialog[_ngcontent-%COMP%]   .floating-close-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#64748b;font-size:20px;width:20px;height:20px}.category-details-dialog[_ngcontent-%COMP%]   .floating-close-button[_ngcontent-%COMP%]:hover{background:#fff;transform:scale(1.05)}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:24px 32px;background:linear-gradient(135deg,#f8fafc,#f1f5f9);border-bottom:1px solid #e2e8f0;flex-shrink:0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:16px;background:#fffc;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #0000001a}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 4px;font-size:24px;font-weight:700;color:#1e293b;line-height:1.2}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-title[_ngcontent-%COMP%]   .category-type[_ngcontent-%COMP%]{font-size:14px;color:#64748b;text-transform:capitalize;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#64748b;transition:all .2s ease}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#1e293b;background:#0000000d}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button.desktop-close[_ngcontent-%COMP%]{display:block}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column;min-height:0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;min-height:0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-header{background:#f8fafc;border-bottom:1px solid #e2e8f0;flex-shrink:0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-header .mat-tab-label{color:#64748b;font-weight:500;min-width:120px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-header .mat-tab-label.mat-tab-label-active{color:#3b82f6}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-header .mat-ink-bar{background-color:#3b82f6}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-body-wrapper{flex:1;overflow:hidden}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-body{height:100%;overflow:hidden;display:flex;flex-direction:column}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-body-content{height:100%;overflow:hidden;display:flex;flex-direction:column}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden;padding:24px 32px;min-height:0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:24px;margin-bottom:20px;box-shadow:0 2px 8px #0000000a;transition:all .2s ease}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #00000014;transform:translateY(-1px)}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:20px;width:20px;height:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:8px;margin-bottom:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .period[_ngcontent-%COMP%]{font-size:16px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]{margin-bottom:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background:#f1f5f9;border-radius:4px;overflow:hidden;margin-bottom:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s ease;border-radius:4px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]   .spent[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]   .percentage[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#f8fafc;border-radius:8px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;font-size:16px;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-ok[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-warning[_ngcontent-%COMP%]{color:#d97706}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-exceeded[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f1f5f9}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;font-size:16px;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .value.positive[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .value.negative[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f1f5f9}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500;color:#1e293b;font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600;font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .amount.positive[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .amount.negative[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .more-indicator[_ngcontent-%COMP%]{text-align:center;padding:12px 0;color:#64748b;font-size:14px;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]{margin-bottom:32px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;font-weight:600;color:#1e293b;padding-bottom:8px;border-bottom:2px solid #e2e8f0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 0;border-bottom:1px solid #f1f5f9}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;display:flex;align-items:center;gap:8px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:6px;border:2px solid #e2e8f0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:20px;transition:all .2s ease}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #00000014;transform:translateY(-1px)}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;background:#f8fafc;display:flex;align-items:center;justify-content:center}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;font-size:16px;display:block}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{font-size:12px;color:#64748b;text-transform:capitalize}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;padding:12px;background:#f8fafc;border-radius:8px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#64748b;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;font-size:14px;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.positive[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.negative[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-ok[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-warning[_ngcontent-%COMP%]{color:#d97706}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value.budget-exceeded[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#94a3b8}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;opacity:.5}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:500}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:#fff;border:1px solid #e2e8f0;border-radius:10px;transition:all .2s ease}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #0000000f}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-size:12px;color:#64748b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:700;font-size:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .amount.positive[_ngcontent-%COMP%]{color:#059669}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .amount.negative[_ngcontent-%COMP%]{color:#dc2626}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:20px;text-align:center;transition:all .2s ease}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #00000014;transform:translateY(-2px)}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{display:block;font-size:12px;color:#64748b;font-weight:500;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{display:block;font-size:24px;font-weight:700;color:#1e293b}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-value.negative[_ngcontent-%COMP%]{color:#dc2626}.budget-ok[_ngcontent-%COMP%]{color:#059669!important}.budget-warning[_ngcontent-%COMP%]{color:#d97706!important}.budget-exceeded[_ngcontent-%COMP%]{color:#dc2626!important}@media (max-width: 768px){.category-details-dialog[_ngcontent-%COMP%]{width:100vw;height:100vh;max-height:100vh;border-radius:0;margin:0}.category-details-dialog[_ngcontent-%COMP%]   .floating-close-button[_ngcontent-%COMP%]{display:flex!important;align-items:center;justify-content:center}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{padding:60px 20px 16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]{gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]{width:44px;height:44px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;line-height:1.3}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .category-header-info[_ngcontent-%COMP%]   .category-title[_ngcontent-%COMP%]   .category-type[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button.desktop-close[_ngcontent-%COMP%]{display:none}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-header .mat-tab-label{min-width:80px;font-size:13px;padding:0 12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding:16px 20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{padding:16px;margin-bottom:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{margin-bottom:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:24px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .budget-overview[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .period[_ngcontent-%COMP%]{font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]{padding:10px 0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .monthly-summary[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]{padding:10px 0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .subcategories-summary[_ngcontent-%COMP%]   .subcategory-item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]{margin-bottom:24px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:15px;margin-bottom:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{padding:12px 0}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:20px;height:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]{gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]{padding:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]{margin-bottom:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-icon[_ngcontent-%COMP%]{width:36px;height:36px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-header[_ngcontent-%COMP%]   .subcategory-info[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{font-size:11px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{padding:10px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:11px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .subcategories-list[_ngcontent-%COMP%]   .subcategory-card[_ngcontent-%COMP%]   .subcategory-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]{gap:10px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]{padding:14px 16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:13px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-size:11px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transactions-section[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:14px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{padding:16px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:11px;margin-bottom:6px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:18px}}@media (min-width: 769px) and (max-width: 1024px){.category-details-dialog[_ngcontent-%COMP%]{width:85vw;max-width:800px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding:20px 28px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{padding:20px}.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 1025px){.category-details-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .statistics-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}"]});let e=n;return e})();var C3=(e,n)=>n.value;function v3(e,n){e&1&&(c(0,"mat-error"),d(1," Budget amount is required "),l())}function b3(e,n){e&1&&(c(0,"mat-error"),d(1," Budget amount must be greater than 0 "),l())}function y3(e,n){if(e&1&&(c(0,"div",16)(1,"label",17),d(2,"Budget Amount"),l(),c(3,"mat-form-field",18),se(4,"input",19),X(5,v3,2,0,"mat-error",20)(6,b3,2,0,"mat-error",20),l()()),e&2){let i=S();p(5),w("ngIf",i.budgetAmountControl==null?null:i.budgetAmountControl.hasError("required")),p(),w("ngIf",i.budgetAmountControl==null?null:i.budgetAmountControl.hasError("min"))}}function M3(e,n){if(e&1&&(c(0,"mat-option",22),d(1),l()),e&2){let i=n.$implicit;w("value",i.value),p(),oe(" ",i.label," ")}}function w3(e,n){e&1&&(c(0,"mat-error"),d(1," Budget period is required "),l())}function S3(e,n){if(e&1&&(c(0,"div",16)(1,"label",17),d(2,"Budget Period"),l(),c(3,"mat-form-field",18)(4,"mat-select",21),Ge(5,M3,2,2,"mat-option",22,C3),l(),X(7,w3,2,0,"mat-error",20),l()()),e&2){let i=S();p(5),He(i.budgetPeriods),p(2),w("ngIf",i.budgetPeriodControl==null?null:i.budgetPeriodControl.hasError("required"))}}function P3(e,n){e&1&&(c(0,"mat-error"),d(1," Start date is required "),l())}function O3(e,n){if(e&1&&(c(0,"div",16)(1,"label",17),d(2,"Start Date"),l(),c(3,"mat-form-field",18),se(4,"input",23)(5,"mat-datepicker-toggle",24)(6,"mat-datepicker",null,0),X(8,P3,2,0,"mat-error",20),l()()),e&2){let i,t=Gn(7),r=S();p(4),w("matDatepicker",t)("min",r.minDate)("max",r.maxDate),p(),w("for",t),p(3),w("ngIf",(i=r.budgetForm.get("budgetStartDate"))==null?null:i.hasError("required"))}}function k3(e,n){if(e&1&&(c(0,"div",16)(1,"label",17),d(2,"End Date (Optional)"),l(),c(3,"mat-form-field",18),se(4,"input",25)(5,"mat-datepicker-toggle",24)(6,"mat-datepicker",null,1),l()()),e&2){let i=Gn(7),t=S();p(4),w("matDatepicker",i)("min",t.minDate)("max",t.maxDate),p(),w("for",i)}}function E3(e,n){e&1&&(c(0,"mat-error"),d(1," Threshold must be at least 0% "),l())}function T3(e,n){e&1&&(c(0,"mat-error"),d(1," Threshold cannot exceed 100% "),l())}function I3(e,n){if(e&1&&(c(0,"div",16)(1,"label",17),d(2,"Alert Threshold (%)"),l(),c(3,"mat-form-field",18),se(4,"input",26),c(5,"mat-hint"),d(6,"Get notified when you reach this percentage of your budget"),l(),X(7,E3,2,0,"mat-error",20)(8,T3,2,0,"mat-error",20),l()()),e&2){let i,t,r=S();p(7),w("ngIf",(i=r.budgetForm.get("budgetAlertThreshold"))==null?null:i.hasError("min")),p(),w("ngIf",(t=r.budgetForm.get("budgetAlertThreshold"))==null?null:t.hasError("max"))}}function A3(e,n){e&1&&(c(0,"div",16)(1,"mat-slide-toggle",27)(2,"span",28),d(3,"Enable budget alerts"),l()()())}var w_=(()=>{let n=class n{constructor(t,r,a){this.dialogRef=t,this.data=r,this.budgetService=a,this.minDate=new Date,this.maxDate=new Date(new Date().getFullYear()+1,11,31),this.budgetForm=this.budgetService.createBudgetForm(),this.budgetPeriods=this.budgetService.getBudgetPeriods()}ngOnInit(){this.budgetService.initializeBudgetForm(this.budgetForm,this.data.category)}onCancel(){this.dialogRef.close()}onSave(){if(this.budgetService.isBudgetFormValid(this.budgetForm)){let t=this.budgetService.getBudgetDataFromForm(this.budgetForm);this.dialogRef.close(t)}}get isFormValid(){return this.budgetService.isBudgetFormValid(this.budgetForm)}get budgetAmountControl(){return this.budgetForm.get("budgetAmount")}get budgetPeriodControl(){return this.budgetForm.get("budgetPeriod")}};n.\u0275fac=function(r){return new(r||n)(q(fi),q(pi),q(kc))},n.\u0275cmp=Ve({type:n,selectors:[["app-category-budget-dialog"]],decls:30,vars:11,consts:[["startPicker",""],["endPicker",""],[1,"budget-dialog-container"],[1,"dialog-header"],["mat-dialog-title",""],[1,"header-icon"],["mat-icon-button","",1,"close-button",3,"click"],[1,"dialog-content"],[1,"budget-form",3,"formGroup"],[1,"form-field-toggle"],[1,"toggle-label","text-sm","font-semibold"],["formControlName","hasBudget","color","primary",1,"budget-toggle"],["class","form-field",4,"ngIf"],[1,"dialog-actions"],["mat-button","",1,"cancel-button",3,"click"],["mat-raised-button","","color","primary",1,"save-button",3,"click","disabled"],[1,"form-field"],[1,"field-label"],["appearance","fill",1,"form-input-field"],["matInput","","type","number","formControlName","budgetAmount","placeholder","0.00","step","0.01",1,"form-input"],[4,"ngIf"],["formControlName","budgetPeriod",1,"form-select"],[3,"value"],["matInput","","formControlName","budgetStartDate","placeholder","Choose start date",1,"form-input",3,"matDatepicker","min","max"],["matSuffix","",3,"for"],["matInput","","formControlName","budgetEndDate","placeholder","Choose end date (optional)",1,"form-input",3,"matDatepicker","min","max"],["matInput","","type","number","formControlName","budgetAlertThreshold","placeholder","80",1,"form-input"],["formControlName","budgetAlertEnabled","color","primary",1,"alert-toggle"],[1,"toggle-label"]],template:function(r,a){if(r&1&&(c(0,"div",2)(1,"div",3)(2,"h2",4)(3,"mat-icon",5),d(4,"account_balance_wallet"),l(),d(5),l(),c(6,"button",6),N("click",function(){return a.onCancel()}),c(7,"mat-icon"),d(8,"close"),l()()(),c(9,"mat-dialog-content",7)(10,"form",8)(11,"div",9)(12,"span",10),d(13),l(),se(14,"mat-slide-toggle",11),l(),X(15,y3,7,2,"div",12)(16,S3,8,1,"div",12)(17,O3,9,5,"div",12)(18,k3,8,4,"div",12)(19,I3,9,2,"div",12)(20,A3,4,0,"div",12),l()(),c(21,"mat-dialog-actions",13)(22,"button",14),N("click",function(){return a.onCancel()}),c(23,"mat-icon"),d(24,"cancel"),l(),d(25," Cancel "),l(),c(26,"button",15),N("click",function(){return a.onSave()}),c(27,"mat-icon"),d(28,"save"),l(),d(29),l()()()),r&2){let o,s,u,m,f,h;p(5),oe(" ",a.data.isEdit?"Edit":"Set"," Budget "),p(5),w("formGroup",a.budgetForm),p(3),oe("Set budget for ",a.data.category.name,""),p(2),w("ngIf",(o=a.budgetForm.get("hasBudget"))==null?null:o.value),p(),w("ngIf",(s=a.budgetForm.get("hasBudget"))==null?null:s.value),p(),w("ngIf",(u=a.budgetForm.get("hasBudget"))==null?null:u.value),p(),w("ngIf",(m=a.budgetForm.get("hasBudget"))==null?null:m.value),p(),w("ngIf",(f=a.budgetForm.get("hasBudget"))==null?null:f.value),p(),w("ngIf",(h=a.budgetForm.get("hasBudget"))==null?null:h.value),p(6),w("disabled",!a.isFormValid),p(3),oe(" ",a.data.isEdit?"Update":"Set"," Budget ")}},dependencies:[ct,jn,Vt,ki,Ut,Un,Ei,Ti,Ht,bn,at,Fd,Rd,Nd,Ji,Dd,Sa,wo,Ni,Fi,Pa,Pd,kd,Od,Jr],styles:["@media (max-width: 640px){.budget-dialog-container[_ngcontent-%COMP%]{min-width:320px;max-width:100vw}}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 1.5rem 0;border-bottom:1px solid #e5e7eb}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{padding-left:0!important;margin:0;display:flex;align-items:center;gap:.5rem;font-size:1.25rem;font-weight:600;color:#1f2937}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{color:#3b82f6}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#6b7280}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#374151;background-color:#f3f4f6}.dialog-content[_ngcontent-%COMP%]{padding:1.5rem;max-height:70vh;overflow-y:auto}.dialog-content[_ngcontent-%COMP%]   .budget-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]{font-weight:500;color:#374151;font-size:.875rem}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .form-input-field[_ngcontent-%COMP%]{width:100%}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .form-input-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%], .dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .form-input-field[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{font-size:.875rem}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%], .dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]{margin-top:.5rem}.dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .budget-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%], .dialog-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .alert-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-weight:500;color:#374151;margin-left:.5rem}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;padding:1rem 1.5rem 1.5rem;border-top:1px solid #e5e7eb}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{color:#6b7280}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]:hover{color:#374151;background-color:#f3f4f6}.dialog-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.dialog-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#2563eb}.dialog-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:disabled{background-color:#9ca3af;color:#6b7280}.form-field-toggle[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:baseline}"]});let e=n;return e})();function D3(e,n){if(e&1&&(c(0,"div",28)(1,"div",29),se(2,"div",30),l(),c(3,"span",31),d(4),pe(5,"currency"),l()()),e&2){let i=S(2);p(2),Xt("width",i.Math.min(i.calculateBudgetProgressPercentage(i.category),100),"%")("background-color",i.getBudgetProgressColor(i.category)),p(2),jt(" ",Ee(5,6,i.calculateBudgetSpent(i.category))," (",i.calculateBudgetProgressPercentage(i.category).toFixed(1),"%) ")}}function F3(e,n){if(e&1&&(c(0,"div",22)(1,"div",23)(2,"span",24),d(3,"Budget:"),l(),c(4,"span",25),d(5),pe(6,"currency"),l(),c(7,"span",26),d(8),l()(),X(9,D3,6,8,"div",27),l()),e&2){let i=S();p(5),z(Ee(6,3,i.category.budget==null?null:i.category.budget.budgetAmount)),p(3),oe("/ ",i.formatBudgetPeriod(i.category.budget==null?null:i.category.budget.budgetPeriod),""),p(),w("ngIf",i.category.budget==null?null:i.category.budget.hasBudget)}}function R3(e,n){if(e&1&&(c(0,"div",32)(1,"span",33),d(2),l(),c(3,"span",34),d(4),pe(5,"currency"),pe(6,"currency"),l()()),e&2){let i=S();p(2),z(i.category.type==="expense"?"Spent:":"Income:"),p(2),z(i.category.type==="expense"?Ee(5,2,i.calculateTotalSpentPerMonth(i.category)):Ee(6,4,i.calculateTotalIncomePerMonth(i.category)))}}function N3(e,n){if(e&1){let i=be();c(0,"button",35),N("click",function(){G(i);let r=S();return H(r.onOpenBudgetDialog())}),c(1,"mat-icon"),d(2,"account_balance_wallet"),l(),d(3),l()}if(e&2){let i=S();w("matTooltip",i.category.budget!=null&&i.category.budget.hasBudget?"Edit budget":"Set budget"),p(3),oe(" ",i.category.budget!=null&&i.category.budget.hasBudget?"Edit Budget":"Set Budget"," ")}}function B3(e,n){if(e&1){let i=be();c(0,"button",36),N("click",function(){G(i);let r=S();return H(r.onSelectParentCategory())}),c(1,"mat-icon"),d(2,"account_tree"),l(),d(3," Select Parent Category "),l()}}function L3(e,n){if(e&1){let i=be();c(0,"button",37),N("click",function(){G(i);let r=S();return H(r.onRemoveFromParentCategory())}),c(1,"mat-icon"),d(2,"account_tree_off"),l(),d(3," Remove from Parent "),l()}}function V3(e,n){if(e&1){let i=be();c(0,"div",38)(1,"button",39),N("click",function(){G(i);let r=S();return H(r.onOpenDetailsDialog())}),c(2,"mat-icon"),d(3,"expand_more"),l(),c(4,"span"),d(5,"Show More"),l()()()}}var Eu=(()=>{let n=class n{constructor(t,r,a,o,s,u,m,f){this.dateService=t,this.dialog=r,this.notificationService=a,this.hapticFeedback=o,this.categoryService=s,this.budgetService=u,this.store=m,this.auth=f,this.isMobile=!1,this.home=!1,this.recentTransactions=[],this.subCategoryCount=0,this.allTransactions=[],this.subCategories=[],this.userId="",this.initializeUserId()}initializeUserId(){return ue(this,null,function*(){let t=yield this.auth.currentUser;t&&(this.userId=t.uid)})}calculateBudgetSpent(t){var u,m;if(!((u=t.budget)!=null&&u.hasBudget)||!((m=t.budget)!=null&&m.budgetAmount))return 0;let r=this.allTransactions.filter(f=>f.categoryId===t.id&&f.type===en.EXPENSE),a=t.budget.budgetStartDate,o=t.budget.budgetEndDate,s=r;if(a){let f=this.dateService.toDate(a);if(!f)return 0;s=s.filter(h=>{let _=this.dateService.toDate(h.date);return _&&_>=f})}if(o){let f=this.dateService.toDate(o);if(!f)return 0;s=s.filter(h=>{let _=this.dateService.toDate(h.date);return _&&_<=f})}return s.reduce((f,h)=>f+Math.abs(h.amount),0)}calculateBudgetRemaining(t){var a,o;if(!((a=t.budget)!=null&&a.hasBudget)||!((o=t.budget)!=null&&o.budgetAmount))return 0;let r=this.calculateBudgetSpent(t);return Math.max(0,(t.budget.budgetAmount||0)-r)}calculateBudgetProgressPercentage(t){var o,s;if(!((o=t.budget)!=null&&o.hasBudget)||!((s=t.budget)!=null&&s.budgetAmount))return 0;let r=this.calculateBudgetSpent(t),a=t.budget.budgetAmount||0;return a===0?0:Math.min(100,r/a*100)}calculateTotalSpentPerMonth(t){return!this.recentTransactions||this.recentTransactions.length===0?0:this.recentTransactions.reduce((r,a)=>r+Math.abs(a.amount),0)}calculateTotalIncomePerMonth(t){if(!this.recentTransactions||this.recentTransactions.length===0)return 0;let r=new Date().getMonth(),a=new Date().getFullYear();return this.recentTransactions.filter(o=>{let s=this.dateService.toDate(o.date);return s?o.categoryId===t.id&&o.amount>0&&s.getMonth()===r&&s.getFullYear()===a:!1}).reduce((o,s)=>o+s.amount,0)}getBudgetProgressColor(t){let r=this.calculateBudgetProgressPercentage(t);return r>=100?"#ef4444":r>=80?"#f59e0b":r>=60?"#3b82f6":"#10b981"}formatBudgetPeriod(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}getBudgetStatusClass(t){let r=this.calculateBudgetProgressPercentage(t);return r>=100?"danger":r>=80?"warning":"safe"}getRemainingBudgetClass(t){return this.calculateBudgetRemaining(t)<0?"danger":"safe"}onEditCategory(){this.isMobile?this.openMobileEditDialog():this.openEditDialog()}onDeleteCategory(){this.openDeleteConfirmationDialog()}onOpenBudgetDialog(){this.openBudgetDialog()}onSelectParentCategory(){this.openParentCategorySelectorDialog()}onRemoveFromParentCategory(){this.removeFromParentCategory()}onOpenDetailsDialog(){let t={category:this.category,subCategories:this.subCategories,recentTransactions:this.recentTransactions,categoryStats:this.categoryStats,allTransactions:this.allTransactions};this.dialog.open(Pu,{data:t,width:"90vw",maxWidth:"700px",height:"85vh",maxHeight:"85vh",disableClose:!1,autoFocus:!1,hasBackdrop:!0,backdropClass:"dialog-backdrop",panelClass:"category-details-dialog-panel"})}openMobileEditDialog(){this.dialog.open(ss,{width:"100vw",height:"100vh",maxWidth:"100vw",maxHeight:"100vh",data:{category:this.category,isEdit:!0},disableClose:!1,autoFocus:!1,hasBackdrop:!0,backdropClass:"dialog-backdrop",panelClass:"mobile-category-dialog-panel"}).afterClosed().subscribe(r=>{r&&(this.notificationService.success("Category updated successfully"),this.hapticFeedback.successVibration())})}openEditDialog(){this.dialog.open(ss,{width:"500px",maxWidth:"90vw",data:{category:this.category,isEdit:!0},disableClose:!1}).afterClosed().subscribe(r=>{r&&this.notificationService.success("Category updated successfully")})}openDeleteConfirmationDialog(){this.dialog.open(Kr,{width:"400px",data:{title:"Delete Category",message:`Are you sure you want to delete "${this.category.name}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",confirmColor:"warn"}}).afterClosed().subscribe(r=>{r&&this.performDelete()})}performDelete(){if(!this.category.id){this.notificationService.error("Category ID not found");return}this.store.dispatch(nc({userId:this.userId,categoryId:this.category.id})),this.notificationService.success("Category deleted successfully"),this.hapticFeedback.successVibration()}openBudgetDialog(){var r;this.dialog.open(w_,{width:"500px",maxWidth:"90vw",data:{category:this.category,isEdit:((r=this.category.budget)==null?void 0:r.hasBudget)||!1},disableClose:!1}).afterClosed().subscribe(a=>{a&&this.updateCategoryBudget(a)})}updateCategoryBudget(t){if(!this.category.id){this.notificationService.error("Category ID not found");return}this.store.dispatch(ba({userId:this.userId,categoryId:this.category.id,name:this.category.name,categoryType:this.category.type,icon:this.category.icon,color:this.category.color,budgetData:t})),this.notificationService.success(t.hasBudget?"Budget set successfully for "+this.category.name:"Budget removed from "+this.category.name)}openParentCategorySelectorDialog(){this.categoryService.openParentCategorySelectorDialog(this.category).subscribe(t=>{t&&this.convertToSubCategory(t)})}convertToSubCategory(t){if(!this.category.id||!t.id){this.notificationService.error("Category ID not found");return}this.store.dispatch(ba({userId:this.userId,categoryId:this.category.id,name:this.category.name,categoryType:this.category.type,icon:this.category.icon,color:this.category.color,parentCategoryId:t.id,isSubCategory:!0})),this.notificationService.success(`${this.category.name} is now a sub-category of ${t.name}`)}removeFromParentCategory(){if(!this.category.id){this.notificationService.error("Category ID not found");return}this.store.dispatch(ba({userId:this.userId,categoryId:this.category.id,name:this.category.name,categoryType:this.category.type,icon:this.category.icon,color:this.category.color,parentCategoryId:null,isSubCategory:!1})),this.category.parentCategoryId&&this.notificationService.success(`${this.category.name} is no longer a sub-category`)}};n.\u0275fac=function(r){return new(r||n)(q(At),q(fn),q(ht),q(Sr),q(Do),q(kc),q(wt),q(pt))},n.\u0275cmp=Ve({type:n,selectors:[["app-category-card"]],inputs:{category:"category",isMobile:"isMobile",home:"home",recentTransactions:"recentTransactions",categoryStats:"categoryStats",subCategoryCount:"subCategoryCount",Math:"Math",allTransactions:"allTransactions",subCategories:"subCategories"},decls:34,vars:16,consts:[["menu","matMenu"],[1,"category-item"],[1,"category-content"],[1,"category-info"],[1,"category-icon-name"],[1,"category-icon-container"],[1,"category-icon"],[1,"category-header"],[1,"category-name"],[1,"text-[0.6rem]","text-gray-400","italic"],[1,"category-details"],["class","budget-info",4,"ngIf"],["class","category-spent",4,"ngIf"],[1,"category-actions"],["mat-menu-item","","class","action-button budget-button",3,"matTooltip","click",4,"ngIf"],["mat-menu-item","","matTooltip","Edit category",1,"action-button","edit-button",3,"click"],["mat-menu-item","","class","action-button parent-button","matTooltip","Select parent category",3,"click",4,"ngIf"],["mat-menu-item","","class","action-button remove-parent-button","matTooltip","Remove from parent category",3,"click",4,"ngIf"],["mat-menu-item","","matTooltip","Delete category",1,"action-button","delete-button",3,"click"],[1,"!text-red-800"],["matIconButton","",3,"matMenuTriggerFor"],["class","expand-section",4,"ngIf"],[1,"budget-info"],[1,"budget-amount"],[1,"budget-label"],[1,"budget-value"],[1,"budget-period"],["class","budget-progress",4,"ngIf"],[1,"budget-progress"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[1,"category-spent"],[1,"category-spent-label"],[1,"category-spent-value"],["mat-menu-item","",1,"action-button","budget-button",3,"click","matTooltip"],["mat-menu-item","","matTooltip","Select parent category",1,"action-button","parent-button",3,"click"],["mat-menu-item","","matTooltip","Remove from parent category",1,"action-button","remove-parent-button",3,"click"],[1,"expand-section"],["mat-button","",1,"expand-btn",3,"click"]],template:function(r,a){if(r&1){let o=be();c(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"mat-icon",6),d(6),l()(),c(7,"div",7)(8,"h3",8),d(9),c(10,"span",9),d(11),pe(12,"titlecase"),l()()()(),c(13,"div",10),X(14,F3,10,5,"div",11)(15,R3,7,6,"div",12),l()(),c(16,"div",13)(17,"mat-menu",null,0),X(19,N3,4,2,"button",14),c(20,"button",15),N("click",function(){return G(o),H(a.onEditCategory())}),c(21,"mat-icon"),d(22,"edit"),l(),d(23," Edit "),l(),X(24,B3,4,0,"button",16)(25,L3,4,0,"button",17),c(26,"button",18),N("click",function(){return G(o),H(a.onDeleteCategory())}),c(27,"mat-icon",19),d(28,"delete"),l(),d(29," Delete "),l()(),c(30,"button",20)(31,"mat-icon"),d(32,"more_vert"),l()()()(),X(33,V3,6,0,"div",21),l()}if(r&2){let o=Gn(18);Xt("border-left-color",a.category.color),p(5),Xt("color",a.category.color),p(),z(a.category.icon||"category"),p(3),oe("",a.category.name," "),p(2),oe(" ",Ee(12,14,a.category.type),""),p(3),w("ngIf",a.category==null||a.category.budget==null?null:a.category.budget.hasBudget),p(),w("ngIf",!(!(a.category==null||a.category.budget==null)&&a.category.budget.hasBudget)),p(4),w("ngIf",!a.home&&a.category.type==="expense"),p(5),w("ngIf",!a.category.isSubCategory&&!(a.category.subCategories!=null&&a.category.subCategories.length)),p(),w("ngIf",a.category.isSubCategory||a.category.parentCategoryId),p(5),w("matMenuTriggerFor",o),p(3),w("ngIf",!a.isMobile)}},dependencies:[ct,Ht,at,Po,So,Oo,Jn,yr,Wi],styles:["@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.category-item[_ngcontent-%COMP%]{width:100%;background:#fff;border-radius:12px;padding:1.25rem;border:1px solid #e5e7eb;cursor:pointer;transition:all .2s ease;border-left:4px solid transparent;min-height:12.6rem}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]{padding:.5rem;border-radius:10px;min-height:inherit}}.category-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a;border-color:#d1d5db}.category-item.expanded[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.category-item[_ngcontent-%COMP%]   .category-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem;position:relative}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-content[_ngcontent-%COMP%]{gap:.75rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]{flex:1;min-width:0;padding-right:3rem}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]{padding-right:1.5rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem;margin-bottom:.75rem}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]{gap:.5rem;margin-bottom:.5rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]{width:2rem;height:2rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem;color:#fff}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-icon-container[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem;flex:1;min-width:0}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-header[_ngcontent-%COMP%]{gap:.125rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-header[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:clamp(1rem,2.5vw,1.25rem);font-weight:600;color:#1f2937;margin:0;line-height:1.2;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-icon-name[_ngcontent-%COMP%]   .category-header[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:1rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:.5rem}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]{gap:.375rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.375rem;width:100%}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]{gap:.25rem}}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;flex-wrap:wrap}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .budget-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .budget-value[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#1f2937}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-amount[_ngcontent-%COMP%]   .budget-period[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:6px;background-color:#e5e7eb;border-radius:3px;overflow:hidden}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s ease;border-radius:3px}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .budget-info[_ngcontent-%COMP%]   .budget-progress[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;display:block;line-height:1.2}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .category-spent[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.25rem;flex-wrap:wrap;padding:.25rem 0}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .category-spent[_ngcontent-%COMP%]   .category-spent-label[_ngcontent-%COMP%]{font-size:.775rem;color:#6b7280;font-weight:500}.category-item[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-details[_ngcontent-%COMP%]   .category-spent[_ngcontent-%COMP%]   .category-spent-value[_ngcontent-%COMP%]{font-size:.775rem;font-weight:600;color:#6b7280;position:relative;left:.3rem}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-shrink:0;align-items:flex-start;position:absolute;right:0;top:0}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]{gap:.25rem}}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button[matIconButton][_ngcontent-%COMP%]{min-width:44px;min-height:44px}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button[matIconButton][_ngcontent-%COMP%]{min-width:40px;min-height:40px}}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button[matIconButton][_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.1)}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button[matIconButton][_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{min-width:44px;min-height:44px}@media (max-width: 640px){.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{min-width:40px;min-height:40px}}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.1)}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.budget-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#dbeafe}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.budget-button[_ngcontent-%COMP%]:hover:not(:disabled)   mat-icon[_ngcontent-%COMP%]{color:#2563eb}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.budget-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.edit-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#fef3c7}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.edit-button[_ngcontent-%COMP%]:hover:not(:disabled)   mat-icon[_ngcontent-%COMP%]{color:#d97706}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.edit-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.delete-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#fee2e2}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.delete-button[_ngcontent-%COMP%]:hover:not(:disabled)   mat-icon[_ngcontent-%COMP%]{color:#dc2626}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.delete-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.parent-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#e0e7ff}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.parent-button[_ngcontent-%COMP%]:hover:not(:disabled)   mat-icon[_ngcontent-%COMP%]{color:#6366f1}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.parent-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.remove-parent-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#fef3c7}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.remove-parent-button[_ngcontent-%COMP%]:hover:not(:disabled)   mat-icon[_ngcontent-%COMP%]{color:#f59e0b}.category-item[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   .action-button.remove-parent-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.expand-section[_ngcontent-%COMP%]{margin-top:1rem;text-align:center}.expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem;font-weight:500;transition:all .2s ease}.expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]:hover{color:#3b82f6;background:#eff6ff}.expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem;margin-right:.5rem}.category-details-expanded[_ngcontent-%COMP%]{margin-top:1.5rem;border-top:1px solid #e5e7eb;padding-top:1.5rem}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header{border-bottom:1px solid #e5e7eb}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-label{color:#6b7280;font-weight:500;min-width:120px}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-label.mat-mdc-tab-label-active{color:#3b82f6}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-header-pagination{display:none}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-ink-bar{background-color:#3b82f6}.category-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-body-wrapper .mat-mdc-tab-body .mat-mdc-tab-body-content{padding:1rem 0}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 0;border-bottom:1px solid #f3f4f6}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-size:.875rem;color:#1f2937;font-weight:600;display:flex;align-items:center;gap:.5rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.danger[_ngcontent-%COMP%]{color:#dc2626}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.warning[_ngcontent-%COMP%]{color:#f59e0b}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.safe[_ngcontent-%COMP%]{color:#10b981}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value.negative[_ngcontent-%COMP%]{color:#dc2626}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:1rem;height:1rem;border-radius:50%;border:1px solid #d1d5db}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-budget-details[_ngcontent-%COMP%]{text-align:center;padding:2rem 1rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-budget-details[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;color:#9ca3af;margin-bottom:1rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-budget-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#374151;margin:0 0 .5rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-budget-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin:0 0 1.5rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]{text-align:center;padding:2rem 1rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2.5rem;width:2.5rem;height:2.5rem;color:#9ca3af;margin-bottom:1rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .no-transactions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin:0}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 0;border-bottom:1px solid #f3f4f6}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .transaction-description[_ngcontent-%COMP%]{font-size:.875rem;color:#1f2937;font-weight:500}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .transaction-date[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount.positive[_ngcontent-%COMP%]{color:#10b981}.category-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .transaction-list[_ngcontent-%COMP%]   .transaction-item[_ngcontent-%COMP%]   .transaction-amount.negative[_ngcontent-%COMP%]{color:#dc2626}"]});let e=n;return e})();var Pg=(e,n)=>n.id,j3=e=>({"!max-h-[100vh]":e}),z3=()=>[];function W3(e,n){if(e&1){let i=be();c(0,"div",9)(1,"p",10),d(2),l(),c(3,"button",11),N("click",function(){G(i);let r=S();return H(r.clearError())}),c(4,"mat-icon"),d(5,"close"),l()()()}if(e&2){let i=S();p(2),z(i.errorMessage)}}function Y3(e,n){if(e&1){let i=be();c(0,"button",12),N("click",function(){G(i);let r=S();return H(r.openAddMobileDialog())}),c(1,"mat-icon"),d(2,"add"),l()()}}function $3(e,n){if(e&1){let i=be();c(0,"button",13),N("click",function(){G(i);let r=S();return H(r.openAddMobileDialog())}),c(1,"mat-icon"),d(2,"add"),l()()}}function G3(e,n){if(e&1&&(c(0,"div",14)(1,"div",15)(2,"h2",16),d(3,"Manage Categories"),l(),c(4,"p",17),d(5),l()()()),e&2){let i=S();p(5),jt("(",i.categories.length," categor",i.categories.length!==1?"ies":"y",")")}}function H3(e,n){if(e&1){let i=be();c(0,"button",23),N("click",function(){G(i);let r=S(2);return H(r.openAddMobileDialog())}),c(1,"mat-icon"),d(2,"add"),l(),d(3," Add Category "),l()}}function q3(e,n){if(e&1&&(c(0,"div",18)(1,"div",19)(2,"mat-icon"),d(3,"local_offer"),l()(),c(4,"h3",20),d(5,"No categories yet"),l(),c(6,"p",21),d(7,"Add your first category to get started"),l(),X(8,H3,4,0,"button",22),l()),e&2){let i=S();p(8),w("ngIf",i.breakpointService.device.isMobile)}}function X3(e,n){if(e&1){let i=be();c(0,"div",42)(1,"button",43),N("click",function(){G(i);let r=S(3);return H(r.toggleBudgetSummaryExpansion())}),c(2,"mat-icon"),d(3),l(),c(4,"span"),d(5),l()()()}if(e&2){let i=S(3);p(3),z(i.isBudgetSummaryExpanded?"expand_less":"expand_more"),p(2),z(i.isBudgetSummaryExpanded?"Show Less":"Show More")}}function K3(e,n){if(e&1&&(c(0,"div",48)(1,"span",49),d(2,"Highest Spending Category:"),l(),c(3,"span",50)(4,"mat-icon"),d(5),l(),d(6),pe(7,"currency"),l()()),e&2){let i=S(4);p(4),Xt("color",i.getDetailedBudgetStats().mostExpensiveCategory.color),p(),z(i.getDetailedBudgetStats().mostExpensiveCategory.icon),p(),jt(" ",i.getDetailedBudgetStats().mostExpensiveCategory.name," (",Ee(7,5,i.getDetailedBudgetStats().mostExpensiveCategory.spent),") ")}}function Z3(e,n){if(e&1&&(c(0,"div",48)(1,"span",49),d(2,"Lowest Spending Category:"),l(),c(3,"span",50)(4,"mat-icon"),d(5),l(),d(6),pe(7,"currency"),l()()),e&2){let i=S(4);p(4),Xt("color",i.getDetailedBudgetStats().leastExpensiveCategory.color),p(),z(i.getDetailedBudgetStats().leastExpensiveCategory.icon),p(),jt(" ",i.getDetailedBudgetStats().leastExpensiveCategory.name," (",Ee(7,5,i.getDetailedBudgetStats().leastExpensiveCategory.spent),") ")}}function J3(e,n){if(e&1&&(c(0,"div",54)(1,"div",55)(2,"mat-icon"),d(3),l(),c(4,"span",56),d(5),l()(),c(6,"div",57)(7,"div",58)(8,"span",59),d(9,"Budget:"),l(),c(10,"span",60),d(11),pe(12,"currency"),l()(),c(13,"div",58)(14,"span",59),d(15,"Spent:"),l(),c(16,"span",61),d(17),pe(18,"currency"),l()(),c(19,"div",58)(20,"span",59),d(21,"Remaining:"),l(),c(22,"span",60),d(23),pe(24,"currency"),l()(),c(25,"div",58)(26,"span",59),d(27,"Progress:"),l(),c(28,"span",60),d(29),l()()(),c(30,"div",62)(31,"div",37),se(32,"div",38),l()()()),e&2){let i=n.$implicit,t=S(4);p(2),Xt("color",i.color),p(),z(i.icon),p(2),z(i.name),p(6),z(Ee(12,16,i.budget)),p(6),z(Ee(18,18,i.spent)),p(5),Lt(i.remaining<0?"danger":"safe"),p(),oe(" ",Ee(24,20,i.remaining)," "),p(5),Lt(i.progress>=90?"danger":i.progress>=75?"warning":"safe"),p(),oe(" ",i.progress.toFixed(1),"% "),p(3),Xt("width",t.Math.min(i.progress,100),"%")("background-color",i.progress>=100?"#ef4444":i.progress>=80?"#f59e0b":i.progress>=60?"#3b82f6":"#10b981")}}function Q3(e,n){if(e&1&&(c(0,"div",44)(1,"mat-tab-group",45)(2,"mat-tab",46)(3,"div",47)(4,"div",48)(5,"span",49),d(6,"Total Categories with Budget:"),l(),c(7,"span",50),d(8),l()(),c(9,"div",48)(10,"span",49),d(11,"Average Budget per Category:"),l(),c(12,"span",50),d(13),pe(14,"currency"),l()(),c(15,"div",48)(16,"span",49),d(17,"Average Spent per Category:"),l(),c(18,"span",50),d(19),pe(20,"currency"),l()(),X(21,K3,8,7,"div",51)(22,Z3,8,7,"div",51),l()(),c(23,"mat-tab",52)(24,"div",47)(25,"div",53),Ge(26,J3,33,22,"div",54,Pg),l()()()()()),e&2){let i=S(3);p(8),z(i.getDetailedBudgetStats().totalCategories),p(5),z(Ee(14,5,i.getOverallBudgetStats().averageBudget)),p(6),z(Ee(20,7,i.getDetailedBudgetStats().averageSpentPerCategory)),p(2),w("ngIf",i.getDetailedBudgetStats().mostExpensiveCategory),p(),w("ngIf",i.getDetailedBudgetStats().leastExpensiveCategory),p(4),He(i.getDetailedBudgetStats().categories)}}function ek(e,n){if(e&1&&(c(0,"div",28)(1,"div",29)(2,"mat-icon",30),d(3,"account_balance_wallet"),l(),c(4,"h3",31),d(5,"Overall Monthly Budget"),l()(),c(6,"div",32)(7,"div",33)(8,"span",34),d(9,"Total Budget:"),l(),c(10,"span",35),d(11),pe(12,"currency"),l()()(),c(13,"div",36)(14,"div",37),se(15,"div",38),l(),c(16,"div",39),d(17),pe(18,"currency"),pe(19,"currency"),l()(),X(20,X3,6,2,"div",40)(21,Q3,28,9,"div",41),l()),e&2){let i=S(2);Je("expanded",i.isBudgetSummaryExpanded),p(11),z(Ee(12,12,i.getOverallBudgetStats().totalBudget)),p(4),Xt("width",i.Math.min(i.getOverallBudgetStats().overallProgress,100),"%")("background-color",i.getOverallBudgetProgressColor()),p(2),I0(" ",Ee(18,14,i.getOverallBudgetStats().totalSpent)," / ",Ee(19,16,i.getOverallBudgetStats().totalBudget)," (",i.getOverallBudgetStats().overallProgress.toFixed(1),"%) "),p(3),w("ngIf",!i.breakpointService.device.isMobile||i.home),p(),w("ngIf",i.isBudgetSummaryExpanded)}}function tk(e,n){e&1&&se(0,"hr",63)}function nk(e,n){e&1&&(c(0,"div",64)(1,"div",65)(2,"mat-icon",66),d(3,"info"),l(),c(4,"div",67)(5,"h4",68),d(6,"No Budgets Set"),l(),c(7,"p",69),d(8,"Set budgets for your expense categories to track your spending goals."),l()()()())}function ik(e,n){if(e&1&&se(0,"app-category-card",70),e&2){let i=S().$implicit,t=S(3);w("category",i)("isMobile",t.breakpointService.device.isMobile)("home",t.home)("recentTransactions",t.getRecentTransactions(i))("categoryStats",t.getCategoryStats(i))("allTransactions",t.transactions)("subCategories",t.getSubCategoriesForCategory(i.id))("Math",t.Math)}}function rk(e,n){if(e&1&&se(0,"app-category-card",74),e&2){let i=n.$implicit,t=S(5);w("category",i)("isMobile",t.breakpointService.device.isMobile)("home",t.home)("recentTransactions",t.getRecentTransactions(i))("categoryStats",t.getCategoryStats(i))("allTransactions",t.transactions)("subCategories",A0(9,z3))("subCategoryCount",0)("Math",t.Math)}}function ak(e,n){if(e&1&&(c(0,"div",71)(1,"div",72),d(2,"Sub-categories"),l(),c(3,"div",73),Ge(4,rk,1,10,"app-category-card",74,Pg),l()()),e&2){let i=S().$implicit,t=S(3);p(4),He(t.getSubCategoriesForCategory(i.id))}}function ok(e,n){if(e&1&&X(0,ik,1,8,"app-category-card",70)(1,ak,6,0,"div",71),e&2){let i=n.$implicit,t=S(3);ot(!i.isSubCategory&&!i.parentCategoryId?0:-1),p(),ot(t.getSubCategoriesForCategory(i.id).length>0&&t.breakpointService.device.isMobile?1:-1)}}function sk(e,n){if(e&1&&Ge(0,ok,2,2,null,null,Pg),e&2){let i=S(2);He(i.categories)}}function ck(e,n){if(e&1&&(c(0,"div",24),X(1,ek,22,18,"div",25)(2,tk,1,0,"hr",26)(3,nk,9,0,"div",27)(4,sk,2,0),l()),e&2){let i=S();w("ngClass",dl(5,j3,i.breakpointService.device.isTablePortrait)),p(),w("ngIf",i.getOverallBudgetStats().categoriesWithBudget>0),p(),w("ngIf",!i.home&&i.breakpointService.device.isMobile),p(),w("ngIf",!i.home&&i.getOverallBudgetStats().categoriesWithBudget===0),p(),ot(i.home?-1:4)}}var Ec=(()=>{let n=class n{constructor(t,r,a,o,s,u,m,f,h){this.auth=t,this.dialog=r,this.notificationService=a,this.hapticFeedback=o,this.breakpointObserver=s,this.store=u,this.budgetService=m,this.dateService=f,this.breakpointService=h,this.home=!1,this.Math=Math,this.transactions=[],this.isLoading=!1,this.errorMessage="",this.isBudgetSummaryExpanded=!1,this.userId="",this.destroy$=new vn,this.isLoading$=this.store.select(Id),this.transactions$=this.store.select(An)}ngOnInit(){this.initializeComponent(),this.subscribeToStoreData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeComponent(){return ue(this,null,function*(){let t=yield this.auth.currentUser;if(!t){this.errorMessage="User not authenticated";return}this.userId=t.uid,this.loadUserCategories(),this.loadUserTransactions()})}loadUserCategories(){this.store.dispatch(mr({userId:this.userId}))}loadUserTransactions(){this.store.dispatch(ri({userId:this.userId}))}subscribeToStoreData(){this.store.select(Ri).subscribe(t=>{this.categories=t.sort((r,a)=>{var u,m,f,h,_,y,v,C,P,D,T,I;let o=(m=(u=r.budget)==null?void 0:u.hasBudget)!=null?m:!1,s=(h=(f=a.budget)==null?void 0:f.hasBudget)!=null?h:!1;if(o!==s)return o?-1:1;if(this.breakpointService.device.isDesktop){let K=((y=(_=r.subCategories)==null?void 0:_.length)!=null?y:0)>0,ee=((C=(v=a.subCategories)==null?void 0:v.length)!=null?C:0)>0;if(K!==ee)return K?1:-1}else{let K=((D=(P=r.subCategories)==null?void 0:P.length)!=null?D:0)>0,ee=((I=(T=a.subCategories)==null?void 0:T.length)!=null?I:0)>0;if(K!==ee)return K?-1:1}return r.name.localeCompare(a.name)})}),this.transactions$.pipe(Qt(this.destroy$)).subscribe(t=>{this.transactions=t}),this.isLoading$.pipe(Qt(this.destroy$)).subscribe(t=>{this.isLoading=t})}trackByCategoryId(t,r){return r.id||t}clearError(){this.errorMessage=""}openMobileDialog(t){this.dialog.open(ss,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog",data:t||null}).afterClosed().pipe(Qt(this.destroy$)).subscribe(a=>{a&&this.loadUserCategories()})}openAddMobileDialog(){this.breakpointService.device.isMobile&&this.hapticFeedback.lightVibration(),this.openMobileDialog()}getSubCategoriesForCategory(t){return this.categories.filter(r=>r.isSubCategory&&r.parentCategoryId===t)}getBudgetProgressColor(t,r,a){var u;let o=r!=null?r:this.calculateBudgetProgressPercentage(t),s=a!=null?a:((u=t.budget)==null?void 0:u.budgetAlertThreshold)||80;return this.budgetService.getBudgetProgressColor(t,o,s)}formatBudgetPeriod(t){return this.budgetService.formatBudgetPeriod(t)}toggleBudgetSummaryExpansion(){this.isBudgetSummaryExpanded=!this.isBudgetSummaryExpanded}getRecentTransactions(t){return!t||!t.name?[]:this.transactions.filter(r=>r.categoryId===t.id&&(0,Sg.default)(this.dateService.toDate(r.date)).isSame((0,Sg.default)(),"month"))}getCategoryStats(t){if(!t||!t.name)return{totalTransactions:0,totalSpent:0,averageTransaction:0,largestTransaction:0,thisMonth:0,lastMonth:0};let r=this.transactions.filter(T=>T.categoryId===t.id);if(r.length===0)return{totalTransactions:0,totalSpent:0,averageTransaction:0,largestTransaction:0,thisMonth:0,lastMonth:0};let a=r.length,o=r.reduce((T,I)=>T+Math.abs(I.amount),0),s=o/a,u=Math.max(...r.map(T=>Math.abs(T.amount))),m=new Date,f=m.getMonth(),h=m.getFullYear(),_=f===0?11:f-1,y=f===0?h-1:h,v=r.filter(T=>{let I=this.dateService.toDate(T.date)||new Date;return I.getMonth()===f&&I.getFullYear()===h}),C=r.filter(T=>{let I=this.dateService.toDate(T.date)||new Date;return I.getMonth()===_&&I.getFullYear()===y}),P=v.reduce((T,I)=>T+Math.abs(I.amount),0),D=C.reduce((T,I)=>T+Math.abs(I.amount),0);return{totalTransactions:a,totalSpent:o,averageTransaction:s,largestTransaction:u,thisMonth:P,lastMonth:D}}getBudgetStatusClass(t,r){var o;if(!((o=t.budget)!=null&&o.hasBudget))return"";let a=r!=null?r:this.calculateBudgetProgressPercentage(t);return a>=90?"danger":a>=75?"warning":"safe"}getRemainingBudgetClass(t,r){var s,u,m;if(!((s=t.budget)!=null&&s.hasBudget))return"";let a=r!=null?r:this.calculateBudgetSpent(t),o=(((u=t.budget)==null?void 0:u.budgetAmount)||0)-a;return o<=0?"danger":o<(((m=t.budget)==null?void 0:m.budgetAmount)||0)*.1?"warning":"safe"}calculateTotalSpentPerMonth(t){return this.transactions.filter(o=>o.categoryId===t.id).reduce((o,s)=>o+Math.abs(s.amount),0)}calculateTotalIncomePerMonth(t){return this.transactions.filter(o=>o.categoryId===t.id).reduce((o,s)=>o+s.amount,0)}calculateBudgetSpent(t){var u,m;if(!((u=t.budget)!=null&&u.hasBudget)||!((m=t.budget)!=null&&m.budgetAmount))return 0;let r=this.transactions.filter(f=>f.categoryId===t.id&&f.type===en.EXPENSE),a=t.budget.budgetStartDate,o=t.budget.budgetEndDate,s=r;if(a){let f=this.dateService.toDate(a);if(!f)return 0;s=s.filter(h=>{let _=this.dateService.toDate(h.date);return _&&_>=f})}if(o){let f=this.dateService.toDate(o);if(!f)return 0;s=s.filter(h=>{let _=this.dateService.toDate(h.date);return _&&_<=f})}return s.reduce((f,h)=>f+Math.abs(h.amount),0)}calculateBudgetRemaining(t){var a,o;if(!((a=t.budget)!=null&&a.hasBudget)||!((o=t.budget)!=null&&o.budgetAmount))return 0;let r=this.calculateBudgetSpent(t);return Math.max(0,(t.budget.budgetAmount||0)-r)}calculateBudgetProgressPercentage(t){var o,s;if(!((o=t.budget)!=null&&o.hasBudget)||!((s=t.budget)!=null&&s.budgetAmount))return 0;let r=this.calculateBudgetSpent(t),a=t.budget.budgetAmount||0;return a===0?0:Math.min(100,r/a*100)}getOverallBudgetStats(){let t=this.categories.filter(m=>{var f;return((f=m.budget)==null?void 0:f.hasBudget)&&m.type===en.EXPENSE});if(t.length===0)return{totalBudget:0,totalSpent:0,totalRemaining:0,overallProgress:0,categoriesWithBudget:0,averageBudget:0};let r=t.reduce((m,f)=>{var h;return m+(((h=f.budget)==null?void 0:h.budgetAmount)||0)},0),a=t.reduce((m,f)=>m+this.calculateBudgetSpent(f),0),o=r-a,s=r>0?a/r*100:0,u=r/t.length;return{totalBudget:r,totalSpent:a,totalRemaining:o,overallProgress:s,categoriesWithBudget:t.length,averageBudget:u}}getOverallBudgetStatusClass(){let t=this.getOverallBudgetStats();return t.overallProgress>=90?"danger":t.overallProgress>=75?"warning":"safe"}getOverallBudgetProgressColor(){let t=this.getOverallBudgetStats();return t.overallProgress>=100?"#ef4444":t.overallProgress>=80?"#f59e0b":t.overallProgress>=60?"#3b82f6":"#10b981"}getDetailedBudgetStats(){let t=this.categories.filter(m=>{var f;return((f=m.budget)==null?void 0:f.hasBudget)&&m.type===en.EXPENSE});if(t.length===0)return{categories:[],totalCategories:0,averageSpentPerCategory:0,mostExpensiveCategory:null,leastExpensiveCategory:null};let r=t.map(m=>{var f;return{name:m.name,budget:((f=m.budget)==null?void 0:f.budgetAmount)||0,spent:this.calculateBudgetSpent(m),remaining:this.calculateBudgetRemaining(m),progress:this.calculateBudgetProgressPercentage(m),color:m.color,icon:m.icon}}),o=r.reduce((m,f)=>m+f.spent,0)/r.length,s=r.reduce((m,f)=>f.spent>m.spent?f:m,r[0]),u=r.reduce((m,f)=>f.spent<m.spent?f:m,r[0]);return{categories:r.sort((m,f)=>f.spent-m.spent),totalCategories:r.length,averageSpentPerCategory:o,mostExpensiveCategory:s,leastExpensiveCategory:u}}};n.\u0275fac=function(r){return new(r||n)(q(pt),q(fn),q(ht),q(Sr),q(Zi),q(wt),q(kc),q(At),q(Qi))},n.\u0275cmp=Ve({type:n,selectors:[["user-category"]],inputs:{home:"home"},decls:9,vars:6,consts:[[1,"categories-container"],["class","error-message mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center justify-between",4,"ngIf"],["mat-fab","","color","primary","class","mobile-fab-btn add-category-btn",3,"click",4,"ngIf"],["mat-fab","","color","primary","class","desktop-fab-btn",3,"click",4,"ngIf"],[1,"categories-grid"],[1,"categories-list"],["class","section-header",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","categories-grid-list",3,"ngClass",4,"ngIf"],[1,"error-message","mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg","flex","items-center","justify-between"],[1,"text-red-700","text-sm"],["mat-icon-button","",1,"error-close-button",3,"click"],["mat-fab","","color","primary",1,"mobile-fab-btn","add-category-btn",3,"click"],["mat-fab","","color","primary",1,"desktop-fab-btn",3,"click"],[1,"section-header"],[1,"header-content"],[1,"section-title"],[1,"section-subtitle"],[1,"empty-state"],[1,"empty-icon"],[1,"empty-title"],[1,"empty-text"],["mat-raised-button","","color","primary","class","empty-state-button",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"empty-state-button",3,"click"],[1,"categories-grid-list",3,"ngClass"],["class","budget-summary-card lg:col-span-2",3,"expanded",4,"ngIf"],["class","my-1",4,"ngIf"],["class","no-budget-card",4,"ngIf"],[1,"budget-summary-card","lg:col-span-2"],[1,"budget-summary-header"],[1,"budget-icon"],[1,"budget-summary-title"],[1,"budget-summary-stats"],[1,"budget-stat-item"],[1,"budget-stat-label"],[1,"budget-stat-value"],[1,"overall-budget-progress"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],["class","expand-section",4,"ngIf"],["class","budget-details-expanded",4,"ngIf"],[1,"expand-section"],["mat-button","",1,"expand-btn",3,"click"],[1,"budget-details-expanded"],[1,"details-tabs"],["label","Summary"],[1,"tab-content"],[1,"detail-row"],[1,"detail-label"],[1,"detail-value"],["class","detail-row",4,"ngIf"],["label","Category Breakdown"],[1,"category-breakdown-list"],[1,"category-breakdown-item"],[1,"category-breakdown-header"],[1,"category-name"],[1,"category-breakdown-stats"],[1,"breakdown-stat"],[1,"breakdown-label"],[1,"breakdown-value"],[1,"breakdown-value","spent"],[1,"category-breakdown-progress"],[1,"my-1"],[1,"no-budget-card"],[1,"no-budget-content"],[1,"no-budget-icon"],[1,"no-budget-text-content"],[1,"no-budget-title"],[1,"no-budget-text"],[3,"category","isMobile","home","recentTransactions","categoryStats","allTransactions","subCategories","Math"],[1,"sub-category-wrapper"],[1,"group-header"],[1,"sub-categories-container"],[3,"category","isMobile","home","recentTransactions","categoryStats","allTransactions","subCategories","subCategoryCount","Math"]],template:function(r,a){r&1&&(c(0,"div",0),X(1,W3,6,1,"div",1)(2,Y3,3,0,"button",2)(3,$3,3,0,"button",3),c(4,"div",4)(5,"section",5),X(6,G3,6,2,"div",6)(7,q3,9,1,"div",7)(8,ck,5,7,"div",8),l()()()),r&2&&(p(),w("ngIf",a.errorMessage),p(),w("ngIf",(a.breakpointService.device.isMobile||a.breakpointService.device.isTablePortrait)&&!a.home),p(),w("ngIf",!a.breakpointService.device.isMobile),p(3),w("ngIf",!a.home),p(),w("ngIf",a.categories&&a.categories.length===0&&!a.home),p(),w("ngIf",a.categories.length>0))},dependencies:[br,ct,Ht,bn,Ma,at,ko,Eo,Eu,Wi],styles:['@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideDown{0%{transform:translateY(-100%);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:-200% 0}to{background-position:200% 0}}.categories-container[_ngcontent-%COMP%]{background:inherit;overflow:auto;position:relative}@media (max-width: 640px){.categories-container[_ngcontent-%COMP%]{padding:.5rem}}.error-message[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease}.error-message[_ngcontent-%COMP%]   .error-close-button[_ngcontent-%COMP%]{color:#dc2626;min-width:44px;min-height:44px}.loading-indicator[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background:linear-gradient(90deg,#f8fafc,#e2e8f0,#f8fafc);border-bottom:1px solid #e2e8f0;box-shadow:0 2px 4px #0000000d;animation:_ngcontent-%COMP%_slideDown .3s ease-out}.loading-indicator[_ngcontent-%COMP%]   mat-progress-bar[_ngcontent-%COMP%]{height:3px}.loading-indicator[_ngcontent-%COMP%]   mat-progress-bar[_ngcontent-%COMP%]     .mat-progress-bar-fill:after{background:linear-gradient(90deg,#3b82f6,#1d4ed8,#3b82f6);animation:_ngcontent-%COMP%_shimmer 2s ease-in-out infinite}.loading-indicator[_ngcontent-%COMP%]   mat-progress-bar[_ngcontent-%COMP%]     .mat-progress-bar-buffer{background:#3b82f61a}.categories-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;max-width:1200px;margin:0 auto;transition:opacity .3s ease}.categories-grid.loading[_ngcontent-%COMP%]{opacity:.7;pointer-events:none}@media (min-width: 768px){.categories-grid[_ngcontent-%COMP%]{gap:3rem}}@media (max-width: 640px){.categories-grid[_ngcontent-%COMP%]{gap:1.5rem}}.categories-list[_ngcontent-%COMP%]{width:100%}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{margin-bottom:1.5rem;position:relative}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;flex:1}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:clamp(1.25rem,3vw,2rem);font-weight:600;color:#1f2937;margin:0 0 .25rem;height:35px}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{color:#6b7280;font-size:clamp(.75rem,2vw,1rem);margin:0}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .mobile-add-button[_ngcontent-%COMP%]{flex-shrink:0;margin-left:1rem;box-shadow:0 4px 12px #00000026;transition:all .2s ease;min-width:56px;min-height:56px}.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .mobile-add-button[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 6px 16px #0003}@media (max-width: 640px){.categories-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .mobile-add-button[_ngcontent-%COMP%]{min-width:48px;min-height:48px}}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem;background:#fff;border-radius:12px;border:2px dashed #d1d5db}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{margin-bottom:1rem}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:clamp(2.5rem,6vw,4rem);width:clamp(2.5rem,6vw,4rem);height:clamp(2.5rem,6vw,4rem);color:#9ca3af}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-title[_ngcontent-%COMP%]{font-size:clamp(1rem,2.5vw,1.5rem);font-weight:500;color:#374151;margin:0 0 .5rem}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-text[_ngcontent-%COMP%]{color:#6b7280;font-size:clamp(.75rem,2vw,1rem);margin:0 0 1.5rem}.categories-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-state-button[_ngcontent-%COMP%]{min-height:44px;padding:.75rem 1.5rem;display:inline-flex;align-items:center;gap:.5rem}.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem;max-height:calc(92vh - 250px);overflow-y:auto;scrollbar-width:thin;scrollbar-color:#cbd5e1 #f1f5f9}@media (min-width: 768px){.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:1.5rem}}@media (min-width: 1200px){.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:1rem;align-items:stretch}}@media (max-width: 640px){.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]{max-height:100vh;gap:.75rem;padding-bottom:2rem}}.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.categories-list[_ngcontent-%COMP%]   .categories-grid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.categories-list[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]{width:100%}.sub-category-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;margin-top:1.5rem;margin-bottom:.5rem;background:#f8fafc;border:2.8px dashed #d4d5d7;border-radius:12px;padding:1rem;box-shadow:0 1px 3px #0000000d}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]{border-radius:10px;margin-top:0;margin-bottom:1rem0}}.sub-category-wrapper[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]{position:absolute;top:-.75rem;left:1rem;background:#f8fafc;padding:0 .5rem;font-size:.75rem;font-weight:600;color:#6b7280;border:1px solid #e2e8f0;border-radius:6px;z-index:1}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]{font-size:.7rem;padding:0 .375rem;top:-.625rem;left:.75rem}}.sub-category-wrapper[_ngcontent-%COMP%]:before{content:"";position:absolute;left:2rem;top:-1.5rem;width:2px;height:1rem;z-index:0}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]:before{left:1.5rem;top:-.95rem;width:1.5px;height:3.75rem;background:linear-gradient(to bottom,#3b82f6,#d1d5db)}}.sub-category-wrapper[_ngcontent-%COMP%]:after{content:"";position:absolute;left:2rem;top:-.5rem;width:1rem;height:2px;background:#3b82f6;z-index:0}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]:after{left:1.5rem;width:.75rem;height:1.5px}}.sub-category-wrapper[_ngcontent-%COMP%]   .sub-categories-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;margin-top:.5rem;position:relative}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]   .sub-categories-container[_ngcontent-%COMP%]{gap:.5rem}}.sub-category-wrapper[_ngcontent-%COMP%]   .sub-categories-container[_ngcontent-%COMP%]:before{content:"";position:absolute;left:1.5rem;top:0;bottom:0;width:2px;background:linear-gradient(to bottom,#d1d5db,#e5e7eb);z-index:0}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]   .sub-categories-container[_ngcontent-%COMP%]:before{left:1rem;width:1.5px}}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]{width:100%;transform:scale(.98);opacity:.95;transition:all .3s ease;position:relative}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:hover{transform:scale(1);opacity:1;z-index:10;border-left-color:#3b82f6}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(1){transform:scale(1);opacity:1;z-index:3}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(2){transform:scale(.99);opacity:.98;z-index:2}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(3){transform:scale(.98);opacity:.95;z-index:1}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(n+4){transform:scale(.97);opacity:.9}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:before{content:"";position:absolute;left:-.75rem;top:50%;width:8px;height:8px;background:#3b82f6;border:2px solid #f8fafc;border-radius:50%;transform:translateY(-50%);z-index:1;box-shadow:0 1px 3px #0000001a}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:before{left:-.5rem;width:6px;height:6px;border-width:1.5px}}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:after{content:"";position:absolute;left:-.5rem;top:50%;width:.5rem;height:2px;background:#3b82f6;transform:translateY(-50%);z-index:0}@media (max-width: 640px){.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:after{left:-.375rem;width:.375rem;height:1.5px}.sub-category-wrapper[_ngcontent-%COMP%]{gap:.25rem}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]{transform:scale(.99)}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:hover{transform:scale(1)}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(1){transform:scale(1)}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(2){transform:scale(.995)}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(3){transform:scale(.99)}.sub-category-wrapper[_ngcontent-%COMP%]   app-category-card[_ngcontent-%COMP%]:nth-child(n+4){transform:scale(.985)}}.budget-summary-card[_ngcontent-%COMP%]{width:100%;background:#dbfbff4a;border-radius:12px;padding:1.25rem;border:1px solid #e5e7eb;transition:all .2s ease;border-left:4px solid #4d98a4;position:relative;overflow:hidden}@media (max-width: 640px){.budget-summary-card[_ngcontent-%COMP%]{padding:.5rem;border-radius:10px}}.budget-summary-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a;border-color:#d1d5db}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin:.65rem 0 .5rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-header[_ngcontent-%COMP%]   .budget-icon[_ngcontent-%COMP%]{color:#fff;font-size:1.5rem;width:1.5rem;height:1.5rem;--tw-bg-opacity: 1;background-color:rgb(70 119 127 / var(--tw-bg-opacity));border-radius:8px;padding:.5rem;display:flex;align-items:center;justify-content:center;flex-shrink:0}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-header[_ngcontent-%COMP%]   .budget-summary-title[_ngcontent-%COMP%]{font-size:clamp(1rem,2.5vw,1.25rem);font-weight:600;color:#1f2937;margin:0;line-height:1.2}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:1rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:.5rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-value[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#6b7280}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-value.spent[_ngcontent-%COMP%], .budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-value.danger[_ngcontent-%COMP%]{color:#dc2626}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-value.warning[_ngcontent-%COMP%]{color:#f59e0b}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-stats[_ngcontent-%COMP%]   .budget-stat-item[_ngcontent-%COMP%]   .budget-stat-value.safe[_ngcontent-%COMP%]{color:#10b981}.budget-summary-card[_ngcontent-%COMP%]   .overall-budget-progress[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem;margin-bottom:1rem}.budget-summary-card[_ngcontent-%COMP%]   .overall-budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:6px;background-color:#e5e7eb;border-radius:3px;overflow:hidden}.budget-summary-card[_ngcontent-%COMP%]   .overall-budget-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s ease;border-radius:3px}.budget-summary-card[_ngcontent-%COMP%]   .overall-budget-progress[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;display:block;line-height:1.2}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:.75rem;border-top:1px solid #e5e7eb}.budget-summary-card[_ngcontent-%COMP%]   .budget-summary-footer[_ngcontent-%COMP%]   .budget-categories-count[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.budget-summary-card[_ngcontent-%COMP%]   .expand-section[_ngcontent-%COMP%]{display:flex;justify-content:center;border-top:1px solid #e5e7eb}.budget-summary-card[_ngcontent-%COMP%]   .expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem;display:flex;align-items:center;gap:.5rem;transition:color .2s ease}.budget-summary-card[_ngcontent-%COMP%]   .expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]:hover{color:#3b82f6}.budget-summary-card[_ngcontent-%COMP%]   .expand-section[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]{margin-top:1rem;padding-top:1rem;border-top:1px solid #e5e7eb}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header{border-bottom:1px solid #e5e7eb;margin-bottom:1rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header .mat-tab-label{color:#6b7280;font-weight:500;min-width:120px}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header .mat-tab-label.mat-tab-label-active{color:#3b82f6}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .details-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header .mat-ink-bar{background-color:#3b82f6}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding:.5rem 0}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.5rem 0;border-bottom:1px solid #f3f4f6}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-size:.875rem;color:#1f2937;font-weight:600;display:flex;align-items:center;gap:.5rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;padding:1rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:.75rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-header[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#1f2937}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:.5rem;margin-bottom:.75rem}@media (max-width: 480px){.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]{grid-template-columns:1fr}}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-weight:500}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-value[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#1f2937}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-value.spent[_ngcontent-%COMP%], .budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-value.danger[_ngcontent-%COMP%]{color:#dc2626}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-value.warning[_ngcontent-%COMP%]{color:#f59e0b}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-stats[_ngcontent-%COMP%]   .breakdown-stat[_ngcontent-%COMP%]   .breakdown-value.safe[_ngcontent-%COMP%]{color:#10b981}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:6px;background-color:#e5e7eb;border-radius:3px;overflow:hidden}.budget-summary-card[_ngcontent-%COMP%]   .budget-details-expanded[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .category-breakdown-list[_ngcontent-%COMP%]   .category-breakdown-item[_ngcontent-%COMP%]   .category-breakdown-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s ease;border-radius:3px}.no-budget-card[_ngcontent-%COMP%]{width:100%;background:#fff;border-radius:12px;padding:1.25rem;border:1px solid #e5e7eb;transition:all .2s ease;border-left:4px solid #f59e0b;margin-bottom:1rem}@media (max-width: 640px){.no-budget-card[_ngcontent-%COMP%]{padding:.5rem;border-radius:10px}}.no-budget-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a;border-color:#d1d5db}.no-budget-card[_ngcontent-%COMP%]   .no-budget-content[_ngcontent-%COMP%]{display:flex;align-items:center;align-items:flex-start;gap:.75rem}.no-budget-card[_ngcontent-%COMP%]   .no-budget-content[_ngcontent-%COMP%]   .no-budget-icon[_ngcontent-%COMP%]{color:#fff;font-size:1.5rem;width:1.5rem;height:1.5rem;background:#f59e0b;border-radius:12px;padding:.5rem;display:flex;align-items:center;justify-content:center;flex-shrink:0}.no-budget-card[_ngcontent-%COMP%]   .no-budget-content[_ngcontent-%COMP%]   .no-budget-text-content[_ngcontent-%COMP%]{flex:1}.no-budget-card[_ngcontent-%COMP%]   .no-budget-content[_ngcontent-%COMP%]   .no-budget-text-content[_ngcontent-%COMP%]   .no-budget-title[_ngcontent-%COMP%]{font-size:clamp(.8rem,2.5vw,1.25rem);font-weight:600;color:#1f2937;margin:0 0 .25rem;line-height:1.2}.no-budget-card[_ngcontent-%COMP%]   .no-budget-content[_ngcontent-%COMP%]   .no-budget-text-content[_ngcontent-%COMP%]   .no-budget-text[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;margin:0;line-height:1.2}.add-category-btn[_ngcontent-%COMP%]{position:fixed!important;bottom:8rem;right:1rem;z-index:100;box-shadow:0 4px 12px #00000026;transition:all .2s ease}.add-category-btn[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 6px 16px #0003}  .mat-autocomplete-panel{border-radius:8px;box-shadow:0 4px 12px #00000026;border:1px solid #e5e7eb;max-height:200px}  .mat-autocomplete-panel .mat-option{padding:.75rem 1rem;font-size:.875rem;color:#374151;transition:all .2s ease}  .mat-autocomplete-panel .mat-option:hover{background:#f3f4f6}  .mat-autocomplete-panel .mat-option.mat-selected{background:#dbeafe;color:#1d4ed8}']});let e=n;return e})();var cn=Tr(Nr());var Ja=Tr(Nr());var Ia=(()=>{let n=class n{constructor(){this.selectedDateSubject=new mn(null),this.selectedDateRangeSubject=new mn(null),this.categoryFilterSubject=new mn(null),this.searchTermSubject=new mn(""),this.selectedCategorySubject=new mn(["all"]),this.selectedTypeSubject=new mn("all"),this.accountFilterSubject=new mn([]),this.amountRangeSubject=new mn({min:null,max:null}),this.statusFilterSubject=new mn([]),this.tagsSubject=new mn([]),this.filterStateSubject=new mn(this.getDefaultFilterState()),this.filterHistorySubject=new mn([]),this.filterPresetsSubject=new mn([]),this.activePresetSubject=new mn(null),this.selectedDate$=this.selectedDateSubject.asObservable(),this.selectedDateRange$=this.selectedDateRangeSubject.asObservable(),this.categoryFilter$=this.categoryFilterSubject.asObservable(),this.searchTerm$=this.searchTermSubject.asObservable(),this.selectedCategory$=this.selectedCategorySubject.asObservable(),this.selectedType$=this.selectedTypeSubject.asObservable(),this.accountFilter$=this.accountFilterSubject.asObservable(),this.amountRange$=this.amountRangeSubject.asObservable(),this.statusFilter$=this.statusFilterSubject.asObservable(),this.tags$=this.tagsSubject.asObservable(),this.filterState$=this.filterStateSubject.asObservable(),this.filterHistory$=this.filterHistorySubject.asObservable(),this.filterPresets$=this.filterPresetsSubject.asObservable(),this.activePreset$=this.activePresetSubject.asObservable(),this.hasActiveFilters$=this.filterState$.pipe(rt(t=>this.hasActiveFilters(t)),js()),this.activeFiltersCount$=this.filterState$.pipe(rt(t=>this.getActiveFiltersCount(t)),js()),this.initializePresets(),this.setupFilterStateUpdates()}setSelectedDate(t){this.selectedDateSubject.next(t),this.selectedDateRangeSubject.next(null)}getSelectedDate(){return this.selectedDateSubject.value}setSelectedDateRange(t,r){if(!t||!r){console.warn("Invalid date range provided");return}this.selectedDateRangeSubject.next({startDate:t,endDate:r}),this.selectedDateSubject.next(null)}getSelectedDateRange(){return this.selectedDateRangeSubject.value}setCategoryFilter(t,r,a,o){if(!t||r===void 0||a===void 0||!o){console.warn("Invalid category filter parameters provided");return}let s={categoryId:t,year:r,month:a,monthName:o};this.categoryFilterSubject.next(s)}getCategoryFilter(){return this.categoryFilterSubject.value}setSearchTerm(t){this.searchTermSubject.next(t||"")}getSearchTerm(){return this.searchTermSubject.value}setSelectedCategory(t){if(!Array.isArray(t)||t.length===0){console.warn("Invalid categories array provided");return}this.selectedCategorySubject.next(t)}getSelectedCategory(){return this.selectedCategorySubject.value}setSelectedType(t){this.selectedTypeSubject.next(t||"all")}getSelectedType(){return this.selectedTypeSubject.value}setAccountFilter(t){if(!Array.isArray(t)){console.warn("Invalid accounts array provided");return}this.accountFilterSubject.next(t)}getAccountFilter(){return this.accountFilterSubject.value}setAmountRange(t,r){this.amountRangeSubject.next({min:t,max:r})}getAmountRange(){return this.amountRangeSubject.value}setStatusFilter(t){if(!Array.isArray(t)){console.warn("Invalid statuses array provided");return}this.statusFilterSubject.next(t)}getStatusFilter(){return this.statusFilterSubject.value}setTags(t){if(!Array.isArray(t)){console.warn("Invalid tags array provided");return}this.tagsSubject.next(t)}getTags(){return this.tagsSubject.value}clearSelectedDate(){this.selectedDateSubject.next(null),this.selectedDateRangeSubject.next(null)}clearCategoryFilter(){this.categoryFilterSubject.next(null)}clearSearchTerm(){this.searchTermSubject.next("")}clearSelectedCategory(){this.selectedCategorySubject.next(["all"])}clearSelectedType(){this.selectedTypeSubject.next("all")}clearAccountFilter(){this.accountFilterSubject.next([])}clearAmountRange(){this.amountRangeSubject.next({min:null,max:null})}clearStatusFilter(){this.statusFilterSubject.next([])}clearTags(){this.tagsSubject.next([])}clearAllFilters(){this.clearSelectedDate(),this.clearCategoryFilter(),this.clearSearchTerm(),this.clearSelectedCategory(),this.clearSelectedType(),this.clearAccountFilter(),this.clearAmountRange(),this.clearStatusFilter(),this.clearTags(),this.activePresetSubject.next(null)}setupFilterStateUpdates(){Th([this.selectedDate$,this.selectedDateRange$,this.categoryFilter$,this.searchTerm$,this.selectedCategory$,this.selectedType$,this.accountFilter$,this.amountRange$,this.statusFilter$,this.tags$]).subscribe(([t,r,a,o,s,u,m,f,h,_])=>{let y={searchTerm:o,selectedCategory:s,selectedType:u,selectedDate:t,selectedDateRange:r,categoryFilter:a,accountFilter:m,amountRange:f,statusFilter:h,tags:_};this.filterStateSubject.next(y),this.addToHistory(y)})}saveAsPreset(t,r){if(!t||!r){console.warn("Preset name and description are required");return}let a=this.getCurrentFilterState(),o={id:this.generatePresetId(),name:t,description:r,filter:a},s=[...this.filterPresetsSubject.value,o];this.filterPresetsSubject.next(s),this.savePresetsToStorage(s)}applyPreset(t){let a=this.filterPresetsSubject.value.find(o=>o.id===t);a?(this.applyFilterState(a.filter),this.activePresetSubject.next(t)):console.warn(`Preset with id ${t} not found`)}deletePreset(t){let r=this.filterPresetsSubject.value.filter(a=>a.id!==t);this.filterPresetsSubject.next(r),this.savePresetsToStorage(r)}addToHistory(t){let r={timestamp:new Date,filter:t,description:this.generateFilterDescription(t)},a=this.filterHistorySubject.value,o=[r,...a.slice(0,9)];this.filterHistorySubject.next(o)}getFilterHistory(){return this.filterHistorySubject.value}clearFilterHistory(){this.filterHistorySubject.next([])}getCurrentFilterState(){return this.filterStateSubject.value}hasActiveFilters(t){let r=t||this.getCurrentFilterState();return!!(r.searchTerm||!r.selectedCategory.includes("all")||r.selectedType!=="all"||r.selectedDate||r.selectedDateRange||r.categoryFilter||r.accountFilter.length>0||r.amountRange.min!==null||r.amountRange.max!==null||r.statusFilter.length>0||r.tags.length>0)}getActiveFiltersCount(t){let r=t||this.getCurrentFilterState(),a=0;return r.searchTerm&&a++,r.selectedCategory.includes("all")||a++,r.selectedType!=="all"&&a++,r.selectedDate&&a++,r.selectedDateRange&&a++,r.categoryFilter&&a++,r.accountFilter.length>0&&a++,(r.amountRange.min!==null||r.amountRange.max!==null)&&a++,r.statusFilter.length>0&&a++,r.tags.length>0&&a++,a}applyFilterState(t){t.searchTerm!==void 0&&this.setSearchTerm(t.searchTerm),t.selectedCategory!==void 0&&this.setSelectedCategory(t.selectedCategory),t.selectedType!==void 0&&this.setSelectedType(t.selectedType),t.selectedDate!==void 0&&this.setSelectedDate(t.selectedDate),t.selectedDateRange!==void 0&&t.selectedDateRange&&this.setSelectedDateRange(t.selectedDateRange.startDate,t.selectedDateRange.endDate),t.categoryFilter!==void 0&&this.categoryFilterSubject.next(t.categoryFilter),t.accountFilter!==void 0&&this.setAccountFilter(t.accountFilter),t.amountRange!==void 0&&this.setAmountRange(t.amountRange.min,t.amountRange.max),t.statusFilter!==void 0&&this.setStatusFilter(t.statusFilter),t.tags!==void 0&&this.setTags(t.tags)}resetToDefaults(){this.applyFilterState(this.getDefaultFilterState())}getDefaultFilterState(){return{searchTerm:"",selectedCategory:["all"],selectedType:"all",selectedDate:null,selectedDateRange:null,categoryFilter:null,accountFilter:[],amountRange:{min:null,max:null},statusFilter:[],tags:[]}}getDefaultPresets(){return[{id:"default-all",name:"All Transactions",description:"Show all transactions without filters",filter:this.getDefaultFilterState(),isDefault:!0},{id:"default-current-month",name:"Current Month",description:"Show transactions from current month",filter:le(ae({},this.getDefaultFilterState()),{selectedDateRange:{startDate:new Date(new Date().getFullYear(),new Date().getMonth(),1),endDate:new Date(new Date().getFullYear(),new Date().getMonth()+1,0)}})}]}initializePresets(){let t=this.loadPresetsFromStorage();this.filterPresetsSubject.next(t)}generatePresetId(){return`preset-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}generateFilterDescription(t){let r=[];return t.searchTerm&&r.push(`Search: "${t.searchTerm}"`),t.selectedCategory.includes("all")||r.push(`Category: ${t.selectedCategory.join(", ")}`),t.selectedType!=="all"&&r.push(`Type: ${t.selectedType}`),t.selectedDate&&r.push(`Date: ${t.selectedDate.toLocaleDateString()}`),t.selectedDateRange&&r.push(`Date Range: ${t.selectedDateRange.startDate.toLocaleDateString()} - ${t.selectedDateRange.endDate.toLocaleDateString()}`),t.categoryFilter&&r.push(`Category Filter: ${t.categoryFilter.categoryId} (${t.categoryFilter.monthName} ${t.categoryFilter.year})`),r.length>0?r.join(", "):"No filters applied"}savePresetsToStorage(t){try{localStorage.setItem("money-manager-filter-presets",JSON.stringify(t))}catch(r){console.warn("Failed to save filter presets to localStorage:",r)}}loadPresetsFromStorage(){try{let t=localStorage.getItem("money-manager-filter-presets");return t?JSON.parse(t):this.getDefaultPresets()}catch(t){return console.warn("Failed to load filter presets from localStorage:",t),this.getDefaultPresets()}}filterTransactions(t,r){let a=r||this.getCurrentFilterState(),o=[...t];if(a.searchTerm&&a.searchTerm.trim()){let s=a.searchTerm.toLowerCase().trim();o=o.filter(u=>{var m,f;return((m=u.payee)==null?void 0:m.toLowerCase().includes(s))||((f=u.category)==null?void 0:f.toLowerCase().includes(s))||u.notes&&u.notes.toLowerCase().includes(s)})}if(a.selectedCategory&&!a.selectedCategory.includes("all")&&(o=o.filter(s=>a.selectedCategory.includes(s.categoryId))),a.selectedType&&a.selectedType!=="all"&&(o=o.filter(s=>s.type===a.selectedType)),a.selectedDate){let s=(0,Ja.default)(a.selectedDate).startOf("day");o=o.filter(u=>{let m=this.getTransactionDate(u.date);return m?(0,Ja.default)(m).startOf("day").isSame(s,"day"):!1})}if(a.selectedDateRange&&a.selectedDateRange.startDate&&a.selectedDateRange.endDate){let s=(0,Ja.default)(a.selectedDateRange.startDate).startOf("day"),u=(0,Ja.default)(a.selectedDateRange.endDate).endOf("day");o=o.filter(m=>{let f=this.getTransactionDate(m.date);return f?(0,Ja.default)(f).isBetween(s,u,"day","[]"):!1})}return a.accountFilter&&a.accountFilter.length>0&&(o=o.filter(s=>a.accountFilter.includes(s.accountId))),a.amountRange&&(a.amountRange.min!==null&&(o=o.filter(s=>s.amount>=(a.amountRange.min||0))),a.amountRange.max!==null&&(o=o.filter(s=>s.amount<=(a.amountRange.max||0)))),a.statusFilter&&a.statusFilter.length>0&&(o=o.filter(s=>a.statusFilter.includes(s.status))),a.tags&&a.tags.length>0&&(o=o.filter(s=>s.tags&&a.tags.some(u=>s.tags.includes(u)))),o}filterTransactionsWithCustomFilters(t,r){let a={searchTerm:r.searchTerm||"",selectedCategory:r.selectedCategory||["all"],selectedType:r.selectedType||"all",selectedDate:r.selectedDate||null,selectedDateRange:r.selectedDateRange||null,categoryFilter:null,accountFilter:r.accountFilter||[],amountRange:r.amountRange||{min:null,max:null},statusFilter:r.statusFilter||[],tags:r.tags||[]};return this.filterTransactions(t,a)}sortTransactions(t,r="date-desc"){let a=[...t];switch(r){case"date-desc":return a.sort((o,s)=>{var f,h;let u=this.getTransactionDate(o.date),m=this.getTransactionDate(s.date);return((f=m==null?void 0:m.getTime())!=null?f:0)-((h=u==null?void 0:u.getTime())!=null?h:0)});case"date-asc":return a.sort((o,s)=>{var f,h;let u=this.getTransactionDate(o.date),m=this.getTransactionDate(s.date);return((f=u==null?void 0:u.getTime())!=null?f:0)-((h=m==null?void 0:m.getTime())!=null?h:0)});case"amount-desc":return a.sort((o,s)=>s.amount-o.amount);case"amount-asc":return a.sort((o,s)=>o.amount-s.amount);case"payee-asc":return a.sort((o,s)=>o.payee.localeCompare(s.payee));case"category-asc":return a.sort((o,s)=>o.category.localeCompare(s.category));default:return a.sort((o,s)=>{var f,h;let u=this.getTransactionDate(o.date),m=this.getTransactionDate(s.date);return((f=m==null?void 0:m.getTime())!=null?f:0)-((h=u==null?void 0:u.getTime())!=null?h:0)})}}filterAndSortTransactions(t,r,a="date-desc"){let o=this.filterTransactions(t,r);return this.sortTransactions(o,a)}getTransactionDate(t){if(!t)return null;if(t&&typeof t=="object"&&"seconds"in t)return new Date(t.seconds*1e3);if(t instanceof Date)return t;if(typeof t=="string"){let r=new Date(t);return isNaN(r.getTime())?null:r}else if(typeof t=="number")return new Date(t);return null}filterCurrentYearTransactions(t,r){let a=(0,Ja.default)().year(),o=t.filter(s=>{let u=this.getTransactionDate(s.date);return u?(0,Ja.default)(u).year()===a:!1});return this.filterTransactions(o,r)}filterYearTransactions(t,r,a){let o=t.filter(s=>{let u=this.getTransactionDate(s.date);return u?(0,Ja.default)(u).year()===r:!1});return this.filterTransactions(o,a)}};n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var P_=new Xa("NGX_ECHARTS_CONFIG"),Og=class{constructor(){this.subject=new sl(1),this.subscriptions=new Pi}doFilter(n){this.subject.next(n)}dispose(){this.subscriptions.unsubscribe()}notEmpty(n,i){this.subscriptions.add(this.subject.subscribe(t=>{if(t[n]){let r=t[n].currentValue;r!=null&&i(r)}}))}has(n,i){this.subscriptions.add(this.subject.subscribe(t=>{if(t[n]){let r=t[n].currentValue;i(r)}}))}notFirst(n,i){this.subscriptions.add(this.subject.subscribe(t=>{if(t[n]&&!t[n].isFirstChange()){let r=t[n].currentValue;i(r)}}))}notFirstAndEmpty(n,i){this.subscriptions.add(this.subject.subscribe(t=>{if(t[n]&&!t[n].isFirstChange()){let r=t[n].currentValue;r!=null&&i(r)}}))}},Tu=(()=>{let n=class n{constructor(){var t;this.el=Wr(Ws),this.ngZone=Wr(vr),this.config=Wr(P_),this.options=Ka(null),this.theme=Ka((t=this.config.theme)!=null?t:null),this.initOpts=Ka(null),this.merge=Ka(null),this.autoResize=Ka(!0),this.loading=Ka(!1),this.loadingType=Ka("default"),this.loadingOpts=Ka(null),this.chartInit=Zm(),this.optionsError=Zm(),this.chartClick=zt(this.createLazyEvent("click")),this.chartDblClick=zt(this.createLazyEvent("dblclick")),this.chartMouseDown=zt(this.createLazyEvent("mousedown")),this.chartMouseMove=zt(this.createLazyEvent("mousemove")),this.chartMouseUp=zt(this.createLazyEvent("mouseup")),this.chartMouseOver=zt(this.createLazyEvent("mouseover")),this.chartMouseOut=zt(this.createLazyEvent("mouseout")),this.chartGlobalOut=zt(this.createLazyEvent("globalout")),this.chartContextMenu=zt(this.createLazyEvent("contextmenu")),this.chartHighlight=zt(this.createLazyEvent("highlight")),this.chartDownplay=zt(this.createLazyEvent("downplay")),this.chartSelectChanged=zt(this.createLazyEvent("selectchanged")),this.chartLegendSelectChanged=zt(this.createLazyEvent("legendselectchanged")),this.chartLegendSelected=zt(this.createLazyEvent("legendselected")),this.chartLegendUnselected=zt(this.createLazyEvent("legendunselected")),this.chartLegendLegendSelectAll=zt(this.createLazyEvent("legendselectall")),this.chartLegendLegendInverseSelect=zt(this.createLazyEvent("legendinverseselect")),this.chartLegendScroll=zt(this.createLazyEvent("legendscroll")),this.chartDataZoom=zt(this.createLazyEvent("datazoom")),this.chartDataRangeSelected=zt(this.createLazyEvent("datarangeselected")),this.chartGraphRoam=zt(this.createLazyEvent("graphroam")),this.chartGeoRoam=zt(this.createLazyEvent("georoam")),this.chartTreeRoam=zt(this.createLazyEvent("treeroam")),this.chartTimelineChanged=zt(this.createLazyEvent("timelinechanged")),this.chartTimelinePlayChanged=zt(this.createLazyEvent("timelineplaychanged")),this.chartRestore=zt(this.createLazyEvent("restore")),this.chartDataViewChanged=zt(this.createLazyEvent("dataviewchanged")),this.chartMagicTypeChanged=zt(this.createLazyEvent("magictypechanged")),this.chartGeoSelectChanged=zt(this.createLazyEvent("geoselectchanged")),this.chartGeoSelected=zt(this.createLazyEvent("geoselected")),this.chartGeoUnselected=zt(this.createLazyEvent("geounselected")),this.chartAxisAreaSelected=zt(this.createLazyEvent("axisareaselected")),this.chartBrush=zt(this.createLazyEvent("brush")),this.chartBrushEnd=zt(this.createLazyEvent("brushend")),this.chartBrushSelected=zt(this.createLazyEvent("brushselected")),this.chartGlobalCursorTaken=zt(this.createLazyEvent("globalcursortaken")),this.chartRendered=zt(this.createLazyEvent("rendered")),this.chartFinished=zt(this.createLazyEvent("finished")),this.animationFrameID=null,this.chart$=new sl(1),this.resize$=new vn,this.changeFilter=new Og,this.resizeObFired=!1,this.echarts=this.config.echarts}ngOnChanges(t){this.changeFilter.doFilter(t)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe(Nh(100,Sh,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize()&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(t=>{for(let r of t)r.target===this.el.nativeElement&&(this.resizeObFired?this.animationFrameID=window.requestAnimationFrame(()=>{this.resize$.next()}):this.resizeObFired=!0)})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",t=>this.onOptionsChange(t)),this.changeFilter.notFirstAndEmpty("merge",t=>this.setOption(t)),this.changeFilter.has("loading",t=>this.toggleLoading(!!t)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(t){this.chart?t?this.chart.showLoading(this.loadingType(),this.loadingOpts()):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(r=>t?r.showLoading(this.loadingType(),this.loadingOpts()):r.hideLoading())}setOption(t,r){if(this.chart)try{this.chart.setOption(t,r)}catch(a){console.error(a),this.optionsError.emit(a)}}refreshChart(){return ue(this,null,function*(){this.dispose(),yield this.initChart()})}createChart(){let t=this.el.nativeElement;if(window&&window.getComputedStyle){let r=window.getComputedStyle(t,null).getPropertyValue("height");(!r||r==="0px")&&(!t.style.height||t.style.height==="0px")&&(t.style.height="400px")}return this.ngZone.runOutsideAngular(()=>(typeof this.echarts=="function"?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:a})=>{var o,s;return a(t,(s=this.theme())!=null?s:(o=this.config)==null?void 0:o.theme,this.initOpts())}))}initChart(){return ue(this,null,function*(){yield this.onOptionsChange(this.options());let t=this.merge();t&&this.chart&&this.setOption(t)})}onOptionsChange(t){return ue(this,null,function*(){t&&(this.chart?this.setOption(this.options(),!0):(this.chart=yield this.createChart(),this.chart$.next(this.chart),this.chartInit.emit(this.chart),this.setOption(this.options(),!0)))})}createLazyEvent(t){return c1(this.chartInit).pipe(zr(r=>new qt(a=>(r.on(t,o=>this.ngZone.run(()=>a.next(o))),()=>{this.chart&&(this.chart.isDisposed()||r.off(t))}))))}};n.\u0275fac=function(r){return new(r||n)},n.\u0275dir=S0({type:n,selectors:[["echarts"],["","echarts",""]],inputs:{options:[1,"options"],theme:[1,"theme"],initOpts:[1,"initOpts"],merge:[1,"merge"],autoResize:[1,"autoResize"],loading:[1,"loading"],loadingType:[1,"loadingType"],loadingOpts:[1,"loadingOpts"]},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartHighlight:"chartHighlight",chartDownplay:"chartDownplay",chartSelectChanged:"chartSelectChanged",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendLegendSelectAll:"chartLegendLegendSelectAll",chartLegendLegendInverseSelect:"chartLegendLegendInverseSelect",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartGraphRoam:"chartGraphRoam",chartGeoRoam:"chartGeoRoam",chartTreeRoam:"chartTreeRoam",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartGeoSelectChanged:"chartGeoSelectChanged",chartGeoSelected:"chartGeoSelected",chartGeoUnselected:"chartGeoUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartGlobalCursorTaken:"chartGlobalCursorTaken",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],standalone:!0,features:[P0]});let e=n;return e})();function lk(e){return{provide:P_,useValue:e}}var O_=(()=>{let n=class n{static forRoot(t){return{ngModule:n,providers:[lk(t)]}}static forChild(){return{ngModule:n}}};n.\u0275fac=function(r){return new(r||n)},n.\u0275mod=Cr({type:n}),n.\u0275inj=_r({});let e=n;return e})();var Pl=Tr(Nr());var E_=(()=>{let n=class n{constructor(t,r,a,o){this.auth=t,this.notificationService=r,this.currencyService=a,this.store=o,this.totalSpendAmt=0,this.totalIncomeAmt=0,this.showYearly=!1,this.userCurrency=this.currencyService.getDefaultCurrency(),this.subscriptions=new Pi,this.totalIncome$=this.store.select(vg),this.totalIncomeByMonth$=this.store.select(g_((0,Pl.default)().month(),(0,Pl.default)().year())),this.totalExpenses$=this.store.select(bg),this.totalExpensesByMonth$=this.store.select(p_((0,Pl.default)().month(),(0,Pl.default)().year())),this.netBalance$=this.store.select(h_)}ngOnInit(){var r;this.subscriptions.add(this.currencyService.currentCurrency$.subscribe(a=>{this.userCurrency=a}));let t=(r=this.auth.currentUser)==null?void 0:r.uid;t&&this.store.dispatch(ri({userId:t})),this.subscriptions.add(this.totalIncome$.subscribe(a=>{this.totalIncomeAmt=a})),this.subscriptions.add(this.totalExpenses$.subscribe(a=>{this.totalSpendAmt=a}))}ngOnDestroy(){this.subscriptions.unsubscribe()}toggleExpenseIncome(){this.showYearly=!this.showYearly}};n.\u0275fac=function(r){return new(r||n)(q(pt),q(ht),q(lx),q(wt))},n.\u0275cmp=Ve({type:n,selectors:[["total-balance"]],decls:17,vars:18,consts:[[1,"text-center","mb-2","pt-5","md:pt-0","mt-2"],[1,"grid","grid-cols-1","gap-4"],[1,"text-center",3,"click"],[1,"text-lg","text-muted","text-gray-500"],[1,"text-responsive-lg","mt-1","font-bold","text-primary"],[1,"text-gray-500"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"div",2),N("click",function(){return a.toggleExpenseIncome()}),c(3,"div",3),d(4,"You Expense | Income"),l(),c(5,"div",4),d(6),pe(7,"async"),pe(8,"currency"),pe(9,"async"),pe(10,"currency"),c(11,"span",5),d(12),pe(13,"async"),pe(14,"currency"),pe(15,"async"),pe(16,"currency"),l()()()()()),r&2&&(p(6),oe(" ",a.showYearly?Ee(8,4,Ee(7,2,a.totalExpenses$)):Ee(10,8,Ee(9,6,a.totalExpensesByMonth$))," \xA0 | \xA0 "),p(6),z(a.showYearly?Ee(14,12,Ee(13,10,a.totalIncome$)):Ee(16,16,Ee(15,14,a.totalIncomeByMonth$))))},dependencies:[go,Wi]});let e=n;return e})();var uk=["calendar"],mk=(e,n)=>n.value;function gk(e,n){e&1&&(c(0,"div",19),se(1,"total-balance",20),l())}function fk(e,n){if(e&1){let i=be();c(0,"button",21),N("click",function(){G(i);let r=S();return H(r.clearAll())}),c(1,"mat-icon"),d(2,"clear"),l()()}}function pk(e,n){if(e&1){let i=be();c(0,"button",22),N("click",function(){G(i);let r=S();return H(r.toggleControls())}),c(1,"mat-icon"),d(2,"expand_more"),l()()}if(e&2){let i=S();Je("rotated",i.isControlsExpanded),fa("matTooltip",i.isControlsExpanded?"Hide controls":"Show controls")}}function hk(e,n){if(e&1){let i=be();c(0,"div",23)(1,"button",12),N("click",function(){G(i);let r=S();return H(r.toggleChartViewMode())}),c(2,"mat-icon"),d(3,"category"),l(),d(4," Category View "),l(),c(5,"button",12),N("click",function(){G(i);let r=S();return H(r.toggleChartViewMode())}),c(6,"mat-icon"),d(7,"compare_arrows"),l(),d(8," Income vs Expense "),l()()}if(e&2){let i=S();p(),w("color",i.chartViewMode==="category"?"primary":"basic"),p(4),w("color",i.chartViewMode==="income-expense"?"primary":"basic")}}function xk(e,n){if(e&1&&(c(0,"mat-option",28),d(1),l()),e&2){let i=n.$implicit;w("value",i),p(),oe(" ",i," ")}}function _k(e,n){if(e&1&&(c(0,"mat-option",28),d(1),l()),e&2){let i=n.$implicit;w("value",i.value),p(),oe(" ",i.label," ")}}function Ck(e,n){if(e&1){let i=be();c(0,"div",24)(1,"div",25)(2,"mat-form-field",26)(3,"mat-label"),d(4,"Year"),l(),c(5,"mat-select",27),gt("valueChange",function(r){G(i);let a=S();return mt(a.selectedYear,r)||(a.selectedYear=r),H(r)}),N("selectionChange",function(r){G(i);let a=S();return H(a.onYearChange(r.value))}),Ge(6,xk,2,2,"mat-option",28,Oi),l()(),c(8,"mat-form-field",29)(9,"mat-label"),d(10,"Month"),l(),c(11,"mat-select",27),gt("valueChange",function(r){G(i);let a=S();return mt(a.selectedMonth,r)||(a.selectedMonth=r),H(r)}),N("selectionChange",function(r){G(i);let a=S();return H(a.onMonthChange(r.value))}),Ge(12,_k,2,2,"mat-option",28,mk),l()()()()}if(e&2){let i=S();p(5),ut("value",i.selectedYear),p(),He(i.availableYears),p(5),ut("value",i.selectedMonth),p(),He(i.availableMonths)}}function vk(e,n){if(e&1){let i=be();c(0,"div",30)(1,"button",31),N("click",function(){G(i);let r=S();return H(r.goToPreviousMonth())}),c(2,"mat-icon"),d(3,"chevron_left"),l()(),c(4,"button",32),N("click",function(){G(i);let r=S();return H(r.goToToday())}),c(5,"mat-icon"),d(6,"today"),l(),d(7," Today "),l(),c(8,"button",33),N("click",function(){G(i);let r=S();return H(r.goToNextMonth())}),c(9,"mat-icon"),d(10,"chevron_right"),l()()()}}function bk(e,n){if(e&1){let i=be();c(0,"div",34)(1,"div",35)(2,"div",36),N("chartClick",function(r){G(i);let a=S();return H(a.onChartClick(r))}),l()()()}if(e&2){let i=S();p(2),w("options",i.pieChartOption)}}function yk(e,n){if(e&1&&(c(0,"span",47),d(1),pe(2,"date"),l()),e&2){let i=S(2);p(),oe(" ",yt(2,1,i.startDate,"MMM dd, yyyy")," ")}}function Mk(e,n){e&1&&(c(0,"span",48),d(1,"Not selected"),l())}function wk(e,n){if(e&1&&(c(0,"span",49),d(1),pe(2,"date"),l()),e&2){let i=S(2);p(),oe(" ",yt(2,1,i.endDate,"MMM dd, yyyy")," ")}}function Sk(e,n){e&1&&(c(0,"span",48),d(1,"Not selected"),l())}function Pk(e,n){if(e&1&&(c(0,"div",50)(1,"div",51)(2,"div",52)(3,"div",53),d(4,"Income"),l(),c(5,"div",54),d(6),pe(7,"number"),l()(),c(8,"div",52)(9,"div",53),d(10,"Expenses"),l(),c(11,"div",55),d(12),pe(13,"number"),l()(),c(14,"div",52)(15,"div",53),d(16,"Net"),l(),c(17,"div",56),d(18),pe(19,"number"),l()()(),c(20,"div",57),d(21),l()()),e&2){let i=S(2);p(6),oe("\u20B9",yt(7,7,i.getRangeTotalIncome(),"1.2-2"),""),p(6),oe("\u20B9",yt(13,10,i.getRangeTotalExpenses(),"1.2-2"),""),p(5),w("ngClass",i.getRangeNetAmount()>=0?"positive":"negative"),p(),oe(" \u20B9",yt(19,13,i.getRangeNetAmount(),"1.2-2")," "),p(3),I0(" ",i.rangeTransactions.length," transactions in ",i.getDaysInRange()," day",i.getDaysInRange()!==1?"s":""," ")}}function Ok(e,n){if(e&1&&(c(0,"div",37)(1,"div",38)(2,"div",39)(3,"div",40)(4,"span",41),d(5,"Start:"),l(),X(6,yk,3,4,"span",42)(7,Mk,2,0,"span",43),l(),c(8,"mat-icon",44),d(9,"arrow_forward"),l(),c(10,"div",40)(11,"span",41),d(12,"End:"),l(),X(13,wk,3,4,"span",45)(14,Sk,2,0,"span",43),l()(),X(15,Pk,22,16,"div",46),l()()),e&2){let i=S();p(6),w("ngIf",i.startDate),p(),w("ngIf",!i.startDate),p(6),w("ngIf",i.endDate),p(),w("ngIf",!i.endDate),p(),w("ngIf",i.startDate&&i.endDate)}}function kk(e,n){if(e&1&&(c(0,"div",37)(1,"div",58)(2,"div",59)(3,"mat-icon",60),d(4,"event"),l(),c(5,"span",61),d(6),pe(7,"date"),l()(),c(8,"div",62)(9,"div",51)(10,"div",52)(11,"div",53),d(12,"Income"),l(),c(13,"div",54),d(14),pe(15,"number"),l()(),c(16,"div",52)(17,"div",53),d(18,"Expenses"),l(),c(19,"div",55),d(20),pe(21,"number"),l()(),c(22,"div",52)(23,"div",53),d(24,"Net"),l(),c(25,"div",56),d(26),pe(27,"number"),l()()(),c(28,"div",57),d(29),l()()()()),e&2){let i=S();p(6),z(yt(7,6,i.selectedDate,"fullDate")),p(8),oe("\u20B9",yt(15,9,i.getTotalIncome(),"1.2-2"),""),p(6),oe("\u20B9",yt(21,12,i.getTotalExpenses(),"1.2-2"),""),p(5),w("ngClass",i.getNetAmount()>=0?"positive":"negative"),p(),oe(" \u20B9",yt(27,15,i.getNetAmount(),"1.2-2")," "),p(3),oe(" ",i.selectedDateTransactions.length," transactions ")}}function Ek(e,n){if(e&1){let i=be();c(0,"div",63)(1,"mat-calendar",64,0),N("selectedChange",function(r){G(i);let a=S();return H(a.onDateSelected(r))}),l()()}if(e&2){let i=S();p(),w("dateClass",i.dateClass)("selected",i.selectedDate)}}var T_=(()=>{let n=class n{constructor(t,r,a,o,s){this.breakpointObserver=t,this.filterService=r,this.notificationService=a,this.dateService=o,this.store=s,this.isMobile=!1,this.transactions=[],this.categories=[],this.selectedDate=null,this.selectedDateTransactions=[],this.isRangeMode=!1,this.startDate=null,this.endDate=null,this.rangeTransactions=[],this.isControlsExpanded=!1,this.pieChartOption={},this.showPieChart=!1,this.showCalendar=!0,this.chartViewMode="category",this.currentViewDate=new Date,this.selectedYear=new Date().getFullYear(),this.selectedMonth=new Date().getMonth(),this.availableYears=[],this.availableMonths=[{value:0,label:"January"},{value:1,label:"February"},{value:2,label:"March"},{value:3,label:"April"},{value:4,label:"May"},{value:5,label:"June"},{value:6,label:"July"},{value:7,label:"August"},{value:8,label:"September"},{value:9,label:"October"},{value:10,label:"November"},{value:11,label:"December"}],this.subscription=new Pi,this.dateClass=(u,m)=>{if(m==="month"){let f=(0,cn.default)(u).startOf("day"),h="",_=this.transactions.some(v=>(0,cn.default)(this.dateService.toDate(v.date)).startOf("day").isSame(f,"day")&&v.type===en.INCOME);if(this.transactions.some(v=>(0,cn.default)(this.dateService.toDate(v.date)).startOf("day").isSame(f,"day"))&&(_?h+="has-transactions has-income ":h+="has-transactions has-expense "),this.isRangeMode){if(this.startDate&&(0,cn.default)(this.startDate).startOf("day").isSame(f,"day")&&(h+="range-start "),this.endDate&&(0,cn.default)(this.endDate).startOf("day").isSame(f,"day")&&(h+="range-end "),this.startDate&&this.endDate){let v=(0,cn.default)(this.startDate).startOf("day"),C=(0,cn.default)(this.endDate).endOf("day");f.isBetween(v,C,"day","[]")&&(h+="range-in-between ")}}else this.selectedDate&&(0,cn.default)(this.selectedDate).startOf("day").isSame(f,"day")&&(h+="selected-date ");return h.trim()}return""},this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(u=>{this.isMobile=u.matches})}ngOnInit(){this.loadTransactions(),this.loadCategories(),this.initializePieChart(),this.generateAvailableYears(),this.subscribeToFilterService()}ngOnDestroy(){this.subscription.unsubscribe()}loadTransactions(){this.subscription.add(this.store.select(An).subscribe({next:t=>{this.transactions=t,this.updatePieChart(),this.updateCalendar()},error:t=>{console.error("Error loading transactions:",t),this.notificationService.error("Failed to load calendar data")}}))}loadCategories(){this.subscription.add(this.store.select(Ri).subscribe({next:t=>{this.categories=t,this.updatePieChart()},error:t=>{console.error("Error loading categories:",t)}}))}generateAvailableYears(){let t=new Date().getFullYear();this.availableYears=[];for(let r=t-5;r<=t+1;r++)this.availableYears.push(r)}initializePieChart(){this.pieChartOption={title:{text:"Category-wise Spending",left:"center",textStyle:{fontSize:14,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:"{b}<br> \u20B9{c} ({d}%)"},legend:{orient:"horizontal",left:"center",bottom:"10%",type:"scroll"},series:[{name:"Categories",type:"pie",radius:"50%",data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}}updatePieChart(){this.chartViewMode==="category"?this.updateCategoryChart():this.updateIncomeExpenseChart()}updateCategoryChart(){let t=this.getFilteredTransactions(),r=this.getCategorySpendingData(t),a=t.reduce((o,s)=>o+s.amount,0);this.pieChartOption=le(ae({},this.pieChartOption),{title:{text:`${this.availableMonths[this.selectedMonth].label} ${this.selectedYear} - \u20B9${a.toLocaleString()}`,left:"center",textStyle:{fontSize:14,fontWeight:"bold"}},series:[{name:"Categories",type:"pie",radius:"50%",label:{show:!0,position:"outside",formatter:"{b} ({d}%)"},data:r,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}onChartClick(t){this.chartViewMode==="category"&&t.data&&!this.isMobile&&this.applyCategoryFilter(t.data.categoryId||t.data.name)}applyCategoryFilter(t){let r=this.categories.find(u=>u.id===t),a=r?r.name:t;this.filterService.setSelectedCategory([t]);let o=(0,cn.default)([this.selectedYear,this.selectedMonth,1]).startOf("month").toDate(),s=(0,cn.default)([this.selectedYear,this.selectedMonth,1]).endOf("month").toDate();this.filterService.setSelectedDateRange(o,s),this.notificationService.success(`Filtering transactions for ${a} in ${this.availableMonths[this.selectedMonth].label} ${this.selectedYear}`)}updateIncomeExpenseChart(){let t=0,r=0;this.isRangeMode&&this.startDate&&this.endDate?(t=this.getRangeTotalIncome(),r=this.getRangeTotalExpenses()):this.selectedDate&&(t=this.getTotalIncome(),r=this.getTotalExpenses()),this.pieChartOption=le(ae({},this.pieChartOption),{title:{text:"Income vs Expenses",left:"center",textStyle:{fontSize:14,fontWeight:"bold"}},series:[{name:"Transactions",type:"pie",radius:"50%",data:[{value:t,name:"Income",itemStyle:{color:"#10b981"}},{value:r,name:"Expenses",itemStyle:{color:"#ef4444"}}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}getFilteredTransactions(){let t=(0,cn.default)([this.selectedYear,this.selectedMonth,1]),r=(0,cn.default)(t).endOf("month");return this.transactions.filter(a=>(0,cn.default)(this.dateService.toDate(a.date)).isBetween(t,r,"day","[]")&&a.type==="expense")}getCategorySpendingData(t){let r=new Map;t.forEach(o=>{let s=o.categoryId,u=this.categories.find(f=>f.id===s),m=u?u.name:"";if(m&&s)if(r.has(s)){let f=r.get(s);f.amount+=o.amount}else r.set(s,{name:m,id:s,amount:o.amount})});let a=["#5B8DEF","#A0C4FF","#B8B8FF","#CDB4DB","#FFAFCC","#FFC8DD","#FDCB82","#90DBF4","#ADE8F4","#CAF0F8","#A2D2FF","#D0F4DE"];return Array.from(r.values()).map((o,s)=>({name:o.name,categoryId:o.id,value:o.amount,itemStyle:{color:a[s%a.length]}}))}togglePieChart(){this.showPieChart=!this.showPieChart,this.showCalendar=!this.showCalendar,this.showPieChart&&this.updatePieChart()}toggleCalendar(){this.showCalendar=!this.showCalendar,this.showPieChart=!this.showCalendar}toggleChartViewMode(){this.chartViewMode=this.chartViewMode==="category"?"income-expense":"category",this.updatePieChart()}onYearChange(t){this.selectedYear=t,this.updatePieChart()}onMonthChange(t){this.selectedMonth=t,this.updatePieChart()}goToPreviousMonth(){this.currentViewDate=(0,cn.default)(this.currentViewDate).subtract(1,"month").toDate()}goToNextMonth(){this.currentViewDate=(0,cn.default)(this.currentViewDate).add(1,"month").toDate()}goToToday(){this.currentViewDate=new Date}onDateSelected(t){this.isRangeMode?this.handleRangeSelection(t):this.handleSingleDateSelection(t),this.updatePieChart()}handleSingleDateSelection(t){this.selectedDate=t,t?(this.selectedDateTransactions=this.getTransactionsForDate(t),this.filterService.setSelectedDate(t)):(this.selectedDateTransactions=[],this.filterService.clearSelectedDate())}handleRangeSelection(t){t&&(!this.startDate||this.startDate&&this.endDate?(this.startDate=t,this.endDate=null,this.rangeTransactions=[]):(t>=this.startDate?this.endDate=t:(this.endDate=this.startDate,this.startDate=t),this.rangeTransactions=this.getTransactionsForDateRange(this.startDate,this.endDate),this.filterService.setSelectedDateRange(this.startDate,this.endDate)))}getTransactionsForDate(t){let r=(0,cn.default)(t).startOf("day");return this.transactions.filter(a=>(0,cn.default)(this.dateService.toDate(a.date)).startOf("day").isSame(r,"day"))}getTransactionsForDateRange(t,r){let a=(0,cn.default)(t).startOf("day"),o=(0,cn.default)(r).endOf("day");return this.transactions.filter(s=>(0,cn.default)(this.dateService.toDate(s.date)).isBetween(a,o,"day","[]"))}formatDate(t){return(0,cn.default)(t).format("YYYY-MM-DD")}getTotalIncome(){return this.selectedDateTransactions.filter(t=>t.type===en.INCOME).reduce((t,r)=>t+r.amount,0)}getTotalExpenses(){return this.selectedDateTransactions.filter(t=>t.type==="expense").reduce((t,r)=>t+r.amount,0)}getNetAmount(){return this.getTotalIncome()-this.getTotalExpenses()}toggleRangeMode(){this.isRangeMode=!this.isRangeMode,this.clearSelections()}toggleControls(){this.isControlsExpanded=!this.isControlsExpanded}hasSelection(){return this.isRangeMode?this.startDate!==null||this.endDate!==null:this.selectedDate!==null}clearSelections(){this.selectedDate=null,this.selectedDateTransactions=[],this.startDate=null,this.endDate=null,this.rangeTransactions=[],this.filterService.clearSelectedDate(),this.updatePieChart()}getRangeTotalIncome(){return this.rangeTransactions.filter(t=>t.type===en.INCOME).reduce((t,r)=>t+r.amount,0)}getRangeTotalExpenses(){return this.rangeTransactions.filter(t=>t.type==="expense").reduce((t,r)=>t+r.amount,0)}getRangeNetAmount(){return this.getRangeTotalIncome()-this.getRangeTotalExpenses()}getFormattedDateRange(){if(!this.startDate||!this.endDate)return"";let t=(0,cn.default)(this.startDate),r=(0,cn.default)(this.endDate);return t.isSame(r,"day")?t.format("MMM DD, YYYY"):t.isSame(r,"year")?`${t.format("MMM DD")} - ${r.format("MMM DD, YYYY")}`:`${t.format("MMM DD, YYYY")} - ${r.format("MMM DD, YYYY")}`}getDaysInRange(){if(!this.startDate||!this.endDate)return 0;let t=(0,cn.default)(this.startDate);return(0,cn.default)(this.endDate).diff(t,"days")+1}isToday(t){return(0,cn.default)(t).isSame((0,cn.default)(),"day")}isPastDate(t){return(0,cn.default)(t).isBefore((0,cn.default)(),"day")}isFutureDate(t){return(0,cn.default)(t).isAfter((0,cn.default)(),"day")}clearAll(){this.clearSelections(),this.isControlsExpanded=this.isRangeMode=!1,this.filterService.clearSelectedDate()}subscribeToFilterService(){this.subscription.add(this.filterService.selectedDateRange$.subscribe(t=>{t&&(this.selectedMonth=t.startDate.getMonth(),this.selectedYear=t.startDate.getFullYear()),this.updatePieChart()}))}updateCalendar(){this.calendar&&this.calendar.updateTodaysDate()}};n.\u0275fac=function(r){return new(r||n)(q(Zi),q(Ia),q(ht),q(At),q(wt))},n.\u0275cmp=Ve({type:n,selectors:[["calendar-view"]],viewQuery:function(r,a){if(r&1&&Ir(uk,5),r&2){let o;Ar(o=Dr())&&(a.calendar=o.first)}},decls:35,vars:18,consts:[["calendar",""],[1,"demo-inline-calendar-card"],["class","m-4 flex justify-around",4,"ngIf"],[1,"calendar-header"],[1,"header-main"],[1,"header-title","sm:text-sm","text-xs"],[1,"header-actions"],["mat-icon-button","","color","warn","matTooltip","Clear selection",3,"click",4,"ngIf"],["mat-icon-button","",3,"click","color","matTooltip"],["mat-icon-button","",3,"rotated","matTooltip","click",4,"ngIf"],[1,"controls-section"],[1,"mode-toggle"],["mat-raised-button","",3,"click","color"],["class","chart-mode-toggle",4,"ngIf"],["class","date-filters",4,"ngIf"],["class","calendar-navigation",4,"ngIf"],["class","pie-chart-section",4,"ngIf"],["class","status-section",4,"ngIf"],["class","calendar-container",4,"ngIf"],[1,"m-4","flex","justify-around"],[1,"md:col-span-2","lg:col-span-7"],["mat-icon-button","","color","warn","matTooltip","Clear selection",3,"click"],["mat-icon-button","",3,"click","matTooltip"],[1,"chart-mode-toggle"],[1,"date-filters"],[1,"filter-row"],["appearance","fill",1,"year-select"],[3,"valueChange","selectionChange","value"],[3,"value"],["appearance","fill",1,"month-select"],[1,"calendar-navigation"],["mat-icon-button","","matTooltip","Previous month",3,"click"],["mat-raised-button","","color","primary","matTooltip","Go to today",3,"click"],["mat-icon-button","","matTooltip","Next month",3,"click"],[1,"pie-chart-section"],[1,"chart-container"],["echarts","",1,"pie-chart",3,"chartClick","options"],[1,"status-section"],[1,"range-status"],[1,"date-range-display"],[1,"date-item"],[1,"date-label"],["class","date-value start-date",4,"ngIf"],["class","date-placeholder",4,"ngIf"],[1,"arrow-icon"],["class","date-value end-date",4,"ngIf"],["class","range-summary",4,"ngIf"],[1,"date-value","start-date"],[1,"date-placeholder"],[1,"date-value","end-date"],[1,"range-summary"],[1,"summary-grid"],[1,"summary-item"],[1,"summary-label"],[1,"summary-amount","income"],[1,"summary-amount","expense"],[1,"summary-amount",3,"ngClass"],[1,"transaction-count"],[1,"single-date-status"],[1,"selected-date-display"],[1,"date-icon"],[1,"selected-date-text"],[1,"date-summary"],[1,"calendar-container"],[3,"selectedChange","dateClass","selected"]],template:function(r,a){r&1&&(c(0,"mat-card",1),X(1,gk,2,0,"div",2),c(2,"div",3)(3,"div",4)(4,"div",5)(5,"mat-icon"),d(6,"calendar_today"),l(),c(7,"span"),d(8,"Calendar"),l()(),c(9,"div",6),X(10,fk,3,0,"button",7),c(11,"button",8),N("click",function(){return a.togglePieChart()}),c(12,"mat-icon"),d(13,"pie_chart"),l()(),c(14,"button",8),N("click",function(){return a.toggleCalendar()}),c(15,"mat-icon"),d(16,"calendar_month"),l()(),X(17,pk,3,3,"button",9),l()(),c(18,"div",10)(19,"div",11)(20,"button",12),N("click",function(){return a.toggleRangeMode()}),c(21,"mat-icon"),d(22,"event"),l(),d(23," Single Date "),l(),c(24,"button",12),N("click",function(){return a.toggleRangeMode()}),c(25,"mat-icon"),d(26,"date_range"),l(),d(27," Date Range "),l()(),X(28,hk,9,2,"div",13)(29,Ck,14,2,"div",14)(30,vk,11,0,"div",15),l()(),X(31,bk,3,1,"div",16)(32,Ok,16,5,"div",17)(33,kk,30,18,"div",17)(34,Ek,3,2,"div",18),l()),r&2&&(p(),w("ngIf",!a.isRangeMode&&!a.selectedDate),p(9),w("ngIf",a.hasSelection()),p(),fa("matTooltip",a.showPieChart?"Hide chart":"Show chart"),w("color",a.showPieChart?"primary":"basic"),p(3),fa("matTooltip",a.showCalendar&&!a.showPieChart?"Hide calendar":"Show calendar"),w("color",a.showCalendar&&!a.showPieChart?"primary":"basic"),p(3),w("ngIf",!a.isMobile),p(),Je("expanded",a.isControlsExpanded),p(2),w("color",a.isRangeMode?"basic":"primary"),p(4),w("color",a.isRangeMode?"primary":"basic"),p(4),w("ngIf",a.showPieChart),p(),w("ngIf",a.showPieChart&&a.chartViewMode==="category"),p(),w("ngIf",a.showCalendar),p(),w("ngIf",a.showPieChart),p(),w("ngIf",a.isRangeMode&&a.showCalendar),p(),w("ngIf",!a.isRangeMode&&a.selectedDate&&a.showCalendar),p(),w("ngIf",a.showCalendar&&!a.showPieChart))},dependencies:[br,ct,To,Ht,bn,at,Px,Ji,Zr,Ni,Fi,Jn,Tu,E_,Ys,Vn],styles:[".demo-inline-calendar-card[_ngcontent-%COMP%]{width:100%;max-width:400px;margin:0 auto;overflow:hidden}.calendar-header[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-weight:600;color:#374151}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:.25rem}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:transform .2s ease}.calendar-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button.rotated[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]{max-height:0;overflow:hidden;transition:max-height .3s ease,padding .3s ease;padding:0 1rem}.calendar-header[_ngcontent-%COMP%]   .controls-section.expanded[_ngcontent-%COMP%]{max-height:400px;padding:1rem;background-color:#f0f8ff}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .mode-toggle[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:center;margin-bottom:1rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .mode-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;max-width:150px}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .chart-mode-toggle[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:center;margin-bottom:1rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .chart-mode-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;max-width:150px;font-size:.75rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .chart-mode-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;margin-right:.25rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]{margin-bottom:1rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:center}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .year-select[_ngcontent-%COMP%], .calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .month-select[_ngcontent-%COMP%]{flex:1;max-width:120px}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .year-select[_ngcontent-%COMP%]     .mat-mdc-form-field, .calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .month-select[_ngcontent-%COMP%]     .mat-mdc-form-field{font-size:.875rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .year-select[_ngcontent-%COMP%]     .mat-mdc-select, .calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .date-filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]   .month-select[_ngcontent-%COMP%]     .mat-mdc-select{font-size:.875rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .calendar-navigation[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .calendar-navigation[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:all .2s ease}.calendar-header[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .calendar-navigation[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.pie-chart-section[_ngcontent-%COMP%]{padding:1rem 0;border-bottom:1px solid #f3f4f6;background:#f4f3f6}.pie-chart-section[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.pie-chart-section[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .pie-chart[_ngcontent-%COMP%]{width:100%;height:450px;max-width:450px;cursor:pointer}@media (max-width: 480px){.pie-chart-section[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .pie-chart[_ngcontent-%COMP%]{width:100%;height:350px;max-width:350px}}.status-section[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #f3f4f6}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:1rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value[_ngcontent-%COMP%]{font-weight:600}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.start-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.start-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.start-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.start-date[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(70 119 127 / var(--tw-text-opacity))}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.end-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.end-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.end-date[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-value.end-date[_ngcontent-%COMP%]{color:#10b981}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-placeholder[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-placeholder[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-placeholder[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-item[_ngcontent-%COMP%]   .date-placeholder[_ngcontent-%COMP%]{color:#9ca3af;font-style:italic}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .arrow-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .arrow-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .arrow-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .arrow-icon[_ngcontent-%COMP%]{color:#9ca3af;font-size:1rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .date-icon[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .date-icon[_ngcontent-%COMP%]{color:#10b981}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .selected-date-text[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .selected-date-text[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-range-display[_ngcontent-%COMP%]   .selected-date-text[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .selected-date-display[_ngcontent-%COMP%]   .selected-date-text[_ngcontent-%COMP%]{font-weight:600;color:#374151}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]{background:#f8fafc;border-radius:8px;padding:1rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-bottom:.5rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{text-align:center}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;margin-bottom:.25rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount[_ngcontent-%COMP%]{font-weight:700;font-size:.875rem}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.income[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.income[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.income[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.income[_ngcontent-%COMP%]{color:#10b981}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.expense[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.expense[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.expense[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.expense[_ngcontent-%COMP%]{color:#ef4444}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.positive[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.positive[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.positive[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.positive[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(70 119 127 / var(--tw-text-opacity))}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.negative[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.negative[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.negative[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-amount.negative[_ngcontent-%COMP%]{color:#f59e0b}.status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .range-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .range-summary[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%], .status-section[_ngcontent-%COMP%]   .single-date-status[_ngcontent-%COMP%]   .date-summary[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]{text-align:center;font-size:.75rem;color:#6b7280}.calendar-container[_ngcontent-%COMP%]{padding:1rem}  .mat-calendar-body-cell.has-transactions.has-income .mat-calendar-body-cell-content{background-color:#a6eeb3!important}  .mat-calendar-body-cell.has-transactions.has-expense{color:#fff!important;font-weight:700;border-radius:50%}  .mat-calendar-body-cell.has-transactions.has-expense .mat-calendar-body-cell-content{background-color:#c8dbdf!important}  .mat-calendar-body-cell.has-transactions:hover .mat-calendar-body-cell-content{--tw-bg-opacity: 1;background-color:rgb(70 119 127 / var(--tw-bg-opacity))}  .mat-calendar-body-cell.mat-calendar-body-active .mat-calendar-body-cell-content{--tw-bg-opacity: 1;background-color:rgb(70 119 127 / var(--tw-bg-opacity));color:#fff!important}  .mat-calendar-body-cell.range-start .mat-calendar-body-cell-content{background-color:#059669!important;color:#fff!important;font-weight:700}  .mat-calendar-body-cell.range-end .mat-calendar-body-cell-content{background-color:#dc2626!important;color:#fff!important;font-weight:700}  .mat-calendar-body-cell.range-in-between .mat-calendar-body-cell-content{background-color:#fbbf24!important;color:#1f2937!important;font-weight:500}  .mat-calendar-body-cell.selected-date .mat-calendar-body-cell-content{background-color:#7c3aed!important;color:#fff!important;font-weight:700}.transaction-summary[_ngcontent-%COMP%]   .income-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dcfce7,#bbf7d0)}.transaction-summary[_ngcontent-%COMP%]   .expense-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fee2e2,#fecaca)}.transaction-summary[_ngcontent-%COMP%]   .net-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe)}.transaction-item[_ngcontent-%COMP%]{transition:all .2s ease}.transaction-item[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 6px -1px #0000001a}@media (max-width: 768px){.demo-inline-calendar-card[_ngcontent-%COMP%]{max-width:100%}.transaction-summary[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}}"]});let e=n;return e})();var Ul={};Ul.version="0.18.5";var Na=1200,Uc=1252,Ik=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],tf={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},nf=function(e){Ik.indexOf(e)!=-1&&(Uc=tf[0]=e)};function Ak(){nf(1252)}var ha=function(e){Na=e,nf(e)};function rf(){ha(1200),Ak()}function Wg(e){for(var n=[],i=0,t=e.length;i<t;++i)n[i]=e.charCodeAt(i);return n}function Dk(e){for(var n=[],i=0;i<e.length>>1;++i)n[i]=String.fromCharCode(e.charCodeAt(2*i)+(e.charCodeAt(2*i+1)<<8));return n.join("")}function VC(e){for(var n=[],i=0;i<e.length>>1;++i)n[i]=String.fromCharCode(e.charCodeAt(2*i+1)+(e.charCodeAt(2*i)<<8));return n.join("")}var El=function(e){var n=e.charCodeAt(0),i=e.charCodeAt(1);return n==255&&i==254?Dk(e.slice(2)):n==254&&i==255?VC(e.slice(2)):n==65279?e.slice(1):e},Iu=function(n){return String.fromCharCode(n)},I_=function(n){return String.fromCharCode(n)},pn;var ni=null,Ol=!0,Lo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jl(e){for(var n="",i=0,t=0,r=0,a=0,o=0,s=0,u=0,m=0;m<e.length;)i=e.charCodeAt(m++),a=i>>2,t=e.charCodeAt(m++),o=(i&3)<<4|t>>4,r=e.charCodeAt(m++),s=(t&15)<<2|r>>6,u=r&63,isNaN(t)?s=u=64:isNaN(r)&&(u=64),n+=Lo.charAt(a)+Lo.charAt(o)+Lo.charAt(s)+Lo.charAt(u);return n}function jr(e){var n="",i=0,t=0,r=0,a=0,o=0,s=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)a=Lo.indexOf(e.charAt(m++)),o=Lo.indexOf(e.charAt(m++)),i=a<<2|o>>4,n+=String.fromCharCode(i),s=Lo.indexOf(e.charAt(m++)),t=(o&15)<<4|s>>2,s!==64&&(n+=String.fromCharCode(t)),u=Lo.indexOf(e.charAt(m++)),r=(s&3)<<6|u,u!==64&&(n+=String.fromCharCode(r));return n}var $t=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ro=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,i){return i?new Buffer(n,i):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}}();function Uo(e){return $t?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function A_(e){return $t?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Vr=function(n){return $t?ro(n,"binary"):n.split("").map(function(i){return i.charCodeAt(0)&255})};function tm(e){if(typeof ArrayBuffer>"u")return Vr(e);for(var n=new ArrayBuffer(e.length),i=new Uint8Array(n),t=0;t!=e.length;++t)i[t]=e.charCodeAt(t)&255;return n}function Yo(e){if(Array.isArray(e))return e.map(function(t){return String.fromCharCode(t)}).join("");for(var n=[],i=0;i<e.length;++i)n[i]=String.fromCharCode(e[i]);return n.join("")}function Fk(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function af(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return af(new Uint8Array(e));for(var n=new Array(e.length),i=0;i<e.length;++i)n[i]=e[i];return n}var Ui=$t?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:ro(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,i=0;for(n=0;n<e.length;++n)i+=e[n].length;var t=new Uint8Array(i),r=0;for(n=0,i=0;n<e.length;i+=r,++n)if(r=e[n].length,e[n]instanceof Uint8Array)t.set(e[n],i);else{if(typeof e[n]=="string")throw"wtf";t.set(new Uint8Array(e[n]),i)}return t}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Rk(e){for(var n=[],i=0,t=e.length+250,r=Uo(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)r[i++]=o;else if(o<2048)r[i++]=192|o>>6&31,r[i++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var s=e.charCodeAt(++a)&1023;r[i++]=240|o>>8&7,r[i++]=128|o>>2&63,r[i++]=128|s>>6&15|(o&3)<<4,r[i++]=128|s&63}else r[i++]=224|o>>12&15,r[i++]=128|o>>6&63,r[i++]=128|o&63;i>t&&(n.push(r.slice(0,i)),i=0,r=Uo(65535),t=65530)}return n.push(r.slice(0,i)),Ui(n)}var ar=/\u0000/g,Tl=/[\u0001-\u0006]/g;function Nc(e){for(var n="",i=e.length-1;i>=0;)n+=e.charAt(i--);return n}function xa(e,n){var i=""+e;return i.length>=n?i:ei("0",n-i.length)+i}function of(e,n){var i=""+e;return i.length>=n?i:ei(" ",n-i.length)+i}function zu(e,n){var i=""+e;return i.length>=n?i:i+ei(" ",n-i.length)}function Nk(e,n){var i=""+Math.round(e);return i.length>=n?i:ei("0",n-i.length)+i}function Bk(e,n){var i=""+e;return i.length>=n?i:ei("0",n-i.length)+i}var D_=Math.pow(2,32);function Tc(e,n){if(e>D_||e<-D_)return Nk(e,n);var i=Math.round(e);return Bk(i,n)}function Wu(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var F_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Eg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Lk(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var Ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},R_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Vk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Yu(e,n,i){for(var t=e<0?-1:1,r=e*t,a=0,o=1,s=0,u=1,m=0,f=0,h=Math.floor(r);m<n&&(h=Math.floor(r),s=h*o+a,f=h*m+u,!(r-h<5e-8));)r=1/(r-h),a=o,o=s,u=m,m=f;if(f>n&&(m>n?(f=u,s=a):(f=m,s=o)),!i)return[0,t*s,f];var _=Math.floor(t*s/f);return[_,t*s-_*f,f]}function us(e,n,i){if(e>2958465||e<0)return null;var t=e|0,r=Math.floor(86400*(e-t)),a=0,o=[],s={D:t,T:r,u:86400*(e-t)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),n&&n.date1904&&(t+=1462),s.u>.9999&&(s.u=0,++r==86400&&(s.T=r=0,++t,++s.D)),t===60)o=i?[1317,10,29]:[1900,2,29],a=3;else if(t===0)o=i?[1317,8,29]:[1900,1,0],a=6;else{t>60&&--t;var u=new Date(1900,0,1);u.setDate(u.getDate()+t-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),t<60&&(a=(a+6)%7),i&&(a=$k(u,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=r%60,r=Math.floor(r/60),s.M=r%60,r=Math.floor(r/60),s.H=r,s.q=a,s}var UC=new Date(1899,11,31,0,0,0),Uk=UC.getTime(),jk=new Date(1900,2,1,0,0,0);function jC(e,n){var i=e.getTime();return n?i-=1461*24*60*60*1e3:e>=jk&&(i+=24*60*60*1e3),(i-(Uk+(e.getTimezoneOffset()-UC.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function sf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function zk(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Wk(e){var n=e<0?12:11,i=sf(e.toFixed(12));return i.length<=n||(i=e.toPrecision(10),i.length<=n)?i:e.toExponential(5)}function Yk(e){var n=sf(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function zl(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),i;return n>=-4&&n<=-1?i=e.toPrecision(10+n):Math.abs(n)<=9?i=Wk(e):n===10?i=e.toFixed(10).substr(0,12):i=Yk(e),sf(zk(i.toUpperCase()))}function hs(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):zl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return sa(14,jC(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function $k(e,n){n[0]-=581;var i=e.getDay();return e<60&&(i=(i+6)%7),i}function Gk(e,n,i,t){var r="",a=0,o=0,s=i.y,u,m=0;switch(e){case 98:s=i.y+543;case 121:switch(n.length){case 1:case 2:u=s%100,m=2;break;default:u=s%1e4,m=4;break}break;case 109:switch(n.length){case 1:case 2:u=i.m,m=n.length;break;case 3:return Eg[i.m-1][1];case 5:return Eg[i.m-1][0];default:return Eg[i.m-1][2]}break;case 100:switch(n.length){case 1:case 2:u=i.d,m=n.length;break;case 3:return F_[i.q][0];default:return F_[i.q][1]}break;case 104:switch(n.length){case 1:case 2:u=1+(i.H+11)%12,m=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:u=i.H,m=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:u=i.M,m=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return i.u===0&&(n=="s"||n=="ss")?xa(i.S,n.length):(t>=2?o=t===3?1e3:100:o=t===1?10:1,a=Math.round(o*(i.S+i.u)),a>=60*o&&(a=0),n==="s"?a===0?"0":""+a/o:(r=xa(a,2+t),n==="ss"?r.substr(0,2):"."+r.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":u=i.D*24+i.H;break;case"[m]":case"[mm]":u=(i.D*24+i.H)*60+i.M;break;case"[s]":case"[ss]":u=((i.D*24+i.H)*60+i.M)*60+Math.round(i.S+i.u);break;default:throw"bad abstime format: "+n}m=n.length===3?1:2;break;case 101:u=s,m=1;break}var f=m>0?xa(u,m):"";return f}function Vo(e){var n=3;if(e.length<=n)return e;for(var i=e.length%n,t=e.substr(0,i);i!=e.length;i+=n)t+=(t.length>0?",":"")+e.substr(i,n);return t}var zC=/%/g;function Hk(e,n,i){var t=n.replace(zC,""),r=n.length-t.length;return eo(e,t,i*Math.pow(10,2*r))+ei("%",r)}function qk(e,n,i){for(var t=n.length-1;n.charCodeAt(t-1)===44;)--t;return eo(e,n.substr(0,t),i/Math.pow(10,3*(n.length-t)))}function WC(e,n){var i,t=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+WC(e,-n);var r=e.indexOf(".");r===-1&&(r=e.indexOf("E"));var a=Math.floor(Math.log(n)*Math.LOG10E)%r;if(a<0&&(a+=r),i=(n/Math.pow(10,a)).toPrecision(t+1+(r+a)%r),i.indexOf("e")===-1){var o=Math.floor(Math.log(n)*Math.LOG10E);for(i.indexOf(".")===-1?i=i.charAt(0)+"."+i.substr(1)+"E+"+(o-i.length+a):i+="E+"+(o-a);i.substr(0,2)==="0.";)i=i.charAt(0)+i.substr(2,r)+"."+i.substr(2+r),i=i.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");i=i.replace(/\+-/,"-")}i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,u,m,f){return u+m+f.substr(0,(r+a)%r)+"."+f.substr(a)+"E"})}else i=n.toExponential(t);return e.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),e.match(/E\-/)&&i.match(/e\+/)&&(i=i.replace(/e\+/,"e")),i.replace("e","E")}var YC=/# (\?+)( ?)\/( ?)(\d+)/;function Xk(e,n,i){var t=parseInt(e[4],10),r=Math.round(n*t),a=Math.floor(r/t),o=r-a*t,s=t;return i+(a===0?"":""+a)+" "+(o===0?ei(" ",e[1].length+1+e[4].length):of(o,e[1].length)+e[2]+"/"+e[3]+xa(s,e[4].length))}function Kk(e,n,i){return i+(n===0?"":""+n)+ei(" ",e[1].length+2+e[4].length)}var $C=/^#*0*\.([0#]+)/,GC=/\).*[0#]/,HC=/\(###\) ###\\?-####/;function gr(e){for(var n="",i,t=0;t!=e.length;++t)switch(i=e.charCodeAt(t)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(i)}return n}function N_(e,n){var i=Math.pow(10,n);return""+Math.round(e*i)/i}function B_(e,n){var i=e-Math.floor(e),t=Math.pow(10,n);return n<(""+Math.round(i*t)).length?0:Math.round(i*t)}function Zk(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function Jk(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ta(e,n,i){if(e.charCodeAt(0)===40&&!n.match(GC)){var t=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return i>=0?ta("n",t,i):"("+ta("n",t,-i)+")"}if(n.charCodeAt(n.length-1)===44)return qk(e,n,i);if(n.indexOf("%")!==-1)return Hk(e,n,i);if(n.indexOf("E")!==-1)return WC(n,i);if(n.charCodeAt(0)===36)return"$"+ta(e,n.substr(n.charAt(1)==" "?2:1),i);var r,a,o,s,u=Math.abs(i),m=i<0?"-":"";if(n.match(/^00+$/))return m+Tc(u,n.length);if(n.match(/^[#?]+$/))return r=Tc(i,0),r==="0"&&(r=""),r.length>n.length?r:gr(n.substr(0,n.length-r.length))+r;if(a=n.match(YC))return Xk(a,u,m);if(n.match(/^#+0+$/))return m+Tc(u,n.length-n.indexOf("0"));if(a=n.match($C))return r=N_(i,a[1].length).replace(/^([^\.]+)$/,"$1."+gr(a[1])).replace(/\.$/,"."+gr(a[1])).replace(/\.(\d*)$/,function(v,C){return"."+C+ei("0",gr(a[1]).length-C.length)}),n.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),a=n.match(/^(0*)\.(#*)$/))return m+N_(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=n.match(/^#{1,3},##0(\.?)$/))return m+Vo(Tc(u,0));if(a=n.match(/^#,##0\.([#0]*0)$/))return i<0?"-"+ta(e,n,-i):Vo(""+(Math.floor(i)+Zk(i,a[1].length)))+"."+xa(B_(i,a[1].length),a[1].length);if(a=n.match(/^#,#*,#0/))return ta(e,n.replace(/^#,#*,/,""),i);if(a=n.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Nc(ta(e,n.replace(/[\\-]/g,""),i)),o=0,Nc(Nc(n.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<r.length?r.charAt(o++):v==="0"?"0":""}));if(n.match(HC))return r=ta(e,"##########",i),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var f="";if(a=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=Yu(u,Math.pow(10,o)-1,!1),r=""+m,f=eo("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),r+=f+a[2]+"/"+a[3],f=zu(s[2],o),f.length<a[4].length&&(f=gr(a[4].substr(a[4].length-f.length))+f),r+=f,r;if(a=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=Yu(u,Math.pow(10,o)-1,!0),m+(s[0]||(s[1]?"":"0"))+" "+(s[1]?of(s[1],o)+a[2]+"/"+a[3]+zu(s[2],o):ei(" ",2*o+1+a[2].length+a[3].length));if(a=n.match(/^[#0?]+$/))return r=Tc(i,0),n.length<=r.length?r:gr(n.substr(0,n.length-r.length))+r;if(a=n.match(/^([#0?]+)\.([#0]+)$/)){r=""+i.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var h=n.indexOf(".")-o,_=n.length-r.length-h;return gr(n.substr(0,h)+r+n.substr(n.length-_))}if(a=n.match(/^00,000\.([#0]*0)$/))return o=B_(i,a[1].length),i<0?"-"+ta(e,n,-i):Vo(Jk(i)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?xa(0,3-v.length):"")+v})+"."+xa(o,a[1].length);switch(n){case"###,##0.00":return ta(e,"#,##0.00",i);case"###,###":case"##,###":case"#,###":var y=Vo(Tc(u,0));return y!=="0"?m+y:"";case"###,###.00":return ta(e,"###,##0.00",i).replace(/^0\./,".");case"#,###.00":return ta(e,"#,##0.00",i).replace(/^0\./,".");default:}throw new Error("unsupported format |"+n+"|")}function Qk(e,n,i){for(var t=n.length-1;n.charCodeAt(t-1)===44;)--t;return eo(e,n.substr(0,t),i/Math.pow(10,3*(n.length-t)))}function eE(e,n,i){var t=n.replace(zC,""),r=n.length-t.length;return eo(e,t,i*Math.pow(10,2*r))+ei("%",r)}function qC(e,n){var i,t=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+qC(e,-n);var r=e.indexOf(".");r===-1&&(r=e.indexOf("E"));var a=Math.floor(Math.log(n)*Math.LOG10E)%r;if(a<0&&(a+=r),i=(n/Math.pow(10,a)).toPrecision(t+1+(r+a)%r),!i.match(/[Ee]/)){var o=Math.floor(Math.log(n)*Math.LOG10E);i.indexOf(".")===-1?i=i.charAt(0)+"."+i.substr(1)+"E+"+(o-i.length+a):i+="E+"+(o-a),i=i.replace(/\+-/,"-")}i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,u,m,f){return u+m+f.substr(0,(r+a)%r)+"."+f.substr(a)+"E"})}else i=n.toExponential(t);return e.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),e.match(/E\-/)&&i.match(/e\+/)&&(i=i.replace(/e\+/,"e")),i.replace("e","E")}function Da(e,n,i){if(e.charCodeAt(0)===40&&!n.match(GC)){var t=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return i>=0?Da("n",t,i):"("+Da("n",t,-i)+")"}if(n.charCodeAt(n.length-1)===44)return Qk(e,n,i);if(n.indexOf("%")!==-1)return eE(e,n,i);if(n.indexOf("E")!==-1)return qC(n,i);if(n.charCodeAt(0)===36)return"$"+Da(e,n.substr(n.charAt(1)==" "?2:1),i);var r,a,o,s,u=Math.abs(i),m=i<0?"-":"";if(n.match(/^00+$/))return m+xa(u,n.length);if(n.match(/^[#?]+$/))return r=""+i,i===0&&(r=""),r.length>n.length?r:gr(n.substr(0,n.length-r.length))+r;if(a=n.match(YC))return Kk(a,u,m);if(n.match(/^#+0+$/))return m+xa(u,n.length-n.indexOf("0"));if(a=n.match($C))return r=(""+i).replace(/^([^\.]+)$/,"$1."+gr(a[1])).replace(/\.$/,"."+gr(a[1])),r=r.replace(/\.(\d*)$/,function(v,C){return"."+C+ei("0",gr(a[1]).length-C.length)}),n.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),a=n.match(/^(0*)\.(#*)$/))return m+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=n.match(/^#{1,3},##0(\.?)$/))return m+Vo(""+u);if(a=n.match(/^#,##0\.([#0]*0)$/))return i<0?"-"+Da(e,n,-i):Vo(""+i)+"."+ei("0",a[1].length);if(a=n.match(/^#,#*,#0/))return Da(e,n.replace(/^#,#*,/,""),i);if(a=n.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Nc(Da(e,n.replace(/[\\-]/g,""),i)),o=0,Nc(Nc(n.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<r.length?r.charAt(o++):v==="0"?"0":""}));if(n.match(HC))return r=Da(e,"##########",i),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var f="";if(a=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=Yu(u,Math.pow(10,o)-1,!1),r=""+m,f=eo("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),r+=f+a[2]+"/"+a[3],f=zu(s[2],o),f.length<a[4].length&&(f=gr(a[4].substr(a[4].length-f.length))+f),r+=f,r;if(a=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=Yu(u,Math.pow(10,o)-1,!0),m+(s[0]||(s[1]?"":"0"))+" "+(s[1]?of(s[1],o)+a[2]+"/"+a[3]+zu(s[2],o):ei(" ",2*o+1+a[2].length+a[3].length));if(a=n.match(/^[#0?]+$/))return r=""+i,n.length<=r.length?r:gr(n.substr(0,n.length-r.length))+r;if(a=n.match(/^([#0]+)\.([#0]+)$/)){r=""+i.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var h=n.indexOf(".")-o,_=n.length-r.length-h;return gr(n.substr(0,h)+r+n.substr(n.length-_))}if(a=n.match(/^00,000\.([#0]*0)$/))return i<0?"-"+Da(e,n,-i):Vo(""+i).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?xa(0,3-v.length):"")+v})+"."+xa(0,a[1].length);switch(n){case"###,###":case"##,###":case"#,###":var y=Vo(""+u);return y!=="0"?m+y:"";default:if(n.match(/\.[0#?]*$/))return Da(e,n.slice(0,n.lastIndexOf(".")),i)+gr(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function eo(e,n,i){return(i|0)===i?Da(e,n,i):ta(e,n,i)}function tE(e){for(var n=[],i=!1,t=0,r=0;t<e.length;++t)switch(e.charCodeAt(t)){case 34:i=!i;break;case 95:case 42:case 92:++t;break;case 59:n[n.length]=e.substr(r,t-r),r=t+1}if(n[n.length]=e.substr(r),i===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var XC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Yc(e){for(var n=0,i="",t="";n<e.length;)switch(i=e.charAt(n)){case"G":Wu(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++n;break;case"[":for(t=i;e.charAt(n++)!=="]"&&n<e.length;)t+=e.charAt(n);if(t.match(XC))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(i=e.charAt(++n))>-1||i=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===i;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function nE(e,n,i,t){for(var r=[],a="",o=0,s="",u="t",m,f,h,_="H";o<e.length;)switch(s=e.charAt(o)){case"G":if(!Wu(e,o))throw new Error("unrecognized character "+s+" in "+e);r[r.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(h=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(h);r[r.length]={t:"t",v:a},++o;break;case"\\":var y=e.charAt(++o),v=y==="("||y===")"?y:"t";r[r.length]={t:v,v:y},++o;break;case"_":r[r.length]={t:"t",v:" "},o+=2;break;case"@":r[r.length]={t:"T",v:n},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(m==null&&(m=us(n,i,e.charAt(o+1)==="2"),m==null))return"";r[r.length]={t:"X",v:e.substr(o,2)},u=s,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||m==null&&(m=us(n,i),m==null))return"";for(a=s;++o<e.length&&e.charAt(o).toLowerCase()===s;)a+=s;s==="m"&&u.toLowerCase()==="h"&&(s="M"),s==="h"&&(s=_),r[r.length]={t:s,v:a},u=s;break;case"A":case"a":case"\u4E0A":var C={t:s,v:s};if(m==null&&(m=us(n,i)),e.substr(o,3).toUpperCase()==="A/P"?(m!=null&&(C.v=m.H>=12?"P":"A"),C.t="T",_="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(m!=null&&(C.v=m.H>=12?"PM":"AM"),C.t="T",o+=5,_="h"):e.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(m!=null&&(C.v=m.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),C.t="T",o+=5,_="h"):(C.t="t",++o),m==null&&C.t==="T")return"";r[r.length]=C,u=s;break;case"[":for(a=s;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(XC)){if(m==null&&(m=us(n,i),m==null))return"";r[r.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Yc(e)||(r[r.length]={t:"t",v:a}));break;case".":if(m!=null){for(a=s;++o<e.length&&(s=e.charAt(o))==="0";)a+=s;r[r.length]={t:"s",v:a};break}case"0":case"#":for(a=s;++o<e.length&&"0#?.,E+-%".indexOf(s=e.charAt(o))>-1;)a+=s;r[r.length]={t:"n",v:a};break;case"?":for(a=s;e.charAt(++o)===s;)a+=s;r[r.length]={t:s,v:a},u=s;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":r[r.length]={t:t===1?"t":s,v:s},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=s;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);r[r.length]={t:"D",v:a};break;case" ":r[r.length]={t:s,v:s},++o;break;case"$":r[r.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(s)===-1)throw new Error("unrecognized character "+s+" in "+e);r[r.length]={t:"t",v:s},++o;break}var P=0,D=0,T;for(o=r.length-1,u="t";o>=0;--o)switch(r[o].t){case"h":case"H":r[o].t=_,u="h",P<1&&(P=1);break;case"s":(T=r[o].v.match(/\.0+$/))&&(D=Math.max(D,T[0].length-1)),P<3&&(P=3);case"d":case"y":case"M":case"e":u=r[o].t;break;case"m":u==="s"&&(r[o].t="M",P<2&&(P=2));break;case"X":break;case"Z":P<1&&r[o].v.match(/[Hh]/)&&(P=1),P<2&&r[o].v.match(/[Mm]/)&&(P=2),P<3&&r[o].v.match(/[Ss]/)&&(P=3)}switch(P){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var I="",K;for(o=0;o<r.length;++o)switch(r[o].t){case"t":case"T":case" ":case"D":break;case"X":r[o].v="",r[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[o].v=Gk(r[o].t.charCodeAt(0),r[o].v,m,D),r[o].t="t";break;case"n":case"?":for(K=o+1;r[K]!=null&&((s=r[K].t)==="?"||s==="D"||(s===" "||s==="t")&&r[K+1]!=null&&(r[K+1].t==="?"||r[K+1].t==="t"&&r[K+1].v==="/")||r[o].t==="("&&(s===" "||s==="n"||s===")")||s==="t"&&(r[K].v==="/"||r[K].v===" "&&r[K+1]!=null&&r[K+1].t=="?"));)r[o].v+=r[K].v,r[K]={v:"",t:";"},++K;I+=r[o].v,o=K-1;break;case"G":r[o].t="t",r[o].v=hs(n,i);break}var ee="",k,O;if(I.length>0){I.charCodeAt(0)==40?(k=n<0&&I.charCodeAt(0)===45?-n:n,O=eo("n",I,k)):(k=n<0&&t>1?-n:n,O=eo("n",I,k),k<0&&r[0]&&r[0].t=="t"&&(O=O.substr(1),r[0].v="-"+r[0].v)),K=O.length-1;var R=r.length;for(o=0;o<r.length;++o)if(r[o]!=null&&r[o].t!="t"&&r[o].v.indexOf(".")>-1){R=o;break}var U=r.length;if(R===r.length&&O.indexOf("E")===-1){for(o=r.length-1;o>=0;--o)r[o]==null||"n?".indexOf(r[o].t)===-1||(K>=r[o].v.length-1?(K-=r[o].v.length,r[o].v=O.substr(K+1,r[o].v.length)):K<0?r[o].v="":(r[o].v=O.substr(0,K+1),K=-1),r[o].t="t",U=o);K>=0&&U<r.length&&(r[U].v=O.substr(0,K+1)+r[U].v)}else if(R!==r.length&&O.indexOf("E")===-1){for(K=O.indexOf(".")-1,o=R;o>=0;--o)if(!(r[o]==null||"n?".indexOf(r[o].t)===-1)){for(f=r[o].v.indexOf(".")>-1&&o===R?r[o].v.indexOf(".")-1:r[o].v.length-1,ee=r[o].v.substr(f+1);f>=0;--f)K>=0&&(r[o].v.charAt(f)==="0"||r[o].v.charAt(f)==="#")&&(ee=O.charAt(K--)+ee);r[o].v=ee,r[o].t="t",U=o}for(K>=0&&U<r.length&&(r[U].v=O.substr(0,K+1)+r[U].v),K=O.indexOf(".")+1,o=R;o<r.length;++o)if(!(r[o]==null||"n?(".indexOf(r[o].t)===-1&&o!==R)){for(f=r[o].v.indexOf(".")>-1&&o===R?r[o].v.indexOf(".")+1:0,ee=r[o].v.substr(0,f);f<r[o].v.length;++f)K<O.length&&(ee+=O.charAt(K++));r[o].v=ee,r[o].t="t",U=o}}}for(o=0;o<r.length;++o)r[o]!=null&&"n?".indexOf(r[o].t)>-1&&(k=t>1&&n<0&&o>0&&r[o-1].v==="-"?-n:n,r[o].v=eo(r[o].t,r[o].v,k),r[o].t="t");var Q="";for(o=0;o!==r.length;++o)r[o]!=null&&(Q+=r[o].v);return Q}var L_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function V_(e,n){if(n==null)return!1;var i=parseFloat(n[2]);switch(n[1]){case"=":if(e==i)return!0;break;case">":if(e>i)return!0;break;case"<":if(e<i)return!0;break;case"<>":if(e!=i)return!0;break;case">=":if(e>=i)return!0;break;case"<=":if(e<=i)return!0;break}return!1}function iE(e,n){var i=tE(e),t=i.length,r=i[t-1].indexOf("@");if(t<4&&r>-1&&--t,i.length>4)throw new Error("cannot find right format for |"+i.join("|")+"|");if(typeof n!="number")return[4,i.length===4||r>-1?i[i.length-1]:"@"];switch(i.length){case 1:i=r>-1?["General","General","General",i[0]]:[i[0],i[0],i[0],"@"];break;case 2:i=r>-1?[i[0],i[0],i[0],i[1]]:[i[0],i[1],i[0],"@"];break;case 3:i=r>-1?[i[0],i[1],i[0],i[2]]:[i[0],i[1],i[2],"@"];break;case 4:break}var a=n>0?i[0]:n<0?i[1]:i[2];if(i[0].indexOf("[")===-1&&i[1].indexOf("[")===-1)return[t,a];if(i[0].match(/\[[=<>]/)!=null||i[1].match(/\[[=<>]/)!=null){var o=i[0].match(L_),s=i[1].match(L_);return V_(n,o)?[t,i[0]]:V_(n,s)?[t,i[1]]:[t,i[o!=null&&s!=null?2:1]]}return[t,a]}function sa(e,n,i){i==null&&(i={});var t="";switch(typeof e){case"string":e=="m/d/yy"&&i.dateNF?t=i.dateNF:t=e;break;case"number":e==14&&i.dateNF?t=i.dateNF:t=(i.table!=null?i.table:Ct)[e],t==null&&(t=i.table&&i.table[R_[e]]||Ct[R_[e]]),t==null&&(t=Vk[e]||"General");break}if(Wu(t,0))return hs(n,i);n instanceof Date&&(n=jC(n,i.date1904));var r=iE(t,n);if(Wu(r[1]))return hs(n,i);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return nE(r[1],n,i,r[0])}function to(e,n){if(typeof n!="number"){n=+n||-1;for(var i=0;i<392;++i){if(Ct[i]==null){n<0&&(n=i);continue}if(Ct[i]==e){n=i;break}}n<0&&(n=391)}return Ct[n]=e,n}function nm(e){for(var n=0;n!=392;++n)e[n]!==void 0&&to(e[n],n)}function $c(){Ct=Lk()}var rE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},KC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function aE(e){var n=typeof e=="number"?Ct[e]:e;return n=n.replace(KC,"(\\d+)"),new RegExp("^"+n+"$")}function oE(e,n,i){var t=-1,r=-1,a=-1,o=-1,s=-1,u=-1;(n.match(KC)||[]).forEach(function(h,_){var y=parseInt(i[_+1],10);switch(h.toLowerCase().charAt(0)){case"y":t=y;break;case"d":a=y;break;case"h":o=y;break;case"s":u=y;break;case"m":o>=0?s=y:r=y;break}}),u>=0&&s==-1&&r>=0&&(s=r,r=-1);var m=(""+(t>=0?t:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var f=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&s==-1&&u==-1?m:t==-1&&r==-1&&a==-1?f:m+"T"+f}var sE=function(){var e={};e.version="1.2.0";function n(){for(var O=0,R=new Array(256),U=0;U!=256;++U)O=U,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,R[U]=O;return typeof Int32Array<"u"?new Int32Array(R):R}var i=n();function t(O){var R=0,U=0,Q=0,re=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Q=0;Q!=256;++Q)re[Q]=O[Q];for(Q=0;Q!=256;++Q)for(U=O[Q],R=256+Q;R<4096;R+=256)U=re[R]=U>>>8^O[U&255];var ie=[];for(Q=1;Q!=16;++Q)ie[Q-1]=typeof Int32Array<"u"?re.subarray(Q*256,Q*256+256):re.slice(Q*256,Q*256+256);return ie}var r=t(i),a=r[0],o=r[1],s=r[2],u=r[3],m=r[4],f=r[5],h=r[6],_=r[7],y=r[8],v=r[9],C=r[10],P=r[11],D=r[12],T=r[13],I=r[14];function K(O,R){for(var U=R^-1,Q=0,re=O.length;Q<re;)U=U>>>8^i[(U^O.charCodeAt(Q++))&255];return~U}function ee(O,R){for(var U=R^-1,Q=O.length-15,re=0;re<Q;)U=I[O[re++]^U&255]^T[O[re++]^U>>8&255]^D[O[re++]^U>>16&255]^P[O[re++]^U>>>24]^C[O[re++]]^v[O[re++]]^y[O[re++]]^_[O[re++]]^h[O[re++]]^f[O[re++]]^m[O[re++]]^u[O[re++]]^s[O[re++]]^o[O[re++]]^a[O[re++]]^i[O[re++]];for(Q+=15;re<Q;)U=U>>>8^i[(U^O[re++])&255];return~U}function k(O,R){for(var U=R^-1,Q=0,re=O.length,ie=0,Pe=0;Q<re;)ie=O.charCodeAt(Q++),ie<128?U=U>>>8^i[(U^ie)&255]:ie<2048?(U=U>>>8^i[(U^(192|ie>>6&31))&255],U=U>>>8^i[(U^(128|ie&63))&255]):ie>=55296&&ie<57344?(ie=(ie&1023)+64,Pe=O.charCodeAt(Q++)&1023,U=U>>>8^i[(U^(240|ie>>8&7))&255],U=U>>>8^i[(U^(128|ie>>2&63))&255],U=U>>>8^i[(U^(128|Pe>>6&15|(ie&3)<<4))&255],U=U>>>8^i[(U^(128|Pe&63))&255]):(U=U>>>8^i[(U^(224|ie>>12&15))&255],U=U>>>8^i[(U^(128|ie>>6&63))&255],U=U>>>8^i[(U^(128|ie&63))&255]);return~U}return e.table=i,e.bstr=K,e.buf=ee,e.str=k,e}(),ft=function(){var n={};n.version="1.2.1";function i(E,L){for(var F=E.split("/"),B=L.split("/"),V=0,W=0,me=Math.min(F.length,B.length);V<me;++V){if(W=F[V].length-B[V].length)return W;if(F[V]!=B[V])return F[V]<B[V]?-1:1}return F.length-B.length}function t(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:t(E.slice(0,-1));var L=E.lastIndexOf("/");return L===-1?E:E.slice(0,L+1)}function r(E){if(E.charAt(E.length-1)=="/")return r(E.slice(0,-1));var L=E.lastIndexOf("/");return L===-1?E:E.slice(L+1)}function a(E,L){typeof L=="string"&&(L=new Date(L));var F=L.getHours();F=F<<6|L.getMinutes(),F=F<<5|L.getSeconds()>>>1,E.write_shift(2,F);var B=L.getFullYear()-1980;B=B<<4|L.getMonth()+1,B=B<<5|L.getDate(),E.write_shift(2,B)}function o(E){var L=E.read_shift(2)&65535,F=E.read_shift(2)&65535,B=new Date,V=F&31;F>>>=5;var W=F&15;F>>>=4,B.setMilliseconds(0),B.setFullYear(F+1980),B.setMonth(W-1),B.setDate(V);var me=L&31;L>>>=5;var Ce=L&63;return L>>>=6,B.setHours(L),B.setMinutes(Ce),B.setSeconds(me<<1),B}function s(E){$i(E,0);for(var L={},F=0;E.l<=E.length-4;){var B=E.read_shift(2),V=E.read_shift(2),W=E.l+V,me={};switch(B){case 21589:F=E.read_shift(1),F&1&&(me.mtime=E.read_shift(4)),V>5&&(F&2&&(me.atime=E.read_shift(4)),F&4&&(me.ctime=E.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}E.l=W,L[B]=me}return L}var u;function m(){return u||(u={})}function f(E,L){if(E[0]==80&&E[1]==75)return Ua(E,L);if((E[0]|32)==109&&(E[1]|32)==105)return Qc(E,L);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var F=3,B=512,V=0,W=0,me=0,Ce=0,ge=0,fe=[],he=E.slice(0,512);$i(he,0);var Ne=h(he);switch(F=Ne[0],F){case 3:B=512;break;case 4:B=4096;break;case 0:if(Ne[1]==0)return Ua(E,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}B!==512&&(he=E.slice(0,B),$i(he,28));var Ue=E.slice(0,B);_(he,F);var tt=he.read_shift(4,"i");if(F===3&&tt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+tt);he.l+=4,me=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),Ce=he.read_shift(4,"i"),V=he.read_shift(4,"i"),ge=he.read_shift(4,"i"),W=he.read_shift(4,"i");for(var je=-1,Ye=0;Ye<109&&(je=he.read_shift(4,"i"),!(je<0));++Ye)fe[Ye]=je;var nt=y(E,B);P(ge,W,nt,B,fe);var hn=T(nt,me,fe,B);hn[me].name="!Directory",V>0&&Ce!==Pe&&(hn[Ce].name="!MiniFAT"),hn[fe[0]].name="!FAT",hn.fat_addrs=fe,hn.ssz=B;var Hi={},Yn=[],qi=[],Ko=[];I(me,hn,nt,Yn,V,Hi,qi,Ce),v(qi,Ko,Yn),Yn.shift();var Zo={FileIndex:qi,FullPaths:Ko};return L&&L.raw&&(Zo.raw={header:Ue,sectors:nt}),Zo}function h(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(Re,"Header Signature: "),E.l+=16;var L=E.read_shift(2,"u");return[E.read_shift(2,"u"),L]}function _(E,L){var F=9;switch(E.l+=2,F=E.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function y(E,L){for(var F=Math.ceil(E.length/L)-1,B=[],V=1;V<F;++V)B[V-1]=E.slice(V*L,(V+1)*L);return B[F-1]=E.slice(F*L),B}function v(E,L,F){for(var B=0,V=0,W=0,me=0,Ce=0,ge=F.length,fe=[],he=[];B<ge;++B)fe[B]=he[B]=B,L[B]=F[B];for(;Ce<he.length;++Ce)B=he[Ce],V=E[B].L,W=E[B].R,me=E[B].C,fe[B]===B&&(V!==-1&&fe[V]!==V&&(fe[B]=fe[V]),W!==-1&&fe[W]!==W&&(fe[B]=fe[W])),me!==-1&&(fe[me]=B),V!==-1&&B!=fe[B]&&(fe[V]=fe[B],he.lastIndexOf(V)<Ce&&he.push(V)),W!==-1&&B!=fe[B]&&(fe[W]=fe[B],he.lastIndexOf(W)<Ce&&he.push(W));for(B=1;B<ge;++B)fe[B]===B&&(W!==-1&&fe[W]!==W?fe[B]=fe[W]:V!==-1&&fe[V]!==V&&(fe[B]=fe[V]));for(B=1;B<ge;++B)if(E[B].type!==0){if(Ce=B,Ce!=fe[Ce])do Ce=fe[Ce],L[B]=L[Ce]+"/"+L[B];while(Ce!==0&&fe[Ce]!==-1&&Ce!=fe[Ce]);fe[B]=-1}for(L[0]+="/",B=1;B<ge;++B)E[B].type!==2&&(L[B]+="/")}function C(E,L,F){for(var B=E.start,V=E.size,W=[],me=B;F&&V>0&&me>=0;)W.push(L.slice(me*ie,me*ie+ie)),V-=ie,me=ds(F,me*4);return W.length===0?ye(0):Ui(W).slice(0,E.size)}function P(E,L,F,B,V){var W=Pe;if(E===Pe){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var me=F[E],Ce=(B>>>2)-1;if(!me)return;for(var ge=0;ge<Ce&&(W=ds(me,ge*4))!==Pe;++ge)V.push(W);P(ds(me,B-4),L-1,F,B,V)}}function D(E,L,F,B,V){var W=[],me=[];V||(V=[]);var Ce=B-1,ge=0,fe=0;for(ge=L;ge>=0;){V[ge]=!0,W[W.length]=ge,me.push(E[ge]);var he=F[Math.floor(ge*4/B)];if(fe=ge*4&Ce,B<4+fe)throw new Error("FAT boundary crossed: "+ge+" 4 "+B);if(!E[he])break;ge=ds(E[he],fe)}return{nodes:W,data:Z_([me])}}function T(E,L,F,B){var V=E.length,W=[],me=[],Ce=[],ge=[],fe=B-1,he=0,Ne=0,Ue=0,tt=0;for(he=0;he<V;++he)if(Ce=[],Ue=he+L,Ue>=V&&(Ue-=V),!me[Ue]){ge=[];var je=[];for(Ne=Ue;Ne>=0;){je[Ne]=!0,me[Ne]=!0,Ce[Ce.length]=Ne,ge.push(E[Ne]);var Ye=F[Math.floor(Ne*4/B)];if(tt=Ne*4&fe,B<4+tt)throw new Error("FAT boundary crossed: "+Ne+" 4 "+B);if(!E[Ye]||(Ne=ds(E[Ye],tt),je[Ne]))break}W[Ue]={nodes:Ce,data:Z_([ge])}}return W}function I(E,L,F,B,V,W,me,Ce){for(var ge=0,fe=B.length?2:0,he=L[E].data,Ne=0,Ue=0,tt;Ne<he.length;Ne+=128){var je=he.slice(Ne,Ne+128);$i(je,64),Ue=je.read_shift(2),tt=om(je,0,Ue-fe),B.push(tt);var Ye={name:tt,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0},nt=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);nt!==0&&(Ye.ct=K(je,je.l-8));var hn=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);hn!==0&&(Ye.mt=K(je,je.l-8)),Ye.start=je.read_shift(4,"i"),Ye.size=je.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=Pe,Ye.name=""),Ye.type===5?(ge=Ye.start,V>0&&ge!==Pe&&(L[ge].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",L[Ye.start]===void 0&&(L[Ye.start]=D(F,Ye.start,L.fat_addrs,L.ssz)),L[Ye.start].name=Ye.name,Ye.content=L[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:ge!==Pe&&Ye.start!==Pe&&L[ge]&&(Ye.content=C(Ye,L[ge].data,(L[Ce]||{}).data))),Ye.content&&$i(Ye.content,0),W[tt]=Ye,me.push(Ye)}}function K(E,L){return new Date((Vi(E,L+4)/1e7*Math.pow(2,32)+Vi(E,L)/1e7-11644473600)*1e3)}function ee(E,L){return m(),f(u.readFileSync(E),L)}function k(E,L){var F=L&&L.type;switch(F||$t&&Buffer.isBuffer(E)&&(F="buffer"),F||"base64"){case"file":return ee(E,L);case"base64":return f(Vr(jr(E)),L);case"binary":return f(Vr(E),L)}return f(E,L)}function O(E,L){var F=L||{},B=F.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=B+"/",E.FileIndex[0]={name:B,type:5}),F.CLSID&&(E.FileIndex[0].clsid=F.CLSID),R(E)}function R(E){var L="Sh33tJ5";if(!ft.find(E,"/"+L)){var F=ye(4);F[0]=55,F[1]=F[3]=50,F[2]=54,E.FileIndex.push({name:L,type:2,content:F,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+L),U(E)}}function U(E,L){O(E);for(var F=!1,B=!1,V=E.FullPaths.length-1;V>=0;--V){var W=E.FileIndex[V];switch(W.type){case 0:B?F=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(W.R*W.L*W.C)&&(F=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!L)){var me=new Date(1987,1,19),Ce=0,ge=Object.create?Object.create(null):{},fe=[];for(V=0;V<E.FullPaths.length;++V)ge[E.FullPaths[V]]=!0,E.FileIndex[V].type!==0&&fe.push([E.FullPaths[V],E.FileIndex[V]]);for(V=0;V<fe.length;++V){var he=t(fe[V][0]);B=ge[he],B||(fe.push([he,{name:r(he).replace("/",""),type:1,clsid:Be,ct:me,mt:me,content:null}]),ge[he]=!0)}for(fe.sort(function(tt,je){return i(tt[0],je[0])}),E.FullPaths=[],E.FileIndex=[],V=0;V<fe.length;++V)E.FullPaths[V]=fe[V][0],E.FileIndex[V]=fe[V][1];for(V=0;V<fe.length;++V){var Ne=E.FileIndex[V],Ue=E.FullPaths[V];if(Ne.name=r(Ue).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||Be,V===0)Ne.C=fe.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Ue.slice(-1)=="/"){for(Ce=V+1;Ce<fe.length&&t(E.FullPaths[Ce])!=Ue;++Ce);for(Ne.C=Ce>=fe.length?-1:Ce,Ce=V+1;Ce<fe.length&&t(E.FullPaths[Ce])!=t(Ue);++Ce);Ne.R=Ce>=fe.length?-1:Ce,Ne.type=1}else t(E.FullPaths[V+1]||"")==t(Ue)&&(Ne.R=V+1),Ne.type=2}}}function Q(E,L){var F=L||{};if(F.fileType=="mad")return un(E,F);switch(U(E),F.fileType){case"zip":return As(E,F)}var B=function(tt){for(var je=0,Ye=0,nt=0;nt<tt.FileIndex.length;++nt){var hn=tt.FileIndex[nt];if(hn.content){var Hi=hn.content.length;Hi>0&&(Hi<4096?je+=Hi+63>>6:Ye+=Hi+511>>9)}}for(var Yn=tt.FullPaths.length+3>>2,qi=je+7>>3,Ko=je+127>>7,Zo=qi+Ye+Yn+Ko,ja=Zo+127>>7,tl=ja<=109?0:Math.ceil((ja-109)/127);Zo+ja+tl+127>>7>ja;)tl=++ja<=109?0:Math.ceil((ja-109)/127);var ua=[1,tl,ja,Ko,Yn,Ye,je,0];return tt.FileIndex[0].size=je<<6,ua[7]=(tt.FileIndex[0].start=ua[0]+ua[1]+ua[2]+ua[3]+ua[4]+ua[5])+(ua[6]+7>>3),ua}(E),V=ye(B[7]<<9),W=0,me=0;{for(W=0;W<8;++W)V.write_shift(1,xe[W]);for(W=0;W<8;++W)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),W=0;W<3;++W)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,B[2]),V.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:Pe),V.write_shift(4,B[3]),V.write_shift(-4,B[1]?B[0]-1:Pe),V.write_shift(4,B[1]),W=0;W<109;++W)V.write_shift(-4,W<B[2]?B[1]+W:-1)}if(B[1])for(me=0;me<B[1];++me){for(;W<236+me*127;++W)V.write_shift(-4,W<B[2]?B[1]+W:-1);V.write_shift(-4,me===B[1]-1?Pe:me+1)}var Ce=function(tt){for(me+=tt;W<me-1;++W)V.write_shift(-4,W+1);tt&&(++W,V.write_shift(-4,Pe))};for(me=W=0,me+=B[1];W<me;++W)V.write_shift(-4,we.DIFSECT);for(me+=B[2];W<me;++W)V.write_shift(-4,we.FATSECT);Ce(B[3]),Ce(B[4]);for(var ge=0,fe=0,he=E.FileIndex[0];ge<E.FileIndex.length;++ge)he=E.FileIndex[ge],he.content&&(fe=he.content.length,!(fe<4096)&&(he.start=me,Ce(fe+511>>9)));for(Ce(B[6]+7>>3);V.l&511;)V.write_shift(-4,we.ENDOFCHAIN);for(me=W=0,ge=0;ge<E.FileIndex.length;++ge)he=E.FileIndex[ge],he.content&&(fe=he.content.length,!(!fe||fe>=4096)&&(he.start=me,Ce(fe+63>>6)));for(;V.l&511;)V.write_shift(-4,we.ENDOFCHAIN);for(W=0;W<B[4]<<2;++W){var Ne=E.FullPaths[W];if(!Ne||Ne.length===0){for(ge=0;ge<17;++ge)V.write_shift(4,0);for(ge=0;ge<3;++ge)V.write_shift(4,-1);for(ge=0;ge<12;++ge)V.write_shift(4,0);continue}he=E.FileIndex[W],W===0&&(he.start=he.size?he.start-1:Pe);var Ue=W===0&&F.root||he.name;if(fe=2*(Ue.length+1),V.write_shift(64,Ue,"utf16le"),V.write_shift(2,fe),V.write_shift(1,he.type),V.write_shift(1,he.color),V.write_shift(-4,he.L),V.write_shift(-4,he.R),V.write_shift(-4,he.C),he.clsid)V.write_shift(16,he.clsid,"hex");else for(ge=0;ge<4;++ge)V.write_shift(4,0);V.write_shift(4,he.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,he.start),V.write_shift(4,he.size),V.write_shift(4,0)}for(W=1;W<E.FileIndex.length;++W)if(he=E.FileIndex[W],he.size>=4096)if(V.l=he.start+1<<9,$t&&Buffer.isBuffer(he.content))he.content.copy(V,V.l,0,he.size),V.l+=he.size+511&-512;else{for(ge=0;ge<he.size;++ge)V.write_shift(1,he.content[ge]);for(;ge&511;++ge)V.write_shift(1,0)}for(W=1;W<E.FileIndex.length;++W)if(he=E.FileIndex[W],he.size>0&&he.size<4096)if($t&&Buffer.isBuffer(he.content))he.content.copy(V,V.l,0,he.size),V.l+=he.size+63&-64;else{for(ge=0;ge<he.size;++ge)V.write_shift(1,he.content[ge]);for(;ge&63;++ge)V.write_shift(1,0)}if($t)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function re(E,L){var F=E.FullPaths.map(function(ge){return ge.toUpperCase()}),B=F.map(function(ge){var fe=ge.split("/");return fe[fe.length-(ge.slice(-1)=="/"?2:1)]}),V=!1;L.charCodeAt(0)===47?(V=!0,L=F[0].slice(0,-1)+L):V=L.indexOf("/")!==-1;var W=L.toUpperCase(),me=V===!0?F.indexOf(W):B.indexOf(W);if(me!==-1)return E.FileIndex[me];var Ce=!W.match(Tl);for(W=W.replace(ar,""),Ce&&(W=W.replace(Tl,"!")),me=0;me<F.length;++me)if((Ce?F[me].replace(Tl,"!"):F[me]).replace(ar,"")==W||(Ce?B[me].replace(Tl,"!"):B[me]).replace(ar,"")==W)return E.FileIndex[me];return null}var ie=64,Pe=-2,Re="d0cf11e0a1b11ae1",xe=[208,207,17,224,161,177,26,225],Be="00000000000000000000000000000000",we={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Pe,FREESECT:-1,HEADER_SIGNATURE:Re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Be,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function $e(E,L,F){m();var B=Q(E,F);u.writeFileSync(L,B)}function Se(E){for(var L=new Array(E.length),F=0;F<E.length;++F)L[F]=String.fromCharCode(E[F]);return L.join("")}function Ae(E,L){var F=Q(E,L);switch(L&&L.type||"buffer"){case"file":return m(),u.writeFileSync(L.filename,F),F;case"binary":return typeof F=="string"?F:Se(F);case"base64":return jl(typeof F=="string"?F:Se(F));case"buffer":if($t)return Buffer.isBuffer(F)?F:ro(F);case"array":return typeof F=="string"?Vr(F):F}return F}var ce;function Y(E){try{var L=E.InflateRaw,F=new L;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)ce=E;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function te(E,L){if(!ce)return g0(E,L);var F=ce.InflateRaw,B=new F,V=B._processChunk(E.slice(E.l),B._finishFlushFlag);return E.l+=B.bytesRead,V}function Z(E){return ce?ce.deflateRawSync(E):xt(E)}var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(E){var L=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(L>>16|L>>8|L)&255}for(var Me=typeof Uint8Array<"u",_e=Me?new Uint8Array(256):[],it=0;it<256;++it)_e[it]=ke(it);function j(E,L){var F=_e[E&255];return L<=8?F>>>8-L:(F=F<<8|_e[E>>8&255],L<=16?F>>>16-L:(F=F<<8|_e[E>>16&255],F>>>24-L))}function st(E,L){var F=L&7,B=L>>>3;return(E[B]|(F<=6?0:E[B+1]<<8))>>>F&3}function qe(E,L){var F=L&7,B=L>>>3;return(E[B]|(F<=5?0:E[B+1]<<8))>>>F&7}function bt(E,L){var F=L&7,B=L>>>3;return(E[B]|(F<=4?0:E[B+1]<<8))>>>F&15}function Ze(E,L){var F=L&7,B=L>>>3;return(E[B]|(F<=3?0:E[B+1]<<8))>>>F&31}function Fe(E,L){var F=L&7,B=L>>>3;return(E[B]|(F<=1?0:E[B+1]<<8))>>>F&127}function Tt(E,L,F){var B=L&7,V=L>>>3,W=(1<<F)-1,me=E[V]>>>B;return F<8-B||(me|=E[V+1]<<8-B,F<16-B)||(me|=E[V+2]<<16-B,F<24-B)||(me|=E[V+3]<<24-B),me&W}function an(E,L,F){var B=L&7,V=L>>>3;return B<=5?E[V]|=(F&7)<<B:(E[V]|=F<<B&255,E[V+1]=(F&7)>>8-B),L+3}function Sn(E,L,F){var B=L&7,V=L>>>3;return F=(F&1)<<B,E[V]|=F,L+1}function zi(E,L,F){var B=L&7,V=L>>>3;return F<<=B,E[V]|=F&255,F>>>=8,E[V+1]=F,L+8}function Nn(E,L,F){var B=L&7,V=L>>>3;return F<<=B,E[V]|=F&255,F>>>=8,E[V+1]=F&255,E[V+2]=F>>>8,L+16}function Xn(E,L){var F=E.length,B=2*F>L?2*F:L+5,V=0;if(F>=L)return E;if($t){var W=A_(B);if(E.copy)E.copy(W);else for(;V<E.length;++V)W[V]=E[V];return W}else if(Me){var me=new Uint8Array(B);if(me.set)me.set(E);else for(;V<F;++V)me[V]=E[V];return me}return E.length=B,E}function Ot(E){for(var L=new Array(E),F=0;F<E;++F)L[F]=0;return L}function Mn(E,L,F){var B=1,V=0,W=0,me=0,Ce=0,ge=E.length,fe=Me?new Uint16Array(32):Ot(32);for(W=0;W<32;++W)fe[W]=0;for(W=ge;W<F;++W)E[W]=0;ge=E.length;var he=Me?new Uint16Array(ge):Ot(ge);for(W=0;W<ge;++W)fe[V=E[W]]++,B<V&&(B=V),he[W]=0;for(fe[0]=0,W=1;W<=B;++W)fe[W+16]=Ce=Ce+fe[W-1]<<1;for(W=0;W<ge;++W)Ce=E[W],Ce!=0&&(he[W]=fe[Ce+16]++);var Ne=0;for(W=0;W<ge;++W)if(Ne=E[W],Ne!=0)for(Ce=j(he[W],B)>>B-Ne,me=(1<<B+4-Ne)-1;me>=0;--me)L[Ce|me<<Ne]=Ne&15|W<<4;return B}var Kn=Me?new Uint16Array(512):Ot(512),pr=Me?new Uint16Array(32):Ot(32);if(!Me){for(var It=0;It<512;++It)Kn[It]=0;for(It=0;It<32;++It)pr[It]=0}(function(){for(var E=[],L=0;L<32;L++)E.push(5);Mn(E,pr,32);var F=[];for(L=0;L<=143;L++)F.push(8);for(;L<=255;L++)F.push(9);for(;L<=279;L++)F.push(7);for(;L<=287;L++)F.push(8);Mn(F,Kn,288)})();var ui=function(){for(var L=Me?new Uint8Array(32768):[],F=0,B=0;F<Oe.length-1;++F)for(;B<Oe[F+1];++B)L[B]=F;for(;B<32768;++B)L[B]=29;var V=Me?new Uint8Array(259):[];for(F=0,B=0;F<de.length-1;++F)for(;B<de[F+1];++B)V[B]=F;function W(Ce,ge){for(var fe=0;fe<Ce.length;){var he=Math.min(65535,Ce.length-fe),Ne=fe+he==Ce.length;for(ge.write_shift(1,+Ne),ge.write_shift(2,he),ge.write_shift(2,~he&65535);he-- >0;)ge[ge.l++]=Ce[fe++]}return ge.l}function me(Ce,ge){for(var fe=0,he=0,Ne=Me?new Uint16Array(32768):[];he<Ce.length;){var Ue=Math.min(65535,Ce.length-he);if(Ue<10){for(fe=an(ge,fe,+(he+Ue==Ce.length)),fe&7&&(fe+=8-(fe&7)),ge.l=fe/8|0,ge.write_shift(2,Ue),ge.write_shift(2,~Ue&65535);Ue-- >0;)ge[ge.l++]=Ce[he++];fe=ge.l*8;continue}fe=an(ge,fe,+(he+Ue==Ce.length)+2);for(var tt=0;Ue-- >0;){var je=Ce[he];tt=(tt<<5^je)&32767;var Ye=-1,nt=0;if((Ye=Ne[tt])&&(Ye|=he&-32768,Ye>he&&(Ye-=32768),Ye<he))for(;Ce[Ye+nt]==Ce[he+nt]&&nt<250;)++nt;if(nt>2){je=V[nt],je<=22?fe=zi(ge,fe,_e[je+1]>>1)-1:(zi(ge,fe,3),fe+=5,zi(ge,fe,_e[je-23]>>5),fe+=3);var hn=je<8?0:je-4>>2;hn>0&&(Nn(ge,fe,nt-de[je]),fe+=hn),je=L[he-Ye],fe=zi(ge,fe,_e[je]>>3),fe-=3;var Hi=je<4?0:je-2>>1;Hi>0&&(Nn(ge,fe,he-Ye-Oe[je]),fe+=Hi);for(var Yn=0;Yn<nt;++Yn)Ne[tt]=he&32767,tt=(tt<<5^Ce[he])&32767,++he;Ue-=nt-1}else je<=143?je=je+48:fe=Sn(ge,fe,1),fe=zi(ge,fe,_e[je]),Ne[tt]=he&32767,++he}fe=zi(ge,fe,0)-1}return ge.l=(fe+7)/8|0,ge.l}return function(ge,fe){return ge.length<8?W(ge,fe):me(ge,fe)}}();function xt(E){var L=ye(50+Math.floor(E.length*1.1)),F=ui(E,L);return L.slice(0,F)}var on=Me?new Uint16Array(32768):Ot(32768),bi=Me?new Uint16Array(32768):Ot(32768),Bn=Me?new Uint16Array(128):Ot(128),hr=1,qo=1;function Em(E,L){var F=Ze(E,L)+257;L+=5;var B=Ze(E,L)+1;L+=5;var V=bt(E,L)+4;L+=4;for(var W=0,me=Me?new Uint8Array(19):Ot(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ge=1,fe=Me?new Uint8Array(8):Ot(8),he=Me?new Uint8Array(8):Ot(8),Ne=me.length,Ue=0;Ue<V;++Ue)me[J[Ue]]=W=qe(E,L),ge<W&&(ge=W),fe[W]++,L+=3;var tt=0;for(fe[0]=0,Ue=1;Ue<=ge;++Ue)he[Ue]=tt=tt+fe[Ue-1]<<1;for(Ue=0;Ue<Ne;++Ue)(tt=me[Ue])!=0&&(Ce[Ue]=he[tt]++);var je=0;for(Ue=0;Ue<Ne;++Ue)if(je=me[Ue],je!=0){tt=_e[Ce[Ue]]>>8-je;for(var Ye=(1<<7-je)-1;Ye>=0;--Ye)Bn[tt|Ye<<je]=je&7|Ue<<3}var nt=[];for(ge=1;nt.length<F+B;)switch(tt=Bn[Fe(E,L)],L+=tt&7,tt>>>=3){case 16:for(W=3+st(E,L),L+=2,tt=nt[nt.length-1];W-- >0;)nt.push(tt);break;case 17:for(W=3+qe(E,L),L+=3;W-- >0;)nt.push(0);break;case 18:for(W=11+Fe(E,L),L+=7;W-- >0;)nt.push(0);break;default:nt.push(tt),ge<tt&&(ge=tt);break}var hn=nt.slice(0,F),Hi=nt.slice(F);for(Ue=F;Ue<286;++Ue)hn[Ue]=0;for(Ue=B;Ue<30;++Ue)Hi[Ue]=0;return hr=Mn(hn,on,286),qo=Mn(Hi,bi,30),L}function Is(E,L){if(E[0]==3&&!(E[1]&3))return[Uo(L),2];for(var F=0,B=0,V=A_(L||1<<18),W=0,me=V.length>>>0,Ce=0,ge=0;!(B&1);){if(B=qe(E,F),F+=3,B>>>1)B>>1==1?(Ce=9,ge=5):(F=Em(E,F),Ce=hr,ge=qo);else{F&7&&(F+=8-(F&7));var fe=E[F>>>3]|E[(F>>>3)+1]<<8;if(F+=32,fe>0)for(!L&&me<W+fe&&(V=Xn(V,W+fe),me=V.length);fe-- >0;)V[W++]=E[F>>>3],F+=8;continue}for(;;){!L&&me<W+32767&&(V=Xn(V,W+32767),me=V.length);var he=Tt(E,F,Ce),Ne=B>>>1==1?Kn[he]:on[he];if(F+=Ne&15,Ne>>>=4,!(Ne>>>8&255))V[W++]=Ne;else{if(Ne==256)break;Ne-=257;var Ue=Ne<8?0:Ne-4>>2;Ue>5&&(Ue=0);var tt=W+de[Ne];Ue>0&&(tt+=Tt(E,F,Ue),F+=Ue),he=Tt(E,F,ge),Ne=B>>>1==1?pr[he]:bi[he],F+=Ne&15,Ne>>>=4;var je=Ne<4?0:Ne-2>>1,Ye=Oe[Ne];for(je>0&&(Ye+=Tt(E,F,je),F+=je),!L&&me<tt&&(V=Xn(V,tt+100),me=V.length);W<tt;)V[W]=V[W-Ye],++W}}}return L?[V,F+7>>>3]:[V.slice(0,W),F+7>>>3]}function g0(E,L){var F=E.slice(E.l||0),B=Is(F,L);return E.l+=B[1],B[0]}function co(E,L){if(E)typeof console<"u"&&console.error(L);else throw new Error(L)}function Ua(E,L){var F=E;$i(F,0);var B=[],V=[],W={FileIndex:B,FullPaths:V};O(W,{root:L.root});for(var me=F.length-4;(F[me]!=80||F[me+1]!=75||F[me+2]!=5||F[me+3]!=6)&&me>=0;)--me;F.l=me+4,F.l+=4;var Ce=F.read_shift(2);F.l+=6;var ge=F.read_shift(4);for(F.l=ge,me=0;me<Ce;++me){F.l+=20;var fe=F.read_shift(4),he=F.read_shift(4),Ne=F.read_shift(2),Ue=F.read_shift(2),tt=F.read_shift(2);F.l+=8;var je=F.read_shift(4),Ye=s(F.slice(F.l+Ne,F.l+Ne+Ue));F.l+=Ne+Ue+tt;var nt=F.l;F.l=je+4,Jc(F,fe,he,W,Ye),F.l=nt}return W}function Jc(E,L,F,B,V){E.l+=2;var W=E.read_shift(2),me=E.read_shift(2),Ce=o(E);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var ge=E.read_shift(4),fe=E.read_shift(4),he=E.read_shift(4),Ne=E.read_shift(2),Ue=E.read_shift(2),tt="",je=0;je<Ne;++je)tt+=String.fromCharCode(E[E.l++]);if(Ue){var Ye=s(E.slice(E.l,E.l+Ue));(Ye[21589]||{}).mt&&(Ce=Ye[21589].mt),((V||{})[21589]||{}).mt&&(Ce=V[21589].mt)}E.l+=Ue;var nt=E.slice(E.l,E.l+fe);switch(me){case 8:nt=te(E,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var hn=!1;W&8&&(ge=E.read_shift(4),ge==134695760&&(ge=E.read_shift(4),hn=!0),fe=E.read_shift(4),he=E.read_shift(4)),fe!=L&&co(hn,"Bad compressed size: "+L+" != "+fe),he!=F&&co(hn,"Bad uncompressed size: "+F+" != "+he),el(B,tt,nt,{unsafe:!0,mt:Ce})}function As(E,L){var F=L||{},B=[],V=[],W=ye(1),me=F.compression?8:0,Ce=0,ge=!1;ge&&(Ce|=8);var fe=0,he=0,Ne=0,Ue=0,tt=E.FullPaths[0],je=tt,Ye=E.FileIndex[0],nt=[],hn=0;for(fe=1;fe<E.FullPaths.length;++fe)if(je=E.FullPaths[fe].slice(tt.length),Ye=E.FileIndex[fe],!(!Ye.size||!Ye.content||je=="Sh33tJ5")){var Hi=Ne,Yn=ye(je.length);for(he=0;he<je.length;++he)Yn.write_shift(1,je.charCodeAt(he)&127);Yn=Yn.slice(0,Yn.l),nt[Ue]=sE.buf(Ye.content,0);var qi=Ye.content;me==8&&(qi=Z(qi)),W=ye(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,Ce),W.write_shift(2,me),Ye.mt?a(W,Ye.mt):W.write_shift(4,0),W.write_shift(-4,Ce&8?0:nt[Ue]),W.write_shift(4,Ce&8?0:qi.length),W.write_shift(4,Ce&8?0:Ye.content.length),W.write_shift(2,Yn.length),W.write_shift(2,0),Ne+=W.length,B.push(W),Ne+=Yn.length,B.push(Yn),Ne+=qi.length,B.push(qi),Ce&8&&(W=ye(12),W.write_shift(-4,nt[Ue]),W.write_shift(4,qi.length),W.write_shift(4,Ye.content.length),Ne+=W.l,B.push(W)),W=ye(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,Ce),W.write_shift(2,me),W.write_shift(4,0),W.write_shift(-4,nt[Ue]),W.write_shift(4,qi.length),W.write_shift(4,Ye.content.length),W.write_shift(2,Yn.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,Hi),hn+=W.l,V.push(W),hn+=Yn.length,V.push(Yn),++Ue}return W=ye(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,Ue),W.write_shift(2,Ue),W.write_shift(4,hn),W.write_shift(4,Ne),W.write_shift(2,0),Ui([Ui(B),Ui(V),W])}var Ke={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Tm(E,L){if(E.ctype)return E.ctype;var F=E.name||"",B=F.match(/\.([^\.]+)$/);return B&&Ke[B[1]]||L&&(B=(F=L).match(/[\.\\]([^\.\\])+$/),B&&Ke[B[1]])?Ke[B[1]]:"application/octet-stream"}function Im(E){for(var L=jl(E),F=[],B=0;B<L.length;B+=76)F.push(L.slice(B,B+76));return F.join(`\r
`)+`\r
`}function la(E){var L=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var he=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],B=L.split(`\r
`),V=0;V<B.length;++V){var W=B[V];if(W.length==0){F.push("");continue}for(var me=0;me<W.length;){var Ce=76,ge=W.slice(me,me+Ce);ge.charAt(Ce-1)=="="?Ce--:ge.charAt(Ce-2)=="="?Ce-=2:ge.charAt(Ce-3)=="="&&(Ce-=3),ge=W.slice(me,me+Ce),me+=Ce,me<W.length&&(ge+="="),F.push(ge)}}return F.join(`\r
`)}function xr(E){for(var L=[],F=0;F<E.length;++F){for(var B=E[F];F<=E.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+E[++F];L.push(B)}for(var V=0;V<L.length;++V)L[V]=L[V].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return Vr(L.join(`\r
`))}function Gt(E,L,F){for(var B="",V="",W="",me,Ce=0;Ce<10;++Ce){var ge=L[Ce];if(!ge||ge.match(/^\s*$/))break;var fe=ge.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":B=fe[2].trim();break;case"content-type":W=fe[2].trim();break;case"content-transfer-encoding":V=fe[2].trim();break}}switch(++Ce,V.toLowerCase()){case"base64":me=Vr(jr(L.slice(Ce).join("")));break;case"quoted-printable":me=xr(L.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var he=el(E,B.slice(F.length),me,{unsafe:!0});W&&(he.ctype=W)}function Qc(E,L){if(Se(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=L&&L.root||"",B=($t&&Buffer.isBuffer(E)?E.toString("binary"):Se(E)).split(`\r
`),V=0,W="";for(V=0;V<B.length;++V)if(W=B[V],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),F||(F=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),W.slice(0,F.length)!=F););var me=(B[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var Ce="--"+(me[1]||""),ge=[],fe=[],he={FileIndex:ge,FullPaths:fe};O(he);var Ne,Ue=0;for(V=0;V<B.length;++V){var tt=B[V];tt!==Ce&&tt!==Ce+"--"||(Ue++&&Gt(he,B.slice(Ne,V),F),Ne=V)}return he}function un(E,L){var F=L||{},B=F.boundary||"SheetJS";B="------="+B;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],W=E.FullPaths[0],me=W,Ce=E.FileIndex[0],ge=1;ge<E.FullPaths.length;++ge)if(me=E.FullPaths[ge].slice(W.length),Ce=E.FileIndex[ge],!(!Ce.size||!Ce.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(nt){return"_x"+nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(nt){return"_u"+nt.charCodeAt(0).toString(16)+"_"});for(var fe=Ce.content,he=$t&&Buffer.isBuffer(fe)?fe.toString("binary"):Se(fe),Ne=0,Ue=Math.min(1024,he.length),tt=0,je=0;je<=Ue;++je)(tt=he.charCodeAt(je))>=32&&tt<128&&++Ne;var Ye=Ne>=Ue*4/5;V.push(B),V.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+me),V.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),V.push("Content-Type: "+Tm(Ce,me)),V.push(""),V.push(Ye?la(he):Im(he))}return V.push(B+`--\r
`),V.join(`\r
`)}function Xo(E){var L={};return O(L,E),L}function el(E,L,F,B){var V=B&&B.unsafe;V||O(E);var W=!V&&ft.find(E,L);if(!W){var me=E.FullPaths[0];L.slice(0,me.length)==me?me=L:(me.slice(-1)!="/"&&(me+="/"),me=(me+L).replace("//","/")),W={name:r(L),type:2},E.FileIndex.push(W),E.FullPaths.push(me),V||ft.utils.cfb_gc(E)}return W.content=F,W.size=F?F.length:0,B&&(B.CLSID&&(W.clsid=B.CLSID),B.mt&&(W.mt=B.mt),B.ct&&(W.ct=B.ct)),W}function Ds(E,L){O(E);var F=ft.find(E,L);if(F){for(var B=0;B<E.FileIndex.length;++B)if(E.FileIndex[B]==F)return E.FileIndex.splice(B,1),E.FullPaths.splice(B,1),!0}return!1}function Si(E,L,F){O(E);var B=ft.find(E,L);if(B){for(var V=0;V<E.FileIndex.length;++V)if(E.FileIndex[V]==B)return E.FileIndex[V].name=r(F),E.FullPaths[V]=F,!0}return!1}function da(E){U(E,!0)}return n.find=re,n.read=k,n.parse=f,n.write=Ae,n.writeFile=$e,n.utils={cfb_new:Xo,cfb_add:el,cfb_del:Ds,cfb_mov:Si,cfb_gc:da,ReadShift:Al,CheckField:fv,prep_blob:$i,bconcat:Ui,use_zlib:Y,_deflateRaw:xt,_inflateRaw:g0,consts:we},n}(),Fc;function cE(e){return typeof e=="string"?tm(e):Array.isArray(e)?Fk(e):e}function e0(e,n,i){if(typeof Fc<"u"&&Fc.writeFileSync)return i?Fc.writeFileSync(e,n,i):Fc.writeFileSync(e,n);if(typeof Deno<"u"){if(i&&typeof n=="string")switch(i){case"utf8":n=new TextEncoder(i).encode(n);break;case"binary":n=tm(n);break;default:throw new Error("Unsupported encoding "+i)}return Deno.writeFileSync(e,n)}var t=i=="utf8"?Ra(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(t,e);if(typeof Blob<"u"){var r=new Blob([cE(t)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,e);if(typeof saveAs<"u")return saveAs(r,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var s=File(e);return s.open("w"),s.encoding="binary",Array.isArray(n)&&(n=Yo(n)),s.write(n),s.close(),n}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function lE(e){if(typeof Fc<"u")return Fc.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var i=n.read();return n.close(),i}catch(t){if(!t.message||!t.message.match(/onstruct/))throw t}throw new Error("Cannot access file "+e)}function ii(e){for(var n=Object.keys(e),i=[],t=0;t<n.length;++t)Object.prototype.hasOwnProperty.call(e,n[t])&&i.push(n[t]);return i}function U_(e,n){for(var i=[],t=ii(e),r=0;r!==t.length;++r)i[e[t[r]][n]]==null&&(i[e[t[r]][n]]=t[r]);return i}function im(e){for(var n=[],i=ii(e),t=0;t!==i.length;++t)n[e[i[t]]]=i[t];return n}function rm(e){for(var n=[],i=ii(e),t=0;t!==i.length;++t)n[e[i[t]]]=parseInt(i[t],10);return n}function dE(e){for(var n=[],i=ii(e),t=0;t!==i.length;++t)n[e[i[t]]]==null&&(n[e[i[t]]]=[]),n[e[i[t]]].push(i[t]);return n}var $u=new Date(1899,11,30,0,0,0);function wi(e,n){var i=e.getTime();n&&(i-=1462*24*60*60*1e3);var t=$u.getTime()+(e.getTimezoneOffset()-$u.getTimezoneOffset())*6e4;return(i-t)/(24*60*60*1e3)}var ZC=new Date,uE=$u.getTime()+(ZC.getTimezoneOffset()-$u.getTimezoneOffset())*6e4,j_=ZC.getTimezoneOffset();function am(e){var n=new Date;return n.setTime(e*24*60*60*1e3+uE),n.getTimezoneOffset()!==j_&&n.setTime(n.getTime()+(n.getTimezoneOffset()-j_)*6e4),n}function mE(e){var n=0,i=0,t=!1,r=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=r.length;++a)if(r[a]){switch(i=1,a>3&&(t=!0),r[a].slice(r[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[a].slice(r[a].length-1));case"D":i*=24;case"H":i*=60;case"M":if(t)i*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}n+=i*parseInt(r[a],10)}return n}var z_=new Date("2017-02-19T19:06:09.000Z"),JC=isNaN(z_.getFullYear())?new Date("2/19/17"):z_,gE=JC.getFullYear()==2017;function Fn(e,n){var i=new Date(e);if(gE)return n>0?i.setTime(i.getTime()+i.getTimezoneOffset()*60*1e3):n<0&&i.setTime(i.getTime()-i.getTimezoneOffset()*60*1e3),i;if(e instanceof Date)return e;if(JC.getFullYear()==1917&&!isNaN(i.getFullYear())){var t=i.getFullYear();return e.indexOf(""+t)>-1||i.setFullYear(i.getFullYear()+100),i}var r=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function xs(e,n){if($t&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return Ra(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ra(VC(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return Ra(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ra(new TextDecoder("utf-16be").decode(e.slice(2)))}var i={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return i[a]||a})}catch{}for(var t=[],r=0;r!=e.length;++r)t.push(String.fromCharCode(e[r]));return t.join("")}function Rn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=Rn(e[i]));return n}function ei(e,n){for(var i="";i.length<n;)i+=e;return i}function _a(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var i=1,t=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return i*=100,""});return!isNaN(n=Number(t))||(t=t.replace(/[(](.*)[)]/,function(r,a){return i=-i,a}),!isNaN(n=Number(t)))?n/i:n}var fE=["january","february","march","april","may","june","july","august","september","october","november","december"];function jc(e){var n=new Date(e),i=new Date(NaN),t=n.getYear(),r=n.getMonth(),a=n.getDate();if(isNaN(a))return i;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&fE.indexOf(o)==-1)return i}else if(o.match(/[a-z]/))return i;return t<0||t>8099?i:(r>0||a>1)&&t!=101?n:e.match(/[^-0-9:,\/\\]/)?i:n}var pE=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(i,t,r){if(e||typeof t=="string")return i.split(t);for(var a=i.split(t),o=[a[0]],s=1;s<a.length;++s)o.push(r),o.push(a[s]);return o}}();function QC(e){return e?e.content&&e.type?xs(e.content,!0):e.data?El(e.data):e.asNodeBuffer&&$t?El(e.asNodeBuffer().toString("binary")):e.asBinary?El(e.asBinary()):e._data&&e._data.getContent?El(xs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ev(e){if(!e)return null;if(e.data)return Wg(e.data);if(e.asNodeBuffer&&$t)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?Wg(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function hE(e){return e&&e.name.slice(-4)===".bin"?ev(e):QC(e)}function ra(e,n){for(var i=e.FullPaths||ii(e.files),t=n.toLowerCase().replace(/[\/]/g,"\\"),r=t.replace(/\\/g,"/"),a=0;a<i.length;++a){var o=i[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(t==o||r==o)return e.files?e.files[i[a]]:e.FileIndex[a]}return null}function cf(e,n){var i=ra(e,n);if(i==null)throw new Error("Cannot find file "+n+" in zip");return i}function Ci(e,n,i){if(!i)return hE(cf(e,n));if(!n)return null;try{return Ci(e,n)}catch{return null}}function Ur(e,n,i){if(!i)return QC(cf(e,n));if(!n)return null;try{return Ur(e,n)}catch{return null}}function tv(e,n,i){if(!i)return ev(cf(e,n));if(!n)return null;try{return tv(e,n)}catch{return null}}function W_(e){for(var n=e.FullPaths||ii(e.files),i=[],t=0;t<n.length;++t)n[t].slice(-1)!="/"&&i.push(n[t].replace(/^Root Entry[\/]/,""));return i.sort()}function Rt(e,n,i){if(e.FullPaths){if(typeof i=="string"){var t;return $t?t=ro(i):t=Rk(i),ft.utils.cfb_add(e,n,t)}ft.utils.cfb_add(e,n,i)}else e.file(n,i)}function lf(){return ft.utils.cfb_new()}function nv(e,n){switch(n.type){case"base64":return ft.read(e,{type:"base64"});case"binary":return ft.read(e,{type:"binary"});case"buffer":case"array":return ft.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function Il(e,n){if(e.charAt(0)=="/")return e.slice(1);var i=n.split("/");n.slice(-1)!="/"&&i.pop();for(var t=e.split("/");t.length!==0;){var r=t.shift();r===".."?i.pop():r!=="."&&i.push(r)}return i.join("/")}var di=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,xE=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Y_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_E=/<[^>]*>/g,cr=di.match(Y_)?Y_:_E,CE=/<\w*:/,vE=/<(\/?)\w+:/;function St(e,n,i){for(var t={},r=0,a=0;r!==e.length&&!((a=e.charCodeAt(r))===32||a===10||a===13);++r);if(n||(t[0]=e.slice(0,r)),r===e.length)return t;var o=e.match(xE),s=0,u="",m=0,f="",h="",_=1;if(o)for(m=0;m!=o.length;++m){for(h=o[m],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(f=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(_=(r=h.charCodeAt(a+1))==34||r==39?1:0,u=h.slice(a+1+_,h.length-_),s=0;s!=f.length&&f.charCodeAt(s)!==58;++s);if(s===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),t[f]=u,i||(t[f.toLowerCase()]=u);else{var y=(s===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(s+1);if(t[y]&&f.slice(s-3,s)=="ext")continue;t[y]=u,i||(t[y.toLowerCase()]=u)}}return t}function Ba(e){return e.replace(vE,"<$1")}var iv={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},df=im(iv),nn=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function i(t){var r=t+"",a=r.indexOf("<![CDATA[");if(a==-1)return r.replace(e,function(s,u){return iv[s]||String.fromCharCode(parseInt(u,s.indexOf("x")>-1?16:10))||s}).replace(n,function(s,u){return String.fromCharCode(parseInt(u,16))});var o=r.indexOf("]]>");return i(r.slice(0,a))+r.slice(a+9,o)+i(r.slice(o+3))}}(),uf=/[&<>'"]/g,bE=/[\u0000-\u0008\u000b-\u001f]/g;function Cn(e){var n=e+"";return n.replace(uf,function(i){return df[i]}).replace(bE,function(i){return"_x"+("000"+i.charCodeAt(0).toString(16)).slice(-4)+"_"})}function $_(e){return Cn(e).replace(/ /g,"_x0020_")}var rv=/[\u0000-\u001f]/g;function mf(e){var n=e+"";return n.replace(uf,function(i){return df[i]}).replace(/\n/g,"<br/>").replace(rv,function(i){return"&#x"+("000"+i.charCodeAt(0).toString(16)).slice(-4)+";"})}function yE(e){var n=e+"";return n.replace(uf,function(i){return df[i]}).replace(rv,function(i){return"&#x"+i.charCodeAt(0).toString(16).toUpperCase()+";"})}var G_=function(){var e=/&#(\d+);/g;function n(i,t){return String.fromCharCode(parseInt(t,10))}return function(t){return t.replace(e,n)}}();function ME(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Dn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Tg(e){for(var n="",i=0,t=0,r=0,a=0,o=0,s=0;i<e.length;){if(t=e.charCodeAt(i++),t<128){n+=String.fromCharCode(t);continue}if(r=e.charCodeAt(i++),t>191&&t<224){o=(t&31)<<6,o|=r&63,n+=String.fromCharCode(o);continue}if(a=e.charCodeAt(i++),t<240){n+=String.fromCharCode((t&15)<<12|(r&63)<<6|a&63);continue}o=e.charCodeAt(i++),s=((t&7)<<18|(r&63)<<12|(a&63)<<6|o&63)-65536,n+=String.fromCharCode(55296+(s>>>10&1023)),n+=String.fromCharCode(56320+(s&1023))}return n}function H_(e){var n=Uo(2*e.length),i,t,r=1,a=0,o=0,s;for(t=0;t<e.length;t+=r)r=1,(s=e.charCodeAt(t))<128?i=s:s<224?(i=(s&31)*64+(e.charCodeAt(t+1)&63),r=2):s<240?(i=(s&15)*4096+(e.charCodeAt(t+1)&63)*64+(e.charCodeAt(t+2)&63),r=3):(r=4,i=(s&7)*262144+(e.charCodeAt(t+1)&63)*4096+(e.charCodeAt(t+2)&63)*64+(e.charCodeAt(t+3)&63),i-=65536,o=55296+(i>>>10&1023),i=56320+(i&1023)),o!==0&&(n[a++]=o&255,n[a++]=o>>>8,o=0),n[a++]=i%256,n[a++]=i>>>8;return n.slice(0,a).toString("ucs2")}function q_(e){return ro(e,"binary").toString("utf8")}var Au="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",yn=$t&&(q_(Au)==Tg(Au)&&q_||H_(Au)==Tg(Au)&&H_)||Tg,Ra=$t?function(e){return ro(e,"utf8").toString("binary")}:function(e){for(var n=[],i=0,t=0,r=0;i<e.length;)switch(t=e.charCodeAt(i++),!0){case t<128:n.push(String.fromCharCode(t));break;case t<2048:n.push(String.fromCharCode(192+(t>>6))),n.push(String.fromCharCode(128+(t&63)));break;case(t>=55296&&t<57344):t-=55296,r=e.charCodeAt(i++)-56320+(t<<10),n.push(String.fromCharCode(240+(r>>18&7))),n.push(String.fromCharCode(144+(r>>12&63))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)));break;default:n.push(String.fromCharCode(224+(t>>12))),n.push(String.fromCharCode(128+(t>>6&63))),n.push(String.fromCharCode(128+(t&63)))}return n.join("")},Wl=function(){var e={};return function(i,t){var r=i+"|"+(t||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+i+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+i+">",t||"")}}(),av=function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(i){for(var t=i.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<e.length;++r)t=t.replace(e[r][0],e[r][1]);return t}}(),wE=function(){var e={};return function(i){return e[i]!==void 0?e[i]:e[i]=new RegExp("<(?:vt:)?"+i+">([\\s\\S]*?)</(?:vt:)?"+i+">","g")}}(),SE=/<\/?(?:vt:)?variant>/g,PE=/<(?:vt:)([^>]*)>([\s\S]*)</;function X_(e,n){var i=St(e),t=e.match(wE(i.baseType))||[],r=[];if(t.length!=i.size){if(n.WTF)throw new Error("unexpected vector length "+t.length+" != "+i.size);return r}return t.forEach(function(a){var o=a.replace(SE,"").match(PE);o&&r.push({v:yn(o[2]),t:o[1]})}),r}var ov=/(^\s|\s$|\n)/;function Gi(e,n){return"<"+e+(n.match(ov)?' xml:space="preserve"':"")+">"+n+"</"+e+">"}function Yl(e){return ii(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function ze(e,n,i){return"<"+e+(i!=null?Yl(i):"")+(n!=null?(n.match(ov)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function Yg(e,n){try{return e.toISOString().replace(/\.\d*/,"")}catch(i){if(n)throw i}return""}function OE(e,n){switch(typeof e){case"string":var i=ze("vt:lpwstr",Cn(e));return n&&(i=i.replace(/&quot;/g,"_x0022_")),i;case"number":return ze((e|0)==e?"vt:i4":"vt:r8",Cn(String(e)));case"boolean":return ze("vt:bool",e?"true":"false")}if(e instanceof Date)return ze("vt:filetime",Yg(e));throw new Error("Unable to serialize "+e)}function gf(e){if($t&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return yn(Yo(af(e)));throw new Error("Bad input format: expected Buffer or string")}var $l=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Mi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ys=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Lr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function kE(e,n){for(var i=1-2*(e[n+7]>>>7),t=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),r=e[n+6]&15,a=5;a>=0;--a)r=r*256+e[n+a];return t==2047?r==0?i*(1/0):NaN:(t==0?t=-1022:(t-=1023,r+=Math.pow(2,52)),i*Math.pow(2,t-52)*r)}function EE(e,n,i){var t=(n<0||1/n==-1/0?1:0)<<7,r=0,a=0,o=t?-n:n;isFinite(o)?o==0?r=a=0:(r=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-r),r<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?r=-1022:(a-=Math.pow(2,52),r+=1023)):(r=2047,a=isNaN(n)?26985:0);for(var s=0;s<=5;++s,a/=256)e[i+s]=a&255;e[i+6]=(r&15)<<4|a&15,e[i+7]=r>>4|t}var K_=function(e){for(var n=[],i=10240,t=0;t<e[0].length;++t)if(e[0][t])for(var r=0,a=e[0][t].length;r<a;r+=i)n.push.apply(n,e[0][t].slice(r,r+i));return n},Z_=$t?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:ro(n)})):K_(e)}:K_,J_=function(e,n,i){for(var t=[],r=n;r<i;r+=2)t.push(String.fromCharCode(Qa(e,r)));return t.join("").replace(ar,"")},om=$t?function(e,n,i){return Buffer.isBuffer(e)?e.toString("utf16le",n,i).replace(ar,""):J_(e,n,i)}:J_,Q_=function(e,n,i){for(var t=[],r=n;r<n+i;++r)t.push(("0"+e[r].toString(16)).slice(-2));return t.join("")},sv=$t?function(e,n,i){return Buffer.isBuffer(e)?e.toString("hex",n,n+i):Q_(e,n,i)}:Q_,eC=function(e,n,i){for(var t=[],r=n;r<i;r++)t.push(String.fromCharCode(Dc(e,r)));return t.join("")},Gc=$t?function(n,i,t){return Buffer.isBuffer(n)?n.toString("utf8",i,t):eC(n,i,t)}:eC,cv=function(e,n){var i=Vi(e,n);return i>0?Gc(e,n+4,n+4+i-1):""},ff=cv,lv=function(e,n){var i=Vi(e,n);return i>0?Gc(e,n+4,n+4+i-1):""},pf=lv,dv=function(e,n){var i=2*Vi(e,n);return i>0?Gc(e,n+4,n+4+i-1):""},hf=dv,uv=function(n,i){var t=Vi(n,i);return t>0?om(n,i+4,i+4+t):""},xf=uv,mv=function(e,n){var i=Vi(e,n);return i>0?Gc(e,n+4,n+4+i):""},_f=mv,gv=function(e,n){return kE(e,n)},Gu=gv,Cf=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};$t&&(ff=function(n,i){if(!Buffer.isBuffer(n))return cv(n,i);var t=n.readUInt32LE(i);return t>0?n.toString("utf8",i+4,i+4+t-1):""},pf=function(n,i){if(!Buffer.isBuffer(n))return lv(n,i);var t=n.readUInt32LE(i);return t>0?n.toString("utf8",i+4,i+4+t-1):""},hf=function(n,i){if(!Buffer.isBuffer(n))return dv(n,i);var t=2*n.readUInt32LE(i);return n.toString("utf16le",i+4,i+4+t-1)},xf=function(n,i){if(!Buffer.isBuffer(n))return uv(n,i);var t=n.readUInt32LE(i);return n.toString("utf16le",i+4,i+4+t)},_f=function(n,i){if(!Buffer.isBuffer(n))return mv(n,i);var t=n.readUInt32LE(i);return n.toString("utf8",i+4,i+4+t)},Gu=function(n,i){return Buffer.isBuffer(n)?n.readDoubleLE(i):gv(n,i)},Cf=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});function TE(){om=function(e,n,i){return pn.utils.decode(1200,e.slice(n,i)).replace(ar,"")},Gc=function(e,n,i){return pn.utils.decode(65001,e.slice(n,i))},ff=function(e,n){var i=Vi(e,n);return i>0?pn.utils.decode(Uc,e.slice(n+4,n+4+i-1)):""},pf=function(e,n){var i=Vi(e,n);return i>0?pn.utils.decode(Na,e.slice(n+4,n+4+i-1)):""},hf=function(e,n){var i=2*Vi(e,n);return i>0?pn.utils.decode(1200,e.slice(n+4,n+4+i-1)):""},xf=function(e,n){var i=Vi(e,n);return i>0?pn.utils.decode(1200,e.slice(n+4,n+4+i)):""},_f=function(e,n){var i=Vi(e,n);return i>0?pn.utils.decode(65001,e.slice(n+4,n+4+i)):""}}typeof pn<"u"&&TE();var Dc=function(e,n){return e[n]},Qa=function(e,n){return e[n+1]*256+e[n]},IE=function(e,n){var i=e[n+1]*256+e[n];return i<32768?i:(65535-i+1)*-1},Vi=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},ds=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},AE=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function Al(e,n){var i="",t,r,a=[],o,s,u,m;switch(n){case"dbcs":if(m=this.l,$t&&Buffer.isBuffer(this))i=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)i+=String.fromCharCode(Qa(this,m)),m+=2;e*=2;break;case"utf8":i=Gc(this,this.l,this.l+e);break;case"utf16le":e*=2,i=om(this,this.l,this.l+e);break;case"wstr":if(typeof pn<"u")i=pn.utils.decode(Na,this.slice(this.l,this.l+2*e));else return Al.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":i=ff(this,this.l),e=4+Vi(this,this.l);break;case"lpstr-cp":i=pf(this,this.l),e=4+Vi(this,this.l);break;case"lpwstr":i=hf(this,this.l),e=4+2*Vi(this,this.l);break;case"lpp4":e=4+Vi(this,this.l),i=xf(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Vi(this,this.l),i=_f(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,i="";(o=Dc(this,this.l+e++))!==0;)a.push(Iu(o));i=a.join("");break;case"_wstr":for(e=0,i="";(o=Qa(this,this.l+e))!==0;)a.push(Iu(o)),e+=2;e+=2,i=a.join("");break;case"dbcs-cont":for(i="",m=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(m)!==-1)return o=Dc(this,m),this.l=m+1,s=Al.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(Iu(Qa(this,m))),m+=2}i=a.join(""),e*=2;break;case"cpstr":if(typeof pn<"u"){i=pn.utils.decode(Na,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(i="",m=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(m)!==-1)return o=Dc(this,m),this.l=m+1,s=Al.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(Iu(Dc(this,m))),m+=1}i=a.join("");break;default:switch(e){case 1:return t=Dc(this,this.l),this.l++,t;case 2:return t=(n==="i"?IE:Qa)(this,this.l),this.l+=2,t;case 4:case-4:return n==="i"||!(this[this.l+3]&128)?(t=(e>0?ds:AE)(this,this.l),this.l+=4,t):(r=Vi(this,this.l),this.l+=4,r);case 8:case-8:if(n==="f")return e==8?r=Gu(this,this.l):r=Gu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:i=sv(this,this.l,e);break}}return this.l+=e,i}var DE=function(e,n,i){e[i]=n&255,e[i+1]=n>>>8&255,e[i+2]=n>>>16&255,e[i+3]=n>>>24&255},FE=function(e,n,i){e[i]=n&255,e[i+1]=n>>8&255,e[i+2]=n>>16&255,e[i+3]=n>>24&255},RE=function(e,n,i){e[i]=n&255,e[i+1]=n>>>8&255};function NE(e,n,i){var t=0,r=0;if(i==="dbcs"){for(r=0;r!=n.length;++r)RE(this,n.charCodeAt(r),this.l+2*r);t=2*n.length}else if(i==="sbcs"){if(typeof pn<"u"&&Uc==874)for(r=0;r!=n.length;++r){var a=pn.utils.encode(Uc,n.charAt(r));this[this.l+r]=a[0]}else for(n=n.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=n.length;++r)this[this.l+r]=n.charCodeAt(r)&255;t=n.length}else if(i==="hex"){for(;r<e;++r)this[this.l++]=parseInt(n.slice(2*r,2*r+2),16)||0;return this}else if(i==="utf16le"){var o=Math.min(this.l+e,this.length);for(r=0;r<Math.min(n.length,e);++r){var s=n.charCodeAt(r);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:t=1,this[this.l]=n&255;break;case 2:t=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:t=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:t=4,DE(this,n,this.l);break;case 8:if(t=8,i==="f"){EE(this,n,this.l);break}case 16:break;case-4:t=4,FE(this,n,this.l);break}return this.l+=t,this}function fv(e,n){var i=sv(this,this.l,e.length>>1);if(i!==e)throw new Error(n+"Expected "+e+" saw "+i);this.l+=e.length>>1}function $i(e,n){e.l=n,e.read_shift=Al,e.chk=fv,e.write_shift=NE}function sr(e,n){e.l+=n}function ye(e){var n=Uo(e);return $i(n,0),n}function ao(e,n,i){if(e){var t,r,a;$i(e,e.l||0);for(var o=e.length,s=0,u=0;e.l<o;){s=e.read_shift(1),s&128&&(s=(s&127)+((e.read_shift(1)&127)<<7));var m=Zl[s]||Zl[65535];for(t=e.read_shift(1),a=t&127,r=1;r<4&&t&128;++r)a+=((t=e.read_shift(1))&127)<<7*r;u=e.l+a;var f=m.f&&m.f(e,a,i);if(e.l=u,n(f,m,s))return}}}function kr(){var e=[],n=$t?256:2048,i=function(m){var f=ye(m);return $i(f,0),f},t=i(n),r=function(){t&&(t.length>t.l&&(t=t.slice(0,t.l),t.l=t.length),t.length>0&&e.push(t),t=null)},a=function(m){return t&&m<t.length-t.l?t:(r(),t=i(Math.max(m+1,n)))},o=function(){return r(),Ui(e)},s=function(m){r(),t=m,t.l==null&&(t.l=t.length),a(n)};return{next:a,push:s,end:o,_bufs:e}}function Ie(e,n,i,t){var r=+n,a;if(!isNaN(r)){t||(t=Zl[r].p||(i||[]).length||0),a=1+(r>=128?1:0)+1,t>=128&&++a,t>=16384&&++a,t>=2097152&&++a;var o=e.next(a);r<=127?o.write_shift(1,r):(o.write_shift(1,(r&127)+128),o.write_shift(1,r>>7));for(var s=0;s!=4;++s)if(t>=128)o.write_shift(1,(t&127)+128),t>>=7;else{o.write_shift(1,t);break}t>0&&Cf(i)&&e.push(i)}}function Dl(e,n,i){var t=Rn(e);if(n.s?(t.cRel&&(t.c+=n.s.c),t.rRel&&(t.r+=n.s.r)):(t.cRel&&(t.c+=n.c),t.rRel&&(t.r+=n.r)),!i||i.biff<12){for(;t.c>=256;)t.c-=256;for(;t.r>=65536;)t.r-=65536}return t}function tC(e,n,i){var t=Rn(e);return t.s=Dl(t.s,n.s,i),t.e=Dl(t.e,n.s,i),t}function Fl(e,n){if(e.cRel&&e.c<0)for(e=Rn(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=Rn(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var i=vt(e);return!e.cRel&&e.cRel!=null&&(i=VE(i)),!e.rRel&&e.rRel!=null&&(i=BE(i)),i}function Ig(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Hn(e.s.c)+":"+(e.e.cRel?"":"$")+Hn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+li(e.s.r)+":"+(e.e.rRel?"":"$")+li(e.e.r):Fl(e.s,n.biff)+":"+Fl(e.e,n.biff)}function vf(e){return parseInt(LE(e),10)-1}function li(e){return""+(e+1)}function BE(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function LE(e){return e.replace(/\$(\d+)$/,"$1")}function bf(e){for(var n=UE(e),i=0,t=0;t!==n.length;++t)i=26*i+n.charCodeAt(t)-64;return i-1}function Hn(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function VE(e){return e.replace(/^([A-Z])/,"$$$1")}function UE(e){return e.replace(/^\$([A-Z])/,"$1")}function jE(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function qn(e){for(var n=0,i=0,t=0;t<e.length;++t){var r=e.charCodeAt(t);r>=48&&r<=57?n=10*n+(r-48):r>=65&&r<=90&&(i=26*i+(r-64))}return{c:i-1,r:n-1}}function vt(e){for(var n=e.c+1,i="";n;n=(n-1)/26|0)i=String.fromCharCode((n-1)%26+65)+i;return i+(e.r+1)}function Er(e){var n=e.indexOf(":");return n==-1?{s:qn(e),e:qn(e)}:{s:qn(e.slice(0,n)),e:qn(e.slice(n+1))}}function Ft(e,n){return typeof n>"u"||typeof n=="number"?Ft(e.s,e.e):(typeof e!="string"&&(e=vt(e)),typeof n!="string"&&(n=vt(n)),e==n?e:e+":"+n)}function rn(e){var n={s:{c:0,r:0},e:{c:0,r:0}},i=0,t=0,r=0,a=e.length;for(i=0;t<a&&!((r=e.charCodeAt(t)-64)<1||r>26);++t)i=26*i+r;for(n.s.c=--i,i=0;t<a&&!((r=e.charCodeAt(t)-48)<0||r>9);++t)i=10*i+r;if(n.s.r=--i,t===a||r!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++t,i=0;t!=a&&!((r=e.charCodeAt(t)-64)<1||r>26);++t)i=26*i+r;for(n.e.c=--i,i=0;t!=a&&!((r=e.charCodeAt(t)-48)<0||r>9);++t)i=10*i+r;return n.e.r=--i,n}function nC(e,n){var i=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=sa(e.z,i?wi(n):n)}catch{}try{return e.w=sa((e.XF||{}).numFmtId||(i?14:0),i?wi(n):n)}catch{return""+n}}function io(e,n,i){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&i&&i.dateNF&&(e.z=i.dateNF),e.t=="e"?oo[e.v]||e.v:n==null?nC(e,e.v):nC(e,n))}function $o(e,n){var i=n&&n.sheet?n.sheet:"Sheet1",t={};return t[i]=e,{SheetNames:[i],Sheets:t}}function pv(e,n,i){var t=i||{},r=e?Array.isArray(e):t.dense;ni!=null&&r==null&&(r=ni);var a=e||(r?[]:{}),o=0,s=0;if(a&&t.origin!=null){if(typeof t.origin=="number")o=t.origin;else{var u=typeof t.origin=="string"?qn(t.origin):t.origin;o=u.r,s=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=rn(a["!ref"]);m.s.c=f.s.c,m.s.r=f.s.r,m.e.c=Math.max(m.e.c,f.e.c),m.e.r=Math.max(m.e.r,f.e.r),o==-1&&(m.e.r=o=f.e.r+1)}for(var h=0;h!=n.length;++h)if(n[h]){if(!Array.isArray(n[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=n[h].length;++_)if(!(typeof n[h][_]>"u")){var y={v:n[h][_]},v=o+h,C=s+_;if(m.s.r>v&&(m.s.r=v),m.s.c>C&&(m.s.c=C),m.e.r<v&&(m.e.r=v),m.e.c<C&&(m.e.c=C),n[h][_]&&typeof n[h][_]=="object"&&!Array.isArray(n[h][_])&&!(n[h][_]instanceof Date))y=n[h][_];else if(Array.isArray(y.v)&&(y.f=n[h][_][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(t.nullError)y.t="e",y.v=0;else if(t.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=t.dateNF||Ct[14],t.cellDates?(y.t="d",y.w=sa(y.z,wi(y.v))):(y.t="n",y.v=wi(y.v),y.w=sa(y.z,y.v))):y.t="s";if(r)a[v]||(a[v]=[]),a[v][C]&&a[v][C].z&&(y.z=a[v][C].z),a[v][C]=y;else{var P=vt({c:C,r:v});a[P]&&a[P].z&&(y.z=a[P].z),a[P]=y}}}return m.s.c<1e7&&(a["!ref"]=Ft(m)),a}function Hc(e,n){return pv(null,e,n)}function zE(e){return e.read_shift(4,"i")}function Ca(e,n){return n||(n=ye(4)),n.write_shift(4,e),n}function or(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function ji(e,n){var i=!1;return n==null&&(i=!0,n=ye(4+2*e.length)),n.write_shift(4,e.length),e.length>0&&n.write_shift(0,e,"dbcs"),i?n.slice(0,n.l):n}function WE(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function YE(e,n){return n||(n=ye(4)),n.write_shift(2,e.ich||0),n.write_shift(2,e.ifnt||0),n}function yf(e,n){var i=e.l,t=e.read_shift(1),r=or(e),a=[],o={t:r,h:r};if(t&1){for(var s=e.read_shift(4),u=0;u!=s;++u)a.push(WE(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=i+n,o}function $E(e,n){var i=!1;return n==null&&(i=!0,n=ye(15+4*e.t.length)),n.write_shift(1,0),ji(e.t,n),i?n.slice(0,n.l):n}var GE=yf;function HE(e,n){var i=!1;return n==null&&(i=!0,n=ye(23+4*e.t.length)),n.write_shift(1,1),ji(e.t,n),n.write_shift(4,1),YE({ich:0,ifnt:0},n),i?n.slice(0,n.l):n}function ca(e){var n=e.read_shift(4),i=e.read_shift(2);return i+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:i}}function Ms(e,n){return n==null&&(n=ye(8)),n.write_shift(-4,e.c),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}function ws(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}function Ss(e,n){return n==null&&(n=ye(4)),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}var qE=or,hv=ji;function Mf(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}function Hu(e,n){var i=!1;return n==null&&(i=!0,n=ye(127)),n.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&n.write_shift(0,e,"dbcs"),i?n.slice(0,n.l):n}var XE=or,$g=Mf,wf=Hu;function Sf(e){var n=e.slice(e.l,e.l+4),i=n[0]&1,t=n[0]&2;e.l+=4;var r=t===0?Gu([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):ds(n,0)>>2;return i?r/100:r}function xv(e,n){n==null&&(n=ye(4));var i=0,t=0,r=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?t=1:r==(r|0)&&r>=-(1<<29)&&r<1<<29&&(t=1,i=1),t)n.write_shift(-4,((i?r:e)<<2)+(i+2));else throw new Error("unsupported RkNumber "+e)}function _v(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}function KE(e,n){return n||(n=ye(16)),n.write_shift(4,e.s.r),n.write_shift(4,e.e.r),n.write_shift(4,e.s.c),n.write_shift(4,e.e.c),n}var Ps=_v,qc=KE;function rr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function _s(e,n){return(n||ye(8)).write_shift(8,e,"f")}function ZE(e){var n={},i=e.read_shift(1),t=i>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),s=e.read_shift(1),u=e.read_shift(1);switch(e.l++,t){case 0:n.auto=1;break;case 1:n.index=r;var m=ms[r];m&&(n.rgb=Hl(m));break;case 2:n.rgb=Hl([o,s,u]);break;case 3:n.theme=r;break}return a!=0&&(n.tint=a>0?a/32767:a/32768),n}function qu(e,n){if(n||(n=ye(8)),!e||e.auto)return n.write_shift(4,0),n.write_shift(4,0),n;e.index!=null?(n.write_shift(1,2),n.write_shift(1,e.index)):e.theme!=null?(n.write_shift(1,6),n.write_shift(1,e.theme)):(n.write_shift(1,5),n.write_shift(1,0));var i=e.tint||0;if(i>0?i*=32767:i<0&&(i*=32768),n.write_shift(2,i),!e.rgb||e.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var t=e.rgb||"FFFFFF";typeof t=="number"&&(t=("000000"+t.toString(16)).slice(-6)),n.write_shift(1,parseInt(t.slice(0,2),16)),n.write_shift(1,parseInt(t.slice(2,4),16)),n.write_shift(1,parseInt(t.slice(4,6),16)),n.write_shift(1,255)}return n}function JE(e){var n=e.read_shift(1);e.l++;var i={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return i}function QE(e,n){n||(n=ye(2));var i=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return n.write_shift(1,i),n.write_shift(1,0),n}function Cv(e,n){var i={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},t=e.read_shift(4);switch(t){case 0:return"";case 4294967295:case 4294967294:return i[e.read_shift(4)]||""}if(t>400)throw new Error("Unsupported Clipboard: "+t.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function eT(e){return Cv(e,1)}function tT(e){return Cv(e,2)}var Pf=2,Or=3,Du=11,iC=12,Xu=19;var Fu=64,nT=65,iT=71;var rT=4108,aT=4126,Li=80,vv=81,oT=[Li,vv],Gg={1:{n:"CodePage",t:Pf},2:{n:"Category",t:Li},3:{n:"PresentationFormat",t:Li},4:{n:"ByteCount",t:Or},5:{n:"LineCount",t:Or},6:{n:"ParagraphCount",t:Or},7:{n:"SlideCount",t:Or},8:{n:"NoteCount",t:Or},9:{n:"HiddenCount",t:Or},10:{n:"MultimediaClipCount",t:Or},11:{n:"ScaleCrop",t:Du},12:{n:"HeadingPairs",t:rT},13:{n:"TitlesOfParts",t:aT},14:{n:"Manager",t:Li},15:{n:"Company",t:Li},16:{n:"LinksUpToDate",t:Du},17:{n:"CharacterCount",t:Or},19:{n:"SharedDoc",t:Du},22:{n:"HyperlinksChanged",t:Du},23:{n:"AppVersion",t:Or,p:"version"},24:{n:"DigSig",t:nT},26:{n:"ContentType",t:Li},27:{n:"ContentStatus",t:Li},28:{n:"Language",t:Li},29:{n:"Version",t:Li},255:{},2147483648:{n:"Locale",t:Xu},2147483651:{n:"Behavior",t:Xu},1919054434:{}},Hg={1:{n:"CodePage",t:Pf},2:{n:"Title",t:Li},3:{n:"Subject",t:Li},4:{n:"Author",t:Li},5:{n:"Keywords",t:Li},6:{n:"Comments",t:Li},7:{n:"Template",t:Li},8:{n:"LastAuthor",t:Li},9:{n:"RevNumber",t:Li},10:{n:"EditTime",t:Fu},11:{n:"LastPrinted",t:Fu},12:{n:"CreatedDate",t:Fu},13:{n:"ModifiedDate",t:Fu},14:{n:"PageCount",t:Or},15:{n:"WordCount",t:Or},16:{n:"CharCount",t:Or},17:{n:"Thumbnail",t:iT},18:{n:"Application",t:Li},19:{n:"DocSecurity",t:Or},255:{},2147483648:{n:"Locale",t:Xu},2147483651:{n:"Behavior",t:Xu},1919054434:{}},rC={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},sT=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function cT(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var lT=cT([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ms=Rn(lT),oo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},bv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},qg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ru={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Of(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dT(e){var n=Of();if(!e||!e.match)return n;var i={};if((e.match(cr)||[]).forEach(function(t){var r=St(t);switch(r[0].replace(CE,"<")){case"<?xml":break;case"<Types":n.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":i[r.Extension]=r.ContentType;break;case"<Override":n[qg[r.ContentType]]!==void 0&&n[qg[r.ContentType]].push(r.PartName);break}}),n.xmlns!==Mi.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=i,delete n.calcchains,n}function yv(e,n){var i=dE(qg),t=[],r;t[t.length]=di,t[t.length]=ze("Types",null,{xmlns:Mi.CT,"xmlns:xsd":Mi.xsd,"xmlns:xsi":Mi.xsi}),t=t.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return ze("Default",null,{Extension:u[0],ContentType:u[1]})}));var a=function(u){e[u]&&e[u].length>0&&(r=e[u][0],t[t.length]=ze("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:Ru[u][n.bookType]||Ru[u].xlsx}))},o=function(u){(e[u]||[]).forEach(function(m){t[t.length]=ze("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:Ru[u][n.bookType]||Ru[u].xlsx})})},s=function(u){(e[u]||[]).forEach(function(m){t[t.length]=ze("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:i[u][0]})})};return a("workbooks"),o("sheets"),o("charts"),s("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("threadedcomments"),s("drawings"),o("metadata"),s("people"),t.length>2&&(t[t.length]="</Types>",t[1]=t[1].replace("/>",">")),t.join("")}var Nt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Gl(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function Rl(e,n){var i={"!id":{}};if(!e)return i;n.charAt(0)!=="/"&&(n="/"+n);var t={};return(e.match(cr)||[]).forEach(function(r){var a=St(r);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var s=a.TargetMode==="External"?a.Target:Il(a.Target,n);i[s]=o,t[a.Id]=o}}),i["!id"]=t,i}function Bc(e){var n=[di,ze("Relationships",null,{xmlns:Mi.RELS})];return ii(e["!id"]).forEach(function(i){n[n.length]=ze("Relationship",null,e["!id"][i])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function _n(e,n,i,t,r,a){if(r||(r={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),n<0)for(n=e["!idx"];e["!id"]["rId"+n];++n);if(e["!idx"]=n+1,r.Id="rId"+n,r.Type=t,r.Target=i,a?r.TargetMode=a:[Nt.HLINK,Nt.XPATH,Nt.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),e["!id"][r.Id])throw new Error("Cannot rewrite rId "+n);return e["!id"][r.Id]=r,e[("/"+r.Target).replace("//","/")]=r,n}var uT="application/vnd.oasis.opendocument.spreadsheet";function mT(e,n){for(var i=gf(e),t,r;t=$l.exec(i);)switch(t[3]){case"manifest":break;case"file-entry":if(r=St(t[0],!1),r.path=="/"&&r.type!==uT)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw t}}function gT(e){var n=[di];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var i=0;i<e.length;++i)n.push('  <manifest:file-entry manifest:full-path="'+e[i][0]+'" manifest:media-type="'+e[i][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function aC(e,n,i){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(i||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function fT(e,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function pT(e){var n=[di];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var i=0;i!=e.length;++i)n.push(aC(e[i][0],e[i][1])),n.push(fT("",e[i][0]));return n.push(aC("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function Mv(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ul.version+"</meta:generator></office:meta></office:document-meta>"}var oa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],hT=function(){for(var e=new Array(oa.length),n=0;n<oa.length;++n){var i=oa[n],t="(?:"+i[0].slice(0,i[0].indexOf(":"))+":)"+i[0].slice(i[0].indexOf(":")+1);e[n]=new RegExp("<"+t+"[^>]*>([\\s\\S]*?)</"+t+">")}return e}();function wv(e){var n={};e=yn(e);for(var i=0;i<oa.length;++i){var t=oa[i],r=e.match(hT[i]);r!=null&&r.length>0&&(n[t[1]]=nn(r[1])),t[2]==="date"&&n[t[1]]&&(n[t[1]]=Fn(n[t[1]]))}return n}function Ag(e,n,i,t,r){r[e]!=null||n==null||n===""||(r[e]=n,n=Cn(n),t[t.length]=i?ze(e,n,i):Gi(e,n))}function Sv(e,n){var i=n||{},t=[di,ze("cp:coreProperties",null,{"xmlns:cp":Mi.CORE_PROPS,"xmlns:dc":Mi.dc,"xmlns:dcterms":Mi.dcterms,"xmlns:dcmitype":Mi.dcmitype,"xmlns:xsi":Mi.xsi})],r={};if(!e&&!i.Props)return t.join("");e&&(e.CreatedDate!=null&&Ag("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Yg(e.CreatedDate,i.WTF),{"xsi:type":"dcterms:W3CDTF"},t,r),e.ModifiedDate!=null&&Ag("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Yg(e.ModifiedDate,i.WTF),{"xsi:type":"dcterms:W3CDTF"},t,r));for(var a=0;a!=oa.length;++a){var o=oa[a],s=i.Props&&i.Props[o[1]]!=null?i.Props[o[1]]:e?e[o[1]]:null;s===!0?s="1":s===!1?s="0":typeof s=="number"&&(s=String(s)),s!=null&&Ag(o[0],s,null,t,r)}return t.length>2&&(t[t.length]="</cp:coreProperties>",t[1]=t[1].replace("/>",">")),t.join("")}var gs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Pv=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ov(e,n,i,t){var r=[];if(typeof e=="string")r=X_(e,t);else for(var a=0;a<e.length;++a)r=r.concat(e[a].map(function(f){return{v:f}}));var o=typeof n=="string"?X_(n,t).map(function(f){return f.v}):n,s=0,u=0;if(o.length>0)for(var m=0;m!==r.length;m+=2){switch(u=+r[m+1].v,r[m].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":i.Worksheets=u,i.SheetNames=o.slice(s,s+u);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":i.NamedRanges=u,i.DefinedNames=o.slice(s,s+u);break;case"Charts":case"Diagramme":i.Chartsheets=u,i.ChartNames=o.slice(s,s+u);break}s+=u}}function xT(e,n,i){var t={};return n||(n={}),e=yn(e),gs.forEach(function(r){var a=(e.match(Wl(r[0]))||[])[1];switch(r[2]){case"string":a&&(n[r[1]]=nn(a));break;case"bool":n[r[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));o&&o.length>0&&(t[r[1]]=o[1]);break}}),t.HeadingPairs&&t.TitlesOfParts&&Ov(t.HeadingPairs,t.TitlesOfParts,n,i),n}function kv(e){var n=[],i=ze;return e||(e={}),e.Application="SheetJS",n[n.length]=di,n[n.length]=ze("Properties",null,{xmlns:Mi.EXT_PROPS,"xmlns:vt":Mi.vt}),gs.forEach(function(t){if(e[t[1]]!==void 0){var r;switch(t[2]){case"string":r=Cn(String(e[t[1]]));break;case"bool":r=e[t[1]]?"true":"false";break}r!==void 0&&(n[n.length]=i(t[0],r))}}),n[n.length]=i("HeadingPairs",i("vt:vector",i("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+i("vt:variant",i("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=i("TitlesOfParts",i("vt:vector",e.SheetNames.map(function(t){return"<vt:lpstr>"+Cn(t)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var _T=/<[^>]+>[^<]*/g;function CT(e,n){var i={},t="",r=e.match(_T);if(r)for(var a=0;a!=r.length;++a){var o=r[a],s=St(o);switch(s[0]){case"<?xml":break;case"<Properties":break;case"<property":t=nn(s.name);break;case"</property>":t=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),m=u[0].slice(4),f=u[1];switch(m){case"lpstr":case"bstr":case"lpwstr":i[t]=nn(f);break;case"bool":i[t]=Dn(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":i[t]=parseInt(f,10);break;case"r4":case"r8":case"decimal":i[t]=parseFloat(f);break;case"filetime":case"date":i[t]=Fn(f);break;case"cy":case"error":i[t]=nn(f);break;default:if(m.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",o,m,u)}}else if(o.slice(0,2)!=="</"){if(n.WTF)throw new Error(o)}}}return i}function Ev(e){var n=[di,ze("Properties",null,{xmlns:Mi.CUST_PROPS,"xmlns:vt":Mi.vt})];if(!e)return n.join("");var i=1;return ii(e).forEach(function(r){++i,n[n.length]=ze("property",OE(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:i,name:Cn(r)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var Xg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Dg;function vT(e,n,i){Dg||(Dg=im(Xg)),n=Dg[n]||n,e[n]=i}function bT(e,n){var i=[];return ii(Xg).map(function(t){for(var r=0;r<oa.length;++r)if(oa[r][1]==t)return oa[r];for(r=0;r<gs.length;++r)if(gs[r][1]==t)return gs[r];throw t}).forEach(function(t){if(e[t[1]]!=null){var r=n&&n.Props&&n.Props[t[1]]!=null?n.Props[t[1]]:e[t[1]];switch(t[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),i.push(Gi(Xg[t[1]]||t[1],r))}}),ze("DocumentProperties",i.join(""),{xmlns:Lr.o})}function yT(e,n){var i=["Worksheets","SheetNames"],t="CustomDocumentProperties",r=[];return e&&ii(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<oa.length;++o)if(a==oa[o][1])return;for(o=0;o<gs.length;++o)if(a==gs[o][1])return;for(o=0;o<i.length;++o)if(a==i[o])return;var s=e[a],u="string";typeof s=="number"?(u="float",s=String(s)):s===!0||s===!1?(u="boolean",s=s?"1":"0"):s=String(s),r.push(ze($_(a),s,{"dt:dt":u}))}}),n&&ii(n).forEach(function(a){if(Object.prototype.hasOwnProperty.call(n,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=n[a],s="string";typeof o=="number"?(s="float",o=String(o)):o===!0||o===!1?(s="boolean",o=o?"1":"0"):o instanceof Date?(s="dateTime.tz",o=o.toISOString()):o=String(o),r.push(ze($_(a),o,{"dt:dt":s}))}}),"<"+t+' xmlns="'+Lr.o+'">'+r.join("")+"</"+t+">"}function kf(e){var n=e.read_shift(4),i=e.read_shift(4);return new Date((i/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function MT(e){var n=typeof e=="string"?new Date(Date.parse(e)):e,i=n.getTime()/1e3+11644473600,t=i%Math.pow(2,32),r=(i-t)/Math.pow(2,32);t*=1e7,r*=1e7;var a=t/Math.pow(2,32)|0;a>0&&(t=t%Math.pow(2,32),r+=a);var o=ye(8);return o.write_shift(4,t),o.write_shift(4,r),o}function Tv(e,n,i){var t=e.l,r=e.read_shift(0,"lpstr-cp");if(i)for(;e.l-t&3;)++e.l;return r}function Iv(e,n,i){var t=e.read_shift(0,"lpwstr");return i&&(e.l+=4-(t.length+1&3)&3),t}function Av(e,n,i){return n===31?Iv(e):Tv(e,n,i)}function Kg(e,n,i){return Av(e,n,i===!1?0:4)}function wT(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return Av(e,n,0)}function ST(e){for(var n=e.read_shift(4),i=[],t=0;t!=n;++t){var r=e.l;i[t]=e.read_shift(0,"lpwstr").replace(ar,""),e.l-r&2&&(e.l+=2)}return i}function PT(e){for(var n=e.read_shift(4),i=[],t=0;t!=n;++t)i[t]=e.read_shift(0,"lpstr-cp").replace(ar,"");return i}function OT(e){var n=e.l,i=Ku(e,vv);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var t=Ku(e,Or);return[i,t]}function kT(e){for(var n=e.read_shift(4),i=[],t=0;t<n/2;++t)i.push(OT(e));return i}function oC(e,n){for(var i=e.read_shift(4),t={},r=0;r!=i;++r){var a=e.read_shift(4),o=e.read_shift(4);t[a]=e.read_shift(o,n===1200?"utf16le":"utf8").replace(ar,"").replace(Tl,"!"),n===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),t}function Dv(e){var n=e.read_shift(4),i=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),i}function ET(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function Ku(e,n,i){var t=e.read_shift(2),r,a=i||{};if(e.l+=2,n!==iC&&t!==n&&oT.indexOf(n)===-1&&!((n&65534)==4126&&(t&65534)==4126))throw new Error("Expected type "+n+" saw "+t);switch(n===iC?t:n){case 2:return r=e.read_shift(2,"i"),a.raw||(e.l+=2),r;case 3:return r=e.read_shift(4,"i"),r;case 11:return e.read_shift(4)!==0;case 19:return r=e.read_shift(4),r;case 30:return Tv(e,t,4).replace(ar,"");case 31:return Iv(e);case 64:return kf(e);case 65:return Dv(e);case 71:return ET(e);case 80:return Kg(e,t,!a.raw).replace(ar,"");case 81:return wT(e,t).replace(ar,"");case 4108:return kT(e);case 4126:case 4127:return t==4127?ST(e):PT(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+t)}}function sC(e,n){var i=ye(4),t=ye(4);switch(i.write_shift(4,e==80?31:e),e){case 3:t.write_shift(-4,n);break;case 5:t=ye(8),t.write_shift(8,n,"f");break;case 11:t.write_shift(4,n?1:0);break;case 64:t=MT(n);break;case 31:case 80:for(t=ye(4+2*(n.length+1)+(n.length%2?0:2)),t.write_shift(4,n.length+1),t.write_shift(0,n,"dbcs");t.l!=t.length;)t.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}return Ui([i,t])}function cC(e,n){var i=e.l,t=e.read_shift(4),r=e.read_shift(4),a=[],o=0,s=0,u=-1,m={};for(o=0;o!=r;++o){var f=e.read_shift(4),h=e.read_shift(4);a[o]=[f,h+i]}a.sort(function(T,I){return T[1]-I[1]});var _={};for(o=0;o!=r;++o){if(e.l!==a[o][1]){var y=!0;if(o>0&&n)switch(n[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,y=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],y=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],y=!1);break}if((!n||o==0)&&e.l<=a[o][1]&&(y=!1,e.l=a[o][1]),y)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(n){var v=n[a[o][0]];if(_[v.n]=Ku(e,v.t,{raw:!0}),v.p==="version"&&(_[v.n]=String(_[v.n]>>16)+"."+("0000"+String(_[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(_[v.n]){case 0:_[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ha(s=_[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[v.n])}}else if(a[o][0]===1){if(s=_.CodePage=Ku(e,Pf),ha(s),u!==-1){var C=e.l;e.l=a[u][1],m=oC(e,s),e.l=C}}else if(a[o][0]===0){if(s===0){u=o,e.l=a[o+1][1];continue}m=oC(e,s)}else{var P=m[a[o][0]],D;switch(e[e.l]){case 65:e.l+=4,D=Dv(e);break;case 30:e.l+=4,D=Kg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,D=Kg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,D=e.read_shift(4,"i");break;case 19:e.l+=4,D=e.read_shift(4);break;case 5:e.l+=4,D=e.read_shift(8,"f");break;case 11:e.l+=4,D=ci(e,4);break;case 64:e.l+=4,D=Fn(kf(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[P]=D}}return e.l=i+t,_}var Fv=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function TT(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function lC(e,n,i){var t=ye(8),r=[],a=[],o=8,s=0,u=ye(8),m=ye(8);if(u.write_shift(4,2),u.write_shift(4,1200),m.write_shift(4,1),a.push(u),r.push(m),o+=8+u.length,!n){m=ye(8),m.write_shift(4,0),r.unshift(m);var f=[ye(4)];for(f[0].write_shift(4,e.length),s=0;s<e.length;++s){var h=e[s][0];for(u=ye(8+2*(h.length+1)+(h.length%2?0:2)),u.write_shift(4,s+2),u.write_shift(4,h.length+1),u.write_shift(0,h,"dbcs");u.l!=u.length;)u.write_shift(1,0);f.push(u)}u=Ui(f),a.unshift(u),o+=8+u.length}for(s=0;s<e.length;++s)if(!(n&&!n[e[s][0]])&&!(Fv.indexOf(e[s][0])>-1||Pv.indexOf(e[s][0])>-1)&&e[s][1]!=null){var _=e[s][1],y=0;if(n){y=+n[e[s][0]];var v=i[y];if(v.p=="version"&&typeof _=="string"){var C=_.split(".");_=(+C[0]<<16)+(+C[1]||0)}u=sC(v.t,_)}else{var P=TT(_);P==-1&&(P=31,_=String(_)),u=sC(P,_)}a.push(u),m=ye(8),m.write_shift(4,n?y:2+s),r.push(m),o+=8+u.length}var D=8*(a.length+1);for(s=0;s<a.length;++s)r[s].write_shift(4,D),D+=a[s].length;return t.write_shift(4,o),t.write_shift(4,a.length),Ui([t].concat(r).concat(a))}function dC(e,n,i){var t=e.content;if(!t)return{};$i(t,0);var r,a,o,s,u=0;t.chk("feff","Byte Order: "),t.read_shift(2);var m=t.read_shift(4),f=t.read_shift(16);if(f!==ft.utils.consts.HEADER_CLSID&&f!==i)throw new Error("Bad PropertySet CLSID "+f);if(r=t.read_shift(4),r!==1&&r!==2)throw new Error("Unrecognized #Sets: "+r);if(a=t.read_shift(16),s=t.read_shift(4),r===1&&s!==t.l)throw new Error("Length mismatch: "+s+" !== "+t.l);r===2&&(o=t.read_shift(16),u=t.read_shift(4));var h=cC(t,n),_={SystemIdentifier:m};for(var y in h)_[y]=h[y];if(_.FMTID=a,r===1)return _;if(u-t.l==2&&(t.l+=2),t.l!==u)throw new Error("Length mismatch 2: "+t.l+" !== "+u);var v;try{v=cC(t,null)}catch{}for(y in v)_[y]=v[y];return _.FMTID=[a,o],_}function uC(e,n,i,t,r,a){var o=ye(r?68:48),s=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,ft.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,r?2:1),o.write_shift(16,n,"hex"),o.write_shift(4,r?68:48);var u=lC(e,i,t);if(s.push(u),r){var m=lC(r,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+u.length),s.push(m)}return Ui(s)}function Bo(e,n){return e.read_shift(n),null}function IT(e,n){n||(n=ye(e));for(var i=0;i<e;++i)n.write_shift(1,0);return n}function AT(e,n,i){for(var t=[],r=e.l+n;e.l<r;)t.push(i(e,r-e.l));if(r!==e.l)throw new Error("Slurp error");return t}function ci(e,n){return e.read_shift(n)===1}function fr(e,n){return n||(n=ye(2)),n.write_shift(2,+!!e),n}function vi(e){return e.read_shift(2,"u")}function aa(e,n){return n||(n=ye(2)),n.write_shift(2,e),n}function Rv(e,n){return AT(e,n,vi)}function DT(e){var n=e.read_shift(1),i=e.read_shift(1);return i===1?n:n===1}function Nv(e,n,i){return i||(i=ye(2)),i.write_shift(1,n=="e"?+e:+!!e),i.write_shift(1,n=="e"?1:0),i}function t0(e,n,i){var t=e.read_shift(i&&i.biff>=12?2:1),r="sbcs-cont",a=Na;if(i&&i.biff>=8&&(Na=1200),!i||i.biff==8){var o=e.read_shift(1);o&&(r="dbcs-cont")}else i.biff==12&&(r="wstr");i.biff>=2&&i.biff<=5&&(r="cpstr");var s=t?e.read_shift(t,r):"";return Na=a,s}function FT(e){var n=Na;Na=1200;var i=e.read_shift(2),t=e.read_shift(1),r=t&4,a=t&8,o=1+(t&1),s=0,u,m={};a&&(s=e.read_shift(2)),r&&(u=e.read_shift(4));var f=o==2?"dbcs-cont":"sbcs-cont",h=i===0?"":e.read_shift(i,f);return a&&(e.l+=4*s),r&&(e.l+=u),m.t=h,a||(m.raw="<t>"+m.t+"</t>",m.r=m.t),Na=n,m}function RT(e){var n=e.t||"",i=1,t=ye(3+(i>1?2:0));t.write_shift(2,n.length),t.write_shift(1,(i>1?8:0)|1),i>1&&t.write_shift(2,i);var r=ye(2*n.length);r.write_shift(2*n.length,n,"utf16le");var a=[t,r];return Ui(a)}function Cs(e,n,i){var t;if(i){if(i.biff>=2&&i.biff<=5)return e.read_shift(n,"cpstr");if(i.biff>=12)return e.read_shift(n,"dbcs-cont")}var r=e.read_shift(1);return r===0?t=e.read_shift(n,"sbcs-cont"):t=e.read_shift(n,"dbcs-cont"),t}function n0(e,n,i){var t=e.read_shift(i&&i.biff==2?1:2);return t===0?(e.l++,""):Cs(e,t,i)}function Os(e,n,i){if(i.biff>5)return n0(e,n,i);var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,i.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Bv(e,n,i){return i||(i=ye(3+2*e.length)),i.write_shift(2,e.length),i.write_shift(1,1),i.write_shift(31,e,"utf16le"),i}function NT(e){var n=e.read_shift(1);e.l++;var i=e.read_shift(2);return e.l+=2,[n,i]}function BT(e){var n=e.read_shift(4),i=e.l,t=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(t=!0),e.l=i);var r=e.read_shift((t?n-24:n)>>1,"utf16le").replace(ar,"");return t&&(e.l+=24),r}function LT(e){for(var n=e.read_shift(2),i="";n-- >0;)i+="../";var t=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var r=e.read_shift(4);if(r===0)return i+t.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(ar,"");return i+o}function VT(e,n){var i=e.read_shift(16);switch(n-=16,i){case"e0c9ea79f9bace118c8200aa004ba90b":return BT(e,n);case"0303000000000000c000000000000046":return LT(e,n);default:throw new Error("Unsupported Moniker "+i)}}function Nu(e){var n=e.read_shift(4),i=n>0?e.read_shift(n,"utf16le").replace(ar,""):"";return i}function mC(e,n){n||(n=ye(6+e.length*2)),n.write_shift(4,1+e.length);for(var i=0;i<e.length;++i)n.write_shift(2,e.charCodeAt(i));return n.write_shift(2,0),n}function UT(e,n){var i=e.l+n,t=e.read_shift(4);if(t!==2)throw new Error("Unrecognized streamVersion: "+t);var r=e.read_shift(2);e.l+=2;var a,o,s,u,m="",f,h;r&16&&(a=Nu(e,i-e.l)),r&128&&(o=Nu(e,i-e.l)),(r&257)===257&&(s=Nu(e,i-e.l)),(r&257)===1&&(u=VT(e,i-e.l)),r&8&&(m=Nu(e,i-e.l)),r&32&&(f=e.read_shift(16)),r&64&&(h=kf(e)),e.l=i;var _=o||s||u||"";_&&m&&(_+="#"+m),_||(_="#"+m),r&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var y={Target:_};return f&&(y.guid=f),h&&(y.time=h),a&&(y.Tooltip=a),y}function jT(e){var n=ye(512),i=0,t=e.Target;t.slice(0,7)=="file://"&&(t=t.slice(7));var r=t.indexOf("#"),a=r>-1?31:23;switch(t.charAt(0)){case"#":a=28;break;case".":a&=-3;break}n.write_shift(4,2),n.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(i=0;i<o.length;++i)n.write_shift(4,o[i]);if(a==28)t=t.slice(1),mC(t,n);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<o.length;++i)n.write_shift(1,parseInt(o[i],16));var s=r>-1?t.slice(0,r):t;for(n.write_shift(4,2*(s.length+1)),i=0;i<s.length;++i)n.write_shift(2,s.charCodeAt(i));n.write_shift(2,0),a&8&&mC(r>-1?t.slice(r+1):"",n)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),i=0;i<o.length;++i)n.write_shift(1,parseInt(o[i],16));for(var u=0;t.slice(u*3,u*3+3)=="../"||t.slice(u*3,u*3+3)=="..\\";)++u;for(n.write_shift(2,u),n.write_shift(4,t.length-3*u+1),i=0;i<t.length-3*u;++i)n.write_shift(1,t.charCodeAt(i+3*u)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),i=0;i<6;++i)n.write_shift(4,0)}return n.slice(0,n.l)}function Lv(e){var n=e.read_shift(1),i=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1);return[n,i,t,r]}function Vv(e,n){var i=Lv(e,n);return i[3]=0,i}function La(e){var n=e.read_shift(2),i=e.read_shift(2),t=e.read_shift(2);return{r:n,c:i,ixfe:t}}function vs(e,n,i,t){return t||(t=ye(6)),t.write_shift(2,e),t.write_shift(2,n),t.write_shift(2,i||0),t}function zT(e){var n=e.read_shift(2),i=e.read_shift(2);return e.l+=8,{type:n,flags:i}}function WT(e,n,i){return n===0?"":Os(e,n,i)}function YT(e,n,i){var t=i.biff>8?4:2,r=e.read_shift(t),a=e.read_shift(t,"i"),o=e.read_shift(t,"i");return[r,a,o]}function Uv(e){var n=e.read_shift(2),i=Sf(e);return[n,i]}function $T(e,n,i){e.l+=4,n-=4;var t=e.l+n,r=t0(e,n,i),a=e.read_shift(2);if(t-=e.l,a!==t)throw new Error("Malformed AddinUdf: padding = "+t+" != "+a);return e.l+=a,r}function sm(e){var n=e.read_shift(2),i=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{s:{c:t,r:n},e:{c:r,r:i}}}function jv(e,n){return n||(n=ye(8)),n.write_shift(2,e.s.r),n.write_shift(2,e.e.r),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c),n}function zv(e){var n=e.read_shift(2),i=e.read_shift(2),t=e.read_shift(1),r=e.read_shift(1);return{s:{c:t,r:n},e:{c:r,r:i}}}var GT=zv;function Wv(e){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),t=e.read_shift(2);return e.l+=12,[i,n,t]}function HT(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function qT(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function er(e){e.l+=2,e.l+=e.read_shift(2)}var XT={0:er,4:er,5:er,6:er,7:qT,8:er,9:er,10:er,11:er,12:er,13:HT,14:er,15:er,16:er,17:er,18:er,19:er,20:er,21:Wv};function KT(e,n){for(var i=e.l+n,t=[];e.l<i;){var r=e.read_shift(2);e.l-=2;try{t.push(XT[r](e,i-e.l))}catch{return e.l=i,t}}return e.l!=i&&(e.l=i),t}function Bu(e,n){var i={BIFFVer:0,dt:0};switch(i.BIFFVer=e.read_shift(2),n-=2,n>=2&&(i.dt=e.read_shift(2),e.l-=2),i.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+i.BIFFVer)}return e.read_shift(n),i}function Ef(e,n,i){var t=1536,r=16;switch(i.bookType){case"biff8":break;case"biff5":t=1280,r=8;break;case"biff4":t=4,r=6;break;case"biff3":t=3,r=6;break;case"biff2":t=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ye(r);return a.write_shift(2,t),a.write_shift(2,n),r>4&&a.write_shift(2,29282),r>6&&a.write_shift(2,1997),r>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function ZT(e,n){return n===0||e.read_shift(2),1200}function JT(e,n,i){if(i.enc)return e.l+=n,"";var t=e.l,r=Os(e,0,i);return e.read_shift(n+t-e.l),r}function QT(e,n){var i=!n||n.biff==8,t=ye(i?112:54);for(t.write_shift(n.biff==8?2:1,7),i&&t.write_shift(1,0),t.write_shift(4,859007059),t.write_shift(4,5458548|(i?0:536870912));t.l<t.length;)t.write_shift(1,i?0:32);return t}function e6(e,n,i){var t=i&&i.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:t&16,fBelow:t&64,fRight:t&128}}function t6(e,n,i){var t=e.read_shift(4),r=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=t0(e,0,i);return o.length===0&&(o="Sheet1"),{pos:t,hs:r,dt:a,name:o}}function n6(e,n){var i=!n||n.biff>=8?2:1,t=ye(8+i*e.name.length);t.write_shift(4,e.pos),t.write_shift(1,e.hs||0),t.write_shift(1,e.dt),t.write_shift(1,e.name.length),n.biff>=8&&t.write_shift(1,1),t.write_shift(i*e.name.length,e.name,n.biff<8?"sbcs":"utf16le");var r=t.slice(0,t.l);return r.l=t.l,r}function i6(e,n){for(var i=e.l+n,t=e.read_shift(4),r=e.read_shift(4),a=[],o=0;o!=r&&e.l<i;++o)a.push(FT(e));return a.Count=t,a.Unique=r,a}function r6(e,n){var i=ye(8);i.write_shift(4,e.Count),i.write_shift(4,e.Unique);for(var t=[],r=0;r<e.length;++r)t[r]=RT(e[r],n);var a=Ui([i].concat(t));return a.parts=[i.length].concat(t.map(function(o){return o.length})),a}function a6(e,n){var i={};return i.dsst=e.read_shift(2),e.l+=n-2,i}function o6(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var i=e.read_shift(2);e.l+=4;var t=e.read_shift(1);return e.l+=3,t&7&&(n.level=t&7),t&32&&(n.hidden=!0),t&64&&(n.hpt=i/20),n}function s6(e){var n=zT(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var i=e.read_shift(4);return i!==0}function c6(e){return e.read_shift(2),e.read_shift(4)}function gC(e,n,i){var t=0;i&&i.biff==2||(t=e.read_shift(2));var r=e.read_shift(2);i&&i.biff==2&&(t=1-(r>>15),r&=32767);var a={Unsynced:t&1,DyZero:(t&2)>>1,ExAsc:(t&4)>>2,ExDsc:(t&8)>>3};return[a,r]}function l6(e){var n=e.read_shift(2),i=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=e.read_shift(2),u=e.read_shift(2),m=e.read_shift(2);return{Pos:[n,i],Dim:[t,r],Flags:a,CurTab:o,FirstTab:s,Selected:u,TabRatio:m}}function d6(){var e=ye(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function u6(e,n,i){if(i&&i.biff>=2&&i.biff<5)return{};var t=e.read_shift(2);return{RTL:t&64}}function m6(e){var n=ye(18),i=1718;return e&&e.RTL&&(i|=64),n.write_shift(2,i),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function g6(){}function f6(e,n,i){var t={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(i&&i.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return t.name=t0(e,0,i),t}function p6(e,n){var i=e.name||"Arial",t=n&&n.biff==5,r=t?15+i.length:16+2*i.length,a=ye(r);return a.write_shift(2,(e.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,i.length),t||a.write_shift(1,1),a.write_shift((t?1:2)*i.length,i,t?"sbcs":"utf16le"),a}function h6(e){var n=La(e);return n.isst=e.read_shift(4),n}function x6(e,n,i,t){var r=ye(10);return vs(e,n,t,r),r.write_shift(4,i),r}function _6(e,n,i){i.biffguess&&i.biff==2&&(i.biff=5);var t=e.l+n,r=La(e,6);i.biff==2&&e.l++;var a=n0(e,t-e.l,i);return r.val=a,r}function C6(e,n,i,t,r){var a=!r||r.biff==8,o=ye(8+ +a+(1+a)*i.length);return vs(e,n,t,o),o.write_shift(2,i.length),a&&o.write_shift(1,1),o.write_shift((1+a)*i.length,i,a?"utf16le":"sbcs"),o}function v6(e,n,i){var t=e.read_shift(2),r=Os(e,0,i);return[t,r]}function b6(e,n,i,t){var r=i&&i.biff==5;t||(t=ye(r?3+n.length:5+2*n.length)),t.write_shift(2,e),t.write_shift(r?1:2,n.length),r||t.write_shift(1,1),t.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le");var a=t.length>t.l?t.slice(0,t.l):t;return a.l==null&&(a.l=a.length),a}var y6=Os;function fC(e,n,i){var t=e.l+n,r=i.biff==8||!i.biff?4:2,a=e.read_shift(r),o=e.read_shift(r),s=e.read_shift(2),u=e.read_shift(2);return e.l=t,{s:{r:a,c:s},e:{r:o,c:u}}}function M6(e,n){var i=n.biff==8||!n.biff?4:2,t=ye(2*i+6);return t.write_shift(i,e.s.r),t.write_shift(i,e.e.r+1),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c+1),t.write_shift(2,0),t}function w6(e){var n=e.read_shift(2),i=e.read_shift(2),t=Uv(e);return{r:n,c:i,ixfe:t[0],rknum:t[1]}}function S6(e,n){for(var i=e.l+n-2,t=e.read_shift(2),r=e.read_shift(2),a=[];e.l<i;)a.push(Uv(e));if(e.l!==i)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-r+1)throw new Error("MulRK length mismatch");return{r:t,c:r,C:o,rkrec:a}}function P6(e,n){for(var i=e.l+n-2,t=e.read_shift(2),r=e.read_shift(2),a=[];e.l<i;)a.push(e.read_shift(2));if(e.l!==i)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-r+1)throw new Error("MulBlank length mismatch");return{r:t,c:r,C:o,ixfe:a}}function O6(e,n,i,t){var r={},a=e.read_shift(4),o=e.read_shift(4),s=e.read_shift(4),u=e.read_shift(2);return r.patternType=sT[s>>26],t.cellStyles&&(r.alc=a&7,r.fWrap=a>>3&1,r.alcV=a>>4&7,r.fJustLast=a>>7&1,r.trot=a>>8&255,r.cIndent=a>>16&15,r.fShrinkToFit=a>>20&1,r.iReadOrder=a>>22&2,r.fAtrNum=a>>26&1,r.fAtrFnt=a>>27&1,r.fAtrAlc=a>>28&1,r.fAtrBdr=a>>29&1,r.fAtrPat=a>>30&1,r.fAtrProt=a>>31&1,r.dgLeft=o&15,r.dgRight=o>>4&15,r.dgTop=o>>8&15,r.dgBottom=o>>12&15,r.icvLeft=o>>16&127,r.icvRight=o>>23&127,r.grbitDiag=o>>30&3,r.icvTop=s&127,r.icvBottom=s>>7&127,r.icvDiag=s>>14&127,r.dgDiag=s>>21&15,r.icvFore=u&127,r.icvBack=u>>7&127,r.fsxButton=u>>14&1),r}function k6(e,n,i){var t={};return t.ifnt=e.read_shift(2),t.numFmtId=e.read_shift(2),t.flags=e.read_shift(2),t.fStyle=t.flags>>2&1,n-=6,t.data=O6(e,n,t.fStyle,i),t}function pC(e,n,i,t){var r=i&&i.biff==5;t||(t=ye(r?16:20)),t.write_shift(2,0),e.style?(t.write_shift(2,e.numFmtId||0),t.write_shift(2,65524)):(t.write_shift(2,e.numFmtId||0),t.write_shift(2,n<<4));var a=0;return e.numFmtId>0&&r&&(a|=1024),t.write_shift(4,a),t.write_shift(4,0),r||t.write_shift(4,0),t.write_shift(2,0),t}function E6(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function T6(e){var n=ye(8);return n.write_shift(4,0),n.write_shift(2,e[0]?e[0]+1:0),n.write_shift(2,e[1]?e[1]+1:0),n}function hC(e,n,i){var t=La(e,6);(i.biff==2||n==9)&&++e.l;var r=DT(e,2);return t.val=r,t.t=r===!0||r===!1?"b":"e",t}function I6(e,n,i,t,r,a){var o=ye(8);return vs(e,n,t,o),Nv(i,a,o),o}function A6(e,n,i){i.biffguess&&i.biff==2&&(i.biff=5);var t=La(e,6),r=rr(e,8);return t.val=r,t}function D6(e,n,i,t){var r=ye(14);return vs(e,n,t,r),_s(i,r),r}var xC=WT;function F6(e,n,i){var t=e.l+n,r=e.read_shift(2),a=e.read_shift(2);if(i.sbcch=a,a==1025||a==14849)return[a,r];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=Cs(e,a),s=[];t>e.l;)s.push(n0(e));return[a,r,o,s]}function _C(e,n,i){var t=e.read_shift(2),r,a={fBuiltIn:t&1,fWantAdvise:t>>>1&1,fWantPict:t>>>2&1,fOle:t>>>3&1,fOleLink:t>>>4&1,cf:t>>>5&1023,fIcon:t>>>15&1};return i.sbcch===14849&&(r=$T(e,n-2,i)),a.body=r||e.read_shift(n-2),typeof r=="string"&&(a.Name=r),a}var R6=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function CC(e,n,i){var t=e.l+n,r=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(i&&i.biff==2?1:2),u=0;(!i||i.biff>=5)&&(i.biff!=5&&(e.l+=2),u=e.read_shift(2),i.biff==5&&(e.l+=2),e.l+=4);var m=Cs(e,o,i);r&32&&(m=R6[m.charCodeAt(0)]);var f=t-e.l;i&&i.biff==2&&--f;var h=t==e.l||s===0||!(f>0)?[]:KA(e,f,i,s);return{chKey:a,Name:m,itab:u,rgce:h}}function Yv(e,n,i){if(i.biff<8)return N6(e,n,i);for(var t=[],r=e.l+n,a=e.read_shift(i.biff>8?4:2);a--!==0;)t.push(YT(e,i.biff>8?12:6,i));if(e.l!=r)throw new Error("Bad ExternSheet: "+e.l+" != "+r);return t}function N6(e,n,i){e[e.l+1]==3&&e[e.l]++;var t=t0(e,n,i);return t.charCodeAt(0)==3?t.slice(1):t}function B6(e,n,i){if(i.biff<8){e.l+=n;return}var t=e.read_shift(2),r=e.read_shift(2),a=Cs(e,t,i),o=Cs(e,r,i);return[a,o]}function L6(e,n,i){var t=zv(e,6);e.l++;var r=e.read_shift(1);return n-=8,[ZA(e,n,i),r,t]}function vC(e,n,i){var t=GT(e,6);switch(i.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[t,qA(e,n,i,t)]}function V6(e){var n=e.read_shift(4)!==0,i=e.read_shift(4)!==0,t=e.read_shift(4);return[n,i,t]}function U6(e,n,i){if(!(i.biff<8)){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=Os(e,0,i);return i.biff<8&&e.read_shift(1),[{r:t,c:r},s,o,a]}}function j6(e,n,i){return U6(e,n,i)}function z6(e,n){for(var i=[],t=e.read_shift(2);t--;)i.push(sm(e,n));return i}function W6(e){var n=ye(2+e.length*8);n.write_shift(2,e.length);for(var i=0;i<e.length;++i)jv(e[i],n);return n}function Y6(e,n,i){if(i&&i.biff<8)return G6(e,n,i);var t=Wv(e,22),r=KT(e,n-22,t[1]);return{cmo:t,ft:r}}var $6={8:function(e,n){var i=e.l+n;e.l+=10;var t=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var r=e.read_shift(1);return e.l+=r,e.l=i,{fmt:t}}};function G6(e,n,i){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var o=[];return o.push(($6[t]||sr)(e,n,i)),{cmo:[r,t,a],ft:o}}function H6(e,n,i){var t=e.l,r="";try{e.l+=4;var a=(i.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=NT(e,6,i);var s=e.read_shift(2);e.read_shift(2),vi(e,2);var u=e.read_shift(2);e.l+=u;for(var m=1;m<e.lens.length-1;++m){if(e.l-t!=e.lens[m])throw new Error("TxO: bad continue record");var f=e[e.l],h=Cs(e,e.lens[m+1]-e.lens[m]-1);if(r+=h,r.length>=(f?s:2*s))break}if(r.length!==s&&r.length!==s*2)throw new Error("cchText: "+s+" != "+r.length);return e.l=t+n,{t:r}}catch{return e.l=t+n,{t:r}}}function q6(e,n){var i=sm(e,8);e.l+=16;var t=UT(e,n-24);return[i,t]}function X6(e){var n=ye(24),i=qn(e[0]);n.write_shift(2,i.r),n.write_shift(2,i.r),n.write_shift(2,i.c),n.write_shift(2,i.c);for(var t="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)n.write_shift(1,parseInt(t[r],16));return Ui([n,jT(e[1])])}function K6(e,n){e.read_shift(2);var i=sm(e,8),t=e.read_shift((n-10)/2,"dbcs-cont");return t=t.replace(ar,""),[i,t]}function Z6(e){var n=e[1].Tooltip,i=ye(10+2*(n.length+1));i.write_shift(2,2048);var t=qn(e[0]);i.write_shift(2,t.r),i.write_shift(2,t.r),i.write_shift(2,t.c),i.write_shift(2,t.c);for(var r=0;r<n.length;++r)i.write_shift(2,n.charCodeAt(r));return i.write_shift(2,0),i}function J6(e){var n=[0,0],i;return i=e.read_shift(2),n[0]=rC[i]||i,i=e.read_shift(2),n[1]=rC[i]||i,n}function Q6(e){return e||(e=ye(4)),e.write_shift(2,1),e.write_shift(2,1),e}function e5(e){for(var n=e.read_shift(2),i=[];n-- >0;)i.push(Vv(e,8));return i}function t5(e){for(var n=e.read_shift(2),i=[];n-- >0;)i.push(Vv(e,8));return i}function n5(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function $v(e,n,i){if(!i.cellStyles)return sr(e,n);var t=i&&i.biff>=12?4:2,r=e.read_shift(t),a=e.read_shift(t),o=e.read_shift(t),s=e.read_shift(t),u=e.read_shift(2);t==2&&(e.l+=2);var m={s:r,e:a,w:o,ixfe:s,flags:u};return(i.biff>=5||!i.biff)&&(m.level=u>>8&7),m}function i5(e,n){var i=ye(12);i.write_shift(2,n),i.write_shift(2,n),i.write_shift(2,e.width*256),i.write_shift(2,0);var t=0;return e.hidden&&(t|=1),i.write_shift(1,t),t=e.level||0,i.write_shift(1,t),i.write_shift(2,0),i}function r5(e,n){var i={};return n<32||(e.l+=16,i.header=rr(e,8),i.footer=rr(e,8),e.l+=2),i}function a5(e,n,i){var t={area:!1};if(i.biff!=5)return e.l+=n,t;var r=e.read_shift(1);return e.l+=3,r&16&&(t.area=!0),t}function o5(e){for(var n=ye(2*e),i=0;i<e;++i)n.write_shift(2,i+1);return n}var s5=La,c5=Rv,l5=n0;function d5(e){var n=e.read_shift(2),i=e.read_shift(2),t=e.read_shift(4),r={fmt:n,env:i,len:t,data:e.slice(e.l,e.l+t)};return e.l+=t,r}function u5(e,n,i){i.biffguess&&i.biff==5&&(i.biff=2);var t=La(e,6);++e.l;var r=Os(e,n-7,i);return t.t="str",t.val=r,t}function m5(e){var n=La(e,6);++e.l;var i=rr(e,8);return n.t="n",n.val=i,n}function g5(e,n,i){var t=ye(15);return o0(t,e,n),t.write_shift(8,i,"f"),t}function f5(e){var n=La(e,6);++e.l;var i=e.read_shift(2);return n.t="n",n.val=i,n}function p5(e,n,i){var t=ye(9);return o0(t,e,n),t.write_shift(2,i),t}function h5(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function x5(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function _5(e,n,i){var t=e.l+n,r=La(e,6),a=e.read_shift(2),o=Cs(e,a,i);return e.l=t,r.t="str",r.val=o,r}var C5=[2,3,48,49,131,139,140,245],Zg=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=im({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function i(s,u){var m=[],f=Uo(1);switch(u.type){case"base64":f=Vr(jr(s));break;case"binary":f=Vr(s);break;case"buffer":case"array":f=s;break}$i(f,0);var h=f.read_shift(1),_=!!(h&136),y=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:y=!0,_=!0;break;case 49:y=!0,_=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var C=0,P=521;h==2&&(C=f.read_shift(2)),f.l+=3,h!=2&&(C=f.read_shift(4)),C>1048576&&(C=1e6),h!=2&&(P=f.read_shift(2));var D=f.read_shift(2),T=u.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(T=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var I=[],K={},ee=Math.min(f.length,h==2?521:P-10-(y?264:0)),k=v?32:11;f.l<ee&&f[f.l]!=13;)switch(K={},K.name=pn.utils.decode(T,f.slice(f.l,f.l+k)).replace(/[\u0000\r\n].*$/g,""),f.l+=k,K.type=String.fromCharCode(f.read_shift(1)),h!=2&&!v&&(K.offset=f.read_shift(4)),K.len=f.read_shift(1),h==2&&(K.offset=f.read_shift(2)),K.dec=f.read_shift(1),K.name.length&&I.push(K),h!=2&&(f.l+=v?13:14),K.type){case"B":(!y||K.len!=8)&&u.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+K.type)}if(f[f.l]!==13&&(f.l=P-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=P;var O=0,R=0;for(m[0]=[],R=0;R!=I.length;++R)m[0][R]=I[R].name;for(;C-- >0;){if(f[f.l]===42){f.l+=D;continue}for(++f.l,m[++O]=[],R=0,R=0;R!=I.length;++R){var U=f.slice(f.l,f.l+I[R].len);f.l+=I[R].len,$i(U,0);var Q=pn.utils.decode(T,U);switch(I[R].type){case"C":Q.trim().length&&(m[O][R]=Q.replace(/\s+$/,""));break;case"D":Q.length===8?m[O][R]=new Date(+Q.slice(0,4),+Q.slice(4,6)-1,+Q.slice(6,8)):m[O][R]=Q;break;case"F":m[O][R]=parseFloat(Q.trim());break;case"+":case"I":m[O][R]=v?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(Q.trim().toUpperCase()){case"Y":case"T":m[O][R]=!0;break;case"N":case"F":m[O][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Q+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));m[O][R]="##MEMO##"+(v?parseInt(Q.trim(),10):U.read_shift(4));break;case"N":Q=Q.replace(/\u0000/g,"").trim(),Q&&Q!="."&&(m[O][R]=+Q||0);break;case"@":m[O][R]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":m[O][R]=new Date((U.read_shift(4)-2440588)*864e5+U.read_shift(4));break;case"Y":m[O][R]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[O][R]=-U.read_shift(-8,"f");break;case"B":if(y&&I[R].len==8){m[O][R]=U.read_shift(8,"f");break}case"G":case"P":U.l+=I[R].len;break;case"0":if(I[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[R].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return u&&u.sheetRows&&(m=m.slice(0,u.sheetRows)),u.DBF=I,m}function t(s,u){var m=u||{};m.dateNF||(m.dateNF="yyyymmdd");var f=Hc(i(s,m),m);return f["!cols"]=m.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete m.DBF,f}function r(s,u){try{return $o(t(s,u),u)}catch(m){if(u&&u.WTF)throw m}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(s,u){var m=u||{};if(+m.codepage>=0&&ha(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var f=kr(),h=em(s,{header:1,raw:!0,cellDates:!0}),_=h[0],y=h.slice(1),v=s["!cols"]||[],C=0,P=0,D=0,T=1;for(C=0;C<_.length;++C){if(((v[C]||{}).DBF||{}).name){_[C]=v[C].DBF.name,++D;continue}if(_[C]!=null){if(++D,typeof _[C]=="number"&&(_[C]=_[C].toString(10)),typeof _[C]!="string")throw new Error("DBF Invalid column name "+_[C]+" |"+typeof _[C]+"|");if(_.indexOf(_[C])!==C){for(P=0;P<1024;++P)if(_.indexOf(_[C]+"_"+P)==-1){_[C]+="_"+P;break}}}}var I=rn(s["!ref"]),K=[],ee=[],k=[];for(C=0;C<=I.e.c-I.s.c;++C){var O="",R="",U=0,Q=[];for(P=0;P<y.length;++P)y[P][C]!=null&&Q.push(y[P][C]);if(Q.length==0||_[C]==null){K[C]="?";continue}for(P=0;P<Q.length;++P){switch(typeof Q[P]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=Q[P]instanceof Date?"D":"C";break;default:R="C"}U=Math.max(U,String(Q[P]).length),O=O&&O!=R?"C":R}U>250&&(U=250),R=((v[C]||{}).DBF||{}).type,R=="C"&&v[C].DBF.len>U&&(U=v[C].DBF.len),O=="B"&&R=="N"&&(O="N",k[C]=v[C].DBF.dec,U=v[C].DBF.len),ee[C]=O=="C"||R=="N"?U:a[O]||0,T+=ee[C],K[C]=O}var re=f.next(32);for(re.write_shift(4,318902576),re.write_shift(4,y.length),re.write_shift(2,296+32*D),re.write_shift(2,T),C=0;C<4;++C)re.write_shift(4,0);for(re.write_shift(4,0|(+n[Uc]||3)<<8),C=0,P=0;C<_.length;++C)if(_[C]!=null){var ie=f.next(32),Pe=(_[C].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ie.write_shift(1,Pe,"sbcs"),ie.write_shift(1,K[C]=="?"?"C":K[C],"sbcs"),ie.write_shift(4,P),ie.write_shift(1,ee[C]||a[K[C]]||0),ie.write_shift(1,k[C]||0),ie.write_shift(1,2),ie.write_shift(4,0),ie.write_shift(1,0),ie.write_shift(4,0),ie.write_shift(4,0),P+=ee[C]||a[K[C]]||0}var Re=f.next(264);for(Re.write_shift(4,13),C=0;C<65;++C)Re.write_shift(4,0);for(C=0;C<y.length;++C){var xe=f.next(T);for(xe.write_shift(1,0),P=0;P<_.length;++P)if(_[P]!=null)switch(K[P]){case"L":xe.write_shift(1,y[C][P]==null?63:y[C][P]?84:70);break;case"B":xe.write_shift(8,y[C][P]||0,"f");break;case"N":var Be="0";for(typeof y[C][P]=="number"&&(Be=y[C][P].toFixed(k[P]||0)),D=0;D<ee[P]-Be.length;++D)xe.write_shift(1,32);xe.write_shift(1,Be,"sbcs");break;case"D":y[C][P]?(xe.write_shift(4,("0000"+y[C][P].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(y[C][P].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+y[C][P].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var we=String(y[C][P]!=null?y[C][P]:"").slice(0,ee[P]);for(xe.write_shift(1,we,"sbcs"),D=0;D<ee[P]-we.length;++D)xe.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:r,to_sheet:t,from_sheet:o}}(),Gv=function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+ii(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),i=function(_,y){var v=e[y];return typeof v=="number"?I_(v):v},t=function(_,y,v){var C=y.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return C==59?_:I_(C)};e["|"]=254;function r(_,y){switch(y.type){case"base64":return a(jr(_),y);case"binary":return a(_,y);case"buffer":return a($t&&Buffer.isBuffer(_)?_.toString("binary"):Yo(_),y);case"array":return a(xs(_),y)}throw new Error("Unrecognized type "+y.type)}function a(_,y){var v=_.split(/[\n\r]+/),C=-1,P=-1,D=0,T=0,I=[],K=[],ee=null,k={},O=[],R=[],U=[],Q=0,re;for(+y.codepage>=0&&ha(+y.codepage);D!==v.length;++D){Q=0;var ie=v[D].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,t).replace(n,i),Pe=ie.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")}),Re=Pe[0],xe;if(ie.length>0)switch(Re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Pe[1].charAt(0)=="P"&&K.push(ie.slice(3).replace(/;;/g,";"));break;case"C":var Be=!1,we=!1,$e=!1,Se=!1,Ae=-1,ce=-1;for(T=1;T<Pe.length;++T)switch(Pe[T].charAt(0)){case"A":break;case"X":P=parseInt(Pe[T].slice(1))-1,we=!0;break;case"Y":for(C=parseInt(Pe[T].slice(1))-1,we||(P=0),re=I.length;re<=C;++re)I[re]=[];break;case"K":xe=Pe[T].slice(1),xe.charAt(0)==='"'?xe=xe.slice(1,xe.length-1):xe==="TRUE"?xe=!0:xe==="FALSE"?xe=!1:isNaN(_a(xe))?isNaN(jc(xe).getDate())||(xe=Fn(xe)):(xe=_a(xe),ee!==null&&Yc(ee)&&(xe=am(xe))),typeof pn<"u"&&typeof xe=="string"&&(y||{}).type!="string"&&(y||{}).codepage&&(xe=pn.utils.decode(y.codepage,xe)),Be=!0;break;case"E":Se=!0;var Y=Lc(Pe[T].slice(1),{r:C,c:P});I[C][P]=[I[C][P],Y];break;case"S":$e=!0,I[C][P]=[I[C][P],"S5S"];break;case"G":break;case"R":Ae=parseInt(Pe[T].slice(1))-1;break;case"C":ce=parseInt(Pe[T].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ie)}if(Be&&(I[C][P]&&I[C][P].length==2?I[C][P][0]=xe:I[C][P]=xe,ee=null),$e){if(Se)throw new Error("SYLK shared formula cannot have own formula");var te=Ae>-1&&I[Ae][ce];if(!te||!te[1])throw new Error("SYLK shared formula cannot find base");I[C][P][1]=db(te[1],{r:C-Ae,c:P-ce})}break;case"F":var Z=0;for(T=1;T<Pe.length;++T)switch(Pe[T].charAt(0)){case"X":P=parseInt(Pe[T].slice(1))-1,++Z;break;case"Y":for(C=parseInt(Pe[T].slice(1))-1,re=I.length;re<=C;++re)I[re]=[];break;case"M":Q=parseInt(Pe[T].slice(1))/20;break;case"F":break;case"G":break;case"P":ee=K[parseInt(Pe[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(U=Pe[T].slice(1).split(" "),re=parseInt(U[0],10);re<=parseInt(U[1],10);++re)Q=parseInt(U[2],10),R[re-1]=Q===0?{hidden:!0}:{wch:Q},jo(R[re-1]);break;case"C":P=parseInt(Pe[T].slice(1))-1,R[P]||(R[P]={});break;case"R":C=parseInt(Pe[T].slice(1))-1,O[C]||(O[C]={}),Q>0?(O[C].hpt=Q,O[C].hpx=Wc(Q)):Q===0&&(O[C].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ie)}Z<1&&(ee=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ie)}}return O.length>0&&(k["!rows"]=O),R.length>0&&(k["!cols"]=R),y&&y.sheetRows&&(I=I.slice(0,y.sheetRows)),[I,k]}function o(_,y){var v=r(_,y),C=v[0],P=v[1],D=Hc(C,y);return ii(P).forEach(function(T){D[T]=P[T]}),D}function s(_,y){return $o(o(_,y),y)}function u(_,y,v,C){var P="C;Y"+(v+1)+";X"+(C+1)+";K";switch(_.t){case"n":P+=_.v||0,_.f&&!_.F&&(P+=";E"+Rf(_.f,{r:v,c:C}));break;case"b":P+=_.v?"TRUE":"FALSE";break;case"e":P+=_.w||_.v;break;case"d":P+='"'+(_.w||_.v)+'"';break;case"s":P+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return P}function m(_,y){y.forEach(function(v,C){var P="F;W"+(C+1)+" "+(C+1)+" ";v.hidden?P+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=ql(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Xl(v.wpx)),typeof v.wch=="number"&&(P+=Math.round(v.wch))),P.charAt(P.length-1)!=" "&&_.push(P)})}function f(_,y){y.forEach(function(v,C){var P="F;";v.hidden?P+="M0;":v.hpt?P+="M"+20*v.hpt+";":v.hpx&&(P+="M"+20*Kl(v.hpx)+";"),P.length>2&&_.push(P+"R"+(C+1))})}function h(_,y){var v=["ID;PWXL;N;E"],C=[],P=rn(_["!ref"]),D,T=Array.isArray(_),I=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),_["!cols"]&&m(v,_["!cols"]),_["!rows"]&&f(v,_["!rows"]),v.push("B;Y"+(P.e.r-P.s.r+1)+";X"+(P.e.c-P.s.c+1)+";D"+[P.s.c,P.s.r,P.e.c,P.e.r].join(" "));for(var K=P.s.r;K<=P.e.r;++K)for(var ee=P.s.c;ee<=P.e.c;++ee){var k=vt({r:K,c:ee});D=T?(_[K]||[])[ee]:_[k],!(!D||D.v==null&&(!D.f||D.F))&&C.push(u(D,_,K,ee,y))}return v.join(I)+I+C.join(I)+I+"E"+I}return{to_workbook:s,to_sheet:o,from_sheet:h}}(),Hv=function(){function e(a,o){switch(o.type){case"base64":return n(jr(a),o);case"binary":return n(a,o);case"buffer":return n($t&&Buffer.isBuffer(a)?a.toString("binary"):Yo(a),o);case"array":return n(xs(a),o)}throw new Error("Unrecognized type "+o.type)}function n(a,o){for(var s=a.split(`
`),u=-1,m=-1,f=0,h=[];f!==s.length;++f){if(s[f].trim()==="BOT"){h[++u]=[],m=0;continue}if(!(u<0)){var _=s[f].trim().split(","),y=_[0],v=_[1];++f;for(var C=s[f]||"";(C.match(/["]/g)||[]).length&1&&f<s.length-1;)C+=`
`+s[++f];switch(C=C.trim(),+y){case-1:if(C==="BOT"){h[++u]=[],m=0;continue}else if(C!=="EOD")throw new Error("Unrecognized DIF special command "+C);break;case 0:C==="TRUE"?h[u][m]=!0:C==="FALSE"?h[u][m]=!1:isNaN(_a(v))?isNaN(jc(v).getDate())?h[u][m]=v:h[u][m]=Fn(v):h[u][m]=_a(v),++m;break;case 1:C=C.slice(1,C.length-1),C=C.replace(/""/g,'"'),Ol&&C&&C.match(/^=".*"$/)&&(C=C.slice(2,-1)),h[u][m++]=C!==""?C:null;break}if(C==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function i(a,o){return Hc(e(a,o),o)}function t(a,o){return $o(i(a,o),o)}var r=function(){var a=function(u,m,f,h,_){u.push(m),u.push(f+","+h),u.push('"'+_.replace(/"/g,'""')+'"')},o=function(u,m,f,h){u.push(m+","+f),u.push(m==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(u){var m=[],f=rn(u["!ref"]),h,_=Array.isArray(u);a(m,"TABLE",0,1,"sheetjs"),a(m,"VECTORS",0,f.e.r-f.s.r+1,""),a(m,"TUPLES",0,f.e.c-f.s.c+1,""),a(m,"DATA",0,0,"");for(var y=f.s.r;y<=f.e.r;++y){o(m,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var C=vt({r:y,c:v});if(h=_?(u[y]||[])[v]:u[C],!h){o(m,1,0,"");continue}switch(h.t){case"n":var P=Ol?h.w:h.v;!P&&h.v!=null&&(P=h.v),P==null?Ol&&h.f&&!h.F?o(m,1,0,"="+h.f):o(m,1,0,""):o(m,0,P,"V");break;case"b":o(m,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(m,1,0,!Ol||isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=sa(h.z||Ct[14],wi(Fn(h.v)))),Ol?o(m,0,h.w,"V"):o(m,1,0,h.w);break;default:o(m,1,0,"")}}}o(m,-1,0,"EOD");var D=`\r
`,T=m.join(D);return T}}();return{to_workbook:t,to_sheet:i,from_sheet:r}}(),qv=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function i(h,_){for(var y=h.split(`
`),v=-1,C=-1,P=0,D=[];P!==y.length;++P){var T=y[P].trim().split(":");if(T[0]==="cell"){var I=qn(T[1]);if(D.length<=I.r)for(v=D.length;v<=I.r;++v)D[v]||(D[v]=[]);switch(v=I.r,C=I.c,T[2]){case"t":D[v][C]=e(T[3]);break;case"v":D[v][C]=+T[3];break;case"vtf":var K=T[T.length-1];case"vtc":switch(T[3]){case"nl":D[v][C]=!!+T[4];break;default:D[v][C]=+T[4];break}T[2]=="vtf"&&(D[v][C]=[D[v][C],K])}}}return _&&_.sheetRows&&(D=D.slice(0,_.sheetRows)),D}function t(h,_){return Hc(i(h,_),_)}function r(h,_){return $o(t(h,_),_)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function m(h){if(!h||!h["!ref"])return"";for(var _=[],y=[],v,C="",P=Er(h["!ref"]),D=Array.isArray(h),T=P.s.r;T<=P.e.r;++T)for(var I=P.s.c;I<=P.e.c;++I)if(C=vt({r:T,c:I}),v=D?(h[T]||[])[I]:h[C],!(!v||v.v==null||v.t==="z")){switch(y=["cell",C,"t"],v.t){case"s":case"str":y.push(n(v.v));break;case"n":v.f?(y[2]="vtf",y[3]="n",y[4]=v.v,y[5]=n(v.f)):(y[2]="v",y[3]=v.v);break;case"b":y[2]="vt"+(v.f?"f":"c"),y[3]="nl",y[4]=v.v?"1":"0",y[5]=n(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var K=wi(Fn(v.v));y[2]="vtc",y[3]="nd",y[4]=""+K,y[5]=v.w||sa(v.z||Ct[14],K);break;case"e":continue}_.push(y.join(":"))}return _.push("sheet:c:"+(P.e.c-P.s.c+1)+":r:"+(P.e.r-P.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function f(h){return[a,o,s,o,m(h),u].join(`
`)}return{to_workbook:r,to_sheet:t,from_sheet:f}}(),zc=function(){function e(f,h,_,y,v){v.raw?h[_][y]=f:f===""||(f==="TRUE"?h[_][y]=!0:f==="FALSE"?h[_][y]=!1:isNaN(_a(f))?isNaN(jc(f).getDate())?h[_][y]=f:h[_][y]=Fn(f):h[_][y]=_a(f))}function n(f,h){var _=h||{},y=[];if(!f||f.length===0)return y;for(var v=f.split(/[\r\n]/),C=v.length-1;C>=0&&v[C].length===0;)--C;for(var P=10,D=0,T=0;T<=C;++T)D=v[T].indexOf(" "),D==-1?D=v[T].length:D++,P=Math.max(P,D);for(T=0;T<=C;++T){y[T]=[];var I=0;for(e(v[T].slice(0,P).trim(),y,T,I,_),I=1;I<=(v[T].length-P)/10+1;++I)e(v[T].slice(P+(I-1)*10,P+I*10).trim(),y,T,I,_)}return _.sheetRows&&(y=y.slice(0,_.sheetRows)),y}var i={44:",",9:"	",59:";",124:"|"},t={44:3,9:2,59:1,124:0};function r(f){for(var h={},_=!1,y=0,v=0;y<f.length;++y)(v=f.charCodeAt(y))==34?_=!_:!_&&v in i&&(h[v]=(h[v]||0)+1);v=[];for(y in h)Object.prototype.hasOwnProperty.call(h,y)&&v.push([h[y],y]);if(!v.length){h=t;for(y in h)Object.prototype.hasOwnProperty.call(h,y)&&v.push([h[y],y])}return v.sort(function(C,P){return C[0]-P[0]||t[C[1]]-t[P[1]]}),i[v.pop()[1]]||44}function a(f,h){var _=h||{},y="";ni!=null&&_.dense==null&&(_.dense=ni);var v=_.dense?[]:{},C={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(y=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(y=f.charAt(4),f=f.slice(6)):y=r(f.slice(0,1024)):_&&_.FS?y=_.FS:y=r(f.slice(0,1024));var P=0,D=0,T=0,I=0,K=0,ee=y.charCodeAt(0),k=!1,O=0,R=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var U=_.dateNF!=null?aE(_.dateNF):null;function Q(){var re=f.slice(I,K),ie={};if(re.charAt(0)=='"'&&re.charAt(re.length-1)=='"'&&(re=re.slice(1,-1).replace(/""/g,'"')),re.length===0)ie.t="z";else if(_.raw)ie.t="s",ie.v=re;else if(re.trim().length===0)ie.t="s",ie.v=re;else if(re.charCodeAt(0)==61)re.charCodeAt(1)==34&&re.charCodeAt(re.length-1)==34?(ie.t="s",ie.v=re.slice(2,-1).replace(/""/g,'"')):FI(re)?(ie.t="n",ie.f=re.slice(1)):(ie.t="s",ie.v=re);else if(re=="TRUE")ie.t="b",ie.v=!0;else if(re=="FALSE")ie.t="b",ie.v=!1;else if(!isNaN(T=_a(re)))ie.t="n",_.cellText!==!1&&(ie.w=re),ie.v=T;else if(!isNaN(jc(re).getDate())||U&&re.match(U)){ie.z=_.dateNF||Ct[14];var Pe=0;U&&re.match(U)&&(re=oE(re,_.dateNF,re.match(U)||[]),Pe=1),_.cellDates?(ie.t="d",ie.v=Fn(re,Pe)):(ie.t="n",ie.v=wi(Fn(re,Pe))),_.cellText!==!1&&(ie.w=sa(ie.z,ie.v instanceof Date?wi(ie.v):ie.v)),_.cellNF||delete ie.z}else ie.t="s",ie.v=re;if(ie.t=="z"||(_.dense?(v[P]||(v[P]=[]),v[P][D]=ie):v[vt({c:D,r:P})]=ie),I=K+1,R=f.charCodeAt(I),C.e.c<D&&(C.e.c=D),C.e.r<P&&(C.e.r=P),O==ee)++D;else if(D=0,++P,_.sheetRows&&_.sheetRows<=P)return!0}e:for(;K<f.length;++K)switch(O=f.charCodeAt(K)){case 34:R===34&&(k=!k);break;case ee:case 10:case 13:if(!k&&Q())break e;break;default:break}return K-I>0&&Q(),v["!ref"]=Ft(C),v}function o(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,h):Hc(n(f,h),h)}function s(f,h){var _="",y=h.type=="string"?[0,0,0,0]:Wf(f,h);switch(h.type){case"base64":_=jr(f);break;case"binary":_=f;break;case"buffer":h.codepage==65001?_=f.toString("utf8"):h.codepage&&typeof pn<"u"?_=pn.utils.decode(h.codepage,f):_=$t&&Buffer.isBuffer(f)?f.toString("binary"):Yo(f);break;case"array":_=xs(f);break;case"string":_=f;break;default:throw new Error("Unrecognized type "+h.type)}return y[0]==239&&y[1]==187&&y[2]==191?_=yn(_.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?_=yn(_):h.type=="binary"&&typeof pn<"u"&&h.codepage&&(_=pn.utils.decode(h.codepage,pn.utils.encode(28591,_))),_.slice(0,19)=="socialcalc:version:"?qv.to_sheet(h.type=="string"?_:yn(_),h):o(_,h)}function u(f,h){return $o(s(f,h),h)}function m(f){for(var h=[],_=rn(f["!ref"]),y,v=Array.isArray(f),C=_.s.r;C<=_.e.r;++C){for(var P=[],D=_.s.c;D<=_.e.c;++D){var T=vt({r:C,c:D});if(y=v?(f[C]||[])[D]:f[T],!y||y.v==null){P.push("          ");continue}for(var I=(y.w||(io(y),y.w)||"").slice(0,10);I.length<10;)I+=" ";P.push(I+(D===0?" ":""))}h.push(P.join(""))}return h.join(`
`)}return{to_workbook:u,to_sheet:s,from_sheet:m}}();function v5(e,n){var i=n||{},t=!!i.WTF;i.WTF=!0;try{var r=Gv.to_workbook(e,i);return i.WTF=t,r}catch(a){if(i.WTF=t,!a.message.match(/SYLK bad record ID/)&&t)throw a;return zc.to_workbook(e,n)}}var fs=function(){function e(Y,te,Z){if(Y){$i(Y,Y.l||0);for(var J=Z.Enum||Ae;Y.l<Y.length;){var de=Y.read_shift(2),Oe=J[de]||J[65535],ke=Y.read_shift(2),Me=Y.l+ke,_e=Oe.f&&Oe.f(Y,ke,Z);if(Y.l=Me,te(_e,Oe,de))return}}}function n(Y,te){switch(te.type){case"base64":return i(Vr(jr(Y)),te);case"binary":return i(Vr(Y),te);case"buffer":case"array":return i(Y,te)}throw"Unsupported type "+te.type}function i(Y,te){if(!Y)return Y;var Z=te||{};ni!=null&&Z.dense==null&&(Z.dense=ni);var J=Z.dense?[]:{},de="Sheet1",Oe="",ke=0,Me={},_e=[],it=[],j={s:{r:0,c:0},e:{r:0,c:0}},st=Z.sheetRows||0;if(Y[2]==0&&(Y[3]==8||Y[3]==9)&&Y.length>=16&&Y[14]==5&&Y[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(Y[2]==2)Z.Enum=Ae,e(Y,function(Fe,Tt,an){switch(an){case 0:Z.vers=Fe,Fe>=4096&&(Z.qpro=!0);break;case 6:j=Fe;break;case 204:Fe&&(Oe=Fe);break;case 222:Oe=Fe;break;case 15:case 51:Z.qpro||(Fe[1].v=Fe[1].v.slice(1));case 13:case 14:case 16:an==14&&(Fe[2]&112)==112&&(Fe[2]&15)>1&&(Fe[2]&15)<15&&(Fe[1].z=Z.dateNF||Ct[14],Z.cellDates&&(Fe[1].t="d",Fe[1].v=am(Fe[1].v))),Z.qpro&&Fe[3]>ke&&(J["!ref"]=Ft(j),Me[de]=J,_e.push(de),J=Z.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},ke=Fe[3],de=Oe||"Sheet"+(ke+1),Oe="");var Sn=Z.dense?(J[Fe[0].r]||[])[Fe[0].c]:J[vt(Fe[0])];if(Sn){Sn.t=Fe[1].t,Sn.v=Fe[1].v,Fe[1].z!=null&&(Sn.z=Fe[1].z),Fe[1].f!=null&&(Sn.f=Fe[1].f);break}Z.dense?(J[Fe[0].r]||(J[Fe[0].r]=[]),J[Fe[0].r][Fe[0].c]=Fe[1]):J[vt(Fe[0])]=Fe[1];break;default:}},Z);else if(Y[2]==26||Y[2]==14)Z.Enum=ce,Y[2]==14&&(Z.qpro=!0,Y.l=0),e(Y,function(Fe,Tt,an){switch(an){case 204:de=Fe;break;case 22:Fe[1].v=Fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Fe[3]>ke&&(J["!ref"]=Ft(j),Me[de]=J,_e.push(de),J=Z.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},ke=Fe[3],de="Sheet"+(ke+1)),st>0&&Fe[0].r>=st)break;Z.dense?(J[Fe[0].r]||(J[Fe[0].r]=[]),J[Fe[0].r][Fe[0].c]=Fe[1]):J[vt(Fe[0])]=Fe[1],j.e.c<Fe[0].c&&(j.e.c=Fe[0].c),j.e.r<Fe[0].r&&(j.e.r=Fe[0].r);break;case 27:Fe[14e3]&&(it[Fe[14e3][0]]=Fe[14e3][1]);break;case 1537:it[Fe[0]]=Fe[1],Fe[0]==ke&&(de=Fe[1]);break;default:break}},Z);else throw new Error("Unrecognized LOTUS BOF "+Y[2]);if(J["!ref"]=Ft(j),Me[Oe||de]=J,_e.push(Oe||de),!it.length)return{SheetNames:_e,Sheets:Me};for(var qe={},bt=[],Ze=0;Ze<it.length;++Ze)Me[_e[Ze]]?(bt.push(it[Ze]||_e[Ze]),qe[it[Ze]]=Me[it[Ze]]||Me[_e[Ze]]):(bt.push(it[Ze]),qe[it[Ze]]={"!ref":"A1"});return{SheetNames:bt,Sheets:qe}}function t(Y,te){var Z=te||{};if(+Z.codepage>=0&&ha(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK1 to JS string");var J=kr(),de=rn(Y["!ref"]),Oe=Array.isArray(Y),ke=[];We(J,0,a(1030)),We(J,6,u(de));for(var Me=Math.min(de.e.r,8191),_e=de.s.r;_e<=Me;++_e)for(var it=li(_e),j=de.s.c;j<=de.e.c;++j){_e===de.s.r&&(ke[j]=Hn(j));var st=ke[j]+it,qe=Oe?(Y[_e]||[])[j]:Y[st];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?We(J,13,y(_e,j,qe.v)):We(J,14,C(_e,j,qe.v));else{var bt=io(qe);We(J,15,h(_e,j,bt.slice(0,239)))}}return We(J,1),J.end()}function r(Y,te){var Z=te||{};if(+Z.codepage>=0&&ha(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK3 to JS string");var J=kr();We(J,0,o(Y));for(var de=0,Oe=0;de<Y.SheetNames.length;++de)(Y.Sheets[Y.SheetNames[de]]||{})["!ref"]&&We(J,27,Se(Y.SheetNames[de],Oe++));var ke=0;for(de=0;de<Y.SheetNames.length;++de){var Me=Y.Sheets[Y.SheetNames[de]];if(!(!Me||!Me["!ref"])){for(var _e=rn(Me["!ref"]),it=Array.isArray(Me),j=[],st=Math.min(_e.e.r,8191),qe=_e.s.r;qe<=st;++qe)for(var bt=li(qe),Ze=_e.s.c;Ze<=_e.e.c;++Ze){qe===_e.s.r&&(j[Ze]=Hn(Ze));var Fe=j[Ze]+bt,Tt=it?(Me[qe]||[])[Ze]:Me[Fe];if(!(!Tt||Tt.t=="z"))if(Tt.t=="n")We(J,23,Q(qe,Ze,ke,Tt.v));else{var an=io(Tt);We(J,22,O(qe,Ze,ke,an.slice(0,239)))}}++ke}}return We(J,1),J.end()}function a(Y){var te=ye(2);return te.write_shift(2,Y),te}function o(Y){var te=ye(26);te.write_shift(2,4096),te.write_shift(2,4),te.write_shift(4,0);for(var Z=0,J=0,de=0,Oe=0;Oe<Y.SheetNames.length;++Oe){var ke=Y.SheetNames[Oe],Me=Y.Sheets[ke];if(!(!Me||!Me["!ref"])){++de;var _e=Er(Me["!ref"]);Z<_e.e.r&&(Z=_e.e.r),J<_e.e.c&&(J=_e.e.c)}}return Z>8191&&(Z=8191),te.write_shift(2,Z),te.write_shift(1,de),te.write_shift(1,J),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(1,1),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(4,0),te}function s(Y,te,Z){var J={s:{c:0,r:0},e:{c:0,r:0}};return te==8&&Z.qpro?(J.s.c=Y.read_shift(1),Y.l++,J.s.r=Y.read_shift(2),J.e.c=Y.read_shift(1),Y.l++,J.e.r=Y.read_shift(2),J):(J.s.c=Y.read_shift(2),J.s.r=Y.read_shift(2),te==12&&Z.qpro&&(Y.l+=2),J.e.c=Y.read_shift(2),J.e.r=Y.read_shift(2),te==12&&Z.qpro&&(Y.l+=2),J.s.c==65535&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}function u(Y){var te=ye(8);return te.write_shift(2,Y.s.c),te.write_shift(2,Y.s.r),te.write_shift(2,Y.e.c),te.write_shift(2,Y.e.r),te}function m(Y,te,Z){var J=[{c:0,r:0},{t:"n",v:0},0,0];return Z.qpro&&Z.vers!=20768?(J[0].c=Y.read_shift(1),J[3]=Y.read_shift(1),J[0].r=Y.read_shift(2),Y.l+=2):(J[2]=Y.read_shift(1),J[0].c=Y.read_shift(2),J[0].r=Y.read_shift(2)),J}function f(Y,te,Z){var J=Y.l+te,de=m(Y,te,Z);if(de[1].t="s",Z.vers==20768){Y.l++;var Oe=Y.read_shift(1);return de[1].v=Y.read_shift(Oe,"utf8"),de}return Z.qpro&&Y.l++,de[1].v=Y.read_shift(J-Y.l,"cstr"),de}function h(Y,te,Z){var J=ye(7+Z.length);J.write_shift(1,255),J.write_shift(2,te),J.write_shift(2,Y),J.write_shift(1,39);for(var de=0;de<J.length;++de){var Oe=Z.charCodeAt(de);J.write_shift(1,Oe>=128?95:Oe)}return J.write_shift(1,0),J}function _(Y,te,Z){var J=m(Y,te,Z);return J[1].v=Y.read_shift(2,"i"),J}function y(Y,te,Z){var J=ye(7);return J.write_shift(1,255),J.write_shift(2,te),J.write_shift(2,Y),J.write_shift(2,Z,"i"),J}function v(Y,te,Z){var J=m(Y,te,Z);return J[1].v=Y.read_shift(8,"f"),J}function C(Y,te,Z){var J=ye(13);return J.write_shift(1,255),J.write_shift(2,te),J.write_shift(2,Y),J.write_shift(8,Z,"f"),J}function P(Y,te,Z){var J=Y.l+te,de=m(Y,te,Z);if(de[1].v=Y.read_shift(8,"f"),Z.qpro)Y.l=J;else{var Oe=Y.read_shift(2);K(Y.slice(Y.l,Y.l+Oe),de),Y.l+=Oe}return de}function D(Y,te,Z){var J=te&32768;return te&=-32769,te=(J?Y:0)+(te>=8192?te-16384:te),(J?"":"$")+(Z?Hn(te):li(te))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function K(Y,te){$i(Y,0);for(var Z=[],J=0,de="",Oe="",ke="",Me="";Y.l<Y.length;){var _e=Y[Y.l++];switch(_e){case 0:Z.push(Y.read_shift(8,"f"));break;case 1:Oe=D(te[0].c,Y.read_shift(2),!0),de=D(te[0].r,Y.read_shift(2),!1),Z.push(Oe+de);break;case 2:{var it=D(te[0].c,Y.read_shift(2),!0),j=D(te[0].r,Y.read_shift(2),!1);Oe=D(te[0].c,Y.read_shift(2),!0),de=D(te[0].r,Y.read_shift(2),!1),Z.push(it+j+":"+Oe+de)}break;case 3:if(Y.l<Y.length){console.error("WK1 premature formula end");return}break;case 4:Z.push("("+Z.pop()+")");break;case 5:Z.push(Y.read_shift(2));break;case 6:{for(var st="";_e=Y[Y.l++];)st+=String.fromCharCode(_e);Z.push('"'+st.replace(/"/g,'""')+'"')}break;case 8:Z.push("-"+Z.pop());break;case 23:Z.push("+"+Z.pop());break;case 22:Z.push("NOT("+Z.pop()+")");break;case 20:case 21:Me=Z.pop(),ke=Z.pop(),Z.push(["AND","OR"][_e-20]+"("+ke+","+Me+")");break;default:if(_e<32&&I[_e])Me=Z.pop(),ke=Z.pop(),Z.push(ke+I[_e]+Me);else if(T[_e]){if(J=T[_e][1],J==69&&(J=Y[Y.l++]),J>Z.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+Z.join("|")+"|");return}var qe=Z.slice(-J);Z.length-=J,Z.push(T[_e][0]+"("+qe.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}Z.length==1?te[1].f=""+Z[0]:console.error("WK1 bad formula parse |"+Z.join("|")+"|")}function ee(Y){var te=[{c:0,r:0},{t:"n",v:0},0];return te[0].r=Y.read_shift(2),te[3]=Y[Y.l++],te[0].c=Y[Y.l++],te}function k(Y,te){var Z=ee(Y,te);return Z[1].t="s",Z[1].v=Y.read_shift(te-4,"cstr"),Z}function O(Y,te,Z,J){var de=ye(6+J.length);de.write_shift(2,Y),de.write_shift(1,Z),de.write_shift(1,te),de.write_shift(1,39);for(var Oe=0;Oe<J.length;++Oe){var ke=J.charCodeAt(Oe);de.write_shift(1,ke>=128?95:ke)}return de.write_shift(1,0),de}function R(Y,te){var Z=ee(Y,te);Z[1].v=Y.read_shift(2);var J=Z[1].v>>1;if(Z[1].v&1)switch(J&7){case 0:J=(J>>3)*5e3;break;case 1:J=(J>>3)*500;break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64;break}return Z[1].v=J,Z}function U(Y,te){var Z=ee(Y,te),J=Y.read_shift(4),de=Y.read_shift(4),Oe=Y.read_shift(2);if(Oe==65535)return J===0&&de===3221225472?(Z[1].t="e",Z[1].v=15):J===0&&de===3489660928?(Z[1].t="e",Z[1].v=42):Z[1].v=0,Z;var ke=Oe&32768;return Oe=(Oe&32767)-16446,Z[1].v=(1-ke*2)*(de*Math.pow(2,Oe+32)+J*Math.pow(2,Oe)),Z}function Q(Y,te,Z,J){var de=ye(14);if(de.write_shift(2,Y),de.write_shift(1,Z),de.write_shift(1,te),J==0)return de.write_shift(4,0),de.write_shift(4,0),de.write_shift(2,65535),de;var Oe=0,ke=0,Me=0,_e=0;return J<0&&(Oe=1,J=-J),ke=Math.log2(J)|0,J/=Math.pow(2,ke-31),_e=J>>>0,_e&2147483648||(J/=2,++ke,_e=J>>>0),J-=_e,_e|=2147483648,_e>>>=0,J*=Math.pow(2,32),Me=J>>>0,de.write_shift(4,Me),de.write_shift(4,_e),ke+=16383+(Oe?32768:0),de.write_shift(2,ke),de}function re(Y,te){var Z=U(Y,14);return Y.l+=te-14,Z}function ie(Y,te){var Z=ee(Y,te),J=Y.read_shift(4);return Z[1].v=J>>6,Z}function Pe(Y,te){var Z=ee(Y,te),J=Y.read_shift(8,"f");return Z[1].v=J,Z}function Re(Y,te){var Z=Pe(Y,14);return Y.l+=te-10,Z}function xe(Y,te){return Y[Y.l+te-1]==0?Y.read_shift(te,"cstr"):""}function Be(Y,te){var Z=Y[Y.l++];Z>te-1&&(Z=te-1);for(var J="";J.length<Z;)J+=String.fromCharCode(Y[Y.l++]);return J}function we(Y,te,Z){if(!(!Z.qpro||te<21)){var J=Y.read_shift(1);Y.l+=17,Y.l+=1,Y.l+=2;var de=Y.read_shift(te-21,"cstr");return[J,de]}}function $e(Y,te){for(var Z={},J=Y.l+te;Y.l<J;){var de=Y.read_shift(2);if(de==14e3){for(Z[de]=[0,""],Z[de][0]=Y.read_shift(2);Y[Y.l];)Z[de][1]+=String.fromCharCode(Y[Y.l]),Y.l++;Y.l++}}return Z}function Se(Y,te){var Z=ye(5+Y.length);Z.write_shift(2,14e3),Z.write_shift(2,te);for(var J=0;J<Y.length;++J){var de=Y.charCodeAt(J);Z[Z.l++]=de>127?95:de}return Z[Z.l++]=0,Z}var Ae={0:{n:"BOF",f:vi},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:s},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:P},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:xe},222:{n:"SHEETNAMELP",f:Be},65535:{n:""}},ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:re},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:$e},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ie},38:{n:"??"},39:{n:"NUMBER27",f:Pe},40:{n:"FORMULA28",f:Re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:xe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:we},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:t,book_to_wk3:r,to_workbook:n}}();function b5(e){var n={},i=e.match(cr),t=0,r=!1;if(i)for(;t!=i.length;++t){var a=St(i[t]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;n.cp=tf[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=a.val;break;case"<sz":n.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":a.rgb&&(n.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(a[0].charCodeAt(1)!==47&&!r)throw new Error("Unrecognized rich format "+a[0])}}return n}var y5=function(){var e=Wl("t"),n=Wl("rPr");function i(a){var o=a.match(e);if(!o)return{t:"s",v:""};var s={t:"s",v:nn(o[1])},u=a.match(n);return u&&(s.s=b5(u[1])),s}var t=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(o){return o.replace(t,"").split(r).map(i).filter(function(s){return s.v})}}(),M5=function(){var n=/(\r\n|\n)/g;function i(r,a,o){var s=[];r.u&&s.push("text-decoration: underline;"),r.uval&&s.push("text-underline-style:"+r.uval+";"),r.sz&&s.push("font-size:"+r.sz+"pt;"),r.outline&&s.push("text-effect: outline;"),r.shadow&&s.push("text-shadow: auto;"),a.push('<span style="'+s.join("")+'">'),r.b&&(a.push("<b>"),o.push("</b>")),r.i&&(a.push("<i>"),o.push("</i>")),r.strike&&(a.push("<s>"),o.push("</s>"));var u=r.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(a.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),r}function t(r){var a=[[],r.v,[]];return r.v?(r.s&&i(r.s,a[0],a[2]),a[0].join("")+a[1].replace(n,"<br/>")+a[2].join("")):""}return function(a){return a.map(t).join("")}}(),w5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,S5=/<(?:\w+:)?r>/,P5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Tf(e,n){var i=n?n.cellHTML:!0,t={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(t.t=nn(yn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),t.r=yn(e),i&&(t.h=mf(t.t))):e.match(S5)&&(t.r=yn(e),t.t=nn(yn((e.replace(P5,"").match(w5)||[]).join("").replace(cr,""))),i&&(t.h=M5(y5(t.r)))),t):{t:""}}var O5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,k5=/<(?:\w+:)?(?:si|sstItem)>/g,E5=/<\/(?:\w+:)?(?:si|sstItem)>/;function T5(e,n){var i=[],t="";if(!e)return i;var r=e.match(O5);if(r){t=r[2].replace(k5,"").split(E5);for(var a=0;a!=t.length;++a){var o=Tf(t[a].trim(),n);o!=null&&(i[i.length]=o)}r=St(r[1]),i.Count=r.count,i.Unique=r.uniqueCount}return i}var I5=/^\s|\s$|[\t\n\r]/;function Xv(e,n){if(!n.bookSST)return"";var i=[di];i[i.length]=ze("sst",null,{xmlns:ys[0],count:e.Count,uniqueCount:e.Unique});for(var t=0;t!=e.length;++t)if(e[t]!=null){var r=e[t],a="<si>";r.r?a+=r.r:(a+="<t",r.t||(r.t=""),r.t.match(I5)&&(a+=' xml:space="preserve"'),a+=">"+Cn(r.t)+"</t>"),a+="</si>",i[i.length]=a}return i.length>2&&(i[i.length]="</sst>",i[1]=i[1].replace("/>",">")),i.join("")}function A5(e){return[e.read_shift(4),e.read_shift(4)]}function D5(e,n){var i=[],t=!1;return ao(e,function(a,o,s){switch(s){case 159:i.Count=a[0],i.Unique=a[1];break;case 19:i.push(a);break;case 160:return!0;case 35:t=!0;break;case 36:t=!1;break;default:if(o.T,!t||n.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),i}function F5(e,n){return n||(n=ye(8)),n.write_shift(4,e.Count),n.write_shift(4,e.Unique),n}var R5=$E;function N5(e){var n=kr();Ie(n,159,F5(e));for(var i=0;i<e.length;++i)Ie(n,19,R5(e[i]));return Ie(n,160),n.end()}function Kv(e){if(typeof pn<"u")return pn.utils.encode(Uc,e);for(var n=[],i=e.split(""),t=0;t<i.length;++t)n[t]=i[t].charCodeAt(0);return n}function no(e,n){var i={};return i.Major=e.read_shift(2),i.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),i}function B5(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=no(e,4),n.U=no(e,4),n.W=no(e,4),n}function L5(e){for(var n=e.read_shift(4),i=e.l+n-4,t={},r=e.read_shift(4),a=[];r-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(t.name=e.read_shift(0,"lpp4"),t.comps=a,e.l!=i)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+i);return t}function V5(e){var n=[];e.l+=4;for(var i=e.read_shift(4);i-- >0;)n.push(L5(e));return n}function U5(e){var n=[];e.l+=4;for(var i=e.read_shift(4);i-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function j5(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=no(e,4),n.U=no(e,4),n.W=no(e,4),n}function z5(e){var n=j5(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function Zv(e,n){var i=e.l+n,t={};t.Flags=e.read_shift(4)&63,e.l+=4,t.AlgID=e.read_shift(4);var r=!1;switch(t.AlgID){case 26126:case 26127:case 26128:r=t.Flags==36;break;case 26625:r=t.Flags==4;break;case 0:r=t.Flags==16||t.Flags==4||t.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+t.AlgID}if(!r)throw new Error("Encryption Flags/AlgID mismatch");return t.AlgIDHash=e.read_shift(4),t.KeySize=e.read_shift(4),t.ProviderType=e.read_shift(4),e.l+=8,t.CSPName=e.read_shift(i-e.l>>1,"utf16le"),e.l=i,t}function Jv(e,n){var i={},t=e.l+n;return e.l+=4,i.Salt=e.slice(e.l,e.l+16),e.l+=16,i.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),i.VerifierHash=e.slice(e.l,t),e.l=t,i}function W5(e){var n=no(e);switch(n.Minor){case 2:return[n.Minor,Y5(e,n)];case 3:return[n.Minor,$5(e,n)];case 4:return[n.Minor,G5(e,n)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function Y5(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var i=e.read_shift(4),t=Zv(e,i),r=Jv(e,e.length-e.l);return{t:"Std",h:t,v:r}}function $5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function G5(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var i=e.read_shift(e.length-e.l,"utf8"),t={};return i.replace(cr,function(a){var o=St(a);switch(Ba(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(s){t[s]=o[s]});break;case"<dataIntegrity":t.encryptedHmacKey=o.encryptedHmacKey,t.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":t.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":t.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":t.encs.push(o);break;default:throw o[0]}}),t}function H5(e,n){var i={},t=i.EncryptionVersionInfo=no(e,4);if(n-=4,t.Minor!=2)throw new Error("unrecognized minor version code: "+t.Minor);if(t.Major>4||t.Major<2)throw new Error("unrecognized major version code: "+t.Major);i.Flags=e.read_shift(4),n-=4;var r=e.read_shift(4);return n-=4,i.EncryptionHeader=Zv(e,r),n-=r,i.EncryptionVerifier=Jv(e,n),i}function q5(e){var n={},i=n.EncryptionVersionInfo=no(e,4);if(i.Major!=1||i.Minor!=1)throw"unrecognized version code "+i.Major+" : "+i.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function If(e){var n=0,i,t=Kv(e),r=t.length+1,a,o,s,u,m;for(i=Uo(r),i[0]=t.length,a=1;a!=r;++a)i[a]=t[a-1];for(a=r-1;a>=0;--a)o=i[a],s=n&16384?1:0,u=n<<1&32767,m=s|u,n=m^o;return n^52811}var Qv=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],i=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],t=function(o){return(o/2|o*128)&255},r=function(o,s){return t(o^s)},a=function(o){for(var s=n[o.length-1],u=104,m=o.length-1;m>=0;--m)for(var f=o[m],h=0;h!=7;++h)f&64&&(s^=i[u]),f*=2,--u;return s};return function(o){for(var s=Kv(o),u=a(s),m=s.length,f=Uo(16),h=0;h!=16;++h)f[h]=0;var _,y,v;for((m&1)===1&&(_=u>>8,f[m]=r(e[0],_),--m,_=u&255,y=s[s.length-1],f[m]=r(y,_));m>0;)--m,_=u>>8,f[m]=r(s[m],_),--m,_=u&255,f[m]=r(s[m],_);for(m=15,v=15-s.length;v>0;)_=u>>8,f[m]=r(e[v],_),--m,--v,_=u&255,f[m]=r(s[m],_),--m,--v;return f}}(),X5=function(e,n,i,t,r){r||(r=n),t||(t=Qv(e));var a,o;for(a=0;a!=n.length;++a)o=n[a],o^=t[i],o=(o>>5|o<<3)&255,r[a]=o,++i;return[r,i,t]},K5=function(e){var n=0,i=Qv(e);return function(t){var r=X5("",t,n,i);return n=r[1],r[0]}};function Z5(e,n,i,t){var r={key:vi(e),verificationBytes:vi(e)};return i.password&&(r.verifier=If(i.password)),t.valid=r.verificationBytes===r.verifier,t.valid&&(t.insitu=K5(i.password)),r}function J5(e,n,i){var t=i||{};return t.Info=e.read_shift(2),e.l-=2,t.Info===1?t.Data=q5(e,n):t.Data=H5(e,n),t}function Q5(e,n,i){var t={Type:i.biff>=8?e.read_shift(2):0};return t.Type?J5(e,n-2,t):Z5(e,i.biff>=8?n:n-2,i,t),t}var eb=function(){function e(r,a){switch(a.type){case"base64":return n(jr(r),a);case"binary":return n(r,a);case"buffer":return n($t&&Buffer.isBuffer(r)?r.toString("binary"):Yo(r),a);case"array":return n(xs(r),a)}throw new Error("Unrecognized type "+a.type)}function n(r,a){var o=a||{},s=o.dense?[]:{},u=r.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(f,h){Array.isArray(s)&&(s[h]=[]);for(var _=/\\\w+\b/g,y=0,v,C=-1;v=_.exec(f);){switch(v[0]){case"\\cell":var P=f.slice(y,_.lastIndex-v[0].length);if(P[0]==" "&&(P=P.slice(1)),++C,P.length){var D={v:P,t:"s"};Array.isArray(s)?s[h][C]=D:s[vt({r:h,c:C})]=D}break}y=_.lastIndex}C>m.e.c&&(m.e.c=C)}),s["!ref"]=Ft(m),s}function i(r,a){return $o(e(r,a),a)}function t(r){for(var a=["{\\rtf1\\ansi"],o=rn(r["!ref"]),s,u=Array.isArray(r),m=o.s.r;m<=o.e.r;++m){a.push("\\trowd\\trautofit1");for(var f=o.s.c;f<=o.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=o.s.c;f<=o.e.c;++f){var h=vt({r:m,c:f});s=u?(r[m]||[])[f]:r[h],!(!s||s.v==null&&(!s.f||s.F))&&(a.push(" "+(s.w||(io(s),s.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:i,to_sheet:e,from_sheet:t}}();function e8(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function Hl(e){for(var n=0,i=1;n!=3;++n)i=i*256+(e[n]>255?255:e[n]<0?0:e[n]);return i.toString(16).toUpperCase().slice(1)}function t8(e){var n=e[0]/255,i=e[1]/255,t=e[2]/255,r=Math.max(n,i,t),a=Math.min(n,i,t),o=r-a;if(o===0)return[0,0,n];var s=0,u=0,m=r+a;switch(u=o/(m>1?2-m:m),r){case n:s=((i-t)/o+6)%6;break;case i:s=(t-n)/o+2;break;case t:s=(n-i)/o+4;break}return[s/6,u,m/2]}function n8(e){var n=e[0],i=e[1],t=e[2],r=i*2*(t<.5?t:1-t),a=t-r/2,o=[a,a,a],s=6*n,u;if(i!==0)switch(s|0){case 0:case 6:u=r*s,o[0]+=r,o[1]+=u;break;case 1:u=r*(2-s),o[0]+=u,o[1]+=r;break;case 2:u=r*(s-2),o[1]+=r,o[2]+=u;break;case 3:u=r*(4-s),o[1]+=u,o[2]+=r;break;case 4:u=r*(s-4),o[2]+=r,o[0]+=u;break;case 5:u=r*(6-s),o[2]+=u,o[0]+=r;break}for(var m=0;m!=3;++m)o[m]=Math.round(o[m]*255);return o}function Zu(e,n){if(n===0)return e;var i=t8(e8(e));return n<0?i[2]=i[2]*(1+n):i[2]=1-(1-i[2])*(1-n),Hl(n8(i))}var tb=6,i8=15,r8=1,ir=tb;function ql(e){return Math.floor((e+Math.round(128/ir)/256)*ir)}function Xl(e){return Math.floor((e-5)/ir*100+.5)/100}function Ju(e){return Math.round((e*ir+5)/ir*256)/256}function Fg(e){return Ju(Xl(ql(e)))}function Af(e){var n=Math.abs(e-Fg(e)),i=ir;if(n>.005)for(ir=r8;ir<i8;++ir)Math.abs(e-Fg(e))<=n&&(n=Math.abs(e-Fg(e)),i=ir);ir=i}function jo(e){e.width?(e.wpx=ql(e.width),e.wch=Xl(e.wpx),e.MDW=ir):e.wpx?(e.wch=Xl(e.wpx),e.width=Ju(e.wch),e.MDW=ir):typeof e.wch=="number"&&(e.width=Ju(e.wch),e.wpx=ql(e.width),e.MDW=ir),e.customWidth&&delete e.customWidth}var a8=96,nb=a8;function Kl(e){return e*96/nb}function Wc(e){return e*nb/96}var o8={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function s8(e,n,i,t){n.Borders=[];var r={},a=!1;(e[0].match(cr)||[]).forEach(function(o){var s=St(o);switch(Ba(s[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":r={},s.diagonalUp&&(r.diagonalUp=Dn(s.diagonalUp)),s.diagonalDown&&(r.diagonalDown=Dn(s.diagonalDown)),n.Borders.push(r);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+s[0]+" in borders")}})}function c8(e,n,i,t){n.Fills=[];var r={},a=!1;(e[0].match(cr)||[]).forEach(function(o){var s=St(o);switch(Ba(s[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":r={},n.Fills.push(r);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":s.patternType&&(r.patternType=s.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":r.bgColor||(r.bgColor={}),s.indexed&&(r.bgColor.indexed=parseInt(s.indexed,10)),s.theme&&(r.bgColor.theme=parseInt(s.theme,10)),s.tint&&(r.bgColor.tint=parseFloat(s.tint)),s.rgb&&(r.bgColor.rgb=s.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":r.fgColor||(r.fgColor={}),s.theme&&(r.fgColor.theme=parseInt(s.theme,10)),s.tint&&(r.fgColor.tint=parseFloat(s.tint)),s.rgb!=null&&(r.fgColor.rgb=s.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fills")}})}function l8(e,n,i,t){n.Fonts=[];var r={},a=!1;(e[0].match(cr)||[]).forEach(function(o){var s=St(o);switch(Ba(s[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(r),r={};break;case"<name":s.val&&(r.name=yn(s.val));break;case"<name/>":case"</name>":break;case"<b":r.bold=s.val?Dn(s.val):1;break;case"<b/>":r.bold=1;break;case"<i":r.italic=s.val?Dn(s.val):1;break;case"<i/>":r.italic=1;break;case"<u":switch(s.val){case"none":r.underline=0;break;case"single":r.underline=1;break;case"double":r.underline=2;break;case"singleAccounting":r.underline=33;break;case"doubleAccounting":r.underline=34;break}break;case"<u/>":r.underline=1;break;case"<strike":r.strike=s.val?Dn(s.val):1;break;case"<strike/>":r.strike=1;break;case"<outline":r.outline=s.val?Dn(s.val):1;break;case"<outline/>":r.outline=1;break;case"<shadow":r.shadow=s.val?Dn(s.val):1;break;case"<shadow/>":r.shadow=1;break;case"<condense":r.condense=s.val?Dn(s.val):1;break;case"<condense/>":r.condense=1;break;case"<extend":r.extend=s.val?Dn(s.val):1;break;case"<extend/>":r.extend=1;break;case"<sz":s.val&&(r.sz=+s.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":s.val&&(r.vertAlign=s.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":s.val&&(r.family=parseInt(s.val,10));break;case"<family/>":case"</family>":break;case"<scheme":s.val&&(r.scheme=s.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(s.val=="1")break;s.codepage=tf[parseInt(s.val,10)];break;case"<color":if(r.color||(r.color={}),s.auto&&(r.color.auto=Dn(s.auto)),s.rgb)r.color.rgb=s.rgb.slice(-6);else if(s.indexed){r.color.index=parseInt(s.indexed,10);var u=ms[r.color.index];r.color.index==81&&(u=ms[1]),u||(u=ms[1]),r.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else s.theme&&(r.color.theme=parseInt(s.theme,10),s.tint&&(r.color.tint=parseFloat(s.tint)),s.theme&&i.themeElements&&i.themeElements.clrScheme&&(r.color.rgb=Zu(i.themeElements.clrScheme[r.color.theme].rgb,r.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fonts")}})}function d8(e,n,i){n.NumberFmt=[];for(var t=ii(Ct),r=0;r<t.length;++r)n.NumberFmt[t[r]]=Ct[t[r]];var a=e[0].match(cr);if(a)for(r=0;r<a.length;++r){var o=St(a[r]);switch(Ba(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var s=nn(yn(o.formatCode)),u=parseInt(o.numFmtId,10);if(n.NumberFmt[u]=s,u>0){if(u>392){for(u=392;u>60&&n.NumberFmt[u]!=null;--u);n.NumberFmt[u]=s}to(s,u)}}break;case"</numFmt>":break;default:if(i.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function u8(e){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var t=i[0];t<=i[1];++t)e[t]!=null&&(n[n.length]=ze("numFmt",null,{numFmtId:t,formatCode:Cn(e[t])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=ze("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var Lu=["numFmtId","fillId","fontId","borderId","xfId"],Vu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function m8(e,n,i){n.CellXf=[];var t,r=!1;(e[0].match(cr)||[]).forEach(function(a){var o=St(a),s=0;switch(Ba(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(t=o,delete t[0],s=0;s<Lu.length;++s)t[Lu[s]]&&(t[Lu[s]]=parseInt(t[Lu[s]],10));for(s=0;s<Vu.length;++s)t[Vu[s]]&&(t[Vu[s]]=Dn(t[Vu[s]]));if(n.NumberFmt&&t.numFmtId>392){for(s=392;s>60;--s)if(n.NumberFmt[t.numFmtId]==n.NumberFmt[s]){t.numFmtId=s;break}}n.CellXf.push(t);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Dn(o.wrapText)),t.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":r=!0;break;case"</AlternateContent>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(i&&i.WTF&&!r)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function g8(e){var n=[];return n[n.length]=ze("cellXfs",null),e.forEach(function(i){n[n.length]=ze("xf",null,i)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=ze("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var f8=function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,i=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,t=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,u,m){var f={};if(!s)return f;s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=s.match(n))&&d8(h,f,m),(h=s.match(r))&&l8(h,f,u,m),(h=s.match(t))&&c8(h,f,u,m),(h=s.match(a))&&s8(h,f,u,m),(h=s.match(i))&&m8(h,f,m),f}}();function ib(e,n){var i=[di,ze("styleSheet",null,{xmlns:ys[0],"xmlns:vt":Mi.vt})],t;return e.SSF&&(t=u8(e.SSF))!=null&&(i[i.length]=t),i[i.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',i[i.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',i[i.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',i[i.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(t=g8(n.cellXfs))&&(i[i.length]=t),i[i.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',i[i.length]='<dxfs count="0"/>',i[i.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',i.length>2&&(i[i.length]="</styleSheet>",i[1]=i[1].replace("/>",">")),i.join("")}function p8(e,n){var i=e.read_shift(2),t=or(e,n-2);return[i,t]}function h8(e,n,i){i||(i=ye(6+4*n.length)),i.write_shift(2,e),ji(n,i);var t=i.length>i.l?i.slice(0,i.l):i;return i.l==null&&(i.l=i.length),t}function x8(e,n,i){var t={};t.sz=e.read_shift(2)/20;var r=JE(e,2,i);r.fItalic&&(t.italic=1),r.fCondense&&(t.condense=1),r.fExtend&&(t.extend=1),r.fShadow&&(t.shadow=1),r.fOutline&&(t.outline=1),r.fStrikeout&&(t.strike=1);var a=e.read_shift(2);switch(a===700&&(t.bold=1),e.read_shift(2)){case 1:t.vertAlign="superscript";break;case 2:t.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(t.underline=o);var s=e.read_shift(1);s>0&&(t.family=s);var u=e.read_shift(1);switch(u>0&&(t.charset=u),e.l++,t.color=ZE(e,8),e.read_shift(1)){case 1:t.scheme="major";break;case 2:t.scheme="minor";break}return t.name=or(e,n-21),t}function _8(e,n){n||(n=ye(25+4*32)),n.write_shift(2,e.sz*20),QE(e,n),n.write_shift(2,e.bold?700:400);var i=0;e.vertAlign=="superscript"?i=1:e.vertAlign=="subscript"&&(i=2),n.write_shift(2,i),n.write_shift(1,e.underline||0),n.write_shift(1,e.family||0),n.write_shift(1,e.charset||0),n.write_shift(1,0),qu(e.color,n);var t=0;return e.scheme=="major"&&(t=1),e.scheme=="minor"&&(t=2),n.write_shift(1,t),ji(e.name,n),n.length>n.l?n.slice(0,n.l):n}var C8=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Rg,v8=sr;function bC(e,n){n||(n=ye(4*3+8*7+16*1)),Rg||(Rg=im(C8));var i=Rg[e.patternType];i==null&&(i=40),n.write_shift(4,i);var t=0;if(i!=40)for(qu({auto:1},n),qu({auto:1},n);t<12;++t)n.write_shift(4,0);else{for(;t<4;++t)n.write_shift(4,0);for(;t<12;++t)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function b8(e,n){var i=e.l+n,t=e.read_shift(2),r=e.read_shift(2);return e.l=i,{ixfe:t,numFmtId:r}}function rb(e,n,i){i||(i=ye(16)),i.write_shift(2,n||0),i.write_shift(2,e.numFmtId||0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(1,0),i.write_shift(1,0);var t=0;return i.write_shift(1,t),i.write_shift(1,0),i.write_shift(1,0),i.write_shift(1,0),i}function kl(e,n){return n||(n=ye(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var y8=sr;function M8(e,n){return n||(n=ye(51)),n.write_shift(1,0),kl(null,n),kl(null,n),kl(null,n),kl(null,n),kl(null,n),n.length>n.l?n.slice(0,n.l):n}function w8(e,n){return n||(n=ye(12+4*10)),n.write_shift(4,e.xfId),n.write_shift(2,1),n.write_shift(1,+e.builtinId),n.write_shift(1,0),Hu(e.name||"",n),n.length>n.l?n.slice(0,n.l):n}function S8(e,n,i){var t=ye(2052);return t.write_shift(4,e),Hu(n,t),Hu(i,t),t.length>t.l?t.slice(0,t.l):t}function P8(e,n,i){var t={};t.NumberFmt=[];for(var r in Ct)t.NumberFmt[r]=Ct[r];t.CellXf=[],t.Fonts=[];var a=[],o=!1;return ao(e,function(u,m,f){switch(f){case 44:t.NumberFmt[u[0]]=u[1],to(u[1],u[0]);break;case 43:t.Fonts.push(u),u.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(u.color.rgb=Zu(n.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&t.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(f),o=!0;break;case 38:a.pop(),o=!1;break;default:if(m.T>0)a.push(f);else if(m.T<0)a.pop();else if(!o||i.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),t}function O8(e,n){if(n){var i=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&++i}),i!=0&&(Ie(e,615,Ca(i)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&Ie(e,44,h8(r,n[r]))}),Ie(e,616))}}function k8(e){var n=1;n!=0&&(Ie(e,611,Ca(n)),Ie(e,43,_8({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Ie(e,612))}function E8(e){var n=2;n!=0&&(Ie(e,603,Ca(n)),Ie(e,45,bC({patternType:"none"})),Ie(e,45,bC({patternType:"gray125"})),Ie(e,604))}function T8(e){var n=1;n!=0&&(Ie(e,613,Ca(n)),Ie(e,46,M8({})),Ie(e,614))}function I8(e){var n=1;Ie(e,626,Ca(n)),Ie(e,47,rb({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Ie(e,627)}function A8(e,n){Ie(e,617,Ca(n.length)),n.forEach(function(i){Ie(e,47,rb(i,0))}),Ie(e,618)}function D8(e){var n=1;Ie(e,619,Ca(n)),Ie(e,48,w8({xfId:0,builtinId:0,name:"Normal"})),Ie(e,620)}function F8(e){var n=0;Ie(e,505,Ca(n)),Ie(e,506)}function R8(e){var n=0;Ie(e,508,S8(n,"TableStyleMedium9","PivotStyleMedium4")),Ie(e,509)}function N8(e,n){var i=kr();return Ie(i,278),O8(i,e.SSF),k8(i,e),E8(i,e),T8(i,e),I8(i,e),A8(i,n.cellXfs),D8(i,e),F8(i,e),R8(i,e),Ie(i,279),i.end()}var B8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function L8(e,n,i){n.themeElements.clrScheme=[];var t={};(e[0].match(cr)||[]).forEach(function(r){var a=St(r);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":t.rgb=a.val;break;case"<a:sysClr":t.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(n.themeElements.clrScheme[B8.indexOf(a[0])]=t,t={}):t.name=a[0].slice(3,a[0].length-1);break;default:if(i&&i.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function V8(){}function U8(){}var j8=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,z8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,W8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Y8(e,n,i){n.themeElements={};var t;[["clrScheme",j8,L8],["fontScheme",z8,V8],["fmtScheme",W8,U8]].forEach(function(r){if(!(t=e.match(r[1])))throw new Error(r[0]+" not found in themeElements");r[2](t,n,i)})}var $8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ab(e,n){(!e||e.length===0)&&(e=Df());var i,t={};if(!(i=e.match($8)))throw new Error("themeElements not found in theme");return Y8(i[0],t,n),t.raw=e,t}function Df(e,n){if(n&&n.themeXLSX)return n.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var i=[di];return i[i.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',i[i.length]="<a:themeElements>",i[i.length]='<a:clrScheme name="Office">',i[i.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',i[i.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',i[i.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',i[i.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',i[i.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',i[i.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',i[i.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',i[i.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',i[i.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',i[i.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',i[i.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',i[i.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',i[i.length]="</a:clrScheme>",i[i.length]='<a:fontScheme name="Office">',i[i.length]="<a:majorFont>",i[i.length]='<a:latin typeface="Cambria"/>',i[i.length]='<a:ea typeface=""/>',i[i.length]='<a:cs typeface=""/>',i[i.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',i[i.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',i[i.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',i[i.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',i[i.length]='<a:font script="Arab" typeface="Times New Roman"/>',i[i.length]='<a:font script="Hebr" typeface="Times New Roman"/>',i[i.length]='<a:font script="Thai" typeface="Tahoma"/>',i[i.length]='<a:font script="Ethi" typeface="Nyala"/>',i[i.length]='<a:font script="Beng" typeface="Vrinda"/>',i[i.length]='<a:font script="Gujr" typeface="Shruti"/>',i[i.length]='<a:font script="Khmr" typeface="MoolBoran"/>',i[i.length]='<a:font script="Knda" typeface="Tunga"/>',i[i.length]='<a:font script="Guru" typeface="Raavi"/>',i[i.length]='<a:font script="Cans" typeface="Euphemia"/>',i[i.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',i[i.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',i[i.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',i[i.length]='<a:font script="Thaa" typeface="MV Boli"/>',i[i.length]='<a:font script="Deva" typeface="Mangal"/>',i[i.length]='<a:font script="Telu" typeface="Gautami"/>',i[i.length]='<a:font script="Taml" typeface="Latha"/>',i[i.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',i[i.length]='<a:font script="Orya" typeface="Kalinga"/>',i[i.length]='<a:font script="Mlym" typeface="Kartika"/>',i[i.length]='<a:font script="Laoo" typeface="DokChampa"/>',i[i.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',i[i.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',i[i.length]='<a:font script="Viet" typeface="Times New Roman"/>',i[i.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',i[i.length]='<a:font script="Geor" typeface="Sylfaen"/>',i[i.length]="</a:majorFont>",i[i.length]="<a:minorFont>",i[i.length]='<a:latin typeface="Calibri"/>',i[i.length]='<a:ea typeface=""/>',i[i.length]='<a:cs typeface=""/>',i[i.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',i[i.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',i[i.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',i[i.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',i[i.length]='<a:font script="Arab" typeface="Arial"/>',i[i.length]='<a:font script="Hebr" typeface="Arial"/>',i[i.length]='<a:font script="Thai" typeface="Tahoma"/>',i[i.length]='<a:font script="Ethi" typeface="Nyala"/>',i[i.length]='<a:font script="Beng" typeface="Vrinda"/>',i[i.length]='<a:font script="Gujr" typeface="Shruti"/>',i[i.length]='<a:font script="Khmr" typeface="DaunPenh"/>',i[i.length]='<a:font script="Knda" typeface="Tunga"/>',i[i.length]='<a:font script="Guru" typeface="Raavi"/>',i[i.length]='<a:font script="Cans" typeface="Euphemia"/>',i[i.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',i[i.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',i[i.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',i[i.length]='<a:font script="Thaa" typeface="MV Boli"/>',i[i.length]='<a:font script="Deva" typeface="Mangal"/>',i[i.length]='<a:font script="Telu" typeface="Gautami"/>',i[i.length]='<a:font script="Taml" typeface="Latha"/>',i[i.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',i[i.length]='<a:font script="Orya" typeface="Kalinga"/>',i[i.length]='<a:font script="Mlym" typeface="Kartika"/>',i[i.length]='<a:font script="Laoo" typeface="DokChampa"/>',i[i.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',i[i.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',i[i.length]='<a:font script="Viet" typeface="Arial"/>',i[i.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',i[i.length]='<a:font script="Geor" typeface="Sylfaen"/>',i[i.length]="</a:minorFont>",i[i.length]="</a:fontScheme>",i[i.length]='<a:fmtScheme name="Office">',i[i.length]="<a:fillStyleLst>",i[i.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:lin ang="16200000" scaled="1"/>',i[i.length]="</a:gradFill>",i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:lin ang="16200000" scaled="0"/>',i[i.length]="</a:gradFill>",i[i.length]="</a:fillStyleLst>",i[i.length]="<a:lnStyleLst>",i[i.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]="</a:lnStyleLst>",i[i.length]="<a:effectStyleLst>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]="</a:effectStyle>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]="</a:effectStyle>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',i[i.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',i[i.length]="</a:effectStyle>",i[i.length]="</a:effectStyleLst>",i[i.length]="<a:bgFillStyleLst>",i[i.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',i[i.length]="</a:gradFill>",i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',i[i.length]="</a:gradFill>",i[i.length]="</a:bgFillStyleLst>",i[i.length]="</a:fmtScheme>",i[i.length]="</a:themeElements>",i[i.length]="<a:objectDefaults>",i[i.length]="<a:spDef>",i[i.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',i[i.length]="</a:spDef>",i[i.length]="<a:lnDef>",i[i.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',i[i.length]="</a:lnDef>",i[i.length]="</a:objectDefaults>",i[i.length]="<a:extraClrSchemeLst/>",i[i.length]="</a:theme>",i.join("")}function G8(e,n,i){var t=e.l+n,r=e.read_shift(4);if(r!==124226){if(!i.cellStyles){e.l=t;return}var a=e.slice(e.l);e.l=t;var o;try{o=nv(a,{type:"array"})}catch{return}var s=Ur(o,"theme/theme/theme1.xml",!0);if(s)return ab(s,i)}}function H8(e){return e.read_shift(4)}function q8(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=X8(e,4);break;case 2:n.xclrValue=Lv(e,4);break;case 3:n.xclrValue=H8(e,4);break;case 4:e.l+=4;break}return e.l+=8,n}function X8(e,n){return sr(e,n)}function K8(e,n){return sr(e,n)}function Z8(e){var n=e.read_shift(2),i=e.read_shift(2)-4,t=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:t[1]=q8(e,i);break;case 6:t[1]=K8(e,i);break;case 14:case 15:t[1]=e.read_shift(i===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+i)}return t}function J8(e,n){var i=e.l+n;e.l+=2;var t=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),a=[];r-- >0;)a.push(Z8(e,i-e.l));return{ixfe:t,ext:a}}function Q8(e,n){n.forEach(function(i){switch(i[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function eI(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:or(e,n-8)}}function tI(e){var n=ye(12+2*e.name.length);return n.write_shift(4,e.flags),n.write_shift(4,e.version),ji(e.name,n),n.slice(0,n.l)}function nI(e){for(var n=[],i=e.read_shift(4);i-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function iI(e){var n=ye(4+8*e.length);n.write_shift(4,e.length);for(var i=0;i<e.length;++i)n.write_shift(4,e[i][0]),n.write_shift(4,e[i][1]);return n}function rI(e,n){var i=ye(8+2*n.length);return i.write_shift(4,e),ji(n,i),i.slice(0,i.l)}function aI(e){return e.l+=4,e.read_shift(4)!=0}function oI(e,n){var i=ye(8);return i.write_shift(4,e),i.write_shift(4,n?1:0),i}function sI(e,n,i){var t={Types:[],Cell:[],Value:[]},r=i||{},a=[],o=!1,s=2;return ao(e,function(u,m,f){switch(f){case 335:t.Types.push({name:u.name});break;case 51:u.forEach(function(h){s==1?t.Cell.push({type:t.Types[h[0]-1].name,index:h[1]}):s==0&&t.Value.push({type:t.Types[h[0]-1].name,index:h[1]})});break;case 337:s=u?1:0;break;case 338:s=2;break;case 35:a.push(f),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!m.T){if(!o||r.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),t}function cI(){var e=kr();return Ie(e,332),Ie(e,334,Ca(1)),Ie(e,335,tI({name:"XLDAPR",version:12e4,flags:3496657072})),Ie(e,336),Ie(e,339,rI(1,"XLDAPR")),Ie(e,52),Ie(e,35,Ca(514)),Ie(e,4096,Ca(0)),Ie(e,4097,aa(1)),Ie(e,36),Ie(e,53),Ie(e,340),Ie(e,337,oI(1,!0)),Ie(e,51,iI([[1,0]])),Ie(e,338),Ie(e,333),e.end()}function lI(e,n,i){var t={Types:[],Cell:[],Value:[]};if(!e)return t;var r=!1,a=2,o;return e.replace(cr,function(s){var u=St(s);switch(Ba(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":t.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<t.Types.length;++m)t.Types[m].name==u.name&&(o=t.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?t.Cell.push({type:t.Types[u.t-1].name,index:+u.v}):a==0&&t.Value.push({type:t.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!r&&i.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return s}),t}function ob(){var e=[di];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function dI(e){var n=[];if(!e)return n;var i=1;return(e.match(cr)||[]).forEach(function(t){var r=St(t);switch(r[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?i=r.i:r.i=i,n.push(r);break}}),n}function uI(e){var n={};n.i=e.read_shift(4);var i={};i.r=e.read_shift(4),i.c=e.read_shift(4),n.r=vt(i);var t=e.read_shift(1);return t&2&&(n.l="1"),t&8&&(n.a="1"),n}function mI(e,n,i){var t=[],r=!1;return ao(e,function(o,s,u){switch(u){case 63:t.push(o);break;default:if(!s.T){if(!r||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),t}function gI(e,n,i,t){if(!e)return e;var r=t||{},a=!1,o=!1;ao(e,function(u,m,f){if(!o)switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!m.T){if(!a||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},r)}function fI(e,n){if(!e)return"??";var i=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][i].Target}var Rc=1024;function sb(e,n){for(var i=[21600,21600],t=["m0,0l0",i[1],i[0],i[1],i[0],"0xe"].join(","),r=[ze("xml",null,{"xmlns:v":Lr.v,"xmlns:o":Lr.o,"xmlns:x":Lr.x,"xmlns:mv":Lr.mv}).replace(/\/>/,">"),ze("o:shapelayout",ze("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ze("v:shapetype",[ze("v:stroke",null,{joinstyle:"miter"}),ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:i.join(","),path:t})];Rc<e*1e3;)Rc+=1e3;return n.forEach(function(a){var o=qn(a[0]),s={color2:"#BEFF82",type:"gradient"};s.type=="gradient"&&(s.angle="-180");var u=s.type=="gradient"?ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=ze("v:fill",u,s),f={on:"t",obscured:"t"};++Rc,r=r.concat(["<v:shape"+Yl({id:"_x0000_s"+Rc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,ze("v:shadow",null,f),ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Gi("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Gi("x:AutoFill","False"),Gi("x:Row",String(o.r)),Gi("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function yC(e,n,i,t){var r=Array.isArray(e),a;n.forEach(function(o){var s=qn(o.ref);if(r?(e[s.r]||(e[s.r]=[]),a=e[s.r][s.c]):a=e[o.ref],!a){a={t:"z"},r?e[s.r][s.c]=a:e[o.ref]=a;var u=rn(e["!ref"]||"BDWGO1000001:A1");u.s.r>s.r&&(u.s.r=s.r),u.e.r<s.r&&(u.e.r=s.r),u.s.c>s.c&&(u.s.c=s.c),u.e.c<s.c&&(u.e.c=s.c);var m=Ft(u);m!==e["!ref"]&&(e["!ref"]=m)}a.c||(a.c=[]);var f={a:o.author,t:o.t,r:o.r,T:i};o.h&&(f.h=o.h);for(var h=a.c.length-1;h>=0;--h){if(!i&&a.c[h].T)return;i&&!a.c[h].T&&a.c.splice(h,1)}if(i&&t){for(h=0;h<t.length;++h)if(f.a==t[h].id){f.a=t[h].name||f.a;break}}a.c.push(f)})}function pI(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var i=[],t=[],r=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);r&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var s=o.match(/<(?:\w+:)?author[^>]*>(.*)/);s&&i.push(s[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var s=o.match(/<(?:\w+:)?comment[^>]*>/);if(s){var u=St(s[0]),m={author:u.authorId&&i[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},f=qn(u.ref);if(!(n.sheetRows&&n.sheetRows<=f.r)){var h=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!h&&!!h[1]&&Tf(h[1])||{r:"",t:"",h:""};m.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),m.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(m.h=_.h),t.push(m)}}}}),t}function cb(e){var n=[di,ze("comments",null,{xmlns:ys[0]})],i=[];return n.push("<authors>"),e.forEach(function(t){t[1].forEach(function(r){var a=Cn(r.a);i.indexOf(a)==-1&&(i.push(a),n.push("<author>"+a+"</author>")),r.T&&r.ID&&i.indexOf("tc="+r.ID)==-1&&(i.push("tc="+r.ID),n.push("<author>tc="+r.ID+"</author>"))})}),i.length==0&&(i.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),e.forEach(function(t){var r=0,a=[];if(t[1][0]&&t[1][0].T&&t[1][0].ID?r=i.indexOf("tc="+t[1][0].ID):t[1].forEach(function(u){u.a&&(r=i.indexOf(Cn(u.a))),a.push(u.t||"")}),n.push('<comment ref="'+t[0]+'" authorId="'+r+'"><text>'),a.length<=1)n.push(Gi("t",Cn(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,s=1;s<a.length;++s)o+=`Reply:
    `+a[s]+`
`;n.push(Gi("t",Cn(o)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function hI(e,n){var i=[],t=!1,r={},a=0;return e.replace(cr,function(s,u){var m=St(s);switch(Ba(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":r={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":r.t!=null&&i.push(r);break;case"<text>":case"<text":a=u+s.length;break;case"</text>":r.t=e.slice(a,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":t=!0;break;case"</mentions>":t=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":t=!0;break;case"</ext>":t=!1;break;default:if(!t&&n.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return s}),i}function xI(e,n,i){var t=[di,ze("ThreadedComments",null,{xmlns:Mi.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(r){var a="";(r[1]||[]).forEach(function(o,s){if(!o.T){delete o.ID;return}o.a&&n.indexOf(o.a)==-1&&n.push(o.a);var u={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+i.tcid++).slice(-12)+"}"};s==0?a=u.id:u.parentId=a,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(o.a)).slice(-12)+"}"),t.push(ze("threadedComment",Gi("text",o.t||""),u))})}),t.push("</ThreadedComments>"),t.join("")}function _I(e,n){var i=[],t=!1;return e.replace(cr,function(a){var o=St(a);switch(Ba(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":i.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":t=!0;break;case"</ext>":t=!1;break;default:if(!t&&n.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),i}function CI(e){var n=[di,ze("personList",null,{xmlns:Mi.TCMNT,"xmlns:x":ys[0]}).replace(/[\/]>/,">")];return e.forEach(function(i,t){n.push(ze("person",null,{displayName:i,id:"{54EE7950-7262-4200-6969-"+("000000000000"+t).slice(-12)+"}",userId:i,providerId:"None"}))}),n.push("</personList>"),n.join("")}function vI(e){var n={};n.iauthor=e.read_shift(4);var i=Ps(e,16);return n.rfx=i.s,n.ref=vt(i.s),e.l+=16,n}function bI(e,n){return n==null&&(n=ye(36)),n.write_shift(4,e[1].iauthor),qc(e[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var yI=or;function MI(e){return ji(e.slice(0,54))}function wI(e,n){var i=[],t=[],r={},a=!1;return ao(e,function(s,u,m){switch(m){case 632:t.push(s);break;case 635:r=s;break;case 637:r.t=s.t,r.h=s.h,r.r=s.r;break;case 636:if(r.author=t[r.iauthor],delete r.iauthor,n.sheetRows&&r.rfx&&n.sheetRows<=r.rfx.r)break;r.t||(r.t=""),delete r.rfx,i.push(r);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!a||n.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),i}function SI(e){var n=kr(),i=[];return Ie(n,628),Ie(n,630),e.forEach(function(t){t[1].forEach(function(r){i.indexOf(r.a)>-1||(i.push(r.a.slice(0,54)),Ie(n,632,MI(r.a)))})}),Ie(n,631),Ie(n,633),e.forEach(function(t){t[1].forEach(function(r){r.iauthor=i.indexOf(r.a);var a={s:qn(t[0]),e:qn(t[0])};Ie(n,635,bI([a,r])),r.t&&r.t.length>0&&Ie(n,637,HE(r)),Ie(n,636),delete r.iauthor})}),Ie(n,634),Ie(n,629),n.end()}var PI="application/vnd.ms-office.vbaProject";function OI(e){var n=ft.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(i,t){if(!(i.slice(-1)==="/"||!i.match(/_VBA_PROJECT_CUR/))){var r=i.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ft.utils.cfb_add(n,r,e.FileIndex[t].content)}}),ft.write(n)}function kI(e,n){n.FullPaths.forEach(function(i,t){if(t!=0){var r=i.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&ft.utils.cfb_add(e,r,n.FileIndex[t].content)}})}var lb=["xlsb","xlsm","xlam","biff8","xla"];function EI(){return{"!type":"dialog"}}function TI(){return{"!type":"dialog"}}function II(){return{"!type":"macro"}}function AI(){return{"!type":"macro"}}var Lc=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function i(t,r,a,o){var s=!1,u=!1;a.length==0?u=!0:a.charAt(0)=="["&&(u=!0,a=a.slice(1,-1)),o.length==0?s=!0:o.charAt(0)=="["&&(s=!0,o=o.slice(1,-1));var m=a.length>0?parseInt(a,10)|0:0,f=o.length>0?parseInt(o,10)|0:0;return s?f+=n.c:--f,u?m+=n.r:--m,r+(s?"":"$")+Hn(f)+(u?"":"$")+li(m)}return function(r,a){return n=a,r.replace(e,i)}}(),Ff=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Rf=function(){return function(n,i){return n.replace(Ff,function(t,r,a,o,s,u){var m=bf(o)-(a?0:i.c),f=vf(u)-(s?0:i.r),h=f==0?"":s?f+1:"["+f+"]",_=m==0?"":a?m+1:"["+m+"]";return r+"R"+h+"C"+_})}}();function db(e,n){return e.replace(Ff,function(i,t,r,a,o,s){return t+(r=="$"?r+a:Hn(bf(a)+n.c))+(o=="$"?o+s:li(vf(s)+n.r))})}function DI(e,n,i){var t=Er(n),r=t.s,a=qn(i),o={r:a.r-r.r,c:a.c-r.c};return db(e,o)}function FI(e){return e.length!=1}function MC(e){return e.replace(/_xlfn\./g,"")}function _i(e){e.l+=1}function zo(e,n){var i=e.read_shift(n==1?1:2);return[i&16383,i>>14&1,i>>15&1]}function ub(e,n,i){var t=2;if(i){if(i.biff>=2&&i.biff<=5)return mb(e,n,i);i.biff==12&&(t=4)}var r=e.read_shift(t),a=e.read_shift(t),o=zo(e,2),s=zo(e,2);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function mb(e){var n=zo(e,2),i=zo(e,2),t=e.read_shift(1),r=e.read_shift(1);return{s:{r:n[0],c:t,cRel:n[1],rRel:n[2]},e:{r:i[0],c:r,cRel:i[1],rRel:i[2]}}}function RI(e,n,i){if(i.biff<8)return mb(e,n,i);var t=e.read_shift(i.biff==12?4:2),r=e.read_shift(i.biff==12?4:2),a=zo(e,2),o=zo(e,2);return{s:{r:t,c:a[0],cRel:a[1],rRel:a[2]},e:{r,c:o[0],cRel:o[1],rRel:o[2]}}}function gb(e,n,i){if(i&&i.biff>=2&&i.biff<=5)return NI(e,n,i);var t=e.read_shift(i&&i.biff==12?4:2),r=zo(e,2);return{r:t,c:r[0],cRel:r[1],rRel:r[2]}}function NI(e){var n=zo(e,2),i=e.read_shift(1);return{r:n[0],c:i,cRel:n[1],rRel:n[2]}}function BI(e){var n=e.read_shift(2),i=e.read_shift(2);return{r:n,c:i&255,fQuoted:!!(i&16384),cRel:i>>15,rRel:i>>15}}function LI(e,n,i){var t=i&&i.biff?i.biff:8;if(t>=2&&t<=5)return VI(e,n,i);var r=e.read_shift(t>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,s=(a&32768)>>15;if(a&=16383,s==1)for(;r>524287;)r-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r,c:a,cRel:o,rRel:s}}function VI(e){var n=e.read_shift(2),i=e.read_shift(1),t=(n&32768)>>15,r=(n&16384)>>14;return n&=16383,t==1&&n>=8192&&(n=n-16384),r==1&&i>=128&&(i=i-256),{r:n,c:i,cRel:r,rRel:t}}function UI(e,n,i){var t=(e[e.l++]&96)>>5,r=ub(e,i.biff>=2&&i.biff<=5?6:8,i);return[t,r]}function jI(e,n,i){var t=(e[e.l++]&96)>>5,r=e.read_shift(2,"i"),a=8;if(i)switch(i.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=ub(e,a,i);return[t,r,o]}function zI(e,n,i){var t=(e[e.l++]&96)>>5;return e.l+=i&&i.biff>8?12:i.biff<8?6:8,[t]}function WI(e,n,i){var t=(e[e.l++]&96)>>5,r=e.read_shift(2),a=8;if(i)switch(i.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[t,r]}function YI(e,n,i){var t=(e[e.l++]&96)>>5,r=RI(e,n-1,i);return[t,r]}function $I(e,n,i){var t=(e[e.l++]&96)>>5;return e.l+=i.biff==2?6:i.biff==12?14:7,[t]}function wC(e){var n=e[e.l+1]&1,i=1;return e.l+=4,[n,i]}function GI(e,n,i){e.l+=2;for(var t=e.read_shift(i&&i.biff==2?1:2),r=[],a=0;a<=t;++a)r.push(e.read_shift(i&&i.biff==2?1:2));return r}function HI(e,n,i){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(i&&i.biff==2?1:2)]}function qI(e,n,i){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(i&&i.biff==2?1:2)]}function XI(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function KI(e,n,i){var t=e[e.l+1]&255?1:0;return e.l+=i&&i.biff==2?3:4,[t]}function fb(e){var n=e.read_shift(1),i=e.read_shift(1);return[n,i]}function ZI(e){return e.read_shift(2),fb(e,2)}function JI(e){return e.read_shift(2),fb(e,2)}function QI(e,n,i){var t=(e[e.l]&96)>>5;e.l+=1;var r=gb(e,0,i);return[t,r]}function eA(e,n,i){var t=(e[e.l]&96)>>5;e.l+=1;var r=LI(e,0,i);return[t,r]}function tA(e,n,i){var t=(e[e.l]&96)>>5;e.l+=1;var r=e.read_shift(2);i&&i.biff==5&&(e.l+=12);var a=gb(e,0,i);return[t,r,a]}function nA(e,n,i){var t=(e[e.l]&96)>>5;e.l+=1;var r=e.read_shift(i&&i.biff<=3?1:2);return[aD[r],xb[r],t]}function iA(e,n,i){var t=e[e.l++],r=e.read_shift(1),a=i&&i.biff<=3?[t==88?-1:0,e.read_shift(1)]:rA(e);return[r,(a[0]===0?xb:rD)[a[1]]]}function rA(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function aA(e,n,i){e.l+=i&&i.biff==2?3:4}function oA(e,n,i){if(e.l++,i&&i.biff==12)return[e.read_shift(4,"i"),0];var t=e.read_shift(2),r=e.read_shift(i&&i.biff==2?1:2);return[t,r]}function sA(e){return e.l++,oo[e.read_shift(1)]}function cA(e){return e.l++,e.read_shift(2)}function lA(e){return e.l++,e.read_shift(1)!==0}function dA(e){return e.l++,rr(e,8)}function uA(e,n,i){return e.l++,t0(e,n-1,i)}function mA(e,n){var i=[e.read_shift(1)];if(n==12)switch(i[0]){case 2:i[0]=4;break;case 4:i[0]=16;break;case 0:i[0]=1;break;case 1:i[0]=2;break}switch(i[0]){case 4:i[1]=ci(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:i[1]=oo[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:i[1]=rr(e,8);break;case 2:i[1]=Os(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+i[0])}return i}function gA(e,n,i){for(var t=e.read_shift(i.biff==12?4:2),r=[],a=0;a!=t;++a)r.push((i.biff==12?Ps:sm)(e,8));return r}function fA(e,n,i){var t=0,r=0;i.biff==12?(t=e.read_shift(4),r=e.read_shift(4)):(r=1+e.read_shift(1),t=1+e.read_shift(2)),i.biff>=2&&i.biff<8&&(--t,--r==0&&(r=256));for(var a=0,o=[];a!=t&&(o[a]=[]);++a)for(var s=0;s!=r;++s)o[a][s]=mA(e,i.biff);return o}function pA(e,n,i){var t=e.read_shift(1)>>>5&3,r=!i||i.biff>=8?4:2,a=e.read_shift(r);switch(i.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[t,0,a]}function hA(e,n,i){if(i.biff==5)return xA(e,n,i);var t=e.read_shift(1)>>>5&3,r=e.read_shift(2),a=e.read_shift(4);return[t,r,a]}function xA(e){var n=e.read_shift(1)>>>5&3,i=e.read_shift(2,"i");e.l+=8;var t=e.read_shift(2);return e.l+=12,[n,i,t]}function _A(e,n,i){var t=e.read_shift(1)>>>5&3;e.l+=i&&i.biff==2?3:4;var r=e.read_shift(i&&i.biff==2?1:2);return[t,r]}function CA(e,n,i){var t=e.read_shift(1)>>>5&3,r=e.read_shift(i&&i.biff==2?1:2);return[t,r]}function vA(e,n,i){var t=e.read_shift(1)>>>5&3;return e.l+=4,i.biff<8&&e.l--,i.biff==12&&(e.l+=2),[t]}function bA(e,n,i){var t=(e[e.l++]&96)>>5,r=e.read_shift(2),a=4;if(i)switch(i.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[t,r]}var yA=sr,MA=sr,wA=sr;function i0(e,n,i){return e.l+=2,[BI(e,4,i)]}function Nf(e){return e.l+=6,[]}var SA=i0,PA=Nf,OA=Nf,kA=i0;function pb(e){return e.l+=2,[vi(e),e.read_shift(2)&1]}var EA=i0,TA=pb,IA=Nf,AA=i0,DA=i0,FA=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function RA(e){e.l+=2;var n=e.read_shift(2),i=e.read_shift(2),t=e.read_shift(4),r=e.read_shift(2),a=e.read_shift(2),o=FA[i>>2&31];return{ixti:n,coltype:i&3,rt:o,idx:t,c:r,C:a}}function NA(e){return e.l+=2,[e.read_shift(4)]}function BA(e,n,i){return e.l+=5,e.l+=2,e.l+=i.biff==2?1:4,["PTGSHEET"]}function LA(e,n,i){return e.l+=i.biff==2?4:5,["PTGENDSHEET"]}function VA(e){var n=e.read_shift(1)>>>5&3,i=e.read_shift(2);return[n,i]}function UA(e){var n=e.read_shift(1)>>>5&3,i=e.read_shift(2);return[n,i]}function jA(e){return e.l+=4,[0,0]}var SC={1:{n:"PtgExp",f:oA},2:{n:"PtgTbl",f:wA},3:{n:"PtgAdd",f:_i},4:{n:"PtgSub",f:_i},5:{n:"PtgMul",f:_i},6:{n:"PtgDiv",f:_i},7:{n:"PtgPower",f:_i},8:{n:"PtgConcat",f:_i},9:{n:"PtgLt",f:_i},10:{n:"PtgLe",f:_i},11:{n:"PtgEq",f:_i},12:{n:"PtgGe",f:_i},13:{n:"PtgGt",f:_i},14:{n:"PtgNe",f:_i},15:{n:"PtgIsect",f:_i},16:{n:"PtgUnion",f:_i},17:{n:"PtgRange",f:_i},18:{n:"PtgUplus",f:_i},19:{n:"PtgUminus",f:_i},20:{n:"PtgPercent",f:_i},21:{n:"PtgParen",f:_i},22:{n:"PtgMissArg",f:_i},23:{n:"PtgStr",f:uA},26:{n:"PtgSheet",f:BA},27:{n:"PtgEndSheet",f:LA},28:{n:"PtgErr",f:sA},29:{n:"PtgBool",f:lA},30:{n:"PtgInt",f:cA},31:{n:"PtgNum",f:dA},32:{n:"PtgArray",f:$I},33:{n:"PtgFunc",f:nA},34:{n:"PtgFuncVar",f:iA},35:{n:"PtgName",f:pA},36:{n:"PtgRef",f:QI},37:{n:"PtgArea",f:UI},38:{n:"PtgMemArea",f:_A},39:{n:"PtgMemErr",f:yA},40:{n:"PtgMemNoMem",f:MA},41:{n:"PtgMemFunc",f:CA},42:{n:"PtgRefErr",f:vA},43:{n:"PtgAreaErr",f:zI},44:{n:"PtgRefN",f:eA},45:{n:"PtgAreaN",f:YI},46:{n:"PtgMemAreaN",f:VA},47:{n:"PtgMemNoMemN",f:UA},57:{n:"PtgNameX",f:hA},58:{n:"PtgRef3d",f:tA},59:{n:"PtgArea3d",f:jI},60:{n:"PtgRefErr3d",f:bA},61:{n:"PtgAreaErr3d",f:WI},255:{}},zA={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},WA={1:{n:"PtgElfLel",f:pb},2:{n:"PtgElfRw",f:AA},3:{n:"PtgElfCol",f:SA},6:{n:"PtgElfRwV",f:DA},7:{n:"PtgElfColV",f:kA},10:{n:"PtgElfRadical",f:EA},11:{n:"PtgElfRadicalS",f:IA},13:{n:"PtgElfColS",f:PA},15:{n:"PtgElfColSV",f:OA},16:{n:"PtgElfRadicalLel",f:TA},25:{n:"PtgList",f:RA},29:{n:"PtgSxName",f:NA},255:{}},YA={0:{n:"PtgAttrNoop",f:jA},1:{n:"PtgAttrSemi",f:KI},2:{n:"PtgAttrIf",f:qI},4:{n:"PtgAttrChoose",f:GI},8:{n:"PtgAttrGoto",f:HI},16:{n:"PtgAttrSum",f:aA},32:{n:"PtgAttrBaxcel",f:wC},33:{n:"PtgAttrBaxcel",f:wC},64:{n:"PtgAttrSpace",f:ZI},65:{n:"PtgAttrSpaceSemi",f:JI},128:{n:"PtgAttrIfError",f:XI},255:{}};function r0(e,n,i,t){if(t.biff<8)return sr(e,n);for(var r=e.l+n,a=[],o=0;o!==i.length;++o)switch(i[o][0]){case"PtgArray":i[o][1]=fA(e,0,t),a.push(i[o][1]);break;case"PtgMemArea":i[o][2]=gA(e,i[o][1],t),a.push(i[o][2]);break;case"PtgExp":t&&t.biff==12&&(i[o][1][1]=e.read_shift(4),a.push(i[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+i[o][0];default:break}return n=r-e.l,n!==0&&a.push(sr(e,n)),a}function a0(e,n,i){for(var t=e.l+n,r,a,o=[];t!=e.l;)n=t-e.l,a=e[e.l],r=SC[a]||SC[zA[a]],(a===24||a===25)&&(r=(a===24?WA:YA)[e[e.l+1]]),!r||!r.f?sr(e,n):o.push([r.n,r.f(e,n,i)]);return o}function $A(e){for(var n=[],i=0;i<e.length;++i){for(var t=e[i],r=[],a=0;a<t.length;++a){var o=t[a];if(o)switch(o[0]){case 2:r.push('"'+o[1].replace(/"/g,'""')+'"');break;default:r.push(o[1])}else r.push("")}n.push(r.join(","))}return n.join(";")}var GA={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function HA(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function hb(e,n,i){if(!e)return"SH33TJSERR0";if(i.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var t=e.XTI[n];if(i.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!t)return"SH33TJSERR1";var r="";if(i.biff>8)switch(e[t[0]][0]){case 357:return r=t[1]==-1?"#REF":e.SheetNames[t[1]],t[1]==t[2]?r:r+":"+e.SheetNames[t[2]];case 358:return i.SID!=null?e.SheetNames[i.SID]:"SH33TJSSAME"+e[t[0]][0];case 355:default:return"SH33TJSSRC"+e[t[0]][0]}switch(e[t[0]][0][0]){case 1025:return r=t[1]==-1?"#REF":e.SheetNames[t[1]]||"SH33TJSERR3",t[1]==t[2]?r:r+":"+e.SheetNames[t[2]];case 14849:return e[t[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[t[0]][0][3]?(r=t[1]==-1?"#REF":e[t[0]][0][3][t[1]]||"SH33TJSERR4",t[1]==t[2]?r:r+":"+e[t[0]][0][3][t[2]]):"SH33TJSERR2"}}function PC(e,n,i){var t=hb(e,n,i);return t=="#REF"?t:HA(t,i)}function nr(e,n,i,t,r){var a=r&&r.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},s=[],u,m,f,h=0,_=0,y,v="";if(!e[0]||!e[0][0])return"";for(var C=-1,P="",D=0,T=e[0].length;D<T;++D){var I=e[0][D];switch(I[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=s.pop(),m=s.pop(),C>=0){switch(e[0][C][1][0]){case 0:P=ei(" ",e[0][C][1][1]);break;case 1:P=ei("\r",e[0][C][1][1]);break;default:if(P="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][C][1][0])}m=m+P,C=-1}s.push(m+GA[I[0]]+u);break;case"PtgIsect":u=s.pop(),m=s.pop(),s.push(m+" "+u);break;case"PtgUnion":u=s.pop(),m=s.pop(),s.push(m+","+u);break;case"PtgRange":u=s.pop(),m=s.pop(),s.push(m+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Dl(I[1][1],o,r),s.push(Fl(f,a));break;case"PtgRefN":f=i?Dl(I[1][1],i,r):I[1][1],s.push(Fl(f,a));break;case"PtgRef3d":h=I[1][1],f=Dl(I[1][2],o,r),v=PC(t,h,r);var K=v;s.push(v+"!"+Fl(f,a));break;case"PtgFunc":case"PtgFuncVar":var ee=I[1][0],k=I[1][1];ee||(ee=0),ee&=127;var O=ee==0?[]:s.slice(-ee);s.length-=ee,k==="User"&&(k=O.shift()),s.push(k+"("+O.join(",")+")");break;case"PtgBool":s.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":s.push(I[1]);break;case"PtgNum":s.push(String(I[1]));break;case"PtgStr":s.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":s.push(I[1]);break;case"PtgAreaN":y=tC(I[1][1],i?{s:i}:o,r),s.push(Ig(y,r));break;case"PtgArea":y=tC(I[1][1],o,r),s.push(Ig(y,r));break;case"PtgArea3d":h=I[1][1],y=I[1][2],v=PC(t,h,r),s.push(v+"!"+Ig(y,r));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=I[1][2];var R=(t.names||[])[_-1]||(t[0]||[])[_],U=R?R.Name:"SH33TJSNAME"+String(_);U&&U.slice(0,6)=="_xlfn."&&!r.xlfn&&(U=U.slice(6)),s.push(U);break;case"PtgNameX":var Q=I[1][1];_=I[1][2];var re;if(r.biff<=5)Q<0&&(Q=-Q),t[Q]&&(re=t[Q][_]);else{var ie="";if(((t[Q]||[])[0]||[])[0]==14849||(((t[Q]||[])[0]||[])[0]==1025?t[Q][_]&&t[Q][_].itab>0&&(ie=t.SheetNames[t[Q][_].itab-1]+"!"):ie=t.SheetNames[_-1]+"!"),t[Q]&&t[Q][_])ie+=t[Q][_].Name;else if(t[0]&&t[0][_])ie+=t[0][_].Name;else{var Pe=(hb(t,Q,r)||"").split(";;");Pe[_-1]?ie=Pe[_-1]:ie+="SH33TJSERRX"}s.push(ie);break}re||(re={Name:"SH33TJSERRY"}),s.push(re.Name);break;case"PtgParen":var Re="(",xe=")";if(C>=0){switch(P="",e[0][C][1][0]){case 2:Re=ei(" ",e[0][C][1][1])+Re;break;case 3:Re=ei("\r",e[0][C][1][1])+Re;break;case 4:xe=ei(" ",e[0][C][1][1])+xe;break;case 5:xe=ei("\r",e[0][C][1][1])+xe;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][C][1][0])}C=-1}s.push(Re+s.pop()+xe);break;case"PtgRefErr":s.push("#REF!");break;case"PtgRefErr3d":s.push("#REF!");break;case"PtgExp":f={c:I[1][1],r:I[1][0]};var Be={c:i.c,r:i.r};if(t.sharedf[vt(f)]){var we=t.sharedf[vt(f)];s.push(nr(we,o,Be,t,r))}else{var $e=!1;for(u=0;u!=t.arrayf.length;++u)if(m=t.arrayf[u],!(f.c<m[0].s.c||f.c>m[0].e.c)&&!(f.r<m[0].s.r||f.r>m[0].e.r)){s.push(nr(m[1],o,Be,t,r)),$e=!0;break}$e||s.push(I[1])}break;case"PtgArray":s.push("{"+$A(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":C=D;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":s.push("");break;case"PtgAreaErr":s.push("#REF!");break;case"PtgAreaErr3d":s.push("#REF!");break;case"PtgList":s.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var Se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&C>=0&&Se.indexOf(e[0][D][0])==-1){I=e[0][C];var Ae=!0;switch(I[1][0]){case 4:Ae=!1;case 0:P=ei(" ",I[1][1]);break;case 5:Ae=!1;case 1:P=ei("\r",I[1][1]);break;default:if(P="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}s.push((Ae?P:"")+s.pop()+(Ae?"":P)),C=-1}}if(s.length>1&&r.WTF)throw new Error("bad formula stack");return s[0]}function qA(e,n,i){var t=e.l+n,r=i.biff==2?1:2,a,o=e.read_shift(r);if(o==65535)return[[],sr(e,n-2)];var s=a0(e,o,i);return n!==o+r&&(a=r0(e,n-o-r,s,i)),e.l=t,[s,a]}function XA(e,n,i){var t=e.l+n,r=i.biff==2?1:2,a,o=e.read_shift(r);if(o==65535)return[[],sr(e,n-2)];var s=a0(e,o,i);return n!==o+r&&(a=r0(e,n-o-r,s,i)),e.l=t,[s,a]}function KA(e,n,i,t){var r=e.l+n,a=a0(e,t,i),o;return r!==e.l&&(o=r0(e,r-e.l,a,i)),[a,o]}function ZA(e,n,i){var t=e.l+n,r,a=e.read_shift(2),o=a0(e,a,i);return a==65535?[[],sr(e,n-2)]:(n!==a+2&&(r=r0(e,t-a-2,o,i)),[o,r])}function JA(e){var n;if(Qa(e,e.l+6)!==65535)return[rr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function QA(e){if(e==null){var n=ye(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof e=="number")return _s(e);return _s(0)}function Ng(e,n,i){var t=e.l+n,r=La(e,6);i.biff==2&&++e.l;var a=JA(e,8),o=e.read_shift(1);i.biff!=2&&(e.read_shift(1),i.biff>=5&&e.read_shift(4));var s=XA(e,t-e.l,i);return{cell:r,val:a[0],formula:s,shared:o>>3&1,tt:a[1]}}function eD(e,n,i,t,r){var a=vs(n,i,r),o=QA(e.v),s=ye(6),u=33;s.write_shift(2,u),s.write_shift(4,0);for(var m=ye(e.bf.length),f=0;f<e.bf.length;++f)m[f]=e.bf[f];var h=Ui([a,o,s,m]);return h}function cm(e,n,i){var t=e.read_shift(4),r=a0(e,t,i),a=e.read_shift(4),o=a>0?r0(e,a,r,i):null;return[r,o]}var tD=cm,lm=cm,nD=cm,iD=cm,rD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},xb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},aD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function OC(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,i){return i.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function oD(e){var n="of:="+e.replace(Ff,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function Bg(e){var n=e.split(":"),i=n[0].split(".")[0];return[i,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}function sD(e){return e.replace(/\./,"!")}var Nl={},Vc={},Bl=typeof Map<"u";function Bf(e,n,i){var t=0,r=e.length;if(i){if(Bl?i.has(n):Object.prototype.hasOwnProperty.call(i,n)){for(var a=Bl?i.get(n):i[n];t<a.length;++t)if(e[a[t]].t===n)return e.Count++,a[t]}}else for(;t<r;++t)if(e[t].t===n)return e.Count++,t;return e[r]={t:n},e.Count++,e.Unique++,i&&(Bl?(i.has(n)||i.set(n,[]),i.get(n).push(r)):(Object.prototype.hasOwnProperty.call(i,n)||(i[n]=[]),i[n].push(r))),r}function dm(e,n){var i={min:e+1,max:e+1},t=-1;return n.MDW&&(ir=n.MDW),n.width!=null?i.customWidth=1:n.wpx!=null?t=Xl(n.wpx):n.wch!=null&&(t=n.wch),t>-1?(i.width=Ju(t),i.customWidth=1):n.width!=null&&(i.width=n.width),n.hidden&&(i.hidden=!0),n.level!=null&&(i.outlineLevel=i.level=n.level),i}function ps(e,n){if(e){var i=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(i=[1,1,1,1,.5,.5]),e.left==null&&(e.left=i[0]),e.right==null&&(e.right=i[1]),e.top==null&&(e.top=i[2]),e.bottom==null&&(e.bottom=i[3]),e.header==null&&(e.header=i[4]),e.footer==null&&(e.footer=i[5])}}function Go(e,n,i){var t=i.revssf[n.z!=null?n.z:"General"],r=60,a=e.length;if(t==null&&i.ssf){for(;r<392;++r)if(i.ssf[r]==null){to(n.z,r),i.ssf[r]=n.z,i.revssf[n.z]=t=r;break}}for(r=0;r!=a;++r)if(e[r].numFmtId===t)return r;return e[a]={numFmtId:t,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function _b(e,n,i,t,r,a){try{t.cellNF&&(e.z=Ct[n])}catch(s){if(t.WTF)throw s}if(!(e.t==="z"&&!t.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Fn(e.v)),(!t||t.cellText!==!1)&&e.t!=="z")try{if(Ct[n]==null&&to(rE[n]||"General",n),e.t==="e")e.w=e.w||oo[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zl(e.v);else if(e.t==="d"){var o=wi(e.v);(o|0)===o?e.w=o.toString(10):e.w=zl(o)}else{if(e.v===void 0)return"";e.w=hs(e.v,Vc)}else e.t==="d"?e.w=sa(n,wi(e.v),Vc):e.w=sa(n,e.v,Vc)}catch(s){if(t.WTF)throw s}if(t.cellStyles&&i!=null)try{e.s=a.Fills[i],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Zu(r.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),t.WTF&&(e.s.fgColor.raw_rgb=r.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Zu(r.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),t.WTF&&(e.s.bgColor.raw_rgb=r.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(s){if(t.WTF&&a.Fills)throw s}}}function cD(e,n,i){if(e&&e["!ref"]){var t=rn(e["!ref"]);if(t.e.c<t.s.c||t.e.r<t.s.r)throw new Error("Bad range ("+i+"): "+e["!ref"])}}function lD(e,n){var i=rn(n);i.s.r<=i.e.r&&i.s.c<=i.e.c&&i.s.r>=0&&i.s.c>=0&&(e["!ref"]=Ft(i))}var dD=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,uD=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,mD=/<(?:\w:)?hyperlink [^>]*>/mg,gD=/"(\w*:\w*)"/,fD=/<(?:\w:)?col\b[^>]*[\/]?>/g,pD=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,hD=/<(?:\w:)?pageMargins[^>]*\/>/g,Cb=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,xD=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,_D=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function CD(e,n,i,t,r,a,o){if(!e)return e;t||(t={"!id":{}}),ni!=null&&n.dense==null&&(n.dense=ni);var s=n.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",f="",h=e.match(uD);h?(m=e.slice(0,h.index),f=e.slice(h.index+h[0].length)):m=f=e;var _=m.match(Cb);_?Lf(_[0],s,r,i):(_=m.match(xD))&&bD(_[0],_[1]||"",s,r,i,o,a);var y=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var v=m.slice(y,y+50).match(gD);v&&lD(s,v[1])}var C=m.match(_D);C&&C[1]&&FD(C[1],r);var P=[];if(n.cellStyles){var D=m.match(fD);D&&ED(P,D)}h&&BD(h[1],s,n,u,a,o);var T=f.match(pD);T&&(s["!autofilter"]=ID(T[0]));var I=[],K=f.match(dD);if(K)for(y=0;y!=K.length;++y)I[y]=rn(K[y].slice(K[y].indexOf('"')+1));var ee=f.match(mD);ee&&PD(s,ee,t);var k=f.match(hD);if(k&&(s["!margins"]=OD(St(k[0]))),!s["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(s["!ref"]=Ft(u)),n.sheetRows>0&&s["!ref"]){var O=rn(s["!ref"]);n.sheetRows<=+O.e.r&&(O.e.r=n.sheetRows-1,O.e.r>u.e.r&&(O.e.r=u.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>u.e.c&&(O.e.c=u.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),s["!fullref"]=s["!ref"],s["!ref"]=Ft(O))}return P.length>0&&(s["!cols"]=P),I.length>0&&(s["!merges"]=I),s}function vD(e){if(e.length===0)return"";for(var n='<mergeCells count="'+e.length+'">',i=0;i!=e.length;++i)n+='<mergeCell ref="'+Ft(e[i])+'"/>';return n+"</mergeCells>"}function Lf(e,n,i,t){var r=St(e);i.Sheets[t]||(i.Sheets[t]={}),r.codeName&&(i.Sheets[t].CodeName=nn(yn(r.codeName)))}function bD(e,n,i,t,r){Lf(e.slice(0,e.indexOf(">")),i,t,r)}function yD(e,n,i,t,r){var a=!1,o={},s=null;if(t.bookType!=="xlsx"&&n.vbaraw){var u=n.SheetNames[i];try{n.Workbook&&(u=n.Workbook.Sheets[i].CodeName||u)}catch{}a=!0,o.codeName=Ra(Cn(u))}if(e&&e["!outline"]){var m={summaryBelow:1,summaryRight:1};e["!outline"].above&&(m.summaryBelow=0),e["!outline"].left&&(m.summaryRight=0),s=(s||"")+ze("outlinePr",null,m)}!a&&!s||(r[r.length]=ze("sheetPr",s,o))}var MD=["objects","scenarios","selectLockedCells","selectUnlockedCells"],wD=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function SD(e){var n={sheet:1};return MD.forEach(function(i){e[i]!=null&&e[i]&&(n[i]="1")}),wD.forEach(function(i){e[i]!=null&&!e[i]&&(n[i]="0")}),e.password&&(n.password=If(e.password).toString(16).toUpperCase()),ze("sheetProtection",null,n)}function PD(e,n,i){for(var t=Array.isArray(e),r=0;r!=n.length;++r){var a=St(yn(n[r]),!0);if(!a.ref)return;var o=((i||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+nn(a.location))):(a.Target="#"+nn(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var s=rn(a.ref),u=s.s.r;u<=s.e.r;++u)for(var m=s.s.c;m<=s.e.c;++m){var f=vt({c:m,r:u});t?(e[u]||(e[u]=[]),e[u][m]||(e[u][m]={t:"z",v:void 0}),e[u][m].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function OD(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(i){e[i]&&(n[i]=parseFloat(e[i]))}),n}function kD(e){return ps(e),ze("pageMargins",null,e)}function ED(e,n){for(var i=!1,t=0;t!=n.length;++t){var r=St(n[t],!0);r.hidden&&(r.hidden=Dn(r.hidden));var a=parseInt(r.min,10)-1,o=parseInt(r.max,10)-1;for(r.outlineLevel&&(r.level=+r.outlineLevel||0),delete r.min,delete r.max,r.width=+r.width,!i&&r.width&&(i=!0,Af(r.width)),jo(r);a<=o;)e[a++]=Rn(r)}}function TD(e,n){for(var i=["<cols>"],t,r=0;r!=n.length;++r)(t=n[r])&&(i[i.length]=ze("col",null,dm(r,t)));return i[i.length]="</cols>",i.join("")}function ID(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}function AD(e,n,i,t){var r=typeof e.ref=="string"?e.ref:Ft(e.ref);i.Workbook||(i.Workbook={Sheets:[]}),i.Workbook.Names||(i.Workbook.Names=[]);var a=i.Workbook.Names,o=Er(r);o.s.r==o.e.r&&(o.e.r=Er(n["!ref"]).e.r,r=Ft(o));for(var s=0;s<a.length;++s){var u=a[s];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==t){u.Ref="'"+i.SheetNames[t]+"'!"+r;break}}return s==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:t,Ref:"'"+i.SheetNames[t]+"'!"+r}),ze("autoFilter",null,{ref:r})}var DD=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function FD(e,n){n.Views||(n.Views=[{}]),(e.match(DD)||[]).forEach(function(i,t){var r=St(i);n.Views[t]||(n.Views[t]={}),+r.zoomScale&&(n.Views[t].zoom=+r.zoomScale),Dn(r.rightToLeft)&&(n.Views[t].RTL=!0)})}function RD(e,n,i,t){var r={workbookViewId:"0"};return(((t||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=t.Workbook.Views[0].RTL?"1":"0"),ze("sheetViews",ze("sheetView",null,r),{})}function ND(e,n,i,t){if(e.c&&i["!comments"].push([n,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var r="",a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":r=e.v?"1":"0";break;case"n":r=""+e.v;break;case"e":r=oo[e.v];break;case"d":t&&t.cellDates?r=Fn(e.v,-1).toISOString():(e=Rn(e),e.t="n",r=""+(e.v=wi(Fn(e.v)))),typeof e.z>"u"&&(e.z=Ct[14]);break;default:r=e.v;break}var s=Gi("v",Cn(r)),u={r:n},m=Go(t.cellXfs,e,t);switch(m!==0&&(u.s=m),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(t&&t.bookSST){s=Gi("v",""+Bf(t.Strings,e.v,t.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=a&&(e.t=a,e.v=o),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,n.length)==n?{t:"array",ref:e.F}:null;s=ze("f",Cn(e.f),f)+(e.v!=null?s:"")}return e.l&&i["!links"].push([n,e.l]),e.D&&(u.cm=1),ze("c",s,u)}var BD=function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,i=/r=["']([^"']*)["']/,t=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,r=/ref=["']([^"']*)["']/,a=Wl("v"),o=Wl("f");return function(u,m,f,h,_,y){for(var v=0,C="",P=[],D=[],T=0,I=0,K=0,ee="",k,O,R=0,U=0,Q,re,ie=0,Pe=0,Re=Array.isArray(y.CellXf),xe,Be=[],we=[],$e=Array.isArray(m),Se=[],Ae={},ce=!1,Y=!!f.sheetStubs,te=u.split(n),Z=0,J=te.length;Z!=J;++Z){C=te[Z].trim();var de=C.length;if(de!==0){var Oe=0;e:for(v=0;v<de;++v)switch(C[v]){case">":if(C[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(O=St(C.slice(Oe,v),!0),R=O.r!=null?parseInt(O.r,10):R+1,U=-1,f.sheetRows&&f.sheetRows<R)continue;Ae={},ce=!1,O.ht&&(ce=!0,Ae.hpt=parseFloat(O.ht),Ae.hpx=Wc(Ae.hpt)),O.hidden=="1"&&(ce=!0,Ae.hidden=!0),O.outlineLevel!=null&&(ce=!0,Ae.level=+O.outlineLevel),ce&&(Se[R-1]=Ae)}break;case"<":Oe=v;break}if(Oe>=v)break;if(O=St(C.slice(Oe,v),!0),R=O.r!=null?parseInt(O.r,10):R+1,U=-1,!(f.sheetRows&&f.sheetRows<R)){h.s.r>R-1&&(h.s.r=R-1),h.e.r<R-1&&(h.e.r=R-1),f&&f.cellStyles&&(Ae={},ce=!1,O.ht&&(ce=!0,Ae.hpt=parseFloat(O.ht),Ae.hpx=Wc(Ae.hpt)),O.hidden=="1"&&(ce=!0,Ae.hidden=!0),O.outlineLevel!=null&&(ce=!0,Ae.level=+O.outlineLevel),ce&&(Se[R-1]=Ae)),P=C.slice(v).split(e);for(var ke=0;ke!=P.length&&P[ke].trim().charAt(0)=="<";++ke);for(P=P.slice(ke),v=0;v!=P.length;++v)if(C=P[v].trim(),C.length!==0){if(D=C.match(i),T=v,I=0,K=0,C="<c "+(C.slice(0,1)=="<"?">":"")+C,D!=null&&D.length===2){for(T=0,ee=D[1],I=0;I!=ee.length&&!((K=ee.charCodeAt(I)-64)<1||K>26);++I)T=26*T+K;--T,U=T}else++U;for(I=0;I!=C.length&&C.charCodeAt(I)!==62;++I);if(++I,O=St(C.slice(0,I),!0),O.r||(O.r=vt({r:R-1,c:U})),ee=C.slice(I),k={t:""},(D=ee.match(a))!=null&&D[1]!==""&&(k.v=nn(D[1])),f.cellFormula){if((D=ee.match(o))!=null&&D[1]!==""){if(k.f=nn(yn(D[1])).replace(/\r\n/g,`
`),f.xlfn||(k.f=MC(k.f)),D[0].indexOf('t="array"')>-1)k.F=(ee.match(r)||[])[1],k.F.indexOf(":")>-1&&Be.push([rn(k.F),k.F]);else if(D[0].indexOf('t="shared"')>-1){re=St(D[0]);var Me=nn(yn(D[1]));f.xlfn||(Me=MC(Me)),we[parseInt(re.si,10)]=[re,Me,O.r]}}else(D=ee.match(/<f[^>]*\/>/))&&(re=St(D[0]),we[re.si]&&(k.f=DI(we[re.si][1],we[re.si][2],O.r)));var _e=qn(O.r);for(I=0;I<Be.length;++I)_e.r>=Be[I][0].s.r&&_e.r<=Be[I][0].e.r&&_e.c>=Be[I][0].s.c&&_e.c<=Be[I][0].e.c&&(k.F=Be[I][1])}if(O.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(Y)k.t="z";else continue;else k.t=O.t||"n";switch(h.s.c>U&&(h.s.c=U),h.e.c<U&&(h.e.c=U),k.t){case"n":if(k.v==""||k.v==null){if(!Y)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!Y)continue;k.t="z"}else Q=Nl[parseInt(k.v,10)],k.v=Q.t,k.r=Q.r,f.cellHTML&&(k.h=Q.h);break;case"str":k.t="s",k.v=k.v!=null?yn(k.v):"",f.cellHTML&&(k.h=mf(k.v));break;case"inlineStr":D=ee.match(t),k.t="s",D!=null&&(Q=Tf(D[1]))?(k.v=Q.t,f.cellHTML&&(k.h=Q.h)):k.v="";break;case"b":k.v=Dn(k.v);break;case"d":f.cellDates?k.v=Fn(k.v,1):(k.v=wi(Fn(k.v,1)),k.t="n");break;case"e":(!f||f.cellText!==!1)&&(k.w=k.v),k.v=bv[k.v];break}if(ie=Pe=0,xe=null,Re&&O.s!==void 0&&(xe=y.CellXf[O.s],xe!=null&&(xe.numFmtId!=null&&(ie=xe.numFmtId),f.cellStyles&&xe.fillId!=null&&(Pe=xe.fillId))),_b(k,ie,Pe,f,_,y),f.cellDates&&Re&&k.t=="n"&&Yc(Ct[ie])&&(k.t="d",k.v=am(k.v)),O.cm&&f.xlmeta){var it=(f.xlmeta.Cell||[])[+O.cm-1];it&&it.type=="XLDAPR"&&(k.D=!0)}if($e){var j=qn(O.r);m[j.r]||(m[j.r]=[]),m[j.r][j.c]=k}else m[O.r]=k}}}}Se.length>0&&(m["!rows"]=Se)}}();function LD(e,n,i,t){var r=[],a=[],o=rn(e["!ref"]),s="",u,m="",f=[],h=0,_=0,y=e["!rows"],v=Array.isArray(e),C={r:m},P,D=-1;for(_=o.s.c;_<=o.e.c;++_)f[_]=Hn(_);for(h=o.s.r;h<=o.e.r;++h){for(a=[],m=li(h),_=o.s.c;_<=o.e.c;++_){u=f[_]+m;var T=v?(e[h]||[])[_]:e[u];T!==void 0&&(s=ND(T,u,e,n,i,t))!=null&&a.push(s)}(a.length>0||y&&y[h])&&(C={r:m},y&&y[h]&&(P=y[h],P.hidden&&(C.hidden=1),D=-1,P.hpx?D=Kl(P.hpx):P.hpt&&(D=P.hpt),D>-1&&(C.ht=D,C.customHeight=1),P.level&&(C.outlineLevel=P.level)),r[r.length]=ze("row",a.join(""),C))}if(y)for(;h<y.length;++h)y&&y[h]&&(C={r:h+1},P=y[h],P.hidden&&(C.hidden=1),D=-1,P.hpx?D=Kl(P.hpx):P.hpt&&(D=P.hpt),D>-1&&(C.ht=D,C.customHeight=1),P.level&&(C.outlineLevel=P.level),r[r.length]=ze("row","",C));return r.join("")}function vb(e,n,i,t){var r=[di,ze("worksheet",null,{xmlns:ys[0],"xmlns:r":Mi.r})],a=i.SheetNames[e],o=0,s="",u=i.Sheets[a];u==null&&(u={});var m=u["!ref"]||"A1",f=rn(m);if(f.e.c>16383||f.e.r>1048575){if(n.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),m=Ft(f)}t||(t={}),u["!comments"]=[];var h=[];yD(u,i,e,n,r),r[r.length]=ze("dimension",null,{ref:m}),r[r.length]=RD(u,n,e,i),n.sheetFormat&&(r[r.length]=ze("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(r[r.length]=TD(u,u["!cols"])),r[o=r.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(s=LD(u,n,e,i,t),s.length>0&&(r[r.length]=s)),r.length>o+1&&(r[r.length]="</sheetData>",r[o]=r[o].replace("/>",">")),u["!protect"]&&(r[r.length]=SD(u["!protect"])),u["!autofilter"]!=null&&(r[r.length]=AD(u["!autofilter"],u,i,e)),u["!merges"]!=null&&u["!merges"].length>0&&(r[r.length]=vD(u["!merges"]));var _=-1,y,v=-1;return u["!links"].length>0&&(r[r.length]="<hyperlinks>",u["!links"].forEach(function(C){C[1].Target&&(y={ref:C[0]},C[1].Target.charAt(0)!="#"&&(v=_n(t,-1,Cn(C[1].Target).replace(/#.*$/,""),Nt.HLINK),y["r:id"]="rId"+v),(_=C[1].Target.indexOf("#"))>-1&&(y.location=Cn(C[1].Target.slice(_+1))),C[1].Tooltip&&(y.tooltip=Cn(C[1].Tooltip)),r[r.length]=ze("hyperlink",null,y))}),r[r.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(r[r.length]=kD(u["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(r[r.length]=Gi("ignoredErrors",ze("ignoredError",null,{numberStoredAsText:1,sqref:m}))),h.length>0&&(v=_n(t,-1,"../drawings/drawing"+(e+1)+".xml",Nt.DRAW),r[r.length]=ze("drawing",null,{"r:id":"rId"+v}),u["!drawing"]=h),u["!comments"].length>0&&(v=_n(t,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Nt.VML),r[r.length]=ze("legacyDrawing",null,{"r:id":"rId"+v}),u["!legacy"]=v),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function VD(e,n){var i={},t=e.l+n;i.r=e.read_shift(4),e.l+=4;var r=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=t,a&7&&(i.level=a&7),a&16&&(i.hidden=!0),a&32&&(i.hpt=r/20),i}function UD(e,n,i){var t=ye(145),r=(i["!rows"]||[])[e]||{};t.write_shift(4,e),t.write_shift(4,0);var a=320;r.hpx?a=Kl(r.hpx)*20:r.hpt&&(a=r.hpt*20),t.write_shift(2,a),t.write_shift(1,0);var o=0;r.level&&(o|=r.level),r.hidden&&(o|=16),(r.hpx||r.hpt)&&(o|=32),t.write_shift(1,o),t.write_shift(1,0);var s=0,u=t.l;t.l+=4;for(var m={r:e,c:0},f=0;f<16;++f)if(!(n.s.c>f+1<<10||n.e.c<f<<10)){for(var h=-1,_=-1,y=f<<10;y<f+1<<10;++y){m.c=y;var v=Array.isArray(i)?(i[m.r]||[])[m.c]:i[vt(m)];v&&(h<0&&(h=y),_=y)}h<0||(++s,t.write_shift(4,h),t.write_shift(4,_))}var C=t.l;return t.l=u,t.write_shift(4,s),t.l=C,t.length>t.l?t.slice(0,t.l):t}function jD(e,n,i,t){var r=UD(t,i,n);(r.length>17||(n["!rows"]||[])[t])&&Ie(e,0,r)}var zD=Ps,WD=qc;function YD(){}function $D(e,n){var i={},t=e[e.l];return++e.l,i.above=!(t&64),i.left=!(t&128),e.l+=18,i.name=qE(e,n-19),i}function GD(e,n,i){i==null&&(i=ye(84+4*e.length));var t=192;n&&(n.above&&(t&=-65),n.left&&(t&=-129)),i.write_shift(1,t);for(var r=1;r<3;++r)i.write_shift(1,0);return qu({auto:1},i),i.write_shift(-4,-1),i.write_shift(-4,-1),hv(e,i),i.slice(0,i.l)}function HD(e){var n=ca(e);return[n]}function qD(e,n,i){return i==null&&(i=ye(8)),Ms(n,i)}function XD(e){var n=ws(e);return[n]}function KD(e,n,i){return i==null&&(i=ye(4)),Ss(n,i)}function ZD(e){var n=ca(e),i=e.read_shift(1);return[n,i,"b"]}function JD(e,n,i){return i==null&&(i=ye(9)),Ms(n,i),i.write_shift(1,e.v?1:0),i}function QD(e){var n=ws(e),i=e.read_shift(1);return[n,i,"b"]}function e7(e,n,i){return i==null&&(i=ye(5)),Ss(n,i),i.write_shift(1,e.v?1:0),i}function t7(e){var n=ca(e),i=e.read_shift(1);return[n,i,"e"]}function n7(e,n,i){return i==null&&(i=ye(9)),Ms(n,i),i.write_shift(1,e.v),i}function i7(e){var n=ws(e),i=e.read_shift(1);return[n,i,"e"]}function r7(e,n,i){return i==null&&(i=ye(8)),Ss(n,i),i.write_shift(1,e.v),i.write_shift(2,0),i.write_shift(1,0),i}function a7(e){var n=ca(e),i=e.read_shift(4);return[n,i,"s"]}function o7(e,n,i){return i==null&&(i=ye(12)),Ms(n,i),i.write_shift(4,n.v),i}function s7(e){var n=ws(e),i=e.read_shift(4);return[n,i,"s"]}function c7(e,n,i){return i==null&&(i=ye(8)),Ss(n,i),i.write_shift(4,n.v),i}function l7(e){var n=ca(e),i=rr(e);return[n,i,"n"]}function d7(e,n,i){return i==null&&(i=ye(16)),Ms(n,i),_s(e.v,i),i}function bb(e){var n=ws(e),i=rr(e);return[n,i,"n"]}function u7(e,n,i){return i==null&&(i=ye(12)),Ss(n,i),_s(e.v,i),i}function m7(e){var n=ca(e),i=Sf(e);return[n,i,"n"]}function g7(e,n,i){return i==null&&(i=ye(12)),Ms(n,i),xv(e.v,i),i}function f7(e){var n=ws(e),i=Sf(e);return[n,i,"n"]}function p7(e,n,i){return i==null&&(i=ye(8)),Ss(n,i),xv(e.v,i),i}function h7(e){var n=ca(e),i=yf(e);return[n,i,"is"]}function x7(e){var n=ca(e),i=or(e);return[n,i,"str"]}function _7(e,n,i){return i==null&&(i=ye(12+4*e.v.length)),Ms(n,i),ji(e.v,i),i.length>i.l?i.slice(0,i.l):i}function C7(e){var n=ws(e),i=or(e);return[n,i,"str"]}function v7(e,n,i){return i==null&&(i=ye(8+4*e.v.length)),Ss(n,i),ji(e.v,i),i.length>i.l?i.slice(0,i.l):i}function b7(e,n,i){var t=e.l+n,r=ca(e);r.r=i["!row"];var a=e.read_shift(1),o=[r,a,"b"];if(i.cellFormula){e.l+=2;var s=lm(e,t-e.l,i);o[3]=nr(s,null,r,i.supbooks,i)}else e.l=t;return o}function y7(e,n,i){var t=e.l+n,r=ca(e);r.r=i["!row"];var a=e.read_shift(1),o=[r,a,"e"];if(i.cellFormula){e.l+=2;var s=lm(e,t-e.l,i);o[3]=nr(s,null,r,i.supbooks,i)}else e.l=t;return o}function M7(e,n,i){var t=e.l+n,r=ca(e);r.r=i["!row"];var a=rr(e),o=[r,a,"n"];if(i.cellFormula){e.l+=2;var s=lm(e,t-e.l,i);o[3]=nr(s,null,r,i.supbooks,i)}else e.l=t;return o}function w7(e,n,i){var t=e.l+n,r=ca(e);r.r=i["!row"];var a=or(e),o=[r,a,"str"];if(i.cellFormula){e.l+=2;var s=lm(e,t-e.l,i);o[3]=nr(s,null,r,i.supbooks,i)}else e.l=t;return o}var S7=Ps,P7=qc;function O7(e,n){return n==null&&(n=ye(4)),n.write_shift(4,e),n}function k7(e,n){var i=e.l+n,t=Ps(e,16),r=Mf(e),a=or(e),o=or(e),s=or(e);e.l=i;var u={rfx:t,relId:r,loc:a,display:s};return o&&(u.Tooltip=o),u}function E7(e,n){var i=ye(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));qc({s:qn(e[0]),e:qn(e[0])},i),wf("rId"+n,i);var t=e[1].Target.indexOf("#"),r=t==-1?"":e[1].Target.slice(t+1);return ji(r||"",i),ji(e[1].Tooltip||"",i),ji("",i),i.slice(0,i.l)}function T7(){}function I7(e,n,i){var t=e.l+n,r=_v(e,16),a=e.read_shift(1),o=[r];if(o[2]=a,i.cellFormula){var s=tD(e,t-e.l,i);o[1]=s}else e.l=t;return o}function A7(e,n,i){var t=e.l+n,r=Ps(e,16),a=[r];if(i.cellFormula){var o=iD(e,t-e.l,i);a[1]=o,e.l=t}else e.l=t;return a}function D7(e,n,i){i==null&&(i=ye(18));var t=dm(e,n);i.write_shift(-4,e),i.write_shift(-4,e),i.write_shift(4,(t.width||10)*256),i.write_shift(4,0);var r=0;return n.hidden&&(r|=1),typeof t.width=="number"&&(r|=2),n.level&&(r|=n.level<<8),i.write_shift(2,r),i}var yb=["left","right","top","bottom","header","footer"];function F7(e){var n={};return yb.forEach(function(i){n[i]=rr(e,8)}),n}function R7(e,n){return n==null&&(n=ye(6*8)),ps(e),yb.forEach(function(i){_s(e[i],n)}),n}function N7(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function B7(e,n,i){i==null&&(i=ye(30));var t=924;return(((n||{}).Views||[])[0]||{}).RTL&&(t|=32),i.write_shift(2,t),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(1,0),i.write_shift(1,0),i.write_shift(2,0),i.write_shift(2,100),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i}function L7(e){var n=ye(24);return n.write_shift(4,4),n.write_shift(4,1),qc(e,n),n}function V7(e,n){return n==null&&(n=ye(16*4+2)),n.write_shift(2,e.password?If(e.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(i){i[1]?n.write_shift(4,e[i[0]]!=null&&!e[i[0]]?1:0):n.write_shift(4,e[i[0]]!=null&&e[i[0]]?0:1)}),n}function U7(){}function j7(){}function z7(e,n,i,t,r,a,o){if(!e)return e;var s=n||{};t||(t={"!id":{}}),ni!=null&&s.dense==null&&(s.dense=ni);var u=s.dense?[]:{},m,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=[],_=!1,y=!1,v,C,P,D,T,I,K,ee,k,O=[];s.biff=12,s["!row"]=0;var R=0,U=!1,Q=[],re={},ie=s.supbooks||r.supbooks||[[]];if(ie.sharedf=re,ie.arrayf=Q,ie.SheetNames=r.SheetNames||r.Sheets.map(function(Ae){return Ae.name}),!s.supbooks&&(s.supbooks=ie,r.Names))for(var Pe=0;Pe<r.Names.length;++Pe)ie[0][Pe+1]=r.Names[Pe];var Re=[],xe=[],Be=!1;Zl[16]={n:"BrtShortReal",f:bb};var we,$e;if(ao(e,function(ce,Y,te){if(!y)switch(te){case 148:m=ce;break;case 0:v=ce,s.sheetRows&&s.sheetRows<=v.r&&(y=!0),ee=li(D=v.r),s["!row"]=v.r,(ce.hidden||ce.hpt||ce.level!=null)&&(ce.hpt&&(ce.hpx=Wc(ce.hpt)),xe[ce.r]=ce);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(C={t:ce[2]},ce[2]){case"n":C.v=ce[1];break;case"s":K=Nl[ce[1]],C.v=K.t,C.r=K.r;break;case"b":C.v=!!ce[1];break;case"e":C.v=ce[1],s.cellText!==!1&&(C.w=oo[C.v]);break;case"str":C.t="s",C.v=ce[1];break;case"is":C.t="s",C.v=ce[1].t;break}if((P=o.CellXf[ce[0].iStyleRef])&&_b(C,P.numFmtId,null,s,a,o),T=ce[0].c==-1?T+1:ce[0].c,s.dense?(u[D]||(u[D]=[]),u[D][T]=C):u[Hn(T)+ee]=C,s.cellFormula){for(U=!1,R=0;R<Q.length;++R){var Z=Q[R];v.r>=Z[0].s.r&&v.r<=Z[0].e.r&&T>=Z[0].s.c&&T<=Z[0].e.c&&(C.F=Ft(Z[0]),U=!0)}!U&&ce.length>3&&(C.f=ce[3])}if(f.s.r>v.r&&(f.s.r=v.r),f.s.c>T&&(f.s.c=T),f.e.r<v.r&&(f.e.r=v.r),f.e.c<T&&(f.e.c=T),s.cellDates&&P&&C.t=="n"&&Yc(Ct[P.numFmtId])){var J=us(C.v);J&&(C.t="d",C.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}we&&(we.type=="XLDAPR"&&(C.D=!0),we=void 0),$e&&($e=void 0);break;case 1:case 12:if(!s.sheetStubs||_)break;C={t:"z",v:void 0},T=ce[0].c==-1?T+1:ce[0].c,s.dense?(u[D]||(u[D]=[]),u[D][T]=C):u[Hn(T)+ee]=C,f.s.r>v.r&&(f.s.r=v.r),f.s.c>T&&(f.s.c=T),f.e.r<v.r&&(f.e.r=v.r),f.e.c<T&&(f.e.c=T),we&&(we.type=="XLDAPR"&&(C.D=!0),we=void 0),$e&&($e=void 0);break;case 176:O.push(ce);break;case 49:we=((s.xlmeta||{}).Cell||[])[ce-1];break;case 494:var de=t["!id"][ce.relId];for(de?(ce.Target=de.Target,ce.loc&&(ce.Target+="#"+ce.loc),ce.Rel=de):ce.relId==""&&(ce.Target="#"+ce.loc),D=ce.rfx.s.r;D<=ce.rfx.e.r;++D)for(T=ce.rfx.s.c;T<=ce.rfx.e.c;++T)s.dense?(u[D]||(u[D]=[]),u[D][T]||(u[D][T]={t:"z",v:void 0}),u[D][T].l=ce):(I=vt({c:T,r:D}),u[I]||(u[I]={t:"z",v:void 0}),u[I].l=ce);break;case 426:if(!s.cellFormula)break;Q.push(ce),k=s.dense?u[D][T]:u[Hn(T)+ee],k.f=nr(ce[1],f,{r:v.r,c:T},ie,s),k.F=Ft(ce[0]);break;case 427:if(!s.cellFormula)break;re[vt(ce[0].s)]=ce[1],k=s.dense?u[D][T]:u[Hn(T)+ee],k.f=nr(ce[1],f,{r:v.r,c:T},ie,s);break;case 60:if(!s.cellStyles)break;for(;ce.e>=ce.s;)Re[ce.e--]={width:ce.w/256,hidden:!!(ce.flags&1),level:ce.level},Be||(Be=!0,Af(ce.w/256)),jo(Re[ce.e+1]);break;case 161:u["!autofilter"]={ref:Ft(ce)};break;case 476:u["!margins"]=ce;break;case 147:r.Sheets[i]||(r.Sheets[i]={}),ce.name&&(r.Sheets[i].CodeName=ce.name),(ce.above||ce.left)&&(u["!outline"]={above:ce.above,left:ce.left});break;case 137:r.Views||(r.Views=[{}]),r.Views[0]||(r.Views[0]={}),ce.RTL&&(r.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_=!0;break;case 36:_=!1;break;case 37:h.push(te),_=!0;break;case 38:h.pop(),_=!1;break;default:if(!Y.T){if(!_||s.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},s),delete s.supbooks,delete s["!row"],!u["!ref"]&&(f.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(u["!ref"]=Ft(m||f)),s.sheetRows&&u["!ref"]){var Se=rn(u["!ref"]);s.sheetRows<=+Se.e.r&&(Se.e.r=s.sheetRows-1,Se.e.r>f.e.r&&(Se.e.r=f.e.r),Se.e.r<Se.s.r&&(Se.s.r=Se.e.r),Se.e.c>f.e.c&&(Se.e.c=f.e.c),Se.e.c<Se.s.c&&(Se.s.c=Se.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Ft(Se))}return O.length>0&&(u["!merges"]=O),Re.length>0&&(u["!cols"]=Re),xe.length>0&&(u["!rows"]=xe),u}function W7(e,n,i,t,r,a,o){if(n.v===void 0)return!1;var s="";switch(n.t){case"b":s=n.v?"1":"0";break;case"d":n=Rn(n),n.z=n.z||Ct[14],n.v=wi(Fn(n.v)),n.t="n";break;case"n":case"e":s=""+n.v;break;default:s=n.v;break}var u={r:i,c:t};switch(u.s=Go(r.cellXfs,n,r),n.l&&a["!links"].push([vt(u),n.l]),n.c&&a["!comments"].push([vt(u),n.c]),n.t){case"s":case"str":return r.bookSST?(s=Bf(r.Strings,n.v,r.revStrings),u.t="s",u.v=s,o?Ie(e,18,c7(n,u)):Ie(e,7,o7(n,u))):(u.t="str",o?Ie(e,17,v7(n,u)):Ie(e,6,_7(n,u))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?o?Ie(e,13,p7(n,u)):Ie(e,2,g7(n,u)):o?Ie(e,16,u7(n,u)):Ie(e,5,d7(n,u)),!0;case"b":return u.t="b",o?Ie(e,15,e7(n,u)):Ie(e,4,JD(n,u)),!0;case"e":return u.t="e",o?Ie(e,14,r7(n,u)):Ie(e,3,n7(n,u)),!0}return o?Ie(e,12,KD(n,u)):Ie(e,1,qD(n,u)),!0}function Y7(e,n,i,t){var r=rn(n["!ref"]||"A1"),a,o="",s=[];Ie(e,145);var u=Array.isArray(n),m=r.e.r;n["!rows"]&&(m=Math.max(r.e.r,n["!rows"].length-1));for(var f=r.s.r;f<=m;++f){o=li(f),jD(e,n,r,f);var h=!1;if(f<=r.e.r)for(var _=r.s.c;_<=r.e.c;++_){f===r.s.r&&(s[_]=Hn(_)),a=s[_]+o;var y=u?(n[f]||[])[_]:n[a];if(!y){h=!1;continue}h=W7(e,y,f,_,t,n,h)}}Ie(e,146)}function $7(e,n){!n||!n["!merges"]||(Ie(e,177,O7(n["!merges"].length)),n["!merges"].forEach(function(i){Ie(e,176,P7(i))}),Ie(e,178))}function G7(e,n){!n||!n["!cols"]||(Ie(e,390),n["!cols"].forEach(function(i,t){i&&Ie(e,60,D7(t,i))}),Ie(e,391))}function H7(e,n){!n||!n["!ref"]||(Ie(e,648),Ie(e,649,L7(rn(n["!ref"]))),Ie(e,650))}function q7(e,n,i){n["!links"].forEach(function(t){if(t[1].Target){var r=_n(i,-1,t[1].Target.replace(/#.*$/,""),Nt.HLINK);Ie(e,494,E7(t,r))}}),delete n["!links"]}function X7(e,n,i,t){if(n["!comments"].length>0){var r=_n(t,-1,"../drawings/vmlDrawing"+(i+1)+".vml",Nt.VML);Ie(e,551,wf("rId"+r)),n["!legacy"]=r}}function K7(e,n,i,t){if(n["!autofilter"]){var r=n["!autofilter"],a=typeof r.ref=="string"?r.ref:Ft(r.ref);i.Workbook||(i.Workbook={Sheets:[]}),i.Workbook.Names||(i.Workbook.Names=[]);var o=i.Workbook.Names,s=Er(a);s.s.r==s.e.r&&(s.e.r=Er(n["!ref"]).e.r,a=Ft(s));for(var u=0;u<o.length;++u){var m=o[u];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==t){m.Ref="'"+i.SheetNames[t]+"'!"+a;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:t,Ref:"'"+i.SheetNames[t]+"'!"+a}),Ie(e,161,qc(rn(a))),Ie(e,162)}}function Z7(e,n,i){Ie(e,133),Ie(e,137,B7(n,i)),Ie(e,138),Ie(e,134)}function J7(e,n){n["!protect"]&&Ie(e,535,V7(n["!protect"]))}function Q7(e,n,i,t){var r=kr(),a=i.SheetNames[e],o=i.Sheets[a]||{},s=a;try{i&&i.Workbook&&(s=i.Workbook.Sheets[e].CodeName||s)}catch{}var u=rn(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(n.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ie(r,129),(i.vbaraw||o["!outline"])&&Ie(r,147,GD(s,o["!outline"])),Ie(r,148,WD(u)),Z7(r,o,i.Workbook),G7(r,o,e,n,i),Y7(r,o,e,n,i),J7(r,o),K7(r,o,i,e),$7(r,o),q7(r,o,t),o["!margins"]&&Ie(r,476,R7(o["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&H7(r,o),X7(r,o,e,t),Ie(r,130),r.end()}function eF(e){var n=[],i=e.match(/^<c:numCache>/),t;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(n[+o[1]]=i?+o[2]:o[2])});var r=nn((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){t=a.replace(/<.*?>/g,"")}),[n,r,t]}function tF(e,n,i,t,r,a){var o=a||{"!type":"chart"};if(!e)return a;var s=0,u=0,m="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var _=eF(h);f.s.r=f.s.c=0,f.e.c=s,m=Hn(s),_[0].forEach(function(y,v){o[m+li(v)]={t:"n",v:y,z:_[1]},u=v}),f.e.r<u&&(f.e.r=u),++s}),s>0&&(o["!ref"]=Ft(f)),o}function nF(e,n,i,t,r){if(!e)return e;t||(t={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,s=e.match(Cb);return s&&Lf(s[0],a,r,i),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),t["!id"][a["!rel"]]&&(a["!drawel"]=t["!id"][a["!rel"]]),a}function iF(e,n){e.l+=10;var i=or(e,n-10);return{name:i}}function rF(e,n,i,t,r){if(!e)return e;t||(t={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=[],s=!1;return ao(e,function(m,f,h){switch(h){case 550:a["!rel"]=m;break;case 651:r.Sheets[i]||(r.Sheets[i]={}),m.name&&(r.Sheets[i].CodeName=m.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:o.push(h);break;case 38:o.pop();break;default:if(f.T>0)o.push(h);else if(f.T<0)o.pop();else if(!s||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}},n),t["!id"][a["!rel"]]&&(a["!drawel"]=t["!id"][a["!rel"]]),a}var Vf=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],aF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oF=[],sF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function kC(e,n){for(var i=0;i!=e.length;++i)for(var t=e[i],r=0;r!=n.length;++r){var a=n[r];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=Dn(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function EC(e,n){for(var i=0;i!=n.length;++i){var t=n[i];if(e[t[0]]==null)e[t[0]]=t[1];else switch(t[2]){case"bool":typeof e[t[0]]=="string"&&(e[t[0]]=Dn(e[t[0]]));break;case"int":typeof e[t[0]]=="string"&&(e[t[0]]=parseInt(e[t[0]],10));break}}}function Mb(e){EC(e.WBProps,Vf),EC(e.CalcPr,sF),kC(e.WBView,aF),kC(e.Sheets,oF),Vc.date1904=Dn(e.WBProps.date1904)}function cF(e){return!e.Workbook||!e.Workbook.WBProps?"false":Dn(e.Workbook.WBProps.date1904)?"true":"false"}var lF="][*?/\\".split("");function wb(e,n){if(e.length>31){if(n)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var i=!0;return lF.forEach(function(t){if(e.indexOf(t)!=-1){if(!n)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");i=!1}}),i}function dF(e,n,i){e.forEach(function(t,r){wb(t);for(var a=0;a<r;++a)if(t==e[a])throw new Error("Duplicate Sheet Name: "+t);if(i){var o=n&&n[r]&&n[r].CodeName||t;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function uF(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var n=e.Workbook&&e.Workbook.Sheets||[];dF(e.SheetNames,n,!!e.vbaraw);for(var i=0;i<e.SheetNames.length;++i)cD(e.Sheets[e.SheetNames[i]],e.SheetNames[i],i)}var mF=/<\w+:workbook/;function gF(e,n){if(!e)throw new Error("Could not find file");var i={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},t=!1,r="xmlns",a={},o=0;if(e.replace(cr,function(u,m){var f=St(u);switch(Ba(f[0])){case"<?xml":break;case"<workbook":u.match(mF)&&(r="xmlns"+u.match(/<(\w+):/)[1]),i.xmlns=f[r];break;case"</workbook>":break;case"<fileVersion":delete f[0],i.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Vf.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":i.WBProps[h[0]]=Dn(f[h[0]]);break;case"int":i.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:i.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(i.WBProps.CodeName=yn(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],i.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=nn(yn(f.name)),delete f[0],i.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":t=!0;break;case"</definedNames>":t=!1;break;case"<definedName":a={},a.Name=yn(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),Dn(f.hidden||"0")&&(a.Hidden=!0),o=m+u.length;break;case"</definedName>":a.Ref=nn(yn(e.slice(o,m))),i.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],i.CalcPr=f;break;case"<calcPr/>":delete f[0],i.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":t=!0;break;case"</ext>":t=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":t=!0;break;case"</AlternateContent>":t=!1;break;case"<revisionPtr":break;default:if(!t&&n.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return u}),ys.indexOf(i.xmlns)===-1)throw new Error("Unknown Namespace: "+i.xmlns);return Mb(i),i}function Sb(e){var n=[di];n[n.length]=ze("workbook",null,{xmlns:ys[0],"xmlns:r":Mi.r});var i=e.Workbook&&(e.Workbook.Names||[]).length>0,t={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Vf.forEach(function(s){e.Workbook.WBProps[s[0]]!=null&&e.Workbook.WBProps[s[0]]!=s[1]&&(t[s[0]]=e.Workbook.WBProps[s[0]])}),e.Workbook.WBProps.CodeName&&(t.codeName=e.Workbook.WBProps.CodeName,delete t.CodeName)),n[n.length]=ze("workbookPr",null,t);var r=e.Workbook&&e.Workbook.Sheets||[],a=0;if(r&&r[0]&&r[0].Hidden){for(n[n.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!r[a]||!r[a].Hidden);++a);a==e.SheetNames.length&&(a=0),n[n.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:Cn(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),r[a])switch(r[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}n[n.length]=ze("sheet",null,o)}return n[n.length]="</sheets>",i&&(n[n.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(s){var u={name:s.Name};s.Comment&&(u.comment=s.Comment),s.Sheet!=null&&(u.localSheetId=""+s.Sheet),s.Hidden&&(u.hidden="1"),s.Ref&&(n[n.length]=ze("definedName",Cn(s.Ref),u))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function fF(e,n){var i={};return i.Hidden=e.read_shift(4),i.iTabID=e.read_shift(4),i.strRelID=$g(e,n-8),i.name=or(e),i}function pF(e,n){return n||(n=ye(127)),n.write_shift(4,e.Hidden),n.write_shift(4,e.iTabID),wf(e.strRelID,n),ji(e.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function hF(e,n){var i={},t=e.read_shift(4);i.defaultThemeVersion=e.read_shift(4);var r=n>8?or(e):"";return r.length>0&&(i.CodeName=r),i.autoCompressPictures=!!(t&65536),i.backupFile=!!(t&64),i.checkCompatibility=!!(t&4096),i.date1904=!!(t&1),i.filterPrivacy=!!(t&8),i.hidePivotFieldList=!!(t&1024),i.promptedSolutions=!!(t&16),i.publishItems=!!(t&2048),i.refreshAllConnections=!!(t&262144),i.saveExternalLinkValues=!!(t&128),i.showBorderUnselectedTables=!!(t&4),i.showInkAnnotation=!!(t&32),i.showObjects=["all","placeholders","none"][t>>13&3],i.showPivotChartFilter=!!(t&32768),i.updateLinks=["userSet","never","always"][t>>8&3],i}function xF(e,n){n||(n=ye(72));var i=0;return e&&e.filterPrivacy&&(i|=8),n.write_shift(4,i),n.write_shift(4,0),hv(e&&e.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function _F(e,n){var i={};return e.read_shift(4),i.ArchID=e.read_shift(4),e.l+=n-8,i}function CF(e,n,i){var t=e.l+n;e.l+=4,e.l+=1;var r=e.read_shift(4),a=XE(e),o=nD(e,0,i),s=Mf(e);e.l=t;var u={Name:a,Ptg:o};return r<268435455&&(u.Sheet=r),s&&(u.Comment=s),u}function vF(e,n){var i={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},t=[],r=!1;n||(n={}),n.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],Zl[16]={n:"BrtFRTArchID$",f:_F},ao(e,function(u,m,f){switch(f){case 156:o.SheetNames.push(u.name),i.Sheets.push(u);break;case 153:i.WBProps=u;break;case 39:u.Sheet!=null&&(n.SID=u.Sheet),u.Ref=nr(u.Ptg,null,null,o,n),delete n.SID,delete u.Ptg,a.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([f,u]):o[0]=[f,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:t.push(f),r=!0;break;case 36:t.pop(),r=!1;break;case 37:t.push(f),r=!0;break;case 38:t.pop(),r=!1;break;case 16:break;default:if(!m.T){if(!r||n.WTF&&t[t.length-1]!=37&&t[t.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},n),Mb(i),i.Names=a,i.supbooks=o,i}function bF(e,n){Ie(e,143);for(var i=0;i!=n.SheetNames.length;++i){var t=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[i]&&n.Workbook.Sheets[i].Hidden||0,r={Hidden:t,iTabID:i+1,strRelID:"rId"+(i+1),name:n.SheetNames[i]};Ie(e,156,pF(r))}Ie(e,144)}function yF(e,n){n||(n=ye(127));for(var i=0;i!=4;++i)n.write_shift(4,0);return ji("SheetJS",n),ji(Ul.version,n),ji(Ul.version,n),ji("7262",n),n.length>n.l?n.slice(0,n.l):n}function MF(e,n){n||(n=ye(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,e),n.write_shift(4,e);var i=120;return n.write_shift(1,i),n.length>n.l?n.slice(0,n.l):n}function wF(e,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var i=n.Workbook.Sheets,t=0,r=-1,a=-1;t<i.length;++t)!i[t]||!i[t].Hidden&&r==-1?r=t:i[t].Hidden==1&&a==-1&&(a=t);a>r||(Ie(e,135),Ie(e,158,MF(r)),Ie(e,136))}}function SF(e,n){var i=kr();return Ie(i,131),Ie(i,128,yF()),Ie(i,153,xF(e.Workbook&&e.Workbook.WBProps||null)),wF(i,e,n),bF(i,e,n),Ie(i,132),i.end()}function PF(e,n,i){return n.slice(-4)===".bin"?vF(e,i):gF(e,i)}function OF(e,n,i,t,r,a,o,s){return n.slice(-4)===".bin"?z7(e,t,i,r,a,o,s):CD(e,t,i,r,a,o,s)}function kF(e,n,i,t,r,a,o,s){return n.slice(-4)===".bin"?rF(e,t,i,r,a,o,s):nF(e,t,i,r,a,o,s)}function EF(e,n,i,t,r,a,o,s){return n.slice(-4)===".bin"?II(e,t,i,r,a,o,s):AI(e,t,i,r,a,o,s)}function TF(e,n,i,t,r,a,o,s){return n.slice(-4)===".bin"?EI(e,t,i,r,a,o,s):TI(e,t,i,r,a,o,s)}function IF(e,n,i,t){return n.slice(-4)===".bin"?P8(e,i,t):f8(e,i,t)}function AF(e,n,i){return ab(e,i)}function DF(e,n,i){return n.slice(-4)===".bin"?D5(e,i):T5(e,i)}function FF(e,n,i){return n.slice(-4)===".bin"?wI(e,i):pI(e,i)}function RF(e,n,i){return n.slice(-4)===".bin"?mI(e,n,i):dI(e,n,i)}function NF(e,n,i,t){return i.slice(-4)===".bin"?gI(e,n,i,t):void 0}function BF(e,n,i){return n.slice(-4)===".bin"?sI(e,n,i):lI(e,n,i)}function LF(e,n,i){return(n.slice(-4)===".bin"?SF:Sb)(e,i)}function VF(e,n,i,t,r){return(n.slice(-4)===".bin"?Q7:vb)(e,i,t,r)}function UF(e,n,i){return(n.slice(-4)===".bin"?N8:ib)(e,i)}function jF(e,n,i){return(n.slice(-4)===".bin"?N5:Xv)(e,i)}function zF(e,n,i){return(n.slice(-4)===".bin"?SI:cb)(e,i)}function WF(e){return(e.slice(-4)===".bin"?cI:ob)()}var Pb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ob=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function pa(e,n){var i=e.split(/\s+/),t=[];if(n||(t[0]=i[0]),i.length===1)return t;var r=e.match(Pb),a,o,s,u;if(r)for(u=0;u!=r.length;++u)a=r[u].match(Ob),(o=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(o+1),t[s]=a[2].slice(1,a[2].length-1));return t}function YF(e){var n=e.split(/\s+/),i={};if(n.length===1)return i;var t=e.match(Pb),r,a,o,s;if(t)for(s=0;s!=t.length;++s)r=t[s].match(Ob),(a=r[1].indexOf(":"))===-1?i[r[1]]=r[2].slice(1,r[2].length-1):(r[1].slice(0,6)==="xmlns:"?o="xmlns"+r[1].slice(6):o=r[1].slice(a+1),i[o]=r[2].slice(1,r[2].length-1));return i}var Ll;function $F(e,n){var i=Ll[e]||nn(e);return i==="General"?hs(n):sa(i,n)}function GF(e,n,i,t){var r=t;switch((i[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=Dn(t);break;case"i2":case"int":r=parseInt(t,10);break;case"r4":case"float":r=parseFloat(t);break;case"date":case"dateTime.tz":r=Fn(t);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+i[0])}e[nn(n)]=r}function HF(e,n,i){if(e.t!=="z"){if(!i||i.cellText!==!1)try{e.t==="e"?e.w=e.w||oo[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zl(e.v):e.w=hs(e.v):e.w=$F(n||"General",e.v)}catch(a){if(i.WTF)throw a}try{var t=Ll[n]||n||"General";if(i.cellNF&&(e.z=t),i.cellDates&&e.t=="n"&&Yc(t)){var r=us(e.v);r&&(e.t="d",e.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}catch(a){if(i.WTF)throw a}}}function qF(e,n,i){if(i.cellStyles&&n.Interior){var t=n.Interior;t.Pattern&&(t.patternType=o8[t.Pattern]||t.Pattern)}e[n.ID]=n}function XF(e,n,i,t,r,a,o,s,u,m){var f="General",h=t.StyleID,_={};m=m||{};var y=[],v=0;for(h===void 0&&s&&(h=s.StyleID),h===void 0&&o&&(h=o.StyleID);a[h]!==void 0&&(a[h].nf&&(f=a[h].nf),a[h].Interior&&y.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(i.Type){case"Boolean":t.t="b",t.v=Dn(e);break;case"String":t.t="s",t.r=G_(nn(e)),t.v=e.indexOf("<")>-1?nn(n||e).replace(/<.*?>/g,""):t.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),t.v=(Fn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),t.v!==t.v?t.v=nn(e):t.v<60&&(t.v=t.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":t.v===void 0&&(t.v=+e),t.t||(t.t="n");break;case"Error":t.t="e",t.v=bv[e],m.cellText!==!1&&(t.w=e);break;default:e==""&&n==""?t.t="z":(t.t="s",t.v=G_(n||e));break}if(HF(t,f,m),m.cellFormula!==!1)if(t.Formula){var C=nn(t.Formula);C.charCodeAt(0)==61&&(C=C.slice(1)),t.f=Lc(C,r),delete t.Formula,t.ArrayRange=="RC"?t.F=Lc("RC:RC",r):t.ArrayRange&&(t.F=Lc(t.ArrayRange,r),u.push([rn(t.F),t.F]))}else for(v=0;v<u.length;++v)r.r>=u[v][0].s.r&&r.r<=u[v][0].e.r&&r.c>=u[v][0].s.c&&r.c<=u[v][0].e.c&&(t.F=u[v][1]);m.cellStyles&&(y.forEach(function(P){!_.patternType&&P.patternType&&(_.patternType=P.patternType)}),t.s=_),t.StyleID!==void 0&&(t.ixfe=t.StyleID)}function KF(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Lg(e,n){var i=n||{};$c();var t=El(gf(e));(i.type=="binary"||i.type=="array"||i.type=="base64")&&(typeof pn<"u"?t=pn.utils.decode(65001,Wg(t)):t=yn(t));var r=t.slice(0,1024).toLowerCase(),a=!1;if(r=r.replace(/".*?"/g,""),(r.indexOf(">")&1023)>Math.min(r.indexOf(",")&1023,r.indexOf(";")&1023)){var o=Rn(i);return o.type="string",zc.to_workbook(t,o)}if(r.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Tt){r.indexOf("<"+Tt)>=0&&(a=!0)}),a)return R9(t,i);Ll={"General Number":"General","General Date":Ct[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ct[15],"Short Date":Ct[14],"Long Time":Ct[19],"Medium Time":Ct[18],"Short Time":Ct[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ct[2],Standard:Ct[4],Percent:Ct[10],Scientific:Ct[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var s,u=[],m;ni!=null&&i.dense==null&&(i.dense=ni);var f={},h=[],_=i.dense?[]:{},y="",v={},C={},P=pa('<Data ss:Type="String">'),D=0,T=0,I=0,K={s:{r:2e6,c:2e6},e:{r:0,c:0}},ee={},k={},O="",R=0,U=[],Q={},re={},ie=0,Pe=[],Re=[],xe={},Be=[],we,$e=!1,Se=[],Ae=[],ce={},Y=0,te=0,Z={Sheets:[],WBProps:{date1904:!1}},J={};$l.lastIndex=0,t=t.replace(/<!--([\s\S]*?)-->/mg,"");for(var de="";s=$l.exec(t);)switch(s[3]=(de=s[3]).toLowerCase()){case"data":if(de=="data"){if(s[1]==="/"){if((m=u.pop())[0]!==s[3])throw new Error("Bad state: "+m.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&u.push([s[3],!0]);break}if(u[u.length-1][1])break;s[1]==="/"?XF(t.slice(D,s.index),O,P,u[u.length-1][0]=="comment"?xe:v,{c:T,r:I},ee,Be[T],C,Se,i):(O="",P=pa(s[0]),D=s.index+s[0].length);break;case"cell":if(s[1]==="/")if(Re.length>0&&(v.c=Re),(!i.sheetRows||i.sheetRows>I)&&v.v!==void 0&&(i.dense?(_[I]||(_[I]=[]),_[I][T]=v):_[Hn(T)+li(I)]=v),v.HRef&&(v.l={Target:nn(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(Y=T+(parseInt(v.MergeAcross,10)|0),te=I+(parseInt(v.MergeDown,10)|0),U.push({s:{c:T,r:I},e:{c:Y,r:te}})),!i.sheetStubs)v.MergeAcross?T=Y+1:++T;else if(v.MergeAcross||v.MergeDown){for(var Oe=T;Oe<=Y;++Oe)for(var ke=I;ke<=te;++ke)(Oe>T||ke>I)&&(i.dense?(_[ke]||(_[ke]=[]),_[ke][Oe]={t:"z"}):_[Hn(Oe)+li(ke)]={t:"z"});T=Y+1}else++T;else v=YF(s[0]),v.Index&&(T=+v.Index-1),T<K.s.c&&(K.s.c=T),T>K.e.c&&(K.e.c=T),s[0].slice(-2)==="/>"&&++T,Re=[];break;case"row":s[1]==="/"||s[0].slice(-2)==="/>"?(I<K.s.r&&(K.s.r=I),I>K.e.r&&(K.e.r=I),s[0].slice(-2)==="/>"&&(C=pa(s[0]),C.Index&&(I=+C.Index-1)),T=0,++I):(C=pa(s[0]),C.Index&&(I=+C.Index-1),ce={},(C.AutoFitHeight=="0"||C.Height)&&(ce.hpx=parseInt(C.Height,10),ce.hpt=Kl(ce.hpx),Ae[I]=ce),C.Hidden=="1"&&(ce.hidden=!0,Ae[I]=ce));break;case"worksheet":if(s[1]==="/"){if((m=u.pop())[0]!==s[3])throw new Error("Bad state: "+m.join("|"));h.push(y),K.s.r<=K.e.r&&K.s.c<=K.e.c&&(_["!ref"]=Ft(K),i.sheetRows&&i.sheetRows<=K.e.r&&(_["!fullref"]=_["!ref"],K.e.r=i.sheetRows-1,_["!ref"]=Ft(K))),U.length&&(_["!merges"]=U),Be.length>0&&(_["!cols"]=Be),Ae.length>0&&(_["!rows"]=Ae),f[y]=_}else K={s:{r:2e6,c:2e6},e:{r:0,c:0}},I=T=0,u.push([s[3],!1]),m=pa(s[0]),y=nn(m.Name),_=i.dense?[]:{},U=[],Se=[],Ae=[],J={name:y,Hidden:0},Z.Sheets.push(J);break;case"table":if(s[1]==="/"){if((m=u.pop())[0]!==s[3])throw new Error("Bad state: "+m.join("|"))}else{if(s[0].slice(-2)=="/>")break;u.push([s[3],!1]),Be=[],$e=!1}break;case"style":s[1]==="/"?qF(ee,k,i):k=pa(s[0]);break;case"numberformat":k.nf=nn(pa(s[0]).Format||"General"),Ll[k.nf]&&(k.nf=Ll[k.nf]);for(var Me=0;Me!=392&&Ct[Me]!=k.nf;++Me);if(Me==392){for(Me=57;Me!=392;++Me)if(Ct[Me]==null){to(k.nf,Me);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(we=pa(s[0]),we.Hidden&&(we.hidden=!0,delete we.Hidden),we.Width&&(we.wpx=parseInt(we.Width,10)),!$e&&we.wpx>10){$e=!0,ir=tb;for(var _e=0;_e<Be.length;++_e)Be[_e]&&jo(Be[_e])}$e&&jo(we),Be[we.Index-1||Be.length]=we;for(var it=0;it<+we.Span;++it)Be[Be.length]=Rn(we);break;case"namedrange":if(s[1]==="/")break;Z.Names||(Z.Names=[]);var j=St(s[0]),st={Name:j.Name,Ref:Lc(j.RefersTo.slice(1),{r:0,c:0})};Z.Sheets.length>0&&(st.Sheet=Z.Sheets.length-1),Z.Names.push(st);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(s[0].slice(-2)==="/>")break;s[1]==="/"?O+=t.slice(R,s.index):R=s.index+s[0].length;break;case"interior":if(!i.cellStyles)break;k.Interior=pa(s[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(s[0].slice(-2)==="/>")break;s[1]==="/"?vT(Q,de,t.slice(ie,s.index)):ie=s.index+s[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(s[1]==="/"){if((m=u.pop())[0]!==s[3])throw new Error("Bad state: "+m.join("|"))}else u.push([s[3],!1]);break;case"comment":if(s[1]==="/"){if((m=u.pop())[0]!==s[3])throw new Error("Bad state: "+m.join("|"));KF(xe),Re.push(xe)}else u.push([s[3],!1]),m=pa(s[0]),xe={a:m.Author};break;case"autofilter":if(s[1]==="/"){if((m=u.pop())[0]!==s[3])throw new Error("Bad state: "+m.join("|"))}else if(s[0].charAt(s[0].length-2)!=="/"){var qe=pa(s[0]);_["!autofilter"]={ref:Lc(qe.Range).replace(/\$/g,"")},u.push([s[3],!0])}break;case"name":break;case"datavalidation":if(s[1]==="/"){if((m=u.pop())[0]!==s[3])throw new Error("Bad state: "+m.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&u.push([s[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(s[1]==="/"){if((m=u.pop())[0]!==s[3])throw new Error("Bad state: "+m.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&u.push([s[3],!0]);break;case"null":break;default:if(u.length==0&&s[3]=="document"||u.length==0&&s[3]=="uof")return FC(t,i);var bt=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(s[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:bt=!1}break;case"componentoptions":switch(s[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:bt=!1}break;case"excelworkbook":switch(s[3]){case"date1904":Z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:bt=!1}break;case"workbookoptions":switch(s[3]){case"owcversion":break;case"height":break;case"width":break;default:bt=!1}break;case"worksheetoptions":switch(s[3]){case"visible":if(s[0].slice(-2)!=="/>")if(s[1]==="/")switch(t.slice(ie,s.index)){case"SheetHidden":J.Hidden=1;break;case"SheetVeryHidden":J.Hidden=2;break}else ie=s.index+s[0].length;break;case"header":_["!margins"]||ps(_["!margins"]={},"xlml"),isNaN(+St(s[0]).Margin)||(_["!margins"].header=+St(s[0]).Margin);break;case"footer":_["!margins"]||ps(_["!margins"]={},"xlml"),isNaN(+St(s[0]).Margin)||(_["!margins"].footer=+St(s[0]).Margin);break;case"pagemargins":var Ze=St(s[0]);_["!margins"]||ps(_["!margins"]={},"xlml"),isNaN(+Ze.Top)||(_["!margins"].top=+Ze.Top),isNaN(+Ze.Left)||(_["!margins"].left=+Ze.Left),isNaN(+Ze.Right)||(_["!margins"].right=+Ze.Right),isNaN(+Ze.Bottom)||(_["!margins"].bottom=+Ze.Bottom);break;case"displayrighttoleft":Z.Views||(Z.Views=[]),Z.Views[0]||(Z.Views[0]={}),Z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:bt=!1}break;case"pivottable":case"pivotcache":switch(s[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:bt=!1}break;case"pagebreaks":switch(s[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:bt=!1}break;case"autofilter":switch(s[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:bt=!1}break;case"querytable":switch(s[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:bt=!1}break;case"datavalidation":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:bt=!1}break;case"sorting":case"conditionalformatting":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:bt=!1}break;case"mapinfo":case"schema":case"data":switch(s[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:bt=!1}break;case"smarttags":break;default:bt=!1;break}if(bt||s[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(s[0].slice(-2)==="/>")break;s[1]==="/"?GF(re,de,Pe,t.slice(ie,s.index)):(Pe=s,ie=s.index+s[0].length);break}if(i.WTF)throw"Unrecognized tag: "+s[3]+"|"+u.join("|")}var Fe={};return!i.bookSheets&&!i.bookProps&&(Fe.Sheets=f),Fe.SheetNames=h,Fe.Workbook=Z,Fe.SSF=Rn(Ct),Fe.Props=Q,Fe.Custprops=re,Fe}function Jg(e,n){switch(jf(n=n||{}),n.type||"base64"){case"base64":return Lg(jr(e),n);case"binary":case"buffer":case"file":return Lg(e,n);case"array":return Lg(Yo(e),n)}}function ZF(e,n){var i=[];return e.Props&&i.push(bT(e.Props,n)),e.Custprops&&i.push(yT(e.Props,e.Custprops,n)),i.join("")}function JF(){return""}function QF(e,n){var i=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(t,r){var a=[];a.push(ze("NumberFormat",null,{"ss:Format":Cn(Ct[t.numFmtId])}));var o={"ss:ID":"s"+(21+r)};i.push(ze("Style",a.join(""),o))}),ze("Styles",i.join(""))}function kb(e){return ze("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Rf(e.Ref,{r:0,c:0})})}function e9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var n=e.Workbook.Names,i=[],t=0;t<n.length;++t){var r=n[t];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||i.push(kb(r)))}return ze("Names",i.join(""))}function t9(e,n,i,t){if(!e||!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,a=[],o=0;o<r.length;++o){var s=r[o];s.Sheet==i&&(s.Name.match(/^_xlfn\./)||a.push(kb(s)))}return a.join("")}function n9(e,n,i,t){if(!e)return"";var r=[];if(e["!margins"]&&(r.push("<PageSetup>"),e["!margins"].header&&r.push(ze("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&r.push(ze("Footer",null,{"x:Margin":e["!margins"].footer})),r.push(ze("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),r.push("</PageSetup>")),t&&t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[i])if(t.Workbook.Sheets[i].Hidden)r.push(ze("Visible",t.Workbook.Sheets[i].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<i&&!(t.Workbook.Sheets[a]&&!t.Workbook.Sheets[a].Hidden);++a);a==i&&r.push("<Selected/>")}return((((t||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),e["!protect"]&&(r.push(Gi("ProtectContents","True")),e["!protect"].objects&&r.push(Gi("ProtectObjects","True")),e["!protect"].scenarios&&r.push(Gi("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?r.push(Gi("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&r.push(Gi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&r.push("<"+o[1]+"/>")})),r.length==0?"":ze("WorksheetOptions",r.join(""),{xmlns:Lr.x})}function i9(e){return e.map(function(n){var i=ME(n.t||""),t=ze("ss:Data",i,{xmlns:"http://www.w3.org/TR/REC-html40"});return ze("Comment",t,{"ss:Author":n.a})}).join("")}function r9(e,n,i,t,r,a,o){if(!e||e.v==null&&e.f==null)return"";var s={};if(e.f&&(s["ss:Formula"]="="+Cn(Rf(e.f,o))),e.F&&e.F.slice(0,n.length)==n){var u=qn(e.F.slice(n.length+1));s["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(e.l&&e.l.Target&&(s["ss:HRef"]=Cn(e.l.Target),e.l.Tooltip&&(s["x:HRefScreenTip"]=Cn(e.l.Tooltip))),i["!merges"])for(var m=i["!merges"],f=0;f!=m.length;++f)m[f].s.c!=o.c||m[f].s.r!=o.r||(m[f].e.c>m[f].s.c&&(s["ss:MergeAcross"]=m[f].e.c-m[f].s.c),m[f].e.r>m[f].s.r&&(s["ss:MergeDown"]=m[f].e.r-m[f].s.r));var h="",_="";switch(e.t){case"z":if(!t.sheetStubs)return"";break;case"n":h="Number",_=String(e.v);break;case"b":h="Boolean",_=e.v?"1":"0";break;case"e":h="Error",_=oo[e.v];break;case"d":h="DateTime",_=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ct[14]);break;case"s":h="String",_=yE(e.v||"");break}var y=Go(t.cellXfs,e,t);s["ss:StyleID"]="s"+(21+y),s["ss:Index"]=o.c+1;var v=e.v!=null?_:"",C=e.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(e.c||[]).length>0&&(C+=i9(e.c)),ze("Cell",C,s)}function a9(e,n){var i='<Row ss:Index="'+(e+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=Wc(n.hpt)),n.hpx&&(i+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(i+=' ss:Hidden="1"')),i+">"}function o9(e,n,i,t){if(!e["!ref"])return"";var r=rn(e["!ref"]),a=e["!merges"]||[],o=0,s=[];e["!cols"]&&e["!cols"].forEach(function(P,D){jo(P);var T=!!P.width,I=dm(D,P),K={"ss:Index":D+1};T&&(K["ss:Width"]=ql(I.width)),P.hidden&&(K["ss:Hidden"]="1"),s.push(ze("Column",null,K))});for(var u=Array.isArray(e),m=r.s.r;m<=r.e.r;++m){for(var f=[a9(m,(e["!rows"]||[])[m])],h=r.s.c;h<=r.e.c;++h){var _=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>h)&&!(a[o].s.r>m)&&!(a[o].e.c<h)&&!(a[o].e.r<m)){(a[o].s.c!=h||a[o].s.r!=m)&&(_=!0);break}if(!_){var y={r:m,c:h},v=vt(y),C=u?(e[m]||[])[h]:e[v];f.push(r9(C,v,e,n,i,t,y))}}f.push("</Row>"),f.length>2&&s.push(f.join(""))}return s.join("")}function s9(e,n,i){var t=[],r=i.SheetNames[e],a=i.Sheets[r],o=a?t9(a,n,e,i):"";return o.length>0&&t.push("<Names>"+o+"</Names>"),o=a?o9(a,n,e,i):"",o.length>0&&t.push("<Table>"+o+"</Table>"),t.push(n9(a,n,e,i)),t.join("")}function c9(e,n){n||(n={}),e.SSF||(e.SSF=Rn(Ct)),e.SSF&&($c(),nm(e.SSF),n.revssf=rm(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF,n.cellXfs=[],Go(n.cellXfs,{},{revssf:{General:0}}));var i=[];i.push(ZF(e,n)),i.push(JF(e,n)),i.push(""),i.push("");for(var t=0;t<e.SheetNames.length;++t)i.push(ze("Worksheet",s9(t,n,e),{"ss:Name":Cn(e.SheetNames[t])}));return i[2]=QF(e,n),i[3]=e9(e,n),di+ze("Workbook",i.join(""),{xmlns:Lr.ss,"xmlns:o":Lr.o,"xmlns:x":Lr.x,"xmlns:ss":Lr.ss,"xmlns:dt":Lr.dt,"xmlns:html":Lr.html})}function l9(e){var n={},i=e.content;if(i.l=28,n.AnsiUserType=i.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=eT(i),i.length-i.l<=4)return n;var t=i.read_shift(4);if(t==0||t>40||(i.l-=4,n.Reserved1=i.read_shift(0,"lpstr-ansi"),i.length-i.l<=4)||(t=i.read_shift(4),t!==1907505652)||(n.UnicodeClipboardFormat=tT(i),t=i.read_shift(4),t==0||t>40))return n;i.l-=4,n.Reserved2=i.read_shift(0,"lpwstr")}var d9=[60,1084,2066,2165,2175];function u9(e,n,i,t,r){var a=t,o=[],s=i.slice(i.l,i.l+a);if(r&&r.enc&&r.enc.insitu&&s.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:r.enc.insitu(s)}o.push(s),i.l+=a;for(var u=Qa(i,i.l),m=Qg[u],f=0;m!=null&&d9.indexOf(u)>-1;)a=Qa(i,i.l+2),f=i.l+4,u==2066?f+=4:(u==2165||u==2175)&&(f+=12),s=i.slice(f,i.l+4+a),o.push(s),i.l+=4+a,m=Qg[u=Qa(i,i.l)];var h=Ui(o);$i(h,0);var _=0;h.lens=[];for(var y=0;y<o.length;++y)h.lens.push(_),_+=o[y].length;if(h.length<t)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+t;return n.f(h,h.length,r)}function Aa(e,n,i){if(e.t!=="z"&&e.XF){var t=0;try{t=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=Ct[t])}catch(a){if(n.WTF)throw a}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||oo[e.v]:t===0||t=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zl(e.v):e.w=hs(e.v):e.w=sa(t,e.v,{date1904:!!i,dateNF:n&&n.dateNF})}catch(a){if(n.WTF)throw a}if(n.cellDates&&t&&e.t=="n"&&Yc(Ct[t]||String(t))){var r=us(e.v);r&&(e.t="d",e.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}}function Uu(e,n,i){return{v:e,ixfe:n,t:i}}function m9(e,n){var i={opts:{}},t={};ni!=null&&n.dense==null&&(n.dense=ni);var r=n.dense?[]:{},a={},o={},s=null,u=[],m="",f={},h,_="",y,v,C,P,D={},T=[],I,K,ee=[],k=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},U=function(xt){return xt<8?ms[xt]:xt<64&&k[xt-8]||ms[xt]},Q=function(xt,on,bi){var Bn=on.XF.data;if(!(!Bn||!Bn.patternType||!bi||!bi.cellStyles)){on.s={},on.s.patternType=Bn.patternType;var hr;(hr=Hl(U(Bn.icvFore)))&&(on.s.fgColor={rgb:hr}),(hr=Hl(U(Bn.icvBack)))&&(on.s.bgColor={rgb:hr})}},re=function(xt,on,bi){if(!(ce>1)&&!(bi.sheetRows&&xt.r>=bi.sheetRows)){if(bi.cellStyles&&on.XF&&on.XF.data&&Q(xt,on,bi),delete on.ixfe,delete on.XF,h=xt,_=vt(xt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),xt.r<o.s.r&&(o.s.r=xt.r),xt.c<o.s.c&&(o.s.c=xt.c),xt.r+1>o.e.r&&(o.e.r=xt.r+1),xt.c+1>o.e.c&&(o.e.c=xt.c+1),bi.cellFormula&&on.f){for(var Bn=0;Bn<T.length;++Bn)if(!(T[Bn][0].s.c>xt.c||T[Bn][0].s.r>xt.r)&&!(T[Bn][0].e.c<xt.c||T[Bn][0].e.r<xt.r)){on.F=Ft(T[Bn][0]),(T[Bn][0].s.c!=xt.c||T[Bn][0].s.r!=xt.r)&&delete on.f,on.f&&(on.f=""+nr(T[Bn][1],o,xt,Se,ie));break}}bi.dense?(r[xt.r]||(r[xt.r]=[]),r[xt.r][xt.c]=on):r[_]=on}},ie={enc:!1,sbcch:0,snames:[],sharedf:D,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(ie.password=n.password);var Pe,Re=[],xe=[],Be=[],we=[],$e=!1,Se=[];Se.SheetNames=ie.snames,Se.sharedf=ie.sharedf,Se.arrayf=ie.arrayf,Se.names=[],Se.XTI=[];var Ae=0,ce=0,Y=0,te=[],Z=[],J;ie.codepage=1200,ha(1200);for(var de=!1;e.l<e.length-1;){var Oe=e.l,ke=e.read_shift(2);if(ke===0&&Ae===10)break;var Me=e.l===e.length?0:e.read_shift(2),_e=Qg[ke];if(_e&&_e.f){if(n.bookSheets&&Ae===133&&ke!==133)break;if(Ae=ke,_e.r===2||_e.r==12){var it=e.read_shift(2);if(Me-=2,!ie.enc&&it!==ke&&((it&255)<<8|it>>8)!==ke)throw new Error("rt mismatch: "+it+"!="+ke);_e.r==12&&(e.l+=10,Me-=10)}var j={};if(ke===10?j=_e.f(e,Me,ie):j=u9(ke,_e,e,Me,ie),ce==0&&[9,521,1033,2057].indexOf(Ae)===-1)continue;switch(ke){case 34:i.opts.Date1904=O.WBProps.date1904=j;break;case 134:i.opts.WriteProtect=!0;break;case 47:if(ie.enc||(e.l=0),ie.enc=j,!n.password)throw new Error("File is password-protected");if(j.valid==null)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:ie.lastuser=j;break;case 66:var st=Number(j);switch(st){case 21010:st=1200;break;case 32768:st=1e4;break;case 32769:st=1252;break}ha(ie.codepage=st),de=!0;break;case 317:ie.rrtabid=j;break;case 25:ie.winlocked=j;break;case 439:i.opts.RefreshAll=j;break;case 12:i.opts.CalcCount=j;break;case 16:i.opts.CalcDelta=j;break;case 17:i.opts.CalcIter=j;break;case 13:i.opts.CalcMode=j;break;case 14:i.opts.CalcPrecision=j;break;case 95:i.opts.CalcSaveRecalc=j;break;case 15:ie.CalcRefMode=j;break;case 2211:i.opts.FullCalc=j;break;case 129:j.fDialog&&(r["!type"]="dialog"),j.fBelow||((r["!outline"]||(r["!outline"]={})).above=!0),j.fRight||((r["!outline"]||(r["!outline"]={})).left=!0);break;case 224:ee.push(j);break;case 430:Se.push([j]),Se[Se.length-1].XTI=[];break;case 35:case 547:Se[Se.length-1].push(j);break;case 24:case 536:J={Name:j.Name,Ref:nr(j.rgce,o,null,Se,ie)},j.itab>0&&(J.Sheet=j.itab-1),Se.names.push(J),Se[0]||(Se[0]=[],Se[0].XTI=[]),Se[Se.length-1].push(j),j.Name=="_xlnm._FilterDatabase"&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&j.rgce[0][0][0]=="PtgArea3d"&&(Z[j.itab-1]={ref:Ft(j.rgce[0][0][1][2])});break;case 22:ie.ExternCount=j;break;case 23:Se.length==0&&(Se[0]=[],Se[0].XTI=[]),Se[Se.length-1].XTI=Se[Se.length-1].XTI.concat(j),Se.XTI=Se.XTI.concat(j);break;case 2196:if(ie.biff<8)break;J!=null&&(J.Comment=j[1]);break;case 18:r["!protect"]=j;break;case 19:j!==0&&ie.WTF&&console.error("Password verifier: "+j);break;case 133:a[j.pos]=j,ie.snames.push(j.name);break;case 10:{if(--ce)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,r["!ref"]=Ft(o),n.sheetRows&&n.sheetRows<=o.e.r){var qe=o.e.r;o.e.r=n.sheetRows-1,r["!fullref"]=r["!ref"],r["!ref"]=Ft(o),o.e.r=qe}o.e.r++,o.e.c++}Re.length>0&&(r["!merges"]=Re),xe.length>0&&(r["!objects"]=xe),Be.length>0&&(r["!cols"]=Be),we.length>0&&(r["!rows"]=we),O.Sheets.push(R)}m===""?f=r:t[m]=r,r=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ie.biff===8&&(ie.biff={9:2,521:3,1033:4}[ke]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),ie.biffguess=j.BIFFVer==0,j.BIFFVer==0&&j.dt==4096&&(ie.biff=5,de=!0,ha(ie.codepage=28591)),ie.biff==8&&j.BIFFVer==0&&j.dt==16&&(ie.biff=2),ce++)break;if(r=n.dense?[]:{},ie.biff<8&&!de&&(de=!0,ha(ie.codepage=n.codepage||1252)),ie.biff<5||j.BIFFVer==0&&j.dt==4096){m===""&&(m="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var bt={pos:e.l-Me,name:m};a[bt.pos]=bt,ie.snames.push(m)}else m=(a[Oe]||{name:""}).name;j.dt==32&&(r["!type"]="chart"),j.dt==64&&(r["!type"]="macro"),Re=[],xe=[],ie.arrayf=T=[],Be=[],we=[],$e=!1,R={Hidden:(a[Oe]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:r["!type"]=="chart"&&(n.dense?(r[j.r]||[])[j.c]:r[vt({c:j.c,r:j.r})])&&++j.c,I={ixfe:j.ixfe,XF:ee[j.ixfe]||{},v:j.val,t:"n"},Y>0&&(I.z=te[I.ixfe>>8&63]),Aa(I,n,i.opts.Date1904),re({c:j.c,r:j.r},I,n);break;case 5:case 517:I={ixfe:j.ixfe,XF:ee[j.ixfe],v:j.val,t:j.t},Y>0&&(I.z=te[I.ixfe>>8&63]),Aa(I,n,i.opts.Date1904),re({c:j.c,r:j.r},I,n);break;case 638:I={ixfe:j.ixfe,XF:ee[j.ixfe],v:j.rknum,t:"n"},Y>0&&(I.z=te[I.ixfe>>8&63]),Aa(I,n,i.opts.Date1904),re({c:j.c,r:j.r},I,n);break;case 189:for(var Ze=j.c;Ze<=j.C;++Ze){var Fe=j.rkrec[Ze-j.c][0];I={ixfe:Fe,XF:ee[Fe],v:j.rkrec[Ze-j.c][1],t:"n"},Y>0&&(I.z=te[I.ixfe>>8&63]),Aa(I,n,i.opts.Date1904),re({c:Ze,r:j.r},I,n)}break;case 6:case 518:case 1030:{if(j.val=="String"){s=j;break}if(I=Uu(j.val,j.cell.ixfe,j.tt),I.XF=ee[I.ixfe],n.cellFormula){var Tt=j.formula;if(Tt&&Tt[0]&&Tt[0][0]&&Tt[0][0][0]=="PtgExp"){var an=Tt[0][0][1][0],Sn=Tt[0][0][1][1],zi=vt({r:an,c:Sn});D[zi]?I.f=""+nr(j.formula,o,j.cell,Se,ie):I.F=((n.dense?(r[an]||[])[Sn]:r[zi])||{}).F}else I.f=""+nr(j.formula,o,j.cell,Se,ie)}Y>0&&(I.z=te[I.ixfe>>8&63]),Aa(I,n,i.opts.Date1904),re(j.cell,I,n),s=j}break;case 7:case 519:if(s)s.val=j,I=Uu(j,s.cell.ixfe,"s"),I.XF=ee[I.ixfe],n.cellFormula&&(I.f=""+nr(s.formula,o,s.cell,Se,ie)),Y>0&&(I.z=te[I.ixfe>>8&63]),Aa(I,n,i.opts.Date1904),re(s.cell,I,n),s=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(j);var Nn=vt(j[0].s);if(y=n.dense?(r[j[0].s.r]||[])[j[0].s.c]:r[Nn],n.cellFormula&&y){if(!s||!Nn||!y)break;y.f=""+nr(j[1],o,j[0],Se,ie),y.F=Ft(j[0])}}break;case 1212:{if(!n.cellFormula)break;if(_){if(!s)break;D[vt(s.cell)]=j[0],y=n.dense?(r[s.cell.r]||[])[s.cell.c]:r[vt(s.cell)],(y||{}).f=""+nr(j[0],o,h,Se,ie)}}break;case 253:I=Uu(u[j.isst].t,j.ixfe,"s"),u[j.isst].h&&(I.h=u[j.isst].h),I.XF=ee[I.ixfe],Y>0&&(I.z=te[I.ixfe>>8&63]),Aa(I,n,i.opts.Date1904),re({c:j.c,r:j.r},I,n);break;case 513:n.sheetStubs&&(I={ixfe:j.ixfe,XF:ee[j.ixfe],t:"z"},Y>0&&(I.z=te[I.ixfe>>8&63]),Aa(I,n,i.opts.Date1904),re({c:j.c,r:j.r},I,n));break;case 190:if(n.sheetStubs)for(var Xn=j.c;Xn<=j.C;++Xn){var Ot=j.ixfe[Xn-j.c];I={ixfe:Ot,XF:ee[Ot],t:"z"},Y>0&&(I.z=te[I.ixfe>>8&63]),Aa(I,n,i.opts.Date1904),re({c:Xn,r:j.r},I,n)}break;case 214:case 516:case 4:I=Uu(j.val,j.ixfe,"s"),I.XF=ee[I.ixfe],Y>0&&(I.z=te[I.ixfe>>8&63]),Aa(I,n,i.opts.Date1904),re({c:j.c,r:j.r},I,n);break;case 0:case 512:ce===1&&(o=j);break;case 252:u=j;break;case 1054:if(ie.biff==4){te[Y++]=j[1];for(var Mn=0;Mn<Y+163&&Ct[Mn]!=j[1];++Mn);Mn>=163&&to(j[1],Y+163)}else to(j[1],j[0]);break;case 30:{te[Y++]=j;for(var Kn=0;Kn<Y+163&&Ct[Kn]!=j;++Kn);Kn>=163&&to(j,Y+163)}break;case 229:Re=Re.concat(j);break;case 93:xe[j.cmo[0]]=ie.lastobj=j;break;case 438:ie.lastobj.TxO=j;break;case 127:ie.lastobj.ImData=j;break;case 440:for(P=j[0].s.r;P<=j[0].e.r;++P)for(C=j[0].s.c;C<=j[0].e.c;++C)y=n.dense?(r[P]||[])[C]:r[vt({c:C,r:P})],y&&(y.l=j[1]);break;case 2048:for(P=j[0].s.r;P<=j[0].e.r;++P)for(C=j[0].s.c;C<=j[0].e.c;++C)y=n.dense?(r[P]||[])[C]:r[vt({c:C,r:P})],y&&y.l&&(y.l.Tooltip=j[1]);break;case 28:{if(ie.biff<=5&&ie.biff>=2)break;y=n.dense?(r[j[0].r]||[])[j[0].c]:r[vt(j[0])];var pr=xe[j[2]];y||(n.dense?(r[j[0].r]||(r[j[0].r]=[]),y=r[j[0].r][j[0].c]={t:"z"}):y=r[vt(j[0])]={t:"z"},o.e.r=Math.max(o.e.r,j[0].r),o.s.r=Math.min(o.s.r,j[0].r),o.e.c=Math.max(o.e.c,j[0].c),o.s.c=Math.min(o.s.c,j[0].c)),y.c||(y.c=[]),v={a:j[1],t:pr.TxO.t},y.c.push(v)}break;case 2173:Q8(ee[j.ixfe],j.ext);break;case 125:{if(!ie.cellStyles)break;for(;j.e>=j.s;)Be[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(j.flags&1)},$e||($e=!0,Af(j.w/256)),jo(Be[j.e+1])}break;case 520:{var It={};j.level!=null&&(we[j.r]=It,It.level=j.level),j.hidden&&(we[j.r]=It,It.hidden=!0),j.hpt&&(we[j.r]=It,It.hpt=j.hpt,It.hpx=Wc(j.hpt))}break;case 38:case 39:case 40:case 41:r["!margins"]||ps(r["!margins"]={}),r["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ke]]=j;break;case 161:r["!margins"]||ps(r["!margins"]={}),r["!margins"].header=j.header,r["!margins"].footer=j.footer;break;case 574:j.RTL&&(O.Views[0].RTL=!0);break;case 146:k=j;break;case 2198:Pe=j;break;case 140:K=j;break;case 442:m?R.CodeName=j||R.name:O.WBProps.CodeName=j||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+ke.toString(16)),e.l+=Me}return i.SheetNames=ii(a).sort(function(ui,xt){return Number(ui)-Number(xt)}).map(function(ui){return a[ui].name}),n.bookSheets||(i.Sheets=t),!i.SheetNames.length&&f["!ref"]?(i.SheetNames.push("Sheet1"),i.Sheets&&(i.Sheets.Sheet1=f)):i.Preamble=f,i.Sheets&&Z.forEach(function(ui,xt){i.Sheets[i.SheetNames[xt]]["!autofilter"]=ui}),i.Strings=u,i.SSF=Rn(Ct),ie.enc&&(i.Encryption=ie.enc),Pe&&(i.Themes=Pe),i.Metadata={},K!==void 0&&(i.Metadata.Country=K),Se.names.length>0&&(O.Names=Se.names),i.Workbook=O,i}var Vl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function g9(e,n,i){var t=ft.find(e,"/!DocumentSummaryInformation");if(t&&t.size>0)try{var r=dC(t,Gg,Vl.DSI);for(var a in r)n[a]=r[a]}catch(m){if(i.WTF)throw m}var o=ft.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var s=dC(o,Hg,Vl.SI);for(var u in s)n[u]==null&&(n[u]=s[u])}catch(m){if(i.WTF)throw m}n.HeadingPairs&&n.TitlesOfParts&&(Ov(n.HeadingPairs,n.TitlesOfParts,n,i),delete n.HeadingPairs,delete n.TitlesOfParts)}function f9(e,n){var i=[],t=[],r=[],a=0,o,s=U_(Gg,"n"),u=U_(Hg,"n");if(e.Props)for(o=ii(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(s,o[a])?i:Object.prototype.hasOwnProperty.call(u,o[a])?t:r).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=ii(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(s,o[a])?i:Object.prototype.hasOwnProperty.call(u,o[a])?t:r).push([o[a],e.Custprops[o[a]]]);var m=[];for(a=0;a<r.length;++a)Fv.indexOf(r[a][0])>-1||Pv.indexOf(r[a][0])>-1||r[a][1]!=null&&m.push(r[a]);t.length&&ft.utils.cfb_add(n,"/SummaryInformation",uC(t,Vl.SI,u,Hg)),(i.length||m.length)&&ft.utils.cfb_add(n,"/DocumentSummaryInformation",uC(i,Vl.DSI,s,Gg,m.length?m:null,Vl.UDI))}function Eb(e,n){n||(n={}),jf(n),rf(),n.codepage&&nf(n.codepage);var i,t;if(e.FullPaths){if(ft.find(e,"/encryption"))throw new Error("File is password-protected");i=ft.find(e,"!CompObj"),t=ft.find(e,"/Workbook")||ft.find(e,"/Book")}else{switch(n.type){case"base64":e=Vr(jr(e));break;case"binary":e=Vr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}$i(e,0),t={content:e}}var r,a;if(i&&l9(i),n.bookProps&&!n.bookSheets)r={};else{var o=$t?"buffer":"array";if(t&&t.content)r=m9(t.content,n);else if((a=ft.find(e,"PerfectOffice_MAIN"))&&a.content)r=fs.to_workbook(a.content,(n.type=o,n));else if((a=ft.find(e,"NativeContent_MAIN"))&&a.content)r=fs.to_workbook(a.content,(n.type=o,n));else throw(a=ft.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&ft.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=OI(e))}var s={};return e.FullPaths&&g9(e,s,n),r.Props=r.Custprops=s,n.bookFiles&&(r.cfb=e),r}function p9(e,n){var i=n||{},t=ft.utils.cfb_new({root:"R"}),r="/Workbook";switch(i.bookType||"xls"){case"xls":i.bookType="biff8";case"xla":i.bookType||(i.bookType="xla");case"biff8":r="/Workbook",i.biff=8;break;case"biff5":r="/Book",i.biff=5;break;default:throw new Error("invalid type "+i.bookType+" for XLS CFB")}return ft.utils.cfb_add(t,r,Tb(e,i)),i.biff==8&&(e.Props||e.Custprops)&&f9(e,t),i.biff==8&&e.vbaraw&&kI(t,ft.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),t}var Zl={0:{f:VD},1:{f:HD},2:{f:m7},3:{f:t7},4:{f:ZD},5:{f:l7},6:{f:x7},7:{f:a7},8:{f:w7},9:{f:M7},10:{f:b7},11:{f:y7},12:{f:XD},13:{f:f7},14:{f:i7},15:{f:QD},16:{f:bb},17:{f:C7},18:{f:s7},19:{f:yf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:CF},40:{},42:{},43:{f:x8},44:{f:p8},45:{f:v8},46:{f:y8},47:{f:b8},48:{},49:{f:zE},50:{},51:{f:nI},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:$v},62:{f:h7},63:{f:uI},64:{f:U7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:sr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:N7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:$D},148:{f:zD,p:16},151:{f:T7},152:{},153:{f:hF},154:{},155:{},156:{f:fF},157:{},158:{},159:{T:1,f:A5},160:{T:-1},161:{T:1,f:Ps},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:S7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:eI},336:{T:-1},337:{f:aI,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$g},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Yv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:I7},427:{f:A7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:F7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:YD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:k7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$g},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yI},633:{T:1},634:{T:-1},635:{T:1,f:vI},636:{T:-1},637:{f:GE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:j7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Qg={6:{f:Ng},10:{f:Bo},12:{f:vi},13:{f:vi},14:{f:ci},15:{f:ci},16:{f:rr},17:{f:ci},18:{f:ci},19:{f:vi},20:{f:xC},21:{f:xC},23:{f:Yv},24:{f:CC},25:{f:ci},26:{},27:{},28:{f:j6},29:{},34:{f:ci},35:{f:_C},38:{f:rr},39:{f:rr},40:{f:rr},41:{f:rr},42:{f:ci},43:{f:ci},47:{f:Q5},49:{f:f6},51:{f:vi},60:{},61:{f:l6},64:{f:ci},65:{f:g6},66:{f:vi},77:{},80:{},81:{},82:{},85:{f:vi},89:{},90:{},91:{},92:{f:JT},93:{f:Y6},94:{},95:{f:ci},96:{},97:{},99:{f:ci},125:{f:$v},128:{f:E6},129:{f:e6},130:{f:vi},131:{f:ci},132:{f:ci},133:{f:t6},134:{},140:{f:J6},141:{f:vi},144:{},146:{f:t5},151:{},152:{},153:{},154:{},155:{},156:{f:vi},157:{},158:{},160:{f:c5},161:{f:r5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:S6},190:{f:P6},193:{f:Bo},197:{},198:{},199:{},200:{},201:{},202:{f:ci},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:vi},220:{},221:{f:ci},222:{},224:{f:k6},225:{f:ZT},226:{f:Bo},227:{},229:{f:z6},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:i6},253:{f:h6},255:{f:a6},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Rv},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ci},353:{f:Bo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:F6},431:{f:ci},432:{},433:{},434:{},437:{},438:{f:H6},439:{f:ci},440:{f:q6},441:{},442:{f:n0},443:{},444:{f:vi},445:{},446:{},448:{f:Bo},449:{f:c6,r:2},450:{f:Bo},512:{f:fC},513:{f:s5},515:{f:A6},516:{f:_6},517:{f:hC},519:{f:l5},520:{f:o6},523:{},545:{f:vC},549:{f:gC},566:{},574:{f:u6},638:{f:w6},659:{},1048:{},1054:{f:v6},1084:{},1212:{f:L6},2048:{f:K6},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Bu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Bo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:n5,r:12},2173:{f:J8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ci,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:B6,r:12},2197:{},2198:{f:G8,r:12},2199:{},2200:{},2201:{},2202:{f:V6,r:12},2203:{f:Bo},2204:{},2205:{},2206:{},2207:{},2211:{f:s6},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:vi},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:a5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:e5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:fC},1:{},2:{f:f5},3:{f:m5},4:{f:u5},5:{f:hC},7:{f:h5},8:{},9:{f:Bu},11:{},22:{f:vi},30:{f:y6},31:{},32:{},33:{f:vC},36:{},37:{f:gC},50:{f:x5},62:{},52:{},67:{},68:{f:vi},69:{},86:{},126:{},127:{f:d5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:_5},223:{},234:{},354:{},421:{},518:{f:Ng},521:{f:Bu},536:{f:CC},547:{f:_C},561:{},579:{},1030:{f:Ng},1033:{f:Bu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function We(e,n,i,t){var r=n;if(!isNaN(r)){var a=t||(i||[]).length||0,o=e.next(4);o.write_shift(2,r),o.write_shift(2,a),a>0&&Cf(i)&&e.push(i)}}function h9(e,n,i,t){var r=t||(i||[]).length||0;if(r<=8224)return We(e,n,i,r);var a=n;if(!isNaN(a)){for(var o=i.parts||[],s=0,u=0,m=0;m+(o[s]||8224)<=8224;)m+=o[s]||8224,s++;var f=e.next(4);for(f.write_shift(2,a),f.write_shift(2,m),e.push(i.slice(u,u+m)),u+=m;u<r;){for(f=e.next(4),f.write_shift(2,60),m=0;m+(o[s]||8224)<=8224;)m+=o[s]||8224,s++;f.write_shift(2,m),e.push(i.slice(u,u+m)),u+=m}}}function o0(e,n,i){return e||(e=ye(7)),e.write_shift(2,n),e.write_shift(2,i),e.write_shift(2,0),e.write_shift(1,0),e}function x9(e,n,i,t){var r=ye(9);return o0(r,e,n),Nv(i,t||"b",r),r}function _9(e,n,i){var t=ye(8+2*i.length);return o0(t,e,n),t.write_shift(1,i.length),t.write_shift(i.length,i,"sbcs"),t.l<t.length?t.slice(0,t.l):t}function C9(e,n,i,t){if(n.v!=null)switch(n.t){case"d":case"n":var r=n.t=="d"?wi(Fn(n.v)):n.v;r==(r|0)&&r>=0&&r<65536?We(e,2,p5(i,t,r)):We(e,3,g5(i,t,r));return;case"b":case"e":We(e,5,x9(i,t,n.v,n.t));return;case"s":case"str":We(e,4,_9(i,t,(n.v||"").slice(0,255)));return}We(e,1,o0(null,i,t))}function v9(e,n,i,t){var r=Array.isArray(n),a=rn(n["!ref"]||"A1"),o,s="",u=[];if(a.e.c>255||a.e.r>16383){if(t.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=Ft(a)}for(var m=a.s.r;m<=a.e.r;++m){s=li(m);for(var f=a.s.c;f<=a.e.c;++f){m===a.s.r&&(u[f]=Hn(f)),o=u[f]+s;var h=r?(n[m]||[])[f]:n[o];h&&C9(e,h,m,f,t)}}}function b9(e,n){var i=n||{};ni!=null&&i.dense==null&&(i.dense=ni);for(var t=kr(),r=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==i.sheet&&(r=a);if(r==0&&i.sheet&&e.SheetNames[0]!=i.sheet)throw new Error("Sheet not found: "+i.sheet);return We(t,i.biff==4?1033:i.biff==3?521:9,Ef(e,16,i)),v9(t,e.Sheets[e.SheetNames[r]],r,i,e),We(t,10),t.end()}function y9(e,n,i){We(e,49,p6({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},i))}function M9(e,n,i){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&We(e,1054,b6(r,n[r],i))})}function w9(e,n){var i=ye(19);i.write_shift(4,2151),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,3),i.write_shift(1,1),i.write_shift(4,0),We(e,2151,i),i=ye(39),i.write_shift(4,2152),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,3),i.write_shift(1,0),i.write_shift(4,0),i.write_shift(2,1),i.write_shift(4,4),i.write_shift(2,0),jv(rn(n["!ref"]||"A1"),i),i.write_shift(4,4),We(e,2152,i)}function S9(e,n){for(var i=0;i<16;++i)We(e,224,pC({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(t){We(e,224,pC(t,0,n))})}function P9(e,n){for(var i=0;i<n["!links"].length;++i){var t=n["!links"][i];We(e,440,X6(t)),t[1].Tooltip&&We(e,2048,Z6(t))}delete n["!links"]}function O9(e,n){if(n){var i=0;n.forEach(function(t,r){++i<=256&&t&&We(e,125,i5(dm(r,t),r))})}}function k9(e,n,i,t,r){var a=16+Go(r.cellXfs,n,r);if(n.v==null&&!n.bf){We(e,513,vs(i,t,a));return}if(n.bf)We(e,6,eD(n,i,t,r,a));else switch(n.t){case"d":case"n":var o=n.t=="d"?wi(Fn(n.v)):n.v;We(e,515,D6(i,t,o,a,r));break;case"b":case"e":We(e,517,I6(i,t,n.v,a,r,n.t));break;case"s":case"str":if(r.bookSST){var s=Bf(r.Strings,n.v,r.revStrings);We(e,253,x6(i,t,s,a,r))}else We(e,516,C6(i,t,(n.v||"").slice(0,255),a,r));break;default:We(e,513,vs(i,t,a))}}function E9(e,n,i){var t=kr(),r=i.SheetNames[e],a=i.Sheets[r]||{},o=(i||{}).Workbook||{},s=(o.Sheets||[])[e]||{},u=Array.isArray(a),m=n.biff==8,f,h="",_=[],y=rn(a["!ref"]||"A1"),v=m?65536:16384;if(y.e.c>255||y.e.r>=v){if(n.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,v-1)}We(t,2057,Ef(i,16,n)),We(t,13,aa(1)),We(t,12,aa(100)),We(t,15,fr(!0)),We(t,17,fr(!1)),We(t,16,_s(.001)),We(t,95,fr(!0)),We(t,42,fr(!1)),We(t,43,fr(!1)),We(t,130,aa(1)),We(t,128,T6([0,0])),We(t,131,fr(!1)),We(t,132,fr(!1)),m&&O9(t,a["!cols"]),We(t,512,M6(y,n)),m&&(a["!links"]=[]);for(var C=y.s.r;C<=y.e.r;++C){h=li(C);for(var P=y.s.c;P<=y.e.c;++P){C===y.s.r&&(_[P]=Hn(P)),f=_[P]+h;var D=u?(a[C]||[])[P]:a[f];D&&(k9(t,D,C,P,n),m&&D.l&&a["!links"].push([f,D.l]))}}var T=s.CodeName||s.name||r;return m&&We(t,574,m6((o.Views||[])[0])),m&&(a["!merges"]||[]).length&&We(t,229,W6(a["!merges"])),m&&P9(t,a),We(t,442,Bv(T,n)),m&&w9(t,a),We(t,10),t.end()}function T9(e,n,i){var t=kr(),r=(e||{}).Workbook||{},a=r.Sheets||[],o=r.WBProps||{},s=i.biff==8,u=i.biff==5;if(We(t,2057,Ef(e,5,i)),i.bookType=="xla"&&We(t,135),We(t,225,s?aa(1200):null),We(t,193,IT(2)),u&&We(t,191),u&&We(t,192),We(t,226),We(t,92,QT("SheetJS",i)),We(t,66,aa(s?1200:1252)),s&&We(t,353,aa(0)),s&&We(t,448),We(t,317,o5(e.SheetNames.length)),s&&e.vbaraw&&We(t,211),s&&e.vbaraw){var m=o.CodeName||"ThisWorkbook";We(t,442,Bv(m,i))}We(t,156,aa(17)),We(t,25,fr(!1)),We(t,18,fr(!1)),We(t,19,aa(0)),s&&We(t,431,fr(!1)),s&&We(t,444,aa(0)),We(t,61,d6(i)),We(t,64,fr(!1)),We(t,141,aa(0)),We(t,34,fr(cF(e)=="true")),We(t,14,fr(!0)),s&&We(t,439,fr(!1)),We(t,218,aa(0)),y9(t,e,i),M9(t,e.SSF,i),S9(t,i),s&&We(t,352,fr(!1));var f=t.end(),h=kr();s&&We(h,140,Q6()),s&&i.Strings&&h9(h,252,r6(i.Strings,i)),We(h,10);var _=h.end(),y=kr(),v=0,C=0;for(C=0;C<e.SheetNames.length;++C)v+=(s?12:11)+(s?2:1)*e.SheetNames[C].length;var P=f.length+v+_.length;for(C=0;C<e.SheetNames.length;++C){var D=a[C]||{};We(y,133,n6({pos:P,hs:D.Hidden||0,dt:0,name:e.SheetNames[C]},i)),P+=n[C].length}var T=y.end();if(v!=T.length)throw new Error("BS8 "+v+" != "+T.length);var I=[];return f.length&&I.push(f),T.length&&I.push(T),_.length&&I.push(_),Ui(I)}function I9(e,n){var i=n||{},t=[];e&&!e.SSF&&(e.SSF=Rn(Ct)),e&&e.SSF&&($c(),nm(e.SSF),i.revssf=rm(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF),i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,zf(i),i.cellXfs=[],Go(i.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var r=0;r<e.SheetNames.length;++r)t[t.length]=E9(r,i,e);return t.unshift(T9(e,t,i)),Ui(t)}function Tb(e,n){for(var i=0;i<=e.SheetNames.length;++i){var t=e.Sheets[e.SheetNames[i]];if(!(!t||!t["!ref"])){var r=Er(t["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[i]+"' extends beyond column IV (255).  Data may be lost.")}}var a=n||{};switch(a.biff||2){case 8:case 5:return I9(e,n);case 4:case 3:case 2:return b9(e,n)}throw new Error("invalid type "+a.bookType+" for BIFF")}function TC(e,n){var i=n||{};ni!=null&&i.dense==null&&(i.dense=ni);var t=i.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var r=e.match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=r.index,s=a&&a.index||e.length,u=pE(e.slice(o,s),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,f=0,h=0,_=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(o=0;o<u.length;++o){var C=u[o].trim(),P=C.slice(0,3).toLowerCase();if(P=="<tr"){if(++m,i.sheetRows&&i.sheetRows<=m){--m;break}f=0;continue}if(!(P!="<td"&&P!="<th")){var D=C.split(/<\/t[dh]>/i);for(s=0;s<D.length;++s){var T=D[s].trim();if(T.match(/<t[dh]/i)){for(var I=T,K=0;I.charAt(0)=="<"&&(K=I.indexOf(">"))>-1;)I=I.slice(K+1);for(var ee=0;ee<v.length;++ee){var k=v[ee];k.s.c==f&&k.s.r<m&&m<=k.e.r&&(f=k.e.c+1,ee=-1)}var O=St(T.slice(0,T.indexOf(">")));_=O.colspan?+O.colspan:1,((h=+O.rowspan)>1||_>1)&&v.push({s:{r:m,c:f},e:{r:m+(h||1)-1,c:f+_-1}});var R=O.t||O["data-t"]||"";if(!I.length){f+=_;continue}if(I=av(I),y.s.r>m&&(y.s.r=m),y.e.r<m&&(y.e.r=m),y.s.c>f&&(y.s.c=f),y.e.c<f&&(y.e.c=f),!I.length){f+=_;continue}var U={t:"s",v:I};i.raw||!I.trim().length||R=="s"||(I==="TRUE"?U={t:"b",v:!0}:I==="FALSE"?U={t:"b",v:!1}:isNaN(_a(I))?isNaN(jc(I).getDate())||(U={t:"d",v:Fn(I)},i.cellDates||(U={t:"n",v:wi(U.v)}),U.z=i.dateNF||Ct[14]):U={t:"n",v:_a(I)}),i.dense?(t[m]||(t[m]=[]),t[m][f]=U):t[vt({r:m,c:f})]=U,f+=_}}}}return t["!ref"]=Ft(y),v.length&&(t["!merges"]=v),t}function A9(e,n,i,t){for(var r=e["!merges"]||[],a=[],o=n.s.c;o<=n.e.c;++o){for(var s=0,u=0,m=0;m<r.length;++m)if(!(r[m].s.r>i||r[m].s.c>o)&&!(r[m].e.r<i||r[m].e.c<o)){if(r[m].s.r<i||r[m].s.c<o){s=-1;break}s=r[m].e.r-r[m].s.r+1,u=r[m].e.c-r[m].s.c+1;break}if(!(s<0)){var f=vt({r:i,c:o}),h=t.dense?(e[i]||[])[o]:e[f],_=h&&h.v!=null&&(h.h||mf(h.w||(io(h),h.w)||""))||"",y={};s>1&&(y.rowspan=s),u>1&&(y.colspan=u),t.editable?_='<span contenteditable="true">'+_+"</span>":h&&(y["data-t"]=h&&h.t||"z",h.v!=null&&(y["data-v"]=h.v),h.z!=null&&(y["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+h.l.Target+'">'+_+"</a>")),y.id=(t.id||"sjs")+"-"+f,a.push(ze("td",_,y))}}var v="<tr>";return v+a.join("")+"</tr>"}var D9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',F9="</body></html>";function R9(e,n){var i=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!i||i.length==0)throw new Error("Invalid HTML: could not find <table>");if(i.length==1)return $o(TC(i[0],n),n);var t=Gf();return i.forEach(function(r,a){Hf(t,TC(r,n),"Sheet"+(a+1))}),t}function N9(e,n,i){var t=[];return t.join("")+"<table"+(i&&i.id?' id="'+i.id+'"':"")+">"}function Ib(e,n){var i=n||{},t=i.header!=null?i.header:D9,r=i.footer!=null?i.footer:F9,a=[t],o=Er(e["!ref"]);i.dense=Array.isArray(e),a.push(N9(e,o,i));for(var s=o.s.r;s<=o.e.r;++s)a.push(A9(e,o,s,i));return a.push("</table>"+r),a.join("")}function Ab(e,n,i){var t=i||{};ni!=null&&(t.dense=ni);var r=0,a=0;if(t.origin!=null)if(typeof t.origin=="number")r=t.origin;else{var o=typeof t.origin=="string"?qn(t.origin):t.origin;r=o.r,a=o.c}var s=n.getElementsByTagName("tr"),u=Math.min(t.sheetRows||1e7,s.length),m={s:{r:0,c:0},e:{r,c:a}};if(e["!ref"]){var f=Er(e["!ref"]);m.s.r=Math.min(m.s.r,f.s.r),m.s.c=Math.min(m.s.c,f.s.c),m.e.r=Math.max(m.e.r,f.e.r),m.e.c=Math.max(m.e.c,f.e.c),r==-1&&(m.e.r=r=f.e.r+1)}var h=[],_=0,y=e["!rows"]||(e["!rows"]=[]),v=0,C=0,P=0,D=0,T=0,I=0;for(e["!cols"]||(e["!cols"]=[]);v<s.length&&C<u;++v){var K=s[v];if(IC(K)){if(t.display)continue;y[C]={hidden:!0}}var ee=K.children;for(P=D=0;P<ee.length;++P){var k=ee[P];if(!(t.display&&IC(k))){var O=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):av(k.innerHTML),R=k.getAttribute("data-z")||k.getAttribute("z");for(_=0;_<h.length;++_){var U=h[_];U.s.c==D+a&&U.s.r<C+r&&C+r<=U.e.r&&(D=U.e.c+1-a,_=-1)}I=+k.getAttribute("colspan")||1,((T=+k.getAttribute("rowspan")||1)>1||I>1)&&h.push({s:{r:C+r,c:D+a},e:{r:C+r+(T||1)-1,c:D+a+(I||1)-1}});var Q={t:"s",v:O},re=k.getAttribute("data-t")||k.getAttribute("t")||"";O!=null&&(O.length==0?Q.t=re||"z":t.raw||O.trim().length==0||re=="s"||(O==="TRUE"?Q={t:"b",v:!0}:O==="FALSE"?Q={t:"b",v:!1}:isNaN(_a(O))?isNaN(jc(O).getDate())||(Q={t:"d",v:Fn(O)},t.cellDates||(Q={t:"n",v:wi(Q.v)}),Q.z=t.dateNF||Ct[14]):Q={t:"n",v:_a(O)})),Q.z===void 0&&R!=null&&(Q.z=R);var ie="",Pe=k.getElementsByTagName("A");if(Pe&&Pe.length)for(var Re=0;Re<Pe.length&&!(Pe[Re].hasAttribute("href")&&(ie=Pe[Re].getAttribute("href"),ie.charAt(0)!="#"));++Re);ie&&ie.charAt(0)!="#"&&(Q.l={Target:ie}),t.dense?(e[C+r]||(e[C+r]=[]),e[C+r][D+a]=Q):e[vt({c:D+a,r:C+r})]=Q,m.e.c<D+a&&(m.e.c=D+a),D+=I}}++C}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),m.e.r=Math.max(m.e.r,C-1+r),e["!ref"]=Ft(m),C>=u&&(e["!fullref"]=Ft((m.e.r=s.length-v+C-1+r,m))),e}function Db(e,n){var i=n||{},t=i.dense?[]:{};return Ab(t,e,n)}function B9(e,n){return $o(Db(e,n),n)}function IC(e){var n="",i=L9(e);return i&&(n=i(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function L9(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function V9(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(t,r){return Array(parseInt(r,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),i=nn(n.replace(/<[^>]*>/g,""));return[i]}var AC={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Fb(e,n){var i=n||{};ni!=null&&i.dense==null&&(i.dense=ni);var t=gf(e),r=[],a,o,s={name:""},u="",m=0,f,h,_={},y=[],v=i.dense?[]:{},C,P,D={value:""},T="",I=0,K,ee=[],k=-1,O=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},U=0,Q={},re=[],ie={},Pe=0,Re=0,xe=[],Be=1,we=1,$e=[],Se={Names:[]},Ae={},ce=["",""],Y=[],te={},Z="",J=0,de=!1,Oe=!1,ke=0;for($l.lastIndex=0,t=t.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");C=$l.exec(t);)switch(C[3]=C[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":C[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?v["!ref"]=Ft(R):v["!ref"]="A1:A1",i.sheetRows>0&&i.sheetRows<=R.e.r&&(v["!fullref"]=v["!ref"],R.e.r=i.sheetRows-1,v["!ref"]=Ft(R)),re.length&&(v["!merges"]=re),xe.length&&(v["!rows"]=xe),f.name=f.\u540D\u79F0||f.name,typeof JSON<"u"&&JSON.stringify(f),y.push(f.name),_[f.name]=v,Oe=!1):C[0].charAt(C[0].length-2)!=="/"&&(f=St(C[0],!1),k=O=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,v=i.dense?[]:{},re=[],xe=[],Oe=!0);break;case"table-row-group":C[1]==="/"?--U:++U;break;case"table-row":case"\u884C":if(C[1]==="/"){k+=Be,Be=1;break}if(h=St(C[0],!1),h.\u884C\u53F7?k=h.\u884C\u53F7-1:k==-1&&(k=0),Be=+h["number-rows-repeated"]||1,Be<10)for(ke=0;ke<Be;++ke)U>0&&(xe[k+ke]={level:U});O=-1;break;case"covered-table-cell":C[1]!=="/"&&++O,i.sheetStubs&&(i.dense?(v[k]||(v[k]=[]),v[k][O]={t:"z"}):v[vt({r:k,c:O})]={t:"z"}),T="",ee=[];break;case"table-cell":case"\u6570\u636E":if(C[0].charAt(C[0].length-2)==="/")++O,D=St(C[0],!1),we=parseInt(D["number-columns-repeated"]||"1",10),P={t:"z",v:null},D.formula&&i.cellFormula!=!1&&(P.f=OC(nn(D.formula))),(D.\u6570\u636E\u7C7B\u578B||D["value-type"])=="string"&&(P.t="s",P.v=nn(D["string-value"]||""),i.dense?(v[k]||(v[k]=[]),v[k][O]=P):v[vt({r:k,c:O})]=P),O+=we-1;else if(C[1]!=="/"){++O,T="",I=0,ee=[],we=1;var Me=Be?k+Be-1:k;if(O>R.e.c&&(R.e.c=O),O<R.s.c&&(R.s.c=O),k<R.s.r&&(R.s.r=k),Me>R.e.r&&(R.e.r=Me),D=St(C[0],!1),Y=[],te={},P={t:D.\u6570\u636E\u7C7B\u578B||D["value-type"],v:null},i.cellFormula)if(D.formula&&(D.formula=nn(D.formula)),D["number-matrix-columns-spanned"]&&D["number-matrix-rows-spanned"]&&(Pe=parseInt(D["number-matrix-rows-spanned"],10)||0,Re=parseInt(D["number-matrix-columns-spanned"],10)||0,ie={s:{r:k,c:O},e:{r:k+Pe-1,c:O+Re-1}},P.F=Ft(ie),$e.push([ie,P.F])),D.formula)P.f=OC(D.formula);else for(ke=0;ke<$e.length;++ke)k>=$e[ke][0].s.r&&k<=$e[ke][0].e.r&&O>=$e[ke][0].s.c&&O<=$e[ke][0].e.c&&(P.F=$e[ke][1]);switch((D["number-columns-spanned"]||D["number-rows-spanned"])&&(Pe=parseInt(D["number-rows-spanned"],10)||0,Re=parseInt(D["number-columns-spanned"],10)||0,ie={s:{r:k,c:O},e:{r:k+Pe-1,c:O+Re-1}},re.push(ie)),D["number-columns-repeated"]&&(we=parseInt(D["number-columns-repeated"],10)),P.t){case"boolean":P.t="b",P.v=Dn(D["boolean-value"]);break;case"float":P.t="n",P.v=parseFloat(D.value);break;case"percentage":P.t="n",P.v=parseFloat(D.value);break;case"currency":P.t="n",P.v=parseFloat(D.value);break;case"date":P.t="d",P.v=Fn(D["date-value"]),i.cellDates||(P.t="n",P.v=wi(P.v)),P.z="m/d/yy";break;case"time":P.t="n",P.v=mE(D["time-value"])/86400,i.cellDates&&(P.t="d",P.v=am(P.v)),P.z="HH:MM:SS";break;case"number":P.t="n",P.v=parseFloat(D.\u6570\u636E\u6570\u503C);break;default:if(P.t==="string"||P.t==="text"||!P.t)P.t="s",D["string-value"]!=null&&(T=nn(D["string-value"]),ee=[]);else throw new Error("Unsupported value type "+P.t)}}else{if(de=!1,P.t==="s"&&(P.v=T||"",ee.length&&(P.R=ee),de=I==0),Ae.Target&&(P.l=Ae),Y.length>0&&(P.c=Y,Y=[]),T&&i.cellText!==!1&&(P.w=T),de&&(P.t="z",delete P.v),(!de||i.sheetStubs)&&!(i.sheetRows&&i.sheetRows<=k))for(var _e=0;_e<Be;++_e){if(we=parseInt(D["number-columns-repeated"]||"1",10),i.dense)for(v[k+_e]||(v[k+_e]=[]),v[k+_e][O]=_e==0?P:Rn(P);--we>0;)v[k+_e][O+we]=Rn(P);else for(v[vt({r:k+_e,c:O})]=P;--we>0;)v[vt({r:k+_e,c:O+we})]=Rn(P);R.e.c<=O&&(R.e.c=O)}we=parseInt(D["number-columns-repeated"]||"1",10),O+=we-1,we=0,P={},T="",ee=[]}Ae={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(C[1]==="/"){if((a=r.pop())[0]!==C[3])throw"Bad state: "+a}else C[0].charAt(C[0].length-2)!=="/"&&r.push([C[3],!0]);break;case"annotation":if(C[1]==="/"){if((a=r.pop())[0]!==C[3])throw"Bad state: "+a;te.t=T,ee.length&&(te.R=ee),te.a=Z,Y.push(te)}else C[0].charAt(C[0].length-2)!=="/"&&r.push([C[3],!1]);Z="",J=0,T="",I=0,ee=[];break;case"creator":C[1]==="/"?Z=t.slice(J,C.index):J=C.index+C[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(C[1]==="/"){if((a=r.pop())[0]!==C[3])throw"Bad state: "+a}else C[0].charAt(C[0].length-2)!=="/"&&r.push([C[3],!1]);T="",I=0,ee=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(C[1]==="/"){if(Q[s.name]=u,(a=r.pop())[0]!==C[3])throw"Bad state: "+a}else C[0].charAt(C[0].length-2)!=="/"&&(u="",s=St(C[0],!1),r.push([C[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(r[r.length-1][0]){case"time-style":case"date-style":o=St(C[0],!1),u+=AC[C[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(r[r.length-1][0]){case"time-style":case"date-style":o=St(C[0],!1),u+=AC[C[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(C[0].slice(-2)==="/>")break;if(C[1]==="/")switch(r[r.length-1][0]){case"number-style":case"date-style":case"time-style":u+=t.slice(m,C.index);break}else m=C.index+C[0].length;break;case"named-range":o=St(C[0],!1),ce=Bg(o["cell-range-address"]);var it={Name:o.name,Ref:ce[0]+"!"+ce[1]};Oe&&(it.Sheet=y.length),Se.Names.push(it);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(r[r.length-1][0])>-1)break;if(C[1]==="/"&&(!D||!D["string-value"])){var j=V9(t.slice(I,C.index),K);T=(T.length>0?T+`
`:"")+j[0]}else K=St(C[0],!1),I=C.index+C[0].length;break;case"s":break;case"database-range":if(C[1]==="/")break;try{ce=Bg(St(C[0])["target-range-address"]),_[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(C[1]!=="/"){if(Ae=St(C[0],!1),!Ae.href)break;Ae.Target=nn(Ae.href),delete Ae.href,Ae.Target.charAt(0)=="#"&&Ae.Target.indexOf(".")>-1?(ce=Bg(Ae.Target.slice(1)),Ae.Target="#"+ce[0]+"!"+ce[1]):Ae.Target.match(/^\.\.[\\\/]/)&&(Ae.Target=Ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(C[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(i.WTF)throw new Error(C)}}var st={Sheets:_,SheetNames:y,Workbook:Se};return i.bookSheets&&delete st.Sheets,st}function DC(e,n){n=n||{},ra(e,"META-INF/manifest.xml")&&mT(Ci(e,"META-INF/manifest.xml"),n);var i=Ur(e,"content.xml");if(!i)throw new Error("Missing content.xml in ODS / UOF file");var t=Fb(yn(i),n);return ra(e,"meta.xml")&&(t.Props=wv(Ci(e,"meta.xml"))),t}function FC(e,n){return Fb(e,n)}var U9=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+Yl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return di+n}}(),RC=function(){var e=function(a){return Cn(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,i=`          <table:covered-table-cell/>
`,t=function(a,o,s){var u=[];u.push('      <table:table table:name="'+Cn(o.SheetNames[s])+`" table:style-name="ta1">
`);var m=0,f=0,h=Er(a["!ref"]||"A1"),_=a["!merges"]||[],y=0,v=Array.isArray(a);if(a["!cols"])for(f=0;f<=h.e.c;++f)u.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var C="",P=a["!rows"]||[];for(m=0;m<h.s.r;++m)C=P[m]?' table:style-name="ro'+P[m].ods+'"':"",u.push("        <table:table-row"+C+`></table:table-row>
`);for(;m<=h.e.r;++m){for(C=P[m]?' table:style-name="ro'+P[m].ods+'"':"",u.push("        <table:table-row"+C+`>
`),f=0;f<h.s.c;++f)u.push(n);for(;f<=h.e.c;++f){var D=!1,T={},I="";for(y=0;y!=_.length;++y)if(!(_[y].s.c>f)&&!(_[y].s.r>m)&&!(_[y].e.c<f)&&!(_[y].e.r<m)){(_[y].s.c!=f||_[y].s.r!=m)&&(D=!0),T["table:number-columns-spanned"]=_[y].e.c-_[y].s.c+1,T["table:number-rows-spanned"]=_[y].e.r-_[y].s.r+1;break}if(D){u.push(i);continue}var K=vt({r:m,c:f}),ee=v?(a[m]||[])[f]:a[K];if(ee&&ee.f&&(T["table:formula"]=Cn(oD(ee.f)),ee.F&&ee.F.slice(0,K.length)==K)){var k=Er(ee.F);T["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,T["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!ee){u.push(n);continue}switch(ee.t){case"b":I=ee.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=ee.v?"true":"false";break;case"n":I=ee.w||String(ee.v||0),T["office:value-type"]="float",T["office:value"]=ee.v||0;break;case"s":case"str":I=ee.v==null?"":ee.v,T["office:value-type"]="string";break;case"d":I=ee.w||Fn(ee.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=Fn(ee.v).toISOString(),T["table:style-name"]="ce1";break;default:u.push(n);continue}var O=e(I);if(ee.l&&ee.l.Target){var R=ee.l.Target;R=R.charAt(0)=="#"?"#"+sD(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),O=ze("text:a",O,{"xlink:href":R.replace(/&/g,"&amp;")})}u.push("          "+ze("table:table-cell",ze("text:p",O,{}),T)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},r=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var s=0;o.SheetNames.map(function(m){return o.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var f=0;f<m["!cols"].length;++f)if(m["!cols"][f]){var h=m["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;jo(h),h.ods=s;var _=m["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+s+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),a.push(`  </style:style>
`),++s}}});var u=0;o.SheetNames.map(function(m){return o.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var f=0;f<m["!rows"].length;++f)if(m["!rows"][f]){m["!rows"][f].ods=u;var h=m["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++u}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,s){var u=[di],m=Yl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Yl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});s.bookType=="fods"?(u.push("<office:document"+m+f+`>
`),u.push(Mv().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+m+`>
`),r(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)u.push(t(o.Sheets[o.SheetNames[h]],o,h,s));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),s.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}}();function Rb(e,n){if(n.bookType=="fods")return RC(e,n);var i=lf(),t="",r=[],a=[];return t="mimetype",Rt(i,t,"application/vnd.oasis.opendocument.spreadsheet"),t="content.xml",Rt(i,t,RC(e,n)),r.push([t,"text/xml"]),a.push([t,"ContentFile"]),t="styles.xml",Rt(i,t,U9(e,n)),r.push([t,"text/xml"]),a.push([t,"StylesFile"]),t="meta.xml",Rt(i,t,di+Mv()),r.push([t,"text/xml"]),a.push([t,"MetadataFile"]),t="manifest.rdf",Rt(i,t,pT(a)),r.push([t,"application/rdf+xml"]),t="META-INF/manifest.xml",Rt(i,t,gT(r)),i}function bs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ef(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):yn(Yo(e))}function j9(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Vr(Ra(e))}function z9(e,n){e:for(var i=0;i<=e.length-n.length;++i){for(var t=0;t<n.length;++t)if(e[i+t]!=n[t])continue e;return!0}return!1}function Wo(e){var n=e.reduce(function(r,a){return r+a.length},0),i=new Uint8Array(n),t=0;return e.forEach(function(r){i.set(r,t),t+=r.length}),i}function NC(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function W9(e,n){for(var i=(e[n+15]&127)<<7|e[n+14]>>1,t=e[n+14]&1,r=n+13;r>=n;--r)t=t*256+e[r];return(e[n+15]&128?-t:t)*Math.pow(10,i-6176)}function Y9(e,n,i){var t=Math.floor(i==0?0:Math.LOG10E*Math.log(Math.abs(i)))+6176-20,r=i/Math.pow(10,t-6176);e[n+15]|=t>>7,e[n+14]|=(t&127)<<1;for(var a=0;r>=1;++a,r/=256)e[n+a]=r&255;e[n+15]|=i>=0?0:128}function Jl(e,n){var i=n?n[0]:0,t=e[i]&127;e:if(e[i++]>=128&&(t|=(e[i]&127)<<7,e[i++]<128||(t|=(e[i]&127)<<14,e[i++]<128)||(t|=(e[i]&127)<<21,e[i++]<128)||(t+=(e[i]&127)*Math.pow(2,28),++i,e[i++]<128)||(t+=(e[i]&127)*Math.pow(2,35),++i,e[i++]<128)||(t+=(e[i]&127)*Math.pow(2,42),++i,e[i++]<128)))break e;return n&&(n[0]=i),t}function xn(e){var n=new Uint8Array(7);n[0]=e&127;var i=1;e:if(e>127){if(n[i-1]|=128,n[i]=e>>7&127,++i,e<=16383||(n[i-1]|=128,n[i]=e>>14&127,++i,e<=2097151)||(n[i-1]|=128,n[i]=e>>21&127,++i,e<=268435455)||(n[i-1]|=128,n[i]=e/256>>>21&127,++i,e<=34359738367)||(n[i-1]|=128,n[i]=e/65536>>>21&127,++i,e<=4398046511103))break e;n[i-1]|=128,n[i]=e/16777216>>>21&127,++i}return n.slice(0,i)}function ti(e){var n=0,i=e[n]&127;e:if(e[n++]>=128){if(i|=(e[n]&127)<<7,e[n++]<128||(i|=(e[n]&127)<<14,e[n++]<128)||(i|=(e[n]&127)<<21,e[n++]<128))break e;i|=(e[n]&127)<<28}return i}function ln(e){for(var n=[],i=[0];i[0]<e.length;){var t=i[0],r=Jl(e,i),a=r&7;r=Math.floor(r/8);var o=0,s;if(r==0)break;switch(a){case 0:{for(var u=i[0];e[i[0]++]>=128;);s=e.slice(u,i[0])}break;case 5:o=4,s=e.slice(i[0],i[0]+o),i[0]+=o;break;case 1:o=8,s=e.slice(i[0],i[0]+o),i[0]+=o;break;case 2:o=Jl(e,i),s=e.slice(i[0],i[0]+o),i[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(r," at offset ").concat(t))}var m={data:s,type:a};n[r]==null?n[r]=[m]:n[r].push(m)}return n}function Yi(e){var n=[];return e.forEach(function(i,t){i.forEach(function(r){r.data&&(n.push(xn(t*8+r.type)),r.type==2&&n.push(xn(r.data.length)),n.push(r.data))})}),Wo(n)}function Uf(e,n){return(e==null?void 0:e.map(function(i){return n(i.data)}))||[]}function na(e){for(var n,i=[],t=[0];t[0]<e.length;){var r=Jl(e,t),a=ln(e.slice(t[0],t[0]+r));t[0]+=r;var o={id:ti(a[1][0].data),messages:[]};a[2].forEach(function(s){var u=ln(s.data),m=ti(u[3][0].data);o.messages.push({meta:u,data:e.slice(t[0],t[0]+m)}),t[0]+=m}),(n=a[3])!=null&&n[0]&&(o.merge=ti(a[3][0].data)>>>0>0),i.push(o)}return i}function Ic(e){var n=[];return e.forEach(function(i){var t=[];t[1]=[{data:xn(i.id),type:0}],t[2]=[],i.merge!=null&&(t[3]=[{data:xn(+!!i.merge),type:0}]);var r=[];i.messages.forEach(function(o){r.push(o.data),o.meta[3]=[{type:0,data:xn(o.data.length)}],t[2].push({data:Yi(o.meta),type:2})});var a=Yi(t);n.push(xn(a.length)),n.push(a),r.forEach(function(o){return n.push(o)})}),Wo(n)}function $9(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var i=[0],t=Jl(n,i),r=[];i[0]<n.length;){var a=n[i[0]]&3;if(a==0){var o=n[i[0]++]>>2;if(o<60)++o;else{var s=o-59;o=n[i[0]],s>1&&(o|=n[i[0]+1]<<8),s>2&&(o|=n[i[0]+2]<<16),s>3&&(o|=n[i[0]+3]<<24),o>>>=0,o++,i[0]+=s}r.push(n.slice(i[0],i[0]+o)),i[0]+=o;continue}else{var u=0,m=0;if(a==1?(m=(n[i[0]]>>2&7)+4,u=(n[i[0]++]&224)<<3,u|=n[i[0]++]):(m=(n[i[0]++]>>2)+1,a==2?(u=n[i[0]]|n[i[0]+1]<<8,i[0]+=2):(u=(n[i[0]]|n[i[0]+1]<<8|n[i[0]+2]<<16|n[i[0]+3]<<24)>>>0,i[0]+=4)),r=[Wo(r)],u==0)throw new Error("Invalid offset 0");if(u>r[0].length)throw new Error("Invalid offset beyond length");if(m>=u)for(r.push(r[0].slice(-u)),m-=u;m>=r[r.length-1].length;)r.push(r[r.length-1]),m-=r[r.length-1].length;r.push(r[0].slice(-u,-u+m))}}var f=Wo(r);if(f.length!=t)throw new Error("Unexpected length: ".concat(f.length," != ").concat(t));return f}function ia(e){for(var n=[],i=0;i<e.length;){var t=e[i++],r=e[i]|e[i+1]<<8|e[i+2]<<16;i+=3,n.push($9(t,e.slice(i,i+r))),i+=r}if(i!==e.length)throw new Error("data is not a valid framed stream!");return Wo(n)}function Ac(e){for(var n=[],i=0;i<e.length;){var t=Math.min(e.length-i,268435455),r=new Uint8Array(4);n.push(r);var a=xn(t),o=a.length;n.push(a),t<=60?(o++,n.push(new Uint8Array([t-1<<2]))):t<=256?(o+=2,n.push(new Uint8Array([240,t-1&255]))):t<=65536?(o+=3,n.push(new Uint8Array([244,t-1&255,t-1>>8&255]))):t<=16777216?(o+=4,n.push(new Uint8Array([248,t-1&255,t-1>>8&255,t-1>>16&255]))):t<=4294967296&&(o+=5,n.push(new Uint8Array([252,t-1&255,t-1>>8&255,t-1>>16&255,t-1>>>24&255]))),n.push(e.slice(i,i+t)),o+=t,r[0]=0,r[1]=o&255,r[2]=o>>8&255,r[3]=o>>16&255,i+=t}return Wo(n)}function G9(e,n,i,t){var r=bs(e),a=r.getUint32(4,!0),o=(t>1?12:8)+NC(a&(t>1?3470:398))*4,s=-1,u=-1,m=NaN,f=new Date(2001,0,1);a&512&&(s=r.getUint32(o,!0),o+=4),o+=NC(a&(t>1?12288:4096))*4,a&16&&(u=r.getUint32(o,!0),o+=4),a&32&&(m=r.getFloat64(o,!0),o+=8),a&64&&(f.setTime(f.getTime()+r.getFloat64(o,!0)*1e3),o+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:m};break;case 3:h={t:"s",v:n[u]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:m>0};break;case 7:h={t:"n",v:m/86400};break;case 8:h={t:"e",v:0};break;case 9:if(s>-1)h={t:"s",v:i[s]};else if(u>-1)h={t:"s",v:n[u]};else if(!isNaN(m))h={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function H9(e,n,i){var t=bs(e),r=t.getUint32(8,!0),a=12,o=-1,s=-1,u=NaN,m=NaN,f=new Date(2001,0,1);r&1&&(u=W9(e,a),a+=16),r&2&&(m=t.getFloat64(a,!0),a+=8),r&4&&(f.setTime(f.getTime()+t.getFloat64(a,!0)*1e3),a+=8),r&8&&(s=t.getUint32(a,!0),a+=4),r&16&&(o=t.getUint32(a,!0),a+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:n[s]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:m>0};break;case 7:h={t:"n",v:m/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:i[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(r&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(r&31," : ").concat(e.slice(0,4)))}return h}function Vg(e,n){var i=new Uint8Array(32),t=bs(i),r=12,a=0;switch(i[0]=5,e.t){case"n":i[1]=2,Y9(i,r,e.v),a|=1,r+=16;break;case"b":i[1]=6,t.setFloat64(r,e.v?1:0,!0),a|=2,r+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));i[1]=3,t.setUint32(r,n.indexOf(e.v),!0),a|=8,r+=4;break;default:throw"unsupported cell type "+e.t}return t.setUint32(8,a,!0),i.slice(0,r)}function Ug(e,n){var i=new Uint8Array(32),t=bs(i),r=12,a=0;switch(i[0]=3,e.t){case"n":i[2]=2,t.setFloat64(r,e.v,!0),a|=32,r+=8;break;case"b":i[2]=6,t.setFloat64(r,e.v?1:0,!0),a|=32,r+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));i[2]=3,t.setUint32(r,n.indexOf(e.v),!0),a|=16,r+=4;break;default:throw"unsupported cell type "+e.t}return t.setUint32(4,a,!0),i.slice(0,r)}function q9(e,n,i){switch(e[0]){case 0:case 1:case 2:case 3:return G9(e,n,i,e[0]);case 5:return H9(e,n,i);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function tr(e){var n=ln(e);return Jl(n[1][0].data)}function BC(e,n){var i=ln(n.data),t=ti(i[1][0].data),r=i[3],a=[];return(r||[]).forEach(function(o){var s=ln(o.data),u=ti(s[1][0].data)>>>0;switch(t){case 1:a[u]=ef(s[3][0].data);break;case 8:{var m=e[tr(s[9][0].data)][0],f=ln(m.data),h=e[tr(f[1][0].data)][0],_=ti(h.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var y=ln(h.data);a[u]=y[3].map(function(v){return ef(v.data)}).join("")}break}}),a}function X9(e,n){var i,t,r,a,o,s,u,m,f,h,_,y,v,C,P=ln(e),D=ti(P[1][0].data)>>>0,T=ti(P[2][0].data)>>>0,I=((t=(i=P[8])==null?void 0:i[0])==null?void 0:t.data)&&ti(P[8][0].data)>0||!1,K,ee;if((a=(r=P[7])==null?void 0:r[0])!=null&&a.data&&n!=0)K=(s=(o=P[7])==null?void 0:o[0])==null?void 0:s.data,ee=(m=(u=P[6])==null?void 0:u[0])==null?void 0:m.data;else if((h=(f=P[4])==null?void 0:f[0])!=null&&h.data&&n!=1)K=(y=(_=P[4])==null?void 0:_[0])==null?void 0:y.data,ee=(C=(v=P[3])==null?void 0:v[0])==null?void 0:C.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var k=I?4:1,O=bs(K),R=[],U=0;U<K.length/2;++U){var Q=O.getUint16(U*2,!0);Q<65535&&R.push([U,Q])}if(R.length!=T)throw"Expected ".concat(T," cells, found ").concat(R.length);var re=[];for(U=0;U<R.length-1;++U)re[R[U][0]]=ee.subarray(R[U][1]*k,R[U+1][1]*k);return R.length>=1&&(re[R[R.length-1][0]]=ee.subarray(R[R.length-1][1]*k)),{R:D,cells:re}}function K9(e,n){var i,t=ln(n.data),r=(i=t==null?void 0:t[7])!=null&&i[0]?ti(t[7][0].data)>>>0>0?1:0:-1,a=Uf(t[5],function(o){return X9(o,r)});return{nrows:ti(t[4][0].data)>>>0,data:a.reduce(function(o,s){return o[s.R]||(o[s.R]=[]),s.cells.forEach(function(u,m){if(o[s.R][m])throw new Error("Duplicate cell r=".concat(s.R," c=").concat(m));o[s.R][m]=u}),o},[])}}function Z9(e,n,i){var t,r=ln(n.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(ti(r[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(r[6][0].data));if(a.e.c=(ti(r[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(r[7][0].data));i["!ref"]=Ft(a);var o=ln(r[4][0].data),s=BC(e,e[tr(o[4][0].data)][0]),u=(t=o[17])!=null&&t[0]?BC(e,e[tr(o[17][0].data)][0]):[],m=ln(o[3][0].data),f=0;m[1].forEach(function(h){var _=ln(h.data),y=e[tr(_[2][0].data)][0],v=ti(y.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var C=K9(e,y);C.data.forEach(function(P,D){P.forEach(function(T,I){var K=vt({r:f+D,c:I}),ee=q9(T,s,u);ee&&(i[K]=ee)})}),f+=C.nrows})}function J9(e,n){var i=ln(n.data),t={"!ref":"A1"},r=e[tr(i[2][0].data)],a=ti(r[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Z9(e,r[0],t),t}function Q9(e,n){var i,t=ln(n.data),r={name:(i=t[1])!=null&&i[0]?ef(t[1][0].data):"",sheets:[]},a=Uf(t[2],tr);return a.forEach(function(o){e[o].forEach(function(s){var u=ti(s.meta[1][0].data);u==6e3&&r.sheets.push(J9(e,s))})}),r}function eR(e,n){var i=Gf(),t=ln(n.data),r=Uf(t[1],tr);if(r.forEach(function(a){e[a].forEach(function(o){var s=ti(o.meta[1][0].data);if(s==2){var u=Q9(e,o);u.sheets.forEach(function(m,f){Hf(i,m,f==0?u.name:u.name+"_"+f,!0)})}})}),i.SheetNames.length==0)throw new Error("Empty NUMBERS file");return i}function jg(e){var n,i,t,r,a={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var m;try{m=ia(u.content)}catch(h){return console.log("?? "+u.content.length+" "+(h.message||h))}var f;try{f=na(m)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){a[h.id]=h.messages,o.push(h.id)})}}),!o.length)throw new Error("File has no messages");var s=((r=(t=(i=(n=a==null?void 0:a[1])==null?void 0:n[0])==null?void 0:i.meta)==null?void 0:t[1])==null?void 0:r[0].data)&&ti(a[1][0].meta[1][0].data)==1&&a[1][0];if(s||o.forEach(function(u){a[u].forEach(function(m){var f=ti(m.meta[1][0].data)>>>0;if(f==1)if(!s)s=m;else throw new Error("Document has multiple roots")})}),!s)throw new Error("Cannot find Document root");return eR(a,s)}function tR(e,n,i){var t,r,a,o;if(!((t=e[6])!=null&&t[0])||!((r=e[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var s=((o=(a=e[8])==null?void 0:a[0])==null?void 0:o.data)&&ti(e[8][0].data)>0||!1;if(s)throw"Math only works with normal offsets";for(var u=0,m=bs(e[7][0].data),f=0,h=[],_=bs(e[4][0].data),y=0,v=[],C=0;C<n.length;++C){if(n[C]==null){m.setUint16(C*2,65535,!0),_.setUint16(C*2,65535);continue}m.setUint16(C*2,f,!0),_.setUint16(C*2,y,!0);var P,D;switch(typeof n[C]){case"string":P=Vg({t:"s",v:n[C]},i),D=Ug({t:"s",v:n[C]},i);break;case"number":P=Vg({t:"n",v:n[C]},i),D=Ug({t:"n",v:n[C]},i);break;case"boolean":P=Vg({t:"b",v:n[C]},i),D=Ug({t:"b",v:n[C]},i);break;default:throw new Error("Unsupported value "+n[C])}h.push(P),f+=P.length,v.push(D),y+=D.length,++u}for(e[2][0].data=xn(u);C<e[7][0].data.length/2;++C)m.setUint16(C*2,65535,!0),_.setUint16(C*2,65535,!0);return e[6][0].data=Wo(h),e[3][0].data=Wo(v),u}function nR(e,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var i=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var t=Er(i["!ref"]);t.s.r=t.s.c=0;var r=!1;t.e.c>9&&(r=!0,t.e.c=9),t.e.r>49&&(r=!0,t.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(Ft(t)));var a=em(i,{range:t,header:1}),o=["~Sh33tJ5~"];a.forEach(function(Z){return Z.forEach(function(J){typeof J=="string"&&o.push(J)})});var s={},u=[],m=ft.read(n.numbers,{type:"base64"});m.FileIndex.map(function(Z,J){return[Z,m.FullPaths[J]]}).forEach(function(Z){var J=Z[0],de=Z[1];if(J.type==2&&J.name.match(/\.iwa/)){var Oe=J.content,ke=ia(Oe),Me=na(ke);Me.forEach(function(_e){u.push(_e.id),s[_e.id]={deps:[],location:de,type:ti(_e.messages[0].meta[1][0].data)}})}}),u.sort(function(Z,J){return Z-J});var f=u.filter(function(Z){return Z>1}).map(function(Z){return[Z,xn(Z)]});m.FileIndex.map(function(Z,J){return[Z,m.FullPaths[J]]}).forEach(function(Z){var J=Z[0],de=Z[1];if(J.name.match(/\.iwa/)){var Oe=na(ia(J.content));Oe.forEach(function(ke){ke.messages.forEach(function(Me){f.forEach(function(_e){ke.messages.some(function(it){return ti(it.meta[1][0].data)!=11006&&z9(it.data,_e[1])})&&s[_e[0]].deps.push(ke.id)})})})}});function h(){for(var Z=927262;Z<2e6;++Z)if(!s[Z])return Z;throw new Error("Too many messages")}for(var _=ft.find(m,s[1].location),y=na(ia(_.content)),v,C=0;C<y.length;++C){var P=y[C];P.id==1&&(v=P)}var D=tr(ln(v.messages[0].data)[1][0].data);for(_=ft.find(m,s[D].location),y=na(ia(_.content)),C=0;C<y.length;++C)P=y[C],P.id==D&&(v=P);for(D=tr(ln(v.messages[0].data)[2][0].data),_=ft.find(m,s[D].location),y=na(ia(_.content)),C=0;C<y.length;++C)P=y[C],P.id==D&&(v=P);for(D=tr(ln(v.messages[0].data)[2][0].data),_=ft.find(m,s[D].location),y=na(ia(_.content)),C=0;C<y.length;++C)P=y[C],P.id==D&&(v=P);var T=ln(v.messages[0].data);{T[6][0].data=xn(t.e.r+1),T[7][0].data=xn(t.e.c+1);var I=tr(T[46][0].data),K=ft.find(m,s[I].location),ee=na(ia(K.content));{for(var k=0;k<ee.length&&ee[k].id!=I;++k);if(ee[k].id!=I)throw"Bad ColumnRowUIDMapArchive";var O=ln(ee[k].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var R=0;R<=t.e.c;++R){var U=[];U[1]=U[2]=[{type:0,data:xn(R+420690)}],O[1].push({type:2,data:Yi(U)}),O[2].push({type:0,data:xn(R)}),O[3].push({type:0,data:xn(R)})}O[4]=[],O[5]=[],O[6]=[];for(var Q=0;Q<=t.e.r;++Q)U=[],U[1]=U[2]=[{type:0,data:xn(Q+726270)}],O[4].push({type:2,data:Yi(U)}),O[5].push({type:0,data:xn(Q)}),O[6].push({type:0,data:xn(Q)});ee[k].messages[0].data=Yi(O)}K.content=Ac(Ic(ee)),K.size=K.content.length,delete T[46];var re=ln(T[4][0].data);{re[7][0].data=xn(t.e.r+1);var ie=ln(re[1][0].data),Pe=tr(ie[2][0].data);K=ft.find(m,s[Pe].location),ee=na(ia(K.content));{if(ee[0].id!=Pe)throw"Bad HeaderStorageBucket";var Re=ln(ee[0].messages[0].data);for(Q=0;Q<a.length;++Q){var xe=ln(Re[2][0].data);xe[1][0].data=xn(Q),xe[4][0].data=xn(a[Q].length),Re[2][Q]={type:Re[2][0].type,data:Yi(xe)}}ee[0].messages[0].data=Yi(Re)}K.content=Ac(Ic(ee)),K.size=K.content.length;var Be=tr(re[2][0].data);K=ft.find(m,s[Be].location),ee=na(ia(K.content));{if(ee[0].id!=Be)throw"Bad HeaderStorageBucket";for(Re=ln(ee[0].messages[0].data),R=0;R<=t.e.c;++R)xe=ln(Re[2][0].data),xe[1][0].data=xn(R),xe[4][0].data=xn(t.e.r+1),Re[2][R]={type:Re[2][0].type,data:Yi(xe)};ee[0].messages[0].data=Yi(Re)}K.content=Ac(Ic(ee)),K.size=K.content.length;var we=tr(re[4][0].data);(function(){for(var Z=ft.find(m,s[we].location),J=na(ia(Z.content)),de,Oe=0;Oe<J.length;++Oe){var ke=J[Oe];ke.id==we&&(de=ke)}var Me=ln(de.messages[0].data);{Me[3]=[];var _e=[];o.forEach(function(st,qe){_e[1]=[{type:0,data:xn(qe)}],_e[2]=[{type:0,data:xn(1)}],_e[3]=[{type:2,data:j9(st)}],Me[3].push({type:2,data:Yi(_e)})})}de.messages[0].data=Yi(Me);var it=Ic(J),j=Ac(it);Z.content=j,Z.size=Z.content.length})();var $e=ln(re[3][0].data);{var Se=$e[1][0];delete $e[2];var Ae=ln(Se.data);{var ce=tr(Ae[2][0].data);(function(){for(var Z=ft.find(m,s[ce].location),J=na(ia(Z.content)),de,Oe=0;Oe<J.length;++Oe){var ke=J[Oe];ke.id==ce&&(de=ke)}var Me=ln(de.messages[0].data);{delete Me[6],delete $e[7];var _e=new Uint8Array(Me[5][0].data);Me[5]=[];for(var it=0,j=0;j<=t.e.r;++j){var st=ln(_e);it+=tR(st,a[j],o),st[1][0].data=xn(j),Me[5].push({data:Yi(st),type:2})}Me[1]=[{type:0,data:xn(t.e.c+1)}],Me[2]=[{type:0,data:xn(t.e.r+1)}],Me[3]=[{type:0,data:xn(it)}],Me[4]=[{type:0,data:xn(t.e.r+1)}]}de.messages[0].data=Yi(Me);var qe=Ic(J),bt=Ac(qe);Z.content=bt,Z.size=Z.content.length})()}Se.data=Yi(Ae)}re[3][0].data=Yi($e)}T[4][0].data=Yi(re)}v.messages[0].data=Yi(T);var Y=Ic(y),te=Ac(Y);return _.content=te,_.size=_.content.length,m}function Nb(e){return function(i){for(var t=0;t!=e.length;++t){var r=e[t];i[r[0]]===void 0&&(i[r[0]]=r[1]),r[2]==="n"&&(i[r[0]]=Number(i[r[0]]))}}}function jf(e){Nb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function zf(e){Nb([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function iR(e){return Nt.WS.indexOf(e)>-1?"sheet":Nt.CS&&e==Nt.CS?"chart":Nt.DS&&e==Nt.DS?"dialog":Nt.MS&&e==Nt.MS?"macro":e&&e.length?e:"sheet"}function rR(e,n){if(!e)return 0;try{e=n.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,iR(e["!id"][t.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function aR(e,n,i,t,r,a,o,s,u,m,f,h){try{a[t]=Rl(Ur(e,i,!0),n);var _=Ci(e,n),y;switch(s){case"sheet":y=OF(_,n,r,u,a[t],m,f,h);break;case"chart":if(y=kF(_,n,r,u,a[t],m,f,h),!y||!y["!drawel"])break;var v=Il(y["!drawel"].Target,n),C=Gl(v),P=fI(Ur(e,v,!0),Rl(Ur(e,C,!0),v)),D=Il(P,v),T=Gl(D);y=tF(Ur(e,D,!0),D,u,Rl(Ur(e,T,!0),D),m,y);break;case"macro":y=EF(_,n,r,u,a[t],m,f,h);break;case"dialog":y=TF(_,n,r,u,a[t],m,f,h);break;default:throw new Error("Unrecognized sheet type "+s)}o[t]=y;var I=[];a&&a[t]&&ii(a[t]).forEach(function(K){var ee="";if(a[t][K].Type==Nt.CMNT){ee=Il(a[t][K].Target,n);var k=FF(Ci(e,ee,!0),ee,u);if(!k||!k.length)return;yC(y,k,!1)}a[t][K].Type==Nt.TCMNT&&(ee=Il(a[t][K].Target,n),I=I.concat(hI(Ci(e,ee,!0),u)))}),I&&I.length&&yC(y,I,!0,u.people||[])}catch(K){if(u.WTF)throw K}}function ea(e){return e.charAt(0)=="/"?e.slice(1):e}function oR(e,n){if($c(),n=n||{},jf(n),ra(e,"META-INF/manifest.xml")||ra(e,"objectdata.xml"))return DC(e,n);if(ra(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof jg<"u"){if(e.FileIndex)return jg(e);var i=ft.utils.cfb_new();return W_(e).forEach(function(Re){Rt(i,Re,tv(e,Re))}),jg(i)}throw new Error("Unsupported NUMBERS file")}if(!ra(e,"[Content_Types].xml"))throw ra(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ra(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var t=W_(e),r=dT(Ur(e,"[Content_Types].xml")),a=!1,o,s;if(r.workbooks.length===0&&(s="xl/workbook.xml",Ci(e,s,!0)&&r.workbooks.push(s)),r.workbooks.length===0){if(s="xl/workbook.bin",!Ci(e,s,!0))throw new Error("Could not find workbook");r.workbooks.push(s),a=!0}r.workbooks[0].slice(-3)=="bin"&&(a=!0);var u={},m={};if(!n.bookSheets&&!n.bookProps){if(Nl=[],r.sst)try{Nl=DF(Ci(e,ea(r.sst)),r.sst,n)}catch(Re){if(n.WTF)throw Re}n.cellStyles&&r.themes.length&&(u=AF(Ur(e,r.themes[0].replace(/^\//,""),!0)||"",r.themes[0],n)),r.style&&(m=IF(Ci(e,ea(r.style)),r.style,u,n))}r.links.map(function(Re){try{var xe=Rl(Ur(e,Gl(ea(Re))),Re);return NF(Ci(e,ea(Re)),xe,Re,n)}catch{}});var f=PF(Ci(e,ea(r.workbooks[0])),r.workbooks[0],n),h={},_="";r.coreprops.length&&(_=Ci(e,ea(r.coreprops[0]),!0),_&&(h=wv(_)),r.extprops.length!==0&&(_=Ci(e,ea(r.extprops[0]),!0),_&&xT(_,h,n)));var y={};(!n.bookSheets||n.bookProps)&&r.custprops.length!==0&&(_=Ur(e,ea(r.custprops[0]),!0),_&&(y=CT(_,n)));var v={};if((n.bookSheets||n.bookProps)&&(f.Sheets?o=f.Sheets.map(function(xe){return xe.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),n.bookProps&&(v.Props=h,v.Custprops=y),n.bookSheets&&typeof o<"u"&&(v.SheetNames=o),n.bookSheets?v.SheetNames:n.bookProps))return v;o={};var C={};n.bookDeps&&r.calcchain&&(C=RF(Ci(e,ea(r.calcchain)),r.calcchain,n));var P=0,D={},T,I;{var K=f.Sheets;h.Worksheets=K.length,h.SheetNames=[];for(var ee=0;ee!=K.length;++ee)h.SheetNames[ee]=K[ee].name}var k=a?"bin":"xml",O=r.workbooks[0].lastIndexOf("/"),R=(r.workbooks[0].slice(0,O+1)+"_rels/"+r.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");ra(e,R)||(R="xl/_rels/workbook."+k+".rels");var U=Rl(Ur(e,R,!0),R.replace(/_rels.*/,"s5s"));(r.metadata||[]).length>=1&&(n.xlmeta=BF(Ci(e,ea(r.metadata[0])),r.metadata[0],n)),(r.people||[]).length>=1&&(n.people=_I(Ci(e,ea(r.people[0])),n)),U&&(U=rR(U,f.Sheets));var Q=Ci(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(P=0;P!=h.Worksheets;++P){var re="sheet";if(U&&U[P]?(T="xl/"+U[P][1].replace(/[\/]?xl\//,""),ra(e,T)||(T=U[P][1]),ra(e,T)||(T=R.replace(/_rels\/.*$/,"")+U[P][1]),re=U[P][2]):(T="xl/worksheets/sheet"+(P+1-Q)+"."+k,T=T.replace(/sheet0\./,"sheet.")),I=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(P!=n.sheets)continue e;break;case"string":if(h.SheetNames[P].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var ie=!1,Pe=0;Pe!=n.sheets.length;++Pe)typeof n.sheets[Pe]=="number"&&n.sheets[Pe]==P&&(ie=1),typeof n.sheets[Pe]=="string"&&n.sheets[Pe].toLowerCase()==h.SheetNames[P].toLowerCase()&&(ie=1);if(!ie)continue e}}aR(e,T,I,h.SheetNames[P],P,D,o,re,n,f,u,m)}return v={Directory:r,Workbook:f,Props:h,Custprops:y,Deps:C,Sheets:o,SheetNames:h.SheetNames,Strings:Nl,Styles:m,Themes:u,SSF:Rn(Ct)},n&&n.bookFiles&&(e.files?(v.keys=t,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(Re,xe){Re=Re.replace(/^Root Entry[\/]/,""),v.keys.push(Re),v.files[Re]=e.FileIndex[xe]}))),n&&n.bookVBA&&(r.vba.length>0?v.vbaraw=Ci(e,ea(r.vba[0]),!0):r.defaults&&r.defaults.bin===PI&&(v.vbaraw=Ci(e,"xl/vbaProject.bin",!0))),v}function sR(e,n){var i=n||{},t="Workbook",r=ft.find(e,t);try{if(t="/!DataSpaces/Version",r=ft.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);if(B5(r.content),t="/!DataSpaces/DataSpaceMap",r=ft.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);var a=V5(r.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+t);if(t="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",r=ft.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);var o=U5(r.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+t);if(t="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",r=ft.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);z5(r.content)}catch{}if(t="/EncryptionInfo",r=ft.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);var s=W5(r.content);if(t="/EncryptedPackage",r=ft.find(e,t),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+t);if(s[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(s[1],r.content,i.password||"",i);if(s[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(s[1],r.content,i.password||"",i);throw new Error("File is password-protected")}function cR(e,n){return n.bookType=="ods"?Rb(e,n):n.bookType=="numbers"?nR(e,n):n.bookType=="xlsb"?lR(e,n):dR(e,n)}function lR(e,n){Rc=1024,e&&!e.SSF&&(e.SSF=Rn(Ct)),e&&e.SSF&&($c(),nm(e.SSF),n.revssf=rm(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Bl?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var i=n.bookType=="xlsb"?"bin":"xml",t=lb.indexOf(n.bookType)>-1,r=Of();zf(n=n||{});var a=lf(),o="",s=0;if(n.cellXfs=[],Go(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Rt(a,o,Sv(e.Props,n)),r.coreprops.push(o),_n(n.rels,2,o,Nt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&u.push(e.SheetNames[m]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,Rt(a,o,kv(e.Props,n)),r.extprops.push(o),_n(n.rels,3,o,Nt.EXT_PROPS),e.Custprops!==e.Props&&ii(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Rt(a,o,Ev(e.Custprops,n)),r.custprops.push(o),_n(n.rels,4,o,Nt.CUST_PROPS)),s=1;s<=e.SheetNames.length;++s){var f={"!id":{}},h=e.Sheets[e.SheetNames[s-1]],_=(h||{})["!type"]||"sheet";switch(_){case"chart":default:o="xl/worksheets/sheet"+s+"."+i,Rt(a,o,VF(s-1,o,n,e,f)),r.sheets.push(o),_n(n.wbrels,-1,"worksheets/sheet"+s+"."+i,Nt.WS[0])}if(h){var y=h["!comments"],v=!1,C="";y&&y.length>0&&(C="xl/comments"+s+"."+i,Rt(a,C,zF(y,C,n)),r.comments.push(C),_n(f,-1,"../comments"+s+"."+i,Nt.CMNT),v=!0),h["!legacy"]&&v&&Rt(a,"xl/drawings/vmlDrawing"+s+".vml",sb(s,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Rt(a,Gl(o),Bc(f))}return n.Strings!=null&&n.Strings.length>0&&(o="xl/sharedStrings."+i,Rt(a,o,jF(n.Strings,o,n)),r.strs.push(o),_n(n.wbrels,-1,"sharedStrings."+i,Nt.SST)),o="xl/workbook."+i,Rt(a,o,LF(e,o,n)),r.workbooks.push(o),_n(n.rels,1,o,Nt.WB),o="xl/theme/theme1.xml",Rt(a,o,Df(e.Themes,n)),r.themes.push(o),_n(n.wbrels,-1,"theme/theme1.xml",Nt.THEME),o="xl/styles."+i,Rt(a,o,UF(e,o,n)),r.styles.push(o),_n(n.wbrels,-1,"styles."+i,Nt.STY),e.vbaraw&&t&&(o="xl/vbaProject.bin",Rt(a,o,e.vbaraw),r.vba.push(o),_n(n.wbrels,-1,"vbaProject.bin",Nt.VBA)),o="xl/metadata."+i,Rt(a,o,WF(o)),r.metadata.push(o),_n(n.wbrels,-1,"metadata."+i,Nt.XLMETA),Rt(a,"[Content_Types].xml",yv(r,n)),Rt(a,"_rels/.rels",Bc(n.rels)),Rt(a,"xl/_rels/workbook."+i+".rels",Bc(n.wbrels)),delete n.revssf,delete n.ssf,a}function dR(e,n){Rc=1024,e&&!e.SSF&&(e.SSF=Rn(Ct)),e&&e.SSF&&($c(),nm(e.SSF),n.revssf=rm(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Bl?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var i="xml",t=lb.indexOf(n.bookType)>-1,r=Of();zf(n=n||{});var a=lf(),o="",s=0;if(n.cellXfs=[],Go(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Rt(a,o,Sv(e.Props,n)),r.coreprops.push(o),_n(n.rels,2,o,Nt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&u.push(e.SheetNames[m]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,Rt(a,o,kv(e.Props,n)),r.extprops.push(o),_n(n.rels,3,o,Nt.EXT_PROPS),e.Custprops!==e.Props&&ii(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Rt(a,o,Ev(e.Custprops,n)),r.custprops.push(o),_n(n.rels,4,o,Nt.CUST_PROPS));var f=["SheetJ5"];for(n.tcid=0,s=1;s<=e.SheetNames.length;++s){var h={"!id":{}},_=e.Sheets[e.SheetNames[s-1]],y=(_||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+s+"."+i,Rt(a,o,vb(s-1,n,e,h)),r.sheets.push(o),_n(n.wbrels,-1,"worksheets/sheet"+s+"."+i,Nt.WS[0])}if(_){var v=_["!comments"],C=!1,P="";if(v&&v.length>0){var D=!1;v.forEach(function(T){T[1].forEach(function(I){I.T==!0&&(D=!0)})}),D&&(P="xl/threadedComments/threadedComment"+s+"."+i,Rt(a,P,xI(v,f,n)),r.threadedcomments.push(P),_n(h,-1,"../threadedComments/threadedComment"+s+"."+i,Nt.TCMNT)),P="xl/comments"+s+"."+i,Rt(a,P,cb(v,n)),r.comments.push(P),_n(h,-1,"../comments"+s+"."+i,Nt.CMNT),C=!0}_["!legacy"]&&C&&Rt(a,"xl/drawings/vmlDrawing"+s+".vml",sb(s,_["!comments"])),delete _["!comments"],delete _["!legacy"]}h["!id"].rId1&&Rt(a,Gl(o),Bc(h))}return n.Strings!=null&&n.Strings.length>0&&(o="xl/sharedStrings."+i,Rt(a,o,Xv(n.Strings,n)),r.strs.push(o),_n(n.wbrels,-1,"sharedStrings."+i,Nt.SST)),o="xl/workbook."+i,Rt(a,o,Sb(e,n)),r.workbooks.push(o),_n(n.rels,1,o,Nt.WB),o="xl/theme/theme1.xml",Rt(a,o,Df(e.Themes,n)),r.themes.push(o),_n(n.wbrels,-1,"theme/theme1.xml",Nt.THEME),o="xl/styles."+i,Rt(a,o,ib(e,n)),r.styles.push(o),_n(n.wbrels,-1,"styles."+i,Nt.STY),e.vbaraw&&t&&(o="xl/vbaProject.bin",Rt(a,o,e.vbaraw),r.vba.push(o),_n(n.wbrels,-1,"vbaProject.bin",Nt.VBA)),o="xl/metadata."+i,Rt(a,o,ob()),r.metadata.push(o),_n(n.wbrels,-1,"metadata."+i,Nt.XLMETA),f.length>1&&(o="xl/persons/person.xml",Rt(a,o,CI(f,n)),r.people.push(o),_n(n.wbrels,-1,"persons/person.xml",Nt.PEOPLE)),Rt(a,"[Content_Types].xml",yv(r,n)),Rt(a,"_rels/.rels",Bc(n.rels)),Rt(a,"xl/_rels/workbook."+i+".rels",Bc(n.wbrels)),delete n.revssf,delete n.ssf,a}function Wf(e,n){var i="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":i=jr(e.slice(0,12));break;case"binary":i=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3),i.charCodeAt(4),i.charCodeAt(5),i.charCodeAt(6),i.charCodeAt(7)]}function uR(e,n){return ft.find(e,"EncryptedPackage")?sR(e,n):Eb(e,n)}function mR(e,n){var i,t=e,r=n||{};return r.type||(r.type=$t&&Buffer.isBuffer(e)?"buffer":"base64"),i=nv(t,r),oR(i,r)}function Bb(e,n){var i=0;e:for(;i<e.length;)switch(e.charCodeAt(i)){case 10:case 13:case 32:++i;break;case 60:return Jg(e.slice(i),n);default:break e}return zc.to_workbook(e,n)}function gR(e,n){var i="",t=Wf(e,n);switch(n.type){case"base64":i=jr(e);break;case"binary":i=e;break;case"buffer":i=e.toString("binary");break;case"array":i=xs(e);break;default:throw new Error("Unrecognized type "+n.type)}return t[0]==239&&t[1]==187&&t[2]==191&&(i=yn(i)),n.type="binary",Bb(i,n)}function fR(e,n){var i=e;return n.type=="base64"&&(i=jr(i)),i=pn.utils.decode(1200,i.slice(2),"str"),n.type="binary",Bb(i,n)}function pR(e){return e.match(/[^\x00-\x7F]/)?Ra(e):e}function zg(e,n,i,t){return t?(i.type="string",zc.to_workbook(e,i)):zc.to_workbook(n,i)}function Qu(e,n){rf();var i=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Qu(new Uint8Array(e),(i=Rn(i),i.type="array",i));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!i.type&&(i.type=typeof Deno<"u"?"buffer":"array");var t=e,r=[0,0,0,0],a=!1;if(i.cellStyles&&(i.cellNF=!0,i.sheetStubs=!0),Vc={},i.dateNF&&(Vc.dateNF=i.dateNF),i.type||(i.type=$t&&Buffer.isBuffer(e)?"buffer":"base64"),i.type=="file"&&(i.type=$t?"buffer":"binary",t=lE(e),typeof Uint8Array<"u"&&!$t&&(i.type="array")),i.type=="string"&&(a=!0,i.type="binary",i.codepage=65001,t=pR(e)),i.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),s=new Uint8Array(o);if(s.foo="bar",!s.foo)return i=Rn(i),i.type="array",Qu(af(t),i)}switch((r=Wf(t,i))[0]){case 208:if(r[1]===207&&r[2]===17&&r[3]===224&&r[4]===161&&r[5]===177&&r[6]===26&&r[7]===225)return uR(ft.read(t,i),i);break;case 9:if(r[1]<=8)return Eb(t,i);break;case 60:return Jg(t,i);case 73:if(r[1]===73&&r[2]===42&&r[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(r[1]===68)return v5(t,i);break;case 84:if(r[1]===65&&r[2]===66&&r[3]===76)return Hv.to_workbook(t,i);break;case 80:return r[1]===75&&r[2]<9&&r[3]<9?mR(t,i):zg(e,t,i,a);case 239:return r[3]===60?Jg(t,i):zg(e,t,i,a);case 255:if(r[1]===254)return fR(t,i);if(r[1]===0&&r[2]===2&&r[3]===0)return fs.to_workbook(t,i);break;case 0:if(r[1]===0&&(r[2]>=2&&r[3]===0||r[2]===0&&(r[3]===8||r[3]===9)))return fs.to_workbook(t,i);break;case 3:case 131:case 139:case 140:return Zg.to_workbook(t,i);case 123:if(r[1]===92&&r[2]===114&&r[3]===116)return eb.to_workbook(t,i);break;case 10:case 13:case 32:return gR(t,i);case 137:if(r[1]===80&&r[2]===78&&r[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return C5.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?Zg.to_workbook(t,i):zg(e,t,i,a)}function Lb(e,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return e0(n.file,ft.write(e,{type:$t?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return ft.write(e,n)}function hR(e,n){var i=Rn(n||{}),t=cR(e,i);return xR(t,i)}function xR(e,n){var i={},t=$t?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(i.compression="DEFLATE"),n.password)i.type=t;else switch(n.type){case"base64":i.type="base64";break;case"binary":i.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":i.type=t;break;default:throw new Error("Unrecognized type "+n.type)}var r=e.FullPaths?ft.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[i.type]||i.type,compression:!!n.compression}):e.generate(i);if(typeof Deno<"u"&&typeof r=="string"){if(n.type=="binary"||n.type=="base64")return r;r=new Uint8Array(tm(r))}return n.password&&typeof encrypt_agile<"u"?Lb(encrypt_agile(r,n.password),n):n.type==="file"?e0(n.file,r):n.type=="string"?yn(r):r}function _R(e,n){var i=n||{},t=p9(e,i);return Lb(t,i)}function Fa(e,n,i){i||(i="");var t=i+e;switch(n.type){case"base64":return jl(Ra(t));case"binary":return Ra(t);case"string":return e;case"file":return e0(n.file,t,"utf8");case"buffer":return $t?ro(t,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(t):Fa(t,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function CR(e,n){switch(n.type){case"base64":return jl(e);case"binary":return e;case"string":return e;case"file":return e0(n.file,e,"binary");case"buffer":return $t?ro(e,"binary"):e.split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function ju(e,n){switch(n.type){case"string":case"base64":case"binary":for(var i="",t=0;t<e.length;++t)i+=String.fromCharCode(e[t]);return n.type=="base64"?jl(i):n.type=="string"?yn(i):i;case"file":return e0(n.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+n.type)}}function Yf(e,n){rf(),uF(e);var i=Rn(n||{});if(i.cellStyles&&(i.cellNF=!0,i.sheetStubs=!0),i.type=="array"){i.type="binary";var t=Yf(e,i);return i.type="array",tm(t)}var r=0;if(i.sheet&&(typeof i.sheet=="number"?r=i.sheet:r=e.SheetNames.indexOf(i.sheet),!e.SheetNames[r]))throw new Error("Sheet not found: "+i.sheet+" : "+typeof i.sheet);switch(i.bookType||"xlsb"){case"xml":case"xlml":return Fa(c9(e,i),i);case"slk":case"sylk":return Fa(Gv.from_sheet(e.Sheets[e.SheetNames[r]],i),i);case"htm":case"html":return Fa(Ib(e.Sheets[e.SheetNames[r]],i),i);case"txt":return CR(Vb(e.Sheets[e.SheetNames[r]],i),i);case"csv":return Fa($f(e.Sheets[e.SheetNames[r]],i),i,"\uFEFF");case"dif":return Fa(Hv.from_sheet(e.Sheets[e.SheetNames[r]],i),i);case"dbf":return ju(Zg.from_sheet(e.Sheets[e.SheetNames[r]],i),i);case"prn":return Fa(zc.from_sheet(e.Sheets[e.SheetNames[r]],i),i);case"rtf":return Fa(eb.from_sheet(e.Sheets[e.SheetNames[r]],i),i);case"eth":return Fa(qv.from_sheet(e.Sheets[e.SheetNames[r]],i),i);case"fods":return Fa(Rb(e,i),i);case"wk1":return ju(fs.sheet_to_wk1(e.Sheets[e.SheetNames[r]],i),i);case"wk3":return ju(fs.book_to_wk3(e,i),i);case"biff2":i.biff||(i.biff=2);case"biff3":i.biff||(i.biff=3);case"biff4":return i.biff||(i.biff=4),ju(Tb(e,i),i);case"biff5":i.biff||(i.biff=5);case"biff8":case"xla":case"xls":return i.biff||(i.biff=8),_R(e,i);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return hR(e,i);default:throw new Error("Unrecognized bookType |"+i.bookType+"|")}}function vR(e,n,i,t,r,a,o,s){var u=li(i),m=s.defval,f=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),h=!0,_=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:i,enumerable:!1})}catch{_.__rowNum__=i}else _.__rowNum__=i;if(!o||e[i])for(var y=n.s.c;y<=n.e.c;++y){var v=o?e[i][y]:e[t[y]+u];if(v===void 0||v.t===void 0){if(m===void 0)continue;a[y]!=null&&(_[a[y]]=m);continue}var C=v.v;switch(v.t){case"z":if(C==null)break;continue;case"e":C=C==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[y]!=null){if(C==null)if(v.t=="e"&&C===null)_[a[y]]=null;else if(m!==void 0)_[a[y]]=m;else if(f&&C===null)_[a[y]]=null;else continue;else _[a[y]]=f&&(v.t!=="n"||v.t==="n"&&s.rawNumbers!==!1)?C:io(v,C,s);C!=null&&(h=!1)}}return{row:_,isempty:h}}function em(e,n){if(e==null||e["!ref"]==null)return[];var i={t:"n",v:0},t=0,r=1,a=[],o=0,s="",u={s:{r:0,c:0},e:{r:0,c:0}},m=n||{},f=m.range!=null?m.range:e["!ref"];switch(m.header===1?t=1:m.header==="A"?t=2:Array.isArray(m.header)?t=3:m.header==null&&(t=0),typeof f){case"string":u=rn(f);break;case"number":u=rn(e["!ref"]),u.s.r=f;break;default:u=f}t>0&&(r=0);var h=li(u.s.r),_=[],y=[],v=0,C=0,P=Array.isArray(e),D=u.s.r,T=0,I={};P&&!e[D]&&(e[D]=[]);var K=m.skipHidden&&e["!cols"]||[],ee=m.skipHidden&&e["!rows"]||[];for(T=u.s.c;T<=u.e.c;++T)if(!(K[T]||{}).hidden)switch(_[T]=Hn(T),i=P?e[D][T]:e[_[T]+h],t){case 1:a[T]=T-u.s.c;break;case 2:a[T]=_[T];break;case 3:a[T]=m.header[T-u.s.c];break;default:if(i==null&&(i={w:"__EMPTY",t:"s"}),s=o=io(i,null,m),C=I[o]||0,!C)I[o]=1;else{do s=o+"_"+C++;while(I[s]);I[o]=C,I[s]=1}a[T]=s}for(D=u.s.r+r;D<=u.e.r;++D)if(!(ee[D]||{}).hidden){var k=vR(e,u,D,_,t,a,P,m);(k.isempty===!1||(t===1?m.blankrows!==!1:m.blankrows))&&(y[v++]=k.row)}return y.length=v,y}var LC=/"/g;function bR(e,n,i,t,r,a,o,s){for(var u=!0,m=[],f="",h=li(i),_=n.s.c;_<=n.e.c;++_)if(t[_]){var y=s.dense?(e[i]||[])[_]:e[t[_]+h];if(y==null)f="";else if(y.v!=null){u=!1,f=""+(s.rawNumbers&&y.t=="n"?y.v:io(y,null,s));for(var v=0,C=0;v!==f.length;++v)if((C=f.charCodeAt(v))===r||C===a||C===34||s.forceQuotes){f='"'+f.replace(LC,'""')+'"';break}f=="ID"&&(f='"ID"')}else y.f!=null&&!y.F?(u=!1,f="="+y.f,f.indexOf(",")>=0&&(f='"'+f.replace(LC,'""')+'"')):f="";m.push(f)}return s.blankrows===!1&&u?null:m.join(o)}function $f(e,n){var i=[],t=n==null?{}:n;if(e==null||e["!ref"]==null)return"";var r=rn(e["!ref"]),a=t.FS!==void 0?t.FS:",",o=a.charCodeAt(0),s=t.RS!==void 0?t.RS:`
`,u=s.charCodeAt(0),m=new RegExp((a=="|"?"\\|":a)+"+$"),f="",h=[];t.dense=Array.isArray(e);for(var _=t.skipHidden&&e["!cols"]||[],y=t.skipHidden&&e["!rows"]||[],v=r.s.c;v<=r.e.c;++v)(_[v]||{}).hidden||(h[v]=Hn(v));for(var C=0,P=r.s.r;P<=r.e.r;++P)(y[P]||{}).hidden||(f=bR(e,r,P,h,o,u,a,t),f!=null&&(t.strip&&(f=f.replace(m,"")),(f||t.blankrows!==!1)&&i.push((C++?s:"")+f)));return delete t.dense,i.join("")}function Vb(e,n){n||(n={}),n.FS="	",n.RS=`
`;var i=$f(e,n);if(typeof pn>"u"||n.type=="string")return i;var t=pn.utils.encode(1200,i,"str");return"\xFF\xFE"+t}function yR(e){var n="",i,t="";if(e==null||e["!ref"]==null)return[];var r=rn(e["!ref"]),a="",o=[],s,u=[],m=Array.isArray(e);for(s=r.s.c;s<=r.e.c;++s)o[s]=Hn(s);for(var f=r.s.r;f<=r.e.r;++f)for(a=li(f),s=r.s.c;s<=r.e.c;++s)if(n=o[s]+a,i=m?(e[f]||[])[s]:e[n],t="",i!==void 0){if(i.F!=null){if(n=i.F,!i.f)continue;t=i.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(i.f!=null)t=i.f;else{if(i.t=="z")continue;if(i.t=="n"&&i.v!=null)t=""+i.v;else if(i.t=="b")t=i.v?"TRUE":"FALSE";else if(i.w!==void 0)t="'"+i.w;else{if(i.v===void 0)continue;i.t=="s"?t="'"+i.v:t=""+i.v}}u[u.length]=n+"="+t}return u}function Ub(e,n,i){var t=i||{},r=+!t.skipHeader,a=e||{},o=0,s=0;if(a&&t.origin!=null)if(typeof t.origin=="number")o=t.origin;else{var u=typeof t.origin=="string"?qn(t.origin):t.origin;o=u.r,s=u.c}var m,f={s:{c:0,r:0},e:{c:s,r:o+n.length-1+r}};if(a["!ref"]){var h=rn(a["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),o==-1&&(o=h.e.r+1,f.e.r=o+n.length-1+r)}else o==-1&&(o=0,f.e.r=n.length-1+r);var _=t.header||[],y=0;n.forEach(function(C,P){ii(C).forEach(function(D){(y=_.indexOf(D))==-1&&(_[y=_.length]=D);var T=C[D],I="z",K="",ee=vt({c:s+y,r:o+P+r});m=Ql(a,ee),T&&typeof T=="object"&&!(T instanceof Date)?a[ee]=T:(typeof T=="number"?I="n":typeof T=="boolean"?I="b":typeof T=="string"?I="s":T instanceof Date?(I="d",t.cellDates||(I="n",T=wi(T)),K=t.dateNF||Ct[14]):T===null&&t.nullError&&(I="e",T=0),m?(m.t=I,m.v=T,delete m.w,delete m.R,K&&(m.z=K)):a[ee]=m={t:I,v:T},K&&(m.z=K))})}),f.e.c=Math.max(f.e.c,s+_.length-1);var v=li(o);if(r)for(y=0;y<_.length;++y)a[Hn(y+s)+v]={t:"s",v:_[y]};return a["!ref"]=Ft(f),a}function MR(e,n){return Ub(null,e,n)}function Ql(e,n,i){if(typeof n=="string"){if(Array.isArray(e)){var t=qn(n);return e[t.r]||(e[t.r]=[]),e[t.r][t.c]||(e[t.r][t.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Ql(e,vt(n)):Ql(e,vt({r:n,c:i||0}))}function wR(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var i=e.SheetNames.indexOf(n);if(i>-1)return i;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Gf(){return{SheetNames:[],Sheets:{}}}function Hf(e,n,i,t){var r=1;if(!i)for(;r<=65535&&e.SheetNames.indexOf(i="Sheet"+r)!=-1;++r,i=void 0);if(!i||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(t&&e.SheetNames.indexOf(i)>=0){var a=i.match(/(^.*?)(\d+)$/);r=a&&+a[2]||0;var o=a&&a[1]||i;for(++r;r<=65535&&e.SheetNames.indexOf(i=o+r)!=-1;++r);}if(wb(i),e.SheetNames.indexOf(i)>=0)throw new Error("Worksheet with name |"+i+"| already exists!");return e.SheetNames.push(i),e.Sheets[i]=n,i}function SR(e,n,i){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var t=wR(e,n);switch(e.Workbook.Sheets[t]||(e.Workbook.Sheets[t]={}),i){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+i)}e.Workbook.Sheets[t].Hidden=i}function PR(e,n){return e.z=n,e}function jb(e,n,i){return n?(e.l={Target:n},i&&(e.l.Tooltip=i)):delete e.l,e}function OR(e,n,i){return jb(e,"#"+n,i)}function kR(e,n,i){e.c||(e.c=[]),e.c.push({t:n,a:i||"SheetJS"})}function ER(e,n,i,t){for(var r=typeof n!="string"?n:rn(n),a=typeof n=="string"?n:Ft(n),o=r.s.r;o<=r.e.r;++o)for(var s=r.s.c;s<=r.e.c;++s){var u=Ql(e,o,s);u.t="n",u.F=a,delete u.v,o==r.s.r&&s==r.s.c&&(u.f=i,t&&(u.D=!0))}return e}var Ho={encode_col:Hn,encode_row:li,encode_cell:vt,encode_range:Ft,decode_col:bf,decode_row:vf,split_cell:jE,decode_cell:qn,decode_range:Er,format_cell:io,sheet_add_aoa:pv,sheet_add_json:Ub,sheet_add_dom:Ab,aoa_to_sheet:Hc,json_to_sheet:MR,table_to_sheet:Db,table_to_book:B9,sheet_to_csv:$f,sheet_to_txt:Vb,sheet_to_json:em,sheet_to_html:Ib,sheet_to_formulae:yR,sheet_to_row_object_array:em,sheet_get_cell:Ql,book_new:Gf,book_append_sheet:Hf,book_set_sheet_visibility:SR,cell_set_number_format:PR,cell_set_hyperlink:jb,cell_set_internal_link:OR,cell_add_comment:kR,sheet_set_array_formula:ER,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var d$=Ul.version;var AR=["fileUploadContainer"],DR=(e,n)=>n.accountId,FR=(e,n)=>n._idx,RR=(e,n)=>n.id;function NR(e,n){if(e&1&&(c(0,"mat-option",18),d(1),l()),e&2){let i=n.$implicit;w("value",i.accountId),p(),jt(" ",i.name," (",i.type,") ")}}function BR(e,n){if(e&1){let i=be();c(0,"div",13)(1,"div",14)(2,"div",15)(3,"label",16),d(4,"Default Account"),l(),c(5,"mat-select",17),gt("valueChange",function(r){G(i);let a=S();return mt(a.defaultAccountId,r)||(a.defaultAccountId=r),H(r)}),Ge(6,NR,2,3,"mat-option",18,DR),l()()()()}if(e&2){let i=S();p(5),ut("value",i.defaultAccountId),p(),He(i.accounts)}}function LR(e,n){if(e&1){let i=be();c(0,"div",19)(1,"button",20),N("click",function(){G(i);let r=S();return H(r.downloadTemplate())}),c(2,"mat-icon"),d(3,"download"),l(),d(4," Download Excel Template "),l()()}}function VR(e,n){if(e&1&&(c(0,"div",30)(1,"mat-icon",31),d(2,"file_present"),l(),d(3),l()),e&2){let i=S(2);p(3),jt(" ",i.selectedFile.name," (",i.fileType,") ")}}function UR(e,n){if(e&1&&(c(0,"div",32)(1,"mat-icon",33),d(2,"error"),l(),c(3,"span",34),d(4),l()()),e&2){let i=S(2);p(4),z(i.error)}}function jR(e,n){if(e&1){let i=be();c(0,"div",21)(1,"div",22,0)(3,"input",23),N("change",function(r){G(i);let a=S();return H(a.onFileSelected(r))}),l(),c(4,"div",24)(5,"mat-icon",25),d(6,"cloud_upload"),l(),c(7,"p",26),d(8),l(),c(9,"p",27),d(10,"Supports Excel (XLSX, XLS) files only"),l(),X(11,VR,4,2,"div",28),l()(),X(12,UR,5,1,"div",29),l()}if(e&2){let i=S();p(),Je("drag-over",i.isDragOver),p(2),w("disabled",i.isLoading),p(5),oe(" ",i.isLoading?"Processing...":"Click to select file or drag and drop"," "),p(3),w("ngIf",i.selectedFile),p(),w("ngIf",i.error)}}function zR(e,n){e&1&&(c(0,"div",35),se(1,"mat-spinner",36),c(2,"p",37),d(3,"Processing file..."),l()())}function WR(e,n){e&1&&(c(0,"div",49)(1,"div",50)(2,"mat-icon",51),d(3,"info"),l(),c(4,"span",52),d(5," Data imported from Google Sheets. Review and select the transactions you want to import into your account. "),l()()())}function YR(e,n){if(e&1&&(c(0,"mat-option",18)(1,"div",61)(2,"span",62),d(3),l()()()),e&2){let i=n.$implicit;w("value",i.id+"-"+i.name),p(3),z(i.name)}}function $R(e,n){if(e&1){let i=be();c(0,"tr",48)(1,"td",46)(2,"mat-checkbox",53),N("change",function(){let r=G(i).$implicit,a=S(2);return H(a.toggleSelect(r._idx))}),l()(),c(3,"td",54)(4,"span"),d(5),pe(6,"number"),l()(),c(7,"td",55),d(8),l(),c(9,"td",56)(10,"span",57),d(11),l()(),c(12,"td",58)(13,"mat-select",59),N("selectionChange",function(r){let a=G(i).$implicit,o=S(2);return H(o.updateCategory(a._idx,r.value))}),c(14,"mat-option",60)(15,"div",61)(16,"span",62),d(17),l()()(),Ge(18,YR,4,2,"mat-option",18,RR),pe(20,"async"),l()(),c(21,"td",63),d(22),pe(23,"date"),l()()}if(e&2){let i=n.$implicit,t=S(2);p(2),w("checked",t.selectedToImport.has(i._idx)),p(2),Je("income",i.type==="income")("expense",i.type==="expense"),p(),jt(" ",i.type==="income"?"+":"-","\u20B9",yt(6,17,i.amount,"1.2-2")," "),p(3),z(i.description),p(2),Je("income",i.type==="income")("expense",i.type==="expense"),p(),oe(" ",i.type," "),p(2),w("value",i.categoryId+"-"+i.category),p(),w("value",i.categoryId+"-"+i.category),p(3),z("Existing - "+i.category),p(),He(Ee(20,20,t.categories$)),p(4),z(yt(23,22,i.date,"dd MMM yyyy"))}}function GR(e,n){if(e&1){let i=be();c(0,"div",38),X(1,WR,6,0,"div",39),c(2,"div",40)(3,"h3",41),d(4),l(),c(5,"div",42)(6,"button",43),N("click",function(){G(i);let r=S();return H(r.toggleSelectAll())}),d(7),l(),c(8,"span",26),d(9),l()()(),c(10,"div",44)(11,"table",45)(12,"thead")(13,"tr")(14,"th",46)(15,"mat-checkbox",47),N("change",function(){G(i);let r=S();return H(r.toggleSelectAll())}),l()(),c(16,"th"),d(17,"Amount"),l(),c(18,"th"),d(19,"Description"),l(),c(20,"th"),d(21,"Type"),l(),c(22,"th"),d(23,"Category"),l(),c(24,"th"),d(25,"Date"),l()()(),c(26,"tbody"),Ge(27,$R,24,25,"tr",48,FR),l()()()()}if(e&2){let i=S();p(),w("ngIf",i.data==null?null:i.data.transactions),p(3),oe(" ",i.data.transactions?"Google Sheets Data Preview":"Preview & Select Transactions"," "),p(3),oe(" ",i.selectedToImport.size===i.parsedTransactions.length?"Deselect All":"Select All"," "),p(2),jt(" ",i.selectedToImport.size," of ",i.parsedTransactions.length," selected "),p(6),w("checked",i.selectedToImport.size===i.parsedTransactions.length)("indeterminate",i.selectedToImport.size>0&&i.selectedToImport.size<i.parsedTransactions.length),p(12),He(i.parsedTransactions)}}var Xc=(()=>{let n=class n{constructor(t,r,a,o,s,u){this.dialogRef=t,this.data=r,this.notificationService=a,this.auth=o,this.store=s,this.ssrService=u,this.selectedFile=null,this.parsedTransactions=[],this.selectedToImport=new Set,this.error="",this.isLoading=!1,this.isDragOver=!1,this.fileType="",this.accounts=[],this.categories$=lt([]),this.defaultAccountId="",this.setupDragAndDrop(),this.loadAccountsAndCategories(),r&&r.transactions&&Array.isArray(r.transactions)&&(this.parsedTransactions=r.transactions,this.selectedToImport=new Set(this.parsedTransactions.map(m=>m._idx)),this.notificationService.success(`Loaded ${this.parsedTransactions.length} transactions from Google Sheets`))}ngAfterViewInit(){}ngOnDestroy(){}loadAccountsAndCategories(){return ue(this,null,function*(){var r;if((r=this.auth.currentUser)!=null&&r.uid)try{this.store.select(wa).subscribe(a=>{this.accounts=a,a.length>0&&(this.defaultAccountId=a[0].accountId)}),this.categories$=this.store.select(Ri)}catch(a){console.error("Error loading accounts and categories:",a)}})}updateCategory(t,r){let a=this.parsedTransactions.findIndex(o=>o._idx===t);a!==-1&&(this.parsedTransactions[a].categoryId=r.split("-")[0],this.parsedTransactions[a].category=r.split("-")[1])}setupDragAndDrop(){var r;let t=(r=this.fileUploadContainer)==null?void 0:r.nativeElement;t&&(t.addEventListener("dragover",a=>{a.preventDefault(),a.stopPropagation(),this.isDragOver=!0}),t.addEventListener("dragleave",a=>{a.preventDefault(),a.stopPropagation(),this.isDragOver=!1}),t.addEventListener("drop",a=>{var s;a.preventDefault(),a.stopPropagation(),this.isDragOver=!1;let o=(s=a.dataTransfer)==null?void 0:s.files;o&&o.length>0&&this.handleFile(o[0])}))}onFileSelected(t){let r=t.target.files[0];r&&this.handleFile(r)}handleFile(t){if(!t){this.notificationService.warning("Please select a file");return}let r=[".xlsx",".xls"],a=t.name.toLowerCase().substring(t.name.lastIndexOf("."));if(!r.includes(a)){this.notificationService.error("Please select an Excel file (XLSX or XLS)");return}this.selectedFile=t,this.fileType=a.toUpperCase(),this.error="",this.isLoading=!0,this.notificationService.info(`Processing ${this.fileType} file...`),this.parseExcelFile(t)}parseExcelFile(t){let r=new FileReader;r.onload=a=>{try{let o=new Uint8Array(a.target.result),s=Qu(o,{type:"array"});if(s.SheetNames.length===0){this.isLoading=!1,this.error="Excel file contains no sheets.",this.notificationService.error("No sheets found in Excel file");return}let u=s.SheetNames[0],m=s.Sheets[u],f=Ho.sheet_to_json(m,{header:1});if(f.length<2){this.isLoading=!1,this.error="Excel file is empty or has no data rows.",this.notificationService.error("No data found in Excel file");return}let h=f[0],_=f.slice(1);if(!h||h.length===0){this.isLoading=!1,this.error="Excel file must have a header row.",this.notificationService.error("Invalid Excel format - missing headers");return}let y=Ho.sheet_to_json(m,{defval:"",raw:!0});if(y.length===0){this.isLoading=!1,this.error="No valid data rows found in Excel file.",this.notificationService.error("No valid data in Excel file");return}this.isLoading=!1,this.processParsedData(y),this.notificationService.success(`Successfully parsed ${this.parsedTransactions.length} transactions from Excel file`)}catch(o){this.isLoading=!1,this.error="Error parsing Excel file. Please check the format.",this.notificationService.error("Failed to parse Excel file"),console.error("Excel parsing error:",o)}},r.onerror=()=>{this.isLoading=!1,this.error="Error reading Excel file.",this.notificationService.error("Failed to read Excel file")},r.readAsArrayBuffer(t)}processParsedData(t){if(!t||t.length===0){this.error="No valid data found in the file.",this.notificationService.error("No transactions found in the file");return}if(this.parseStandardFormat(t),this.parsedTransactions.length===0){this.error="No valid transactions found in the file.",this.notificationService.error("No valid transactions found");return}this.selectedToImport=new Set(this.parsedTransactions.map(r=>r._idx))}parseStandardFormat(t){this.parsedTransactions=t.map((r,a)=>({_idx:a,type:(r.type||r.Type||r.TYPE||"expense").toLowerCase(),category:r.category||r.Category||r.CATEGORY||"Other",date:r.date||r.Date||r.DATE||new Date().toISOString().split("T")[0],description:r.description||r.Description||r.DESCRIPTION||r.payee||r.Payee||r.PAYEE||"",amount:parseFloat(r.amount||r.Amount||r.AMOUNT||"0")}))}toggleSelect(t){this.selectedToImport.has(t)?this.selectedToImport.delete(t):this.selectedToImport.add(t)}toggleSelectAll(){this.selectedToImport.size===this.parsedTransactions.length?this.selectedToImport.clear():this.selectedToImport=new Set(this.parsedTransactions.map(t=>t._idx))}downloadTemplate(){try{if(this.ssrService.isClientSide()){let t=[["Payee","Amount","Type","Category","Date","Notes"],["Salary Payment",5e4,"income","Salary","2024-01-15","Monthly salary"]],r=Ho.aoa_to_sheet(t);r["!cols"]=[{width:20},{width:12},{width:10},{width:18},{width:12},{width:25}];let a=Ho.book_new();Ho.book_append_sheet(a,r,"Transactions");let o=[["Transaction Import Template - Instructions"],[""],["Column Descriptions:"],["Payee","Name of the person, merchant, or company"],["Amount","Transaction amount (positive number)"],["Type",'Must be either "income" or "expense"'],["Category","Transaction category (e.g., Salary, Food & Dining, etc.)"],["Date","Transaction date in YYYY-MM-DD format"],["Notes","Optional description or notes"],[""],["Important Notes:"],["- Keep the header row as is (Row 1)"],["- Use YYYY-MM-DD format for dates"],["- Delete sample row (Row 2) before adding your data"]],s=Ho.aoa_to_sheet(o);s["!cols"]=[{width:60}],Ho.book_append_sheet(a,s,"Instructions");let u=Yf(a,{bookType:"xlsx",type:"array"}),m=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),f=window.URL.createObjectURL(m),h=document.createElement("a");h.href=f,h.download="transaction_import_template.xlsx",h.click(),window.URL.revokeObjectURL(f),this.notificationService.success("Excel template downloaded successfully")}}catch(t){console.error("Error downloading template:",t),this.notificationService.error("Failed to download template")}}importSelected(){let t=this.parsedTransactions.filter(o=>this.selectedToImport.has(o._idx));if(t.length===0){this.notificationService.warning("Please select at least one transaction to import");return}let r=t.filter(o=>!o.description||!o.description.trim()?(this.notificationService.warning(`Transaction ${o._idx+1}: Description is required`),!1):!o.amount||o.amount<=0?(this.notificationService.warning(`Transaction ${o._idx+1}: Amount must be greater than 0`),!1):!o.type||!["income","expense"].includes(o.type)?(this.notificationService.warning(`Transaction ${o._idx+1}: Invalid transaction type`),!1):!o.category||!o.category.trim()?(this.notificationService.warning(`Transaction ${o._idx+1}: Category is required`),!1):o.date?!0:(this.notificationService.warning(`Transaction ${o._idx+1}: Date is required`),!1));if(r.length===0){this.notificationService.error("No valid transactions to import");return}r.length<t.length&&this.notificationService.warning(`${t.length-r.length} transactions were skipped due to validation errors`);let a=r.map(o=>le(ae({},o),{accountId:this.defaultAccountId||"default",categoryId:o.categoryId||"default",category:o.category||"default"}));this.notificationService.success(`Importing ${r.length} transactions`),this.dialogRef.close(a)}close(){this.dialogRef.close()}};n.\u0275fac=function(r){return new(r||n)(q(fi),q(pi),q(ht),q(pt),q(wt),q(Pr))},n.\u0275cmp=Ve({type:n,selectors:[["import-transactions"]],viewQuery:function(r,a){if(r&1&&Ir(AR,5),r&2){let o;Ar(o=Dr())&&(a.fileUploadContainer=o.first)}},decls:18,vars:11,consts:[["fileUploadContainer",""],[1,"import-dialog"],["mat-dialog-title","",1,"text-lg","font-semibold","mb-4"],[1,"mr-2"],["mat-dialog-content","",1,"max-h-[70vh]","overflow-y-auto"],["class","mb-6 p-4 bg-gray-50 rounded-lg",4,"ngIf"],["class","mb-2 flex justify-end",4,"ngIf"],["class","mb-6",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","transactions-preview",4,"ngIf"],["mat-dialog-actions","","align","end",1,"dialog-actions"],["mat-button","",1,"mr-2",3,"click"],["mat-raised-button","","color","primary",1,"import-button",3,"click","disabled"],[1,"mb-6","p-4","bg-gray-50","rounded-lg"],[1,"flex","flex-col","sm:flex-row","gap-4"],[1,"flex-1"],[1,"block","text-sm","font-medium","text-gray-600","mb-1"],["placeholder","Select account for imported transactions",1,"w-full",3,"valueChange","value"],[3,"value"],[1,"mb-2","flex","justify-end"],["mat-stroked-button","","color","primary",1,"w-full","sm:w-auto",3,"click"],[1,"mb-6"],[1,"file-upload-container"],["type","file","accept",".xlsx,.xls",1,"file-input",3,"change","disabled"],[1,"file-upload-overlay"],[1,"text-4xl","mb-2"],[1,"text-sm","text-gray-600"],[1,"text-xs","text-gray-500","mt-1"],["class","mt-2 p-2 bg-blue-50 rounded text-xs text-blue-700",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"mt-2","p-2","bg-blue-50","rounded","text-xs","text-blue-700"],[1,"text-sm","mr-1"],[1,"error-message"],[1,"text-red-500"],[1,"text-red-600","text-sm"],[1,"loading-container"],["diameter","40"],[1,"mt-2","text-gray-600"],[1,"transactions-preview"],["class","mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",4,"ngIf"],[1,"preview-header"],[1,"font-semibold","mb-2"],[1,"preview-actions"],["mat-button","","color","primary",1,"text-sm",3,"click"],[1,"table-container"],[1,"transactions-table"],[1,"checkbox-col"],[3,"change","checked","indeterminate"],[1,"transaction-row"],[1,"mb-4","p-3","bg-blue-50","border","border-blue-200","rounded-lg"],[1,"flex","items-center","gap-2"],[1,"text-blue-600","text-sm"],[1,"text-sm","text-blue-800"],[3,"change","checked"],[1,"amount-cell"],[1,"payee-cell"],[1,"type-cell"],[1,"type-badge"],[1,"category-cell"],[1,"category-select",3,"selectionChange","value"],[1,"keep-original-option",3,"value"],[1,"option-content"],[1,"option-text"],[1,"date-cell"]],template:function(r,a){r&1&&(c(0,"div",1)(1,"h2",2)(2,"mat-icon",3),d(3),l(),d(4),l(),c(5,"div",4),X(6,BR,8,1,"div",5)(7,LR,5,0,"div",6)(8,jR,13,6,"div",7)(9,zR,4,0,"div",8)(10,GR,29,7,"div",9),l(),c(11,"div",10)(12,"button",11),N("click",function(){return a.close()}),d(13,"Cancel"),l(),c(14,"button",12),N("click",function(){return a.importSelected()}),c(15,"mat-icon"),d(16),l(),d(17),l()()()),r&2&&(p(3),z(a.data.transactions?"table_chart":"upload_file"),p(),oe(" ",a.data.transactions?"Import from Google Sheets":"Import Transactions"," "),p(2),w("ngIf",a.accounts.length>0),p(),w("ngIf",!(a.data!=null&&a.data.transactions)),p(),w("ngIf",!(a.data!=null&&a.data.transactions)),p(),w("ngIf",a.isLoading&&!(a.data!=null&&a.data.transactions)),p(),w("ngIf",a.parsedTransactions.length&&!a.isLoading),p(4),w("disabled",!a.parsedTransactions.length||a.selectedToImport.size===0),p(2),z(a.data.transactions?"table_chart":"cloud_upload"),p(),jt(" ",a.data.transactions?"Import from Sheets":"Import Selected"," (",a.selectedToImport.size,") "))},dependencies:[ct,Ht,at,Xr,Ni,Fi,Pd,kd,Od,Td,go,Ys,Vn],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-width:350px}.import-dialog[_ngcontent-%COMP%]{padding:.5rem}.import-header[_ngcontent-%COMP%]{margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid #e5e7eb}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem}@media (max-width: 640px){.header-content[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:1rem}}.title-section[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem;flex:1}.title-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:1.75rem;width:1.75rem;height:1.75rem;margin-top:.125rem}@media (max-width: 640px){.title-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem}}.title-text[_ngcontent-%COMP%]{flex:1}.dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:700;color:#111827;line-height:1.2}@media (max-width: 640px){.dialog-title[_ngcontent-%COMP%]{font-size:1.25rem}}.dialog-subtitle[_ngcontent-%COMP%]{margin:.25rem 0 0;font-size:.875rem;color:#6b7280;line-height:1.4}@media (max-width: 640px){.dialog-subtitle[_ngcontent-%COMP%]{font-size:.8rem}}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center}@media (max-width: 640px){.header-actions[_ngcontent-%COMP%]{justify-content:stretch}}.download-template-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.625rem 1rem;border-radius:8px;font-weight:500;transition:all .2s ease;border:2px solid #3b82f6;background:transparent;color:#3b82f6}.download-template-btn[_ngcontent-%COMP%]:hover{background:#3b82f6;color:#fff;transform:translateY(-1px);box-shadow:0 4px 12px #3b82f64d}.download-template-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}@media (max-width: 640px){.download-template-btn[_ngcontent-%COMP%]{width:100%;justify-content:center;padding:.75rem 1rem}}.btn-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.btn-text[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500}@media (max-width: 640px){.btn-text[_ngcontent-%COMP%]{font-size:.9rem}}.file-upload-container[_ngcontent-%COMP%]{position:relative;border:2px dashed #d1d5db;border-radius:8px;padding:2rem;text-align:center;transition:all .3s ease;background:#f9fafb;cursor:pointer}.file-upload-container[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#f0f9ff}.file-upload-container.drag-over[_ngcontent-%COMP%]{border-color:#3b82f6;background:#dbeafe}.file-input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer;z-index:2}.file-upload-overlay[_ngcontent-%COMP%]{pointer-events:none;z-index:1}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-top:.5rem;padding:.75rem;background:#fef2f2;border:1px solid #fecaca;border-radius:6px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem 1rem;text-align:center}.transactions-preview[_ngcontent-%COMP%]{margin-top:1.5rem}.preview-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;flex-wrap:wrap;gap:.5rem}@media (max-width: 640px){.preview-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}.preview-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}@media (max-width: 640px){.preview-actions[_ngcontent-%COMP%]{width:100%;justify-content:space-between}}.table-container[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:8px;overflow:hidden;background:#fff;overflow-x:auto}.transactions-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.875rem;min-width:600px}.transactions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .transactions-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;text-align:left;border-bottom:1px solid #f3f4f6}.transactions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f9fafb;font-weight:600;color:#374151;position:sticky;top:0;z-index:10}.transactions-table[_ngcontent-%COMP%]   .checkbox-col[_ngcontent-%COMP%]{width:48px;text-align:center}.transactions-table[_ngcontent-%COMP%]   .payee-cell[_ngcontent-%COMP%]{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.transactions-table[_ngcontent-%COMP%]   .amount-cell[_ngcontent-%COMP%]{font-weight:600;text-align:right}.transactions-table[_ngcontent-%COMP%]   .amount-cell[_ngcontent-%COMP%]   .income[_ngcontent-%COMP%]{color:#059669}.transactions-table[_ngcontent-%COMP%]   .amount-cell[_ngcontent-%COMP%]   .expense[_ngcontent-%COMP%]{color:#dc2626}.transactions-table[_ngcontent-%COMP%]   .type-cell[_ngcontent-%COMP%]{text-align:center}.transactions-table[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:12px;font-size:.75rem;font-weight:500;text-transform:capitalize}.transactions-table[_ngcontent-%COMP%]   .type-badge.income[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.transactions-table[_ngcontent-%COMP%]   .type-badge.expense[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.transactions-table[_ngcontent-%COMP%]   .category-cell[_ngcontent-%COMP%]{max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.transactions-table[_ngcontent-%COMP%]   .category-select[_ngcontent-%COMP%]{width:100%;font-size:.75rem}.transactions-table[_ngcontent-%COMP%]   .category-select[_ngcontent-%COMP%]     .mat-mdc-select-trigger{height:auto;min-height:32px;padding:.25rem .5rem;background:#f8fafc;border:1px solid transparent;border-radius:4px;transition:all .2s ease}.transactions-table[_ngcontent-%COMP%]   .category-select[_ngcontent-%COMP%]     .mat-mdc-select-trigger:hover{background:#e2e8f0;border-color:#cbd5e1}.transactions-table[_ngcontent-%COMP%]   .category-select[_ngcontent-%COMP%]     .mat-mdc-select-value{color:#374151;font-size:.75rem}.transactions-table[_ngcontent-%COMP%]   .category-select[_ngcontent-%COMP%]     .mat-mdc-select-arrow{color:#6b7280}.transactions-table[_ngcontent-%COMP%]   .option-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%}.transactions-table[_ngcontent-%COMP%]   .option-text[_ngcontent-%COMP%]{font-size:.75rem;color:#374151;flex:1}.transactions-table[_ngcontent-%COMP%]   .option-badge[_ngcontent-%COMP%]{font-size:.625rem;padding:.125rem .375rem;border-radius:8px;font-weight:500;margin-left:.5rem;text-transform:capitalize}.transactions-table[_ngcontent-%COMP%]   .option-badge.original[_ngcontent-%COMP%]{background:#fbbf24;color:#92400e}.transactions-table[_ngcontent-%COMP%]   .option-badge.income[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.transactions-table[_ngcontent-%COMP%]   .option-badge.expense[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.transactions-table[_ngcontent-%COMP%]   .no-categories-text[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-style:italic}.transactions-table[_ngcontent-%COMP%]     .keep-original-option{background:#fef3c7}.transactions-table[_ngcontent-%COMP%]     .keep-original-option:hover{background:#fde68a!important}.transactions-table[_ngcontent-%COMP%]     .keep-original-option.mat-mdc-option-active{background:#fde68a!important}.transactions-table[_ngcontent-%COMP%]   .date-cell[_ngcontent-%COMP%]{text-align:center;white-space:nowrap}.transactions-table[_ngcontent-%COMP%]   .transaction-row[_ngcontent-%COMP%]{transition:background-color .2s ease}.transactions-table[_ngcontent-%COMP%]   .transaction-row[_ngcontent-%COMP%]:hover{background:#f9fafb}.dialog-actions[_ngcontent-%COMP%]{padding:1rem 0 0;border-top:1px solid #e5e7eb;margin-top:1rem}@media (max-width: 640px){.dialog-actions[_ngcontent-%COMP%]{flex-direction:column-reverse;gap:.5rem}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}@media (max-width: 640px){.import-button[_ngcontent-%COMP%]{margin-bottom:.5rem}}@media (max-width: 768px){.transactions-table[_ngcontent-%COMP%]{font-size:.75rem}.transactions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .transactions-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem}.transactions-table[_ngcontent-%COMP%]   .payee-cell[_ngcontent-%COMP%]{max-width:120px}.transactions-table[_ngcontent-%COMP%]   .category-cell[_ngcontent-%COMP%]{max-width:80px}.file-upload-container[_ngcontent-%COMP%]{padding:1.5rem}}@media (max-width: 480px){.transactions-table[_ngcontent-%COMP%]{font-size:.7rem}.transactions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .transactions-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.375rem}.transactions-table[_ngcontent-%COMP%]   .payee-cell[_ngcontent-%COMP%]{max-width:100px}.transactions-table[_ngcontent-%COMP%]   .category-cell[_ngcontent-%COMP%]{max-width:60px}.file-upload-container[_ngcontent-%COMP%]{padding:1rem}.preview-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem}}"]});let e=n;return e})();var Va=Tr(Nr());var Wb=(e,n)=>n.month,qf=(e,n)=>n.category,qR=(e,n)=>n.period,XR=(e,n)=>n.account,zb=(e,n)=>n.name,KR=(e,n)=>n.id;function ZR(e,n){e&1&&(c(0,"div",11)(1,"div",12)(2,"div",13),se(3,"div",14),l(),c(4,"h3",15),d(5,"Loading Financial Data"),l(),c(6,"p",16),d(7,"Please wait while we prepare your reports..."),l()()())}function JR(e,n){e&1&&(c(0,"mat-icon",113),d(1,"check"),l())}function QR(e,n){if(e&1){let i=be();c(0,"button",67),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.onChartTypeChange(r))}),c(1,"mat-icon",68),d(2),l(),c(3,"span",68),d(4),l(),X(5,JR,2,0,"mat-icon",113),l()}if(e&2){let i=n.$implicit,t=S(2);Je("bg-blue-50",t.selectedChartType===i),p(2),z(i==="pie"?"pie_chart":i==="bar"?"bar_chart":i==="line"?"show_chart":i==="area"?"area_chart":i==="radar"?"radar":i==="funnel"?"filter_alt":i==="scatter"?"scatter_plot":"grid_on"),p(2),z(i.charAt(0).toUpperCase()+i.slice(1)),p(),ot(t.selectedChartType===i?5:-1)}}function eN(e,n){e&1&&(c(0,"mat-icon",114),d(1,"check"),l())}function tN(e,n){if(e&1){let i=be();c(0,"button",67),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.onAnalyticsViewChange(r))}),c(1,"mat-icon",68),d(2),l(),c(3,"span",68),d(4),l(),X(5,eN,2,0,"mat-icon",114),l()}if(e&2){let i=n.$implicit,t=S(2);Je("bg-green-50",t.selectedAnalyticsView===i),p(2),z(i==="overview"?"dashboard":i==="trends"?"trending_up":i==="categories"?"category":i==="accounts"?"account_balance":i==="comparison"?"compare":"timeline"),p(2),z(i.charAt(0).toUpperCase()+i.slice(1)),p(),ot(t.selectedAnalyticsView===i?5:-1)}}function nN(e,n){if(e&1&&(c(0,"div",117)(1,"span",118),d(2),l(),c(3,"span",119),d(4),l()()),e&2){let i=n.$implicit;p(2),z(i.category),p(),w("ngClass",i.change>=0?"text-red-600":"text-green-600"),p(),jt(" ",i.change>=0?"+":"","",i.percentage.toFixed(1),"% ")}}function iN(e,n){if(e&1&&(c(0,"div",82)(1,"h4",115)(2,"mat-icon",116),d(3,"category"),l(),d(4," Category Trends "),l(),Ge(5,nN,5,4,"div",117,qf),l()),e&2){let i=S(2);p(5),He(i.categoryTrends.slice(0,3))}}function rN(e,n){if(e&1&&(c(0,"div",117)(1,"span",118),d(2),l(),c(3,"span",120),d(4),l()()),e&2){let i=n.$implicit,t=S(3);p(2),z(i.period),p(2),z(t.formatCurrency(i.amount))}}function aN(e,n){if(e&1&&(c(0,"div",82)(1,"h4",115)(2,"mat-icon",116),d(3,"trending_up"),l(),d(4," Spending Trends "),l(),Ge(5,rN,5,2,"div",117,qR),l()),e&2){let i=S(2);p(5),He(i.spendingTrends.slice(0,3))}}function oN(e,n){if(e&1&&(c(0,"div",117)(1,"span",118),d(2),l(),c(3,"span",120),d(4),l()()),e&2){let i=n.$implicit,t=S(3);p(2),z(i.account),p(2),z(t.formatCurrency(i.balance))}}function sN(e,n){if(e&1&&(c(0,"div",82)(1,"h4",115)(2,"mat-icon",116),d(3,"account_balance"),l(),d(4," Account Balances "),l(),Ge(5,oN,5,2,"div",117,XR),l()),e&2){let i=S(2);p(5),He(i.accountBalances.slice(0,3))}}function cN(e,n){if(e&1&&(c(0,"mat-option",136),d(1),l()),e&2){let i=n.$implicit;w("value",i.name),p(),z(i.name)}}function lN(e,n){if(e&1&&(c(0,"mat-option",136),d(1),l()),e&2){let i=n.$implicit;w("value",i.name),p(),z(i.name)}}function dN(e,n){if(e&1){let i=be();c(0,"div",121)(1,"div",122)(2,"div",123)(3,"div",124)(4,"mat-icon",81),d(5,"filter_list"),l()(),c(6,"div")(7,"h3",125),d(8,"Quick Filters"),l(),c(9,"p",126),d(10,"Filter your financial data"),l()()(),c(11,"button",127),N("click",function(){G(i);let r=S(2);return H(r.toggleQuickFilters())}),c(12,"mat-icon"),d(13,"expand_less"),l()()(),c(14,"div",128)(15,"div")(16,"label",129),d(17,"Date Range"),l(),c(18,"mat-form-field",130)(19,"mat-select")(20,"mat-option",131),d(21,"Last 7 days"),l(),c(22,"mat-option",132),d(23,"Last 30 days"),l(),c(24,"mat-option",133),d(25,"Last 3 months"),l(),c(26,"mat-option",134),d(27,"Last year"),l()()()(),c(28,"div")(29,"label",129),d(30,"Category"),l(),c(31,"mat-form-field",130)(32,"mat-select")(33,"mat-option",135),d(34,"All Categories"),l(),Ge(35,cN,2,2,"mat-option",136,zb),l()()(),c(37,"div")(38,"label",129),d(39,"Account"),l(),c(40,"mat-form-field",130)(41,"mat-select")(42,"mat-option",135),d(43,"All Accounts"),l(),Ge(44,lN,2,2,"mat-option",136,zb),l()()(),c(46,"div")(47,"label",129),d(48,"Transaction Type"),l(),c(49,"mat-form-field",130)(50,"mat-select")(51,"mat-option",135),d(52,"All Types"),l(),c(53,"mat-option",137),d(54,"Income"),l(),c(55,"mat-option",138),d(56,"Expense"),l()()()()(),c(57,"div",139)(58,"button",140),N("click",function(){G(i);let r=S(2);return H(r.toggleQuickFilters())}),d(59," Cancel "),l(),c(60,"button",141),N("click",function(){G(i);let r=S(2);return H(r.applyFilters())}),d(61," Apply Filters "),l()()()}if(e&2){let i=S(2);p(35),He(i.categories),p(9),He(i.accounts)}}function uN(e,n){if(e&1){let i=be();c(0,"div",142)(1,"button",143),N("click",function(){G(i);let r=S(2);return H(r.toggleQuickFilters())}),c(2,"mat-icon"),d(3,"filter_list"),l(),c(4,"span"),d(5,"Show Filters"),l()()()}}function mN(e,n){if(e&1&&(c(0,"div",128)(1,"div",144)(2,"div",20)(3,"div",21)(4,"p",145),d(5,"Avg Daily Spending"),l(),c(6,"p",146),d(7),l()(),c(8,"div",104)(9,"mat-icon",147),d(10,"schedule"),l()()()(),c(11,"div",148)(12,"div",20)(13,"div",21)(14,"p",149),d(15,"Avg Monthly Spending"),l(),c(16,"p",150),d(17),l()(),c(18,"div",151)(19,"mat-icon",152),d(20,"calendar_month"),l()()()(),c(21,"div",153)(22,"div",20)(23,"div",21)(24,"p",154),d(25,"Savings Rate"),l(),c(26,"p",155),d(27),l()(),c(28,"div",156)(29,"mat-icon",157),d(30,"trending_up"),l()()()(),c(31,"div",158)(32,"div",20)(33,"div",21)(34,"p",159),d(35,"Expense Growth"),l(),c(36,"p",160),d(37),l()(),c(38,"div",161)(39,"mat-icon",162),d(40,"analytics"),l()()()()()),e&2){let i=S(2);p(7),z(i.formatCurrency(i.averageDailySpending)),p(10),z(i.formatCurrency(i.averageMonthlySpending)),p(10),oe("",i.savingsRate.toFixed(1),"%"),p(9),w("ngClass",i.expenseGrowthRate>=0?"text-rose-600":"text-green-600"),p(),jt(" ",i.expenseGrowthRate>=0?"+":"","",i.expenseGrowthRate.toFixed(1),"% ")}}function gN(e,n){if(e&1&&(c(0,"div",91)(1,"span",94),d(2),l(),c(3,"span",163),d(4),l()()),e&2){let i=n.$implicit,t=S(2);p(2),z(i.month),p(2),z(t.formatCurrency(i.savings))}}function fN(e,n){if(e&1&&(c(0,"div",164)(1,"div",92)(2,"div",165)(3,"mat-icon",68),d(4),l()(),c(5,"div",166)(6,"span",167),d(7),l(),c(8,"div",168),d(9),l()()(),c(10,"span",163),d(11),l()()),e&2){let i=n.$implicit,t=S(3);p(3),Xt("color",i.color),p(),z(i.icon),p(3),z(i.category),p(2),oe("",i.percentage.toFixed(1),"% of total"),p(2),z(t.formatCurrency(i.amount))}}function pN(e,n){if(e&1&&(c(0,"div",82),Ge(1,fN,12,6,"div",164,qf),l()),e&2){let i=S(2);p(),He(i.topCategories)}}function hN(e,n){e&1&&(c(0,"div",169)(1,"div",170)(2,"mat-icon",171),d(3,"bar_chart"),l()(),c(4,"h4",172),d(5,"No Data Available"),l(),c(6,"p",173),d(7,"Add transactions to see category breakdown"),l()())}function xN(e,n){if(e&1&&(c(0,"div",164)(1,"div",92)(2,"mat-icon",174),d(3),l(),c(4,"div",166)(5,"span",167),d(6),l(),c(7,"div",175),d(8),l()()(),c(9,"div",176)(10,"span",177),d(11),l(),c(12,"div",168),d(13),pe(14,"date"),l()()()),e&2){let i=n.$implicit,t=S(3);p(2),w("ngClass",t.getTransactionColor(i)),p(),z(t.getTransactionIcon(i)),p(3),z(i.payee),p(2),z(i.category),p(2),w("ngClass",t.getTransactionColor(i)),p(),jt(" ",i.type==="income"?"+":"-","",t.formatCurrency(i.amount)," "),p(2),oe(" ",yt(14,8,t.dateService.toDate(i.date),"MMM dd")," ")}}function _N(e,n){if(e&1&&(c(0,"div",82),Ge(1,xN,15,11,"div",164,KR),l()),e&2){let i=S(2);p(),He(i.recentTransactions)}}function CN(e,n){e&1&&(c(0,"div",169)(1,"div",170)(2,"mat-icon",171),d(3,"receipt_long"),l()(),c(4,"h4",172),d(5,"No Recent Transactions"),l(),c(6,"p",173),d(7,"Your recent activity will appear here"),l()())}function vN(e,n){if(e&1){let i=be();c(0,"div",121)(1,"div",122)(2,"div",123)(3,"div",178)(4,"mat-icon",77),d(5,"file_download"),l()(),c(6,"div")(7,"h3",125),d(8,"Export Options"),l(),c(9,"p",126),d(10,"Export your financial reports"),l()()(),c(11,"button",127),N("click",function(){G(i);let r=S(2);return H(r.toggleExportOptions())}),c(12,"mat-icon"),d(13,"expand_less"),l()()(),c(14,"div",128)(15,"div")(16,"label",129),d(17,"Export Format"),l(),c(18,"mat-form-field",130)(19,"mat-select",179),gt("ngModelChange",function(r){G(i);let a=S(2);return mt(a.userPreferences.exportFormat,r)||(a.userPreferences.exportFormat=r),H(r)}),c(20,"mat-option",180),d(21,"PDF Report"),l(),c(22,"mat-option",181),d(23,"Excel Spreadsheet"),l(),c(24,"mat-option",182),d(25,"CSV Data"),l(),c(26,"mat-option",183),d(27,"JSON Data"),l()()()(),c(28,"div")(29,"label",129),d(30,"Date Range"),l(),c(31,"mat-form-field",130)(32,"mat-select")(33,"mat-option",184),d(34,"Current Month"),l(),c(35,"mat-option",185),d(36,"Last 3 Months"),l(),c(37,"mat-option",186),d(38,"Last 6 Months"),l(),c(39,"mat-option",187),d(40,"Last 12 Months"),l(),c(41,"mat-option",188),d(42,"Custom Range"),l()()()(),c(43,"div")(44,"label",129),d(45,"Include Charts"),l(),c(46,"mat-slide-toggle",189),d(47,"Include Visualizations"),l()(),c(48,"div",190)(49,"button",191),N("click",function(){G(i);let r=S(2);return H(r.exportReport())}),c(50,"mat-icon",192),d(51,"download"),l(),d(52," Export Report "),l()()(),c(53,"div",139)(54,"button",140),N("click",function(){G(i);let r=S(2);return H(r.toggleExportOptions())}),d(55," Cancel "),l(),c(56,"button",193),N("click",function(){G(i);let r=S(2);return H(r.generateReport())}),c(57,"mat-icon",192),d(58,"description"),l(),d(59," Generate Report "),l()()()}if(e&2){let i=S(2);p(19),ut("ngModel",i.userPreferences.exportFormat)}}function bN(e,n){if(e&1){let i=be();c(0,"div",142)(1,"button",143),N("click",function(){G(i);let r=S(2);return H(r.toggleExportOptions())}),c(2,"mat-icon"),d(3,"file_download"),l(),c(4,"span"),d(5,"Export Options"),l()()()}}function yN(e,n){if(e&1&&(c(0,"div",198)(1,"div",200),d(2),l(),c(3,"div",201),d(4),l(),c(5,"div",202),d(6),l(),c(7,"div",203),d(8),l()()),e&2){let i=n.$implicit,t=S(3);p(2),z(i.month),p(2),z(t.formatCurrency(i.income)),p(2),z(t.formatCurrency(i.expenses)),p(2),jt(" ",i.savings>=0?"+":"","",t.formatCurrency(i.savings)," ")}}function MN(e,n){if(e&1&&(c(0,"div",20)(1,"div",92)(2,"div",204)(3,"mat-icon",205),d(4),l()(),c(5,"span",94),d(6),l()(),c(7,"div",206)(8,"div",207),se(9,"div",208),l(),c(10,"span",209),d(11),l()()()),e&2){let i=n.$implicit,t=S(4);p(3),Xt("color",i.color),p(),z(i.icon),p(2),z(i.category),p(3),Xt("width",i.percentage,"%"),p(2),oe(" ",t.formatCurrency(i.amount)," ")}}function wN(e,n){if(e&1&&(c(0,"div",195)(1,"h4",196),d(2,"Category Breakdown"),l(),c(3,"div",82),Ge(4,MN,12,7,"div",20,qf),l()()),e&2){let i=S(3);p(4),He(i.topCategories)}}function SN(e,n){if(e&1&&(c(0,"div",194)(1,"div",195)(2,"h4",196),d(3,"Monthly Trends"),l(),c(4,"div",197),Ge(5,yN,9,5,"div",198,Wb),l()(),X(7,wN,6,0,"div",199),l()),e&2){let i=S(2);p(5),He(i.monthlyTrends),p(2),w("ngIf",i.topCategories.length>0)}}function PN(e,n){if(e&1){let i=be();c(0,"div",210)(1,"div",211)(2,"mat-icon",212),d(3,"analytics"),l()(),c(4,"h4",213),d(5,"No Data Available"),l(),c(6,"p",214),d(7," Start adding transactions to see detailed reports and insights about your financial patterns. "),l(),c(8,"button",215),N("click",function(){G(i);let r=S(2);return H(r.addTransaction())}),c(9,"mat-icon"),d(10,"add"),l(),c(11,"span"),d(12,"Add Transaction"),l()()()}}function ON(e,n){if(e&1){let i=be();c(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20)(4,"div",21)(5,"p",22),d(6,"Total Income"),l(),c(7,"p",23),d(8),l(),c(9,"p",24),d(10,"This period"),l()(),c(11,"div",25)(12,"mat-icon",26),d(13,"trending_up"),l()()()(),c(14,"div",27)(15,"div",20)(16,"div",21)(17,"p",28),d(18,"Total Expenses"),l(),c(19,"p",29),d(20),l(),c(21,"p",30),d(22,"This period"),l()(),c(23,"div",31)(24,"mat-icon",32),d(25,"trending_down"),l()()()(),c(26,"div",33)(27,"div",20)(28,"div",21)(29,"p",34),d(30,"Net Savings"),l(),c(31,"p",35),d(32),l(),c(33,"p",36),d(34,"This period"),l()(),c(35,"div",37)(36,"mat-icon",38),d(37,"account_balance_wallet"),l()()()(),c(38,"div",39)(39,"div",20)(40,"div",21)(41,"p",40),d(42,"Monthly Change"),l(),c(43,"p",41),d(44),l(),c(45,"p",42),d(46,"vs last month"),l()(),c(47,"div",43)(48,"mat-icon",44),d(49),l()()()()(),c(50,"div",45)(51,"div",46)(52,"div",47)(53,"div",21)(54,"h2",48),d(55),l(),c(56,"p",49),d(57,"Interactive financial visualization"),l()(),c(58,"div",50)(59,"mat-button-toggle-group",51),N("change",function(r){G(i);let a=S();return H(a.onPeriodChange(r.value))}),c(60,"mat-button-toggle",52),d(61,"D"),l(),c(62,"mat-button-toggle",53),d(63,"W"),l(),c(64,"mat-button-toggle",54),d(65,"M"),l(),c(66,"mat-button-toggle",55),d(67,"Y"),l()(),c(68,"button",56)(69,"mat-icon"),d(70),l()(),c(71,"mat-menu",57,0)(73,"div",58)(74,"div",59),d(75,"Chart Type"),l(),Ge(76,QR,6,5,"button",60,Oi),l()(),c(78,"button",61)(79,"mat-icon"),d(80,"analytics"),l()(),c(81,"mat-menu",62,1)(83,"div",58)(84,"div",59),d(85,"Analytics View"),l(),Ge(86,tN,6,5,"button",63,Oi),l()(),c(88,"button",64),N("click",function(){G(i);let r=S();return H(r.toggleAdvancedAnalytics())}),c(89,"mat-icon"),d(90),l()(),c(91,"button",65)(92,"mat-icon"),d(93,"more_vert"),l()(),c(94,"mat-menu",66,2)(96,"button",67),N("click",function(){G(i);let r=S();return H(r.openPreferencesDialog())}),c(97,"mat-icon",68),d(98,"settings"),l(),c(99,"span",68),d(100,"Preferences"),l()(),c(101,"button",69),N("click",function(){G(i);let r=S();return H(r.refreshData())}),c(102,"mat-icon",68),d(103,"refresh"),l(),c(104,"span",68),d(105),l()(),c(106,"button",67),N("click",function(){G(i);let r=S();return H(r.toggleHelpTooltip())}),c(107,"mat-icon",68),d(108,"help_outline"),l(),c(109,"span",68),d(110,"Help"),l()(),se(111,"mat-divider"),c(112,"button",67),N("click",function(){G(i);let r=S();return H(r.toggleQuickFilters())}),c(113,"mat-icon",68),d(114,"filter_list"),l(),c(115,"span",68),d(116),l()(),c(117,"button",67),N("click",function(){G(i);let r=S();return H(r.toggleExportOptions())}),c(118,"mat-icon",68),d(119,"file_download"),l(),c(120,"span",68),d(121),l()()()()()(),c(122,"div",70)(123,"div",71),se(124,"div",72),l()()(),c(125,"div",73)(126,"div",74)(127,"mat-card",75)(128,"div",70)(129,"div",76)(130,"div",21)(131,"h3",48),d(132,"Analytics Summary"),l(),c(133,"p",49),d(134,"Key insights and trends"),l()(),c(135,"div",25)(136,"mat-icon",77),d(137,"insights"),l()()(),c(138,"div",78),X(139,iN,7,0,"div",79)(140,aN,7,0,"div",79)(141,sN,7,0,"div",79),l()()()(),c(142,"div",80)(143,"mat-card",75)(144,"div",70)(145,"div",76)(146,"div",21)(147,"h3",48),d(148,"Quick Actions"),l(),c(149,"p",49),d(150,"Common tasks"),l()(),c(151,"div",37)(152,"mat-icon",81),d(153,"bolt"),l()()(),c(154,"div",82)(155,"button",83),N("click",function(){G(i);let r=S();return H(r.addTransaction())}),c(156,"mat-icon",84),d(157,"add"),l(),d(158," Add Transaction "),l(),c(159,"button",83),N("click",function(){G(i);let r=S();return H(r.exportReport())}),c(160,"mat-icon",84),d(161,"file_download"),l(),d(162," Export Report "),l(),c(163,"button",85),N("click",function(){G(i);let r=S();return H(r.refreshData())}),c(164,"mat-icon",84),d(165,"refresh"),l(),d(166),l(),c(167,"button",83),N("click",function(){G(i);let r=S();return H(r.toggleQuickFilters())}),c(168,"mat-icon",84),d(169,"filter_list"),l(),d(170),l(),c(171,"button",83),N("click",function(){G(i);let r=S();return H(r.openPreferencesDialog())}),c(172,"mat-icon",84),d(173,"settings"),l(),d(174," Preferences "),l()()()()()(),X(175,dN,62,0,"div",86)(176,uN,6,0,"div",87)(177,mN,41,6,"div",88),c(178,"div",89)(179,"mat-card",45)(180,"div",70)(181,"div",76)(182,"div",21)(183,"h3",48),d(184,"Spending Overview"),l(),c(185,"p",49),d(186,"Your financial summary"),l()(),c(187,"div",37)(188,"mat-icon",81),d(189,"pie_chart"),l()()(),c(190,"div",90)(191,"div",91)(192,"div",92),se(193,"div",93),c(194,"span",94),d(195,"Total Income"),l()(),c(196,"span",95),d(197),l()(),c(198,"div",91)(199,"div",92),se(200,"div",96),c(201,"span",94),d(202,"Total Expenses"),l()(),c(203,"span",97),d(204),l()(),c(205,"div",91)(206,"div",92),se(207,"div",98),c(208,"span",94),d(209,"Net Savings"),l()(),c(210,"span",99),d(211),l()()()()(),c(212,"mat-card",45)(213,"div",70)(214,"div",76)(215,"div",21)(216,"h3",48),d(217,"Monthly Trends"),l(),c(218,"p",49),d(219,"Compare monthly performance"),l()(),c(220,"div",25)(221,"mat-icon",77),d(222,"trending_up"),l()()(),c(223,"div",90),Ge(224,gN,5,2,"div",91,Wb),c(226,"div",100)(227,"span",101),d(228,"Change"),l(),c(229,"span",95),d(230),l()()()()(),c(231,"mat-card",45)(232,"div",70)(233,"div",76)(234,"div",21)(235,"h3",48),d(236,"Top Spending Categories"),l(),c(237,"p",49),d(238,"Your highest expense areas"),l()(),c(239,"div",43)(240,"mat-icon",102),d(241,"category"),l()()(),X(242,pN,3,0,"div",79)(243,hN,8,0,"div",103),l()(),c(244,"mat-card",45)(245,"div",70)(246,"div",76)(247,"div",21)(248,"h3",48),d(249,"Recent Activity"),l(),c(250,"p",49),d(251,"Latest transactions"),l()(),c(252,"div",104)(253,"mat-icon",105),d(254,"schedule"),l()()(),X(255,_N,3,0,"div",79)(256,CN,8,0,"div",103),l()()(),X(257,vN,60,1,"div",86)(258,bN,6,0,"div",87),c(259,"mat-card",45)(260,"div",70)(261,"div",106)(262,"div",21)(263,"h3",107),d(264,"Detailed Analysis"),l(),c(265,"p",49),d(266,"Deep dive into your financial data"),l()(),c(267,"div",108)(268,"button",109),N("click",function(){G(i);let r=S();return H(r.onPeriodChange("daily"))}),d(269," Daily "),l(),c(270,"button",109),N("click",function(){G(i);let r=S();return H(r.onPeriodChange("weekly"))}),d(271," Weekly "),l(),c(272,"button",110),N("click",function(){G(i);let r=S();return H(r.onPeriodChange("monthly"))}),d(273," Monthly "),l(),c(274,"button",109),N("click",function(){G(i);let r=S();return H(r.onPeriodChange("yearly"))}),d(275," Yearly "),l()()(),X(276,SN,8,1,"div",111)(277,PN,13,0,"div",112),l()()()}if(e&2){let i=Gn(72),t=Gn(82),r=Gn(95),a=S();p(8),z(a.formatCurrency(a.totalIncome)),p(12),z(a.formatCurrency(a.totalExpenses)),p(12),z(a.formatCurrency(a.netSavings)),p(11),w("ngClass",a.getMonthlyChangeColor()),p(),oe(" ",a.getMonthlyChangeDisplay()," "),p(4),w("ngClass",a.getMonthlyChangeColor()),p(),z(a.getMonthlyChangeIcon()),p(6),z(a.getChartTitle()),p(4),w("value",a.selectedPeriod),p(9),w("matMenuTriggerFor",i),p(2),z(a.selectedChartType==="pie"?"pie_chart":a.selectedChartType==="bar"?"bar_chart":a.selectedChartType==="line"?"show_chart":a.selectedChartType==="area"?"area_chart":a.selectedChartType==="radar"?"radar":a.selectedChartType==="funnel"?"filter_alt":a.selectedChartType==="scatter"?"scatter_plot":"grid_on"),p(6),He(a.availableChartTypes),p(2),w("matMenuTriggerFor",t),p(8),He(a.availableAnalyticsViews),p(2),Je("text-purple-600",a.showAdvancedAnalytics)("text-gray-600",!a.showAdvancedAnalytics),w("matTooltip",a.showAdvancedAnalytics?"Switch to Basic":"Switch to Advanced"),p(2),z(a.showAdvancedAnalytics?"visibility_off":"visibility"),p(),w("matMenuTriggerFor",r),p(10),w("disabled",a.isRefreshing),p(),Je("animate-spin",a.isRefreshing),p(3),z(a.isRefreshing?"Refreshing...":"Refresh Data"),p(11),oe("",a.showQuickFilters?"Hide":"Show"," Filters"),p(5),oe("",a.showExportOptions?"Hide":"Show"," Export"),p(2),w("ngClass",a.getChartHeight()),p(),w("options",a.getCurrentChartOption()),p(15),w("ngIf",a.categoryTrends.length>0),p(),w("ngIf",a.spendingTrends.length>0),p(),w("ngIf",a.accountBalances.length>0),p(22),w("disabled",a.isRefreshing),p(),Je("animate-spin",a.isRefreshing),p(2),oe(" ",a.isRefreshing?"Refreshing...":"Refresh Data"," "),p(4),oe(" ",a.showQuickFilters?"Hide":"Show"," Filters "),p(5),w("ngIf",a.showQuickFilters),p(),w("ngIf",!a.showQuickFilters),p(),w("ngIf",a.showAdvancedAnalytics),p(20),z(a.formatCurrency(a.totalIncome)),p(7),z(a.formatCurrency(a.totalExpenses)),p(7),z(a.formatCurrency(a.netSavings)),p(13),He(a.monthlyTrends.slice(-2)),p(6),z(a.getMonthlyChangeDisplay()),p(12),w("ngIf",a.topCategories.length>0),p(),w("ngIf",a.topCategories.length===0),p(12),w("ngIf",a.recentTransactions.length>0),p(),w("ngIf",a.recentTransactions.length===0),p(),w("ngIf",a.showExportOptions),p(),w("ngIf",!a.showExportOptions),p(10),Je("bg-blue-50",a.selectedPeriod==="daily"),p(2),Je("bg-blue-50",a.selectedPeriod==="weekly"),p(2),Je("bg-blue-600",a.selectedPeriod==="monthly"),p(2),Je("bg-blue-50",a.selectedPeriod==="yearly"),p(2),w("ngIf",a.hasData),p(),w("ngIf",!a.hasData)}}function kN(e,n){if(e&1&&(c(0,"mat-option",136),d(1),l()),e&2){let i=n.$implicit;w("value",i),p(),oe(" ",i.charAt(0).toUpperCase()+i.slice(1)," ")}}function EN(e,n){if(e&1&&(c(0,"mat-option",136),d(1),l()),e&2){let i=n.$implicit;w("value",i),p(),oe(" ",i.charAt(0).toUpperCase()+i.slice(1)," ")}}function TN(e,n){if(e&1){let i=be();c(0,"div")(1,"label",129),d(2,"Email Frequency"),l(),c(3,"mat-form-field",130)(4,"mat-select",179),gt("ngModelChange",function(r){G(i);let a=S(2);return mt(a.userPreferences.emailFrequency,r)||(a.userPreferences.emailFrequency=r),H(r)}),c(5,"mat-option",224),d(6,"Daily"),l(),c(7,"mat-option",225),d(8,"Weekly"),l(),c(9,"mat-option",226),d(10,"Monthly"),l(),c(11,"mat-option",243),d(12,"Never"),l()()()()}if(e&2){let i=S(2);p(4),ut("ngModel",i.userPreferences.emailFrequency)}}function IN(e,n){if(e&1){let i=be();c(0,"div",216)(1,"div",217)(2,"div",218)(3,"div",20)(4,"h2",219),d(5,"Analytics Preferences"),l(),c(6,"button",220),N("click",function(){G(i);let r=S();return H(r.closePreferencesDialog())}),c(7,"mat-icon"),d(8,"close"),l()()(),c(9,"p",221),d(10,"Customize your analytics dashboard experience"),l()(),c(11,"div",222)(12,"div",223)(13,"div")(14,"h3",196),d(15,"Default Settings"),l(),c(16,"div",78)(17,"div")(18,"label",129),d(19,"Default Chart Type"),l(),c(20,"mat-form-field",130)(21,"mat-select",179),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.defaultChartType,r)||(a.userPreferences.defaultChartType=r),H(r)}),Ge(22,kN,2,2,"mat-option",136,Oi),l()()(),c(24,"div")(25,"label",129),d(26,"Default Analytics View"),l(),c(27,"mat-form-field",130)(28,"mat-select",179),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.defaultAnalyticsView,r)||(a.userPreferences.defaultAnalyticsView=r),H(r)}),Ge(29,EN,2,2,"mat-option",136,Oi),l()()(),c(31,"div")(32,"label",129),d(33,"Default Period"),l(),c(34,"mat-form-field",130)(35,"mat-select",179),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.defaultPeriod,r)||(a.userPreferences.defaultPeriod=r),H(r)}),c(36,"mat-option",224),d(37,"Daily"),l(),c(38,"mat-option",225),d(39,"Weekly"),l(),c(40,"mat-option",226),d(41,"Monthly"),l(),c(42,"mat-option",227),d(43,"Yearly"),l()()()()()(),c(44,"div")(45,"h3",196),d(46,"Display Options"),l(),c(47,"div",78)(48,"div")(49,"label",129),d(50,"Chart Height"),l(),c(51,"mat-form-field",130)(52,"mat-select",179),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.chartHeight,r)||(a.userPreferences.chartHeight=r),H(r)}),c(53,"mat-option",228),d(54,"Small"),l(),c(55,"mat-option",229),d(56,"Medium"),l(),c(57,"mat-option",230),d(58,"Large"),l()()()(),c(59,"div")(60,"label",129),d(61,"Currency Format"),l(),c(62,"mat-form-field",130)(63,"mat-select",179),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.currencyFormat,r)||(a.userPreferences.currencyFormat=r),H(r)}),c(64,"mat-option",231),d(65,"Indian Rupee (\u20B9)"),l(),c(66,"mat-option",232),d(67,"US Dollar ($)"),l(),c(68,"mat-option",233),d(69,"Euro (\u20AC)"),l()()()(),c(70,"div")(71,"label",129),d(72,"Date Format"),l(),c(73,"mat-form-field",130)(74,"mat-select",179),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.dateFormat,r)||(a.userPreferences.dateFormat=r),H(r)}),c(75,"mat-option",234),d(76,"DD/MM/YYYY"),l(),c(77,"mat-option",235),d(78,"MM/DD/YYYY"),l(),c(79,"mat-option",236),d(80,"YYYY-MM-DD"),l()()()()()()(),c(81,"div")(82,"h3",196),d(83,"Chart Options"),l(),c(84,"div",223)(85,"div",78)(86,"mat-slide-toggle",237),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.showTooltips,r)||(a.userPreferences.showTooltips=r),H(r)}),d(87," Show Tooltips "),l(),c(88,"mat-slide-toggle",237),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.showAnimations,r)||(a.userPreferences.showAnimations=r),H(r)}),d(89," Show Animations "),l(),c(90,"mat-slide-toggle",237),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.showAdvancedAnalytics,r)||(a.userPreferences.showAdvancedAnalytics=r),H(r)}),d(91," Show Advanced Analytics "),l()(),c(92,"div",78)(93,"div")(94,"label",129),d(95,"Refresh Interval (minutes)"),l(),c(96,"mat-form-field",130)(97,"input",238),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.refreshInterval,r)||(a.userPreferences.refreshInterval=r),H(r)}),l()()(),c(98,"div")(99,"label",129),d(100,"Export Format"),l(),c(101,"mat-form-field",130)(102,"mat-select",179),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.exportFormat,r)||(a.userPreferences.exportFormat=r),H(r)}),c(103,"mat-option",180),d(104,"PDF"),l(),c(105,"mat-option",181),d(106,"Excel"),l(),c(107,"mat-option",182),d(108,"CSV"),l(),c(109,"mat-option",183),d(110,"JSON"),l()()()()()()(),c(111,"div")(112,"h3",196),d(113,"Email Reports"),l(),c(114,"div",223)(115,"mat-slide-toggle",237),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.userPreferences.emailReports,r)||(a.userPreferences.emailReports=r),H(r)}),d(116," Enable Email Reports "),l(),X(117,TN,13,1,"div",239),l()()(),c(118,"div",240)(119,"button",241),N("click",function(){G(i);let r=S();return H(r.resetPreferences())}),d(120," Reset to Default "),l(),c(121,"div",242)(122,"button",140),N("click",function(){G(i);let r=S();return H(r.closePreferencesDialog())}),d(123," Cancel "),l(),c(124,"button",141),N("click",function(){G(i);let r=S();return r.savePreferences(),H(r.closePreferencesDialog())}),d(125," Save Preferences "),l()()()()()}if(e&2){let i=S();p(21),ut("ngModel",i.userPreferences.defaultChartType),p(),He(i.availableChartTypes),p(6),ut("ngModel",i.userPreferences.defaultAnalyticsView),p(),He(i.availableAnalyticsViews),p(6),ut("ngModel",i.userPreferences.defaultPeriod),p(17),ut("ngModel",i.userPreferences.chartHeight),p(11),ut("ngModel",i.userPreferences.currencyFormat),p(11),ut("ngModel",i.userPreferences.dateFormat),p(12),ut("ngModel",i.userPreferences.showTooltips),p(2),ut("ngModel",i.userPreferences.showAnimations),p(2),ut("ngModel",i.userPreferences.showAdvancedAnalytics),p(7),ut("ngModel",i.userPreferences.refreshInterval),p(5),ut("ngModel",i.userPreferences.exportFormat),p(13),ut("ngModel",i.userPreferences.emailReports),p(2),w("ngIf",i.userPreferences.emailReports)}}function AN(e,n){if(e&1){let i=be();c(0,"div",216)(1,"div",244)(2,"div",218)(3,"div",20)(4,"h2",219),d(5,"Analytics Help"),l(),c(6,"button",220),N("click",function(){G(i);let r=S();return H(r.toggleHelpTooltip())}),c(7,"mat-icon"),d(8,"close"),l()()()(),c(9,"div",245)(10,"div")(11,"h3",15),d(12,"Chart Types"),l(),c(13,"div",246)(14,"p")(15,"strong"),d(16,"Pie Chart:"),l(),d(17," Shows spending breakdown by category"),l(),c(18,"p")(19,"strong"),d(20,"Bar Chart:"),l(),d(21," Displays monthly financial trends"),l(),c(22,"p")(23,"strong"),d(24,"Line Chart:"),l(),d(25," Shows trends over time with smooth curves"),l(),c(26,"p")(27,"strong"),d(28,"Area Chart:"),l(),d(29," Displays daily spending patterns"),l(),c(30,"p")(31,"strong"),d(32,"Radar Chart:"),l(),d(33," Compares category performance"),l(),c(34,"p")(35,"strong"),d(36,"Funnel Chart:"),l(),d(37," Shows spending funnel analysis"),l(),c(38,"p")(39,"strong"),d(40,"Scatter Chart:"),l(),d(41," Shows income vs expenses correlation"),l(),c(42,"p")(43,"strong"),d(44,"Heatmap:"),l(),d(45," Displays weekly spending patterns"),l()()(),c(46,"div")(47,"h3",15),d(48,"Analytics Views"),l(),c(49,"div",246)(50,"p")(51,"strong"),d(52,"Overview:"),l(),d(53," General financial summary"),l(),c(54,"p")(55,"strong"),d(56,"Trends:"),l(),d(57," Historical data analysis"),l(),c(58,"p")(59,"strong"),d(60,"Categories:"),l(),d(61," Category-wise breakdown"),l(),c(62,"p")(63,"strong"),d(64,"Accounts:"),l(),d(65," Account-specific data"),l(),c(66,"p")(67,"strong"),d(68,"Comparison:"),l(),d(69," Period-over-period analysis"),l(),c(70,"p")(71,"strong"),d(72,"Forecast:"),l(),d(73," Future predictions"),l()()(),c(74,"div")(75,"h3",15),d(76,"Tips"),l(),c(77,"div",246)(78,"p"),d(79,"\u2022 Use different chart types to view data from various perspectives"),l(),c(80,"p"),d(81,"\u2022 Switch between time periods to analyze trends"),l(),c(82,"p"),d(83,"\u2022 Enable advanced analytics for detailed insights"),l(),c(84,"p"),d(85,"\u2022 Customize preferences to match your workflow"),l(),c(86,"p"),d(87,"\u2022 Export reports for sharing or offline analysis"),l()()()(),c(88,"div",247)(89,"button",191),N("click",function(){G(i);let r=S();return H(r.toggleHelpTooltip())}),d(90," Got it! "),l()()()()}}function DN(e,n){if(e&1){let i=be();c(0,"div",8)(1,"button",248),N("click",function(){G(i);let r=S();return H(r.addTransaction())}),c(2,"mat-icon"),d(3,"receipt"),l()(),c(4,"button",249),N("click",function(){G(i);let r=S();return H(r.exportReport())}),c(5,"mat-icon"),d(6,"file_download"),l()(),c(7,"button",250),N("click",function(){G(i);let r=S();return H(r.refreshData())}),c(8,"mat-icon"),d(9,"refresh"),l()()()}}var um=(()=>{let n=class n{constructor(t,r,a,o,s,u){this.router=t,this.auth=r,this.notificationService=a,this.store=o,this.dateService=s,this.ssrService=u,this.totalIncome=0,this.totalExpenses=0,this.netSavings=0,this.monthlyChange=0,this.monthlyChangePercentage=0,this.transactions=[],this.accounts=[],this.categories=[],this.topCategories=[],this.recentTransactions=[],this.monthlyTrends=[],this.dailyData=[],this.weeklyData=[],this.yearlyData=[],this.accountBalances=[],this.spendingTrends=[],this.categoryTrends=[],this.averageDailySpending=0,this.averageMonthlySpending=0,this.savingsRate=0,this.expenseGrowthRate=0,this.incomeGrowthRate=0,this.selectedPeriod="monthly",this.selectedChartType="pie",this.selectedAnalyticsView="overview",this.showAdvancedAnalytics=!1,this.availableChartTypes=["pie","bar","line","area","radar","funnel","scatter","heatmap"],this.availableAnalyticsViews=["overview","trends","categories","accounts","comparison","forecast"],this.isLoading=!0,this.hasData=!1,this.pieChartOption={},this.barChartOption={},this.lineChartOption={},this.areaChartOption={},this.radarChartOption={},this.funnelChartOption={},this.scatterChartOption={},this.heatmapChartOption={},this.isDarkMode=!1,this.userPreferences={defaultChartType:"pie",defaultAnalyticsView:"overview",defaultPeriod:"monthly",showAdvancedAnalytics:!1,chartHeight:"medium",refreshInterval:5,currencyFormat:"INR",dateFormat:"DD/MM/YYYY",theme:"auto",showTooltips:!0,showAnimations:!0,exportFormat:"pdf",emailReports:!1,emailFrequency:"never"},this.showPreferencesDialog=!1,this.showQuickFilters=!1,this.showExportOptions=!1,this.showHelpTooltip=!1,this.showQuickActions=!1,this.isRefreshing=!1,this.subscriptions=[],this.transactions$=this.store.select(An),this.accounts$=this.store.select(wa),this.categories$=this.store.select(Ri),this.transactionsLoading$=this.store.select(Su),this.accountsLoading$=this.store.select(Ed),this.categoriesLoading$=this.store.select(Id)}ngOnInit(){this.loadPreferences(),this.detectTheme(),this.loadData()}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}loadData(){if(!this.auth.currentUser){this.isLoading=!1,this.notificationService.error("User not authenticated");return}let r=this.transactions$.subscribe(s=>{this.transactions=s,this.calculateFinancialMetrics(),this.calculateTopCategories(),this.getRecentTransactions(),this.calculateMonthlyTrends(),this.calculateEnhancedAnalytics(),this.updateCharts(),this.isLoading=!1,this.hasData=this.transactions.length>0}),a=this.accounts$.subscribe(s=>{this.accounts=s}),o=this.categories$.subscribe(s=>{this.categories=s});this.subscriptions.push(r,a,o)}calculateFinancialMetrics(){let t=new Date,r=t.getMonth(),a=t.getFullYear(),o=r===0?11:r-1,s=r===0?a-1:a,u=this.transactions.filter(y=>{let v=this.dateService.toDate(y.date);return(v==null?void 0:v.getMonth())===r&&(v==null?void 0:v.getFullYear())===a}),m=this.transactions.filter(y=>{let v=this.dateService.toDate(y.date);return(v==null?void 0:v.getMonth())===o&&(v==null?void 0:v.getFullYear())===s});this.totalIncome=u.filter(y=>y.type==="income").reduce((y,v)=>y+v.amount,0),this.totalExpenses=u.filter(y=>y.type==="expense").reduce((y,v)=>y+v.amount,0),this.netSavings=this.totalIncome-this.totalExpenses;let f=m.filter(y=>y.type==="income").reduce((y,v)=>y+v.amount,0),h=m.filter(y=>y.type==="expense").reduce((y,v)=>y+v.amount,0),_=f-h;this.monthlyChange=this.netSavings-_,this.monthlyChangePercentage=_!==0?this.monthlyChange/_*100:0}calculateTopCategories(){let t=new Date().getMonth(),r=new Date().getFullYear(),a=this.transactions.filter(u=>{let m=this.dateService.toDate(u.date);return u.type==="expense"&&(m==null?void 0:m.getMonth())===t&&(m==null?void 0:m.getFullYear())===r}),o=new Map;a.forEach(u=>{let m=o.get(u.categoryId)||0;o.set(u.categoryId,m+u.amount)});let s=this.totalExpenses;this.topCategories=Array.from(o.entries()).map(([u,m])=>{let f=this.categories.find(h=>h.id===u);return{category:(f==null?void 0:f.name)||"Unknown",amount:m,percentage:s>0?m/s*100:0,icon:(f==null?void 0:f.icon)||"category"}}).sort((u,m)=>m.amount-u.amount).slice(0,5)}getRecentTransactions(){this.recentTransactions=this.transactions.sort((t,r)=>{var a,o,s,u;return((o=(a=this.dateService.toDate(r.date))==null?void 0:a.getTime())!=null?o:0)-((u=(s=this.dateService.toDate(t.date))==null?void 0:s.getTime())!=null?u:0)}).slice(0,5)}calculateMonthlyTrends(){let t=new Date,r=[];for(let a=5;a>=0;a--){let o=new Date(t.getFullYear(),t.getMonth()-a,1),s=o.toLocaleDateString(Dt.LANGUAGE.DEFAULT,{month:"short"}),u=this.transactions.filter(h=>{let _=this.dateService.toDate(h.date);return(_==null?void 0:_.getMonth())===o.getMonth()&&(_==null?void 0:_.getFullYear())===o.getFullYear()}),m=u.filter(h=>h.type==="income").reduce((h,_)=>h+_.amount,0),f=u.filter(h=>h.type==="expense").reduce((h,_)=>h+_.amount,0);r.push({month:s,income:m,expenses:f,savings:m-f})}this.monthlyTrends=r}calculateEnhancedAnalytics(){this.calculateDailyData(),this.calculateWeeklyData(),this.calculateYearlyData(),this.calculateAccountBalances(),this.calculateSpendingTrends(),this.calculateCategoryTrends(),this.calculateGrowthRates()}calculateDailyData(){let t=new Date,r=[];for(let a=29;a>=0;a--){let o=new Date(t.getTime()-a*24*60*60*1e3),s=o.toISOString().split("T")[0],u=this.transactions.filter(h=>{let _=this.dateService.toDate(h.date);return(_==null?void 0:_.toDateString())===o.toDateString()}),m=u.filter(h=>h.type==="income").reduce((h,_)=>h+_.amount,0),f=u.filter(h=>h.type==="expense").reduce((h,_)=>h+_.amount,0);r.push({date:s,income:m,expenses:f,savings:m-f})}this.dailyData=r}calculateWeeklyData(){let t=new Date,r=[];for(let a=11;a>=0;a--){let o=new Date(t.getTime()-a*7*24*60*60*1e3),s=new Date(o.getTime()+6*24*60*60*1e3),u=`Week ${Math.ceil((o.getTime()-new Date(o.getFullYear(),0,1).getTime())/(7*24*60*60*1e3))}`,m=this.transactions.filter(_=>{let y=this.dateService.toDate(_.date);return y&&y>=o&&y<=s}),f=m.filter(_=>_.type==="income").reduce((_,y)=>_+y.amount,0),h=m.filter(_=>_.type==="expense").reduce((_,y)=>_+y.amount,0);r.push({week:u,income:f,expenses:h,savings:f-h})}this.weeklyData=r}calculateYearlyData(){let t=new Date,r=[];for(let a=4;a>=0;a--){let o=t.getFullYear()-a,s=o.toString(),u=this.transactions.filter(h=>{let _=this.dateService.toDate(h.date);return(_==null?void 0:_.getFullYear())===o}),m=u.filter(h=>h.type==="income").reduce((h,_)=>h+_.amount,0),f=u.filter(h=>h.type==="expense").reduce((h,_)=>h+_.amount,0);r.push({year:s,income:m,expenses:f,savings:m-f})}this.yearlyData=r}calculateAccountBalances(){let t=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"];this.accountBalances=this.accounts.map((r,a)=>{let s=this.transactions.filter(u=>u.accountId===r.accountId).reduce((u,m)=>u+(m.type==="income"?m.amount:-m.amount),r.balance||0);return{account:r.name,balance:Math.max(0,s),color:t[a%t.length]}})}calculateSpendingTrends(){let t=["Last 7 Days","Last 30 Days","Last 3 Months","Last 6 Months","Last Year"],r=[];t.forEach((a,o)=>{let s=[7,30,90,180,365][o],u=new Date,m=new Date(u.getTime()-s*24*60*60*1e3),h=this.transactions.filter(D=>{let T=this.dateService.toDate(D.date);return T&&T>=m&&T<=u}).filter(D=>D.type==="expense").reduce((D,T)=>D+T.amount,0),_=new Date(m.getTime()-s*24*60*60*1e3),v=this.transactions.filter(D=>{let T=this.dateService.toDate(D.date);return T&&T>=_&&T<m}).filter(D=>D.type==="expense").reduce((D,T)=>D+T.amount,0),C=h-v,P=v>0?C/v*100:0;r.push({period:a,amount:h,change:C,percentage:P})}),this.spendingTrends=r}calculateCategoryTrends(){let t=new Date,r=t.getMonth(),a=t.getFullYear(),o=r===0?11:r-1,s=r===0?a-1:a,u=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#EC4899","#84CC16"];this.categoryTrends=this.categories.map((m,f)=>{let _=this.transactions.filter(D=>{let T=this.dateService.toDate(D.date);return D.categoryId===m.id&&D.type==="expense"&&(T==null?void 0:T.getMonth())===r&&(T==null?void 0:T.getFullYear())===a}).reduce((D,T)=>D+T.amount,0),v=this.transactions.filter(D=>{let T=this.dateService.toDate(D.date);return D.categoryId===m.id&&D.type==="expense"&&(T==null?void 0:T.getMonth())===o&&(T==null?void 0:T.getFullYear())===s}).reduce((D,T)=>D+T.amount,0),C=_-v,P=v>0?C/v*100:0;return{category:m.name,currentAmount:_,previousAmount:v,change:C,percentage:P,color:u[f%u.length]}}).filter(m=>m.currentAmount>0||m.previousAmount>0).sort((m,f)=>Math.abs(f.change)-Math.abs(m.change)).slice(0,8)}calculateGrowthRates(){var f;let t=this.transactions.filter(h=>h.type==="expense").reduce((h,_)=>h+_.amount,0),r=this.transactions.length>0?Math.max(1,Math.ceil((new Date().getTime()-(((f=this.dateService.toDate(this.transactions[0].date))==null?void 0:f.getTime())||0))/(24*60*60*1e3))):30;this.averageDailySpending=t/r,this.averageMonthlySpending=this.averageDailySpending*30;let a=this.transactions.filter(h=>h.type==="income").reduce((h,_)=>h+_.amount,0);this.savingsRate=a>0?this.netSavings/a*100:0;let o=this.totalExpenses,s=this.transactions.filter(h=>{let _=this.dateService.toDate(h.date),y=new Date().getMonth()===0?11:new Date().getMonth()-1,v=new Date().getMonth()===0?new Date().getFullYear()-1:new Date().getFullYear();return h.type==="expense"&&(_==null?void 0:_.getMonth())===y&&(_==null?void 0:_.getFullYear())===v}).reduce((h,_)=>h+_.amount,0);this.expenseGrowthRate=s>0?(o-s)/s*100:0;let u=this.totalIncome,m=this.transactions.filter(h=>{let _=this.dateService.toDate(h.date),y=new Date().getMonth()===0?11:new Date().getMonth()-1,v=new Date().getMonth()===0?new Date().getFullYear()-1:new Date().getFullYear();return h.type==="income"&&(_==null?void 0:_.getMonth())===y&&(_==null?void 0:_.getFullYear())===v}).reduce((h,_)=>h+_.amount,0);this.incomeGrowthRate=m>0?(u-m)/m*100:0}onPeriodChange(t){this.selectedPeriod=t,this.notificationService.info(`Report period changed to ${t}`),console.log("Period changed to:",t),this.updateCharts()}onChartTypeChange(t){this.selectedChartType=t,this.notificationService.info(`Chart type changed to ${t}`),this.updateCharts()}onAnalyticsViewChange(t){this.selectedAnalyticsView=t,this.notificationService.info(`Analytics view changed to ${t}`),this.updateCharts()}toggleAdvancedAnalytics(){this.showAdvancedAnalytics=!this.showAdvancedAnalytics,this.userPreferences.showAdvancedAnalytics=this.showAdvancedAnalytics,this.savePreferences(),this.notificationService.info(this.showAdvancedAnalytics?"Advanced analytics enabled":"Advanced analytics disabled")}openPreferencesDialog(){this.showPreferencesDialog=!0}closePreferencesDialog(){this.showPreferencesDialog=!1}savePreferences(){localStorage.setItem("reports-preferences",JSON.stringify(this.userPreferences)),this.notificationService.success("Preferences saved successfully")}loadPreferences(){let t=localStorage.getItem("reports-preferences");t&&(this.userPreferences=ae(ae({},this.userPreferences),JSON.parse(t)),this.selectedChartType=this.userPreferences.defaultChartType,this.selectedAnalyticsView=this.userPreferences.defaultAnalyticsView,this.selectedPeriod=this.userPreferences.defaultPeriod,this.showAdvancedAnalytics=this.userPreferences.showAdvancedAnalytics)}resetPreferences(){this.userPreferences={defaultChartType:"pie",defaultAnalyticsView:"overview",defaultPeriod:"monthly",showAdvancedAnalytics:!1,chartHeight:"medium",refreshInterval:5,currencyFormat:"INR",dateFormat:"DD/MM/YYYY",theme:"auto",showTooltips:!0,showAnimations:!0,exportFormat:"pdf",emailReports:!1,emailFrequency:"never"},this.savePreferences(),this.notificationService.info("Preferences reset to default")}toggleQuickFilters(){this.showQuickFilters=!this.showQuickFilters}applyFilters(){this.notificationService.info("Filters applied successfully"),this.toggleQuickFilters(),this.refreshData()}toggleExportOptions(){this.showExportOptions=!this.showExportOptions}toggleHelpTooltip(){this.showHelpTooltip=!this.showHelpTooltip}toggleQuickActions(){this.showQuickActions=!this.showQuickActions}refreshData(){this.isRefreshing=!0,setTimeout(()=>{this.loadData(),this.isRefreshing=!1,this.notificationService.success("Data refreshed successfully")},1e3)}getChartHeight(){switch(this.userPreferences.chartHeight){case"small":return"h-48 sm:h-56";case"large":return"h-80 sm:h-96";default:return"h-64 sm:h-80"}}formatCurrencyWithPreference(t){switch(this.userPreferences.currencyFormat){case"USD":return`$${t.toLocaleString("en-US")}`;case"EUR":return`\u20AC${t.toLocaleString("de-DE")}`;default:return`\u20B9${t.toLocaleString("en-IN")}`}}exportReport(){try{console.log("Export report clicked"),this.notificationService.info("Export feature coming soon")}catch(t){console.error("Error exporting report:",t),this.notificationService.error("Failed to export report")}}generateReport(){try{console.log("Generate report clicked"),this.notificationService.info("Report generation feature coming soon")}catch(t){console.error("Error generating report:",t),this.notificationService.error("Failed to generate report")}}addTransaction(){this.router.navigate(["/dashboard/transaction-list/add-transaction"])}getMonthlyChangeDisplay(){return`${this.monthlyChange>=0?"+":""}${this.monthlyChangePercentage.toFixed(1)}%`}getMonthlyChangeColor(){return this.monthlyChange>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}getMonthlyChangeIcon(){return this.monthlyChange>=0?"trending_up":"trending_down"}formatCurrency(t){return`\u20B9${t.toLocaleString("en-IN")}`}getTransactionIcon(t){return t.type==="income"?"trending_up":"trending_down"}getTransactionColor(t){return t.type==="income"?"text-green-600":"text-red-600"}getCurrentChartOption(){switch(this.selectedChartType){case"pie":return this.pieChartOption;case"bar":return this.barChartOption;case"line":return this.lineChartOption;case"area":return this.areaChartOption;case"radar":return this.radarChartOption;case"funnel":return this.funnelChartOption;case"scatter":return this.scatterChartOption;case"heatmap":return this.heatmapChartOption;default:return this.pieChartOption}}getChartTitle(){switch(this.selectedChartType){case"pie":return"Spending by Category";case"bar":return"Monthly Financial Trends";case"line":return"Financial Trends Over Time";case"area":return"Daily Spending Patterns";case"radar":return"Category Performance Comparison";case"funnel":return"Spending Funnel Analysis";case"scatter":return"Income vs Expenses Correlation";case"heatmap":return"Weekly Spending Heatmap";default:return"Financial Analytics"}}initializePieChart(){if(this.topCategories.length===0){this.pieChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.topCategories.map(r=>({name:r.category,value:r.amount,itemStyle:{color:r.color}}));this.pieChartOption={title:{text:"Spending by Category",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"},formatter:r=>{let a=(r.value/this.totalExpenses*100).toFixed(1);return`${r.name}<br/>${this.formatCurrency(r.value)} (${a}%)`}},legend:{orient:"vertical",left:"left",top:"middle",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"}},series:[{name:"Spending",type:"pie",radius:["40%","70%"],center:["60%","50%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold",color:this.isDarkMode?"#F9FAFB":"#333"}},labelLine:{show:!1},data:t}]}}initializeBarChart(){if(this.monthlyTrends.length===0){this.barChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.monthlyTrends.map(s=>s.month),r=this.monthlyTrends.map(s=>s.income),a=this.monthlyTrends.map(s=>s.expenses),o=this.monthlyTrends.map(s=>s.savings);this.barChartOption={title:{text:"Monthly Financial Trends",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"},formatter:s=>{let u=`${s[0].axisValue}<br/>`;return s.forEach(m=>{u+=`${m.marker} ${m.seriesName}: ${this.formatCurrency(m.value)}<br/>`}),u}},legend:{data:["Income","Expenses","Savings"],top:"bottom",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"}},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",data:t,axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},yAxis:{type:"value",axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333",formatter:s=>this.formatCurrency(s)},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},series:[{name:"Income",type:"bar",data:r,itemStyle:{color:"#10B981"},emphasis:{itemStyle:{color:"#059669"}}},{name:"Expenses",type:"bar",data:a,itemStyle:{color:"#EF4444"},emphasis:{itemStyle:{color:"#DC2626"}}},{name:"Savings",type:"bar",data:o,itemStyle:{color:"#3B82F6"},emphasis:{itemStyle:{color:"#2563EB"}}}]}}initializeLineChart(){if(this.monthlyTrends.length===0){this.lineChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.monthlyTrends.map(s=>s.month),r=this.monthlyTrends.map(s=>s.income),a=this.monthlyTrends.map(s=>s.expenses),o=this.monthlyTrends.map(s=>s.savings);this.lineChartOption={title:{text:"Financial Trends Over Time",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"}},legend:{data:["Income","Expenses","Savings"],top:"bottom",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"}},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",data:t,axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},yAxis:{type:"value",axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333",formatter:s=>this.formatCurrency(s)},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},series:[{name:"Income",type:"line",data:r,smooth:!0,itemStyle:{color:"#10B981"},lineStyle:{color:"#10B981",width:3},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(16, 185, 129, 0.3)"},{offset:1,color:"rgba(16, 185, 129, 0.1)"}]}}},{name:"Expenses",type:"line",data:a,smooth:!0,itemStyle:{color:"#EF4444"},lineStyle:{color:"#EF4444",width:3},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(239, 68, 68, 0.3)"},{offset:1,color:"rgba(239, 68, 68, 0.1)"}]}}},{name:"Savings",type:"line",data:o,smooth:!0,itemStyle:{color:"#3B82F6"},lineStyle:{color:"#3B82F6",width:3},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(59, 130, 246, 0.3)"},{offset:1,color:"rgba(59, 130, 246, 0.1)"}]}}}]}}initializeAreaChart(){if(this.dailyData.length===0){this.areaChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.dailyData.map(o=>o.date),r=this.dailyData.map(o=>o.income),a=this.dailyData.map(o=>o.expenses);this.areaChartOption={title:{text:"Daily Spending Patterns",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"}},legend:{data:["Income","Expenses"],top:"bottom",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"}},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",data:t,axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},yAxis:{type:"value",axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333",formatter:o=>this.formatCurrency(o)},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},series:[{name:"Income",type:"line",stack:"Total",data:r,areaStyle:{color:"#10B981"},itemStyle:{color:"#10B981"}},{name:"Expenses",type:"line",stack:"Total",data:a,areaStyle:{color:"#EF4444"},itemStyle:{color:"#EF4444"}}]}}initializeRadarChart(){if(this.categoryTrends.length===0){this.radarChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.categoryTrends.map(o=>o.category),r=this.categoryTrends.map(o=>o.currentAmount),a=this.categoryTrends.map(o=>o.previousAmount);this.radarChartOption={title:{text:"Category Performance Comparison",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"}},legend:{data:["Current Month","Previous Month"],top:"bottom",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"}},radar:{indicator:t.map(o=>({name:o,max:Math.max(...r,...a)*1.2})),center:["50%","50%"],radius:"60%",axisName:{color:this.isDarkMode?"#F9FAFB":"#333"},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitArea:{show:!1}},series:[{name:"Category Performance",type:"radar",data:[{value:r,name:"Current Month",itemStyle:{color:"#3B82F6"},areaStyle:{color:"rgba(59, 130, 246, 0.3)"}},{value:a,name:"Previous Month",itemStyle:{color:"#10B981"},areaStyle:{color:"rgba(16, 185, 129, 0.3)"}}]}]}}initializeFunnelChart(){if(this.spendingTrends.length===0){this.funnelChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.spendingTrends.map(r=>({name:r.period,value:r.amount}));this.funnelChartOption={title:{text:"Spending Funnel Analysis",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"},formatter:r=>`${r.name}<br/>${this.formatCurrency(r.value)}`},series:[{name:"Spending",type:"funnel",left:"10%",top:60,width:"80%",height:"80%",min:0,max:Math.max(...t.map(r=>r.value)),minSize:"0%",maxSize:"100%",sort:"descending",gap:2,label:{show:!0,position:"inside",color:this.isDarkMode?"#F9FAFB":"#333"},labelLine:{length:10,lineStyle:{width:1,type:"solid"}},itemStyle:{borderColor:this.isDarkMode?"#374151":"#FFFFFF",borderWidth:1},emphasis:{label:{fontSize:20}},data:t}]}}initializeScatterChart(){if(this.dailyData.length===0){this.scatterChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.dailyData.map((r,a)=>[a,r.expenses,r.income]);this.scatterChartOption={title:{text:"Income vs Expenses Correlation",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"},formatter:r=>`Day ${r.data[0]+1}<br/>Expenses: ${this.formatCurrency(r.data[1])}<br/>Income: ${this.formatCurrency(r.data[2])}`},xAxis:{type:"value",name:"Day",axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},yAxis:{type:"value",name:"Amount",axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333",formatter:r=>this.formatCurrency(r)},axisLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}},splitLine:{lineStyle:{color:this.isDarkMode?"#4B5563":"#E5E7EB"}}},series:[{name:"Income vs Expenses",type:"scatter",data:t,symbolSize:8,itemStyle:{color:"#3B82F6"}}]}}initializeHeatmapChart(){if(this.dailyData.length===0){this.heatmapChartOption={title:{text:"No Data Available",left:"center",top:"center",textStyle:{color:this.isDarkMode?"#9CA3AF":"#666",fontSize:16}}};return}let t=this.dailyData.map((r,a)=>[Math.floor(a/7),a%7,r.expenses]);this.heatmapChartOption={title:{text:"Weekly Spending Heatmap",left:"center",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333",fontSize:16,fontWeight:"bold"}},tooltip:{position:"top",backgroundColor:this.isDarkMode?"#374151":"#FFFFFF",borderColor:this.isDarkMode?"#4B5563":"#E5E7EB",textStyle:{color:this.isDarkMode?"#F9FAFB":"#374151"},formatter:r=>{let a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return`Week ${r.data[0]+1}, ${a[r.data[1]]}<br/>${this.formatCurrency(r.data[2])}`}},grid:{height:"50%",top:"10%"},xAxis:{type:"category",data:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],splitArea:{show:!0},axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"}},yAxis:{type:"category",data:["Week 1","Week 2","Week 3","Week 4"],splitArea:{show:!0},axisLabel:{color:this.isDarkMode?"#F9FAFB":"#333"}},visualMap:{min:0,max:Math.max(...this.dailyData.map(r=>r.expenses)),calculable:!0,orient:"horizontal",left:"center",bottom:"15%",textStyle:{color:this.isDarkMode?"#F9FAFB":"#333"},inRange:{color:["#EBF8FF","#3B82F6"]}},series:[{name:"Spending",type:"heatmap",data:t,label:{show:!0,color:this.isDarkMode?"#F9FAFB":"#333"},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}}updateCharts(){this.initializePieChart(),this.initializeBarChart(),this.initializeLineChart(),this.initializeAreaChart(),this.initializeRadarChart(),this.initializeFunnelChart(),this.initializeScatterChart(),this.initializeHeatmapChart()}detectTheme(){this.isDarkMode=document.documentElement.classList.contains("dark"),new MutationObserver(()=>{this.isDarkMode=document.documentElement.classList.contains("dark"),this.updateCharts()}).observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),this.ssrService.isClientSide()&&window.addEventListener("resize",()=>{setTimeout(()=>this.updateCharts(),100)})}};n.\u0275fac=function(r){return new(r||n)(q(Kt),q(pt),q(ht),q(wt),q(At),q(Pr))},n.\u0275cmp=Ve({type:n,selectors:[["app-reports"]],decls:11,vars:6,consts:[["chartTypeMenu","matMenu"],["analyticsViewMenu","matMenu"],["moreOptionsMenu","matMenu"],[1,"min-h-screen","bg-gray-50","dark:bg-gray-900"],["class","max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",4,"ngIf"],["class","max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",4,"ngIf"],[1,"fixed","bottom-6","right-6","z-40"],[1,"flex","flex-col","space-y-2"],["mat-fab","","color","primary","matTooltip","Quick Actions",1,"shadow-lg",3,"click"],["class","flex flex-col space-y-2",4,"ngIf"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-12"],[1,"text-center"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-blue-100","dark:bg-blue-900/20","rounded-full","mb-6"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","mb-2"],[1,"text-gray-600","dark:text-gray-400"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-6","space-y-6"],[1,"grid","grid-cols-1","sm:grid-cols-2","xl:grid-cols-4","gap-4"],[1,"bg-gradient-to-br","from-green-50","to-green-100","dark:from-green-900/20","dark:to-green-800/20","rounded-xl","p-4","sm:p-6","border","border-green-200","dark:border-green-700","shadow-sm","hover:shadow-md","transition-shadow","metric-card"],[1,"flex","items-center","justify-between"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-green-600","dark:text-green-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-green-900","dark:text-green-100","truncate"],[1,"text-xs","text-green-600","dark:text-green-400","mt-1"],[1,"bg-green-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-green-600","dark:text-green-400","text-lg","sm:text-xl"],[1,"bg-gradient-to-br","from-red-50","to-red-100","dark:from-red-900/20","dark:to-red-800/20","rounded-xl","p-4","sm:p-6","border","border-red-200","dark:border-red-700","shadow-sm","hover:shadow-md","transition-shadow","metric-card"],[1,"text-sm","font-medium","text-red-600","dark:text-red-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-red-900","dark:text-red-100","truncate"],[1,"text-xs","text-red-600","dark:text-red-400","mt-1"],[1,"bg-red-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-red-600","dark:text-red-400","text-lg","sm:text-xl"],[1,"bg-gradient-to-br","from-blue-50","to-blue-100","dark:from-blue-900/20","dark:to-blue-800/20","rounded-xl","p-4","sm:p-6","border","border-blue-200","dark:border-blue-700","shadow-sm","hover:shadow-md","transition-shadow","metric-card"],[1,"text-sm","font-medium","text-blue-600","dark:text-blue-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-blue-900","dark:text-blue-100","truncate"],[1,"text-xs","text-blue-600","dark:text-blue-400","mt-1"],[1,"bg-blue-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-blue-600","dark:text-blue-400","text-lg","sm:text-xl"],[1,"bg-gradient-to-br","from-purple-50","to-purple-100","dark:from-purple-900/20","dark:to-purple-800/20","rounded-xl","p-4","sm:p-6","border","border-purple-200","dark:border-purple-700","shadow-sm","hover:shadow-md","transition-shadow","metric-card"],[1,"text-sm","font-medium","text-purple-600","dark:text-purple-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-purple-900","dark:text-purple-100","truncate",3,"ngClass"],[1,"text-xs","text-purple-600","dark:text-purple-400","mt-1"],[1,"bg-purple-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-lg","sm:text-xl",3,"ngClass"],[1,"bg-white","dark:bg-gray-800","shadow-lg","border-0","rounded-xl","overflow-hidden"],[1,"p-4","sm:p-6","border-b","border-gray-200","dark:border-gray-700","bg-gray-50","dark:bg-gray-700/50"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between","gap-4"],[1,"text-lg","sm:text-xl","font-semibold","text-gray-900","dark:text-white","truncate"],[1,"text-sm","text-gray-600","dark:text-gray-400","mt-1"],[1,"flex","items-center","space-x-2","compact-control-bar"],[1,"hidden","sm:flex",3,"change","value"],["value","daily",1,"text-xs"],["value","weekly",1,"text-xs"],["value","monthly",1,"text-xs"],["value","yearly",1,"text-xs"],["mat-icon-button","","matTooltip","Chart Type",1,"text-gray-600","dark:text-gray-400","hover:text-blue-600","dark:hover:text-blue-400",3,"matMenuTriggerFor"],[1,"chart-type-menu"],[1,"p-2"],[1,"text-xs","font-medium","text-gray-500","dark:text-gray-400","mb-2","px-3"],["mat-menu-item","",1,"flex","items-center","space-x-3",3,"bg-blue-50"],["mat-icon-button","","matTooltip","Analytics View",1,"text-gray-600","dark:text-gray-400","hover:text-green-600","dark:hover:text-green-400",3,"matMenuTriggerFor"],[1,"analytics-view-menu"],["mat-menu-item","",1,"flex","items-center","space-x-3",3,"bg-green-50"],["mat-icon-button","",1,"hover:text-purple-600","dark:hover:text-purple-400",3,"click","matTooltip"],["mat-icon-button","","matTooltip","More Options",1,"text-gray-600","dark:text-gray-400","hover:text-gray-800","dark:hover:text-gray-200",3,"matMenuTriggerFor"],[1,"more-options-menu"],["mat-menu-item","",1,"flex","items-center","space-x-3",3,"click"],[1,"text-sm"],["mat-menu-item","",1,"flex","items-center","space-x-3",3,"click","disabled"],[1,"p-4","sm:p-6"],[1,"w-full","chart-transition",3,"ngClass"],["echarts","",1,"w-full","h-full",3,"options"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2"],[1,"bg-white","dark:bg-gray-800","shadow-lg","border-0","rounded-xl","overflow-hidden","h-full"],[1,"flex","items-center","justify-between","mb-4","sm:mb-6"],[1,"text-green-600","dark:text-green-400"],[1,"space-y-4"],["class","space-y-3",4,"ngIf"],[1,"lg:col-span-1"],[1,"text-blue-600","dark:text-blue-400"],[1,"space-y-3"],["mat-stroked-button","",1,"w-full","justify-start",3,"click"],[1,"mr-3"],["mat-stroked-button","",1,"w-full","justify-start",3,"click","disabled"],["class","bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 sm:p-6",4,"ngIf"],["class","flex justify-center",4,"ngIf"],["class","grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-4","sm:gap-6","mb-8"],[1,"space-y-3","sm:space-y-4"],[1,"flex","justify-between","items-center","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg"],[1,"flex","items-center","space-x-3","min-w-0","flex-1"],[1,"w-3","h-3","bg-green-500","rounded-full","flex-shrink-0"],[1,"text-gray-700","dark:text-gray-300","truncate"],[1,"font-semibold","text-green-600","dark:text-green-400","ml-3","text-right"],[1,"w-3","h-3","bg-red-500","rounded-full","flex-shrink-0"],[1,"font-semibold","text-red-600","dark:text-red-400","ml-3","text-right"],[1,"w-3","h-3","bg-blue-500","rounded-full","flex-shrink-0"],[1,"font-semibold","text-blue-600","dark:text-blue-400","ml-3","text-right"],[1,"flex","justify-between","items-center","p-3","bg-green-50","dark:bg-green-900/20","rounded-lg","border","border-green-200","dark:border-green-700"],[1,"text-gray-700","dark:text-gray-300"],[1,"text-purple-600","dark:text-purple-400"],["class","text-center py-8 sm:py-12",4,"ngIf"],[1,"bg-orange-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-orange-600","dark:text-orange-400"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between","gap-4","mb-6","sm:mb-8"],[1,"text-xl","sm:text-2xl","font-bold","text-gray-900","dark:text-white"],[1,"flex","flex-wrap","gap-2","justify-center","lg:justify-end"],["mat-stroked-button","",1,"px-3","sm:px-4","py-2","text-xs","sm:text-sm","border","border-gray-300","dark:border-gray-600","rounded-lg","hover:bg-gray-50","dark:hover:bg-gray-700","transition-colors",3,"click"],["mat-raised-button","","color","primary",1,"px-3","sm:px-4","py-2","text-xs","sm:text-sm","rounded-lg","shadow-md","hover:shadow-lg","transition-shadow",3,"click"],["class","space-y-6",4,"ngIf"],["class","text-center py-12 sm:py-16",4,"ngIf"],[1,"text-blue-600","text-sm"],[1,"text-green-600","text-sm"],[1,"text-sm","font-medium","text-gray-700","dark:text-gray-300","flex","items-center"],[1,"text-sm","mr-2"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg","hover:bg-gray-100","dark:hover:bg-gray-600","transition-colors"],[1,"text-sm","text-gray-600","dark:text-gray-400","truncate"],[1,"text-sm","font-medium",3,"ngClass"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-lg","p-4","sm:p-6"],[1,"flex","items-center","justify-between","mb-6"],[1,"flex","items-center","space-x-3"],[1,"bg-blue-500/10","p-2","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-600","dark:text-gray-400"],["mat-icon-button","",1,"text-gray-600","dark:text-gray-400","hover:text-gray-800","dark:hover:text-gray-200",3,"click"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],["appearance","fill",1,"w-full"],["value","7"],["value","30"],["value","90"],["value","365"],["value","all"],[3,"value"],["value","income"],["value","expense"],[1,"flex","justify-end","space-x-3","mt-6"],["mat-stroked-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],[1,"flex","justify-center"],["mat-stroked-button","",1,"flex","items-center","space-x-2","px-6","py-3",3,"click"],[1,"bg-gradient-to-br","from-orange-50","to-orange-100","dark:from-orange-900/20","dark:to-orange-800/20","rounded-xl","p-4","sm:p-6","border","border-orange-200","dark:border-orange-700"],[1,"text-sm","font-medium","text-orange-600","dark:text-orange-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-orange-900","dark:text-orange-100","truncate"],[1,"text-orange-600","dark:text-orange-400","text-lg","sm:text-xl"],[1,"bg-gradient-to-br","from-indigo-50","to-indigo-100","dark:from-indigo-900/20","dark:to-indigo-800/20","rounded-xl","p-4","sm:p-6","border","border-indigo-200","dark:border-indigo-700"],[1,"text-sm","font-medium","text-indigo-600","dark:text-indigo-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-indigo-900","dark:text-indigo-100","truncate"],[1,"bg-indigo-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-indigo-600","dark:text-indigo-400","text-lg","sm:text-xl"],[1,"bg-gradient-to-br","from-emerald-50","to-emerald-100","dark:from-emerald-900/20","dark:to-emerald-800/20","rounded-xl","p-4","sm:p-6","border","border-emerald-200","dark:border-emerald-700"],[1,"text-sm","font-medium","text-emerald-600","dark:text-emerald-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-emerald-900","dark:text-emerald-100","truncate"],[1,"bg-emerald-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-emerald-600","dark:text-emerald-400","text-lg","sm:text-xl"],[1,"bg-gradient-to-br","from-rose-50","to-rose-100","dark:from-rose-900/20","dark:to-rose-800/20","rounded-xl","p-4","sm:p-6","border","border-rose-200","dark:border-rose-700"],[1,"text-sm","font-medium","text-rose-600","dark:text-rose-400","truncate"],[1,"text-lg","sm:text-xl","lg:text-2xl","font-bold","text-rose-900","dark:text-rose-100","truncate",3,"ngClass"],[1,"bg-rose-500/10","p-2","sm:p-3","rounded-lg","flex-shrink-0","ml-3"],[1,"text-rose-600","dark:text-rose-400","text-lg","sm:text-xl"],[1,"font-semibold","text-gray-900","dark:text-white","ml-3","text-right"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg"],[1,"w-8","h-8","rounded-full","flex","items-center","justify-center","flex-shrink-0","bg-gray-100","dark:bg-gray-600"],[1,"min-w-0","flex-1"],[1,"text-gray-700","dark:text-gray-300","font-medium","truncate","block"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"text-center","py-8","sm:py-12"],[1,"bg-gray-100","dark:bg-gray-700","w-16","h-16","sm:w-20","sm:h-20","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-gray-400","text-2xl","sm:text-3xl"],[1,"text-base","sm:text-lg","font-medium","text-gray-900","dark:text-white","mb-2"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"flex-shrink-0",3,"ngClass"],[1,"text-xs","text-gray-500","dark:text-gray-400","truncate"],[1,"text-right","ml-3","flex-shrink-0"],[1,"font-semibold","block",3,"ngClass"],[1,"bg-green-500/10","p-2","rounded-lg"],[3,"ngModelChange","ngModel"],["value","pdf"],["value","excel"],["value","csv"],["value","json"],["value","current"],["value","last3"],["value","last6"],["value","last12"],["value","custom"],[1,"w-full"],[1,"flex","items-end"],["mat-raised-button","","color","primary",1,"w-full",3,"click"],[1,"mr-2"],["mat-raised-button","","color","accent",3,"click"],[1,"space-y-6"],[1,"bg-gray-50","dark:bg-gray-700","rounded-lg","p-4","sm:p-6"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","mb-4"],[1,"grid","grid-cols-2","sm:grid-cols-3","md:grid-cols-4","lg:grid-cols-6","gap-3","sm:gap-4"],[1,"text-center","p-3","bg-white","dark:bg-gray-600","rounded-lg"],["class","bg-gray-50 dark:bg-gray-700 rounded-lg p-4 sm:p-6",4,"ngIf"],[1,"text-xs","sm:text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2","truncate"],[1,"text-sm","sm:text-lg","font-bold","text-green-600","dark:text-green-400","truncate"],[1,"text-xs","sm:text-sm","text-red-600","dark:text-red-400","truncate"],[1,"text-xs","text-gray-500","dark:text-gray-400","mt-1","truncate"],[1,"w-6","h-6","rounded-full","flex","items-center","justify-center","flex-shrink-0","bg-gray-100","dark:bg-gray-600"],[1,"text-xs"],[1,"flex","items-center","space-x-3","sm:space-x-4","ml-3"],[1,"w-20","sm:w-32","bg-gray-200","dark:bg-gray-600","rounded-full","h-2","flex-shrink-0"],[1,"bg-blue-600","h-2","rounded-full"],[1,"text-sm","font-medium","text-gray-900","dark:text-white","w-16","sm:w-20","text-right","truncate"],[1,"text-center","py-12","sm:py-16"],[1,"bg-gray-100","dark:bg-gray-700","w-20","h-20","sm:w-24","sm:h-24","rounded-full","flex","items-center","justify-center","mx-auto","mb-6"],[1,"text-gray-400","text-4xl","sm:text-5xl"],[1,"text-xl","sm:text-2xl","font-bold","text-gray-900","dark:text-white","mb-3"],[1,"text-sm","sm:text-base","text-gray-600","dark:text-gray-400","mb-6","max-w-md","mx-auto"],["mat-raised-button","","color","primary",1,"flex","items-center","space-x-2","px-4","sm:px-6","py-3","rounded-lg","shadow-md","hover:shadow-lg","transition-shadow","mx-auto",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-2xl","max-w-4xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"p-6","border-b","border-gray-200","dark:border-gray-700"],[1,"text-xl","font-bold","text-gray-900","dark:text-white"],["mat-icon-button","",3,"click"],[1,"text-sm","text-gray-600","dark:text-gray-400","mt-2"],[1,"p-6","space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["value","daily"],["value","weekly"],["value","monthly"],["value","yearly"],["value","small"],["value","medium"],["value","large"],["value","INR"],["value","USD"],["value","EUR"],["value","DD/MM/YYYY"],["value","MM/DD/YYYY"],["value","YYYY-MM-DD"],[1,"w-full",3,"ngModelChange","ngModel"],["matInput","","type","number","min","1","max","60",3,"ngModelChange","ngModel"],[4,"ngIf"],[1,"p-6","border-t","border-gray-200","dark:border-gray-700","flex","justify-between"],["mat-stroked-button","",1,"text-red-600","border-red-600","hover:bg-red-50",3,"click"],[1,"space-x-3"],["value","never"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-2xl","max-w-2xl","w-full"],[1,"p-6","space-y-4"],[1,"space-y-2","text-sm","text-gray-600","dark:text-gray-400"],[1,"p-6","border-t","border-gray-200","dark:border-gray-700"],["mat-mini-fab","","color","accent","matTooltip","Add Transaction",1,"shadow-lg",3,"click"],["mat-mini-fab","","color","warn","matTooltip","Export Report",1,"shadow-lg",3,"click"],["mat-mini-fab","","color","primary","matTooltip","Refresh Data",1,"shadow-lg",3,"click"]],template:function(r,a){r&1&&(c(0,"div",3),X(1,ZR,8,0,"div",4)(2,ON,278,58,"div",5)(3,IN,126,13,"div",6)(4,AN,91,0,"div",6),c(5,"div",7)(6,"div",8)(7,"button",9),N("click",function(){return a.toggleQuickActions()}),c(8,"mat-icon"),d(9),l()(),X(10,DN,10,0,"div",10),l()()()),r&2&&(p(),w("ngIf",a.isLoading),p(),w("ngIf",!a.isLoading),p(),w("ngIf",a.showPreferencesDialog),p(),w("ngIf",a.showHelpTooltip),p(5),z(a.showQuickActions?"close":"add"),p(),w("ngIf",a.showQuickActions))},dependencies:[br,ct,Vt,ki,Ut,Ks,Xs,Zn,To,Ad,Ht,bn,Z1,Ma,at,Ji,Ni,Fi,Po,So,Oo,Lx,Vx,Pa,Jn,Jr,Tu,Vn],styles:['.chart-type-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%], .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%], .more-options-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%]{padding:0}.chart-type-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%], .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%], .more-options-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]{min-height:40px;height:40px;padding:0 16px}.chart-type-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover, .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover, .more-options-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover{background-color:#3b82f61a}.chart-type-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%], .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%], .more-options-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%]{background-color:#3b82f626}.mat-button-toggle-group[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden;border:1px solid #e5e7eb}.mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]{border:none;min-width:40px;height:36px}.mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]   .mat-button-toggle-label-content[_ngcontent-%COMP%]{padding:0 8px;font-size:12px;font-weight:500}.mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle.mat-button-toggle-checked[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]:not(.mat-button-toggle-checked){background-color:#fff;color:#6b7280}.mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]:not(.mat-button-toggle-checked):hover{background-color:#f3f4f6}.dark[_ngcontent-%COMP%]   .mat-button-toggle-group[_ngcontent-%COMP%]{border-color:#4b5563}.dark[_ngcontent-%COMP%]   .mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]:not(.mat-button-toggle-checked){background-color:#374151;color:#d1d5db}.dark[_ngcontent-%COMP%]   .mat-button-toggle-group[_ngcontent-%COMP%]   .mat-button-toggle[_ngcontent-%COMP%]:not(.mat-button-toggle-checked):hover{background-color:#4b5563}.dark[_ngcontent-%COMP%]   .chart-type-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover, .dark[_ngcontent-%COMP%]   .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover, .dark[_ngcontent-%COMP%]   .more-options-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover{background-color:#3b82f633}.dark[_ngcontent-%COMP%]   .chart-type-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .analytics-view-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .more-options-menu[_ngcontent-%COMP%]   .mat-menu-item.mat-menu-item-highlighted[_ngcontent-%COMP%]{background-color:#3b82f640}.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{width:36px;height:36px;line-height:36px}.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;line-height:20px}.chart-container[_ngcontent-%COMP%]{min-height:400px}.chart-container.small[_ngcontent-%COMP%]{min-height:300px}.chart-container.medium[_ngcontent-%COMP%]{min-height:400px}.chart-container.large[_ngcontent-%COMP%]{min-height:500px}@media (max-width: 640px){.mat-button-toggle-group[_ngcontent-%COMP%]{display:none!important}.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{width:32px;height:32px;line-height:32px}.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;line-height:18px}}.chart-transition[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.mat-menu-panel[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 10px 25px #00000026;border:1px solid #e5e7eb}.dark[_ngcontent-%COMP%]   .mat-menu-panel[_ngcontent-%COMP%]{border-color:#4b5563;box-shadow:0 10px 25px #0000004d}.mat-tooltip[_ngcontent-%COMP%]{font-size:12px;padding:4px 8px;border-radius:6px}.chart-loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:200px}.chart-loading[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #f3f4f6;border-top:3px solid #3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.mat-card[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.mat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.mat-stroked-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.mat-stroked-button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 6px -1px #0000001a}.mat-raised-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.mat-raised-button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 8px 15px -3px #0000001a}.metric-card[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.metric-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 25px 50px -12px #00000040}.chart-container[_ngcontent-%COMP%]{position:relative}.chart-container[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,#3b82f60d,#9333ea0d);border-radius:inherit;opacity:0;transition:opacity .3s ease-in-out;pointer-events:none}.chart-container[_ngcontent-%COMP%]:hover:before{opacity:1}.loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background:#ffffffe6;display:flex;align-items:center;justify-content:center;border-radius:inherit;z-index:10}@media (max-width: 768px){.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{width:28px;height:28px;line-height:28px}.compact-control-bar[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;line-height:16px}.metric-card[_ngcontent-%COMP%]:hover{transform:none}}.mat-focus-indicator[_ngcontent-%COMP%]{border-radius:8px}.dark[_ngcontent-%COMP%]   .mat-card[_ngcontent-%COMP%]:hover{box-shadow:0 20px 25px -5px #0000004d,0 10px 10px -5px #0003}.dark[_ngcontent-%COMP%]   .loading-overlay[_ngcontent-%COMP%]{background:#111827e6}']});let e=n;return e})();var Yb=(()=>{let n=class n{constructor(t){this.dateService=t,this.oldRegimeSlabs=[{minIncome:0,maxIncome:25e4,rate:0,description:"Up to \u20B92,50,000"},{minIncome:250001,maxIncome:5e5,rate:5,description:"\u20B92,50,001 - \u20B95,00,000"},{minIncome:500001,maxIncome:1e6,rate:20,description:"\u20B95,00,001 - \u20B910,00,000"},{minIncome:1000001,maxIncome:1/0,rate:30,description:"Above \u20B910,00,000"}],this.newRegimeSlabs=[{minIncome:0,maxIncome:3e5,rate:0,description:"Up to \u20B93,00,000"},{minIncome:300001,maxIncome:6e5,rate:5,description:"\u20B93,00,001 - \u20B96,00,000"},{minIncome:600001,maxIncome:9e5,rate:10,description:"\u20B96,00,001 - \u20B99,00,000"},{minIncome:900001,maxIncome:12e5,rate:15,description:"\u20B99,00,001 - \u20B912,00,000"},{minIncome:1200001,maxIncome:15e5,rate:20,description:"\u20B912,00,001 - \u20B915,00,000"},{minIncome:1500001,maxIncome:1/0,rate:30,description:"Above \u20B915,00,000"}],this.NEW_REGIME_STANDARD_DEDUCTION=Dt.VALIDATION.MAX_AMOUNT*.05}calculateTotalIncome(t,r=2025){let a=new Date(r-1,3,1),o=new Date(r,2,31);return t.filter(s=>{let u=this.dateService.toDate(s.date)||new Date;return s.type==="income"&&u>=a&&u<=o}).reduce((s,u)=>s+u.amount,0)}getDefaultDeductions(){return[{section:"80C",description:"ELSS, PPF, EPF, Life Insurance, etc.",maxAmount:15e4,currentAmount:0},{section:"80D",description:"Health Insurance Premium",maxAmount:25e3,currentAmount:0},{section:"80G",description:"Donations to Charitable Institutions",maxAmount:1e5,currentAmount:0},{section:"80TTA",description:"Interest on Savings Account",maxAmount:1e4,currentAmount:0},{section:"HRA",description:"House Rent Allowance Exemption",maxAmount:0,currentAmount:0},{section:"LTA",description:"Leave Travel Allowance",maxAmount:0,currentAmount:0}]}calculateOldRegimeTax(t,r){let a=r.reduce((f,h)=>f+h.currentAmount,0),o=Math.max(0,t-a),s=this.calculateTaxBySlabs(o,this.oldRegimeSlabs),u=s*.04,m=s+u;return{totalIncome:t,deductions:r,totalDeductions:a,taxableIncome:o,incomeTax:s,cess:u,totalTaxLiability:m,regime:"old"}}calculateNewRegimeTax(t){let r=Math.max(0,t-this.NEW_REGIME_STANDARD_DEDUCTION),a=this.calculateTaxBySlabs(r,this.newRegimeSlabs),o=a*.04,s=a+o;return{totalIncome:t,deductions:[{section:"Standard",description:"Standard Deduction",maxAmount:this.NEW_REGIME_STANDARD_DEDUCTION,currentAmount:this.NEW_REGIME_STANDARD_DEDUCTION}],totalDeductions:this.NEW_REGIME_STANDARD_DEDUCTION,taxableIncome:r,incomeTax:a,cess:o,totalTaxLiability:s,regime:"new"}}calculateTaxBySlabs(t,r){let a=0,o=t;for(let s of r){if(o<=0)break;let u=Math.min(o,s.maxIncome===1/0?o:s.maxIncome-s.minIncome+1);a+=u*s.rate/100,o-=u}return a}calculateGST(t,r=18){let a=t*r/100,o=a/2,s=a/2;return{baseAmount:t,cgst:o,sgst:s,totalGST:a}}getTaxSlabs(t){return t==="old"?this.oldRegimeSlabs:this.newRegimeSlabs}compareRegimes(t,r){let a=this.calculateOldRegimeTax(t,r),o=this.calculateNewRegimeTax(t),s=a.totalTaxLiability-o.totalTaxLiability,u=s>0?"new":"old";return{oldRegime:a,newRegime:o,recommendation:u,savings:Math.abs(s)}}generateTaxReport(t,r){return`
INDIAN TAX ANALYSIS REPORT
Financial Year: 2024-25
Tax Regime: ${t.regime==="old"?"Old Regime (With Deductions)":"New Regime (Simplified)"}

INCOME DETAILS:
Total Income: \u20B9${t.totalIncome.toLocaleString("en-IN")}

${t.regime==="old"?`
DEDUCTIONS:
${t.deductions.map(o=>`${o.section}: \u20B9${o.currentAmount.toLocaleString("en-IN")}`).join(`
`)}
Total Deductions: \u20B9${t.totalDeductions.toLocaleString("en-IN")}
`:`
STANDARD DEDUCTION:
Standard Deduction: \u20B9${t.totalDeductions.toLocaleString("en-IN")}
`}

TAXABLE INCOME: \u20B9${t.taxableIncome.toLocaleString("en-IN")}

TAX CALCULATION:
Income Tax: \u20B9${t.incomeTax.toLocaleString("en-IN")}
Cess (4%): \u20B9${t.cess.toLocaleString("en-IN")}
TOTAL TAX LIABILITY: \u20B9${t.totalTaxLiability.toLocaleString("en-IN")}

${r?`
GST ANALYSIS:
Base Amount: \u20B9${r.baseAmount.toLocaleString("en-IN")}
CGST (9%): \u20B9${r.cgst.toLocaleString("en-IN")}
SGST (9%): \u20B9${r.sgst.toLocaleString("en-IN")}
Total GST (18%): \u20B9${r.totalGST.toLocaleString("en-IN")}
`:""}

Generated on: ${new Date().toLocaleDateString("en-IN")}
    `}};n.\u0275fac=function(r){return new(r||n)(De(At))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();function NN(e,n){e&1&&(c(0,"div",44),d(1," Please enter a valid income amount "),l())}function BN(e,n){if(e&1){let i=be();c(0,"div",38)(1,"form",39)(2,"div")(3,"label",40),d(4,"Annual Income (\u20B9)"),l(),c(5,"input",41),N("input",function(r){G(i);let a=S();return H(a.onInputChange(r))})("blur",function(){G(i);let r=S();return H(r.onManualIncomeChange())}),l(),c(6,"div",42),d(7),l(),X(8,NN,2,0,"div",43),l()()()}if(e&2){let i,t=S();p(),w("formGroup",t.taxForm),p(6),jt(" Enter your total annual income for FY ",t.currentYear,"-",t.currentYear+1," "),p(),w("ngIf",((i=t.taxForm.get("manualIncome"))==null?null:i.invalid)&&((i=t.taxForm.get("manualIncome"))==null?null:i.touched))}}function LN(e,n){if(e&1&&(c(0,"div",45)(1,"div",46)(2,"div")(3,"div",47),d(4,"Income from Transactions"),l(),c(5,"div",48),d(6),l(),c(7,"div",49),d(8),l()(),c(9,"mat-icon",50),d(10,"check_circle"),l()()()),e&2){let i=S();p(6),z(i.formatCurrency(i.totalIncome)),p(2),jt(" Calculated from your income transactions for FY ",i.currentYear,"-",i.currentYear+1," ")}}function VN(e,n){e&1&&(c(0,"div",51)(1,"div",52),se(2,"mat-spinner",53),c(3,"span",54),d(4,"Calculating tax from your transactions..."),l()()())}function UN(e,n){if(e&1&&(c(0,"div",55)(1,"div",22)(2,"h4",56)(3,"mat-icon",57),d(4,"account_balance"),l(),d(5," Tax Calculation Summary "),l(),c(6,"div",58)(7,"div",59)(8,"span",54),d(9),l(),c(10,"span",60),d(11),l()(),c(12,"div",59)(13,"span",54),d(14,"Standard Deduction"),l(),c(15,"span",61),d(16),l()(),c(17,"div",62)(18,"span",63),d(19,"Taxable Income"),l(),c(20,"span",64),d(21),l()(),c(22,"div",59)(23,"span",54),d(24,"Income Tax"),l(),c(25,"span",65),d(26),l()(),c(27,"div",59)(28,"span",54),d(29,"Cess (4%)"),l(),c(30,"span",65),d(31),l()(),c(32,"div",66)(33,"span",67),d(34,"Total Tax Liability"),l(),c(35,"span",68),d(36),l()()()(),c(37,"div",22)(38,"h4",56)(39,"mat-icon",11),d(40,"info"),l(),d(41," Tax Details "),l(),c(42,"div",58)(43,"div",59)(44,"span",54),d(45,"Current Tax Slab"),l(),c(46,"span",69),d(47),l()(),c(48,"div",59)(49,"span",54),d(50,"Effective Tax Rate"),l(),c(51,"span",69),d(52),l()(),c(53,"div",59)(54,"span",54),d(55,"Monthly Tax"),l(),c(56,"span",70),d(57),l()(),c(58,"div",59)(59,"span",54),d(60,"Net Income After Tax"),l(),c(61,"span",71),d(62),l()(),c(63,"div",38)(64,"div",72)(65,"strong"),d(66,"Note:"),l(),d(67," This calculation uses the new tax regime with simplified rates and standard deduction of \u20B950,000. "),l()()()()()),e&2){let i=S();p(9),jt("Total Income (FY ",i.currentYear,"-",i.currentYear+1,")"),p(2),z(i.formatCurrency(i.taxCalculation.totalIncome)),p(5),z(i.formatCurrency(i.taxCalculation.totalDeductions)),p(5),z(i.formatCurrency(i.taxCalculation.taxableIncome)),p(5),z(i.formatCurrency(i.taxCalculation.incomeTax)),p(5),z(i.formatCurrency(i.taxCalculation.cess)),p(5),z(i.formatCurrency(i.taxCalculation.totalTaxLiability)),p(11),z(i.getCurrentTaxSlab()),p(5),oe("",i.taxCalculation.totalIncome>0?(i.taxCalculation.totalTaxLiability/i.taxCalculation.totalIncome*100).toFixed(2):"0","%"),p(5),z(i.formatCurrency(i.taxCalculation.totalTaxLiability/12)),p(5),z(i.formatCurrency(i.taxCalculation.totalIncome-i.taxCalculation.totalTaxLiability))}}function jN(e,n){if(e&1&&(c(0,"div",51)(1,"div",73)(2,"mat-icon",74),d(3,"account_balance_wallet"),l(),c(4,"h3",75),d(5),l(),c(6,"p",76),d(7),l(),c(8,"p",77),d(9),l()()()),e&2){let i=S();p(5),oe(" ",i.useManualIncome?"No Income Entered":"No Income Transactions Found"," "),p(2),oe(" ",i.useManualIncome?"Please enter your annual income to see the tax calculation.":"We couldn't find any income transactions for FY "+i.currentYear+"-"+(i.currentYear+1)+"."," "),p(2),oe(" ",i.useManualIncome?"Enter your income in the manual input field above.":"Add income transactions to see your tax calculation."," ")}}var mm=(()=>{let n=class n{constructor(t,r,a,o,s){this.auth=t,this.taxService=r,this.notificationService=a,this.store=o,this.fb=s,this.taxCalculation=null,this.transactions=[],this.totalIncome=0,this.currentYear=new Date().getFullYear(),this.useManualIncome=!1,this.isLoading=!1,this.subscriptions=[],this.taxForm=this.fb.group({manualIncome:[0,[Qe.required,Qe.min(0)]]})}ngOnInit(){this.loadTransactions()}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}loadTransactions(){var r;if((r=this.auth.currentUser)==null?void 0:r.uid){let a=this.store.select(An).pipe(qa(1)).subscribe({next:o=>{this.transactions=o,this.calculateTaxFromTransactions()},error:o=>{console.error("Error loading transactions:",o),this.notificationService.error("Failed to load transaction data")}});this.subscriptions.push(a)}}calculateTaxFromTransactions(){this.isLoading=!0;try{this.totalIncome=this.taxService.calculateTotalIncome(this.transactions,this.currentYear),this.calculateTax(),this.totalIncome>0&&this.notificationService.success("Tax calculation completed successfully!")}catch(t){console.error("Error calculating tax:",t),this.notificationService.error("Failed to calculate tax.")}finally{this.isLoading=!1}}calculateTax(){let t=this.getCurrentIncome();this.taxCalculation=this.taxService.calculateNewRegimeTax(t)}toggleIncomeSource(){if(this.useManualIncome=!this.useManualIncome,this.useManualIncome){let t=this.totalIncome>0?this.totalIncome:0;this.taxForm.patchValue({manualIncome:t}),setTimeout(()=>this.calculateTax(),0)}else this.calculateTax()}onManualIncomeChange(){if(this.useManualIncome){let t=this.taxForm.value.manualIncome;t!=null&&t>=0&&this.calculateTax()}}onInputChange(t){let r=t.target.value;if(this.useManualIncome&&r!==""){let a=parseFloat(r);!isNaN(a)&&a>=0&&(this.taxForm.patchValue({manualIncome:a}),this.calculateTax())}}getCurrentIncome(){if(this.useManualIncome){let t=this.taxForm.value.manualIncome;return t!=null&&t>=0?t:0}return this.totalIncome}formatCurrency(t){return`\u20B9${t.toLocaleString("en-IN")}`}getCurrentTaxSlab(){if(!this.taxCalculation)return"N/A";let t=this.taxService.getTaxSlabs("new"),r=this.taxCalculation.taxableIncome;for(let a of t)if(r<=a.maxIncome)return`${a.description} (${a.rate}%)`;return"Above \u20B915,00,000 (30%)"}isManualIncomeValid(){var t;return((t=this.taxForm.get("manualIncome"))==null?void 0:t.valid)||!1}};n.\u0275fac=function(r){return new(r||n)(q(pt),q(Yb),q(ht),q(wt),q(Ii))},n.\u0275cmp=Ve({type:n,selectors:[["app-tax"]],decls:127,vars:27,consts:[[1,"min-h-screen","bg-gray-50","p-4","sm:p-6","lg:p-8"],[1,"max-w-7xl","mx-auto"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-6","mb-6"],[1,"flex","flex-col","sm:flex-row","sm:justify-between","sm:items-center","gap-4"],[1,"flex-1"],[1,"text-2xl","sm:text-3xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600","text-sm","sm:text-base"],[1,"flex","items-center"],[1,"text-blue-600","mr-2"],[1,"text-blue-600","font-medium"],[1,"text-xl","font-semibold","text-gray-900","mb-4","flex","items-center"],[1,"text-green-600","mr-3"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4","mb-6"],["mat-raised-button","",1,"flex","items-center","justify-center","space-x-3","p-4","h-auto","min-h-[60px]","transition-all","duration-200","hover:shadow-md",3,"click","color"],[1,"text-xl"],[1,"text-left"],[1,"font-semibold"],[1,"text-xs","opacity-80"],["class","bg-blue-50 p-4 rounded-lg border border-blue-200",4,"ngIf"],["class","bg-green-50 p-4 rounded-lg border border-green-200",4,"ngIf"],["class","bg-white rounded-xl shadow-sm border border-gray-100 p-8 mb-6",4,"ngIf"],["class","grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",4,"ngIf"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-6"],[1,"text-lg","font-semibold","text-gray-900","mb-6","flex","items-center"],[1,"text-purple-600","mr-3"],[1,"overflow-x-auto","rounded-lg","border","border-gray-200"],[1,"w-full"],[1,"bg-gray-50"],[1,"px-4","py-3","text-left","font-semibold","text-gray-700","text-sm"],[1,"divide-y","divide-gray-200"],[1,"hover:bg-gray-50","transition-colors"],[1,"px-4","py-3","text-sm"],[1,"px-4","py-3","text-green-600","font-medium","text-sm"],[1,"hover:bg-red-50","transition-colors","bg-red-50"],[1,"px-4","py-3","font-medium","text-sm"],[1,"mt-6","p-4","bg-blue-50","rounded-lg","border","border-blue-200"],[1,"font-semibold","text-blue-800","mb-2"],[1,"text-sm","text-blue-700","space-y-1"],[1,"bg-blue-50","p-4","rounded-lg","border","border-blue-200"],[1,"space-y-4",3,"formGroup"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","number","formControlName","manualIncome","placeholder","Enter your annual income",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"input","blur"],[1,"text-xs","text-gray-500","mt-1"],["class","text-red-500 text-xs mt-1",4,"ngIf"],[1,"text-red-500","text-xs","mt-1"],[1,"bg-green-50","p-4","rounded-lg","border","border-green-200"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-green-800"],[1,"text-2xl","font-bold","text-green-700"],[1,"text-xs","text-green-600","mt-1"],[1,"text-green-600","text-3xl"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-8","mb-6"],[1,"flex","items-center","justify-center"],["diameter","40",1,"mr-4"],[1,"text-gray-600"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6","mb-6"],[1,"text-lg","font-semibold","text-gray-900","mb-4","flex","items-center"],[1,"text-blue-600","mr-3"],[1,"space-y-4"],[1,"flex","justify-between","items-center","py-3","border-b","border-gray-100"],[1,"font-semibold","text-gray-900","text-lg"],[1,"font-semibold","text-green-600","text-lg"],[1,"flex","justify-between","items-center","py-3","border-b-2","border-blue-200","bg-blue-50","px-4","rounded-lg"],[1,"text-gray-700","font-medium"],[1,"font-bold","text-blue-700","text-lg"],[1,"font-semibold","text-red-600","text-lg"],[1,"flex","justify-between","items-center","py-4","bg-red-50","px-4","rounded-lg","border-2","border-red-200"],[1,"text-gray-700","font-semibold"],[1,"font-bold","text-red-700","text-xl"],[1,"font-semibold","text-blue-600"],[1,"font-semibold","text-red-600"],[1,"font-semibold","text-green-600"],[1,"text-sm","text-blue-800"],[1,"text-center"],[1,"text-gray-400","text-6xl","mb-4"],[1,"text-xl","font-semibold","text-gray-700","mb-2"],[1,"text-gray-500","mb-4"],[1,"text-sm","text-gray-400"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),d(6,"Tax Analysis"),l(),c(7,"p",6),d(8),l()(),c(9,"div",7)(10,"mat-icon",8),d(11,"new_releases"),l(),c(12,"span",9),d(13,"New Regime"),l()()()(),c(14,"div",2)(15,"h3",10)(16,"mat-icon",11),d(17,"account_balance_wallet"),l(),d(18," Income Source "),l(),c(19,"div",12)(20,"button",13),N("click",function(){return a.toggleIncomeSource()}),c(21,"mat-icon",14),d(22,"sync"),l(),c(23,"div",15)(24,"div",16),d(25,"Auto from Transactions"),l(),c(26,"div",17),d(27,"Use your transaction data"),l()()(),c(28,"button",13),N("click",function(){return a.toggleIncomeSource()}),c(29,"mat-icon",14),d(30,"edit"),l(),c(31,"div",15)(32,"div",16),d(33,"Manual Entry"),l(),c(34,"div",17),d(35,"Enter income manually"),l()()()(),X(36,BN,9,4,"div",18)(37,LN,11,3,"div",19),l(),X(38,VN,5,0,"div",20)(39,UN,68,12,"div",21)(40,jN,10,3,"div",20),c(41,"div",22)(42,"h4",23)(43,"mat-icon",24),d(44,"table_chart"),l(),d(45),l(),c(46,"div",25)(47,"table",26)(48,"thead")(49,"tr",27)(50,"th",28),d(51,"Income Range"),l(),c(52,"th",28),d(53,"Tax Rate"),l(),c(54,"th",28),d(55,"Cess"),l(),c(56,"th",28),d(57,"Effective Rate"),l()()(),c(58,"tbody",29)(59,"tr",30)(60,"td",31),d(61,"Up to \u20B93,00,000"),l(),c(62,"td",32),d(63,"Nil"),l(),c(64,"td",31),d(65,"-"),l(),c(66,"td",32),d(67,"0%"),l()(),c(68,"tr",30)(69,"td",31),d(70,"\u20B93,00,001 - \u20B96,00,000"),l(),c(71,"td",31),d(72,"5%"),l(),c(73,"td",31),d(74,"4%"),l(),c(75,"td",31),d(76,"5.2%"),l()(),c(77,"tr",30)(78,"td",31),d(79,"\u20B96,00,001 - \u20B99,00,000"),l(),c(80,"td",31),d(81,"10%"),l(),c(82,"td",31),d(83,"4%"),l(),c(84,"td",31),d(85,"10.4%"),l()(),c(86,"tr",30)(87,"td",31),d(88,"\u20B99,00,001 - \u20B912,00,000"),l(),c(89,"td",31),d(90,"15%"),l(),c(91,"td",31),d(92,"4%"),l(),c(93,"td",31),d(94,"15.6%"),l()(),c(95,"tr",30)(96,"td",31),d(97,"\u20B912,00,001 - \u20B915,00,000"),l(),c(98,"td",31),d(99,"20%"),l(),c(100,"td",31),d(101,"4%"),l(),c(102,"td",31),d(103,"20.8%"),l()(),c(104,"tr",33)(105,"td",34),d(106,"Above \u20B915,00,000"),l(),c(107,"td",34),d(108,"30%"),l(),c(109,"td",31),d(110,"4%"),l(),c(111,"td",34),d(112,"31.2%"),l()()()()(),c(113,"div",35)(114,"h5",36),d(115,"New Regime Benefits:"),l(),c(116,"ul",37)(117,"li"),d(118,"\u2022 Standard deduction of \u20B950,000 automatically applied"),l(),c(119,"li"),d(120,"\u2022 Lower tax rates compared to old regime"),l(),c(121,"li"),d(122,"\u2022 No need to maintain investment proofs"),l(),c(123,"li"),d(124,"\u2022 Simplified tax filing process"),l(),c(125,"li"),d(126,"\u2022 No deductions except standard deduction"),l()()()()()()),r&2&&(p(8),jt("New Tax Regime calculation for FY ",a.currentYear,"-",a.currentYear+1,""),p(12),Je("bg-blue-600",!a.useManualIncome)("text-white",!a.useManualIncome)("bg-gray-100",a.useManualIncome)("text-gray-700",a.useManualIncome),w("color",a.useManualIncome?"basic":"primary"),p(8),Je("bg-blue-600",a.useManualIncome)("text-white",a.useManualIncome)("bg-gray-100",!a.useManualIncome)("text-gray-700",!a.useManualIncome),w("color",a.useManualIncome?"primary":"basic"),p(8),w("ngIf",a.useManualIncome),p(),w("ngIf",!a.useManualIncome),p(),w("ngIf",a.isLoading),p(),w("ngIf",!a.isLoading&&a.taxCalculation&&(a.useManualIncome?a.isManualIncomeValid():!0)),p(),w("ngIf",!a.isLoading&&a.getCurrentIncome()===0),p(5),jt(" New Tax Regime Slabs (FY ",a.currentYear,"-",a.currentYear+1,") "))},dependencies:[ct,jn,Vt,ki,Ut,Un,Ei,Ti,Ht,at,Xr]});let e=n;return e})();var $b=(e,n)=>n.value,WN=(e,n)=>n.id;function YN(e,n){if(e&1&&(c(0,"option",12),d(1),l()),e&2){let i=n.$implicit;w("value",i.value),p(),oe(" ",i.label," ")}}function $N(e,n){if(e&1&&(c(0,"option",12),d(1),l()),e&2){let i=n.$implicit;w("value",i.value),p(),oe(" ",i.label," ")}}function GN(e,n){if(e&1){let i=be();c(0,"span",29),d(1),c(2,"button",35),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.removeTag(r))}),c(3,"mat-icon",36),d(4,"close"),l()()()}if(e&2){let i=n.$implicit;p(),oe(" ",i," ")}}function HN(e,n){if(e&1){let i=be();c(0,"div",16)(1,"mat-card",17)(2,"div",18)(3,"h3",19),d(4,"Add New Note"),l(),c(5,"button",20),N("click",function(){G(i);let r=S();return H(r.cancelAddNote())}),c(6,"mat-icon"),d(7,"close"),l()()(),c(8,"div",21)(9,"div")(10,"label",22),d(11,"Title"),l(),c(12,"input",23),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.newNote.title,r)||(a.newNote.title=r),H(r)}),l()(),c(13,"div")(14,"label",22),d(15,"Content"),l(),c(16,"textarea",24),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.newNote.content,r)||(a.newNote.content=r),H(r)}),l()(),c(17,"div",25)(18,"div")(19,"label",22),d(20,"Category"),l(),c(21,"select",26),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.newNote.category,r)||(a.newNote.category=r),H(r)}),Ge(22,$N,2,2,"option",12,$b),l()(),c(24,"div")(25,"label",22),d(26,"Tags"),l(),c(27,"input",27),N("keyup.enter",function(r){G(i);let a=S();return H(a.addTag(r))}),l(),c(28,"div",28),Ge(29,GN,5,1,"span",29,Oi),l()()(),c(31,"div",30)(32,"mat-checkbox",31),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.newNote.isImportant,r)||(a.newNote.isImportant=r),H(r)}),d(33," Mark as Important "),l()(),c(34,"div",32)(35,"button",33),N("click",function(){G(i);let r=S();return H(r.cancelAddNote())}),d(36,"Cancel"),l(),c(37,"button",34),N("click",function(){G(i);let r=S();return H(r.saveNote())}),d(38,"Save Note"),l()()()()()}if(e&2){let i=S();p(12),ut("ngModel",i.newNote.title),p(4),ut("ngModel",i.newNote.content),p(5),ut("ngModel",i.newNote.category),p(),He(i.categories.slice(1)),p(7),He(i.newNote.tags),p(3),ut("ngModel",i.newNote.isImportant)}}function qN(e,n){if(e&1&&(c(0,"span",47),d(1),l()),e&2){let i=n.$implicit;p(),oe(" ",i," ")}}function XN(e,n){if(e&1){let i=be();c(0,"div",8)(1,"mat-card",37)(2,"div",0)(3,"div",38)(4,"div",39)(5,"h3",40),d(6),l(),c(7,"div",41)(8,"mat-icon",36),d(9),l(),c(10,"span"),d(11),l(),c(12,"span"),d(13,"\u2022"),l(),c(14,"span"),d(15),pe(16,"date"),l()()(),c(17,"div",42)(18,"button",43),N("click",function(){let r=G(i).$implicit,a=S();return H(a.toggleImportant(r))}),c(19,"mat-icon"),d(20),l()(),c(21,"button",44),N("click",function(){let r=G(i).$implicit,a=S();return H(a.deleteNote(r.id))}),c(22,"mat-icon"),d(23,"delete"),l()()()(),c(24,"p",45),d(25),l(),c(26,"div",46),Ge(27,qN,2,1,"span",47,Oi),l(),c(29,"div",48),d(30),pe(31,"date"),l()()()()}if(e&2){let i=n.$implicit,t=S();p(),Je("border-l-4",i.isImportant)("border-l-red-500",i.isImportant),p(5),z(i.title),p(3),z(t.getCategoryInfo(i.category).icon),p(2),z(t.getCategoryInfo(i.category).label),p(4),z(yt(16,13,i.createdAt,"MMM dd, yyyy")),p(3),Je("text-red-500",i.isImportant),p(2),z(i.isImportant?"star":"star_border"),p(5),z(i.content),p(2),He(i.tags),p(3),oe(" Last updated: ",yt(31,16,i.updatedAt,"MMM dd, yyyy HH:mm")," ")}}function KN(e,n){if(e&1){let i=be();c(0,"div",49)(1,"mat-icon",50),d(2,"note"),l(),c(3,"h3",51),d(4,"No notes found"),l(),c(5,"p",52),d(6),l(),c(7,"button",53),N("click",function(){G(i);let r=S();return H(r.addNote())}),c(8,"mat-icon"),d(9,"add"),l(),c(10,"span"),d(11,"Add Note"),l()()()}if(e&2){let i=S();p(6),oe(" ",i.searchTerm||i.selectedCategory!=="all"?"Try adjusting your search or filter criteria.":"Start by adding your first note to keep track of important information."," ")}}var gm=(()=>{let n=class n{constructor(t){this.notificationService=t,this.notes=[],this.filteredNotes=[],this.selectedCategory="all",this.searchTerm="",this.isAddingNote=!1,this.newNote={title:"",content:"",category:"personal",tags:[],isImportant:!1},this.categories=[{value:"all",label:"All Notes",icon:"note"},{value:"personal",label:"Personal",icon:"person"},{value:"financial",label:"Financial",icon:"account_balance_wallet"},{value:"tax",label:"Tax Related",icon:"receipt_long"},{value:"investment",label:"Investment",icon:"trending_up"},{value:"expenses",label:"Expenses",icon:"money_off"},{value:"goals",label:"Goals",icon:"flag"},{value:"documents",label:"Documents",icon:"description"}]}ngOnInit(){this.loadNotes()}loadNotes(){try{this.notes=[{id:"1",title:"Tax Planning Notes",content:"Remember to invest in ELSS for tax saving under section 80C. Also consider health insurance for 80D benefits.",category:"tax",tags:["tax","investment","planning"],createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-15"),isImportant:!0},{id:"2",title:"Monthly Budget Goals",content:"Target: Save 30% of income. Track expenses daily. Review budget every weekend.",category:"financial",tags:["budget","savings","goals"],createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-10"),isImportant:!0}],this.filteredNotes=[...this.notes]}catch(t){console.error("Error loading notes:",t),this.notificationService.error("Failed to load notes")}}filterNotes(){this.filteredNotes=this.notes.filter(t=>{let r=this.selectedCategory==="all"||t.category===this.selectedCategory,a=t.title.toLowerCase().includes(this.searchTerm.toLowerCase())||t.content.toLowerCase().includes(this.searchTerm.toLowerCase())||t.tags.some(o=>o.toLowerCase().includes(this.searchTerm.toLowerCase()));return r&&a})}onCategoryChange(){this.filterNotes()}onSearchChange(){this.filterNotes()}addNote(){this.isAddingNote=!0}saveNote(){if(!this.newNote.title||!this.newNote.content){this.notificationService.warning("Please fill in title and content");return}try{let t={id:Date.now().toString(),title:this.newNote.title,content:this.newNote.content,category:this.newNote.category,tags:this.newNote.tags,createdAt:new Date,updatedAt:new Date,isImportant:this.newNote.isImportant};this.notes.unshift(t),this.filterNotes(),this.resetNewNote(),this.isAddingNote=!1,this.notificationService.success("Note saved successfully")}catch(t){console.error("Error saving note:",t),this.notificationService.error("Failed to save note")}}cancelAddNote(){this.resetNewNote(),this.isAddingNote=!1,this.notificationService.info("Note creation cancelled")}resetNewNote(){this.newNote={title:"",content:"",category:"personal",tags:[],isImportant:!1}}deleteNote(t){try{let r=this.notes.find(a=>a.id===t);this.notes=this.notes.filter(a=>a.id!==t),this.filterNotes(),this.notificationService.success(`Note "${r==null?void 0:r.title}" deleted successfully`)}catch(r){console.error("Error deleting note:",r),this.notificationService.error("Failed to delete note")}}toggleImportant(t){try{t.isImportant=!t.isImportant,t.updatedAt=new Date;let r=t.isImportant?"marked as important":"unmarked as important";this.notificationService.success(`Note "${t.title}" ${r}`)}catch(r){console.error("Error updating note importance:",r),this.notificationService.error("Failed to update note importance")}}addTag(t){let r=t.target.value;r&&!this.newNote.tags.includes(r)?(this.newNote.tags.push(r),this.notificationService.info(`Tag "${r}" added`)):this.newNote.tags.includes(r)&&this.notificationService.warning("Tag already exists")}removeTag(t){this.newNote.tags=this.newNote.tags.filter(r=>r!==t),this.notificationService.info(`Tag "${t}" removed`)}exportNotes(){try{console.log("Export notes clicked"),this.notificationService.info("Export feature coming soon")}catch(t){console.error("Error exporting notes:",t),this.notificationService.error("Failed to export notes")}}importNotes(){try{console.log("Import notes clicked"),this.notificationService.info("Import feature coming soon")}catch(t){console.error("Error importing notes:",t),this.notificationService.error("Failed to import notes")}}getCategoryInfo(t){let r=this.categories.find(a=>a.value===t);return r?{icon:r.icon,label:r.label}:{icon:"note",label:"Unknown"}}};n.\u0275fac=function(r){return new(r||n)(q(ht))},n.\u0275cmp=Ve({type:n,selectors:[["app-notes"]],decls:37,vars:4,consts:[[1,"p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800","mb-1"],[1,"text-gray-600"],[1,"flex","space-x-3"],["mat-stroked-button","",1,"flex","items-center","space-x-2",3,"click"],["mat-raised-button","","color","primary",1,"flex","items-center","space-x-2",3,"click"],[1,"mb-6","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"relative"],[1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","text-gray-400"],["type","text","placeholder","Search notes...",1,"w-full","pl-10","pr-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","input","ngModel"],[1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","change","ngModel"],[3,"value"],["class","mb-6",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-2","xl:grid-cols-3","gap-6"],["class","text-center py-12",4,"ngIf"],[1,"mb-6"],[1,"p-6","shadow-lg","border-0","rounded-xl"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-lg","font-semibold","text-gray-800"],["mat-icon-button","",3,"click"],[1,"space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Enter note title...",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["placeholder","Enter note content...","rows","4",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["type","text","placeholder","Add tags (comma separated)...",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"keyup.enter"],[1,"flex","flex-wrap","gap-2","mt-2"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"flex","items-center"],[1,"mr-2",3,"ngModelChange","ngModel"],[1,"flex","justify-end","space-x-3"],["mat-stroked-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],[1,"ml-1","text-blue-600","hover:text-blue-800",3,"click"],[1,"text-xs"],[1,"h-full","shadow-lg","border-0","rounded-xl","hover:shadow-xl","transition-shadow"],[1,"flex","justify-between","items-start","mb-3"],[1,"flex-1"],[1,"text-lg","font-semibold","text-gray-800","mb-1"],[1,"flex","items-center","space-x-2","text-sm","text-gray-500"],[1,"flex","space-x-1"],["mat-icon-button","","matTooltip","Mark as important",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete note",3,"click"],[1,"text-gray-600","mb-4","line-clamp-3"],[1,"flex","flex-wrap","gap-2","mb-3"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-700"],[1,"text-xs","text-gray-400"],[1,"text-center","py-12"],[1,"text-gray-400","text-6xl","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-500","mb-4"],["mat-raised-button","","color","primary",1,"flex","items-center","space-x-2","mx-auto",3,"click"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),d(4,"Notes & Documents"),l(),c(5,"p",3),d(6,"Store and organize your financial notes, documents, and important information"),l()(),c(7,"div",4)(8,"button",5),N("click",function(){return a.importNotes()}),c(9,"mat-icon"),d(10,"upload"),l(),c(11,"span"),d(12,"Import"),l()(),c(13,"button",5),N("click",function(){return a.exportNotes()}),c(14,"mat-icon"),d(15,"download"),l(),c(16,"span"),d(17,"Export"),l()(),c(18,"button",6),N("click",function(){return a.addNote()}),c(19,"mat-icon"),d(20,"add"),l(),c(21,"span"),d(22,"Add Note"),l()()()(),c(23,"div",7)(24,"div",8)(25,"mat-icon",9),d(26,"search"),l(),c(27,"input",10),gt("ngModelChange",function(s){return mt(a.searchTerm,s)||(a.searchTerm=s),s}),N("input",function(){return a.onSearchChange()}),l()(),c(28,"div")(29,"select",11),gt("ngModelChange",function(s){return mt(a.selectedCategory,s)||(a.selectedCategory=s),s}),N("change",function(){return a.onCategoryChange()}),Ge(30,YN,2,2,"option",12,$b),l()()(),X(32,HN,39,4,"div",13),c(33,"div",14),Ge(34,XN,32,19,"div",8,WN),l(),X(36,KN,12,1,"div",15),l()),r&2&&(p(27),ut("ngModel",a.searchTerm),p(2),ut("ngModel",a.selectedCategory),p(),He(a.categories),p(2),w("ngIf",a.isAddingNote),p(2),He(a.filteredNotes),p(2),w("ngIf",a.filteredNotes.length===0&&!a.isAddingNote))},dependencies:[ct,Hs,qs,Vt,Gs,Ut,Zn,To,Ht,bn,at,Td,Jn,Vn],styles:[".line-clamp-3[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}"]});let e=n;return e})();var lr=Tr(Nr());var Xf=Tr(Nr());function JN(e,n){if(e&1&&(c(0,"div",33)(1,"mat-icon",34),d(2,"error_outline"),l(),c(3,"span",35),d(4),l()()),e&2){let i=S();p(4),z(i.errorMessage)}}var Kf=(()=>{let n=class n{constructor(t,r){this.dialogRef=t,this.data=r,this.startDate=null,this.endDate=null,this.errorMessage=""}ngOnInit(){var t,r;(t=this.data)!=null&&t.startDate&&(this.startDate=new Date(this.data.startDate)),(r=this.data)!=null&&r.endDate&&(this.endDate=new Date(this.data.endDate))}applyDateRange(){if(this.errorMessage="",!this.startDate||!this.endDate){this.errorMessage="Please select both start and end dates.";return}let t=(0,Xf.default)(this.startDate),r=(0,Xf.default)(this.endDate);if(!t.isValid()||!r.isValid()){this.errorMessage="Please enter valid dates.";return}if(r.isBefore(t)){this.errorMessage="End date must be on or after start date.";return}this.dialogRef.close({start:this.startDate,end:this.endDate})}onCancel(){this.dialogRef.close()}selectLast7Days(){let t=new Date,r=new Date;r.setDate(t.getDate()-6),this.startDate=r,this.endDate=t,this.errorMessage=""}selectLast30Days(){let t=new Date,r=new Date;r.setDate(t.getDate()-29),this.startDate=r,this.endDate=t,this.errorMessage=""}selectThisMonth(){let t=new Date,r=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);this.startDate=r,this.endDate=a,this.errorMessage=""}};n.\u0275fac=function(r){return new(r||n)(q(fi),q(pi))},n.\u0275cmp=Ve({type:n,selectors:[["app-custom-date-range-dialog"]],decls:76,vars:5,consts:[[1,"custom-date-range-dialog"],[1,"mobile-header"],[1,"header-content"],[1,"header-title"],[1,"header-actions"],["mat-icon-button","","color","primary","matTooltip","Apply Range",1,"apply-btn",3,"click","disabled"],["mat-icon-button","","matTooltip","Close",1,"close-btn",3,"click"],[1,"mobile-content"],[1,"content-wrapper"],[1,"date-range-card"],[1,"card-header"],[1,"card-icon"],[1,"card-title"],[1,"date-inputs-container"],[1,"date-input-group"],[1,"input-label"],[1,"label-icon"],[1,"date-input-wrapper"],["type","date","aria-label","Start date",1,"date-input",3,"ngModelChange","ngModel"],[1,"input-icon"],[1,"date-separator"],[1,"separator-line"],[1,"separator-icon"],["type","date","aria-label","End date",1,"date-input",3,"ngModelChange","ngModel"],["class","error-card","role","alert",4,"ngIf"],[1,"quick-actions-card"],[1,"quick-buttons"],["mat-stroked-button","","aria-label","Select last 7 days",1,"quick-btn",3,"click"],["mat-stroked-button","","aria-label","Select last 30 days",1,"quick-btn",3,"click"],["mat-stroked-button","","aria-label","Select this month",1,"quick-btn",3,"click"],[1,"action-buttons"],["mat-button","","aria-label","Cancel date selection",1,"cancel-btn",3,"click"],["mat-raised-button","","color","primary","aria-label","Apply selected date range",1,"apply-range-btn",3,"click","disabled"],["role","alert",1,"error-card"],[1,"error-icon"],[1,"error-text"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),d(4,"Select Date Range"),l(),c(5,"div",4)(6,"button",5),N("click",function(){return a.applyDateRange()}),c(7,"mat-icon"),d(8,"check"),l()(),c(9,"button",6),N("click",function(){return a.onCancel()}),c(10,"mat-icon"),d(11,"close"),l()()()()(),c(12,"div",7)(13,"div",8)(14,"div",9)(15,"div",10)(16,"mat-icon",11),d(17,"calendar_today"),l(),c(18,"span",12),d(19,"Date Range"),l()(),c(20,"div",13)(21,"div",14)(22,"label",15)(23,"mat-icon",16),d(24,"event"),l(),c(25,"span"),d(26,"Start Date"),l()(),c(27,"div",17)(28,"input",18),gt("ngModelChange",function(s){return mt(a.startDate,s)||(a.startDate=s),s}),l(),c(29,"mat-icon",19),d(30,"calendar_today"),l()()(),c(31,"div",20),se(32,"div",21),c(33,"mat-icon",22),d(34,"arrow_downward"),l(),se(35,"div",21),l(),c(36,"div",14)(37,"label",15)(38,"mat-icon",16),d(39,"event"),l(),c(40,"span"),d(41,"End Date"),l()(),c(42,"div",17)(43,"input",23),gt("ngModelChange",function(s){return mt(a.endDate,s)||(a.endDate=s),s}),l(),c(44,"mat-icon",19),d(45,"calendar_today"),l()()()()(),X(46,JN,5,1,"div",24),c(47,"div",25)(48,"div",10)(49,"mat-icon",11),d(50,"flash_on"),l(),c(51,"span",12),d(52,"Quick Select"),l()(),c(53,"div",26)(54,"button",27),N("click",function(){return a.selectLast7Days()}),c(55,"mat-icon"),d(56,"today"),l(),c(57,"span"),d(58,"Last 7 days"),l()(),c(59,"button",28),N("click",function(){return a.selectLast30Days()}),c(60,"mat-icon"),d(61,"calendar_month"),l(),c(62,"span"),d(63,"Last 30 days"),l()(),c(64,"button",29),N("click",function(){return a.selectThisMonth()}),c(65,"mat-icon"),d(66,"date_range"),l(),c(67,"span"),d(68,"This month"),l()()()(),c(69,"div",30)(70,"button",31),N("click",function(){return a.onCancel()}),d(71," Cancel "),l(),c(72,"button",32),N("click",function(){return a.applyDateRange()}),c(73,"mat-icon"),d(74,"check"),l(),d(75," Apply Range "),l()()()()()),r&2&&(p(6),w("disabled",!a.startDate||!a.endDate),p(22),ut("ngModel",a.startDate),p(15),ut("ngModel",a.endDate),p(3),w("ngIf",a.errorMessage),p(26),w("disabled",!a.startDate||!a.endDate))},dependencies:[ct,Vt,Ut,Zn,Ht,bn,at,Jn],styles:[".custom-date-range-dialog[_ngcontent-%COMP%]{width:100%;height:100vh;max-width:100vw;background:#f8fafc;display:flex;flex-direction:column;overflow:hidden}.mobile-header[_ngcontent-%COMP%]{position:sticky;top:0;z-index:20;background:#fff;border-bottom:1px solid #e2e8f0;box-shadow:0 1px 3px #0000001a;padding:12px 16px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#1f2937;flex:1}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;background:#3b82f6;color:#fff;transition:all .2s ease}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb;transform:translateY(-1px);box-shadow:0 2px 8px #3b82f64d}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]:disabled{background:#9ca3af;color:#6b7280}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;color:#6b7280;transition:all .2s ease}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.mobile-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;background:#f8fafc}.mobile-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{padding:16px;display:flex;flex-direction:column;gap:16px}.date-range-card[_ngcontent-%COMP%], .quick-actions-card[_ngcontent-%COMP%], .error-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a;overflow:hidden}.card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:16px;border-bottom:1px solid #f3f4f6}.card-header[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:#3b82f6}.card-header[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1f2937}.date-range-card[_ngcontent-%COMP%]   .date-inputs-container[_ngcontent-%COMP%]{padding:16px;display:flex;flex-direction:column;gap:20px}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:14px;font-weight:500;color:#374151}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]   .label-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#3b82f6}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .date-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .date-input-wrapper[_ngcontent-%COMP%]   .date-input[_ngcontent-%COMP%]{width:100%;padding:12px 48px 12px 16px;border:1px solid #d1d5db;border-radius:8px;font-size:16px;color:#1f2937;background:#fff;transition:all .2s ease}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .date-input-wrapper[_ngcontent-%COMP%]   .date-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .date-input-wrapper[_ngcontent-%COMP%]   .date-input[_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{opacity:0;position:absolute;right:0;top:0;width:100%;height:100%;cursor:pointer}.date-range-card[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   .date-input-wrapper[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{position:absolute;right:12px;color:#9ca3af;font-size:20px;width:20px;height:20px;pointer-events:none}.date-range-card[_ngcontent-%COMP%]   .date-separator[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;margin:8px 0}.date-range-card[_ngcontent-%COMP%]   .date-separator[_ngcontent-%COMP%]   .separator-line[_ngcontent-%COMP%]{flex:1;height:1px;background:linear-gradient(90deg,transparent,#d1d5db,transparent);max-width:60px}.date-range-card[_ngcontent-%COMP%]   .date-separator[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#9ca3af;transform:rotate(90deg)}.error-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;padding:16px;background:#fef2f2;border:1px solid #fecaca}.error-card[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:#dc2626;flex-shrink:0;margin-top:2px}.error-card[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{font-size:14px;color:#dc2626;line-height:1.4;flex:1}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]{padding:16px;display:flex;flex-direction:column;gap:12px}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;border:1px solid #d1d5db;border-radius:8px;background:#fff;color:#374151;font-size:14px;font-weight:500;transition:all .2s ease;text-align:left}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#3b82f6;color:#3b82f6;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#6b7280}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1}.action-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;padding:16px 0}.action-buttons[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{padding:12px 24px;border:1px solid #d1d5db;border-radius:8px;background:#fff;color:#6b7280;font-size:16px;font-weight:500;transition:all .2s ease}.action-buttons[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#9ca3af;color:#374151}.action-buttons[_ngcontent-%COMP%]   .apply-range-btn[_ngcontent-%COMP%]{padding:12px 24px;border-radius:8px;background:#3b82f6;color:#fff;font-size:16px;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .2s ease}.action-buttons[_ngcontent-%COMP%]   .apply-range-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb;transform:translateY(-1px);box-shadow:0 4px 12px #3b82f64d}.action-buttons[_ngcontent-%COMP%]   .apply-range-btn[_ngcontent-%COMP%]:disabled{background:#9ca3af;color:#6b7280}.action-buttons[_ngcontent-%COMP%]   .apply-range-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}@media (max-width: 480px){.mobile-header[_ngcontent-%COMP%]{padding:12px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:16px}.mobile-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{padding:12px;gap:12px}.date-range-card[_ngcontent-%COMP%]   .date-inputs-container[_ngcontent-%COMP%]{padding:12px;gap:16px}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]{padding:12px;gap:8px}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]{padding:10px 12px;font-size:13px}.quick-actions-card[_ngcontent-%COMP%]   .quick-buttons[_ngcontent-%COMP%]   .quick-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.action-buttons[_ngcontent-%COMP%]{gap:8px}.action-buttons[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%], .action-buttons[_ngcontent-%COMP%]   .apply-range-btn[_ngcontent-%COMP%]{padding:10px 20px;font-size:14px}}@media (max-width: 360px){.mobile-header[_ngcontent-%COMP%]{padding:8px 12px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{gap:8px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:15px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{gap:4px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%], .mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{width:36px;height:36px}.mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .mobile-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.mobile-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{padding:8px;gap:8px}.card-header[_ngcontent-%COMP%]{padding:12px}.card-header[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.card-header[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:14px}}"]});let e=n;return e})();var Gb=(e,n)=>n.id,QN=(e,n)=>n.value,eB=(e,n)=>n.categoryId;function tB(e,n){if(e&1){let i=be();c(0,"div",31)(1,"div",32)(2,"mat-icon",33),d(3,"filter_alt"),l(),c(4,"span",34),d(5),l()(),c(6,"div",35)(7,"mat-icon",36),N("click",function(){G(i);let r=S(2);return H(r.quickClearFilters())}),d(8,"clear"),l()()()}if(e&2){let i=S(2);p(5),jt("",i.getActiveFiltersCount()," Filter",i.getActiveFiltersCount()>1?"s":""," Active")}}function nB(e,n){if(e&1){let i=be();c(0,"button",37),N("click",function(){G(i);let r=S(2);return H(r.onSearchChange(""))}),c(1,"mat-icon"),d(2,"close"),l()()}}function iB(e,n){e&1&&(c(0,"mat-icon",38),d(1,"check"),l())}function rB(e,n){if(e&1){let i=be();c(0,"button",24),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.onSortChange(r.value))}),c(1,"mat-icon"),d(2),l(),c(3,"span"),d(4),l(),X(5,iB,2,0,"mat-icon",38),l()}if(e&2){let i=n.$implicit,t=S(2);Je("active-menu-item",t.selectedSort===i.value),p(2),z(i.icon),p(2),z(i.label),p(),ot(t.selectedSort===i.value?5:-1)}}function aB(e,n){e&1&&(c(0,"mat-icon",38),d(1,"check"),l())}function oB(e,n){e&1&&(c(0,"mat-icon",38),d(1,"check"),l())}function sB(e,n){e&1&&(c(0,"mat-icon",38),d(1,"check"),l())}function cB(e,n){e&1&&(c(0,"mat-icon",38),d(1,"check"),l())}function lB(e,n){e&1&&(c(0,"mat-icon",38),d(1,"check"),l())}function dB(e,n){if(e&1){let i=be();c(0,"button",24),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.onCategoryChange(r.id))}),c(1,"mat-icon"),d(2),l(),c(3,"span"),d(4),l(),X(5,lB,2,0,"mat-icon",38),l()}if(e&2){let i=n.$implicit,t=S(2);Je("active-menu-item",t.isCategorySelected(i.id)),p(2),z(i.icon),p(2),z(i.name),p(),ot(t.isCategorySelected(i.id)?5:-1)}}function uB(e,n){e&1&&(c(0,"mat-icon",38),d(1,"check"),l())}function mB(e,n){e&1&&(c(0,"mat-icon",38),d(1,"check"),l())}function gB(e,n){e&1&&(c(0,"mat-icon",38),d(1,"check"),l())}function fB(e,n){e&1&&(c(0,"mat-icon",38),d(1,"check"),l())}function pB(e,n){e&1&&(c(0,"mat-icon",38),d(1,"check"),l())}function hB(e,n){if(e&1){let i=be();c(0,"div",11),X(1,tB,9,2,"div",12),c(2,"div",13)(3,"div",14)(4,"mat-icon",15),d(5,"search"),l(),c(6,"input",16),N("ngModelChange",function(r){G(i);let a=S();return H(a.onSearchChange(r))}),l(),X(7,nB,3,0,"button",17),l()(),c(8,"div",18)(9,"button",19)(10,"mat-icon"),d(11,"sort"),l(),c(12,"span",20),d(13),l()(),c(14,"mat-menu",21,0),Ge(16,rB,6,5,"button",22,QN),l(),c(18,"button",23)(19,"mat-icon"),d(20,"account_balance_wallet"),l(),c(21,"span",20),d(22),l()(),c(23,"mat-menu",21,1)(25,"button",24),N("click",function(){G(i);let r=S();return H(r.onTypeChange("all"))}),c(26,"mat-icon"),d(27,"list"),l(),c(28,"span"),d(29,"All Types"),l(),X(30,aB,2,0,"mat-icon",25),l(),c(31,"button",24),N("click",function(){G(i);let r=S();return H(r.onTypeChange("income"))}),c(32,"mat-icon",26),d(33,"trending_up"),l(),c(34,"span"),d(35,"Income"),l(),X(36,oB,2,0,"mat-icon",25),l(),c(37,"button",24),N("click",function(){G(i);let r=S();return H(r.onTypeChange("expense"))}),c(38,"mat-icon",27),d(39,"trending_down"),l(),c(40,"span"),d(41,"Expense"),l(),X(42,sB,2,0,"mat-icon",25),l()(),c(43,"button",28)(44,"mat-icon"),d(45,"category"),l(),c(46,"span",20),d(47),l()(),c(48,"mat-menu",21,2)(50,"button",24),N("click",function(){G(i);let r=S();return H(r.onCategoryChange("all"))}),c(51,"mat-icon"),d(52,"list"),l(),c(53,"span"),d(54,"All Categories"),l(),X(55,cB,2,0,"mat-icon",25),l(),se(56,"mat-divider"),Ge(57,dB,6,5,"button",22,Gb),l(),c(59,"button",29)(60,"mat-icon"),d(61,"calendar_today"),l(),c(62,"span",20),d(63),l()(),c(64,"mat-menu",21,3)(66,"button",24),N("click",function(){G(i);let r=S();return H(r.onDateRangeChange(null))}),c(67,"mat-icon"),d(68,"all_inclusive"),l(),c(69,"span"),d(70,"All Time"),l(),X(71,uB,2,0,"mat-icon",25),l(),c(72,"button",24),N("click",function(){G(i);let r=S();return H(r.onDateRangeChange("this-month"))}),c(73,"mat-icon"),d(74,"calendar_month"),l(),c(75,"span"),d(76,"This Month"),l(),X(77,mB,2,0,"mat-icon",25),l(),c(78,"button",24),N("click",function(){G(i);let r=S();return H(r.onDateRangeChange("last-month"))}),c(79,"mat-icon"),d(80,"calendar_view_month"),l(),c(81,"span"),d(82,"Last Month"),l(),X(83,gB,2,0,"mat-icon",25),l(),c(84,"button",24),N("click",function(){G(i);let r=S();return H(r.onDateRangeChange("this-year"))}),c(85,"mat-icon"),d(86,"calendar_today"),l(),c(87,"span"),d(88,"This Year"),l(),X(89,fB,2,0,"mat-icon",25),l(),se(90,"mat-divider"),c(91,"button",24),N("click",function(){G(i);let r=S();return H(r.openCustomDateRangeDialog())}),c(92,"mat-icon"),d(93,"date_range"),l(),c(94,"span"),d(95,"Custom Range"),l(),X(96,pB,2,0,"mat-icon",25),l()(),c(97,"button",30),N("click",function(){G(i);let r=S();return H(r.openImportDialog())}),c(98,"mat-icon"),d(99,"upload_file"),l(),c(100,"span",20),d(101,"Import"),l()()()()}if(e&2){let i=Gn(15),t=Gn(24),r=Gn(49),a=Gn(65),o=S();p(),w("ngIf",o.hasActiveFilters()),p(5),w("ngModel",o.searchTerm),p(),w("ngIf",o.searchTerm),p(2),fa("matTooltip",o.getCurrentSortLabel()),w("matMenuTriggerFor",i),p(4),z(o.getCurrentSortLabel()),p(3),He(o.sortOptions),p(2),fa("matTooltip",o.getCurrentTypeLabel()),w("matMenuTriggerFor",t),p(4),z(o.getCurrentTypeLabel()),p(3),Je("active-menu-item",o.selectedType==="all"),p(5),w("ngIf",o.selectedType==="all"),p(),Je("active-menu-item",o.selectedType==="income"),p(5),w("ngIf",o.selectedType==="income"),p(),Je("active-menu-item",o.selectedType==="expense"),p(5),w("ngIf",o.selectedType==="expense"),p(),fa("matTooltip",o.getCurrentCategoryLabel()),w("matMenuTriggerFor",r),p(4),z(o.getCurrentCategoryLabel()),p(3),Je("active-menu-item",o.selectedCategory.includes("all")),p(5),w("ngIf",o.selectedCategory.includes("all")),p(2),He(o.getCategoriesList()),p(2),fa("matTooltip",o.getCurrentDateLabel()),w("matMenuTriggerFor",a),p(4),z(o.getCurrentDateLabel()),p(3),Je("active-menu-item",o.selectedDateRange===null),p(5),w("ngIf",o.selectedDateRange===null),p(),Je("active-menu-item",o.isCurrentMonth()),p(5),w("ngIf",o.isCurrentMonth()),p(),Je("active-menu-item",o.isLastMonth()),p(5),w("ngIf",o.isLastMonth()),p(),Je("active-menu-item",o.isCurrentYear()),p(5),w("ngIf",o.isCurrentYear()),p(2),Je("active-menu-item",o.isCustomDateRange()),p(5),w("ngIf",o.isCustomDateRange())}}function xB(e,n){if(e&1&&(c(0,"div",39)(1,"div",40)(2,"div",41)(3,"span",42),d(4),l(),c(5,"span",43),d(6),l()(),c(7,"div",41)(8,"span",44),d(9),pe(10,"number"),l()(),c(11,"div",41)(12,"span",45),d(13),pe(14,"number"),l()()()()),e&2){let i=S();p(4),z(i.getFilteredCount()),p(2),oe("/ ",i.getTotalCount(),""),p(3),oe("+\u20B9",yt(10,4,i.getTotalIncome(),"1.0-0"),""),p(4),oe("-\u20B9",yt(14,7,i.getTotalExpenses(),"1.0-0"),"")}}function _B(e,n){if(e&1){let i=be();c(0,"button",52),N("click",function(){G(i);let r=S(2);return H(r.onAddTransaction())}),c(1,"mat-icon"),d(2,"add"),l(),c(3,"span",53),d(4,"Add First Transaction"),l()()}}function CB(e,n){if(e&1){let i=be();c(0,"button",54),N("click",function(){G(i);let r=S(2);return H(r.clearAllFilters())}),c(1,"mat-icon"),d(2,"clear"),l(),c(3,"span",53),d(4,"Clear Filters"),l()()}}function vB(e,n){if(e&1&&(c(0,"div",46)(1,"div",47)(2,"mat-icon"),d(3,"receipt_long"),l()(),c(4,"h3",48),d(5,"No transactions found"),l(),c(6,"p",49),d(7),l(),X(8,_B,5,0,"button",50)(9,CB,5,0,"button",51),l()),e&2){let i=S();p(7),oe(" ",i.allTransactions.length===0?"Start by adding your first transaction":"No transactions match your current filters. Try adjusting your search or filters."," "),p(),w("ngIf",i.allTransactions.length===0),p(),w("ngIf",i.allTransactions.length>0&&i.hasActiveFilters())}}function bB(e,n){e&1&&(c(0,"mat-icon",59),d(1,"bookmark"),l())}function yB(e,n){e&1&&(c(0,"mat-icon",60),d(1,"category"),l())}function MB(e,n){if(e&1&&(c(0,"div",70),d(1),l()),e&2){let i=S().$implicit;p(),oe(" ",i.notes," ")}}function wB(e,n){if(e&1){let i=be();c(0,"div",71)(1,"div",72)(2,"button",73),N("click",function(){G(i);let r=S().$implicit,a=S();return H(a.onEditTransaction(r))}),c(3,"mat-icon"),d(4,"edit"),l()(),c(5,"button",74),N("click",function(){G(i);let r=S().$implicit,a=S();return H(a.onDeleteTransaction(r))}),c(6,"mat-icon"),d(7,"delete"),l()()()()}}function SB(e,n){if(e&1&&(c(0,"span",87),d(1),l()),e&2){let i=S(2).$implicit,t=S();p(),oe("(",t.getAccountType(i.accountId),")")}}function PB(e,n){if(e&1&&(c(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"fingerprint"),l(),c(4,"span"),d(5,"Transaction ID"),l()(),c(6,"div",80)(7,"span",88),d(8),l()()()),e&2){let i=S(2).$implicit;p(8),z(i.id)}}function OB(e,n){if(e&1&&(c(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"repeat"),l(),c(4,"span"),d(5,"Recurring"),l()(),c(6,"div",80)(7,"span",89),d(8),l()()()),e&2){let i=S(2).$implicit,t=S();p(8),z(t.getRecurringInfo(i))}}function kB(e,n){if(e&1&&(c(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"note"),l(),c(4,"span"),d(5,"Notes"),l()(),c(6,"div",80)(7,"span",90),d(8),l()()()),e&2){let i=S(2).$implicit;p(8),z(i.notes)}}function EB(e,n){if(e&1&&(c(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"payment"),l(),c(4,"span"),d(5,"Payment Method"),l()(),c(6,"div",80)(7,"span",91),d(8),l()()()),e&2){let i=S(2).$implicit;p(8),z(i.paymentMethod)}}function TB(e,n){if(e&1&&(c(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"payment"),l(),c(4,"span"),d(5,"Tax Amount"),l()(),se(6,"div",80),c(7,"span",92),d(8),pe(9,"number"),l()()),e&2){let i=S(2).$implicit;p(8),z(yt(9,1,i.taxAmount,"1.0-0"))}}function IB(e,n){if(e&1&&(c(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"payment"),l(),c(4,"span"),d(5,"Tax Percentage"),l()(),c(6,"div",80)(7,"span",93),d(8),l()()()),e&2){let i=S(2).$implicit;p(8),oe("",i.taxPercentage,"%")}}function AB(e,n){if(e&1&&(c(0,"div",95)(1,"span",96),d(2),l(),c(3,"span",97),d(4),l()()),e&2){let i=n.$implicit;p(2),z(i.categoryName),p(2),jt("\u20B9",i.amount.toFixed(2)," (",i.percentage.toFixed(1),"%)")}}function DB(e,n){if(e&1&&(c(0,"div",77)(1,"div",78)(2,"mat-icon",79),d(3,"category"),l(),c(4,"span"),d(5,"Category Splits"),l()(),c(6,"div",80)(7,"div",94),Ge(8,AB,5,3,"div",95,eB),l()()()),e&2){let i=S(2).$implicit;p(8),He(i.categorySplits)}}function FB(e,n){if(e&1&&(c(0,"div",75)(1,"div",76)(2,"div",77)(3,"div",78)(4,"mat-icon",79),d(5,"account_balance"),l(),c(6,"span"),d(7,"Account"),l()(),c(8,"div",80)(9,"span",81),d(10),l(),X(11,SB,2,1,"span",82),l()(),X(12,PB,9,1,"div",83)(13,OB,9,1,"div",83),c(14,"div",77)(15,"div",78)(16,"mat-icon",79),d(17),l(),c(18,"span"),d(19,"Status"),l()(),c(20,"div",80)(21,"span",84),d(22),l()()(),c(23,"div",77)(24,"div",78)(25,"mat-icon",79),d(26,"schedule"),l(),c(27,"span"),d(28,"Created Date"),l()(),c(29,"div",80)(30,"span",85),d(31),pe(32,"date"),l()()(),c(33,"div",77)(34,"div",78)(35,"mat-icon",79),d(36,"schedule"),l(),c(37,"span"),d(38,"Created Time"),l()(),c(39,"div",80)(40,"span",86),d(41),pe(42,"date"),l()()(),X(43,kB,9,1,"div",83)(44,EB,9,1,"div",83)(45,TB,10,4,"div",83),l(),X(46,IB,9,1,"div",83)(47,DB,10,0,"div",83),l()),e&2){let i=S().$implicit,t=S();p(10),z(t.getAccountName(i.accountId)),p(),w("ngIf",t.getAccountType(i.accountId)),p(),w("ngIf",i.id),p(),w("ngIf",i.isRecurring),p(3),Xt("color",t.getSyncStatusColor(i)),p(),z(t.getSyncStatusIcon(i)),p(4),Xt("color",t.getSyncStatusColor(i)),p(),z(t.getSyncStatusInfo(i)),p(9),z(yt(32,17,t.dateService.toDate(i.date),"fullDate")),p(10),z(yt(42,20,t.dateService.toDate(i.date),"shortTime")),p(2),w("ngIf",i.notes&&i.notes.trim()),p(),w("ngIf",i.paymentMethod),p(),w("ngIf",i.taxAmount),p(),w("ngIf",i.taxPercentage),p(),w("ngIf",i.isCategorySplit&&(i.categorySplits==null?null:i.categorySplits.length))}}function RB(e,n){if(e&1){let i=be();c(0,"div",55),N("click",function(){let r=G(i).$implicit,a=S();return H(a.onLongPress(r))}),c(1,"div",56)(2,"div",57)(3,"div",58)(4,"mat-icon"),d(5),l(),X(6,bB,2,0,"mat-icon",59)(7,yB,2,0,"mat-icon",60),l()(),c(8,"div",61)(9,"div",62),d(10),pe(11,"titlecase"),l(),c(12,"div",63),d(13),pe(14,"date"),l(),X(15,MB,2,1,"div",64),l(),c(16,"div",65)(17,"div",66),d(18),pe(19,"number"),l(),c(20,"div",67),d(21),l()()(),X(22,wB,8,0,"div",68)(23,FB,48,23,"div",69),l()}if(e&2){let i=n.$implicit,t=S();Je("selected",(t.selectedTx==null?null:t.selectedTx.id)===i.id),p(4),Xt("color",t.getCategoryColor(i.categoryId)),p(),oe(" ",t.getCategoryIcon(i.categoryId)," "),p(),ot(i.isSplitTransaction?6:-1),p(),ot(i.isCategorySplit?7:-1),p(3),oe(" ",Ee(11,16,i.payee)," "),p(3),oe(" ",yt(14,18,t.dateService.toDate(i.date),"dd MMM - hh:mm")," "),p(2),w("ngIf",i.notes),p(2),w("ngClass",i.type==="income"?"income-text":"expense-text"),p(),jt(" ",i.type==="income"?"+":"-","\u20B9",yt(19,21,i.amount,"1.0-0")," "),p(3),oe(" ",t.getCategoryName(i.categoryId)," "),p(),w("ngIf",(t.selectedTx==null?null:t.selectedTx.id)===i.id),p(),w("ngIf",(t.selectedTx==null?null:t.selectedTx.id)===i.id)}}var Hb=(()=>{let n=class n{constructor(t,r,a,o,s,u,m){this.auth=t,this.route=r,this.dialog=a,this.dateService=o,this.store=s,this.filterService=u,this.categoryService=m,this.editTransaction=new $n,this.deleteTransaction=new $n,this.addTransaction=new $n,this.importTransactions=new $n,this.selectedTx=null,this.filteredTransactions=[],this.selectedSort="date-desc",this.showFilters=!1,this.accounts=[],this.searchTerm="",this.selectedCategory=["all"],this.selectedType="all",this.selectedDate=null,this.selectedDateRange=null,this.sortOptions=[{value:"date-desc",label:"Newest First",icon:"schedule"},{value:"date-asc",label:"Oldest First",icon:"schedule"},{value:"amount-desc",label:"Highest Amount",icon:"trending_up"},{value:"amount-asc",label:"Lowest Amount",icon:"trending_down"},{value:"payee-asc",label:"Payee A-Z",icon:"sort_by_alpha"},{value:"category-asc",label:"Category A-Z",icon:"category"}],this.subscription=new Pi,this.destroy$=new vn,this.categories=[],this.transactions$=this.store.select(An),this.allTransactions=[]}ngOnInit(){this.setupFilterServiceSubscriptions(),this.setupTransactionSubscriptions(),this.loadUserCategories(),this.loadUserAccounts(),this.route.url.includes("transactions")&&(this.showFilters=!0)}ngOnDestroy(){this.subscription.unsubscribe(),this.destroy$.next(),this.destroy$.complete()}setupTransactionSubscriptions(){this.subscription.add(this.transactions$.subscribe(t=>{this.allTransactions=t.sort((r,a)=>{var u,m;let o=this.dateService.toDate(r.date),s=this.dateService.toDate(a.date);return((u=s==null?void 0:s.getTime())!=null?u:0)-((m=o==null?void 0:o.getTime())!=null?m:0)}),this.filterTransactions()}))}setupFilterServiceSubscriptions(){this.subscription.add(this.filterService.searchTerm$.subscribe(t=>{this.searchTerm=t,this.filterTransactions()})),this.subscription.add(this.filterService.selectedCategory$.subscribe(t=>{this.selectedCategory=t,this.filterTransactions()})),this.subscription.add(this.filterService.selectedType$.subscribe(t=>{this.selectedType=t,this.filterTransactions()})),this.subscription.add(this.filterService.selectedDate$.subscribe(t=>{this.selectedDate=t,this.filterTransactions()})),this.subscription.add(this.filterService.selectedDateRange$.subscribe(t=>{this.selectedDateRange=t,this.filterTransactions()}))}filterTransactions(){let t;this.filterService.getSelectedDate()||this.filterService.getSelectedDateRange()?t=this.filterService.filterTransactions(this.allTransactions,this.filterService.getCurrentFilterState()):t=this.filterService.filterCurrentYearTransactions(this.allTransactions,this.filterService.getCurrentFilterState());let a=this.filterService.sortTransactions(t,this.selectedSort);this.filteredTransactions=a}onSearchChange(t){this.filterService.setSearchTerm(t)}onSortChange(t){this.selectedSort=t,this.filterTransactions()}onTypeChange(t){this.filterService.setSelectedType(t)}onCategoryChange(t){t==="all"?this.filterService.setSelectedCategory(["all"]):this.filterService.setSelectedCategory([t])}onDateRangeChange(t){if(!t){this.filterService.clearSelectedDate();return}let r=(0,lr.default)(),a,o;switch(t){case"today":a=r.startOf("day").toDate(),o=r.endOf("day").toDate();break;case"yesterday":a=r.subtract(1,"day").startOf("day").toDate(),o=r.endOf("day").toDate();break;case"this-week":a=r.startOf("week").toDate(),o=r.endOf("week").toDate();break;case"last-week":a=r.subtract(1,"week").startOf("week").toDate(),o=r.subtract(1,"week").endOf("week").toDate();break;case"this-month":a=r.startOf("month").toDate(),o=r.endOf("month").toDate();break;case"last-month":a=r.subtract(1,"month").startOf("month").toDate(),o=r.subtract(1,"month").endOf("month").toDate();break;case"this-year":a=r.startOf("year").toDate(),o=r.endOf("year").toDate();break;default:return}this.filterService.setSelectedDateRange(a,o)}isCurrentMonth(){let t=(0,lr.default)().month(),r=(0,lr.default)().year();return this.filteredTransactions.some(a=>{let o=(0,lr.default)(this.dateService.toDate(a.date));return o.month()===t&&o.year()===r})}isLastMonth(){let t=(0,lr.default)().subtract(1,"month").month(),r=(0,lr.default)().subtract(1,"month").year();return this.filteredTransactions.some(a=>{let o=(0,lr.default)(this.dateService.toDate(a.date));return o.month()===t&&o.year()===r})}isCurrentYear(){let t=(0,lr.default)().year();return this.filteredTransactions.some(r=>(0,lr.default)(this.dateService.toDate(r.date)).year()===t)}hasActiveFilters(){return this.filterService.hasActiveFilters()}getCurrentSortLabel(){let t=this.sortOptions.find(r=>r.value===this.selectedSort);return t?t.label:"Sort"}getCurrentTypeLabel(){switch(this.selectedType){case"income":return"Income";case"expense":return"Expense";default:return"All Types"}}getCurrentCategoryLabel(){if(this.selectedCategory.includes("all"))return"All Categories";let t=this.categories.find(r=>r.id===this.selectedCategory[0]);return t?t.name:"Unknown Category"}getCurrentDateLabel(){if(this.selectedDate)return(0,lr.default)(this.selectedDate).format("MMM DD, YYYY");if(this.selectedDateRange){let t=(0,lr.default)(this.selectedDateRange.startDate).format("MMM DD"),r=(0,lr.default)(this.selectedDateRange.endDate).format("MMM DD, YYYY");return`${t} - ${r}`}return"All Dates"}onLongPress(t){this.selectedTx=t}onEditTransaction(t){this.editTransaction.emit(t)}onDeleteTransaction(t){this.dialog.open(Kr,{width:"300px",data:{title:"Delete Transaction",message:"Are you sure you want to delete this transaction?",confirmText:"Delete",cancelText:"Cancel"}}).afterClosed().subscribe(r=>{r&&this.deleteTransaction.emit(t)})}onAddTransaction(){this.addTransaction.emit()}onImportTransactions(){this.importTransactions.emit()}getTotalIncome(){return this.filteredTransactions.filter(t=>t.type==="income").reduce((t,r)=>t+r.amount,0)}getTotalExpenses(){return this.filteredTransactions.filter(t=>t.type==="expense").reduce((t,r)=>t+r.amount,0)}getNetAmount(){return this.getTotalIncome()-this.getTotalExpenses()}getCategoriesList(){return this.categories.map(t=>le(ae({},t),{id:t.id||""}))}getFilteredCount(){return this.filteredTransactions.length}getTotalCount(){return this.allTransactions.length}getCurrentYear(){return(0,lr.default)().year()}getCategoryIcon(t){let r=this.categories.find(a=>a.id===t);return(r==null?void 0:r.icon)||"category"}getCategoryColor(t){let r=this.categories.find(a=>a.id===t);return(r==null?void 0:r.color)||"#46777f"}loadUserCategories(){return ue(this,null,function*(){this.subscription.add(this.store.select(Ri).subscribe(t=>{this.categories=t}))})}loadUserAccounts(){return ue(this,null,function*(){this.subscription.add(this.store.select(wa).subscribe(t=>{this.accounts=t}))})}getAccountName(t){let r=this.accounts.find(a=>a.accountId===t);return(r==null?void 0:r.name)||"Unknown Account"}getAccountType(t){let r=this.accounts.find(a=>a.accountId===t);return(r==null?void 0:r.type)||"Unknown"}getRecurringInfo(t){return t.recurringInterval?`Repeats ${t.recurringInterval.toLowerCase()}`:""}getSyncStatusInfo(t){switch(t.syncStatus){case mi.PENDING:return"Pending sync";case mi.SYNCED:return"Synced";case mi.FAILED:return"Sync failed";default:return""}}getSyncStatusIcon(t){switch(t.syncStatus){case mi.PENDING:return"schedule";case mi.SYNCED:return"check_circle";case mi.FAILED:return"error";default:return"help"}}getSyncStatusColor(t){switch(t.syncStatus){case mi.PENDING:return"orange";case mi.SYNCED:return"green";case mi.FAILED:return"red";default:return"gray"}}clearAllFilters(){this.filterService.clearAllFilters(),this.selectedSort="date-desc"}quickClearFilters(){this.filterService.clearAllFilters()}onClearDateFilter(){this.filterService.clearSelectedDate()}getActiveFiltersCount(){return this.filterService.getActiveFiltersCount()}isCategorySelected(t){return this.selectedCategory.includes(t)}isCustomDateRange(){return!!(this.selectedDate||this.selectedDateRange&&(this.selectedDateRange.startDate!==(0,lr.default)().startOf("month").toDate()||this.selectedDateRange.endDate!==(0,lr.default)().endOf("month").toDate()))}openCustomDateRangeDialog(){var r,a,o,s;this.dialog.open(Kf,{width:"400px",data:{startDate:(a=(r=this.selectedDateRange)==null?void 0:r.startDate)!=null?a:new Date,endDate:(s=(o=this.selectedDateRange)==null?void 0:o.endDate)!=null?s:new Date}}).afterClosed().subscribe(u=>{u&&this.filterService.setSelectedDateRange(u.start,u.end)})}openImportDialog(){this.importTransactions.emit()}getCategoryName(t){let r=this.categories.find(a=>a.id===t);return(r==null?void 0:r.name)||t}};n.\u0275fac=function(r){return new(r||n)(q(pt),q(Kt),q(fn),q(At),q(wt),q(Ia),q(Do))},n.\u0275cmp=Ve({type:n,selectors:[["mobile-transaction-list"]],outputs:{editTransaction:"editTransaction",deleteTransaction:"deleteTransaction",addTransaction:"addTransaction",importTransactions:"importTransactions"},decls:8,vars:3,consts:[["sortMenu","matMenu"],["typeMenu","matMenu"],["categoryMenu","matMenu"],["dateMenu","matMenu"],[1,"mobile-transaction-container"],["class","mobile-filter-header",4,"ngIf"],["class","transaction-summary",4,"ngIf"],[1,"transaction-list-container"],[1,"transaction-scroll"],["class","empty-state",4,"ngIf"],[1,"transaction-card",3,"selected"],[1,"mobile-filter-header"],["class","active-filters-indicator flex justify-between items-center",4,"ngIf"],[1,"search-container"],[1,"search-input-wrapper"],[1,"search-icon"],["type","text","placeholder","Search transactions...",1,"search-input",3,"ngModelChange","ngModel"],["mat-icon-button","","class","clear-search-btn",3,"click",4,"ngIf"],[1,"filter-menu-container","md:justify-center"],["mat-icon-button","","aria-label","Sort transactions",1,"filter-menu-btn",3,"matMenuTriggerFor","matTooltip"],[1,"filter-btn-text"],[1,"filter-menu"],["mat-menu-item","",3,"active-menu-item"],["mat-icon-button","","aria-label","Filter by transaction type",1,"filter-menu-btn",3,"matMenuTriggerFor","matTooltip"],["mat-menu-item","",3,"click"],["class","check-icon",4,"ngIf"],[1,"income-icon"],[1,"expense-icon"],["mat-icon-button","","aria-label","Filter by category",1,"filter-menu-btn",3,"matMenuTriggerFor","matTooltip"],["mat-icon-button","","aria-label","Filter by date range",1,"filter-menu-btn",3,"matMenuTriggerFor","matTooltip"],["mat-icon-button","","matTooltip","Import transactions","aria-label","Import transactions",1,"filter-menu-btn","import-btn",3,"click"],[1,"active-filters-indicator","flex","justify-between","items-center"],[1,"filter-icon-container"],[1,"filter-icon"],[1,"filter-text"],[1,""],[1,"text-black","relative","top-1","!text-blue-700","text-sm",3,"click"],["mat-icon-button","",1,"clear-search-btn",3,"click"],[1,"check-icon"],[1,"transaction-summary"],[1,"summary-stats"],[1,"stat-item"],[1,"stat-value"],[1,"stat-total"],[1,"stat-value","income"],[1,"stat-value","expense"],[1,"empty-state"],[1,"empty-icon"],[1,"empty-title","text-base"],[1,"empty-description","text-base"],["mat-raised-button","","color","primary","class","add-first-btn",3,"click",4,"ngIf"],["mat-stroked-button","","class","clear-filters-btn-large",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"add-first-btn",3,"click"],[1,"text-base"],["mat-stroked-button","",1,"clear-filters-btn-large",3,"click"],[1,"transaction-card",3,"click"],[1,"transaction-main"],[1,"transaction-icon"],[1,"icon-container"],[1,"split-transaction"],[1,"category-split-transaction"],[1,"transaction-details"],[1,"transaction-title","text-base"],[1,"transaction-date","text-base"],["class","transaction-notes text-base",4,"ngIf"],[1,"transaction-amount"],[1,"amount-value","text-base",3,"ngClass"],[1,"amount-type","text-base"],["class","transaction-actions",4,"ngIf"],["class","transaction-details-expanded",4,"ngIf"],[1,"transaction-notes","text-base"],[1,"transaction-actions"],[1,"actions-container"],["mat-icon-button","","matTooltip","Edit transaction",1,"action-button","edit-btn",3,"click"],["mat-icon-button","","matTooltip","Delete transaction",1,"action-button","delete-btn",3,"click"],[1,"transaction-details-expanded"],[1,"details-container"],[1,"detail-row"],[1,"detail-label"],[1,"detail-icon"],[1,"detail-value"],[1,"account-name"],["class","account-type",4,"ngIf"],["class","detail-row",4,"ngIf"],[1,"sync-status"],[1,"created-date"],[1,"created-time"],[1,"account-type"],[1,"transaction-id"],[1,"recurring-info"],[1,"transaction-notes"],[1,"payment-method"],[1,"tax-amount"],[1,"tax-percentage"],[1,"category-splits-list"],[1,"category-split-item"],[1,"split-category"],[1,"split-amount"]],template:function(r,a){r&1&&(c(0,"div",4),X(1,hB,102,42,"div",5)(2,xB,15,10,"div",6),c(3,"div",7)(4,"div",8),X(5,vB,10,3,"div",9),Ge(6,RB,24,24,"div",10,Gb),l()()()),r&2&&(p(),w("ngIf",a.showFilters),p(),w("ngIf",a.showFilters&&a.filteredTransactions.length>0),p(3),w("ngIf",!a.filteredTransactions.length),p(),He(a.filteredTransactions))},dependencies:[br,ct,Vt,Ut,Zn,Ad,Ht,bn,at,Po,So,Oo,Jn,Ys,yr,Vn],styles:[".mobile-transaction-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;background:#f8fafc;position:relative}.mobile-filter-header[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid #e2e8f0;padding:12px;box-shadow:0 1px 3px #0000001a;z-index:10}.active-filters-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:#eff6ff;border:1px solid #bfdbfe;border-radius:8px;margin-bottom:8px;animation:_ngcontent-%COMP%_fadeIn .3s ease}.active-filters-indicator[_ngcontent-%COMP%]   .filter-icon[_ngcontent-%COMP%]{color:#2563eb;font-size:16px;width:16px;height:16px}.active-filters-indicator[_ngcontent-%COMP%]   .filter-text[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#2563eb}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.search-container[_ngcontent-%COMP%]{margin-bottom:12px}.search-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;padding:0 12px;transition:all .2s ease}.search-input-wrapper[_ngcontent-%COMP%]:focus-within{border-color:#3b82f6;background:#fff;box-shadow:0 0 0 3px #3b82f61a}.search-icon[_ngcontent-%COMP%]{color:#9ca3af;font-size:20px;width:20px;height:20px;margin-right:8px}.search-input[_ngcontent-%COMP%]{flex:1;border:none;background:transparent;padding:12px 0;font-size:16px;color:#1f2937;outline:none}.search-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.clear-search-btn[_ngcontent-%COMP%]{color:#9ca3af;width:32px;height:32px;margin-left:8px}.clear-search-btn[_ngcontent-%COMP%]:hover{color:#6b7280;background:#f3f4f6}.filter-menu-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.filter-menu-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;border:1px solid #e2e8f0;background:#fff;color:#374151;transition:all .2s ease;flex-shrink:0;position:relative;display:flex;align-items:center;justify-content:center}.filter-menu-btn[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1;transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.filter-menu-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 1px 2px #0000001a}.filter-menu-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.filter-menu-btn[_ngcontent-%COMP%]   .filter-btn-text[_ngcontent-%COMP%]{display:none;font-size:12px;font-weight:500;margin-left:4px;white-space:nowrap}.filter-menu-btn.import-btn[_ngcontent-%COMP%]{background:#f0f9ff;border-color:#0ea5e9;color:#0ea5e9}.filter-menu-btn.import-btn[_ngcontent-%COMP%]:hover{background:#e0f2fe;border-color:#0284c7;color:#0284c7;transform:translateY(-1px);box-shadow:0 2px 4px #0ea5e933}.filter-menu-btn.import-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 1px 2px #0ea5e91a}@media (min-width: 768px){.filter-menu-btn[_ngcontent-%COMP%]{width:auto;min-width:120px;height:40px;padding:0 12px;justify-content:flex-start}.filter-menu-btn[_ngcontent-%COMP%]   .filter-btn-text[_ngcontent-%COMP%]{display:inline-block}.filter-menu-container[_ngcontent-%COMP%]{gap:12px}}@media (min-width: 1024px){.filter-menu-btn[_ngcontent-%COMP%]{min-width:140px;padding:0 16px}}.clear-filters-btn[_ngcontent-%COMP%]{color:#ef4444;width:40px;height:40px;border-radius:8px;background:#fef2f2;border:1px solid #fecaca;flex-shrink:0}.clear-filters-btn[_ngcontent-%COMP%]:hover{background:#fee2e2;border-color:#fca5a5;transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.clear-filters-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 1px 2px #0000001a}.clear-filters-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.filter-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%]{padding:0}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;font-size:14px;color:#374151;transition:all .2s ease}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]:hover{background:#f8fafc}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item.active-menu-item[_ngcontent-%COMP%]{background:#eff6ff;color:#1d4ed8}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item.active-menu-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1d4ed8}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#6b7280}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]   mat-icon.income-icon[_ngcontent-%COMP%]{color:#10b981}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]   mat-icon.expense-icon[_ngcontent-%COMP%]{color:#ef4444}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]   mat-icon.check-icon[_ngcontent-%COMP%]{margin-left:auto;color:#1d4ed8}.filter-menu[_ngcontent-%COMP%]   .mat-menu-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1}.filter-menu[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{margin:4px 0}.transaction-summary[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid #e2e8f0;padding:8px 12px}.summary-stats[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:12px}.stat-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;flex:1;justify-content:center}.stat-value[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#1f2937}.stat-value.income[_ngcontent-%COMP%]{color:#10b981}.stat-value.expense[_ngcontent-%COMP%]{color:#ef4444}.stat-total[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af;font-weight:400}.transaction-list-container[_ngcontent-%COMP%]{flex:1;overflow:hidden;position:relative}.transaction-scroll[_ngcontent-%COMP%]{height:100%;padding:12px;overflow-y:auto;max-height:70vh}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.empty-icon[_ngcontent-%COMP%]{margin-bottom:16px}.empty-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#d1d5db}.empty-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#374151;margin-bottom:8px}.empty-description[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin-bottom:24px;line-height:1.5}.add-first-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:8px;font-weight:500}.clear-filters-btn-large[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:8px;font-weight:500;color:#ef4444;border-color:#fecaca;background:#fef2f2}.clear-filters-btn-large[_ngcontent-%COMP%]:hover{background:#fee2e2;border-color:#fca5a5}.transaction-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;margin-bottom:10px;border:1px solid #e5e7eb;overflow:hidden;transition:all .2s ease;cursor:pointer}.transaction-card[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.transaction-card.selected[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.transaction-main[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px;gap:12px}.transaction-icon[_ngcontent-%COMP%]{flex-shrink:0}.icon-container[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.icon-container.income-bg[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d1fae5,#a7f3d0)}.icon-container.expense-bg[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fee2e2,#fecaca)}.income-icon[_ngcontent-%COMP%]{color:#059669;font-size:22px;width:22px;height:22px}.expense-icon[_ngcontent-%COMP%]{color:#dc2626;font-size:22px;width:22px;height:22px}.transaction-details[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:2px}.transaction-title[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;line-height:1.3;font-size:.9rem;margin:0}.transaction-category[_ngcontent-%COMP%]{font-size:.9rem;color:#6b7280;font-weight:500;margin:0}.transaction-date[_ngcontent-%COMP%]{font-size:.9rem;color:#9ca3af;display:flex;align-items:center;gap:4px;margin:0}.time-separator[_ngcontent-%COMP%]{color:#d1d5db}.transaction-notes[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;font-style:italic;line-height:1.4;margin:2px 0 0}.transaction-amount[_ngcontent-%COMP%]{text-align:right;flex-shrink:0;display:flex;flex-direction:column;align-items:flex-end;gap:1px}.amount-value[_ngcontent-%COMP%]{font-size:15px;font-weight:700;margin:0}.amount-value.income-text[_ngcontent-%COMP%]{color:#059669}.amount-value.expense-text[_ngcontent-%COMP%]{color:#dc2626}.amount-type[_ngcontent-%COMP%]{font-size:10px;color:#9ca3af;text-transform:capitalize;font-weight:500;letter-spacing:.5px;margin:0;background-color:#fff;padding:1px 5px;border-radius:5px;position:relative;color:#766d6d;font-weight:600;top:5px;left:4px;border:.5px dotted}.transaction-actions[_ngcontent-%COMP%]{background:#f8fafc;border-top:1px solid #e5e7eb;padding:8px 12px;animation:_ngcontent-%COMP%_slideDown .2s ease}.actions-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px}.action-button[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;transition:all .2s ease}.action-button.edit-btn[_ngcontent-%COMP%]{border:1px dashed gray;color:gray}.action-button.edit-btn[_ngcontent-%COMP%]:hover{background:#bfdbfe;transform:scale(1.05)}.action-button.delete-btn[_ngcontent-%COMP%]{border:1px solid #dc2626;color:#dc2626}.action-button.delete-btn[_ngcontent-%COMP%]:hover{background:#fecaca;transform:scale(1.05)}.transaction-details-expanded[_ngcontent-%COMP%]{background:#f8fafc;border-top:1px solid #e5e7eb;padding:16px 12px;animation:_ngcontent-%COMP%_slideDown .3s ease}.details-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f1f5f9}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex-shrink:0;min-width:120px}.detail-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#6b7280}.detail-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#374151}.detail-value[_ngcontent-%COMP%]{flex:1;text-align:right;display:flex;flex-direction:column;align-items:flex-end;gap:2px}.account-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#1f2937}.account-type[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-style:italic}.transaction-id[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-family:Courier New,monospace;background:#f3f4f6;padding:2px 6px;border-radius:4px}.recurring-info[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#059669;background:#d1fae5;padding:4px 8px;border-radius:6px}.sync-status[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.created-date[_ngcontent-%COMP%], .created-time[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.transaction-notes[_ngcontent-%COMP%]{font-size:14px;color:#374151;font-style:italic;line-height:1.4;text-align:left;max-width:200px;word-wrap:break-word}.fab-add[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:24px;z-index:1000;box-shadow:0 8px 24px #3b82f64d;transition:all .2s ease}.fab-add[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 12px 32px #3b82f666}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 480px){.filter-menu-container[_ngcontent-%COMP%]{flex-direction:row;align-items:stretch;justify-content:flex-end}.filter-menu-btn[_ngcontent-%COMP%]{justify-content:space-between}.summary-stats[_ngcontent-%COMP%]{gap:8px}.stat-item[_ngcontent-%COMP%]{flex-direction:row;gap:4px}}.split-transaction[_ngcontent-%COMP%]{position:relative;font-size:27px;top:-28px!important;left:-24px!important;color:#b75e5e}.category-split-transaction[_ngcontent-%COMP%]{position:relative;font-size:27px;top:-28px!important;left:-24px!important;color:#059669}.category-splits-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-top:8px}.category-split-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:#f0f9ff;border:1px solid #bae6fd;border-radius:6px;font-size:14px}.category-split-item[_ngcontent-%COMP%]   .split-category[_ngcontent-%COMP%]{font-weight:500;color:#0369a1}.category-split-item[_ngcontent-%COMP%]   .split-amount[_ngcontent-%COMP%]{font-weight:600;color:#059669}"]});let e=n;return e})();var Zf=Tr(Nr());var BB=(e,n)=>n.id;function LB(e,n){e&1&&(c(0,"th",38)(1,"div",39)(2,"mat-icon",40),d(3,"schedule"),l(),c(4,"span",41),d(5,"Date & Time"),l()()())}function VB(e,n){if(e&1&&(c(0,"td",42)(1,"div",43),d(2),pe(3,"date"),l(),c(4,"div",44),d(5),pe(6,"date"),l()()),e&2){let i=n.$implicit;p(2),oe(" ",yt(3,2,i.date.seconds*1e3,"MMM dd, yyyy")," "),p(3),oe(" ",yt(6,5,i.date.seconds*1e3,"hh:mm a")," ")}}function UB(e,n){e&1&&(c(0,"th",45)(1,"div",39)(2,"mat-icon",40),d(3,"category"),l(),c(4,"span",41),d(5,"Category"),l()()())}function jB(e,n){if(e&1&&(c(0,"td",46)(1,"div",39)(2,"div",47)(3,"mat-icon",48),d(4),l()(),c(5,"span",49),d(6),l()()()),e&2){let i=n.$implicit,t=S();p(3),Xt("color",t.getCategoryColor(i.categoryId)),p(),z(t.getCategoryIcon(i.categoryId)),p(2),oe(" ",t.getCategoryName(i.categoryId)," ")}}function zB(e,n){e&1&&(c(0,"th",50)(1,"div",39)(2,"mat-icon",40),d(3,"description"),l(),c(4,"span",41),d(5,"Description"),l()()())}function WB(e,n){if(e&1&&(c(0,"span",53),d(1),l()),e&2){let i=S().$implicit;p(),z(i.payee)}}function YB(e,n){if(e&1){let i=be();c(0,"input",54),gt("ngModelChange",function(r){G(i);let a=S().$implicit;return mt(a.payee,r)||(a.payee=r),H(r)}),l()}if(e&2){let i=S().$implicit;ut("ngModel",i.payee)}}function $B(e,n){if(e&1&&(c(0,"td",42),X(1,WB,2,1,"span",51)(2,YB,1,1,"input",52),l()),e&2){let i=n.$implicit;p(),w("ngIf",!i.isEditing),p(),w("ngIf",i.isEditing)}}function GB(e,n){e&1&&(c(0,"th",38)(1,"div",39)(2,"mat-icon",40),d(3,"account_balance_wallet"),l(),c(4,"span",41),d(5,"Amount"),l()()())}function HB(e,n){if(e&1&&(c(0,"span",57),d(1),l()),e&2){let i=S().$implicit;Lt(i.type==="income"?"text-green-700":"text-red-800"),p(),oe(" ",(i.type=="income"?"+":"-")+" \u20B9"+i.amount.toLocaleString()," ")}}function qB(e,n){if(e&1){let i=be();c(0,"input",58),gt("ngModelChange",function(r){G(i);let a=S().$implicit;return mt(a.amount,r)||(a.amount=r),H(r)}),l()}if(e&2){let i=S().$implicit;ut("ngModel",i.amount)}}function XB(e,n){if(e&1&&(c(0,"td",42),X(1,HB,2,3,"span",55)(2,qB,1,1,"input",56),l()),e&2){let i=n.$implicit;p(),w("ngIf",!i.isEditing),p(),w("ngIf",i.isEditing)}}function KB(e,n){e&1&&(c(0,"th",59)(1,"div",39)(2,"mat-icon",40),d(3,"swap_horiz"),l(),c(4,"span",41),d(5,"Type"),l()()())}function ZB(e,n){if(e&1&&(c(0,"span")(1,"span",63)(2,"mat-icon",64),d(3),l(),d(4),l()()),e&2){let i=S().$implicit;p(),Lt(i.type==="income"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),p(2),z(i.type==="income"?"trending_up":"trending_down"),p(),oe(" ",i.type," ")}}function JB(e,n){if(e&1){let i=be();c(0,"select",65),gt("ngModelChange",function(r){G(i);let a=S().$implicit;return mt(a.type,r)||(a.type=r),H(r)}),c(1,"option",66),d(2,"Income"),l(),c(3,"option",67),d(4,"Expense"),l()()}if(e&2){let i=S().$implicit;ut("ngModel",i.type)}}function QB(e,n){if(e&1&&(c(0,"td",60),X(1,ZB,5,4,"span",61)(2,JB,5,1,"select",62),l()),e&2){let i=n.$implicit;p(),w("ngIf",!i.isEditing),p(),w("ngIf",i.isEditing)}}function eL(e,n){e&1&&(c(0,"th",68)(1,"div",69)(2,"mat-icon",40),d(3,"settings"),l(),c(4,"span",41),d(5,"Actions"),l()()())}function tL(e,n){if(e&1){let i=be();c(0,"div",72)(1,"button",73),N("click",function(r){G(i);let a=S().$implicit,o=S();return r.stopPropagation(),H(o.onStartRowEdit(a))}),c(2,"mat-icon",74),d(3,"edit"),l()(),c(4,"button",75),N("click",function(r){G(i);let a=S().$implicit,o=S();return r.stopPropagation(),H(o.onDeleteTransaction(a))}),c(5,"mat-icon",74),d(6,"delete"),l()()()}}function nL(e,n){if(e&1){let i=be();c(0,"div",72)(1,"button",76),N("click",function(r){G(i);let a=S().$implicit,o=S();return r.stopPropagation(),H(o.onSaveRowEdit(a))}),c(2,"mat-icon",74),d(3,"check"),l()(),c(4,"button",77),N("click",function(r){G(i);let a=S().$implicit,o=S();return r.stopPropagation(),H(o.onCancelRowEdit(a))}),c(5,"mat-icon",74),d(6,"close"),l()()()}}function iL(e,n){if(e&1&&(c(0,"td",70),X(1,tL,7,0,"div",71)(2,nL,7,0,"div",71),l()),e&2){let i=n.$implicit;p(),w("ngIf",!i.isEditing),p(),w("ngIf",i.isEditing)}}function rL(e,n){e&1&&se(0,"tr",78)}function aL(e,n){if(e&1){let i=be();c(0,"tr",79),N("click",function(){let r=G(i).$implicit,a=S();return H(a.onRowClick(r))}),l()}}function oL(e,n){if(e&1){let i=be();c(0,"div",80),N("click",function(){let r=G(i).$implicit,a=S();return H(a.onRowClick(r))}),c(1,"div",81)(2,"div",82)(3,"div",83)(4,"mat-icon"),d(5),l()(),c(6,"div",84)(7,"div",85),d(8),l(),c(9,"div",86),d(10),l()()(),c(11,"div",87)(12,"div",88),d(13),l(),c(14,"div",89),d(15),l()()(),c(16,"div",90)(17,"span",91)(18,"mat-icon"),d(19),l(),d(20),l(),c(21,"div",92)(22,"button",73),N("click",function(r){let a=G(i).$implicit,o=S();return r.stopPropagation(),H(o.onStartRowEdit(a))}),c(23,"mat-icon"),d(24,"edit"),l()(),c(25,"button",75),N("click",function(r){let a=G(i).$implicit,o=S();return r.stopPropagation(),H(o.onDeleteTransaction(a))}),c(26,"mat-icon"),d(27,"delete"),l()()()()()}if(e&2){let i=n.$implicit,t=S();p(4),Xt("color",t.getCategoryColor(i.categoryId)),p(),z(t.getCategoryIcon(i.categoryId)),p(3),z(i.payee),p(2),z(t.getCategoryName(i.categoryId)),p(2),Lt(i.type==="income"?"income":"expense"),p(),oe(" ",(i.type=="income"?"+":"-")+" \u20B9"+i.amount.toLocaleString()," "),p(2),z(t.getDateDisplay(i.date)),p(2),Lt(i.type==="income"?"income":"expense"),p(2),z(i.type==="income"?"trending_up":"trending_down"),p(),oe(" ",i.type," ")}}function sL(e,n){if(e&1){let i=be();c(0,"div",93)(1,"mat-icon",94),d(2,"receipt_long"),l(),c(3,"h3",95),d(4),l(),c(5,"p",96),d(6,"No transactions found for the current year. Start by adding your first transaction to track your finances."),l(),c(7,"button",97),N("click",function(){G(i);let r=S();return H(r.onAddTransaction())}),c(8,"mat-icon"),d(9,"add"),l(),c(10,"span"),d(11,"Add Transaction"),l()()()}if(e&2){let i=S();p(4),oe("No transactions for ",i.getCurrentYear(),"")}}var qb=(()=>{let n=class n{constructor(t,r,a,o,s,u,m){this.auth=t,this.dateService=r,this.filterService=a,this.store=o,this.ssrService=s,this.dialog=u,this.breakpointService=m,this.editTransaction=new $n,this.deleteTransaction=new $n,this.startRowEdit=new $n,this.saveRowEdit=new $n,this.cancelRowEdit=new $n,this.addTransaction=new $n,this.dataSource=new xl,this.displayedColumns=["Date","Type","Payee","Amount","Status","Actions"],this.MOBILE_BREAKPOINT=640,this.TABLET_BREAKPOINT=768,this.subscription=new Pi,this.categories={},this.transactions$=this.store.select(An),this.allTransactions=[]}ngOnInit(){this.setupDataSource(),this.setupFilterServiceSubscriptions(),this.setupTransactionSubscriptions(),this.loadCategories(),this.updateColumnVisibility()}ngOnDestroy(){this.subscription.unsubscribe()}ngAfterViewInit(){this.setupSorting()}onResize(){this.updateColumnVisibility()}updateColumnVisibility(){if(this.ssrService.isClientSide()){let t=window.innerWidth;t<this.MOBILE_BREAKPOINT?this.displayedColumns=["Date","Payee","Amount","Actions"]:t<this.TABLET_BREAKPOINT?this.displayedColumns=["Date","Type","Payee","Amount","Actions"]:this.displayedColumns=["Date","Type","Payee","Amount","Status","Actions"]}}setupDataSource(){this.dataSource=new xl([]),this.dataSource.filterPredicate=(t,r)=>this.filterService.filterTransactions([t],{searchTerm:r,selectedCategory:this.filterService.getSelectedCategory(),selectedType:this.filterService.getSelectedType(),selectedDate:this.filterService.getSelectedDate(),selectedDateRange:this.filterService.getSelectedDateRange(),categoryFilter:this.filterService.getCategoryFilter(),accountFilter:this.filterService.getAccountFilter(),amountRange:this.filterService.getAmountRange(),statusFilter:this.filterService.getStatusFilter(),tags:this.filterService.getTags()}).length>0}setupTransactionSubscriptions(){this.subscription.add(this.transactions$.subscribe(t=>{this.allTransactions=t.sort((r,a)=>{var u,m;let o=this.dateService.toDate(r.date),s=this.dateService.toDate(a.date);return((u=s==null?void 0:s.getTime())!=null?u:0)-((m=o==null?void 0:o.getTime())!=null?m:0)}),this.updateFilteredData()}))}setupFilterServiceSubscriptions(){this.subscription.add(this.filterService.filterState$.subscribe(()=>{this.updateFilteredData()}))}updateFilteredData(){var f,h;let t=(0,Zf.default)().year(),r;this.filterService.getSelectedDate()||this.filterService.getSelectedDateRange()?r=this.filterService.filterTransactions(this.allTransactions,this.filterService.getCurrentFilterState()):r=this.filterService.filterCurrentYearTransactions(this.allTransactions,this.filterService.getCurrentFilterState());let o=((f=this.sort)==null?void 0:f.direction)||"desc",s=((h=this.sort)==null?void 0:h.active)||"Date",u=this.getSortByFromMatSort(s,o),m=this.filterService.sortTransactions(r,u);this.dataSource.data=m}getSortByFromMatSort(t,r){switch(t){case"Date":return r==="asc"?"date-asc":"date-desc";case"Amount":return r==="asc"?"amount-asc":"amount-desc";case"Payee":return"payee-asc";case"Type":return"category-asc";default:return"date-desc"}}setupSorting(){this.dataSource.sortingDataAccessor=(t,r)=>{switch(r){case"Date":return(this.dateService.toDate(t==null?void 0:t.date)||new Date).getTime();case"Type":return(t==null?void 0:t.category.toString().toLowerCase())||"";case"Payee":return((t==null?void 0:t.payee)||"").toLowerCase();case"Amount":return t==null?void 0:t.amount;case"Status":return((t==null?void 0:t.type)||"").toLowerCase();default:return""}},this.dataSource.sort=this.sort,this.subscription.add(this.sort.sortChange.subscribe(t=>{console.log(`Sorting by ${t.active} in ${t.direction} order`),this.updateFilteredData()})),this.sort.sort({id:"Date",start:"desc",disableClear:!1})}onEditTransaction(t){this.editTransaction.emit(t)}onDeleteTransaction(t){this.dialog.open(Kr,{width:"300px",data:{title:"Delete Transaction",message:"Are you sure you want to delete this transaction?",confirmText:"Delete",cancelText:"Cancel"}}).afterClosed().subscribe(r=>{r&&this.deleteTransaction.emit(t)})}onStartRowEdit(t){this.editTransaction.emit(t)}onSaveRowEdit(t){this.saveRowEdit.emit(t)}onCancelRowEdit(t){this.cancelRowEdit.emit(t)}onAddTransaction(){this.addTransaction.emit()}onRowClick(t){this.openTransactionViewDialog(t)}openTransactionViewDialog(t){let r=this.dialog.open(ls,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog",data:{transaction:t,mode:"view"}})}getFilteredCount(){return this.dataSource.data.length}getTotalCount(){return this.allTransactions.length}getCurrentYear(){return(0,Zf.default)().year()}getCurrentSortState(){return this.sort&&this.sort.active?{active:this.sort.active,direction:this.sort.direction}:null}clearSort(){this.sort&&this.sort.sort({id:"",start:"asc",disableClear:!1})}loadCategories(){var r;((r=this.auth.currentUser)==null?void 0:r.uid)&&this.store.select(Ri).subscribe(a=>{for(let o of a)this.categories[o.id]=o})}getCategoryIcon(t){var r;return((r=this.categories[t])==null?void 0:r.icon)||"category"}getCategoryName(t){var r;return((r=this.categories[t])==null?void 0:r.name)||t}getCategoryColor(t){var r;return((r=this.categories[t])==null?void 0:r.color)||"#46777f"}getDateDisplay(t){return t&&typeof t=="object"&&"seconds"in t?new Date(t.seconds*1e3).toLocaleDateString(Dt.LANGUAGE.DEFAULT,{month:"short",day:"numeric"}):t instanceof Date?t.toLocaleDateString(Dt.LANGUAGE.DEFAULT,{month:"short",day:"numeric"}):""}getTotalIncome(){return this.dataSource.data.filter(t=>t.type==="income").reduce((t,r)=>t+r.amount,0)}getTotalExpense(){return this.dataSource.data.filter(t=>t.type==="expense").reduce((t,r)=>t+r.amount,0)}getNetAmount(){return this.getTotalIncome()-this.getTotalExpense()}getTransactionCount(){return this.dataSource.data.length}clearAllFilters(){this.filterService.clearAllFilters()}getActiveFiltersCount(){return this.filterService.getActiveFiltersCount()}hasActiveFilters(){return this.filterService.hasActiveFilters()}getCurrentFilterState(){return this.filterService.getCurrentFilterState()}};n.\u0275fac=function(r){return new(r||n)(q(pt),q(At),q(Ia),q(wt),q(Pr),q(fn),q(Qi))},n.\u0275cmp=Ve({type:n,selectors:[["transaction-table"]],viewQuery:function(r,a){if(r&1&&Ir(Bd,5),r&2){let o;Ar(o=Dr())&&(a.sort=o.first)}},hostBindings:function(r,a){r&1&&N("resize",function(s){return a.onResize(s)},!1,zh)},outputs:{editTransaction:"editTransaction",deleteTransaction:"deleteTransaction",startRowEdit:"startRowEdit",saveRowEdit:"saveRowEdit",cancelRowEdit:"cancelRowEdit",addTransaction:"addTransaction"},decls:92,vars:18,consts:[[1,"bg-white","rounded-lg","border","border-gray-200","overflow-hidden","flex","flex-col","max-h-[calc(78vh-210px)]"],[1,"hidden","sm:flex","flex-1","overflow-auto","table-container"],["mat-table","","matSort","",1,"w-full","min-w-[800px]",3,"dataSource"],["matColumnDef","Date"],["mat-header-cell","","mat-sort-header","","class","bg-gray-50 px-3 py-4 md:px-6 sticky top-0 z-10",4,"matHeaderCellDef"],["mat-cell","","class","px-3 py-4 border-b border-gray-100 md:px-6",4,"matCellDef"],["matColumnDef","Type"],["mat-header-cell","","mat-sort-header","","class","px-3 py-4 md:px-6 hidden sm:table-cell sticky top-0 z-10 bg-gray-50",4,"matHeaderCellDef"],["mat-cell","","class","px-3 py-4 border-b border-gray-100 md:px-6 hidden sm:table-cell",4,"matCellDef"],["matColumnDef","Payee"],["mat-header-cell","","mat-sort-header","","class","px-3 py-4 md:px-6 sticky top-0 z-10 bg-gray-50",4,"matHeaderCellDef"],["matColumnDef","Amount"],["matColumnDef","Status"],["mat-header-cell","","mat-sort-header","","class","bg-gray-50 px-3 py-4 md:px-6 hidden md:table-cell sticky top-0 z-10",4,"matHeaderCellDef"],["mat-cell","","class","px-3 py-4 border-b border-gray-100 md:px-6 hidden md:table-cell",4,"matCellDef"],["matColumnDef","Actions"],["mat-header-cell","","class","bg-gray-50 px-3 py-4 md:px-6 text-center sticky top-0 z-10",4,"matHeaderCellDef"],["mat-cell","","class","px-3 py-4 border-b border-gray-100 text-center md:px-6",4,"matCellDef"],["mat-header-row","","class","h-12 md:h-16 sticky top-0 z-10",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50 transition-colors cursor-pointer",3,"click",4,"matRowDef","matRowDefColumns"],[1,"hidden","sm:flex","fixed-footer"],[1,"footer-content"],[1,"transaction-count"],[1,"totals-section"],[1,"total-item"],[1,"income"],[1,"total-content"],[1,"total-label"],[1,"total-value","income"],[1,"expense"],[1,"total-value","expense"],[1,"total-item","net-separator"],[1,"total-value"],[1,"sm:hidden","flex-1","overflow-auto","max-h-full","mobile-card-view"],[1,"p-4","space-y-3"],[1,"transaction-card"],[1,"sm:hidden","fixed-footer"],["class","text-center py-8 md:py-12 px-4",4,"ngIf"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50","px-3","py-4","md:px-6","sticky","top-0","z-10"],[1,"flex","items-center","space-x-1","md:space-x-2"],[1,"text-gray-500","text-xs","md:text-sm"],[1,"font-semibold","text-gray-700","text-xs","md:text-sm"],["mat-cell","",1,"px-3","py-4","border-b","border-gray-100","md:px-6"],[1,"text-xs","md:text-sm","text-gray-600"],[1,"text-xs","text-gray-400","hidden","md:block"],["mat-header-cell","","mat-sort-header","",1,"px-3","py-4","md:px-6","hidden","sm:table-cell","sticky","top-0","z-10","bg-gray-50"],["mat-cell","",1,"px-3","py-4","border-b","border-gray-100","md:px-6","hidden","sm:table-cell"],[1,"w-6","h-6","md:w-8","md:h-8","rounded-full","flex","items-center","justify-center","bg-gray-100"],[1,"text-xs","md:text-sm"],[1,"inline-flex","items-center","px-1.5","md:px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-800"],["mat-header-cell","","mat-sort-header","",1,"px-3","py-4","md:px-6","sticky","top-0","z-10","bg-gray-50"],["class","font-medium text-gray-900 max-w-[80px] md:max-w-[100px] text-wrap !block text-xs md:text-sm truncate",4,"ngIf"],["class","w-full px-2 md:px-3 py-1 md:py-2 border border-blue-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","placeholder","Enter payee name",3,"ngModel","ngModelChange",4,"ngIf"],[1,"font-medium","text-gray-900","max-w-[80px]","md:max-w-[100px]","text-wrap","!block","text-xs","md:text-sm","truncate"],["placeholder","Enter payee name",1,"w-full","px-2","md:px-3","py-1","md:py-2","border","border-blue-300","rounded-lg","text-xs","md:text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["class","font-bold text-xs md:text-sm",3,"class",4,"ngIf"],["type","number","class","w-full px-2 md:px-3 py-1 md:py-2 border border-blue-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","placeholder","Enter amount",3,"ngModel","ngModelChange",4,"ngIf"],[1,"font-bold","text-xs","md:text-sm"],["type","number","placeholder","Enter amount",1,"w-full","px-2","md:px-3","py-1","md:py-2","border","border-blue-300","rounded-lg","text-xs","md:text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50","px-3","py-4","md:px-6","hidden","md:table-cell","sticky","top-0","z-10"],["mat-cell","",1,"px-3","py-4","border-b","border-gray-100","md:px-6","hidden","md:table-cell"],[4,"ngIf"],["class","w-full px-2 md:px-3 py-1 md:py-2 border border-blue-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",3,"ngModel","ngModelChange",4,"ngIf"],[1,"inline-flex","items-center","px-2","md:px-3","py-1","rounded-full","text-xs","font-medium"],[1,"text-xs","mr-1"],[1,"w-full","px-2","md:px-3","py-1","md:py-2","border","border-blue-300","rounded-lg","text-xs","md:text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["value","income"],["value","expense"],["mat-header-cell","",1,"bg-gray-50","px-3","py-4","md:px-6","text-center","sticky","top-0","z-10"],[1,"flex","items-center","justify-center","space-x-1","md:space-x-2"],["mat-cell","",1,"px-3","py-4","border-b","border-gray-100","text-center","md:px-6"],["class","flex justify-center space-x-1 md:space-x-2",4,"ngIf"],[1,"flex","justify-center","space-x-1","md:space-x-2"],["mat-icon-button","","matTooltip","Edit transaction",1,"text-blue-600","hover:bg-blue-50","rounded-full","transition-colors",3,"click"],[1,"text-sm","md:text-base"],["mat-icon-button","","matTooltip","Delete transaction",1,"text-red-600","hover:bg-red-50","rounded-full","transition-colors",3,"click"],["mat-icon-button","","color","primary","matTooltip","Save changes",1,"bg-green-100","text-green-600","hover:bg-green-200","rounded-full","transition-colors",3,"click"],["mat-icon-button","","color","warn","matTooltip","Cancel editing",1,"bg-red-100","text-red-600","hover:bg-red-200","rounded-full","transition-colors",3,"click"],["mat-header-row","",1,"h-12","md:h-16","sticky","top-0","z-10"],["mat-row","",1,"hover:bg-gray-50","transition-colors","cursor-pointer",3,"click"],[1,"transaction-card",3,"click"],[1,"card-header"],[1,"left-section"],[1,"category-icon"],[1,"transaction-info"],[1,"payee-name"],[1,"category-name"],[1,"right-section"],[1,"amount"],[1,"date"],[1,"card-footer"],[1,"type-badge"],[1,"action-buttons"],[1,"text-center","py-8","md:py-12","px-4"],[1,"text-gray-400","text-4xl","md:text-6xl","mb-4"],[1,"text-base","md:text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-500","mb-4","text-sm","md:text-base"],["mat-raised-button","","color","primary",1,"flex","items-center","space-x-2","mx-auto","text-sm","md:text-base",3,"click"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"table",2),ts(3,3),X(4,LB,6,0,"th",4)(5,VB,7,8,"td",5),ns(),ts(6,6),X(7,UB,6,0,"th",7)(8,jB,7,4,"td",8),ns(),ts(9,9),X(10,zB,6,0,"th",10)(11,$B,3,2,"td",5),ns(),ts(12,11),X(13,GB,6,0,"th",4)(14,XB,3,2,"td",5),ns(),ts(15,12),X(16,KB,6,0,"th",13)(17,QB,3,2,"td",14),ns(),ts(18,15),X(19,eL,6,0,"th",16)(20,iL,3,2,"td",17),ns(),X(21,rL,1,0,"tr",18)(22,aL,1,0,"tr",19),l()(),c(23,"div",20)(24,"div",21)(25,"div",22)(26,"mat-icon"),d(27,"receipt"),l(),c(28,"span"),d(29),l()(),c(30,"div",23)(31,"div",24)(32,"mat-icon",25),d(33,"trending_up"),l(),c(34,"div",26)(35,"div",27),d(36,"Income"),l(),c(37,"div",28),d(38),l()()(),c(39,"div",24)(40,"mat-icon",29),d(41,"trending_down"),l(),c(42,"div",26)(43,"div",27),d(44,"Expense"),l(),c(45,"div",30),d(46),l()()(),c(47,"div",31)(48,"mat-icon"),d(49,"account_balance_wallet"),l(),c(50,"div",26)(51,"div",27),d(52,"Net"),l(),c(53,"div",32),d(54),l()()()()()(),c(55,"div",33)(56,"div",34),Ge(57,oL,28,13,"div",35,BB),l()(),c(59,"div",36)(60,"div",21)(61,"div",22)(62,"mat-icon"),d(63,"receipt"),l(),c(64,"span"),d(65),l()(),c(66,"div",23)(67,"div",24)(68,"mat-icon",25),d(69,"trending_up"),l(),c(70,"div",26)(71,"div",27),d(72,"Income"),l(),c(73,"div",28),d(74),l()()(),c(75,"div",24)(76,"mat-icon",29),d(77,"trending_down"),l(),c(78,"div",26)(79,"div",27),d(80,"Expense"),l(),c(81,"div",30),d(82),l()()(),c(83,"div",31)(84,"mat-icon"),d(85,"account_balance_wallet"),l(),c(86,"div",26)(87,"div",27),d(88,"Net"),l(),c(89,"div",32),d(90),l()()()()()(),X(91,sL,12,1,"div",37),l()),r&2&&(p(2),w("dataSource",a.dataSource),p(19),w("matHeaderRowDef",a.displayedColumns),p(),w("matRowDefColumns",a.displayedColumns),p(7),oe("",a.getTransactionCount()," transactions"),p(9),oe("\u20B9",a.getTotalIncome().toLocaleString(),""),p(8),oe("\u20B9",a.getTotalExpense().toLocaleString(),""),p(7),Lt(a.getNetAmount()>=0?"net-positive":"net-negative"),p(),jt(" ",a.getNetAmount()>=0?"+":"","\u20B9",a.getNetAmount().toLocaleString()," "),p(3),He(a.dataSource.data),p(8),oe("",a.getTransactionCount()," transactions"),p(9),oe("\u20B9",a.getTotalIncome().toLocaleString(),""),p(8),oe("\u20B9",a.getTotalExpense().toLocaleString(),""),p(7),Lt(a.getNetAmount()>=0?"net-positive":"net-negative"),p(),jt(" ",a.getNetAmount()>=0?"+":"","\u20B9",a.getNetAmount().toLocaleString()," "),p(),w("ngIf",!(a.dataSource.data!=null&&a.dataSource.data.length)))},dependencies:[ct,Hs,qs,Vt,ki,Gs,Ut,Zn,Ht,bn,at,kx,Tx,Fx,Ix,Ex,Rx,Ax,Dx,Nx,Bx,Bd,Ux,Jn,Vn],styles:[".table-container[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#cbd5e1 #f1f5f9}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}@media (max-width: 768px){.table-container[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;min-width:800px}@media (max-width: 640px){table[_ngcontent-%COMP%]{min-width:600px}}.mat-header-cell[_ngcontent-%COMP%]{background:#f8fafc;border-bottom:2px solid #e2e8f0;font-weight:600;color:#374151;padding:12px 16px;position:sticky;top:0;z-index:10;cursor:pointer;transition:all .2s ease;white-space:nowrap}@media (min-width: 768px){.mat-header-cell[_ngcontent-%COMP%]{padding:16px 24px}}.mat-header-cell[_ngcontent-%COMP%]:hover{background:#f1f5f9}.mat-header-cell[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}@media (min-width: 768px){.mat-header-cell[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{gap:8px}}.mat-header-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px;color:#6b7280}@media (min-width: 768px){.mat-header-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}}.mat-header-cell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;font-weight:600}@media (min-width: 768px){.mat-header-cell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}}.mat-sort-header-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}@media (min-width: 768px){.mat-sort-header-container[_ngcontent-%COMP%]{gap:8px}}.mat-sort-header-container[_ngcontent-%COMP%]   .mat-sort-header-arrow[_ngcontent-%COMP%]{color:#6b7280;opacity:.5;transition:all .2s ease}.mat-sort-header-container[_ngcontent-%COMP%]   .mat-sort-header-indicator[_ngcontent-%COMP%]{color:#3b82f6}.mat-header-cell.mat-sort-header-sorted[_ngcontent-%COMP%]{background:#eff6ff;border-bottom-color:#3b82f6}.mat-header-cell.mat-sort-header-sorted[_ngcontent-%COMP%]   .mat-sort-header-arrow[_ngcontent-%COMP%]{opacity:1;color:#3b82f6}.mat-header-cell.mat-sort-header-sorted[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1e40af}.mat-cell[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #f1f5f9;vertical-align:middle}@media (min-width: 768px){.mat-cell[_ngcontent-%COMP%]{padding:16px 24px}}.mat-cell[_ngcontent-%COMP%]:last-child{border-right:none}.mat-row[_ngcontent-%COMP%]{transition:all .2s ease}.mat-row[_ngcontent-%COMP%]:hover{background-color:#f8fafc;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.mat-row[_ngcontent-%COMP%]:last-child   .mat-cell[_ngcontent-%COMP%]{border-bottom:none}.date-cell[_ngcontent-%COMP%]   .date-main[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#374151;margin-bottom:2px}@media (min-width: 768px){.date-cell[_ngcontent-%COMP%]   .date-main[_ngcontent-%COMP%]{font-size:14px}}.date-cell[_ngcontent-%COMP%]   .date-time[_ngcontent-%COMP%]{font-size:11px;color:#6b7280}@media (min-width: 768px){.date-cell[_ngcontent-%COMP%]   .date-time[_ngcontent-%COMP%]{font-size:12px}}.category-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:2px 8px;border-radius:12px;font-size:11px;font-weight:500;background:#f3f4f6;color:#374151;border:1px solid #e5e7eb}@media (min-width: 768px){.category-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:16px;font-size:12px}}.payee-cell[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{font-weight:500;color:#1f2937;max-width:80px;word-wrap:break-word;line-height:1.4;font-size:12px}@media (min-width: 768px){.payee-cell[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{max-width:120px;font-size:14px}}.payee-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:6px 8px;border:2px solid #3b82f6;border-radius:6px;font-size:12px;transition:all .2s ease}@media (min-width: 768px){.payee-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:8px 12px;border-radius:8px;font-size:14px}}.payee-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f61a}.amount-cell[_ngcontent-%COMP%]{text-align:right}.amount-cell[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-weight:700;font-size:12px}@media (min-width: 768px){.amount-cell[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-size:14px}}.amount-cell[_ngcontent-%COMP%]   .amount-value.income[_ngcontent-%COMP%]{color:#059669}.amount-cell[_ngcontent-%COMP%]   .amount-value.expense[_ngcontent-%COMP%]{color:#dc2626}.amount-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:6px 8px;border:2px solid #3b82f6;border-radius:6px;font-size:12px;text-align:right;transition:all .2s ease}@media (min-width: 768px){.amount-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:8px 12px;border-radius:8px;font-size:14px}}.amount-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f61a}.status-cell[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:2px 6px;border-radius:10px;font-size:10px;font-weight:500}@media (min-width: 768px){.status-cell[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:16px;font-size:12px}}.status-cell[_ngcontent-%COMP%]   .status-badge.income[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.status-cell[_ngcontent-%COMP%]   .status-badge.expense[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.status-cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:6px 8px;border:2px solid #3b82f6;border-radius:6px;font-size:12px;transition:all .2s ease}@media (min-width: 768px){.status-cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px 12px;border-radius:8px;font-size:14px}}.status-cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f61a}.actions-cell[_ngcontent-%COMP%]{text-align:center}.actions-cell[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:4px}@media (min-width: 768px){.actions-cell[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{gap:8px}}.actions-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:32px;height:32px}@media (min-width: 768px){.actions-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:40px;height:40px}}.actions-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}@media (min-width: 768px){.actions-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:16px;margin-bottom:12px;box-shadow:0 1px 3px #0000001a;transition:all .2s ease}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026;transform:translateY(-1px)}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;background:#f3f4f6;display:flex;align-items:center;justify-content:center}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;font-size:14px;margin-bottom:2px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   .transaction-info[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-section[_ngcontent-%COMP%]{text-align:right}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-section[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:700;font-size:14px;margin-bottom:2px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-section[_ngcontent-%COMP%]   .amount.income[_ngcontent-%COMP%]{color:#059669}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-section[_ngcontent-%COMP%]   .amount.expense[_ngcontent-%COMP%]{color:#dc2626}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-section[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 8px;border-radius:12px;font-size:11px;font-weight:500}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .type-badge.income[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .type-badge.expense[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px;margin-right:4px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:4px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:32px;height:32px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}@media (max-width: 640px){.hidden-mobile[_ngcontent-%COMP%]{display:none!important}.table-container[_ngcontent-%COMP%]{border-radius:8px;margin:0 -8px}.mobile-card-view[_ngcontent-%COMP%]{padding:12px}.mobile-card-view[_ngcontent-%COMP%]   .transaction-card[_ngcontent-%COMP%]{margin-bottom:8px;padding:12px}}@media (max-width: 768px){.hidden-tablet[_ngcontent-%COMP%]{display:none!important}}.empty-state[_ngcontent-%COMP%]{padding:2rem 1rem}@media (min-width: 768px){.empty-state[_ngcontent-%COMP%]{padding:3rem 2rem}}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem}@media (min-width: 768px){.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:4rem;width:4rem;height:4rem}}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem}@media (min-width: 768px){.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem}}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem}@media (min-width: 768px){.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem}}.pagination-container[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:8px;padding:16px;margin-top:16px}.pagination-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]{background:transparent;border:none}.pagination-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]     .mat-paginator-container{justify-content:center}.pagination-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]     .mat-paginator-page-size{margin-right:16px}.pagination-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]     .mat-paginator-range-actions{margin-left:16px}.fixed-footer[_ngcontent-%COMP%]{background:#f9fafb;border-top:1px solid #e5e7eb;padding:12px 16px;position:sticky;bottom:0;z-index:10;box-shadow:0 -2px 8px #0000001a}@media (min-width: 768px){.fixed-footer[_ngcontent-%COMP%]{padding:16px 24px}}.fixed-footer[_ngcontent-%COMP%]   .footer-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;min-width:800px}@media (max-width: 768px){.fixed-footer[_ngcontent-%COMP%]   .footer-content[_ngcontent-%COMP%]{min-width:auto;flex-direction:column;gap:12px}}.fixed-footer[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.fixed-footer[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280;font-size:16px;width:16px;height:16px}.fixed-footer[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#374151}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:24px}@media (max-width: 768px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]{gap:16px;width:100%;justify-content:space-between}}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}@media (max-width: 768px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]{gap:4px}}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}@media (max-width: 768px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   mat-icon.income[_ngcontent-%COMP%]{color:#059669}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   mat-icon.expense[_ngcontent-%COMP%]{color:#dc2626}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]{text-align:right}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin-bottom:2px}@media (max-width: 768px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:11px}}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]{font-size:14px;font-weight:600}@media (max-width: 768px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]{font-size:12px}}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value.income[_ngcontent-%COMP%]{color:#059669}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value.expense[_ngcontent-%COMP%]{color:#dc2626}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value.net-positive[_ngcontent-%COMP%]{color:#059669}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-content[_ngcontent-%COMP%]   .total-value.net-negative[_ngcontent-%COMP%]{color:#dc2626}.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .net-separator[_ngcontent-%COMP%]{border-left:1px solid #d1d5db;padding-left:24px;margin-left:8px}@media (max-width: 768px){.fixed-footer[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .net-separator[_ngcontent-%COMP%]{padding-left:12px;margin-left:4px}}@media (max-width: 1024px){.mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:12px 16px}.payee-cell[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{max-width:100px}}@media (max-width: 768px){.mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:8px 12px}.mat-header-cell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}.mat-header-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}.payee-cell[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{max-width:80px;font-size:13px}.amount-cell[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-size:13px}.status-cell[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:4px 8px;font-size:11px}.actions-cell[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{width:32px;height:32px}}@media (max-width: 640px){.mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:6px 8px}.mat-header-cell[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{flex-direction:column;gap:4px;text-align:center}.mat-header-cell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}.mat-header-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px}.payee-cell[_ngcontent-%COMP%]   .payee-name[_ngcontent-%COMP%]{max-width:60px;font-size:12px}.amount-cell[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-size:12px}.status-cell[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:2px 6px;font-size:10px}.actions-cell[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{width:28px;height:28px}}"]});let e=n;return e})();var va=Tr(Nr());var lL=(e,n)=>n.value,dL=(e,n)=>n.id,uL=(e,n)=>n.type;function mL(e,n){if(e&1&&(c(0,"span",22),d(1),l()),e&2){let i=S();p(),oe("/ ",i.currentYearCount,"")}}function gL(e,n){if(e&1){let i=be();c(0,"mat-chip",29),N("removed",function(){let r=G(i).$implicit;return H(r.onRemove())}),d(1),c(2,"mat-icon",30),d(3,"cancel"),l()()}if(e&2){let i=n.$implicit;w("removable",!0),p(),oe(" ",i.label," ")}}function fL(e,n){if(e&1&&(c(0,"div",23)(1,"div",24)(2,"div",25)(3,"mat-icon",26),d(4,"filter_alt"),l(),c(5,"span",27),d(6,"Active Filters"),l()(),Ge(7,gL,4,2,"mat-chip",28,uL),l()()),e&2){let i=S();p(7),He(i.getActiveFilters())}}function pL(e,n){if(e&1&&(c(0,"mat-option",18),d(1),l()),e&2){let i=n.$implicit;w("value",i),p(),oe(" ",i," ")}}function hL(e,n){if(e&1&&(c(0,"mat-option",18),d(1),l()),e&2){let i=n.$implicit;w("value",i.value),p(),oe(" ",i.label," ")}}function xL(e,n){if(e&1&&(c(0,"mat-option",18),d(1),l()),e&2){let i=n.$implicit;w("value",i.id),p(),oe(" ",i.name," ")}}var Xb=(()=>{let n=class n{constructor(t,r,a,o){this.notificationService=t,this.store=r,this.dateService=a,this.filterService=o,this.filteredCount=0,this.currentYearCount=0,this.addTransaction=new $n,this.importTransactions=new $n,this.openFilterDialog=new $n,this.viewAnalytics=new $n,this.expandTable=new $n,this.searchTerm="",this.selectedCategory="all",this.selectedType="all",this.selectedYear=(0,va.default)().year(),this.selectedMonth=(0,va.default)().month(),this.selectedMonthOption="all",this.selectedDate=null,this.selectedDateRange=null,this.categories=[],this.availableYears=[],this.months=[],this.subscription=new Pi,this.transactions$=this.store.select(An),this.allTransactions=[],this.currentYear=(0,va.default)().year()}ngOnInit(){this.loadCategoriesFromStore(),this.setupTransactionSubscriptions(),this.updateAvailableYears(),this.updateMonths(),this.setupFilterServiceSubscriptions()}ngOnDestroy(){this.subscription.unsubscribe()}ngOnChanges(t){t.transactions&&(this.updateAvailableYears(),this.updateCategoriesFromTransactions())}setupTransactionSubscriptions(){this.subscription.add(this.transactions$.subscribe(t=>{this.allTransactions=t,this.updateAvailableYears(),this.updateCategoriesFromTransactions()}))}setupFilterServiceSubscriptions(){this.subscription.add(this.filterService.searchTerm$.subscribe(t=>{this.searchTerm=t})),this.subscription.add(this.filterService.selectedCategory$.subscribe(t=>{this.selectedCategory=t.includes("all")?"all":t[0]||"all"})),this.subscription.add(this.filterService.selectedType$.subscribe(t=>{this.selectedType=t})),this.subscription.add(this.filterService.selectedDate$.subscribe(t=>{this.selectedDate=t,t&&(this.selectedDateRange=null)})),this.subscription.add(this.filterService.selectedDateRange$.subscribe(t=>{this.selectedDateRange=t?{start:t.startDate,end:t.endDate}:null,t&&(this.selectedDate=null)}))}loadCategoriesFromStore(){this.subscription.add(this.store.select(Ri).subscribe(t=>{this.categories=t.map(r=>({id:r.id||"",name:r.name})).sort((r,a)=>r.name.localeCompare(a.name))}))}updateCategoriesFromTransactions(){if(this.allTransactions&&this.allTransactions.length>0){let t=new Set,r=new Map;this.allTransactions.forEach(a=>{a.categoryId&&a.category&&(t.add(a.categoryId),r.set(a.categoryId,a.category))}),this.categories=Array.from(t).map(a=>({id:a,name:r.get(a)||"Unknown"})).sort((a,o)=>a.name.localeCompare(o.name))}else this.categories=[]}updateAvailableYears(){if(this.allTransactions&&this.allTransactions.length>0){let t=new Set;this.allTransactions.forEach(r=>{if(r.date){let a=(0,va.default)(this.dateService.toDate(r.date)).year();t.add(a)}}),t.add(this.currentYear),this.availableYears=Array.from(t).sort((r,a)=>a-r)}else this.availableYears=[this.currentYear];(isNaN(this.selectedYear)||!this.availableYears.includes(this.selectedYear))&&(this.selectedYear=this.availableYears.length>0?this.availableYears[0]:this.currentYear)}updateMonths(){this.months=[{value:0,label:"January"},{value:1,label:"February"},{value:2,label:"March"},{value:3,label:"April"},{value:4,label:"May"},{value:5,label:"June"},{value:6,label:"July"},{value:7,label:"August"},{value:8,label:"September"},{value:9,label:"October"},{value:10,label:"November"},{value:11,label:"December"}]}onSearchChange(t){let r=t;this.filterService.setSearchTerm(r)}onCategoryChange(t){let r=t;this.filterService.setSelectedCategory([r])}onTypeChange(t){let r=t;this.filterService.setSelectedType(r)}onSelectedYearChange(t){let r=t;if(this.selectedYear=r,this.selectedMonthOption!=="all"){let a=parseInt(this.selectedMonthOption),o=(0,va.default)().year(r).month(a).startOf("month").toDate(),s=(0,va.default)().year(r).month(a).endOf("month").toDate();this.filterService.setSelectedDateRange(o,s)}else{let a=(0,va.default)().year(r).startOf("year").toDate(),o=(0,va.default)().year(r).endOf("year").toDate();this.filterService.setSelectedDateRange(a,o)}}onSelectedMonthChange(t){if(this.selectedMonthOption=t,t!=="all"){let r=parseInt(t),a=(0,va.default)().year(this.selectedYear).month(r).startOf("month").toDate(),o=(0,va.default)().year(this.selectedYear).month(r).endOf("month").toDate();this.filterService.setSelectedDateRange(a,o)}else this.filterService.clearSelectedDate()}onAddTransaction(){this.addTransaction.emit()}onImportTransactions(){this.importTransactions.emit()}onOpenFilterDialog(){this.openFilterDialog.emit()}onViewAnalytics(){this.viewAnalytics.emit()}onExpandTable(){this.expandTable.emit()}onClearAllFilters(){this.filterService.clearAllFilters(),this.selectedDateRange=null,this.selectedDate=null,this.searchTerm="",this.selectedCategory="all",this.selectedType="all",this.selectedYear=this.availableYears.length>0?this.availableYears[0]:this.currentYear,this.selectedMonthOption="all"}onClearSearchFilter(){this.filterService.clearSearchTerm()}onClearYearFilter(){let t=this.availableYears.length>0?this.availableYears[0]:this.currentYear;this.selectedYear=t,this.filterService.clearSelectedDate()}onClearMonthFilter(){this.selectedMonthOption="all",this.filterService.clearSelectedDate()}onClearCategoryFilter(){this.filterService.clearSelectedCategory()}onClearTypeFilter(){this.filterService.clearSelectedType()}onClearDateRangeFilter(){this.filterService.clearSelectedDate()}onClearDateFilter(){this.filterService.clearSelectedDate()}getActiveFilters(){var a,o;let t=[],r=this.availableYears.length>0?this.availableYears[0]:this.currentYear;if(this.searchTerm&&t.push({type:"search",label:`Search: "${this.searchTerm}"`,onRemove:()=>this.onClearSearchFilter()}),this.selectedYear!==r&&t.push({type:"year",label:`Year: ${this.selectedYear}`,onRemove:()=>this.onClearYearFilter()}),this.selectedMonthOption!=="all"){let s=(a=this.months.find(u=>u.value===parseInt(this.selectedMonthOption)))==null?void 0:a.label;t.push({type:"month",label:`Month: ${s}`,onRemove:()=>this.onClearMonthFilter()})}if(this.selectedCategory!=="all"){let s=(o=this.categories.find(u=>u.id===this.selectedCategory))==null?void 0:o.name;t.push({type:"category",label:`Category: ${s||"Unknown"}`,onRemove:()=>this.onClearCategoryFilter()})}return this.selectedType!=="all"&&t.push({type:"type",label:`Type: ${this.selectedType}`,onRemove:()=>this.onClearTypeFilter()}),this.selectedDateRange&&this.selectedMonthOption==="all"&&t.push({type:"dateRange",label:`Date Range: ${this.selectedDateRange.start.toLocaleDateString()} - ${this.selectedDateRange.end.toLocaleDateString()}`,onRemove:()=>this.onClearDateRangeFilter()}),this.selectedDate&&t.push({type:"date",label:`Date: ${this.selectedDate.toLocaleDateString()}`,onRemove:()=>this.onClearDateFilter()}),t}hasActiveFilters(){return this.filterService.hasActiveFilters()}getActiveFiltersCount(){return this.filterService.getActiveFiltersCount()}getCurrentFilterState(){return this.filterService.getCurrentFilterState()}saveFilterPreset(t,r){this.filterService.saveAsPreset(t,r)}applyFilterPreset(t){this.filterService.applyPreset(t)}getFilterPresets(){return this.filterService.filterPresets$}getFilterHistory(){return this.filterService.filterHistory$}};n.\u0275fac=function(r){return new(r||n)(q(ht),q(wt),q(At),q(Ia))},n.\u0275cmp=Ve({type:n,selectors:[["search-filter"]],inputs:{filteredCount:"filteredCount",currentYearCount:"currentYearCount"},outputs:{addTransaction:"addTransaction",importTransactions:"importTransactions",openFilterDialog:"openFilterDialog",viewAnalytics:"viewAnalytics",expandTable:"expandTable"},features:[P0],decls:73,vars:9,consts:[[1,"bg-white","rounded-xl","border","border-gray-100","shadow-sm","p-4","pb-0"],[1,"flex","items-center","justify-between","mb-2"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","space-x-2"],[1,"w-2","h-2","bg-blue-500","rounded-full"],[1,"text-sm","font-medium","text-gray-700"],[1,"flex","items-center","space-x-1"],[1,"text-sm","font-semibold","text-gray-900"],["class","text-sm text-gray-500",4,"ngIf"],["mat-stroked-button","","matTooltip","Import transactions",1,"rounded-lg","transition-all","duration-200","shadow-sm","hover:shadow-md",3,"click"],[1,"text-md"],["mat-stroked-button","","matTooltip","Add transaction",1,"transition-all","duration-200","shadow-sm","hover:shadow-md","!bg-primary-500","!text-white",3,"click"],["class","mb-3 pb-2 border-b border-gray-100",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4","w-full"],["appearance","fill",1,"w-full"],["matInput","","placeholder","Search transactions...",3,"ngModelChange","ngModel"],["matSuffix","",1,"text-gray-400","text-sm"],[3,"ngModelChange","ngModel"],[3,"value"],["value","all"],["value","income"],["value","expense"],[1,"text-sm","text-gray-500"],[1,"mb-3","pb-2","border-b","border-gray-100"],[1,"flex","flex-wrap","gap-1"],[1,"flex","items-center","space-x-1","ml-2"],[1,"text-blue-500","text-xs"],[1,"text-xs","text-gray-600","font-medium"],[1,"bg-blue-50","text-blue-700","border-blue-200","text-xs","h-6",3,"removable"],[1,"bg-blue-50","text-blue-700","border-blue-200","text-xs","h-6",3,"removed","removable"],["matChipRemove","",1,"text-blue-500","text-xs"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),se(4,"div",4),c(5,"span",5),d(6),l()(),c(7,"div",6)(8,"span",7),d(9),l(),X(10,mL,2,1,"span",8),l()(),c(11,"div",3)(12,"button",9),N("click",function(){return a.onImportTransactions()}),c(13,"mat-icon",10),d(14,"file_upload"),l(),d(15,"Import "),l(),c(16,"button",11),N("click",function(){return a.onAddTransaction()}),c(17,"mat-icon",10),d(18,"add"),l(),d(19,"Add Transaction "),l()()(),X(20,fL,9,0,"div",12),c(21,"div",13)(22,"div")(23,"mat-form-field",14)(24,"mat-label"),d(25,"Search transactions..."),l(),c(26,"input",15),N("ngModelChange",function(s){return a.onSearchChange(s)}),l(),c(27,"mat-icon",16),d(28,"search"),l()()(),c(29,"div")(30,"mat-form-field",14)(31,"mat-label"),d(32,"Year"),l(),c(33,"mat-select",17),N("ngModelChange",function(s){return a.onSelectedYearChange(s)}),Ge(34,pL,2,2,"mat-option",18,Oi),l(),c(36,"mat-icon",16),d(37,"calendar_today"),l()()(),c(38,"div")(39,"mat-form-field",14)(40,"mat-label"),d(41,"Month"),l(),c(42,"mat-select",17),N("ngModelChange",function(s){return a.onSelectedMonthChange(s)}),c(43,"mat-option",19),d(44,"All Months"),l(),Ge(45,hL,2,2,"mat-option",18,lL),l(),c(47,"mat-icon",16),d(48,"date_range"),l()()(),c(49,"div")(50,"mat-form-field",14)(51,"mat-label"),d(52,"Category"),l(),c(53,"mat-select",17),N("ngModelChange",function(s){return a.onCategoryChange(s)}),c(54,"mat-option",19),d(55,"All Categories"),l(),Ge(56,xL,2,2,"mat-option",18,dL),l(),c(58,"mat-icon",16),d(59,"category"),l()()(),c(60,"div")(61,"mat-form-field",14)(62,"mat-label"),d(63,"Type"),l(),c(64,"mat-select",17),N("ngModelChange",function(s){return a.onTypeChange(s)}),c(65,"mat-option",19),d(66,"All Types"),l(),c(67,"mat-option",20),d(68,"Income"),l(),c(69,"mat-option",21),d(70,"Expense"),l()(),c(71,"mat-icon",16),d(72,"account_balance_wallet"),l()()()()()),r&2&&(p(6),oe(" ",a.selectedYear," Transactions "),p(3),z(a.filteredCount),p(),w("ngIf",a.filteredCount!==a.currentYearCount),p(10),w("ngIf",a.hasActiveFilters()),p(6),w("ngModel",a.searchTerm),p(7),w("ngModel",a.selectedYear),p(),He(a.availableYears),p(8),w("ngModel",a.selectedMonthOption),p(3),He(a.months),p(8),w("ngModel",a.selectedCategory),p(3),He(a.categories),p(8),w("ngModel",a.selectedType))},dependencies:[ct,Vt,Ut,Zn,Ht,at,Ji,Zr,wo,Ni,Fi,Pa,Jn,zx,jx]});let e=n;return e})();var CL=["tableSort"];function vL(e,n){if(e&1){let i=be();c(0,"mobile-transaction-list",1),N("editTransaction",function(r){G(i);let a=S();return H(a.editTransaction(r))})("deleteTransaction",function(r){G(i);let a=S();return H(a.deleteTransaction(r))})("addTransaction",function(){G(i);let r=S();return H(r.addTransactionDialog())})("importTransactions",function(){G(i);let r=S();return H(r.openImportDialog())}),l()}}function bL(e,n){e&1&&(c(0,"div",9)(1,"mat-icon",10),d(2,"compare_arrows"),l(),c(3,"span",11),d(4,"Transactions"),l()())}function yL(e,n){e&1&&(c(0,"div",9)(1,"mat-icon",10),d(2,"attach_money"),l(),c(3,"span",11),d(4,"Accounts"),l()())}function ML(e,n){e&1&&(c(0,"div",9)(1,"mat-icon",10),d(2,"local_offer"),l(),c(3,"span",11),d(4,"Categories"),l()())}function wL(e,n){e&1&&(c(0,"div",9)(1,"mat-icon",10),d(2,"analytics"),l(),c(3,"span",11),d(4,"Reports"),l()())}function SL(e,n){e&1&&(c(0,"div",9)(1,"mat-icon",10),d(2,"receipt_long"),l(),c(3,"span",11),d(4,"Tax"),l()())}function PL(e,n){e&1&&(c(0,"div",9)(1,"mat-icon",12),d(2,"note"),l(),c(3,"span",11),d(4,"Notes"),l()())}function OL(e,n){if(e&1){let i=be();c(0,"mat-card",0)(1,"mat-tab-group",2),gt("selectedIndexChange",function(r){G(i);let a=S();return mt(a.selectedTabIndex,r)||(a.selectedTabIndex=r),H(r)}),c(2,"mat-tab",3),X(3,bL,5,0,"ng-template",4),c(4,"div",5)(5,"search-filter",6),N("addTransaction",function(){G(i);let r=S();return H(r.addTransactionDialog())})("importTransactions",function(){G(i);let r=S();return H(r.openImportDialog())})("openFilterDialog",function(){G(i);let r=S();return H(r.openFilterDialog())})("viewAnalytics",function(){G(i);let r=S();return H(r.viewAnalytics())})("expandTable",function(){G(i);let r=S();return H(r.expandTable())}),l(),c(6,"transaction-table",7),N("editTransaction",function(r){G(i);let a=S();return H(a.editTransaction(r))})("deleteTransaction",function(r){G(i);let a=S();return H(a.deleteTransaction(r))})("startRowEdit",function(r){G(i);let a=S();return H(a.startRowEdit(r))})("saveRowEdit",function(r){G(i);let a=S();return H(a.saveRowEdit(r))})("cancelRowEdit",function(r){G(i);let a=S();return H(a.cancelRowEdit(r))})("addTransaction",function(){G(i);let r=S();return H(r.addTransactionDialog())}),l()()(),c(7,"mat-tab"),X(8,yL,5,0,"ng-template",4),c(9,"div",8),se(10,"user-accounts"),l()(),c(11,"mat-tab"),X(12,ML,5,0,"ng-template",4),c(13,"div",8),se(14,"user-category"),l()(),c(15,"mat-tab"),X(16,wL,5,0,"ng-template",4),se(17,"app-reports"),l(),c(18,"mat-tab"),X(19,SL,5,0,"ng-template",4),se(20,"app-tax"),l(),c(21,"mat-tab"),X(22,PL,5,0,"ng-template",4),se(23,"app-notes"),l()()()}if(e&2){let i=S();p(),ut("selectedIndex",i.selectedTabIndex),p(4),w("filteredCount",i.getFilteredCount())("currentYearCount",i.getCurrentYearCount())}}var fm=(()=>{let n=class n{constructor(t,r,a,o,s,u,m,f,h){this.loaderService=t,this._dialog=r,this.auth=a,this.notificationService=o,this.filterService=s,this.store=u,this.dateService=m,this.breakpointService=f,this.router=h,this.dataSource=new xl,this.displayedColumns=["Payee","Amount","Status","Type","Date","Actions"],this.pageSizeOptions=[...Dt.PAGINATION.PAGE_SIZE_OPTIONS],this.selectedTx=null,this.selectedTabIndex=0,this.showFullTable=!1,this.isTransactionsPage=!1,this.isTransactionsPage=!!this.router.url.includes("transactions"),this.transactions$=this.store.select(An),this.transactionsLoading$=this.store.select(Su),this.transactionsError$=this.store.select(d_)}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}ngOnInit(){this.loadTransactions(),this.subscribeToStoreData()}ngOnDestroy(){}loadTransactions(){var r;this.loaderService.show();let t=(r=this.auth.currentUser)==null?void 0:r.uid;t&&(this.store.dispatch(ri({userId:t})),this.store.dispatch(mr({userId:t})))}subscribeToStoreData(){this.transactions$.subscribe(t=>{this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.loaderService.hide()}),this.transactionsError$.subscribe(t=>{t&&(console.error("Error loading transactions:",t),this.notificationService.error("Failed to load transactions"),this.loaderService.hide())})}editTransaction(t){this._dialog.open(ls,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog",data:t}).afterClosed().subscribe(a=>{a&&this.loadTransactions()})}deleteTransaction(t){return ue(this,null,function*(){var a;let r=(a=this.auth.currentUser)==null?void 0:a.uid;r&&t.id&&(this.store.dispatch(ac({userId:r,transactionId:t.id})),this.notificationService.success("Transaction deleted successfully"))})}onLongPress(t){this.selectedTx=t}startRowEdit(t){t.originalValues={payee:t.payee,amount:t.amount,type:t.type},t.isEditing=!0}saveRowEdit(t){var s;if(!t.payee||!t.payee.trim()){this.notificationService.error("Payee cannot be empty");return}let r=parseFloat(t.amount);if(!r||r<=0){this.notificationService.error("Amount must be a positive number");return}if(!t.type||t.type!=="income"&&t.type!=="expense"){this.notificationService.error("Please select a valid transaction type");return}let a={payee:t.payee.trim(),amount:r,type:t.type},o=(s=this.auth.currentUser)==null?void 0:s.uid;o&&t.id&&(this.store.dispatch(xo({userId:o,transactionId:t.id,transaction:a})),this.notificationService.success("Transaction updated successfully"),t.isEditing=!1,delete t.originalValues)}cancelRowEdit(t){t.payee=t.originalValues.payee,t.amount=t.originalValues.amount,t.type=t.originalValues.type,t.isEditing=!1,delete t.originalValues}openImportDialog(){this._dialog.open(Xc,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"import-transactions-dialog"}).afterClosed().subscribe(r=>{r&&r.length&&this.importTransactions(r)})}importTransactions(t){return ue(this,null,function*(){var a;this.loaderService.show();let r=(a=this.auth.currentUser)==null?void 0:a.uid;if(!r){this.notificationService.error("User not authenticated"),this.loaderService.hide();return}try{let o=0,s=0;for(let u of t)try{let m=new Date(u.date);if(isNaN(m.getTime()))throw new Error("Invalid date format");let f={payee:u.payee,userId:r,accountId:u.accountId,amount:parseFloat(u.amount),type:u.type,category:(u==null?void 0:u.category)||"",categoryId:(u==null?void 0:u.categoryId)||"",date:m,notes:u.narration||"",isPending:!1,syncStatus:mi.PENDING,lastSyncedAt:new Date,createdAt:new Date,updatedAt:new Date,createdBy:r,updatedBy:r,status:bo.COMPLETED};this.store.dispatch(ho({userId:r,transaction:f})),o++}catch(m){console.error("Error importing transaction:",u,m),s++}this.loaderService.hide(),o>0&&(this.notificationService.success(`Successfully imported ${o} transactions`),this.store.dispatch(ri({userId:r}))),s>0&&this.notificationService.warning(`${s} transactions failed to import`)}catch(o){this.loaderService.hide(),this.notificationService.error("Failed to import transactions"),console.error("Import error:",o)}})}exportToExcel(){if(!this.dataSource.data||this.dataSource.data.length===0){this.notificationService.error("No transactions to export");return}let t=this.dataSource.data.map(m=>{let f=this.dateService.toDate(m.date);return{Date:(0,Va.default)(f).format("MM/DD/YYYY"),Time:(0,Va.default)(f).format("hh:mm A"),Payee:m.payee,Amount:m.amount,Type:m.type,Category:m.category,Notes:m.notes||""}}),r=Object.keys(t[0]),a=[r.join(","),...t.map(m=>r.map(f=>`"${m[f]}"`).join(","))].join(`
`),o=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),u=URL.createObjectURL(o);s.setAttribute("href",u),s.setAttribute("download",`transactions_${(0,Va.default)().format("YYYY-MM-DD")}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(u),this.notificationService.success(`Exported ${t.length} transactions successfully`)}getCurrentMonthTransactions(){let t=(0,Va.default)().month(),r=(0,Va.default)().year();return this.dataSource.data.filter(a=>{let o=this.dateService.toDate(a.date);if(!o)return!1;let s=(0,Va.default)(o);return s.month()===t&&s.year()===r}).length}getUniqueCategories(){return new Set(this.dataSource.data.map(r=>r.category)).size}getFilteredCount(){return this.dataSource.data.length}getTotalCount(){return this.dataSource.data.length}getCurrentYearCount(){let t=(0,Va.default)().year();return this.dataSource.data.filter(r=>{let a=this.dateService.toDate(r.date);return a?(0,Va.default)(a).year()===t:!1}).length}getCurrentYear(){return(0,Va.default)().year()}getCategoriesList(){let t=new Set(this.dataSource.data.map(r=>r.category));return Array.from(t).sort()}getTypesList(){return[en.INCOME,en.EXPENSE]}refreshTransactions(){var r;let t=(r=this.auth.currentUser)==null?void 0:r.uid;t&&(this.store.dispatch(ri({userId:t})),this.notificationService.success("Transactions refreshed"))}openFilterDialog(){this.notificationService.success("Filter functionality coming soon")}viewAnalytics(){this.notificationService.success("Analytics view coming soon")}addTransactionDialog(){this._dialog.open(ls,{panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"desktop-dialog"}).afterClosed().subscribe(t=>{var r;if(t){let a=(r=this.auth.currentUser)==null?void 0:r.uid;a&&this.store.dispatch(ri({userId:a}))}})}expandTable(){this.showFullTable=!this.showFullTable}clearAllFilters(){this.filterService.clearAllFilters()}getActiveFiltersCount(){return this.filterService.getActiveFiltersCount()}hasActiveFilters(){return this.filterService.hasActiveFilters()}getCurrentFilterState(){return this.filterService.getCurrentFilterState()}};n.\u0275fac=function(r){return new(r||n)(q(fc),q(fn),q(pt),q(ht),q(Ia),q(wt),q(At),q(Qi),q(Kt))},n.\u0275cmp=Ve({type:n,selectors:[["transaction-list"]],viewQuery:function(r,a){if(r&1&&(Ir(Ox,5),Ir(CL,5)),r&2){let o;Ar(o=Dr())&&(a.paginator=o.first),Ar(o=Dr())&&(a.sort=o.first)}},decls:2,vars:1,consts:[[1,"p-2","shadow-lg","border-0","rounded-xl","transaction-list-container","h-[83vh]"],[3,"editTransaction","deleteTransaction","addTransaction","importTransactions"],["mat-stretch-tabs","false","mat-align-tabs","start",1,"custom-tabs",3,"selectedIndexChange","selectedIndex"],[1,"max-h-full"],["mat-tab-label",""],[1,"p-2","overflow-hidden"],[3,"addTransaction","importTransactions","openFilterDialog","viewAnalytics","expandTable","filteredCount","currentYearCount"],[3,"editTransaction","deleteTransaction","startRowEdit","saveRowEdit","cancelRowEdit","addTransaction"],[1,"p-6"],[1,"flex","items-center","space-x-2","px-4","py-2"],[1,"text-primary"],[1,"font-semibold","text-gray-700","text-xs"],[1,"text-yellow-600"]],template:function(r,a){r&1&&X(0,vL,1,0,"mobile-transaction-list")(1,OL,24,3,"mat-card",0),r&2&&ot(a.breakpointService.device.isMobile||a.breakpointService.device.isTablePortrait&&a.isTransactionsPage?0:1)},dependencies:[To,at,Sx,ko,Eo,Oc,Ec,um,mm,gm,Hb,qb,Xb],styles:[".hide-scrollbar[_ngcontent-%COMP%]{-ms-overflow-style:none;scrollbar-width:none;overflow:-moz-scrollbars-none;-webkit-overflow-scrolling:touch}.hide-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.custom-tabs[_ngcontent-%COMP%]   .mat-mdc-tab-group[_ngcontent-%COMP%]   .mat-mdc-tab-header[_ngcontent-%COMP%]{border-bottom:2px solid #e5e7eb}.custom-tabs[_ngcontent-%COMP%]   .mat-mdc-tab-group[_ngcontent-%COMP%]   .mat-mdc-tab-header[_ngcontent-%COMP%]   .mat-mdc-tab-label-container[_ngcontent-%COMP%]   .mat-mdc-tab-label[_ngcontent-%COMP%]{min-width:120px;padding:0}.custom-tabs[_ngcontent-%COMP%]   .mat-mdc-tab-group[_ngcontent-%COMP%]   .mat-mdc-tab-header[_ngcontent-%COMP%]   .mat-mdc-tab-label-container[_ngcontent-%COMP%]   .mat-mdc-tab-label.mat-mdc-tab-label-active[_ngcontent-%COMP%]{background-color:#f3f4f6;border-radius:8px 8px 0 0}.mat-mdc-table[_ngcontent-%COMP%]{background-color:#fff}.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#374151;background-color:#fff;border-bottom:2px solid #e5e7eb;position:sticky;top:0;z-index:10}.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{padding:16px 24px;border-bottom:1px solid #f3f4f6}.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]{transition:all .2s ease}.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:inherit;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.table-container[_ngcontent-%COMP%]{height:100%;overflow:auto}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.transaction-list-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.transaction-list-container[_ngcontent-%COMP%]   .mat-mdc-tab-body-content[_ngcontent-%COMP%]{height:calc(100vh - 200px);overflow:hidden}.mat-mdc-card[_ngcontent-%COMP%]{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f!important;border-radius:16px!important;border:none!important}.mat-mdc-raised-button[_ngcontent-%COMP%]{border-radius:8px!important;font-weight:500!important;text-transform:none!important;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f!important}.mat-mdc-raised-button[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f!important}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{transition:all .2s ease}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{transform:translateY(-1px);box-shadow:0 4px 12px #3b82f626}.status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 12px;border-radius:20px;font-size:12px;font-weight:500;text-transform:capitalize}.status-badge.income[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.status-badge.expense[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b}.mat-mdc-row.editing[_ngcontent-%COMP%]{background-color:#eff6ff;border-left:4px solid #3b82f6}@media (max-width: 768px){.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{padding:12px 16px}}"]});let e=n;return e})();var EL=(e,n)=>({"md:grid-cols-2 ":e,"md:gap-5":n});function TL(e,n){e&1&&se(0,"calendar-view",1)}function IL(e,n){e&1&&se(0,"user-category",3)(1,"user-accounts",4),e&2&&(w("home",!0),p(),w("home",!0))}function AL(e,n){e&1&&se(0,"transaction-list",5)}var Jf=(()=>{let n=class n{constructor(t){this.breakpointService=t}};n.\u0275fac=function(r){return new(r||n)(q(Qi))},n.\u0275cmp=Ve({type:n,selectors:[["app-home"]],decls:4,vars:7,consts:[[1,"grid","grid-cols-1","gap-2","lg:grid-cols-7","lg:px-5","lg:gap-4","xl",3,"ngClass"],[1,"lg:col-span-2"],["class","lg:col-span-5",4,"ngIf"],[1,"lg:col-span-5",3,"home"],[3,"home"],[1,"lg:col-span-5"]],template:function(r,a){r&1&&(c(0,"section",0),X(1,TL,1,0,"calendar-view",1)(2,IL,2,2)(3,AL,1,0,"transaction-list",2),l()),r&2&&(w("ngClass",Gh(4,EL,!a.breakpointService.device.isTablePortrait,!a.breakpointService.device.isTablePortrait)),p(),ot(a.breakpointService.device.isTablePortrait?-1:1),p(),ot(a.breakpointService.device.isMobile?2:-1),p(),w("ngIf",!a.breakpointService.device.isMobile))},dependencies:[br,ct,T_,fm,Oc,Ec]});let e=n;return e})();var DL=(e,n)=>n.title,FL=(e,n)=>n.step;function RL(e,n){if(e&1&&(c(0,"div",46)(1,"div",87)(2,"mat-icon"),d(3),l()(),c(4,"h3",88),d(5),l(),c(6,"p",89),d(7),l()()),e&2){let i=n.$implicit;p(3),z(i.icon),p(2),z(i.title),p(2),z(i.description)}}function NL(e,n){if(e&1&&(c(0,"div",53)(1,"div",90),d(2),l(),c(3,"div",91)(4,"mat-icon"),d(5),l()(),c(6,"h3",92),d(7),l(),c(8,"p",93),d(9),l()()),e&2){let i=n.$implicit;p(2),oe(" ",i.step," "),p(3),z(i.icon),p(2),z(i.title),p(2),z(i.description)}}var Kb=(()=>{let n=class n{constructor(t,r){this.router=t,this.notificationService=r,this.features=[{icon:"account_balance",title:"Connect Bank",description:"Securely connect your bank accounts for automatic transaction tracking and real-time balance updates."},{icon:"pie_chart",title:"Smart Budgeting",description:"Create and manage budgets with intelligent spending alerts to keep you on track."},{icon:"category",title:"Sub Category",description:"Create and manage sub categories to track your spending."},{icon:"trending_up",title:"Real-Time Insights",description:"Get instant financial insights and trends with beautiful charts and analytics."},{icon:"flag",title:"Goal Tracking",description:"Set savings goals and track your progress with visual milestones."},{icon:"wifi_off",title:"Offline Access",description:"Access your data anytime, even without an internet connection."},{icon:"currency_exchange",title:"Multiple Currency Support",description:"Manage your finances in multiple currencies with ease."},{icon:"devices",title:"PWA - Multi-Platform Support",description:"Access your data on multiple devices web, android and ios"},{icon:"security",title:"Secure & Private",description:"Your financial data is protected with industry-standard security measures."},{icon:"cloud",title:"Cloud Sync",description:"Sync your data across all your devices with ease."}],this.howItWorks=[{step:"1",title:"Download & Sign Up",description:"Get the app from App Store or Play Store and create your account in seconds.",icon:"smartphone"},{step:"2",title:"Set Your Goals",description:"Define your financial goals and create personalized budgets.",icon:"flag"},{step:"3",title:"Track & Grow",description:"Monitor your progress and watch your savings grow with smart insights.",icon:"trending_up"}],this.testimonials=[{name:"Sarah Johnson",role:"Freelance Designer",content:"Money Manager helped me save $5,000 in just 6 months! The goal tracking feature is incredible.",avatar:"\u{1F469}\u200D\u{1F3A8}",rating:5,location:"San Francisco, CA"},{name:"Mike Chen",role:"Software Engineer",content:"Finally, a finance app that actually works offline and syncs perfectly across all my devices.",avatar:"\u{1F468}\u200D\u{1F4BB}",rating:5,location:"Seattle, WA"},{name:"Emma Davis",role:"Small Business Owner",content:"The real-time insights helped me identify spending patterns I never noticed before. Game changer!",avatar:"\u{1F469}\u200D\u{1F4BC}",rating:5,location:"Austin, TX"}],this.screenshots=[{title:"Dashboard Overview",description:"Get a complete view of your finances at a glance",image:"assets/images/screenshot/dashboard.png"},{title:"Smart Analytics",description:"Beautiful charts and insights to understand your spending",image:"assets/images/screenshot/analytics.png"},{title:"Goal Tracking",description:"Set and track your financial goals with visual progress",image:"assets/images/screenshot/goals.png"}],this.currentScreenshotIndex=0}ngOnInit(){}navigateToSignUp(){this.router.navigate(["/sign-in"])}navigateToSignIn(){this.router.navigate(["/sign-in"])}scrollToFeatures(){let t=document.getElementById("features");t&&t.scrollIntoView({behavior:"smooth"})}nextScreenshot(){this.currentScreenshotIndex=(this.currentScreenshotIndex+1)%this.screenshots.length}prevScreenshot(){this.currentScreenshotIndex=this.currentScreenshotIndex===0?this.screenshots.length-1:this.currentScreenshotIndex-1}setScreenshotIndex(t){this.currentScreenshotIndex=t}downloadAppStore(){this.notificationService.info("App Store link coming soon!")}downloadPlayStore(){this.notificationService.info("Play Store link coming soon!")}installPwa(){return ue(this,null,function*(){this.notificationService.info("PWA installation will be triggered automatically when available.")})}onPwaInstallClicked(){console.log("PWA install clicked from prompt component"),this.notificationService.success("Installing Money Manager...")}onPwaInstallDismissed(){console.log("PWA install dismissed from prompt component"),this.notificationService.info("Installation cancelled")}};n.\u0275fac=function(r){return new(r||n)(q(Kt),q(ht))},n.\u0275cmp=Ve({type:n,selectors:[["app-landing"]],decls:160,vars:0,consts:[[1,"hero-section","min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-primary-50","via-white","to-primary-100","relative","overflow-hidden"],[1,"absolute","inset-0","overflow-hidden"],[1,"absolute","-top-40","-right-40","w-80","h-80","bg-primary/20","rounded-full","mix-blend-multiply","filter","blur-xl","opacity-70","animate-blob"],[1,"absolute","-bottom-40","-left-40","w-80","h-80","bg-primary/30","rounded-full","mix-blend-multiply","filter","blur-xl","opacity-70","animate-blob","animation-delay-2000"],[1,"absolute","top-40","left-40","w-80","h-80","bg-primary/25","rounded-full","mix-blend-multiply","filter","blur-xl","opacity-70","animate-blob","animation-delay-4000"],[1,"container","mx-auto","px-4","relative","z-10"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8","lg:gap-12","items-center"],[1,"text-center","lg:text-left"],[1,"mb-6"],[1,"text-3xl","sm:text-4xl","lg:text-5xl","xl:text-6xl","font-bold","text-gray-900","mb-4","leading-tight"],[1,"bg-gradient-to-r","from-primary","to-primary-600","bg-clip-text","text-transparent","block"],[1,"text-base","sm:text-lg","lg:text-xl","text-gray-600","mb-6","max-w-lg","mx-auto","lg:mx-0"],[1,"flex","flex-col","sm:flex-row","gap-3","justify-center","lg:justify-start","mb-8"],[1,"flex","items-center","justify-center","gap-3","px-8","py-4","bg-gradient-to-r","from-primary","to-primary-600","text-white","font-semibold","rounded-xl","shadow-lg","hover:shadow-xl","transition-all","duration-300","transform","hover:-translate-y-1",3,"click"],[1,"!text-[1.5rem]"],[1,"text-lg"],[1,"flex","justify-center","lg:justify-end"],[1,"relative"],[1,"w-56","h-[450px]","sm:w-64","sm:h-[500px]","lg:w-72","lg:h-[560px]","bg-gray-900","rounded-[2.5rem]","p-2","shadow-2xl"],[1,"w-full","h-full","bg-white","rounded-[2rem]","overflow-hidden"],[1,"h-5","bg-gradient-to-r","from-primary","to-primary-600","flex","items-center","justify-between","px-3","text-white","text-xs"],[1,"flex","items-center","gap-1"],[1,"w-3","h-1.5","bg-white/30","rounded-full"],[1,"p-3","h-full","bg-gradient-to-br","from-primary-50","to-primary-100"],[1,"text-center","mb-3"],[1,"w-10","h-10","rounded-lg","flex","items-center","justify-center","mx-auto","mb-2"],["src","assets/icon/app-icon/icon-192x192.png","alt","Money Manager",1,"w-10","h-10"],[1,"text-xs","font-semibold","text-gray-800"],[1,"space-y-2"],[1,"bg-white","rounded-lg","p-2","shadow-sm"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-xs","text-gray-600"],[1,"text-sm","font-bold","text-gray-800"],[1,"grid","grid-cols-2","gap-2"],[1,"text-xs","font-semibold","text-green-600"],[1,"text-xs","font-semibold","text-red-600"],[1,"text-xs","text-gray-600","mb-1"],[1,"w-full","bg-gray-200","rounded-full","h-1.5"],[1,"bg-gradient-to-r","from-primary","to-primary-600","h-1.5","rounded-full",2,"width","65%"],[1,"text-xs","text-gray-600","mt-1"],["id","features",1,"py-16","lg:py-20","bg-white"],[1,"container","mx-auto","px-4"],[1,"text-center","mb-12","lg:mb-16","flex","flex-col","items-center","justify-center"],[1,"text-2xl","sm:text-3xl","lg:text-4xl","font-bold","text-gray-900","mb-4"],[1,"text-base","sm:text-lg","text-gray-600","max-w-2xl","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6","lg:gap-8"],[1,"group","p-6","lg:p-8","rounded-2xl","border","border-gray-200","hover:border-primary","hover:shadow-xl","transition-all","duration-300","transform","hover:-translate-y-2","bg-gradient-to-br","from-white","to-primary-50/30","hover:from-primary-50/50","hover:to-white"],[1,"py-20","bg-gradient-to-br","from-primary-50","to-white"],[1,"container-responsive","px-4","sm:px-6","lg:px-8"],[1,"text-center","mb-16","flex","flex-col","items-center","justify-center"],[1,"text-3xl","sm:text-4xl","md:text-5xl","font-bold","text-gray-900","mb-6"],[1,"text-lg","sm:text-xl","text-gray-600","max-w-3xl","mx-auto","leading-relaxed"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-8"],[1,"text-center","group","relative"],[1,"py-20","bg-gradient-to-r","from-primary","via-primary-600","to-primary"],[1,"container","mx-auto","text-center","px-4","flex","flex-col","items-center","justify-center"],[1,"text-3xl","sm:text-4xl","md:text-5xl","font-bold","text-white","mb-6"],[1,"text-xl","text-primary-100","mb-8","mx-auto","leading-relaxed"],[1,"flex","flex-wrap","items-center","justify-center","gap-6","mb-8"],[1,"flex","items-center","gap-2"],[1,"w-6","h-6","bg-primary-400","rounded-full","flex","items-center","justify-center"],[1,"text-white","text-xs"],[1,"text-primary-100","text-sm"],[1,"flex","flex-col","sm:flex-row","gap-4","justify-center"],[1,"flex","items-center","justify-center","gap-3","px-8","py-4","bg-white","text-primary","font-semibold","rounded-xl","shadow-lg","hover:shadow-xl","transform","hover:-translate-y-1","transition-all","duration-300",3,"click"],[1,"text-xl"],[1,"text-lg","font-bold"],[1,"py-12","bg-gray-900","text-white"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-8","mb-8"],[1,"md:col-span-2"],[1,"flex","items-start","mb-4"],[1,"w-10","h-10","rounded-lg","flex","items-center","justify-center","mr-3","bg-gradient-to-r","from-primary","to-primary-600"],["src","assets/icon/app-icon/icon-192x192.png","alt","Money Manager",1,"w-6","h-6"],[1,"text-xl","font-bold"],[1,"text-sm","text-gray-400"],[1,"text-gray-400","mb-4","max-w-md","leading-relaxed"],[1,"font-semibold","mb-4","text-primary-400"],["href","#features",1,"text-gray-400","hover:text-primary-400","transition-colors","duration-300"],["routerLink","/privacy-policy",1,"text-gray-400","hover:text-primary-400","transition-colors","duration-300"],["routerLink","/terms-conditions",1,"text-gray-400","hover:text-primary-400","transition-colors","duration-300"],["href","#",1,"text-gray-400","hover:text-primary-400","transition-colors","duration-300"],[1,"border-t","border-gray-800","pt-6"],[1,"flex","flex-col","md:flex-row","justify-between","items-center","space-y-2","md:space-y-0"],[1,"text-gray-400","text-sm"],[1,"flex","items-center","space-x-4","text-sm","text-gray-400"],[1,"flex","items-center"],[1,"text-sm","mr-1"],[1,"text-3xl","lg:text-4xl","mb-4","group-hover:scale-110","transition-transform","duration-300","text-primary"],[1,"text-lg","lg:text-xl","font-semibold","text-gray-900","mb-3","group-hover:text-primary","transition-colors","duration-300"],[1,"text-sm","lg:text-base","text-gray-600","leading-relaxed"],[1,"w-16","h-16","bg-gradient-to-r","from-primary","to-primary-600","text-white","rounded-full","flex","items-center","justify-center","text-2xl","font-bold","mx-auto","mb-6","shadow-lg","group-hover:shadow-xl","transition-shadow","duration-300"],[1,"text-3xl","mb-4","group-hover:scale-110","transition-transform","duration-300","text-primary"],[1,"text-xl","font-semibold","text-gray-900","mb-4","group-hover:text-primary","transition-colors","duration-300"],[1,"text-gray-600","leading-relaxed"]],template:function(r,a){r&1&&(c(0,"section",0)(1,"div",1),se(2,"div",2)(3,"div",3)(4,"div",4),l(),c(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"h1",9),d(10," Simple "),c(11,"span",10),d(12,"Money Management"),l()(),c(13,"p",11),d(14," Track your expenses, manage budgets, and keep your finances organized. "),l()(),c(15,"div",12)(16,"button",13),N("click",function(){return a.navigateToSignUp()}),c(17,"mat-icon",14),d(18,"person_add"),l(),c(19,"span",15),d(20,"Get Started Free"),l()()()(),c(21,"div",16)(22,"div",17)(23,"div",18)(24,"div",19)(25,"div",20)(26,"span"),d(27,"9:41"),l(),c(28,"div",21),se(29,"div",22),c(30,"span"),d(31,"\u{1F4F6}"),l(),c(32,"span"),d(33,"\u{1F50B}"),l()()(),c(34,"div",23)(35,"div",24)(36,"div",25),se(37,"img",26),l(),c(38,"h3",27),d(39,"Money Manager"),l()(),c(40,"div",28)(41,"div",29)(42,"div",30)(43,"span",31),d(44,"Total Balance"),l()(),c(45,"div",32),d(46,"\u20B92,450.00"),l()(),c(47,"div",33)(48,"div",29)(49,"div",31),d(50,"Income"),l(),c(51,"div",34),d(52,"\u20B93,200"),l()(),c(53,"div",29)(54,"div",31),d(55,"Expenses"),l(),c(56,"div",35),d(57,"\u20B91,850"),l()()(),c(58,"div",29)(59,"div",36),d(60,"Monthly Budget"),l(),c(61,"div",37),se(62,"div",38),l(),c(63,"div",39),d(64,"65% used"),l()()()()()()()()()()(),c(65,"section",40)(66,"div",41)(67,"div",42)(68,"h2",43),d(69," What You Can Do "),l(),c(70,"p",44),d(71," Essential tools to help you manage your money better. "),l()(),c(72,"div",45),Ge(73,RL,8,3,"div",46,DL),l()()(),c(75,"section",47)(76,"div",48)(77,"div",49)(78,"h2",50),d(79," Getting Started "),l(),c(80,"p",51),d(81," Simple steps to start managing your money "),l()(),c(82,"div",52),Ge(83,NL,10,4,"div",53,FL),l()()(),c(85,"section",54)(86,"div",55)(87,"h2",56),d(88," Ready to Get Started? "),l(),c(89,"p",57),d(90," Join thousands of users who are already managing their money smarter. "),l(),c(91,"div",58)(92,"div",59)(93,"div",60)(94,"span",61),d(95,"\u2713"),l()(),c(96,"span",62),d(97,"Free to use"),l()(),c(98,"div",59)(99,"div",60)(100,"span",61),d(101,"\u2713"),l()(),c(102,"span",62),d(103,"Works offline"),l()(),c(104,"div",59)(105,"div",60)(106,"span",61),d(107,"\u2713"),l()(),c(108,"span",62),d(109,"No ads"),l()()(),c(110,"div",63)(111,"button",64),N("click",function(){return a.navigateToSignUp()}),c(112,"mat-icon",65),d(113,"person_add"),l(),c(114,"span",66),d(115,"Get Started Free"),l()()()()(),c(116,"footer",67)(117,"div",41)(118,"div",68)(119,"div",69)(120,"div",70)(121,"div",71),se(122,"img",72),l(),c(123,"div")(124,"h3",73),d(125,"Money Manager"),l(),c(126,"p",74),d(127,"Simple Money Management"),l()()(),c(128,"p",75),d(129," Track expenses, manage budgets, and organize your finances with ease. "),l()(),c(130,"div")(131,"h4",76),d(132,"Quick Links"),l(),c(133,"ul",28)(134,"li")(135,"a",77),d(136,"Features"),l()(),c(137,"li")(138,"a",78),d(139,"Privacy Policy"),l()(),c(140,"li")(141,"a",79),d(142,"Terms of Service"),l()(),c(143,"li")(144,"a",80),d(145,"Contact"),l()()()()(),c(146,"div",81)(147,"div",82)(148,"div",83)(149,"p"),d(150,"\xA9 2024 Money Manager. All rights reserved."),l()(),c(151,"div",84)(152,"span",85)(153,"mat-icon",86),d(154,"security"),l(),d(155," Secure "),l(),c(156,"span",85)(157,"mat-icon",86),d(158,"cloud_done"),l(),d(159," Cloud Sync "),l()()()()()()),r&2&&(p(73),He(a.features),p(10),He(a.howItWorks))},dependencies:[V0,at],styles:['[_ngcontent-%COMP%]:root{--primary: #46777f;--primary-50: #f0f4f5;--primary-100: #e1e9eb;--primary-200: #c3d3d7;--primary-300: #a5bdc3;--primary-400: #87a7af;--primary-500: #46777f;--primary-600: #3a636a;--primary-700: #2e4f55;--primary-800: #223b40;--primary-900: #16272b}@keyframes _ngcontent-%COMP%_blob{0%{transform:translate(0) scale(1)}33%{transform:translate(30px,-50px) scale(1.1)}66%{transform:translate(-20px,20px) scale(.9)}to{transform:translate(0) scale(1)}}.animate-blob[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_blob 7s infinite}.animation-delay-2000[_ngcontent-%COMP%]{animation-delay:2s}.animation-delay-4000[_ngcontent-%COMP%]{animation-delay:4s}.animation-delay-1000[_ngcontent-%COMP%]{animation-delay:1s}.hero-section[_ngcontent-%COMP%]{position:relative}.hero-section[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 20% 80%,rgba(70,119,127,.3) 0%,transparent 50%),radial-gradient(circle at 80% 20%,rgba(70,119,127,.3) 0%,transparent 50%),radial-gradient(circle at 40% 40%,rgba(70,119,127,.2) 0%,transparent 50%);pointer-events:none}html[_ngcontent-%COMP%]{scroll-behavior:smooth}.feature-card[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1)}.feature-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#46777f,#3a636a);transition:all .3s ease}.btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#3a636a,#2e4f55);transform:translateY(-2px);box-shadow:0 10px 20px #46777f66}.testimonial-card[_ngcontent-%COMP%]{transition:all .3s ease}.testimonial-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 10px 25px #0000001a}.phone-mockup[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_float 6s ease-in-out infinite}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0)}50%{transform:translateY(-20px)}}.floating-element[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_float-slow 8s ease-in-out infinite}@keyframes _ngcontent-%COMP%_float-slow{0%,to{transform:translateY(0) rotate(0)}50%{transform:translateY(-15px) rotate(5deg)}}.screenshot-carousel[_ngcontent-%COMP%]{transition:all .5s cubic-bezier(.4,0,.2,1)}.gradient-text[_ngcontent-%COMP%]{background:linear-gradient(135deg,#46777f,#3a636a);background-size:200% 200%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;animation:_ngcontent-%COMP%_gradient-shift 3s ease infinite}@keyframes _ngcontent-%COMP%_gradient-shift{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}.stat-number[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_count-up 2s ease-out}@keyframes _ngcontent-%COMP%_count-up{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}section[_ngcontent-%COMP%]{opacity:0;transform:translateY(30px);animation:_ngcontent-%COMP%_fade-in-up .8s ease-out forwards}@keyframes _ngcontent-%COMP%_fade-in-up{to{opacity:1;transform:translateY(0)}}.feature-card[_ngcontent-%COMP%]{animation-delay:calc(var(--animation-order) * .1s)}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#46777f,#3a636a);border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,#3a636a,#2e4f55)}button[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:focus{outline:2px solid #46777f;outline-offset:2px}.trust-badge[_ngcontent-%COMP%]{transition:all .3s ease}.trust-badge[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.download-btn[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1)}.download-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px) scale(1.02);box-shadow:0 10px 25px #0003}.connection-line[_ngcontent-%COMP%]{position:relative}.connection-line[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:100%;width:100%;height:2px;background:linear-gradient(90deg,#46777f,#3a636a);transform:translateY(-50%);z-index:-1}.rating-stars[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_star-glow 2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_star-glow{0%{filter:brightness(1)}to{filter:brightness(1.2)}}.carousel-dot[_ngcontent-%COMP%]{transition:all .3s ease}.carousel-dot[_ngcontent-%COMP%]:hover{transform:scale(1.2)}.carousel-dot.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#46777f,#3a636a)}.container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;width:100%}@media (max-width: 640px){.container[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}button[_ngcontent-%COMP%]{min-height:44px}}@media (min-width: 641px){.container[_ngcontent-%COMP%]{padding-left:2rem;padding-right:2rem}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}.install-btn[_ngcontent-%COMP%]{background-color:#fff;border-radius:16px;padding:5px;width:60px;height:59px}mat-icon[_ngcontent-%COMP%]{font-size:inherit;width:inherit;height:inherit;line-height:inherit}.group[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;line-height:3rem}.text-3xl[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2rem;width:2rem;height:2rem;line-height:2rem}.text-lg[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem;line-height:1.25rem}.text-lg[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem;line-height:1.125rem}']});let e=n;return e})();var Zb=(()=>{let n=class n{constructor(t,r,a){this.firestore=t,this.auth=r,this.dateService=a}createSubscription(t,r){return ue(this,null,function*(){let a=Et(this.firestore,`users/${t}/subscription`);yield wr(a,le(ae({},r),{startDate:this.dateService.toTimestamp(r.startDate),endDate:this.dateService.toTimestamp(r.endDate)}))})}getSubscription(t){return ue(this,null,function*(){let r=Et(this.firestore,`users/${t}/subscription`),a=yield ai(r);if(a.exists())return a.data()})}updateSubscriptionPlan(t,r){return ue(this,null,function*(){let a=Et(this.firestore,`users/${t}/subscription`);yield kn(a,{plan:r})})}updateSubscriptionDates(t,r,a){return ue(this,null,function*(){let o=Et(this.firestore,`users/${t}/subscription`);yield kn(o,{startDate:Ai.fromDate(r),endDate:Ai.fromDate(a)})})}deleteSubscription(t){return ue(this,null,function*(){let r=Et(this.firestore,`users/${t}/subscription`);yield Di(r)})}};n.\u0275fac=function(r){return new(r||n)(De(Ki),De(pt),De(At))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();function LL(e,n){if(e&1){let i=be();c(0,"div")(1,"p"),d(2),l(),c(3,"p"),d(4),pe(5,"date"),l(),c(6,"p"),d(7),pe(8,"date"),l(),c(9,"button",2),N("click",function(){G(i);let r=S();return H(r.updatePlan("premium"))}),d(10,"Upgrade to Premium"),l(),c(11,"button",2),N("click",function(){G(i);let r=S();return H(r.deleteSubscription())}),d(12,"Cancel Subscription"),l()()}if(e&2){let i=S();p(2),oe("Plan: ",i.subscription.plan,""),p(2),oe("Start Date: ",yt(5,3,i.dateService.toDate(i.subscription.startDate),"short"),""),p(3),oe("End Date: ",yt(8,6,i.dateService.toDate(i.subscription.endDate),"short"),"")}}function VL(e,n){if(e&1){let i=be();c(0,"form",3),N("submit",function(){G(i);let r=S();return H(r.createSubscription())}),c(1,"label",4),d(2,"Plan:"),l(),c(3,"select",5),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.newSubscription.plan,r)||(a.newSubscription.plan=r),H(r)}),c(4,"option",6),d(5,"Free"),l(),c(6,"option",7),d(7,"Premium"),l()(),c(8,"label",8),d(9,"Start Date:"),l(),c(10,"input",9),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.newSubscription.startDate,r)||(a.newSubscription.startDate=r),H(r)}),l(),c(11,"label",10),d(12,"End Date:"),l(),c(13,"input",11),gt("ngModelChange",function(r){G(i);let a=S();return mt(a.newSubscription.endDate,r)||(a.newSubscription.endDate=r),H(r)}),l(),c(14,"button",12),d(15,"Start Subscription"),l()()}if(e&2){let i=S();p(3),ut("ngModel",i.newSubscription.plan),p(7),ut("ngModel",i.newSubscription.startDate),p(3),ut("ngModel",i.newSubscription.endDate)}}var Jb=(()=>{let n=class n{constructor(t,r,a,o,s){this.subscriptionService=t,this.auth=r,this.router=a,this.notificationService=o,this.dateService=s,this.userId="",this.newSubscription={userId:"",plan:"free",startDate:Ai.fromDate(new Date),endDate:Ai.fromDate(new Date)}}ngOnInit(){this.loadSubscription()}loadSubscription(){return ue(this,null,function*(){let t=this.auth.currentUser;if(t)try{this.userId=t.uid,this.subscription=yield this.subscriptionService.getSubscription(this.userId)}catch(r){console.error("Error loading subscription:",r),this.notificationService.error("Failed to load subscription data")}else this.notificationService.error("User not authenticated")})}createSubscription(){return ue(this,null,function*(){if(!this.newSubscription.plan){this.notificationService.warning("Please select a subscription plan");return}let t=this.auth.currentUser;if(t)try{this.newSubscription.userId=t.uid,yield this.subscriptionService.createSubscription(t.uid,this.newSubscription),this.notificationService.success("Subscription created successfully"),this.loadSubscription(),this.newSubscription={userId:"",plan:"free",startDate:Ai.fromDate(new Date),endDate:Ai.fromDate(new Date)}}catch(r){console.error("Error creating subscription:",r),this.notificationService.error("Failed to create subscription")}else this.notificationService.error("User not authenticated")})}updatePlan(t){return ue(this,null,function*(){if(!t){this.notificationService.warning("Please select a valid plan");return}let r=this.auth.currentUser;if(r)try{yield this.subscriptionService.updateSubscriptionPlan(r.uid,t),this.notificationService.success(`Subscription plan updated to ${t}`),this.loadSubscription()}catch(a){console.error("Error updating subscription plan:",a),this.notificationService.error("Failed to update subscription plan")}else this.notificationService.error("User not authenticated")})}updateDates(t,r){return ue(this,null,function*(){if(!t||!r){this.notificationService.warning("Please select valid start and end dates");return}if(t>=r){this.notificationService.warning("End date must be after start date");return}let a=this.auth.currentUser;if(a)try{yield this.subscriptionService.updateSubscriptionDates(a.uid,t,r),this.notificationService.success("Subscription dates updated successfully"),this.loadSubscription()}catch(o){console.error("Error updating subscription dates:",o),this.notificationService.error("Failed to update subscription dates")}else this.notificationService.error("User not authenticated")})}deleteSubscription(){return ue(this,null,function*(){let t=this.auth.currentUser;if(t)try{yield this.subscriptionService.deleteSubscription(t.uid),this.subscription=void 0,this.notificationService.success("Subscription deleted successfully")}catch(r){console.error("Error deleting subscription:",r),this.notificationService.error("Failed to delete subscription")}else this.notificationService.error("User not authenticated")})}};n.\u0275fac=function(r){return new(r||n)(q(Zb),q(pt),q(Kt),q(ht),q(At))},n.\u0275cmp=Ve({type:n,selectors:[["app-subscription"]],decls:5,vars:2,consts:[[4,"ngIf"],[3,"submit",4,"ngIf"],[3,"click"],[3,"submit"],["for","plan"],["id","plan","name","plan",3,"ngModelChange","ngModel"],["value","free"],["value","premium"],["for","startDate"],["type","date","id","startDate","name","startDate","required","",3,"ngModelChange","ngModel"],["for","endDate"],["type","date","id","endDate","name","endDate","required","",3,"ngModelChange","ngModel"],["type","submit"]],template:function(r,a){r&1&&(c(0,"div")(1,"h2"),d(2,"User Subscription"),l(),X(3,LL,13,9,"div",0)(4,VL,16,3,"form",1),l()),r&2&&(p(3),w("ngIf",a.subscription),p(),w("ngIf",!a.subscription))},dependencies:[ct,jn,Hs,qs,Vt,Gs,Ut,Un,Zs,Zn,$s,Vn]});let e=n;return e})();var Qf=Qs("goals"),ep=gn(Qf,e=>e.goals),Qb=gn(Qf,e=>e.loading),e2=gn(Qf,e=>e.error);var yG=gn(ep,e=>e.map(n=>le(ae({},n),{progress:n.currentAmount/n.targetAmount,percentage:Math.round(n.currentAmount/n.targetAmount*100)})));var jL=(e,n)=>n.goalId;function zL(e,n){if(e&1){let i=be();c(0,"div")(1,"div")(2,"p"),d(3),l(),c(4,"p"),d(5),pe(6,"currency"),l(),c(7,"p"),d(8),pe(9,"currency"),l(),c(10,"p"),d(11),pe(12,"date"),l(),c(13,"button",8),N("click",function(){let r=G(i).$implicit,a=S();return H(a.deleteGoal(r.goalId))}),d(14,"Delete"),l(),c(15,"button",8),N("click",function(){let r=G(i).$implicit,a=S();return H(a.updateCurrentAmount(r.goalId,100))}),d(16,"Add 100 to current amount"),l()()()}if(e&2){let i=n.$implicit,t=S();p(3),oe("Title: ",i.title,""),p(2),oe("Target Amount: ",Ee(6,4,i.targetAmount),""),p(3),oe("Current Amount: ",Ee(9,6,i.currentAmount),""),p(3),oe("Deadline: ",yt(12,8,t.dateService.toDate(i.deadline),"short"),"")}}var t2=(()=>{let n=class n{constructor(t,r,a,o,s){this.auth=t,this.router=r,this.notificationService=a,this.store=o,this.dateService=s,this.userId="",this.goals=[],this.newGoal={goalId:"",userId:"",title:"",targetAmount:0,currentAmount:0,deadline:Ai.fromDate(new Date)},this.destroy$=new vn,this.subscriptions=new Pi,this.goals$=this.store.select(ep),this.goalsLoading$=this.store.select(Qb),this.goalsError$=this.store.select(e2)}ngOnInit(){this.loadGoals(),this.subscribeToStoreData()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.destroy$.next(),this.destroy$.complete()}loadGoals(){let t=this.auth.currentUser;t&&(this.userId=t.uid,this.store.dispatch(ka({userId:this.userId})))}subscribeToStoreData(){this.subscriptions.add(this.goals$.subscribe(t=>{this.goals=t})),this.subscriptions.add(this.goalsError$.subscribe(t=>{t&&(console.error("Error loading goals:",t),this.notificationService.error("Failed to load goals"))}))}createGoal(){if(!this.newGoal.title||!this.newGoal.targetAmount){this.notificationService.warning("Please fill in all required fields");return}let t=this.auth.currentUser;t&&(this.newGoal.userId=t.uid,this.newGoal.goalId=`${this.newGoal.userId}-${new Date().getTime()}`,this.store.dispatch(_c({userId:t.uid,goal:this.newGoal})),this.notificationService.success("Goal created successfully"),this.newGoal={goalId:"",userId:"",title:"",targetAmount:0,currentAmount:0,deadline:Ai.fromDate(new Date)})}deleteGoal(t){let r=this.auth.currentUser;r&&(this.store.dispatch(Cc({userId:r.uid,goalId:t})),this.notificationService.success("Goal deleted successfully"))}updateCurrentAmount(t,r){if(r<=0){this.notificationService.warning("Please enter a valid amount");return}let a=this.auth.currentUser;a&&(this.store.dispatch(vc({userId:a.uid,goalId:t,amount:r})),this.notificationService.success("Goal progress updated successfully"))}};n.\u0275fac=function(r){return new(r||n)(q(pt),q(Kt),q(ht),q(wt),q(At))},n.\u0275cmp=Ve({type:n,selectors:[["app-goals"]],decls:17,vars:3,consts:[[3,"submit"],["for","title"],["type","text","id","title","name","title","required","",3,"ngModelChange","ngModel"],["for","targetAmount"],["type","number","id","targetAmount","name","targetAmount","required","",3,"ngModelChange","ngModel"],["for","deadline"],["type","date","id","deadline","name","deadline","required","",3,"ngModelChange","ngModel"],["type","submit"],[3,"click"]],template:function(r,a){r&1&&(c(0,"div")(1,"h2"),d(2,"User Goals"),l(),Ge(3,zL,17,11,"div",null,jL),c(5,"form",0),N("submit",function(){return a.createGoal()}),c(6,"label",1),d(7,"Title:"),l(),c(8,"input",2),gt("ngModelChange",function(s){return mt(a.newGoal.title,s)||(a.newGoal.title=s),s}),l(),c(9,"label",3),d(10,"Target Amount:"),l(),c(11,"input",4),gt("ngModelChange",function(s){return mt(a.newGoal.targetAmount,s)||(a.newGoal.targetAmount=s),s}),l(),c(12,"label",5),d(13,"Deadline:"),l(),c(14,"input",6),gt("ngModelChange",function(s){return mt(a.newGoal.deadline,s)||(a.newGoal.deadline=s),s}),l(),c(15,"button",7),d(16,"Add Goal"),l()()()),r&2&&(p(3),He(a.goals),p(5),ut("ngModel",a.newGoal.title),p(3),ut("ngModel",a.newGoal.targetAmount),p(3),ut("ngModel",a.newGoal.deadline))},dependencies:[jn,Vt,ki,Ut,Un,Zs,Zn,$s,Vn,Wi]});let e=n;return e})();var n2=(()=>{let n=class n extends bu{constructor(t,r){super(t,r),this.firestore=t,this.auth=r,this.COLLECTION_NAME="googleSheets"}extractSpreadsheetId(t){try{let r=new URL(t);if(r.hostname==="docs.google.com"&&r.pathname.includes("/spreadsheets/d/")){let a=r.pathname.split("/"),o=a.findIndex(s=>s==="d");if(o!==-1&&a[o+1])return a[o+1]}return null}catch(r){return console.error("Error extracting spreadsheet ID:",r),null}}validateSheetUrl(t){return!!this.extractSpreadsheetId(t)}getConnections(){try{let t=this.getCollectionRef(this.COLLECTION_NAME);return On(ya(t)).pipe(rt(r=>r.docs.map(a=>ae({id:a.id},a.data()))),_t(r=>this.handleError(r,"getConnections")))}catch(t){return this.handleError(t,"getConnections")}}createConnection(t){try{let r=this.extractSpreadsheetId(t.spreadsheetUrl);if(!r)return es(()=>new Error("Invalid Google Sheets URL"));let a=le(ae({},t),{spreadsheetId:r,id:this.generateId(),createdAt:new Date,updatedAt:new Date}),o=this.getDocumentRef(this.COLLECTION_NAME,a.id);return On(wr(o,a)).pipe(rt(()=>a),_t(s=>this.handleError(s,"createConnection")))}catch(r){return this.handleError(r,"createConnection")}}updateConnection(t,r){try{let a=this.getDocumentRef(this.COLLECTION_NAME,t),o=le(ae({},r),{updatedAt:new Date});return On(kn(a,o)).pipe(_t(s=>this.handleError(s,"updateConnection")))}catch(a){return this.handleError(a,"updateConnection")}}deleteConnection(t){try{let r=this.getDocumentRef(this.COLLECTION_NAME,t);return On(Di(r)).pipe(_t(a=>this.handleError(a,"deleteConnection")))}catch(r){return this.handleError(r,"deleteConnection")}}testConnection(t){try{let r=`https://docs.google.com/spreadsheets/d/${t.spreadsheetId}/gviz/tq?tqx=out:csv&sheet=${t.sheetName}`;return On(fetch(r,{method:"HEAD"})).pipe(rt(a=>a.ok),_t(a=>(console.error("Google Sheets connection test failed:",a),lt(!1))))}catch{return lt(!1)}}importFromSheet(t){try{let r=`https://docs.google.com/spreadsheets/d/${t.spreadsheetId}/gviz/tq?tqx=out:csv&sheet=${t.sheetName}`;return On(fetch(r)).pipe(zr(a=>{if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return On(a.text())}),rt(a=>{if(!a||a.trim()==="")return[];let o=a.split(`
`);if(o.length<2)return[];let s=this.parseCSVLine(o[0]);return o.slice(1).filter(m=>m.trim()!=="").map(m=>{let f=this.parseCSVLine(m),h={};return s.forEach((_,y)=>{h[_]=f[y]||""}),h})}),_t(a=>this.handleError(a,"importFromSheet")))}catch(r){return this.handleError(r,"importFromSheet")}}parseCSVLine(t){let r=[],a="",o=!1;for(let s=0;s<t.length;s++){let u=t[s];u==='"'?o=!o:u===","&&!o?(r.push(a.trim()),a=""):a+=u}return r.push(a.trim()),r}exportToSheet(t,r){return es(()=>new Error("Export is not supported in read-only mode. Please use the Google Sheets interface to edit data."))}getSetupInstructions(){return['1. Use the "Get Example Sheet" button below to open a template you can copy','2. In the example sheet, click "File" \u2192 "Make a copy" to create your own version',"3. Open your copied Google Sheet in the browser",'4. Click "Share" in the top right corner','5. Set sharing to "Anyone with the link can view"',"6. Copy the URL from your browser address bar",'7. Paste the URL in the "Sheet URL" field below','8. Enter the name of the specific sheet tab (e.g., "Sheet1", "Transactions")',"9. Test the connection to verify access","Note: This is read-only access for data import only"]}getApiDocsUrl(){return"https://support.google.com/docs/answer/2494822?hl=en"}};n.\u0275fac=function(r){return new(r||n)(De(Ki),De(pt))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();function YL(e,n){if(e&1&&(c(0,"li"),d(1),l()),e&2){let i=n.$implicit;p(),z(i)}}function $L(e,n){if(e&1&&(c(0,"div",50),d(1),l()),e&2){let i=S();p(),z(i.getFieldError("name"))}}function GL(e,n){if(e&1&&(c(0,"div",50),d(1),l()),e&2){let i=S();p(),z(i.getFieldError("sheetName"))}}function HL(e,n){if(e&1&&(c(0,"div",50),d(1),l()),e&2){let i=S();p(),z(i.getFieldError("spreadsheetUrl"))}}function qL(e,n){e&1&&se(0,"mat-spinner",51)}function XL(e,n){e&1&&(c(0,"mat-icon"),d(1,"wifi_tethering"),l())}function KL(e,n){e&1&&(c(0,"div",52),se(1,"mat-spinner",53),l())}function ZL(e,n){e&1&&(c(0,"div",54)(1,"mat-icon",55),d(2,"table_chart"),l(),c(3,"h4",56),d(4,"No connections yet"),l(),c(5,"p",57),d(6,"Create your first Google Sheets connection to import data"),l()())}function JL(e,n){e&1&&se(0,"mat-spinner",74)}function QL(e,n){e&1&&(c(0,"mat-icon"),d(1,"download"),l())}function eV(e,n){if(e&1){let i=be();c(0,"div",60)(1,"div",61)(2,"div",35)(3,"div",62)(4,"mat-icon",4),d(5,"table_chart"),l()(),c(6,"div")(7,"h4",63),d(8),l(),c(9,"p",64),d(10),l()()(),c(11,"div",65)(12,"mat-slide-toggle",66),N("change",function(r){let a=G(i).$implicit,o=S(2);return a.isActive=r.checked,H(o.updateConnection(a))}),l(),c(13,"button",67),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.deleteConnection(r))}),c(14,"mat-icon"),d(15,"delete"),l()()()(),c(16,"div",68)(17,"div")(18,"span",57),d(19,"Sheet:"),l(),c(20,"span",69),d(21),l()(),c(22,"div")(23,"span",57),d(24,"Status:"),l(),c(25,"span",69),d(26),l()(),c(27,"div")(28,"span",57),d(29,"Last Sync:"),l(),c(30,"span",69),d(31),pe(32,"date"),l()()(),c(33,"div",70)(34,"button",71),N("click",function(){let r=G(i).$implicit,a=S(2);return H(a.importFromSheet(r))}),X(35,JL,1,0,"mat-spinner",72)(36,QL,2,0,"mat-icon",41),d(37),l(),c(38,"a",73)(39,"mat-icon"),d(40,"open_in_new"),l(),d(41," Open Sheet "),l()()()}if(e&2){let i=n.$implicit,t=S(2);p(8),z(i.name),p(2),z(i.spreadsheetId),p(2),w("checked",i.isActive),p(9),z(i.sheetName),p(4),Lt(i.isActive?"text-green-600":"text-gray-500"),p(),oe(" ",i.isActive?"Active":"Inactive"," "),p(5),oe(" ",i.lastSync?yt(32,13,i.lastSync,"short"):"Never"," "),p(3),w("disabled",t.isImporting),p(),w("ngIf",t.isImporting),p(),w("ngIf",!t.isImporting),p(),oe(" ",t.isImporting?"Importing...":"Import Data"," "),p(),w("href",i.spreadsheetUrl,k0)}}function tV(e,n){if(e&1&&(c(0,"div",58),X(1,eV,42,16,"div",59),l()),e&2){let i=S();p(),w("ngForOf",i.connections)}}var i2=(()=>{let n=class n{constructor(t,r,a,o,s,u,m,f,h){this.googleSheetsService=t,this.formBuilder=r,this.dialog=a,this.snackBar=o,this.userService=s,this.breakpointService=u,this.transactionsService=m,this.store=f,this.auth=h,this.connections=[],this.isLoading=!1,this.isTestingConnection=!1,this.isImporting=!1,this.testConfig=null,this.destroy$=new vn,this.connectionForm=this.formBuilder.group({name:["",[Qe.required,Qe.minLength(3)]],spreadsheetUrl:["",[Qe.required,this.urlValidator.bind(this)]],sheetName:["Sheet1",[Qe.required]],isActive:[!0]})}ngOnInit(){this.loadConnections()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}urlValidator(t){return t.value?this.googleSheetsService.validateSheetUrl(t.value)?null:{invalidUrl:!0}:null}loadConnections(){this.isLoading=!0,this.googleSheetsService.getConnections().pipe(Qt(this.destroy$)).subscribe({next:t=>{this.connections=t,this.isLoading=!1},error:t=>{console.error("Error loading connections:",t),this.showSnackBar("Error loading connections","error"),this.isLoading=!1}})}createConnection(){if(this.connectionForm.valid){let t=this.connectionForm.value;this.googleSheetsService.createConnection(t).pipe(Qt(this.destroy$)).subscribe({next:r=>{this.connections.push(r),this.connectionForm.reset({sheetName:"Sheet1",isActive:!0}),this.showSnackBar("Connection created successfully","success")},error:r=>{console.error("Error creating connection:",r),this.showSnackBar("Error creating connection","error")}})}else this.markFormGroupTouched()}updateConnection(t){let r={name:t.name,isActive:t.isActive};this.googleSheetsService.updateConnection(t.id,r).pipe(Qt(this.destroy$)).subscribe({next:()=>{this.showSnackBar("Connection updated successfully","success")},error:a=>{console.error("Error updating connection:",a),this.showSnackBar("Error updating connection","error")}})}deleteConnection(t){confirm(`Are you sure you want to delete the connection "${t.name}"?`)&&this.googleSheetsService.deleteConnection(t.id).pipe(Qt(this.destroy$)).subscribe({next:()=>{this.connections=this.connections.filter(r=>r.id!==t.id),this.showSnackBar("Connection deleted successfully","success")},error:r=>{console.error("Error deleting connection:",r),this.showSnackBar("Error deleting connection","error")}})}testConnection(){if(this.connectionForm.valid){this.isTestingConnection=!0;let t=this.connectionForm.value,r=this.googleSheetsService.extractSpreadsheetId(t.spreadsheetUrl);if(!r){this.isTestingConnection=!1,this.showSnackBar("Invalid Google Sheets URL","error");return}this.testConfig={spreadsheetId:r,sheetName:t.sheetName},this.googleSheetsService.testConnection(this.testConfig).pipe(Qt(this.destroy$)).subscribe({next:a=>{this.isTestingConnection=!1,a?this.showSnackBar("Connection test successful!","success"):this.showSnackBar('Connection test failed. Please check your URL and sheet name, and ensure the sheet is shared with "Anyone with the link can view".',"error")},error:a=>{this.isTestingConnection=!1,console.error("Connection test error:",a),this.showSnackBar("Connection test failed","error")}})}else this.markFormGroupTouched()}importFromSheet(t){this.isImporting=!0;let r={spreadsheetId:t.spreadsheetId,sheetName:t.sheetName};this.googleSheetsService.importFromSheet(r).pipe(Qt(this.destroy$)).subscribe({next:a=>{if(this.isImporting=!1,a.length>0){let o=this.transformGoogleSheetsData(a);this.dialog.open(Xc,{data:{transactions:o},panelClass:this.breakpointService.device.isMobile?"mobile-dialog":"import-transactions-dialog"}).afterClosed().subscribe(u=>{u&&u.length>0&&this.createTransactionsFromImport(u)})}else this.showSnackBar("No data found in the specified sheet","warning")},error:a=>{this.isImporting=!1,console.error("Import error:",a),this.showSnackBar("Error importing data from Google Sheets","error")}})}transformGoogleSheetsData(t){return t.map(r=>({type:r.Type.toLowerCase(),category:r.Category.toLowerCase(),date:new Date(r.Date)||new Date,description:r.Description.toLowerCase(),amount:parseFloat(r.Amount)}))}createTransactionsFromImport(t){var u;let r=(u=this.auth.currentUser)==null?void 0:u.uid;if(!r){this.showSnackBar("User not authenticated","error");return}this.isImporting=!0;let a=0,o=0,s=t.map(m=>ue(this,null,function*(){try{let f={userId:r,payee:m.description||"Imported Transaction",accountId:m.accountId||"default",amount:parseFloat(m.amount),category:m.category||"Uncategorized",categoryId:m.categoryId||"default",type:m.type==="income"?en.INCOME:en.EXPENSE,date:new Date(m.date),notes:m.notes||`Imported from Google Sheets - ${m.description}`,status:bo.COMPLETED,isPending:!1,syncStatus:mi.PENDING,lastSyncedAt:new Date,createdAt:new Date,updatedAt:new Date,createdBy:r,updatedBy:r};yield this.transactionsService.createTransaction(r,f).toPromise(),a++}catch(f){console.error("Error creating transaction:",m,f),o++}}));Promise.all(s).then(()=>{this.isImporting=!1,a>0&&(this.showSnackBar(`Successfully imported ${a} transactions`,"success"),this.store.dispatch(ri({userId:r}))),o>0&&this.showSnackBar(`${o} transactions failed to import`,"warning")}).catch(m=>{this.isImporting=!1,console.error("Error during import:",m),this.showSnackBar("Error during import process","error")})}getSetupInstructions(){return this.googleSheetsService.getSetupInstructions()}openApiDocs(){window.open(this.googleSheetsService.getApiDocsUrl(),"_blank")}openExampleSheet(){window.open("https://docs.google.com/spreadsheets/d/1EDhMkaFWOedDEQSn1TQsl011b-H-5_XAXSIpi31QwTM/edit?usp=sharing","_blank")}markFormGroupTouched(){Object.keys(this.connectionForm.controls).forEach(t=>{let r=this.connectionForm.get(t);r==null||r.markAsTouched()})}showSnackBar(t,r="success"){this.snackBar.open(t,"Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"bottom",panelClass:r==="error"?["error-snackbar"]:r==="warning"?["warning-snackbar"]:["success-snackbar"]})}getFieldError(t){let r=this.connectionForm.get(t);if(r!=null&&r.errors&&r.touched){if(r.errors.required)return"This field is required";if(r.errors.minlength)return`Minimum length is ${r.errors.minlength.requiredLength} characters`;if(r.errors.invalidUrl)return"Please enter a valid Google Sheets URL"}return""}};n.\u0275fac=function(r){return new(r||n)(q(n2),q(Ii),q(fn),q(J1),q(gi),q(Qi),q(Ao),q(wt),q(pt))},n.\u0275cmp=Ve({type:n,selectors:[["app-google-sheets"]],decls:80,vars:13,consts:[[1,"google-sheets-container","p-6","max-w-6xl","mx-auto"],[1,"mb-8"],[1,"flex","items-start","gap-3","mb-3"],[1,"w-10","h-10","bg-gradient-to-br","mt-2","from-green-500","to-blue-600","rounded-lg","flex","items-start","justify-start"],[1,"text-white"],[1,"text-2xl","!m-0","font-bold","text-gray-900"],[1,"text-gray-600","text-sm"],[1,"bg-blue-50","border","border-blue-200","rounded-xl","p-6","mb-8"],[1,"flex","items-center","gap-3","mb-4"],[1,"text-blue-600"],[1,"text-lg","font-semibold","text-blue-900"],[1,"bg-green-50","border","border-green-200","rounded-lg","p-4","mb-4"],[1,"flex","items-center","gap-2","mb-2"],[1,"text-green-600"],[1,"font-medium","text-green-800"],[1,"text-sm","text-green-700","mb-3"],[1,"space-y-2","text-sm","text-blue-800"],[1,"list-decimal","list-inside","space-y-1"],[4,"ngFor","ngForOf"],[1,"mt-4","flex","gap-3"],["mat-stroked-button","","color","primary",1,"text-blue-600","border-blue-600",3,"click"],[1,"mr-2"],["mat-raised-button","","color","accent",1,"bg-green-600","text-white",3,"click"],[1,"bg-white","border","border-gray-200","rounded-xl","p-6","mb-8","shadow-sm"],[1,"text-xl","font-semibold","text-gray-900","mb-6"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["for","name",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","name","type","text","formControlName","name","placeholder","My Google Sheets Connection",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors"],["class","text-red-600 text-sm mt-1",4,"ngIf"],["for","sheetName",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","sheetName","type","text","formControlName","sheetName","placeholder","Sheet1",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors"],["for","spreadsheetUrl",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","spreadsheetUrl","type","url","formControlName","spreadsheetUrl","placeholder","https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors"],[1,"text-gray-500","text-sm","mt-1"],[1,"flex","items-center","gap-3"],["formControlName","isActive","color","primary"],[1,"text-sm","font-medium","text-gray-700"],[1,"flex","gap-4"],["type","button","mat-stroked-button","","color","primary",1,"flex","items-center","gap-2",3,"click","disabled"],["diameter","20",4,"ngIf"],[4,"ngIf"],["type","submit","mat-raised-button","","color","primary",1,"flex","items-center","gap-2",3,"disabled"],[1,"bg-white","border","border-gray-200","rounded-xl","shadow-sm"],[1,"p-6","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-900"],[1,"p-6"],["class","flex justify-center py-8",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","space-y-4",4,"ngIf"],[1,"text-red-600","text-sm","mt-1"],["diameter","20"],[1,"flex","justify-center","py-8"],["diameter","40"],[1,"text-center","py-12"],[1,"text-gray-400","text-6xl","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"space-y-4"],["class","border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",4,"ngFor","ngForOf"],[1,"border","border-gray-200","rounded-lg","p-4","hover:shadow-md","transition-shadow"],[1,"flex","items-center","justify-between","mb-4"],[1,"w-10","h-10","bg-gradient-to-br","from-green-500","to-blue-600","rounded-lg","flex","items-center","justify-center"],[1,"font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","gap-2"],["color","primary",3,"change","checked"],["mat-icon-button","","color","warn","matTooltip","Delete Connection",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","text-sm"],[1,"font-medium","ml-1"],[1,"flex","gap-3","mt-4"],["mat-stroked-button","","color","primary",1,"flex","items-center","gap-2",3,"click","disabled"],["diameter","16",4,"ngIf"],["target","_blank","mat-stroked-button","","color","accent",1,"flex","items-center","gap-2",3,"href"],["diameter","16"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-icon",4),d(5,"table_chart"),l()(),c(6,"div")(7,"h1",5),d(8,"Google Sheets"),l(),c(9,"p",6),d(10,"Import your financial data from Google Sheets "),l()()()(),c(11,"div",7)(12,"div",8)(13,"mat-icon",9),d(14,"info"),l(),c(15,"h3",10),d(16,"Setup Instructions"),l()(),c(17,"div",11)(18,"div",12)(19,"mat-icon",13),d(20,"lightbulb"),l(),c(21,"span",14),d(22,"Quick Start"),l()(),c(23,"p",15),d(24,' Not sure how to format your Google Sheet? Click "Get Example Sheet" below to open a template you can copy and use as a starting point. '),l()(),c(25,"div",16)(26,"ol",17),X(27,YL,2,1,"li",18),l()(),c(28,"div",19)(29,"button",20),N("click",function(){return a.openApiDocs()}),c(30,"mat-icon",21),d(31,"open_in_new"),l(),d(32," View Google Sheets Help "),l(),c(33,"button",22),N("click",function(){return a.openExampleSheet()}),c(34,"mat-icon",21),d(35,"content_copy"),l(),d(36," Get Example Sheet "),l()()(),c(37,"div",23)(38,"h3",24),d(39,"Add New Connection"),l(),c(40,"form",25),N("ngSubmit",function(){return a.createConnection()}),c(41,"div",26)(42,"div")(43,"label",27),d(44,"Connection Name"),l(),se(45,"input",28),X(46,$L,2,1,"div",29),l(),c(47,"div")(48,"label",30),d(49,"Sheet Name"),l(),se(50,"input",31),X(51,GL,2,1,"div",29),l()(),c(52,"div")(53,"label",32),d(54,"Google Sheets URL"),l(),se(55,"input",33),X(56,HL,2,1,"div",29),c(57,"p",34),d(58,'Make sure your Google Sheet is shared with "Anyone with the link can view"'),l()(),c(59,"div",35),se(60,"mat-slide-toggle",36),c(61,"label",37),d(62,"Active Connection"),l()(),c(63,"div",38)(64,"button",39),N("click",function(){return a.testConnection()}),X(65,qL,1,0,"mat-spinner",40)(66,XL,2,0,"mat-icon",41),d(67),l(),c(68,"button",42)(69,"mat-icon"),d(70,"add"),l(),d(71," Create Connection "),l()()()(),c(72,"div",43)(73,"div",44)(74,"h3",45),d(75,"Your Connections"),l()(),c(76,"div",46),X(77,KL,2,0,"div",47)(78,ZL,7,0,"div",48)(79,tV,2,1,"div",49),l()()()),r&2&&(p(27),w("ngForOf",a.getSetupInstructions()),p(13),w("formGroup",a.connectionForm),p(6),w("ngIf",a.getFieldError("name")),p(5),w("ngIf",a.getFieldError("sheetName")),p(5),w("ngIf",a.getFieldError("spreadsheetUrl")),p(8),w("disabled",a.isTestingConnection||!a.connectionForm.valid),p(),w("ngIf",a.isTestingConnection),p(),w("ngIf",!a.isTestingConnection),p(),oe(" ",a.isTestingConnection?"Testing...":"Test Connection"," "),p(),w("disabled",!a.connectionForm.valid),p(9),w("ngIf",a.isLoading),p(),w("ngIf",!a.isLoading&&a.connections.length===0),p(),w("ngIf",!a.isLoading&&a.connections.length>0))},dependencies:[$r,ct,jn,Vt,Ut,Un,Ei,Ti,K1,Ht,bn,at,Xr,Jn,Jr,Vn],styles:[".google-sheets-container[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#f8fafc,#e2e8f0)}  .success-snackbar{background:#10b981;color:#fff}  .success-snackbar .mat-simple-snackbar-action{color:#fff}  .error-snackbar{background:#ef4444;color:#fff}  .error-snackbar .mat-simple-snackbar-action{color:#fff}  .warning-snackbar{background:#f59e0b;color:#fff}  .warning-snackbar .mat-simple-snackbar-action{color:#fff}input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f61a}button[mat-raised-button][_ngcontent-%COMP%]{transition:all .2s ease-in-out}button[mat-raised-button][_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 12px #00000026}button[mat-stroked-button][_ngcontent-%COMP%]{transition:all .2s ease-in-out}button[mat-stroked-button][_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px)}.connection-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.connection-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a}.loading-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:200px}@media (max-width: 768px){.google-sheets-container[_ngcontent-%COMP%]{padding:1rem}.grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.flex[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.connection-item[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-out}.google-sheets-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.google-sheets-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:4px}.google-sheets-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}.google-sheets-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}"]});let e=n;return e})();var tp=Qs("budgets"),r2=gn(tp,e=>e.budgets),a2=gn(tp,e=>e.loading),o2=gn(tp,e=>e.error);var iV=(e,n)=>n.budgetId;function rV(e,n){if(e&1){let i=be();c(0,"div")(1,"div")(2,"p"),d(3),l(),c(4,"p"),d(5),pe(6,"currency"),l(),c(7,"p"),d(8),pe(9,"currency"),l(),c(10,"p"),d(11),pe(12,"date"),l(),c(13,"p"),d(14),pe(15,"date"),l(),c(16,"button",10),N("click",function(){let r=G(i).$implicit,a=S();return H(a.deleteBudget(r.budgetId))}),d(17,"Delete"),l(),c(18,"button",10),N("click",function(){let r=G(i).$implicit,a=S();return H(a.updateSpent(r.budgetId,50))}),d(19,"Add 50 to spent"),l()()()}if(e&2){let i=n.$implicit,t=S();p(3),oe("Category: ",i.category,""),p(2),oe("Limit: ",Ee(6,5,i.limit),""),p(3),oe("Spent: ",Ee(9,7,i.spent),""),p(3),oe("Start Date: ",yt(12,9,t.dateService.toDate(i.startDate),"short"),""),p(3),oe("End Date: ",yt(15,12,t.dateService.toDate(i.endDate),"short"),"")}}var s2=(()=>{let n=class n{constructor(t,r,a,o,s){this.auth=t,this.router=r,this.notificationService=a,this.store=o,this.dateService=s,this.userId="",this.budgets=[],this.newBudget={budgetId:"",userId:"",category:"Groceries",limit:0,spent:0,startDate:Ai.fromDate(new Date),endDate:Ai.fromDate(new Date)},this.destroy$=new vn,this.subscriptions=new Pi,this.budgets$=this.store.select(r2),this.budgetsLoading$=this.store.select(a2),this.budgetsError$=this.store.select(o2)}ngOnInit(){this.loadBudgets(),this.subscribeToStoreData()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.destroy$.next(),this.destroy$.complete()}loadBudgets(){let t=this.auth.currentUser;t&&(this.userId=t.uid,this.store.dispatch(Oa({userId:this.userId})))}subscribeToStoreData(){this.subscriptions.add(this.budgets$.subscribe(t=>{this.budgets=t})),this.subscriptions.add(this.budgetsError$.subscribe(t=>{t&&(console.error("Error loading budgets:",t),this.notificationService.error("Failed to load budgets"))}))}createBudget(){if(!this.newBudget.category||!this.newBudget.limit){this.notificationService.warning("Please fill in all required fields");return}if(this.newBudget.limit<=0){this.notificationService.warning("Budget limit must be greater than 0");return}let t=this.auth.currentUser;t&&(this.newBudget.userId=t.uid,this.newBudget.budgetId=`${this.newBudget.userId}-${new Date().getTime()}`,this.store.dispatch(pc({userId:t.uid,budget:this.newBudget})),this.notificationService.success("Budget created successfully"),this.newBudget={budgetId:"",userId:"",category:"Groceries",limit:0,spent:0,startDate:Ai.fromDate(new Date),endDate:Ai.fromDate(new Date)})}deleteBudget(t){let r=this.auth.currentUser;r&&(this.store.dispatch(hc({userId:r.uid,budgetId:t})),this.notificationService.success("Budget deleted successfully"))}updateSpent(t,r){if(r<0){this.notificationService.warning("Spent amount cannot be negative");return}let a=this.auth.currentUser;a&&(this.store.dispatch(xc({userId:a.uid,budgetId:t,amount:r})),this.notificationService.success("Budget spent amount updated successfully"))}};n.\u0275fac=function(r){return new(r||n)(q(pt),q(Kt),q(ht),q(wt),q(At))},n.\u0275cmp=Ve({type:n,selectors:[["app-budgets"]],decls:20,vars:4,consts:[[3,"submit"],["for","category"],["type","text","id","category","name","category","required","",3,"ngModelChange","ngModel"],["for","limit"],["type","number","id","limit","name","limit","required","",3,"ngModelChange","ngModel"],["for","startDate"],["type","date","id","startDate","name","startDate","required","",3,"ngModelChange","ngModel"],["for","endDate"],["type","date","id","endDate","name","endDate","required","",3,"ngModelChange","ngModel"],["type","submit"],[3,"click"]],template:function(r,a){r&1&&(c(0,"div")(1,"h2"),d(2,"User Budgets"),l(),Ge(3,rV,20,15,"div",null,iV),c(5,"form",0),N("submit",function(){return a.createBudget()}),c(6,"label",1),d(7,"Category:"),l(),c(8,"input",2),gt("ngModelChange",function(s){return mt(a.newBudget.category,s)||(a.newBudget.category=s),s}),l(),c(9,"label",3),d(10,"Limit:"),l(),c(11,"input",4),gt("ngModelChange",function(s){return mt(a.newBudget.limit,s)||(a.newBudget.limit=s),s}),l(),c(12,"label",5),d(13,"Start Date:"),l(),c(14,"input",6),gt("ngModelChange",function(s){return mt(a.newBudget.startDate,s)||(a.newBudget.startDate=s),s}),l(),c(15,"label",7),d(16,"End Date:"),l(),c(17,"input",8),gt("ngModelChange",function(s){return mt(a.newBudget.endDate,s)||(a.newBudget.endDate=s),s}),l(),c(18,"button",9),d(19,"Add Budget"),l()()()),r&2&&(p(3),He(a.budgets),p(5),ut("ngModel",a.newBudget.category),p(3),ut("ngModel",a.newBudget.limit),p(3),ut("ngModel",a.newBudget.startDate),p(3),ut("ngModel",a.newBudget.endDate))},dependencies:[jn,Vt,ki,Ut,Un,Zs,Zn,$s,Vn,Wi]});let e=n;return e})();var c2=Tr(Nr());var aV=(e,n)=>n.value,oV=(e,n)=>n.code;function sV(e,n){e&1&&(c(0,"mat-icon"),d(1,"edit"),l())}function cV(e,n){e&1&&(c(0,"mat-icon"),d(1,"save"),l())}function lV(e,n){if(e&1){let i=be();c(0,"button",16),N("click",function(){G(i);let r=S();return H(r.toggleEdit())}),X(1,sV,2,0,"mat-icon",17)(2,cV,2,0,"mat-icon",17),l()}if(e&2){let i=S();p(),w("ngIf",!i.isEditing),p(),w("ngIf",i.isEditing)}}function dV(e,n){e&1&&(c(0,"div",18),se(1,"mat-spinner",19),c(2,"p",20),d(3,"Loading profile..."),l()())}function uV(e,n){if(e&1){let i=be();c(0,"button",21),N("click",function(){G(i);let r=S();return H(r.toggleEdit())}),c(1,"mat-icon"),d(2),l(),d(3),l()}if(e&2){let i=S();w("disabled",i.isLoading),p(2),z(i.isEditing?"close":"edit"),p(),oe(" ",i.isEditing?"Cancel Edit":"Edit Profile"," ")}}function mV(e,n){e&1&&(c(0,"mat-error"),d(1," First name is required "),l())}function gV(e,n){e&1&&(c(0,"mat-error"),d(1," First name must be at least 2 characters "),l())}function fV(e,n){e&1&&(c(0,"mat-error"),d(1," Last name is required "),l())}function pV(e,n){e&1&&(c(0,"mat-error"),d(1," Last name must be at least 2 characters "),l())}function hV(e,n){e&1&&(c(0,"mat-error"),d(1," Email is required "),l())}function xV(e,n){e&1&&(c(0,"mat-error"),d(1," Please enter a valid email "),l())}function _V(e,n){e&1&&(c(0,"mat-error"),d(1," Please enter a valid phone number "),l())}function CV(e,n){e&1&&(c(0,"mat-error"),d(1," Income cannot be negative "),l())}function vV(e,n){if(e&1&&(c(0,"mat-option",40),d(1),l()),e&2){let i=n.$implicit;w("value",i),p(),oe(" ",i," ")}}function bV(e,n){if(e&1&&(c(0,"mat-option",40),d(1),l()),e&2){let i=n.$implicit;w("value",i.value),p(),oe(" ",i.label," ")}}function yV(e,n){if(e&1&&(c(0,"mat-option",40),d(1),l()),e&2){let i=n.$implicit;w("value",i.code),p(),oe(" ",i.name," ")}}function MV(e,n){e&1&&(c(0,"mat-icon"),d(1,"hourglass_empty"),l())}function wV(e,n){e&1&&(c(0,"mat-icon"),d(1,"save"),l())}function SV(e,n){if(e&1){let i=be();c(0,"div",58)(1,"button",59),N("click",function(){G(i);let r=S(2);return H(r.cancelEdit())}),d(2," Cancel "),l(),c(3,"button",60),X(4,MV,2,0,"mat-icon",17)(5,wV,2,0,"mat-icon",17),d(6),l()()}if(e&2){let i=S(2);p(),w("disabled",i.isLoading),p(2),w("disabled",i.profileForm.invalid||i.isLoading),p(),w("ngIf",i.isLoading),p(),w("ngIf",!i.isLoading),p(),oe(" ",i.isLoading?"Saving...":"Save Changes"," ")}}function PV(e,n){if(e&1){let i=be();c(0,"div",22)(1,"form",23),N("ngSubmit",function(){G(i);let r=S();return H(r.saveProfile())}),c(2,"div",24)(3,"div",25)(4,"mat-icon",26),d(5,"person"),l(),c(6,"h2"),d(7,"Personal Information"),l()(),c(8,"div",27)(9,"mat-form-field",28)(10,"mat-label"),d(11,"First Name *"),l(),se(12,"input",29),X(13,mV,2,0,"mat-error",17)(14,gV,2,0,"mat-error",17),l(),c(15,"mat-form-field",28)(16,"mat-label"),d(17,"Last Name *"),l(),se(18,"input",30),X(19,fV,2,0,"mat-error",17)(20,pV,2,0,"mat-error",17),l(),c(21,"mat-form-field",28)(22,"mat-label"),d(23,"Email *"),l(),se(24,"input",31),X(25,hV,2,0,"mat-error",17)(26,xV,2,0,"mat-error",17),l(),c(27,"mat-form-field",28)(28,"mat-label"),d(29,"Phone Number"),l(),se(30,"input",32),X(31,_V,2,0,"mat-error",17),l(),c(32,"mat-form-field",28)(33,"mat-label"),d(34,"Date of Birth"),l(),se(35,"input",33)(36,"mat-datepicker-toggle",34)(37,"mat-datepicker",null,0),l(),c(39,"mat-form-field",28)(40,"mat-label"),d(41,"Occupation"),l(),se(42,"input",35),l(),c(43,"mat-form-field",28)(44,"mat-label"),d(45,"Monthly Income"),l(),se(46,"input",36),c(47,"span",37),d(48),l(),X(49,CV,2,0,"mat-error",17),l()()(),c(50,"div",38)(51,"div",25)(52,"mat-icon",26),d(53,"settings"),l(),c(54,"h2"),d(55,"Preferences"),l()(),c(56,"div",27)(57,"mat-form-field",28)(58,"mat-label"),d(59,"Default Currency *"),l(),c(60,"mat-select",39),Ge(61,vV,2,2,"mat-option",40,Oi),l()(),c(63,"mat-form-field",28)(64,"mat-label"),d(65,"Timezone *"),l(),c(66,"mat-select",41),Ge(67,bV,2,2,"mat-option",40,aV),l()(),c(69,"mat-form-field",28)(70,"mat-label"),d(71,"Language *"),l(),c(72,"mat-select",42),Ge(73,yV,2,2,"mat-option",40,oV),l()()(),c(75,"div",43)(76,"div",44)(77,"mat-slide-toggle",45)(78,"span",46),d(79,"Push Notifications"),l()(),c(80,"p",47),d(81,"Receive notifications about important updates"),l()(),c(82,"div",44)(83,"mat-slide-toggle",48)(84,"span",46),d(85,"Email Updates"),l()(),c(86,"p",47),d(87,"Receive weekly financial summaries via email"),l()(),c(88,"div",44)(89,"mat-slide-toggle",49)(90,"span",46),d(91,"Budget Alerts"),l()(),c(92,"p",47),d(93,"Get notified when you exceed budget limits"),l()()()(),X(94,SV,7,5,"div",50),l(),c(95,"div",51)(96,"div",25)(97,"mat-icon",26),d(98,"security"),l(),c(99,"h2"),d(100,"Account Actions"),l()(),c(101,"div",52)(102,"div",53)(103,"mat-icon",54),d(104,"lock"),l(),c(105,"h3"),d(106,"Change Password"),l(),c(107,"p"),d(108,"Update your account password for better security"),l(),c(109,"button",55),N("click",function(){G(i);let r=S();return H(r.changePassword())}),d(110," Change Password "),l()(),c(111,"div",53)(112,"mat-icon",54),d(113,"download"),l(),c(114,"h3"),d(115,"Export Data"),l(),c(116,"p"),d(117,"Download all your financial data as a backup"),l(),c(118,"button",55),N("click",function(){G(i);let r=S();return H(r.exportData())}),d(119," Export Data "),l()(),c(120,"div",56)(121,"mat-icon",54),d(122,"delete_forever"),l(),c(123,"h3"),d(124,"Delete Account"),l(),c(125,"p"),d(126,"Permanently delete your account and all associated data"),l(),c(127,"button",57),N("click",function(){G(i);let r=S();return H(r.deleteAccount())}),d(128," Delete Account "),l()()()()()}if(e&2){let i,t,r,a,o,s,u,m,f=Gn(38),h=S();p(),w("formGroup",h.profileForm),p(11),w("readonly",!h.isEditing),p(),w("ngIf",(i=h.profileForm.get("firstName"))==null?null:i.hasError("required")),p(),w("ngIf",(t=h.profileForm.get("firstName"))==null?null:t.hasError("minlength")),p(4),w("readonly",!h.isEditing),p(),w("ngIf",(r=h.profileForm.get("lastName"))==null?null:r.hasError("required")),p(),w("ngIf",(a=h.profileForm.get("lastName"))==null?null:a.hasError("minlength")),p(4),w("readonly",!h.isEditing),p(),w("ngIf",(o=h.profileForm.get("email"))==null?null:o.hasError("required")),p(),w("ngIf",(s=h.profileForm.get("email"))==null?null:s.hasError("email")),p(4),w("readonly",!h.isEditing),p(),w("ngIf",(u=h.profileForm.get("phone"))==null?null:u.hasError("pattern")),p(4),w("matDatepicker",f)("readonly",!h.isEditing),p(),w("for",f)("disabled",!h.isEditing),p(6),w("readonly",!h.isEditing),p(4),w("readonly",!h.isEditing),p(2),oe("",h.userProfile.preferences==null?null:h.userProfile.preferences.defaultCurrency,"\xA0"),p(),w("ngIf",(m=h.profileForm.get("monthlyIncome"))==null?null:m.hasError("min")),p(11),w("disabled",!h.isEditing),p(),He(h.currencies),p(5),w("disabled",!h.isEditing),p(),He(h.timezones),p(5),w("disabled",!h.isEditing),p(),He(h.languages),p(4),w("disabled",!h.isEditing),p(6),w("disabled",!h.isEditing),p(6),w("disabled",!h.isEditing),p(5),w("ngIf",h.isEditing)}}var l2=(()=>{let n=class n{constructor(t,r,a,o,s,u,m,f,h){this.fb=t,this.auth=r,this.router=a,this.notificationService=o,this.validationService=s,this.dialog=u,this.dateService=m,this.store=f,this.breakpointObserver=h,this.isLoading=!1,this.isEditing=!1,this.userProfile=null,this.currencies=Object.values(Y1),this.defaultCurrency=Dt.CURRENCY.DEFAULT,this.languages=Object.entries(Dt.LANGUAGE.NAMES).map(([_,y])=>({code:_,name:y})),this.validation=Dt.VALIDATION,this.timezones=G1,this.isMobile=!1,this.destroy$=new vn,this.subscriptions=new Pi,this.isMobile=this.breakpointObserver.isMatched("(max-width: 600px)"),this.profile$=this.store.select(rx),this.profileLoading$=this.store.select(ax),this.profileError$=this.store.select(ox),this.profileForm=this.fb.group({firstName:["",this.validationService.getProfileNameValidators()],lastName:["",this.validationService.getProfileNameValidators()],email:["",this.validationService.getProfileEmailValidators()],phone:["",this.validationService.getProfilePhoneValidators()],dateOfBirth:[""],occupation:["",this.validationService.getProfileOccupationValidators()],monthlyIncome:[0,this.validationService.getProfileIncomeValidators()],preferences:this.fb.group({defaultCurrency:[this.defaultCurrency,Qe.required],timezone:["UTC",Qe.required],language:[Dt.LANGUAGE.DEFAULT,Qe.required],notifications:[!0],emailUpdates:[!0],budgetAlerts:[!0]})})}ngOnInit(){this.loadUserProfile(),this.subscribeToStoreData()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.destroy$.next(),this.destroy$.complete()}loadUserProfile(){return ue(this,null,function*(){try{if(this.isLoading=!0,this.currentUser=this.auth.currentUser,!this.currentUser){this.notificationService.error(zn.AUTH.USER_NOT_FOUND),this.router.navigate(["/sign-in"]);return}this.store.dispatch(Ea({userId:this.currentUser.uid}))}catch(t){console.error("Error loading profile:",t),this.notificationService.error(zn.NETWORK.SERVER_ERROR)}finally{this.isLoading=!1}})}subscribeToStoreData(){this.subscriptions.add(this.profile$.subscribe(t=>{t&&(this.userProfile=this.mapUserToProfile(t),this.populateForm())})),this.subscriptions.add(this.profileLoading$.subscribe(t=>{this.isLoading=t})),this.subscriptions.add(this.profileError$.subscribe(t=>{t&&(console.error("Error loading profile:",t),this.notificationService.error(zn.NETWORK.SERVER_ERROR))}))}mapUserToProfile(t){var r,a,o,s,u,m;return{uid:t.uid,firstName:t.firstName||"",lastName:t.lastName||"",email:t.email,phone:t.phone||"",dateOfBirth:this.dateService.toDate(t.dateOfBirth||0)||new Date,occupation:t.occupation||"",monthlyIncome:t.monthlyIncome||0,preferences:{defaultCurrency:((r=t.preferences)==null?void 0:r.defaultCurrency)||this.defaultCurrency,timezone:((a=t.preferences)==null?void 0:a.timezone)||"UTC",language:((o=t.preferences)==null?void 0:o.language)||Dt.LANGUAGE.DEFAULT,notifications:((s=t.preferences)==null?void 0:s.notifications)||!0,emailUpdates:((u=t.preferences)==null?void 0:u.emailUpdates)||!0,budgetAlerts:((m=t.preferences)==null?void 0:m.budgetAlerts)||!0},role:t.role,createdAt:t.createdAt,updatedAt:this.dateService.toTimestamp(t.updatedAt)||new Date}}createDefaultProfile(){var t,r;return{uid:this.currentUser.uid,firstName:((t=this.currentUser.displayName)==null?void 0:t.split(" ")[0])||"",lastName:((r=this.currentUser.displayName)==null?void 0:r.split(" ").slice(1).join(" "))||"",email:this.currentUser.email||"",phone:"",dateOfBirth:void 0,occupation:"",monthlyIncome:0,preferences:{defaultCurrency:this.defaultCurrency,timezone:"UTC",language:Dt.LANGUAGE.DEFAULT,notifications:!0,emailUpdates:!0,budgetAlerts:!0},role:og.FREE,createdAt:new Date,updatedAt:new Date}}populateForm(){var t,r,a,o,s,u;this.userProfile&&this.profileForm.patchValue({firstName:this.userProfile.firstName,lastName:this.userProfile.lastName,email:this.userProfile.email,phone:this.userProfile.phone||"",dateOfBirth:this.userProfile.dateOfBirth||"",occupation:this.userProfile.occupation||"",monthlyIncome:this.userProfile.monthlyIncome||0,preferences:{defaultCurrency:((t=this.userProfile.preferences)==null?void 0:t.defaultCurrency)||this.defaultCurrency,timezone:((r=this.userProfile.preferences)==null?void 0:r.timezone)||"UTC",language:((a=this.userProfile.preferences)==null?void 0:a.language)||Dt.LANGUAGE.DEFAULT,notifications:((o=this.userProfile.preferences)==null?void 0:o.notifications)||!0,emailUpdates:((s=this.userProfile.preferences)==null?void 0:s.emailUpdates)||!0,budgetAlerts:((u=this.userProfile.preferences)==null?void 0:u.budgetAlerts)||!0}})}toggleEdit(){this.isEditing=!this.isEditing,this.isEditing?this.notificationService.info("Edit mode enabled"):(this.notificationService.info("Edit mode disabled"),this.saveProfile())}saveProfile(){return ue(this,null,function*(){if(this.profileForm.invalid){this.notificationService.warning(zn.VALIDATION.REQUIRED_FIELD);return}try{this.isLoading=!0;let t=this.profileForm.value;if(this.userProfile){let r={uid:this.userProfile.uid,email:t.email,role:og.FREE,createdAt:this.userProfile.createdAt,preferences:t.preferences,firstName:t.firstName,lastName:t.lastName,phone:t.phone,dateOfBirth:t.dateOfBirth,occupation:t.occupation,monthlyIncome:t.monthlyIncome,updatedAt:new Date};this.store.dispatch(bc({userId:this.currentUser.uid,profile:r})),this.notificationService.success($1.GENERAL.UPDATED),this.isEditing=!1}}catch(t){console.error("Error saving profile:",t),this.notificationService.error(zn.NETWORK.SERVER_ERROR)}finally{this.isLoading=!1}})}cancelEdit(){this.populateForm(),this.isEditing=!1,this.notificationService.info("Changes cancelled")}deleteAccount(){return ue(this,null,function*(){this.dialog.open(Kr,{width:"400px",data:{title:"Delete Account",message:"Are you sure you want to delete your account? This action cannot be undone and all your data will be permanently lost.",confirmText:"Delete Account",cancelText:"Cancel",confirmColor:"warn"}}).afterClosed().subscribe(r=>ue(this,null,function*(){if(r)try{this.isLoading=!0,yield this.currentUser.delete(),this.notificationService.success("Account deleted successfully"),this.router.navigate(["/sign-in"])}catch(a){console.error("Error deleting account:",a),this.notificationService.error(zn.NETWORK.SERVER_ERROR)}finally{this.isLoading=!1}}))})}changePassword(){return ue(this,null,function*(){this.notificationService.info("Password change feature coming soon")})}exportData(){return ue(this,null,function*(){try{if(!Dt.FEATURES.EXPORT_FUNCTIONALITY){this.notificationService.warning(zn.PERMISSION.FEATURE_NOT_AVAILABLE);return}this.notificationService.info("Data export feature coming soon")}catch(t){console.error("Error exporting data:",t),this.notificationService.error(zn.NETWORK.SERVER_ERROR)}})}getFullName(){return this.userProfile?`${this.userProfile.firstName} ${this.userProfile.lastName}`.trim():"User"}getTimezoneLabel(t){let r=this.timezones.find(a=>a.value===t);return r?r.label:t}getLanguageName(t){return Dt.LANGUAGE.NAMES[t]||t}getFormattedDate(t){return t?(0,c2.default)((t==null?void 0:t.seconds)*1e3).format("MMM DD, YYYY"):"N/A"}getFirstNameError(){let t=this.profileForm.get("firstName");return t?this.validationService.getProfileNameError(t):""}getLastNameError(){let t=this.profileForm.get("lastName");return t?this.validationService.getProfileNameError(t):""}getEmailError(){let t=this.profileForm.get("email");return t?this.validationService.getProfileEmailError(t):""}getPhoneError(){let t=this.profileForm.get("phone");return t?this.validationService.getProfilePhoneError(t):""}getOccupationError(){let t=this.profileForm.get("occupation");return t?this.validationService.getProfileOccupationError(t):""}getIncomeError(){let t=this.profileForm.get("monthlyIncome");return t?this.validationService.getProfileIncomeError(t):""}};n.\u0275fac=function(r){return new(r||n)(q(Ii),q(pt),q(Kt),q(ht),q(qr),q(fn),q(At),q(wt),q(Zi))},n.\u0275cmp=Ve({type:n,selectors:[["app-profile"]],decls:19,vars:7,consts:[["dobPicker",""],["mat-fab","","color","primary","class"," mobile-fab-btn",3,"click",4,"ngIf"],[1,"profile-container"],["class","loading-overlay",4,"ngIf"],[1,"profile-header"],[1,"header-content"],[1,"avatar-section"],[1,"avatar"],[1,"avatar-icon"],[1,"user-info"],[1,"user-name"],[1,"user-email"],[1,"user-role"],[1,"header-actions"],["mat-raised-button","","color","primary","class","edit-btn",3,"disabled","click",4,"ngIf"],["class","profile-content",4,"ngIf"],["mat-fab","","color","primary",1,"mobile-fab-btn",3,"click"],[4,"ngIf"],[1,"loading-overlay"],["diameter","40"],[1,"mt-4","text-gray-600"],["mat-raised-button","","color","primary",1,"edit-btn",3,"click","disabled"],[1,"profile-content"],[1,"profile-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"section-header"],[1,"section-icon"],[1,"form-grid"],["appearance","fill",1,"form-field"],["matInput","","formControlName","firstName","autocomplete","given-name",3,"readonly"],["matInput","","formControlName","lastName","autocomplete","family-name",3,"readonly"],["matInput","","type","email","formControlName","email","autocomplete","email",3,"readonly"],["matInput","","formControlName","phone","placeholder","+1 (555) 123-4567","autocomplete","tel",3,"readonly"],["matInput","","formControlName","dateOfBirth","autocomplete","bday",3,"matDatepicker","readonly"],["matSuffix","",3,"for","disabled"],["matInput","","formControlName","occupation","placeholder","e.g., Software Engineer","autocomplete","organization-title",3,"readonly"],["matInput","","type","number","formControlName","monthlyIncome","step","0.01","autocomplete","off",3,"readonly"],["matTextPrefix",""],["formGroupName","preferences",1,"form-section"],["formControlName","defaultCurrency",3,"disabled"],[3,"value"],["formControlName","timezone",3,"disabled"],["formControlName","language",3,"disabled"],[1,"preferences-grid"],[1,"preference-item"],["formControlName","notifications","color","primary",3,"disabled"],[1,"toggle-label"],[1,"preference-description"],["formControlName","emailUpdates","color","primary",3,"disabled"],["formControlName","budgetAlerts","color","primary",3,"disabled"],["class","form-actions",4,"ngIf"],[1,"account-actions-section"],[1,"actions-grid"],[1,"action-card"],[1,"action-icon"],["mat-stroked-button","",1,"action-btn",3,"click"],[1,"action-card","danger"],["mat-stroked-button","","color","warn",1,"action-btn",3,"click"],[1,"form-actions"],["type","button","mat-stroked-button","",1,"cancel-btn",3,"click","disabled"],["type","submit","mat-raised-button","","color","primary",1,"save-btn",3,"disabled"]],template:function(r,a){r&1&&(X(0,lV,3,2,"button",1),c(1,"div",2),X(2,dV,4,0,"div",3),c(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7)(7,"mat-icon",8),d(8,"person"),l()(),c(9,"div",9)(10,"h1",10),d(11),l(),c(12,"p",11),d(13),l(),c(14,"p",12),d(15),l()()(),c(16,"div",13),X(17,uV,4,3,"button",14),l()()(),X(18,PV,129,27,"div",15),l()),r&2&&(w("ngIf",a.isMobile),p(2),w("ngIf",a.isLoading),p(9),z(a.getFullName()),p(2),z(a.userProfile==null?null:a.userProfile.email),p(2),oe("Member since ",a.getFormattedDate(a.userProfile==null?null:a.userProfile.createdAt),""),p(2),w("ngIf",!a.isMobile),p(),w("ngIf",a.userProfile))},dependencies:[ct,jn,Vt,ki,Ut,Un,Ei,Ti,s1,Ht,Ma,at,Xr,Fd,Rd,Nd,Ji,Zr,Sa,_x,wo,Ni,Fi,Pa,Jr],styles:[".profile-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:24px;min-height:100vh;background:var(--background-color);color:var(--text-color)}@media (max-width: 1024px){.profile-container[_ngcontent-%COMP%]{padding:20px}}@media (max-width: 768px){.profile-container[_ngcontent-%COMP%]{padding:16px}}@media (max-width: 480px){.profile-container[_ngcontent-%COMP%]{padding:12px}}.loading-overlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;background:var(--background-color);border-radius:12px;box-shadow:0 2px 8px #0000001a}.profile-header[_ngcontent-%COMP%]{background:var(--card-background);border-radius:16px;padding:32px;margin-bottom:32px;box-shadow:0 4px 20px #00000014;border:1px solid var(--border-color)}@media (max-width: 1024px){.profile-header[_ngcontent-%COMP%]{padding:28px;margin-bottom:28px}}@media (max-width: 768px){.profile-header[_ngcontent-%COMP%]{padding:24px 20px;margin-bottom:24px}}@media (max-width: 480px){.profile-header[_ngcontent-%COMP%]{padding:20px 16px;margin-bottom:20px}}.header-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:24px}@media (max-width: 1024px){.header-content[_ngcontent-%COMP%]{gap:20px}}@media (max-width: 768px){.header-content[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:20px}}@media (max-width: 480px){.header-content[_ngcontent-%COMP%]{gap:16px}}.avatar-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;flex:1}@media (max-width: 768px){.avatar-section[_ngcontent-%COMP%]{width:100%;gap:16px}}@media (max-width: 480px){.avatar-section[_ngcontent-%COMP%]{gap:12px}}.avatar[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,var(--primary-color),var(--accent-color));display:flex;align-items:center;justify-content:center;box-shadow:0 4px 16px #00000026;flex-shrink:0}@media (max-width: 1024px){.avatar[_ngcontent-%COMP%]{width:70px;height:70px}}@media (max-width: 768px){.avatar[_ngcontent-%COMP%]{width:60px;height:60px}}@media (max-width: 480px){.avatar[_ngcontent-%COMP%]{width:50px;height:50px}}.avatar-icon[_ngcontent-%COMP%]{font-size:36px;width:36px;height:36px;color:#fff}@media (max-width: 1024px){.avatar-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}}@media (max-width: 768px){.avatar-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}}@media (max-width: 480px){.avatar-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}}.user-info[_ngcontent-%COMP%]{flex:1;min-width:0}.user-name[_ngcontent-%COMP%]{font-size:28px;font-weight:700;margin:0 0 8px;color:var(--text-color);word-wrap:break-word}@media (max-width: 1024px){.user-name[_ngcontent-%COMP%]{font-size:26px}}@media (max-width: 768px){.user-name[_ngcontent-%COMP%]{font-size:24px}}@media (max-width: 480px){.user-name[_ngcontent-%COMP%]{font-size:22px}}.user-email[_ngcontent-%COMP%]{font-size:16px;color:var(--text-secondary);margin:0 0 4px;word-wrap:break-word}@media (max-width: 480px){.user-email[_ngcontent-%COMP%]{font-size:14px}}.user-role[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted);margin:0}@media (max-width: 480px){.user-role[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 768px){.header-actions[_ngcontent-%COMP%]{width:100%}}.edit-btn[_ngcontent-%COMP%]{min-width:140px}@media (max-width: 1024px){.edit-btn[_ngcontent-%COMP%]{min-width:130px}}@media (max-width: 768px){.edit-btn[_ngcontent-%COMP%]{width:100%;min-width:unset}}.profile-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:32px}@media (max-width: 768px){.profile-content[_ngcontent-%COMP%]{gap:24px}}@media (max-width: 480px){.profile-content[_ngcontent-%COMP%]{gap:20px}}.profile-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:32px}@media (max-width: 768px){.profile-form[_ngcontent-%COMP%]{gap:24px}}@media (max-width: 480px){.profile-form[_ngcontent-%COMP%]{gap:20px}}.form-section[_ngcontent-%COMP%]{background:var(--card-background);border-radius:16px;padding:32px;box-shadow:0 4px 20px #00000014;border:1px solid var(--border-color)}@media (max-width: 1024px){.form-section[_ngcontent-%COMP%]{padding:28px}}@media (max-width: 768px){.form-section[_ngcontent-%COMP%]{padding:24px 20px}}@media (max-width: 480px){.form-section[_ngcontent-%COMP%]{padding:20px 16px}}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:24px;padding-bottom:16px;border-bottom:2px solid var(--border-color)}@media (max-width: 768px){.section-header[_ngcontent-%COMP%]{margin-bottom:20px;padding-bottom:12px}}@media (max-width: 480px){.section-header[_ngcontent-%COMP%]{margin-bottom:16px;padding-bottom:10px;gap:8px}}.section-icon[_ngcontent-%COMP%]{color:var(--primary-color);font-size:24px;width:24px;height:24px;flex-shrink:0}@media (max-width: 480px){.section-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:600;margin:0;color:var(--text-color)}@media (max-width: 768px){.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px}}@media (max-width: 480px){.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px}}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px}@media (max-width: 1024px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px}}@media (max-width: 768px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}}@media (max-width: 480px){.form-grid[_ngcontent-%COMP%]{gap:16px}}.form-field[_ngcontent-%COMP%]{width:100%}.preferences-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px;margin-top:24px}@media (max-width: 1024px){.preferences-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px}}@media (max-width: 768px){.preferences-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}}@media (max-width: 480px){.preferences-grid[_ngcontent-%COMP%]{gap:16px;margin-top:20px}}.preference-item[_ngcontent-%COMP%]{padding:20px;background:var(--background-color);border-radius:12px;border:1px solid var(--border-color);transition:all .3s ease}.preference-item[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a}@media (max-width: 768px){.preference-item[_ngcontent-%COMP%]{padding:16px}}@media (max-width: 480px){.preference-item[_ngcontent-%COMP%]{padding:14px}}.preference-item[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin-bottom:8px}.preference-description[_ngcontent-%COMP%]{font-size:14px;color:var(--text-secondary);margin:8px 0 0;line-height:1.4}@media (max-width: 480px){.preference-description[_ngcontent-%COMP%]{font-size:13px}}.toggle-label[_ngcontent-%COMP%]{font-weight:500;color:var(--text-color)}@media (max-width: 480px){.toggle-label[_ngcontent-%COMP%]{font-size:14px}}.form-actions[_ngcontent-%COMP%]{display:flex;gap:16px;justify-content:flex-end;padding:24px 0;border-top:1px solid var(--border-color)}@media (max-width: 768px){.form-actions[_ngcontent-%COMP%]{flex-direction:column;gap:12px;padding:20px 0}}@media (max-width: 480px){.form-actions[_ngcontent-%COMP%]{padding:16px 0;gap:10px}}.cancel-btn[_ngcontent-%COMP%]{min-width:120px}@media (max-width: 768px){.cancel-btn[_ngcontent-%COMP%]{width:100%;min-width:unset}}.save-btn[_ngcontent-%COMP%]{min-width:140px}@media (max-width: 1024px){.save-btn[_ngcontent-%COMP%]{min-width:130px}}@media (max-width: 768px){.save-btn[_ngcontent-%COMP%]{width:100%;min-width:unset}}.account-actions-section[_ngcontent-%COMP%]{background:var(--card-background);border-radius:16px;padding:32px;box-shadow:0 4px 20px #00000014;border:1px solid var(--border-color)}@media (max-width: 1024px){.account-actions-section[_ngcontent-%COMP%]{padding:28px}}@media (max-width: 768px){.account-actions-section[_ngcontent-%COMP%]{padding:24px 20px}}@media (max-width: 480px){.account-actions-section[_ngcontent-%COMP%]{padding:20px 16px}}.actions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:24px;margin-top:24px}@media (max-width: 1024px){.actions-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:20px}}@media (max-width: 768px){.actions-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}}@media (max-width: 480px){.actions-grid[_ngcontent-%COMP%]{gap:16px;margin-top:20px}}.action-card[_ngcontent-%COMP%]{padding:24px;background:var(--background-color);border-radius:12px;border:1px solid var(--border-color);text-align:center;transition:all .3s ease}.action-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 24px #0000001f}.action-card.danger[_ngcontent-%COMP%]{border-color:var(--warn-color);background:#f443360d}.action-card.danger[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{color:var(--warn-color)}@media (max-width: 768px){.action-card[_ngcontent-%COMP%]{padding:20px}}@media (max-width: 480px){.action-card[_ngcontent-%COMP%]{padding:16px}}.action-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:var(--primary-color);margin-bottom:16px}@media (max-width: 768px){.action-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px;margin-bottom:12px}}@media (max-width: 480px){.action-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;margin-bottom:10px}}.action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin:0 0 12px;color:var(--text-color)}@media (max-width: 768px){.action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;margin:0 0 10px}}@media (max-width: 480px){.action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px;margin:0 0 8px}}.action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-secondary);margin:0 0 20px;line-height:1.5}@media (max-width: 768px){.action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;margin:0 0 16px}}@media (max-width: 480px){.action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;margin:0 0 14px}}.action-btn[_ngcontent-%COMP%]{min-width:140px}@media (max-width: 1024px){.action-btn[_ngcontent-%COMP%]{min-width:130px}}@media (max-width: 768px){.action-btn[_ngcontent-%COMP%]{width:100%;min-width:unset}}.dark-theme[_nghost-%COMP%]   .profile-container[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .profile-container[_ngcontent-%COMP%]{background:var(--dark-background)}.dark-theme[_nghost-%COMP%]   .profile-header[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .profile-header[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   .form-section[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .form-section[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   .account-actions-section[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .account-actions-section[_ngcontent-%COMP%]{background:var(--dark-card-background);border-color:var(--dark-border-color)}.dark-theme[_nghost-%COMP%]   .preference-item[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .preference-item[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   .action-card[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .action-card[_ngcontent-%COMP%]{background:var(--dark-background);border-color:var(--dark-border-color)}.dark-theme[_nghost-%COMP%]   .user-name[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .user-name[_ngcontent-%COMP%]{color:var(--dark-text-color)}.dark-theme[_nghost-%COMP%]   .user-email[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .user-email[_ngcontent-%COMP%]{color:var(--dark-text-secondary)}.dark-theme[_nghost-%COMP%]   .user-role[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .user-role[_ngcontent-%COMP%]{color:var(--dark-text-muted)}.dark-theme[_nghost-%COMP%]   .section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--dark-text-color)}.dark-theme[_nghost-%COMP%]   .action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--dark-text-color)}.dark-theme[_nghost-%COMP%]   .action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dark-text-secondary)}.dark-theme[_nghost-%COMP%]   .preference-description[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .preference-description[_ngcontent-%COMP%]{color:var(--dark-text-secondary)}.form-field[_ngcontent-%COMP%]{transition:all .3s ease}.form-field.mat-focused[_ngcontent-%COMP%]{transform:scale(1.02)}@keyframes _ngcontent-%COMP%_pulse{0%{opacity:1}50%{opacity:.5}to{opacity:1}}.loading-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}@media (max-width: 640px){.form-grid[_ngcontent-%COMP%], .preferences-grid[_ngcontent-%COMP%], .actions-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.user-info[_ngcontent-%COMP%], .action-card[_ngcontent-%COMP%], .preference-item[_ngcontent-%COMP%]{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;hyphens:auto}button[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width: 480px){.profile-container[_ngcontent-%COMP%]{padding:12px}.profile-header[_ngcontent-%COMP%], .form-section[_ngcontent-%COMP%], .account-actions-section[_ngcontent-%COMP%]{padding:20px 16px}.user-name[_ngcontent-%COMP%]{font-size:22px}.avatar[_ngcontent-%COMP%]{width:50px;height:50px}.avatar-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.form-field[_ngcontent-%COMP%]{margin-bottom:8px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px 16px}}@media (max-width: 768px) and (orientation: landscape){.profile-container[_ngcontent-%COMP%]{padding:16px}.header-content[_ngcontent-%COMP%]{flex-direction:row;align-items:center}.avatar-section[_ngcontent-%COMP%], .header-actions[_ngcontent-%COMP%], .edit-btn[_ngcontent-%COMP%]{width:auto}}@media (max-width: 360px){.profile-container[_ngcontent-%COMP%]{padding:8px}.profile-header[_ngcontent-%COMP%], .form-section[_ngcontent-%COMP%], .account-actions-section[_ngcontent-%COMP%]{padding:16px 12px}.user-name[_ngcontent-%COMP%]{font-size:20px}.avatar[_ngcontent-%COMP%]{width:45px;height:45px}.avatar-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:15px}.action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14px}.action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 12px;font-size:14px}}@media (max-width: 768px){.mat-slide-toggle[_ngcontent-%COMP%]{min-height:48px}.action-btn[_ngcontent-%COMP%], .edit-btn[_ngcontent-%COMP%], .save-btn[_ngcontent-%COMP%], .cancel-btn[_ngcontent-%COMP%]{min-height:44px}.mat-form-field[_ngcontent-%COMP%]{margin-bottom:8px}}@media (min-width: 769px) and (max-width: 1024px){.form-grid[_ngcontent-%COMP%], .preferences-grid[_ngcontent-%COMP%], .actions-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}"]});let e=n;return e})();var m2="@firebase/installations",ap="0.6.9";var g2=1e4,f2=`w:${ap}`,p2="FIS_v2",OV="https://firebaseinstallations.googleapis.com/v1",kV=60*60*1e3,EV="installations",TV="Installations";var IV={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Es=new Cd(EV,TV,IV);function h2(e){return e instanceof k1&&e.code.includes("request-failed")}function x2({projectId:e}){return`${OV}/projects/${e}/installations`}function _2(e){return{token:e.token,requestStatus:2,expiresIn:DV(e.expiresIn),creationTime:Date.now()}}function C2(e,n){return ue(this,null,function*(){let t=(yield n.json()).error;return Es.create("request-failed",{requestName:e,serverCode:t.code,serverMessage:t.message,serverStatus:t.status})})}function v2({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function AV(e,{refreshToken:n}){let i=v2(e);return i.append("Authorization",FV(n)),i}function b2(e){return ue(this,null,function*(){let n=yield e();return n.status>=500&&n.status<600?e():n})}function DV(e){return Number(e.replace("s","000"))}function FV(e){return`${p2} ${e}`}function RV(t,r){return ue(this,arguments,function*({appConfig:e,heartbeatServiceProvider:n},{fid:i}){let a=x2(e),o=v2(e),s=n.getImmediate({optional:!0});if(s){let h=yield s.getHeartbeatsHeader();h&&o.append("x-firebase-client",h)}let u={fid:i,authVersion:p2,appId:e.appId,sdkVersion:f2},m={method:"POST",headers:o,body:JSON.stringify(u)},f=yield b2(()=>fetch(a,m));if(f.ok){let h=yield f.json();return{fid:h.fid||i,registrationStatus:2,refreshToken:h.refreshToken,authToken:_2(h.authToken)}}else throw yield C2("Create Installation",f)})}function y2(e){return new Promise(n=>{setTimeout(n,e)})}function NV(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}var BV=/^[cdef][\w-]{21}$/,rp="";function LV(){try{let e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;let i=VV(e);return BV.test(i)?i:rp}catch{return rp}}function VV(e){return NV(e).substr(0,22)}function hm(e){return`${e.appName}!${e.appId}`}var M2=new Map;function w2(e,n){let i=hm(e);S2(i,n),UV(i,n)}function S2(e,n){let i=M2.get(e);if(i)for(let t of i)t(n)}function UV(e,n){let i=jV();i&&i.postMessage({key:e,fid:n}),zV()}var ks=null;function jV(){return!ks&&"BroadcastChannel"in self&&(ks=new BroadcastChannel("[Firebase] FID Change"),ks.onmessage=e=>{S2(e.data.key,e.data.fid)}),ks}function zV(){M2.size===0&&ks&&(ks.close(),ks=null)}var WV="firebase-installations-database",YV=1,Ts="firebase-installations-store",np=null;function op(){return np||(np=fl(WV,YV,{upgrade:(e,n)=>{switch(n){case 0:e.createObjectStore(Ts)}}})),np}function pm(e,n){return ue(this,null,function*(){let i=hm(e),r=(yield op()).transaction(Ts,"readwrite"),a=r.objectStore(Ts),o=yield a.get(i);return yield a.put(n,i),yield r.done,(!o||o.fid!==n.fid)&&w2(e,n.fid),n})}function P2(e){return ue(this,null,function*(){let n=hm(e),t=(yield op()).transaction(Ts,"readwrite");yield t.objectStore(Ts).delete(n),yield t.done})}function xm(e,n){return ue(this,null,function*(){let i=hm(e),r=(yield op()).transaction(Ts,"readwrite"),a=r.objectStore(Ts),o=yield a.get(i),s=n(o);return s===void 0?yield a.delete(i):yield a.put(s,i),yield r.done,s&&(!o||o.fid!==s.fid)&&w2(e,s.fid),s})}function sp(e){return ue(this,null,function*(){let n,i=yield xm(e.appConfig,t=>{let r=$V(t),a=GV(e,r);return n=a.registrationPromise,a.installationEntry});return i.fid===rp?{installationEntry:yield n}:{installationEntry:i,registrationPromise:n}})}function $V(e){let n=e||{fid:LV(),registrationStatus:0};return O2(n)}function GV(e,n){if(n.registrationStatus===0){if(!navigator.onLine){let r=Promise.reject(Es.create("app-offline"));return{installationEntry:n,registrationPromise:r}}let i={fid:n.fid,registrationStatus:1,registrationTime:Date.now()},t=HV(e,i);return{installationEntry:i,registrationPromise:t}}else return n.registrationStatus===1?{installationEntry:n,registrationPromise:qV(e)}:{installationEntry:n}}function HV(e,n){return ue(this,null,function*(){try{let i=yield RV(e,n);return pm(e.appConfig,i)}catch(i){throw h2(i)&&i.customData.serverCode===409?yield P2(e.appConfig):yield pm(e.appConfig,{fid:n.fid,registrationStatus:0}),i}})}function qV(e){return ue(this,null,function*(){let n=yield d2(e.appConfig);for(;n.registrationStatus===1;)yield y2(100),n=yield d2(e.appConfig);if(n.registrationStatus===0){let{installationEntry:i,registrationPromise:t}=yield sp(e);return t||i}return n})}function d2(e){return xm(e,n=>{if(!n)throw Es.create("installation-not-found");return O2(n)})}function O2(e){return XV(e)?{fid:e.fid,registrationStatus:0}:e}function XV(e){return e.registrationStatus===1&&e.registrationTime+g2<Date.now()}function KV(t,r){return ue(this,arguments,function*({appConfig:e,heartbeatServiceProvider:n},i){let a=ZV(e,i),o=AV(e,i),s=n.getImmediate({optional:!0});if(s){let h=yield s.getHeartbeatsHeader();h&&o.append("x-firebase-client",h)}let u={installation:{sdkVersion:f2,appId:e.appId}},m={method:"POST",headers:o,body:JSON.stringify(u)},f=yield b2(()=>fetch(a,m));if(f.ok){let h=yield f.json();return _2(h)}else throw yield C2("Generate Auth Token",f)})}function ZV(e,{fid:n}){return`${x2(e)}/${n}/authTokens:generate`}function cp(e,n=!1){return ue(this,null,function*(){let i,t=yield xm(e.appConfig,a=>{if(!k2(a))throw Es.create("not-registered");let o=a.authToken;if(!n&&eU(o))return a;if(o.requestStatus===1)return i=JV(e,n),a;{if(!navigator.onLine)throw Es.create("app-offline");let s=nU(a);return i=QV(e,s),s}});return i?yield i:t.authToken})}function JV(e,n){return ue(this,null,function*(){let i=yield u2(e.appConfig);for(;i.authToken.requestStatus===1;)yield y2(100),i=yield u2(e.appConfig);let t=i.authToken;return t.requestStatus===0?cp(e,n):t})}function u2(e){return xm(e,n=>{if(!k2(n))throw Es.create("not-registered");let i=n.authToken;return iU(i)?Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}):n})}function QV(e,n){return ue(this,null,function*(){try{let i=yield KV(e,n),t=Object.assign(Object.assign({},n),{authToken:i});return yield pm(e.appConfig,t),i}catch(i){if(h2(i)&&(i.customData.serverCode===401||i.customData.serverCode===404))yield P2(e.appConfig);else{let t=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}});yield pm(e.appConfig,t)}throw i}})}function k2(e){return e!==void 0&&e.registrationStatus===2}function eU(e){return e.requestStatus===2&&!tU(e)}function tU(e){let n=Date.now();return n<e.creationTime||e.creationTime+e.expiresIn<n+kV}function nU(e){let n={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:n})}function iU(e){return e.requestStatus===1&&e.requestTime+g2<Date.now()}function rU(e){return ue(this,null,function*(){let n=e,{installationEntry:i,registrationPromise:t}=yield sp(n);return t?t.catch(console.error):cp(n).catch(console.error),i.fid})}function aU(e,n=!1){return ue(this,null,function*(){let i=e;return yield oU(i),(yield cp(i,n)).token})}function oU(e){return ue(this,null,function*(){let{registrationPromise:n}=yield sp(e);n&&(yield n)})}function sU(e){if(!e||!e.options)throw ip("App Configuration");if(!e.name)throw ip("App Name");let n=["projectId","apiKey","appId"];for(let i of n)if(!e.options[i])throw ip(i);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function ip(e){return Es.create("missing-app-config-values",{valueName:e})}var E2="installations",cU="installations-internal",lU=e=>{let n=e.getProvider("app").getImmediate(),i=sU(n),t=pl(n,"heartbeat");return{app:n,appConfig:i,heartbeatServiceProvider:t,_delete:()=>Promise.resolve()}},dU=e=>{let n=e.getProvider("app").getImmediate(),i=pl(n,E2).getImmediate();return{getId:()=>rU(i),getToken:r=>aU(i,r)}};function uU(){sc(new oc(E2,lU,"PUBLIC")),sc(new oc(cU,dU,"PRIVATE"))}uU();Co(m2,ap);Co(m2,ap,"esm2017");var mU="/firebase-messaging-sw.js",gU="/firebase-cloud-messaging-push-scope",R2="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",fU="https://fcmregistrations.googleapis.com/v1",N2="google.c.a.c_id",pU="google.c.a.c_l",hU="google.c.a.ts",xU="google.c.a.e";var _m=function(e){return e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked",e}(_m||{});function so(e){let n=new Uint8Array(e);return btoa(String.fromCharCode(...n)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function _U(e){let n="=".repeat((4-e.length%4)%4),i=(e+n).replace(/\-/g,"+").replace(/_/g,"/"),t=atob(i),r=new Uint8Array(t.length);for(let a=0;a<t.length;++a)r[a]=t.charCodeAt(a);return r}var lp="fcm_token_details_db",CU=5,T2="fcm_token_object_Store";function vU(e){return ue(this,null,function*(){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(a=>a.name).includes(lp))return null;let n=null;return(yield fl(lp,CU,{upgrade:(t,r,a,o)=>ue(this,null,function*(){var s;if(r<2||!t.objectStoreNames.contains(T2))return;let u=o.objectStore(T2),m=yield u.index("fcmSenderId").get(e);if(yield u.clear(),!!m){if(r===2){let f=m;if(!f.auth||!f.p256dh||!f.endpoint)return;n={token:f.fcmToken,createTime:(s=f.createTime)!==null&&s!==void 0?s:Date.now(),subscriptionOptions:{auth:f.auth,p256dh:f.p256dh,endpoint:f.endpoint,swScope:f.swScope,vapidKey:typeof f.vapidKey=="string"?f.vapidKey:so(f.vapidKey)}}}else if(r===3){let f=m;n={token:f.fcmToken,createTime:f.createTime,subscriptionOptions:{auth:so(f.auth),p256dh:so(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:so(f.vapidKey)}}}else if(r===4){let f=m;n={token:f.fcmToken,createTime:f.createTime,subscriptionOptions:{auth:so(f.auth),p256dh:so(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:so(f.vapidKey)}}}}})})).close(),yield bd(lp),yield bd("fcm_vapid_details_db"),yield bd("undefined"),bU(n)?n:null})}function bU(e){if(!e||!e.subscriptionOptions)return!1;let{subscriptionOptions:n}=e;return typeof e.createTime=="number"&&e.createTime>0&&typeof e.token=="string"&&e.token.length>0&&typeof n.auth=="string"&&n.auth.length>0&&typeof n.p256dh=="string"&&n.p256dh.length>0&&typeof n.endpoint=="string"&&n.endpoint.length>0&&typeof n.swScope=="string"&&n.swScope.length>0&&typeof n.vapidKey=="string"&&n.vapidKey.length>0}var yU="firebase-messaging-database",MU=1,s0="firebase-messaging-store",dp=null;function B2(){return dp||(dp=fl(yU,MU,{upgrade:(e,n)=>{switch(n){case 0:e.createObjectStore(s0)}}})),dp}function wU(e){return ue(this,null,function*(){let n=L2(e),t=yield(yield B2()).transaction(s0).objectStore(s0).get(n);if(t)return t;{let r=yield vU(e.appConfig.senderId);if(r)return yield gp(e,r),r}})}function gp(e,n){return ue(this,null,function*(){let i=L2(e),r=(yield B2()).transaction(s0,"readwrite");return yield r.objectStore(s0).put(n,i),yield r.done,n})}function L2({appConfig:e}){return e.appId}var SU={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},dr=new Cd("messaging","Messaging",SU);function PU(e,n){return ue(this,null,function*(){let i=yield pp(e),t=V2(n),r={method:"POST",headers:i,body:JSON.stringify(t)},a;try{a=yield(yield fetch(fp(e.appConfig),r)).json()}catch(o){throw dr.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(a.error){let o=a.error.message;throw dr.create("token-subscribe-failed",{errorInfo:o})}if(!a.token)throw dr.create("token-subscribe-no-token");return a.token})}function OU(e,n){return ue(this,null,function*(){let i=yield pp(e),t=V2(n.subscriptionOptions),r={method:"PATCH",headers:i,body:JSON.stringify(t)},a;try{a=yield(yield fetch(`${fp(e.appConfig)}/${n.token}`,r)).json()}catch(o){throw dr.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(a.error){let o=a.error.message;throw dr.create("token-update-failed",{errorInfo:o})}if(!a.token)throw dr.create("token-update-no-token");return a.token})}function kU(e,n){return ue(this,null,function*(){let t={method:"DELETE",headers:yield pp(e)};try{let a=yield(yield fetch(`${fp(e.appConfig)}/${n}`,t)).json();if(a.error){let o=a.error.message;throw dr.create("token-unsubscribe-failed",{errorInfo:o})}}catch(r){throw dr.create("token-unsubscribe-failed",{errorInfo:r==null?void 0:r.toString()})}})}function fp({projectId:e}){return`${fU}/projects/${e}/registrations`}function pp(i){return ue(this,arguments,function*({appConfig:e,installations:n}){let t=yield n.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})})}function V2({p256dh:e,auth:n,endpoint:i,vapidKey:t}){let r={web:{endpoint:i,auth:n,p256dh:e}};return t!==R2&&(r.web.applicationPubKey=t),r}var EU=7*24*60*60*1e3;function TU(e){return ue(this,null,function*(){let n=yield AU(e.swRegistration,e.vapidKey),i={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:n.endpoint,auth:so(n.getKey("auth")),p256dh:so(n.getKey("p256dh"))},t=yield wU(e.firebaseDependencies);if(t){if(DU(t.subscriptionOptions,i))return Date.now()>=t.createTime+EU?IU(e,{token:t.token,createTime:Date.now(),subscriptionOptions:i}):t.token;try{yield kU(e.firebaseDependencies,t.token)}catch(r){console.warn(r)}return I2(e.firebaseDependencies,i)}else return I2(e.firebaseDependencies,i)})}function IU(e,n){return ue(this,null,function*(){try{let i=yield OU(e.firebaseDependencies,n),t=Object.assign(Object.assign({},n),{token:i,createTime:Date.now()});return yield gp(e.firebaseDependencies,t),i}catch(i){throw i}})}function I2(e,n){return ue(this,null,function*(){let t={token:yield PU(e,n),createTime:Date.now(),subscriptionOptions:n};return yield gp(e,t),t.token})}function AU(e,n){return ue(this,null,function*(){let i=yield e.pushManager.getSubscription();return i||e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:_U(n)})})}function DU(e,n){let i=n.vapidKey===e.vapidKey,t=n.endpoint===e.endpoint,r=n.auth===e.auth,a=n.p256dh===e.p256dh;return i&&t&&r&&a}function A2(e){let n={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return FU(n,e),RU(n,e),NU(n,e),n}function FU(e,n){if(!n.notification)return;e.notification={};let i=n.notification.title;i&&(e.notification.title=i);let t=n.notification.body;t&&(e.notification.body=t);let r=n.notification.image;r&&(e.notification.image=r);let a=n.notification.icon;a&&(e.notification.icon=a)}function RU(e,n){n.data&&(e.data=n.data)}function NU(e,n){var i,t,r,a,o;if(!n.fcmOptions&&!(!((i=n.notification)===null||i===void 0)&&i.click_action))return;e.fcmOptions={};let s=(r=(t=n.fcmOptions)===null||t===void 0?void 0:t.link)!==null&&r!==void 0?r:(a=n.notification)===null||a===void 0?void 0:a.click_action;s&&(e.fcmOptions.link=s);let u=(o=n.fcmOptions)===null||o===void 0?void 0:o.analytics_label;u&&(e.fcmOptions.analyticsLabel=u)}function BU(e){return typeof e=="object"&&!!e&&N2 in e}LU("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function LU(e,n){let i=[];for(let t=0;t<e.length;t++)i.push(e.charAt(t)),t<n.length&&i.push(n.charAt(t));return i.join("")}function VU(e){if(!e||!e.options)throw up("App Configuration Object");if(!e.name)throw up("App Name");let n=["projectId","apiKey","appId","messagingSenderId"],{options:i}=e;for(let t of n)if(!i[t])throw up(t);return{appName:e.name,projectId:i.projectId,apiKey:i.apiKey,appId:i.appId,senderId:i.messagingSenderId}}function up(e){return dr.create("missing-app-config-values",{valueName:e})}var mp=class{constructor(n,i,t){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;let r=VU(n);this.firebaseDependencies={app:n,appConfig:r,installations:i,analyticsProvider:t}}_delete(){return Promise.resolve()}};function UU(e){return ue(this,null,function*(){try{e.swRegistration=yield navigator.serviceWorker.register(mU,{scope:gU}),e.swRegistration.update().catch(()=>{})}catch(n){throw dr.create("failed-service-worker-registration",{browserErrorMessage:n==null?void 0:n.message})}})}function jU(e,n){return ue(this,null,function*(){if(!n&&!e.swRegistration&&(yield UU(e)),!(!n&&e.swRegistration)){if(!(n instanceof ServiceWorkerRegistration))throw dr.create("invalid-sw-registration");e.swRegistration=n}})}function zU(e,n){return ue(this,null,function*(){n?e.vapidKey=n:e.vapidKey||(e.vapidKey=R2)})}function U2(e,n){return ue(this,null,function*(){if(!navigator)throw dr.create("only-available-in-window");if(Notification.permission==="default"&&(yield Notification.requestPermission()),Notification.permission!=="granted")throw dr.create("permission-blocked");return yield zU(e,n==null?void 0:n.vapidKey),yield jU(e,n==null?void 0:n.serviceWorkerRegistration),TU(e)})}function WU(e,n,i){return ue(this,null,function*(){let t=YU(n);(yield e.firebaseDependencies.analyticsProvider.get()).logEvent(t,{message_id:i[N2],message_name:i[pU],message_time:i[hU],message_device_time:Math.floor(Date.now()/1e3)})})}function YU(e){switch(e){case _m.NOTIFICATION_CLICKED:return"notification_open";case _m.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function $U(e,n){return ue(this,null,function*(){let i=n.data;if(!i.isFirebaseMessaging)return;e.onMessageHandler&&i.messageType===_m.PUSH_RECEIVED&&(typeof e.onMessageHandler=="function"?e.onMessageHandler(A2(i)):e.onMessageHandler.next(A2(i)));let t=i.data;BU(t)&&t[xU]==="1"&&(yield WU(e,i.messageType,t))})}var D2="@firebase/messaging",F2="0.12.12";var GU=e=>{let n=new mp(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",i=>$U(n,i)),n},HU=e=>{let n=e.getProvider("messaging").getImmediate();return{getToken:t=>U2(n,t)}};function qU(){sc(new oc("messaging",GU,"PUBLIC")),sc(new oc("messaging-internal",HU,"PRIVATE")),Co(D2,F2),Co(D2,F2,"esm2017")}function hp(){return ue(this,null,function*(){try{yield P1()}catch{return!1}return typeof window<"u"&&S1()&&O1()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})}function XU(e,n){if(!navigator)throw dr.create("only-available-in-window");return e.onMessageHandler=n,()=>{e.onMessageHandler=null}}function j2(e=tg()){return hp().then(n=>{if(!n)throw dr.create("unsupported-browser")},n=>{throw dr.create("indexed-db-unsupported")}),pl(vd(e),"messaging").getImmediate()}function z2(e,n){return ue(this,null,function*(){return e=vd(e),U2(e,n)})}function W2(e,n){return e=vd(e),XU(e,n)}qU();var c0=class{constructor(n){return n}},Y2="messaging",xp=class{constructor(){return A1(Y2)}};var Cm="__angularfire_symbol__messagingIsSupported",_p="__angularfire_symbol__messagingIsSupportedValue";globalThis[Cm]||(globalThis[Cm]=hp().then(e=>globalThis[_p]=e).catch(()=>globalThis[_p]=!1));var vm={async:()=>globalThis[Cm],sync:()=>{let e=globalThis[_p];if(e===void 0)throw new Error(T1("Messaging"));return e}},Cp=new Xa("angularfire2.messaging-instances");function KU(e,n){if(!vm.sync())return null;let i=I1(Y2,e,n);return i&&new c0(i)}function ZU(e){return(n,i)=>{if(!vm.sync())return null;let t=n.runOutsideAngular(()=>e(i));return new c0(t)}}var JU={provide:xp,deps:[[new Km,Cp]]},QU={provide:c0,useFactory:KU,deps:[[new Km,Cp],F1]};function $2(e,...n){return Co("angularfire",E1.full,"fcm"),zs([QU,JU,{provide:qh,useValue:vm.async,multi:!0},{provide:Cp,useFactory:ZU(e),multi:!0,deps:[vr,Uh,D1,R1,...n]}])}var yH=vm.async;var Kc=yd(j2,!0),vp=yd(z2,!0),bm=yd(W2,!1);var ym=(()=>{let n=class n{constructor(t,r){this.ngZone=t,this.platformId=r,this.tokenSubject=new mn(null),this.permissionSubject=new mn("default"),this.notificationSubject=new mn(null),this.swRegistration=null,this.token$=this.tokenSubject.asObservable(),this.permission$=this.permissionSubject.asObservable(),this.notifications$=this.notificationSubject.asObservable(),this.platformInfo=this.detectPlatform(),this.initializeMessagingWithoutPermission()}detectPlatform(){if(fo(this.platformId))return{isAndroid:!1,isIOS:!1,isChrome:!1,isSafari:!1,isFirefox:!1,isEdge:!1,isMobile:!1,isDesktop:!1,isPWA:!1,isStandalone:!1,supportsNotifications:!1,supportsServiceWorker:!1,supportsPushManager:!1};let t=navigator.userAgent,r=/Android/i.test(t),a=/iPad|iPhone|iPod/.test(t),o=/Chrome/.test(t)&&!/Edge/.test(t),s=/Safari/.test(t)&&!/Chrome/.test(t),u=/Firefox/.test(t),m=/Edge/.test(t),f=r||a||/webOS|BlackBerry|IEMobile|Opera Mini/i.test(t),h=!f,_=window.matchMedia("(display-mode: standalone)").matches,y=_||window.navigator.standalone===!0,v="Notification"in window,C="serviceWorker"in navigator,P="PushManager"in window;return{isAndroid:r,isIOS:a,isChrome:o,isSafari:s,isFirefox:u,isEdge:m,isMobile:f,isDesktop:h,isPWA:_,isStandalone:y,supportsNotifications:v,supportsServiceWorker:C,supportsPushManager:P}}getPlatformInfo(){return this.platformInfo}initializeMessagingWithoutPermission(){return ue(this,null,function*(){try{if(fo(this.platformId)){console.log("Skipping Firebase messaging initialization on server-side");return}if(!this.platformInfo.supportsNotifications){console.warn("This browser does not support notifications");return}if(!this.platformInfo.supportsServiceWorker){console.warn("Service Worker not supported");return}yield this.initializePlatformSpecific(),yield this.registerFirebaseMessagingSW(),this.messaging=Kc(),this.permissionSubject.next(Notification.permission),"permissions"in navigator&&navigator.permissions.query({name:"notifications"}).then(t=>{t.onchange=()=>{this.ngZone.run(()=>{this.permissionSubject.next(Notification.permission)})}}),bm(this.messaging,t=>{this.ngZone.run(()=>ue(this,null,function*(){console.log("Foreground message received:",t),yield this.handleForegroundMessage(t)}))}),console.log("Firebase messaging initialized without automatic permission request")}catch(t){console.error("Failed to initialize Firebase messaging:",t)}})}initializeMessaging(){return ue(this,null,function*(){try{if(fo(this.platformId)){console.log("Skipping Firebase messaging initialization on server-side");return}if(!this.platformInfo.supportsNotifications){console.warn("This browser does not support notifications");return}if(!this.platformInfo.supportsServiceWorker){console.warn("Service Worker not supported");return}yield this.initializePlatformSpecific(),yield this.registerFirebaseMessagingSW(),this.messaging=Kc(),this.permissionSubject.next(Notification.permission),"permissions"in navigator&&navigator.permissions.query({name:"notifications"}).then(t=>{t.onchange=()=>{this.ngZone.run(()=>{this.permissionSubject.next(Notification.permission)})}}),bm(this.messaging,t=>{this.ngZone.run(()=>ue(this,null,function*(){console.log("Foreground message received:",t),yield this.handleForegroundMessage(t)}))}),yield this.requestPermission()}catch(t){console.error("Failed to initialize Firebase messaging:",t)}})}initializePlatformSpecific(){return ue(this,null,function*(){console.log("Platform info:",this.platformInfo),this.platformInfo.isIOS&&(console.log("Initializing for iOS platform"),yield this.initializeIOS()),this.platformInfo.isAndroid&&(console.log("Initializing for Android platform"),yield this.initializeAndroid()),this.platformInfo.isChrome&&this.platformInfo.isDesktop&&(console.log("Initializing for Chrome desktop platform"),yield this.initializeChromeDesktop()),this.platformInfo.isSafari&&(console.log("Initializing for Safari platform"),yield this.initializeSafari())})}initializeIOS(){return ue(this,null,function*(){this.platformInfo.isStandalone||console.warn("iOS notifications work best when app is added to home screen");let t=this.getIOSVersion();t&&t<14&&console.warn("iOS version may have limited notification support")})}initializeAndroid(){return ue(this,null,function*(){let t=this.getChromeVersion();t&&t<79&&console.warn("Chrome version may have limited notification support");let r=this.getAndroidVersion();r&&r<6&&console.warn("Android version may have limited notification support")})}initializeChromeDesktop(){return ue(this,null,function*(){let t=this.getChromeVersion();t&&t<79&&console.warn("Chrome version may have limited notification support")})}initializeSafari(){return ue(this,null,function*(){let t=this.getSafariVersion();t&&t<16.4&&console.warn("Safari version may have limited notification support")})}getIOSVersion(){let t=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/);return t?parseInt(t[1],10):null}getAndroidVersion(){let t=navigator.userAgent.match(/Android (\d+)/);return t?parseInt(t[1],10):null}getChromeVersion(){let t=navigator.userAgent.match(/Chrome\/(\d+)/);return t?parseInt(t[1],10):null}getSafariVersion(){let t=navigator.userAgent.match(/Version\/(\d+)/);return t?parseInt(t[1],10):null}registerFirebaseMessagingSW(){return ue(this,null,function*(){try{let r=(yield navigator.serviceWorker.getRegistrations()).find(o=>{var s;return o.scope.includes(oi.serviceWorkerScope)||((s=o.active)==null?void 0:s.scriptURL.includes(oi.serviceWorkerScope+"firebase-messaging-sw.js"))});if(r){console.log("Firebase messaging service worker already registered"),this.swRegistration=r;return}let a=this.getServiceWorkerOptions();console.log("Registering Firebase messaging service worker..."),this.swRegistration=yield navigator.serviceWorker.register(oi.serviceWorkerScope+"firebase-messaging-sw.js",a),console.log("Firebase messaging service worker registered successfully:",this.swRegistration),yield this.swRegistration.update()}catch(t){throw console.error("Failed to register Firebase messaging service worker:",t),t}})}getServiceWorkerOptions(){let t={scope:oi.serviceWorkerScope};return this.platformInfo.isIOS||this.platformInfo.isAndroid||this.platformInfo.isChrome&&this.platformInfo.isDesktop,t}handleForegroundMessage(t){return ue(this,null,function*(){var a,o,s,u,m,f,h,_,y;let r={title:((a=t.notification)==null?void 0:a.title)||"New Notification",body:((o=t.notification)==null?void 0:o.body)||"",icon:this.getPlatformSpecificIcon((s=t.notification)==null?void 0:s.icon),badge:this.getPlatformSpecificBadge((u=t.notification)==null?void 0:u.badge),image:(m=t.notification)==null?void 0:m.image,data:t.data||{},tag:(f=t.notification)==null?void 0:f.tag,requireInteraction:((h=t.notification)==null?void 0:h.requireInteraction)||!1,silent:((_=t.notification)==null?void 0:_.silent)||!1,timestamp:((y=t.notification)==null?void 0:y.timestamp)||Date.now()};this.notificationSubject.next(r),yield this.showNotification(r)})}getPlatformSpecificIcon(t){return t||(this.platformInfo.isIOS?oi.baseUrl+"/assets/icon/app-icon/icon-152x152.png":this.platformInfo.isAndroid?oi.baseUrl+"/assets/icon/app-icon/icon-192x192.png":oi.baseUrl+"/assets/icon/app-icon/icon-192x192.png")}getPlatformSpecificBadge(t){return t||(this.platformInfo.isIOS||this.platformInfo.isAndroid,"/icons/icon-72x72.png")}requestPermission(){return ue(this,null,function*(){try{if(!this.platformInfo.supportsNotifications)throw new Error("Notifications not supported");let t=yield this.requestPlatformSpecificPermission();return this.permissionSubject.next(t),t==="granted"&&(yield this.getToken()),t}catch(t){return console.error("Error requesting notification permission:",t),"denied"}})}requestPlatformSpecificPermission(){return ue(this,null,function*(){return this.platformInfo.isSafari?(console.log("Requesting permission for Safari"),Notification.requestPermission()):this.platformInfo.isAndroid?(console.log("Requesting permission for Android Chrome"),Notification.requestPermission()):(this.platformInfo.isChrome&&this.platformInfo.isDesktop&&console.log("Requesting permission for Chrome desktop"),Notification.requestPermission())})}getToken(){return ue(this,null,function*(){try{if(!this.messaging)return console.warn("Messaging not initialized"),null;this.swRegistration&&(yield this.swRegistration.update());let t=this.getPlatformSpecificTokenOptions(),r=yield vp(this.messaging,t);return r?(this.tokenSubject.next(r),localStorage.setItem("fcm-token",r),r):(console.warn("No registration token available"),null)}catch(t){return console.error("Error getting FCM token:",t),null}})}getPlatformSpecificTokenOptions(){let t={vapidKey:oi.vapidKey,serviceWorkerRegistration:this.swRegistration||void 0};return this.platformInfo.isIOS||this.platformInfo.isAndroid||this.platformInfo.isChrome&&this.platformInfo.isDesktop,t}refreshToken(){return ue(this,null,function*(){try{if(!this.messaging)return null;let t=yield vp(this.messaging,{vapidKey:oi.vapidKey,serviceWorkerRegistration:this.swRegistration||void 0});return t?(this.tokenSubject.next(t),localStorage.setItem("fcm-token",t),t):null}catch(t){return console.error("Error refreshing FCM token:",t),null}})}showNotification(t){return ue(this,null,function*(){if(Notification.permission!=="granted"){console.warn("Notification permission not granted");return}this.platformInfo.isMobile||this.platformInfo.isAndroid?yield this.showNotificationViaServiceWorker(t):this.showNotificationDirect(t)})}showNotificationViaServiceWorker(t){return ue(this,null,function*(){try{if(!this.swRegistration){console.warn("Service Worker not registered, falling back to direct notification"),this.showNotificationDirect(t);return}if(!this.swRegistration.active&&(console.warn("Service Worker not active, waiting for activation..."),yield this.swRegistration.update(),!this.swRegistration.active)){console.warn("Service Worker still not active, falling back to direct notification"),this.showNotificationDirect(t);return}let r={type:"SHOW_NOTIFICATION",notification:{title:t.title,body:t.body,icon:t.icon,badge:t.badge,image:t.image,data:t.data,tag:t.tag,requireInteraction:t.requireInteraction,silent:t.silent,timestamp:t.timestamp,actions:t.actions}};this.swRegistration.active.postMessage(r),console.log("Notification request sent to Service Worker")}catch(r){console.error("Error showing notification via Service Worker:",r),this.showNotificationDirect(t)}})}showNotificationDirect(t){try{let r={body:t.body,icon:t.icon,badge:t.badge,data:t.data,tag:t.tag,requireInteraction:t.requireInteraction,silent:t.silent},a=new Notification(t.title,r);a.onclick=o=>{o.preventDefault(),this.handleNotificationClick(t,o),a.close()},t.requireInteraction||setTimeout(()=>{a.close()},5e3),console.log("Notification shown directly")}catch(r){console.error("Error showing direct notification:",r)}}handleNotificationClick(t,r){var a,o;console.log("Notification clicked:",t),window.focus&&window.focus(),(a=t.data)!=null&&a.url?window.open(t.data.url,"_blank"):(o=t.data)!=null&&o.route&&(window.location.href=t.data.route),this.notificationSubject.next(le(ae({},t),{data:le(ae({},t.data),{action:"click"})}))}handleNotificationAction(t,r){var a;switch(console.log("Notification action clicked:",r.action,t),r.action){case"view":this.handleNotificationClick(t,r);break;case"dismiss":break;default:(a=t.data)!=null&&a.actionUrl&&window.open(t.data.actionUrl,"_blank")}this.notificationSubject.next(le(ae({},t),{data:le(ae({},t.data),{action:r.action})}))}getStoredToken(){return localStorage.getItem("fcm-token")}clearStoredToken(){localStorage.removeItem("fcm-token"),this.tokenSubject.next(null)}isSupported(){return this.platformInfo.supportsNotifications&&this.platformInfo.supportsServiceWorker}isPlatformSupported(){if(this.platformInfo.isAndroid||this.platformInfo.isChrome&&this.platformInfo.isDesktop)return!0;if(this.platformInfo.isIOS){let t=this.getIOSVersion();return t?t>=14:!1}if(this.platformInfo.isSafari){let t=this.getSafariVersion();return t?t>=16.4:!1}return!1}getPlatformSupportInfo(){if(this.platformInfo.isAndroid)return"Excellent support on Android Chrome";if(this.platformInfo.isChrome&&this.platformInfo.isDesktop)return"Excellent support on Chrome desktop";if(this.platformInfo.isIOS){let t=this.getIOSVersion();return t&&t>=14?"Good support on iOS (requires home screen installation for best results)":"Limited support on iOS (requires iOS 14+ and home screen installation)"}if(this.platformInfo.isSafari){let t=this.getSafariVersion();return t&&t>=16.4?"Good support on Safari 16.4+":"Limited support on Safari (requires Safari 16.4+)"}return"Limited or no support on this platform"}getServiceWorkerRegistration(){return this.swRegistration}initializeMessagingWithPermission(){return ue(this,null,function*(){yield this.initializeMessaging()})}sendTestNotification(){return ue(this,null,function*(){let t={title:"Test Notification",body:"This is a test notification from Money Manager",icon:oi.baseUrl+"/assets/icons/icon-192x192.png",badge:oi.baseUrl+"/assets/icons/icon-72x72.png",data:{type:"test",timestamp:Date.now().toString()},actions:[{action:"view",title:"View"},{action:"dismiss",title:"Dismiss"}]};yield this.showNotification(t)})}listenForMessages(){let t=Kc();bm(t,r=>{console.log("Message received: ",r),alert("Message received: "+r)})}};n.\u0275fac=function(r){return new(r||n)(De(vr),De(O0))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();function ej(e,n){e&1&&se(0,"div",35)}function tj(e,n){if(e&1){let i=be();c(0,"button",33),N("click",function(){G(i);let r=S();return H(r.requestPermission())}),c(1,"span",30),d(2,"\u{1F514}"),l(),c(3,"span",31),d(4,"Enable Notifications"),l(),X(5,ej,1,0,"div",34),l()}if(e&2){let i=S();w("disabled",i.isLoading),p(5),w("ngIf",i.isLoading)}}function nj(e,n){if(e&1){let i=be();c(0,"button",36),N("click",function(){G(i);let r=S();return H(r.openPermissionHelp())}),c(1,"span",30),d(2,"\u2753"),l(),c(3,"span",31),d(4,"How to Enable"),l()()}}function ij(e,n){e&1&&se(0,"div",35)}function rj(e,n){if(e&1){let i=be();c(0,"button",37),N("click",function(){G(i);let r=S();return H(r.testNotification())}),c(1,"span",30),d(2,"\u{1F4E4}"),l(),c(3,"span",31),d(4,"Test Notification"),l(),X(5,ij,1,0,"div",34),l()}if(e&2){let i=S();w("disabled",i.isLoading),p(5),w("ngIf",i.isLoading)}}function aj(e,n){if(e&1){let i=be();c(0,"div",41)(1,"div",42)(2,"div",43)(3,"span",13),d(4),l()(),c(5,"div",44)(6,"h4"),d(7),l(),c(8,"p"),d(9),l()()(),c(10,"mat-slide-toggle",45),N("change",function(r){let a=G(i).$implicit,o=S(2);return H(o.toggleNotificationType(a.key,r))}),l()()}if(e&2){let i=n.$implicit;p(4),z(i.icon),p(3),z(i.title),p(2),z(i.description),p(),w("checked",i.enabled)}}function oj(e,n){if(e&1&&(c(0,"div",38)(1,"div",27)(2,"h3"),d(3,"Notification Types"),l(),c(4,"p"),d(5,"Choose which types of notifications you want to receive"),l()(),c(6,"div",39),X(7,aj,11,4,"div",40),l()()),e&2){let i=S();p(7),w("ngForOf",i.notificationTypes)}}function sj(e,n){e&1&&se(0,"div",35)}function cj(e,n){if(e&1){let i=be();c(0,"div",46)(1,"div",27)(2,"h3"),d(3,"Device Token"),l(),c(4,"p"),d(5,"Your device registration for push notifications"),l()(),c(6,"div",47)(7,"div",48)(8,"div",49),d(9,"Device Token:"),l(),c(10,"div",50)(11,"code"),d(12),l(),c(13,"button",51),N("click",function(){G(i);let r=S();return H(r.copyToken())}),c(14,"span",13),d(15,"\u{1F4CB}"),l()()()(),c(16,"button",52),N("click",function(){G(i);let r=S();return H(r.refreshToken())}),c(17,"span",30),d(18,"\u{1F504}"),l(),c(19,"span",31),d(20,"Refresh Token"),l(),X(21,sj,1,0,"div",34),l()()()}if(e&2){let i=S();p(12),z(i.fcmToken),p(4),w("disabled",i.isLoading),p(5),w("ngIf",i.isLoading)}}function lj(e,n){if(e&1){let i=be();c(0,"div",55)(1,"div",56)(2,"div",57)(3,"span",13),d(4),l()(),c(5,"div",58)(6,"h4"),d(7),l(),c(8,"p"),d(9),l()()(),c(10,"mat-slide-toggle",59),N("change",function(r){let a=G(i).$implicit,o=S(2);return H(o.updateSetting(a.key,r))}),l()()}if(e&2){let i=n.$implicit,t=S(2);p(4),z(i.icon),p(3),z(i.title),p(2),z(i.description),p(),w("checked",t.getSettingValue(i.key))}}function dj(e,n){if(e&1&&(c(0,"div",38)(1,"div",27)(2,"h3"),d(3,"Advanced Settings"),l(),c(4,"p"),d(5,"Customize notification behavior"),l()(),c(6,"div",53),X(7,lj,11,4,"div",54),l()()),e&2){let i=S();p(7),w("ngForOf",i.advancedSettings)}}function uj(e,n){e&1&&(c(0,"div",60)(1,"div",61)(2,"div",62)(3,"span",13),d(4,"\u{1F515}"),l()(),c(5,"h3"),d(6,"Notifications Disabled"),l(),c(7,"p"),d(8,"Enable the master toggle above to configure your notification preferences."),l()()())}function mj(e,n){if(e&1&&(c(0,"div",63)(1,"h4"),d(2,"Debug Information"),l(),c(3,"pre"),d(4),pe(5,"json"),l()()),e&2){let i=S();p(4),z(Ee(5,1,i.debugInfo))}}var H2=(()=>{let n=class n{constructor(t,r){this.messagingService=t,this.notificationService=r,this.destroy$=new vn,this.APP_CONFIG=Dt,this.permissionStatus="default",this.fcmToken=null,this.isLoading=!1,this.notificationsEnabled=!0,this.debugInfo={},this.notificationTypes=[{key:"transactions",title:"Transaction Alerts",description:"Get notified about new transactions and spending limits",icon:"\u{1F4B0}",enabled:!0},{key:"budgets",title:"Budget Reminders",description:"Receive alerts when approaching budget limits",icon:"\u{1F4B3}",enabled:!0},{key:"goals",title:"Goal Updates",description:"Track progress on your financial goals",icon:"\u{1F3AF}",enabled:!0},{key:"bills",title:"Bill Reminders",description:"Never miss a bill payment",icon:"\u{1F4C5}",enabled:!0},{key:"security",title:"Security Alerts",description:"Important security notifications",icon:"\u{1F512}",enabled:!0}],this.advancedSettings=[{key:"soundEnabled",title:"Sound",description:"Play sound for notifications",icon:"\u{1F50A}",value:!0},{key:"vibrationEnabled",title:"Vibration",description:"Vibrate device for notifications",icon:"\u{1F4F3}",value:!0},{key:"requireInteraction",title:"Require Interaction",description:"Keep notifications until user interacts",icon:"\u{1F446}",value:!1}]}ngOnInit(){this.loadSettings(),this.subscribeToMessagingEvents(),this.collectDebugInfo()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadSettings(){this.notificationTypes.forEach(r=>{let a=localStorage.getItem(`notification_${r.key}`);r.enabled=a?JSON.parse(a):!0}),this.advancedSettings.forEach(r=>{let a=localStorage.getItem(`notification_advanced_${r.key}`);r.value=a?JSON.parse(a):r.value});let t=localStorage.getItem("notifications_enabled");this.notificationsEnabled=t?JSON.parse(t):!0}saveSettings(){this.notificationTypes.forEach(t=>{localStorage.setItem(`notification_${t.key}`,JSON.stringify(t.enabled))}),this.advancedSettings.forEach(t=>{localStorage.setItem(`notification_advanced_${t.key}`,JSON.stringify(t.value))}),localStorage.setItem("notifications_enabled",JSON.stringify(this.notificationsEnabled))}subscribeToMessagingEvents(){this.messagingService.permission$.pipe(Qt(this.destroy$)).subscribe(t=>{this.permissionStatus=t,t==="denied"&&(this.notificationsEnabled=!1,this.saveNotificationsEnabled())}),this.messagingService.token$.pipe(Qt(this.destroy$)).subscribe(t=>{this.fcmToken=t,this.collectDebugInfo()})}collectDebugInfo(){this.debugInfo={browser:navigator.userAgent,serviceWorker:"serviceWorker"in navigator,notifications:"Notification"in window,permission:Notification.permission,fcmToken:this.fcmToken,swRegistration:this.messagingService.getServiceWorkerRegistration(),isSupported:this.messagingService.isSupported(),storedToken:this.messagingService.getStoredToken(),timestamp:new Date().toISOString()}}requestPermission(){return ue(this,null,function*(){this.isLoading=!0;try{yield this.messagingService.initializeMessagingWithPermission();let t=yield this.messagingService.requestPermission();console.log("Permission result:",t),t==="granted"?(this.notificationsEnabled=!0,this.saveNotificationsEnabled(),this.notificationService.success("Notifications enabled successfully!")):this.notificationService.error("Notification permission denied")}catch(t){console.error("Error requesting permission:",t),this.notificationService.error("Failed to request notification permission")}finally{this.isLoading=!1}})}testNotification(){return ue(this,null,function*(){this.isLoading=!0;try{this.messagingService.sendTestNotification(),this.notificationService.success("Test notification sent!")}catch(t){console.error("Error sending test notification:",t),this.notificationService.error("Failed to send test notification")}finally{this.isLoading=!1}})}refreshToken(){return ue(this,null,function*(){this.isLoading=!0;try{(yield this.messagingService.refreshToken())?this.notificationService.success("Token refreshed successfully!"):this.notificationService.error("Failed to refresh token")}catch(t){console.error("Error refreshing token:",t),this.notificationService.error("Failed to refresh token")}finally{this.isLoading=!1}})}copyToken(){this.fcmToken&&navigator.clipboard.writeText(this.fcmToken).then(()=>{this.notificationService.success("Token copied to clipboard!")}).catch(()=>{this.notificationService.error("Failed to copy token")})}toggleMasterNotifications(t){this.notificationsEnabled=t.checked,this.saveNotificationsEnabled(),this.notificationsEnabled&&this.permissionStatus==="default"&&this.requestPermission()}toggleNotificationType(t,r){let a=this.notificationTypes.find(o=>o.key===t);a&&(a.enabled=r.checked,this.saveSettings())}updateSetting(t,r){let a=this.advancedSettings.find(o=>o.key===t);a&&(a.value=r.checked,this.saveSettings())}getSettingValue(t){let r=this.advancedSettings.find(a=>a.key===t);return r?r.value:!1}saveNotificationsEnabled(){localStorage.setItem("notifications_enabled",JSON.stringify(this.notificationsEnabled))}getStatusIcon(){switch(this.permissionStatus){case"granted":return"\u2705";case"denied":return"\u274C";default:return"\u2753"}}getPermissionText(){switch(this.permissionStatus){case"granted":return"Granted";case"denied":return"Denied";default:return"Not Set"}}openPermissionHelp(){alert(`
To enable notifications:
1. Click the lock/info icon in your browser's address bar
2. Find "Notifications" in the site settings
3. Change it from "Block" to "Allow"
4. Refresh the page
    `)}debugServiceWorker(){return ue(this,null,function*(){var t,r;try{let a=yield navigator.serviceWorker.getRegistrations();console.log("All service worker registrations:",a);let o=a.find(s=>{var u;return s.scope.includes(oi.serviceWorkerScope)||((u=s.active)==null?void 0:u.scriptURL.includes(oi.serviceWorkerScope+"firebase-messaging-sw.js"))});o?(console.log("Firebase SW found:",o),console.log("Firebase SW state:",(t=o.active)==null?void 0:t.state),console.log("Firebase SW script URL:",(r=o.active)==null?void 0:r.scriptURL)):console.log("No Firebase service worker found"),this.collectDebugInfo(),console.log("Debug info:",this.debugInfo)}catch(a){console.error("Debug error:",a)}})}forceServiceWorkerRegistration(){return ue(this,null,function*(){try{let r=(yield navigator.serviceWorker.getRegistrations()).find(a=>a.scope.includes(oi.serviceWorkerScope));r&&(yield r.unregister(),console.log("Unregistered existing Firebase SW")),setTimeout(()=>ue(this,null,function*(){yield this.messagingService.refreshToken(),this.collectDebugInfo()}),1e3)}catch(t){console.error("Force registration error:",t)}})}};n.\u0275fac=function(r){return new(r||n)(q(ym),q(ht))},n.\u0275cmp=Ve({type:n,selectors:[["app-notification-settings"]],decls:57,vars:20,consts:[[1,"notification-settings"],[1,"settings-header"],[1,"header-content"],[1,"header-text"],[1,"master-toggle-container"],["color","accent",1,"master-toggle",3,"change","checked","disabled"],[1,"toggle-icon"],[1,"master-label"],[1,"settings-content"],[1,"setting-section","permission-card"],[1,"card-header"],[1,"header-left"],[1,"status-icon"],[1,"icon"],[1,"header-info"],[1,"status-text"],[1,"permission-badge"],[1,"card-content"],[1,"description"],[1,"action-buttons"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"],["class","btn btn-warn",3,"click",4,"ngIf"],["class","btn btn-accent",3,"disabled","click",4,"ngIf"],["class","setting-section",4,"ngIf"],["class","setting-section token-card",4,"ngIf"],["class","setting-section disabled-state",4,"ngIf"],[1,"setting-section","debug-section"],[1,"section-header"],[1,"debug-buttons"],[1,"btn","btn-secondary",3,"click"],[1,"btn-icon"],[1,"btn-text"],["class","debug-info",4,"ngIf"],[1,"btn","btn-primary",3,"click","disabled"],["class","btn-loader",4,"ngIf"],[1,"btn-loader"],[1,"btn","btn-warn",3,"click"],[1,"btn","btn-accent",3,"click","disabled"],[1,"setting-section"],[1,"notification-types"],["class","notification-type",4,"ngFor","ngForOf"],[1,"notification-type"],[1,"type-content"],[1,"type-icon"],[1,"type-info"],["color","primary",3,"change","checked"],[1,"setting-section","token-card"],[1,"token-container"],[1,"token-display"],[1,"token-label"],[1,"token-value"],["title","Copy token",1,"copy-btn",3,"click"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"advanced-settings"],["class","setting-item",4,"ngFor","ngForOf"],[1,"setting-item"],[1,"setting-content"],[1,"setting-icon"],[1,"setting-info"],["color","accent",3,"change","checked"],[1,"setting-section","disabled-state"],[1,"disabled-content"],[1,"disabled-icon"],[1,"debug-info"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),d(5,"Notification Settings"),l(),c(6,"p"),d(7,"Manage your push notification preferences"),l()(),c(8,"div",4)(9,"mat-slide-toggle",5),N("change",function(s){return a.toggleMasterNotifications(s)}),c(10,"span",6),d(11),l()(),c(12,"span",7),d(13),l()()()(),c(14,"div",8)(15,"div",9)(16,"div",10)(17,"div",11)(18,"div",12)(19,"span",13),d(20),l()(),c(21,"div",14)(22,"h3"),d(23,"Notification Permission"),l(),c(24,"p",15),d(25),l()()(),c(26,"div",16),d(27),l()(),c(28,"div",17)(29,"p",18),d(30),l(),c(31,"div",19),X(32,tj,6,2,"button",20)(33,nj,5,0,"button",21)(34,rj,6,2,"button",22),l()()(),X(35,oj,8,1,"div",23)(36,cj,22,3,"div",24)(37,dj,8,1,"div",23)(38,uj,9,0,"div",25),c(39,"div",26)(40,"div",27)(41,"h3"),d(42,"Debug Tools"),l(),c(43,"p"),d(44,"Tools to help troubleshoot notification issues"),l()(),c(45,"div",28)(46,"button",29),N("click",function(){return a.debugServiceWorker()}),c(47,"span",30),d(48,"\u{1F50D}"),l(),c(49,"span",31),d(50,"Debug Service Worker"),l()(),c(51,"button",29),N("click",function(){return a.forceServiceWorkerRegistration()}),c(52,"span",30),d(53,"\u{1F504}"),l(),c(54,"span",31),d(55,"Force Re-registration"),l()()(),X(56,mj,6,3,"div",32),l()()()),r&2&&(p(9),w("checked",a.notificationsEnabled)("disabled",a.permissionStatus==="denied"),p(2),z(a.notificationsEnabled?"\u{1F514}":"\u{1F515}"),p(2),z(a.notificationsEnabled?"Enabled":"Disabled"),p(5),Lt(a.permissionStatus),p(2),z(a.getStatusIcon()),p(5),z(a.getPermissionText()),p(),Lt(a.permissionStatus),p(),oe(" ",a.getPermissionText()," "),p(3),oe(" Allow ",a.APP_CONFIG.APP_NAME," to send you notifications about important updates and reminders. "),p(2),w("ngIf",a.permissionStatus==="default"),p(),w("ngIf",a.permissionStatus==="denied"),p(),w("ngIf",a.permissionStatus==="granted"),p(),w("ngIf",a.permissionStatus==="granted"&&a.notificationsEnabled),p(),w("ngIf",a.permissionStatus==="granted"&&a.fcmToken&&a.notificationsEnabled),p(),w("ngIf",a.permissionStatus==="granted"&&a.notificationsEnabled),p(),w("ngIf",!a.notificationsEnabled),p(18),w("ngIf",a.debugInfo))},dependencies:[$r,ct,Jr,Zh],styles:[".notification-settings[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:24px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.settings-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--primary-color, #3b82f6) 0%,var(--accent-color, #8b5cf6) 100%);border-radius:16px;padding:32px;margin-bottom:32px;color:#fff;box-shadow:0 8px 32px #3b82f64d}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:24px}.header-text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:32px;font-weight:700;margin:0 0 8px;color:#fff}.header-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin:0;opacity:.9}.master-toggle-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px}.toggle-icon[_ngcontent-%COMP%]{font-size:18px;z-index:1}.master-label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;opacity:.9}.setting-section[_ngcontent-%COMP%]{background:var(--surface-color, #ffffff);border:1px solid var(--border-color, #e2e8f0);border-radius:16px;padding:24px;margin-bottom:24px;box-shadow:0 2px 8px #0000000d;transition:all .2s ease}.setting-section[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #0000001a;transform:translateY(-1px)}.permission-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9);border:2px solid var(--primary-color, #3b82f6)}.token-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid #f59e0b}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.status-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px}.status-icon.granted[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.status-icon.denied[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.status-icon.default[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.header-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 4px}.status-text[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0}.permission-badge[_ngcontent-%COMP%]{padding:8px 16px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.permission-badge.granted[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.permission-badge.denied[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.permission-badge.default[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.section-header[_ngcontent-%COMP%]{margin-bottom:24px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 8px}.section-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0}.card-content[_ngcontent-%COMP%]{margin-bottom:20px}.description[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0 0 20px;line-height:1.6}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.btn[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border:none;border-radius:12px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s ease;text-decoration:none;min-width:140px;justify-content:center}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:var(--primary-color, #3b82f6);color:#fff;box-shadow:0 4px 12px #3b82f64d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary-color-dark, #2563eb);transform:translateY(-1px);box-shadow:0 6px 16px #3b82f666}.btn-secondary[_ngcontent-%COMP%]{background:var(--surface-hover-color, #f1f5f9);color:var(--text-color, #1e293b);border:1px solid var(--border-color, #e2e8f0)}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--surface-hover-color-dark, #e2e8f0);transform:translateY(-1px)}.btn-warn[_ngcontent-%COMP%]{background:var(--warn-color, #ef4444);color:#fff;box-shadow:0 4px 12px #ef44444d}.btn-warn[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--warn-color-dark, #dc2626);transform:translateY(-1px);box-shadow:0 6px 16px #ef444466}.btn-accent[_ngcontent-%COMP%]{background:var(--accent-color, #8b5cf6);color:#fff;box-shadow:0 4px 12px #8b5cf64d}.btn-accent[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--accent-color-dark, #7c3aed);transform:translateY(-1px);box-shadow:0 6px 16px #8b5cf666}.btn-icon[_ngcontent-%COMP%]{font-size:16px}.btn-text[_ngcontent-%COMP%]{font-weight:600}.btn-loader[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid transparent;border-top:2px solid currentColor;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.notification-types[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.notification-type[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border:1px solid var(--border-color, #e2e8f0);border-radius:12px;background:var(--surface-hover-color, #f8fafc);transition:all .2s ease}.notification-type[_ngcontent-%COMP%]:hover{background:var(--surface-hover-color-dark, #f1f5f9);border-color:var(--primary-color, #3b82f6)}.type-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;flex:1}.type-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;background:var(--primary-color, #3b82f6);display:flex;align-items:center;justify-content:center;color:#fff;font-size:20px}.type-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 4px}.type-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0;line-height:1.4}.token-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.token-display[_ngcontent-%COMP%]{background:var(--surface-hover-color, #f8fafc);border:1px solid var(--border-color, #e2e8f0);border-radius:12px;padding:16px}.token-label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:var(--text-muted, #64748b);margin-bottom:8px;text-transform:uppercase;letter-spacing:.5px}.token-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.token-value[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{flex:1;font-family:Courier New,monospace;font-size:12px;color:var(--text-color, #1e293b);word-break:break-all;background:#0000000d;padding:8px 12px;border-radius:6px}.copy-btn[_ngcontent-%COMP%]{background:var(--primary-color, #3b82f6);color:#fff;border:none;padding:8px;border-radius:6px;cursor:pointer;transition:all .2s ease}.copy-btn[_ngcontent-%COMP%]:hover{background:var(--primary-color-dark, #2563eb);transform:scale(1.05)}.advanced-settings[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.setting-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border:1px solid var(--border-color, #e2e8f0);border-radius:12px;background:var(--surface-hover-color, #f8fafc);transition:all .2s ease}.setting-item[_ngcontent-%COMP%]:hover{background:var(--surface-hover-color-dark, #f1f5f9);border-color:var(--primary-color, #3b82f6)}.setting-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;flex:1}.setting-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;background:var(--accent-color, #8b5cf6);display:flex;align-items:center;justify-content:center;color:#fff;font-size:18px}.setting-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 4px}.setting-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0;line-height:1.4}  .mat-mdc-slide-toggle .mdc-switch .mdc-switch__track{background-color:#cbd5e1;border-color:#cbd5e1}  .mat-mdc-slide-toggle .mdc-switch .mdc-switch__handle-track{background-color:var(--primary-color, #3b82f6)}  .mat-mdc-slide-toggle .mdc-switch .mdc-switch__handle{background-color:#fff;box-shadow:0 2px 4px #0003}  .mat-mdc-slide-toggle.mat-mdc-slide-toggle-checked .mdc-switch .mdc-switch__track{background-color:var(--primary-color, #3b82f6);border-color:var(--primary-color, #3b82f6)}  .mat-mdc-slide-toggle .mdc-form-field .mdc-form-field__label{display:none}.notification-type[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mdc-switch, .setting-item[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mdc-switch{width:48px;height:24px}.disabled-state[_ngcontent-%COMP%]{text-align:center;padding:48px 24px}.disabled-content[_ngcontent-%COMP%]{max-width:400px;margin:0 auto}.disabled-icon[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:var(--surface-hover-color, #f8fafc);display:flex;align-items:center;justify-content:center;margin:0 auto 24px;font-size:32px;color:var(--text-muted, #64748b)}.disabled-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 12px}.disabled-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0;line-height:1.5}@media (max-width: 768px){.notification-settings[_ngcontent-%COMP%]{padding:16px}.settings-header[_ngcontent-%COMP%]{padding:24px 20px}.header-content[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:20px}.header-text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px}.setting-section[_ngcontent-%COMP%]{padding:20px}.card-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.action-buttons[_ngcontent-%COMP%]{flex-direction:column}.action-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}.notification-type[_ngcontent-%COMP%], .setting-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.type-content[_ngcontent-%COMP%], .setting-content[_ngcontent-%COMP%]{width:100%}}"]});let e=n;return e})();function gj(e,n){if(e&1&&(c(0,"mat-error"),d(1),l()),e&2){let i=S();p(),z(i.getFieldError("name"))}}function fj(e,n){if(e&1&&(c(0,"mat-error"),d(1),l()),e&2){let i=S();p(),z(i.getFieldError("email"))}}function pj(e,n){if(e&1&&(c(0,"mat-error"),d(1),l()),e&2){let i=S();p(),z(i.getFieldError("subject"))}}function hj(e,n){if(e&1&&(c(0,"mat-option",39)(1,"div",40)(2,"mat-icon"),d(3),l(),c(4,"span"),d(5),l()()()),e&2){let i=n.$implicit;w("value",i.value),p(3),z(i.icon),p(2),z(i.label)}}function xj(e,n){if(e&1&&(c(0,"mat-error"),d(1),l()),e&2){let i=S();p(),z(i.getFieldError("category"))}}function _j(e,n){if(e&1&&(c(0,"mat-option",39)(1,"div",41),se(2,"div",42),c(3,"span"),d(4),l()()()),e&2){let i=n.$implicit;w("value",i.value),p(2),Xt("background-color",i.color),p(2),z(i.label)}}function Cj(e,n){if(e&1&&(c(0,"mat-error"),d(1),l()),e&2){let i=S();p(),z(i.getFieldError("priority"))}}function vj(e,n){if(e&1){let i=be();c(0,"button",43),N("click",function(){let r=G(i).$implicit,a=S();return H(a.setRating(r))})("mouseenter",function(){let r=G(i).$implicit,a=S();return H(a.setRating(r))})("mouseleave",function(){let r;G(i);let a=S();return H(a.setRating(((r=a.feedbackForm.get("rating"))==null?null:r.value)||0))}),c(1,"mat-icon"),d(2),l()()}if(e&2){let i,t,r=n.index,a=S();Je("active",((i=a.feedbackForm.get("rating"))==null?null:i.value)&&r<((i=a.feedbackForm.get("rating"))==null?null:i.value)),p(2),z(r<(((t=a.feedbackForm.get("rating"))==null?null:t.value)||0)?"star":"star_border")}}function bj(e,n){if(e&1&&(c(0,"span",44),d(1),l()),e&2){let i,t=S();p(),oe(" ",(i=t.feedbackForm.get("rating"))==null?null:i.value,"/5 stars ")}}function yj(e,n){if(e&1&&(c(0,"mat-error"),d(1),l()),e&2){let i=S();p(),z(i.getFieldError("message"))}}function Mj(e,n){e&1&&(c(0,"mat-icon"),d(1,"send"),l())}function wj(e,n){e&1&&se(0,"mat-spinner",45)}var q2=(()=>{let n=class n{constructor(t,r,a,o,s,u,m){this.fb=t,this.dialog=r,this.breakpointObserver=a,this.auth=o,this.notificationService=s,this.hapticFeedback=u,this.feedbackService=m,this.isMobile=!1,this.isSubmitting=!1,this.currentUser=null,this.destroy$=new vn,this.appName=Dt.APP_NAME,this.feedbackCategories=[{value:"bug",label:"Bug Report",icon:"bug_report"},{value:"feature",label:"Feature Request",icon:"lightbulb"},{value:"improvement",label:"Improvement Suggestion",icon:"trending_up"},{value:"general",label:"General Feedback",icon:"chat"},{value:"support",label:"Support Request",icon:"help"}],this.priorityLevels=[{value:"low",label:"Low",color:"#10b981"},{value:"medium",label:"Medium",color:"#f59e0b"},{value:"high",label:"High",color:"#ef4444"}],this.ratingOptions=[1,2,3,4,5],this.feedbackForm=this.createForm(),this.breakpointObserver.observe([cc.Handset]).pipe(Qt(this.destroy$)).subscribe(f=>{this.isMobile=f.matches})}ngOnInit(){this.initializeUser()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeUser(){return ue(this,null,function*(){this.currentUser=yield this.auth.currentUser,this.currentUser&&this.feedbackForm.patchValue({name:this.currentUser.displayName||"",email:this.currentUser.email||""})})}createForm(){return this.fb.group({name:["",[Qe.required,Qe.minLength(2),Qe.maxLength(50)]],email:["",[Qe.required,Qe.email]],subject:["",[Qe.required,Qe.minLength(5),Qe.maxLength(100)]],message:["",[Qe.required,Qe.minLength(10),Qe.maxLength(1e3)]],category:["general",Qe.required],priority:["medium",Qe.required],rating:[null]})}getCategoryIcon(t){let r=this.feedbackCategories.find(a=>a.value===t);return r?r.icon:"chat"}getPriorityColor(t){let r=this.priorityLevels.find(a=>a.value===t);return r?r.color:"#6b7280"}setRating(t){this.feedbackForm.patchValue({rating:t}),this.isMobile&&this.hapticFeedback.lightVibration()}getRatingStars(t){return Array.from({length:5},(r,a)=>a<t)}submitFeedback(){return ue(this,null,function*(){var t;if(this.feedbackForm.invalid){this.markFormGroupTouched(),this.notificationService.warning("Please fill in all required fields correctly");return}if(!this.isSubmitting){this.isSubmitting=!0,this.isMobile&&this.hapticFeedback.lightVibration();try{let r=le(ae({},this.feedbackForm.value),{userId:((t=this.currentUser)==null?void 0:t.uid)||"anonymous"});yield this.feedbackService.submitFeedback(r),this.notificationService.success("Thank you for your feedback! We'll get back to you soon."),this.resetForm()}catch(r){console.error("Error submitting feedback:",r),this.notificationService.error("Failed to submit feedback. Please try again.")}finally{this.isSubmitting=!1}}})}resetForm(){this.feedbackForm.reset({category:"general",priority:"medium",rating:null}),this.currentUser&&this.feedbackForm.patchValue({name:this.currentUser.displayName||"",email:this.currentUser.email||""})}markFormGroupTouched(){Object.keys(this.feedbackForm.controls).forEach(t=>{let r=this.feedbackForm.get(t);r==null||r.markAsTouched()})}getFieldError(t){let r=this.feedbackForm.get(t);if(r!=null&&r.errors&&r.touched){if(r.errors.required)return`${this.getFieldLabel(t)} is required`;if(r.errors.email)return"Please enter a valid email address";if(r.errors.minlength)return`${this.getFieldLabel(t)} must be at least ${r.errors.minlength.requiredLength} characters`;if(r.errors.maxlength)return`${this.getFieldLabel(t)} must not exceed ${r.errors.maxlength.requiredLength} characters`}return""}getFieldLabel(t){return{name:"Name",email:"Email",subject:"Subject",message:"Message",category:"Category",priority:"Priority"}[t]||t}isFieldInvalid(t){let r=this.feedbackForm.get(t);return!!(r!=null&&r.invalid&&r.touched)}};n.\u0275fac=function(r){return new(r||n)(q(Ii),q(fn),q(Zi),q(pt),q(ht),q(Sr),q(Wx))},n.\u0275cmp=Ve({type:n,selectors:[["app-feedback"]],decls:117,vars:20,consts:[[1,"feedback-container"],[1,"feedback-header"],[1,"header-content"],[1,"page-title"],[1,"page-subtitle"],[1,"header-icon"],[1,"feedback-form-container"],[1,"feedback-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"section-title"],[1,"form-row"],["appearance","fill",1,"form-field"],["matInput","","formControlName","name","placeholder","Your name","maxlength","50"],[4,"ngIf"],["matInput","","formControlName","email","type","email","placeholder","your.email@example.com"],["matSuffix",""],["matInput","","formControlName","subject","placeholder","Brief description of your feedback","maxlength","100"],["appearance","fill",1,"form-field","category-field"],["formControlName","category"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill",1,"form-field","priority-field"],["formControlName","priority"],[1,"rating-section"],[1,"rating-label"],[1,"rating-stars"],["type","button","class","star-button",3,"active","click","mouseenter","mouseleave",4,"ngFor","ngForOf"],["class","rating-text",4,"ngIf"],["appearance","fill",1,"form-field","message-field"],["matInput","","formControlName","message","placeholder","Please provide detailed feedback, suggestions, or describe any issues you've encountered...","rows","6","maxlength","1000"],[1,"submit-section"],[1,"submit-info"],[1,"submit-actions"],["type","button","mat-stroked-button","",1,"reset-button",3,"click","disabled"],["type","submit","mat-raised-button","","color","primary",1,"submit-button",3,"disabled"],["diameter","20",4,"ngIf"],[1,"help-section"],[1,"help-title"],[1,"help-content"],[1,"help-item"],[3,"value"],[1,"category-option"],[1,"priority-option"],[1,"priority-indicator"],["type","button",1,"star-button",3,"click","mouseenter","mouseleave"],[1,"rating-text"],["diameter","20"]],template:function(r,a){if(r&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),d(4,"Send Feedback"),l(),c(5,"p",4),d(6),l()(),c(7,"div",5)(8,"mat-icon"),d(9,"feedback"),l()()(),c(10,"div",6)(11,"form",7),N("ngSubmit",function(){return a.submitFeedback()}),c(12,"div",8)(13,"h3",9)(14,"mat-icon"),d(15,"person"),l(),d(16," Personal Information "),l(),c(17,"div",10)(18,"mat-form-field",11)(19,"mat-label"),d(20,"Name *"),l(),se(21,"input",12),X(22,gj,2,1,"mat-error",13),c(23,"mat-hint"),d(24),l()(),c(25,"mat-form-field",11)(26,"mat-label"),d(27,"Email *"),l(),se(28,"input",14),c(29,"mat-icon",15),d(30,"email"),l(),X(31,fj,2,1,"mat-error",13),l()()(),c(32,"div",8)(33,"h3",9)(34,"mat-icon"),d(35,"description"),l(),d(36," Feedback Details "),l(),c(37,"div",10)(38,"mat-form-field",11)(39,"mat-label"),d(40,"Subject *"),l(),se(41,"input",16),X(42,pj,2,1,"mat-error",13),c(43,"mat-hint"),d(44),l()()(),c(45,"div",10)(46,"mat-form-field",17)(47,"mat-label"),d(48,"Category *"),l(),c(49,"mat-select",18),X(50,hj,6,3,"mat-option",19),l(),X(51,xj,2,1,"mat-error",13),l(),c(52,"mat-form-field",20)(53,"mat-label"),d(54,"Priority *"),l(),c(55,"mat-select",21),X(56,_j,5,4,"mat-option",19),l(),X(57,Cj,2,1,"mat-error",13),l()(),c(58,"div",22)(59,"label",23),d(60,"How would you rate your experience? (Optional)"),l(),c(61,"div",24),X(62,vj,3,3,"button",25),l(),X(63,bj,2,1,"span",26),l(),c(64,"div",10)(65,"mat-form-field",27)(66,"mat-label"),d(67,"Message *"),l(),se(68,"textarea",28),X(69,yj,2,1,"mat-error",13),c(70,"mat-hint"),d(71),l()()()(),c(72,"div",29)(73,"div",30)(74,"mat-icon"),d(75,"info"),l(),c(76,"span"),d(77,"Your feedback will be sent to our team and we'll get back to you as soon as possible."),l()(),c(78,"div",31)(79,"button",32),N("click",function(){return a.resetForm()}),c(80,"mat-icon"),d(81,"refresh"),l(),d(82," Reset "),l(),c(83,"button",33),X(84,Mj,2,0,"mat-icon",13)(85,wj,1,0,"mat-spinner",34),d(86),l()()()()(),c(87,"div",35)(88,"h3",36)(89,"mat-icon"),d(90,"help"),l(),d(91," Need Help? "),l(),c(92,"div",37)(93,"div",38)(94,"mat-icon"),d(95,"bug_report"),l(),c(96,"div")(97,"h4"),d(98,"Bug Report"),l(),c(99,"p"),d(100,"Found a bug? Please include steps to reproduce the issue and any error messages you see."),l()()(),c(101,"div",38)(102,"mat-icon"),d(103,"lightbulb"),l(),c(104,"div")(105,"h4"),d(106,"Feature Request"),l(),c(107,"p"),d(108,"Have an idea for a new feature? Let us know how it would help you manage your money better."),l()()(),c(109,"div",38)(110,"mat-icon"),d(111,"support"),l(),c(112,"div")(113,"h4"),d(114,"Support"),l(),c(115,"p"),d(116,"Need help using the app? We're here to assist you with any questions or concerns."),l()()()()()()),r&2){let o,s,u,m;p(6),oe("Help us improve ",a.appName," by sharing your thoughts, suggestions, or reporting issues."),p(5),w("formGroup",a.feedbackForm),p(11),w("ngIf",a.isFieldInvalid("name")),p(2),oe("",((o=a.feedbackForm.get("name"))==null||o.value==null?null:o.value.length)||0,"/50"),p(7),w("ngIf",a.isFieldInvalid("email")),p(11),w("ngIf",a.isFieldInvalid("subject")),p(2),oe("",((s=a.feedbackForm.get("subject"))==null||s.value==null?null:s.value.length)||0,"/100"),p(6),w("ngForOf",a.feedbackCategories),p(),w("ngIf",a.isFieldInvalid("category")),p(5),w("ngForOf",a.priorityLevels),p(),w("ngIf",a.isFieldInvalid("priority")),p(5),w("ngForOf",a.ratingOptions),p(),w("ngIf",(u=a.feedbackForm.get("rating"))==null?null:u.value),p(6),w("ngIf",a.isFieldInvalid("message")),p(2),oe("",((m=a.feedbackForm.get("message"))==null||m.value==null?null:m.value.length)||0,"/1000"),p(8),w("disabled",a.isSubmitting),p(4),w("disabled",a.feedbackForm.invalid||a.isSubmitting),p(),w("ngIf",!a.isSubmitting),p(),w("ngIf",a.isSubmitting),p(),oe(" ",a.isSubmitting?"Sending...":"Send Feedback"," ")}},dependencies:[$r,ct,jn,Vt,Ut,Un,Js,Ei,Ti,Ht,at,Xr,Ji,Zr,Dd,Sa,wo,Ni,Fi,Pa],styles:["@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}.feedback-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:2rem;animation:_ngcontent-%COMP%_slideInUp .5s ease-out}@media (max-width: 768px){.feedback-container[_ngcontent-%COMP%]{padding:1rem}}.feedback-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:2rem;padding:1.5rem;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:16px;color:#fff;box-shadow:0 8px 32px #667eea4d}@media (max-width: 768px){.feedback-header[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:1rem}}.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1}.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin:0 0 .5rem;text-shadow:0 2px 4px rgba(0,0,0,.1)}@media (max-width: 768px){.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:1.5rem}}.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{font-size:1rem;margin:0;opacity:.9;line-height:1.5}@media (max-width: 768px){.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{font-size:.9rem}}.feedback-header[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;opacity:.8}@media (max-width: 768px){.feedback-header[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2.5rem;width:2.5rem;height:2.5rem}}.feedback-form-container[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:0 4px 20px #00000014;overflow:hidden;margin-bottom:2rem}.feedback-form-container[_ngcontent-%COMP%]   .feedback-form[_ngcontent-%COMP%]{padding:2rem}@media (max-width: 768px){.feedback-form-container[_ngcontent-%COMP%]   .feedback-form[_ngcontent-%COMP%]{padding:1.5rem}}.form-section[_ngcontent-%COMP%]{margin-bottom:2rem}.form-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.25rem;font-weight:600;color:#1f2937;margin:0 0 1.5rem;padding-bottom:.5rem;border-bottom:2px solid #e5e7eb}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1rem}@media (max-width: 768px){.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.75rem}}.form-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-field[_ngcontent-%COMP%]{width:100%}@media (max-width: 768px){.form-field.category-field[_ngcontent-%COMP%], .form-field.priority-field[_ngcontent-%COMP%]{grid-column:1}}.form-field.message-field[_ngcontent-%COMP%]{grid-column:1/-1}.category-option[_ngcontent-%COMP%], .priority-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.category-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .priority-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.2rem;width:1.2rem;height:1.2rem}.priority-indicator[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;flex-shrink:0}.rating-section[_ngcontent-%COMP%]{margin:1.5rem 0;padding:1rem;background:#f8fafc;border-radius:12px;border:1px solid #e2e8f0}.rating-section[_ngcontent-%COMP%]   .rating-label[_ngcontent-%COMP%]{display:block;font-weight:500;color:#374151;margin-bottom:.75rem}.rating-section[_ngcontent-%COMP%]   .rating-stars[_ngcontent-%COMP%]{display:flex;gap:.25rem;margin-bottom:.5rem}.rating-section[_ngcontent-%COMP%]   .rating-stars[_ngcontent-%COMP%]   .star-button[_ngcontent-%COMP%]{background:none;border:none;padding:.25rem;cursor:pointer;border-radius:4px;transition:all .2s ease}.rating-section[_ngcontent-%COMP%]   .rating-stars[_ngcontent-%COMP%]   .star-button[_ngcontent-%COMP%]:hover{background:#667eea1a;transform:scale(1.1)}.rating-section[_ngcontent-%COMP%]   .rating-stars[_ngcontent-%COMP%]   .star-button.active[_ngcontent-%COMP%]{color:#fbbf24}.rating-section[_ngcontent-%COMP%]   .rating-stars[_ngcontent-%COMP%]   .star-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.5rem;width:1.5rem;height:1.5rem}.rating-section[_ngcontent-%COMP%]   .rating-text[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.submit-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:1.5rem;border-top:1px solid #e5e7eb}.submit-section[_ngcontent-%COMP%]   .submit-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:1.5rem;padding:1rem;background:#eff6ff;border-radius:8px;border-left:4px solid #3b82f6}.submit-section[_ngcontent-%COMP%]   .submit-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#3b82f6;flex-shrink:0}.submit-section[_ngcontent-%COMP%]   .submit-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;color:#1e40af;line-height:1.4}.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end}@media (max-width: 768px){.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]{flex-direction:column;gap:.75rem}}.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]   .reset-button[_ngcontent-%COMP%]{min-width:120px}@media (max-width: 768px){.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]   .reset-button[_ngcontent-%COMP%]{order:2}}.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]{min-width:160px;height:48px}@media (max-width: 768px){.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]{order:1}}.submit-section[_ngcontent-%COMP%]   .submit-actions[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-right:.5rem}.help-section[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:0 4px 20px #00000014;padding:2rem}@media (max-width: 768px){.help-section[_ngcontent-%COMP%]{padding:1.5rem}}.help-section[_ngcontent-%COMP%]   .help-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.25rem;font-weight:600;color:#1f2937;margin:0 0 1.5rem}.help-section[_ngcontent-%COMP%]   .help-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea}.help-section[_ngcontent-%COMP%]   .help-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}@media (max-width: 768px){.help-section[_ngcontent-%COMP%]   .help-content[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}}.help-section[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:1rem;background:#f8fafc;border-radius:12px;border:1px solid #e2e8f0;transition:all .2s ease}.help-section[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.help-section[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea;font-size:1.5rem;width:1.5rem;height:1.5rem;flex-shrink:0;margin-top:.125rem}.help-section[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#1f2937;margin:0 0 .5rem}.help-section[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin:0;line-height:1.5}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .feedback-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4c1d95,#7c3aed)}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .feedback-form-container[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .help-section[_ngcontent-%COMP%]{background:#1f2937;box-shadow:0 4px 20px #0000004d}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{color:#f9fafb;border-bottom-color:#374151}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .rating-section[_ngcontent-%COMP%]{background:#374151;border-color:#4b5563}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .rating-section[_ngcontent-%COMP%]   .rating-label[_ngcontent-%COMP%]{color:#f9fafb}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .submit-section[_ngcontent-%COMP%]{border-top-color:#374151}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .submit-section[_ngcontent-%COMP%]   .submit-info[_ngcontent-%COMP%]{background:#1e3a8a;border-left-color:#3b82f6}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .submit-section[_ngcontent-%COMP%]   .submit-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#dbeafe}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .help-section[_ngcontent-%COMP%]   .help-title[_ngcontent-%COMP%]{color:#f9fafb}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]{background:#374151;border-color:#4b5563}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#f9fafb}.dark[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]   .help-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#9ca3af}@media (max-width: 480px){.feedback-container[_ngcontent-%COMP%]{padding:.5rem}.feedback-header[_ngcontent-%COMP%]{padding:1rem}.feedback-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:1.25rem}.feedback-header[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2rem;width:2rem;height:2rem}.feedback-form-container[_ngcontent-%COMP%]   .feedback-form[_ngcontent-%COMP%], .help-section[_ngcontent-%COMP%]{padding:1rem}}.star-button[_ngcontent-%COMP%]:focus{outline:2px solid #667eea;outline-offset:2px}.form-field[_ngcontent-%COMP%]:focus-within   .mat-form-field-outline[_ngcontent-%COMP%]{color:#667eea}.submit-button[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.form-field.mat-form-field-disabled[_ngcontent-%COMP%]{opacity:.6}"]});let e=n;return e})();var X2=(()=>{let n=class n{};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=Ve({type:n,selectors:[["app-app-shell"]],decls:23,vars:0,consts:[["id","app-shell",1,"app-shell"],[1,"app-shell-header"],[1,"app-shell-logo"],[1,"app-shell-logo-icon"],["src","assets/images/logo.svg","alt","Money Manager Logo",1,"logo-image"],[1,"font-heading","font-semibold","text-xl"],[1,"app-shell-skeleton","w-10","h-10","rounded-full"],[1,"app-shell-content"],[1,"app-shell-loading"],[1,"app-shell-spinner"],[1,"font-heading","font-semibold","text-2xl","mb-2"],[1,"text-sm","opacity-80"],[1,"w-full","max-w-md","mt-8"],[1,"app-shell-skeleton","app-shell-skeleton-header"],[1,"app-shell-skeleton","app-shell-skeleton-text"],[1,"app-shell-skeleton","app-shell-skeleton-text",2,"width","120px"],[1,"app-shell-skeleton","app-shell-skeleton-text",2,"width","180px"],[1,"app-shell-footer"],[1,"m-0","text-sm"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3),se(4,"img",4),l(),c(5,"span",5),d(6,"Money Manager"),l()(),se(7,"div",6),l(),c(8,"main",7)(9,"div",8),se(10,"div",9),c(11,"h2",10),d(12,"Loading Money Manager"),l(),c(13,"p",11),d(14,"Preparing your financial dashboard..."),l()(),c(15,"div",12),se(16,"div",13)(17,"div",14)(18,"div",15)(19,"div",16),l()(),c(20,"footer",17)(21,"p",18),d(22,"\xA9 2024 Money Manager - Your Personal Finance Assistant"),l()()())},styles:[".app-shell[_ngcontent-%COMP%]{font-family:Inter,sans-serif;background:#f9fafb;min-height:100vh;display:flex;flex-direction:column;color:#1f2937}.app-shell-header[_ngcontent-%COMP%]{background:#fff;padding:1rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e5e7eb;box-shadow:0 1px 3px #0000001a}.app-shell-logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-weight:600;font-size:1.25rem}.app-shell-logo-icon[_ngcontent-%COMP%]{width:32px;height:32px;background:#46777f;border-radius:8px;display:flex;align-items:center;justify-content:center}.app-shell-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;text-align:center}.app-shell-loading[_ngcontent-%COMP%]{margin:2rem 0}.app-shell-spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid #e5e7eb;border-top:4px solid #46777f;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}.app-shell-skeleton[_ngcontent-%COMP%]{background:#e5e7eb;border-radius:8px;margin:.5rem 0;animation:_ngcontent-%COMP%_pulse 2s cubic-bezier(.4,0,.6,1) infinite}.app-shell-skeleton-header[_ngcontent-%COMP%]{height:20px;width:200px;margin:0 auto 1rem}.app-shell-skeleton-text[_ngcontent-%COMP%]{height:16px;width:150px;margin:.5rem auto}.app-shell-footer[_ngcontent-%COMP%]{background:#fff;padding:1rem;text-align:center;font-size:.875rem;color:#6b7280;border-top:1px solid #e5e7eb}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}@media (max-width: 768px){.app-shell-content[_ngcontent-%COMP%]{padding:1rem}.app-shell-logo[_ngcontent-%COMP%]{font-size:1rem}.app-shell-logo-icon[_ngcontent-%COMP%]{width:28px;height:28px}}"]});let e=n;return e})();var K2=(()=>{let n=class n{constructor(){this.lastUpdated="December 2024"}navigateBack(){window.history.back()}};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=Ve({type:n,selectors:[["app-privacy-policy"]],decls:182,vars:2,consts:[[1,"min-h-screen","bg-gray-50"],[1,"bg-white","shadow-sm","border-b"],[1,"container","mx-auto","px-4","py-4"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"p-2","rounded-lg","hover:bg-gray-100","transition-colors","duration-200",3,"click"],[1,"w-8","h-8","rounded-lg","flex","items-center","justify-center","bg-gradient-to-r","from-primary","to-primary-600"],["src","assets/icon/app-icon/icon-192x192.png","alt","Money Manager",1,"w-6","h-6"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"container","mx-auto","px-4","py-8","overflow-y-auto","h-screen"],[1,"max-w-4xl","mx-auto","bg-white","rounded-xl","shadow-sm","p-8"],[1,"mb-8"],[1,"text-2xl","font-bold","text-gray-900","mb-4"],[1,"text-gray-700","leading-relaxed","mb-4"],[1,"text-gray-700","leading-relaxed"],[1,"text-lg","font-semibold","text-gray-800","mb-3"],[1,"list-disc","list-inside","text-gray-700","mb-4","space-y-2"],[1,"list-disc","list-inside","text-gray-700","space-y-2"],[1,"bg-gray-50","rounded-lg","p-4"],[1,"space-y-2","text-gray-700"],[1,"border-t","pt-6","mt-8"],[1,"text-sm","text-gray-500","text-center"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),N("click",function(){return a.navigateBack()}),c(6,"mat-icon"),d(7,"arrow_back"),l()(),c(8,"div",4)(9,"div",6),se(10,"img",7),l(),c(11,"h1",8),d(12,"Privacy Policy"),l()()(),c(13,"div",9),d(14),l()()()(),c(15,"div",10)(16,"div",11)(17,"section",12)(18,"h2",13),d(19,"Introduction"),l(),c(20,"p",14),d(21,' Money Manager ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our money management application. '),l(),c(22,"p",15),d(23," By using our application, you agree to the collection and use of information in accordance with this policy. "),l()(),c(24,"section",12)(25,"h2",13),d(26,"Information We Collect"),l(),c(27,"h3",16),d(28,"Personal Information"),l(),c(29,"ul",17)(30,"li"),d(31,"Name and email address when you create an account"),l(),c(32,"li"),d(33,"Profile information you choose to provide"),l(),c(34,"li"),d(35,"Financial data you input (transactions, budgets, goals)"),l(),c(36,"li"),d(37,"Account preferences and settings"),l()(),c(38,"h3",16),d(39,"Usage Information"),l(),c(40,"ul",17)(41,"li"),d(42,"App usage patterns and features accessed"),l(),c(43,"li"),d(44,"Device information and browser type"),l(),c(45,"li"),d(46,"IP address and general location data"),l(),c(47,"li"),d(48,"Error logs and performance data"),l()()(),c(49,"section",12)(50,"h2",13),d(51,"How We Use Your Information"),l(),c(52,"ul",18)(53,"li"),d(54,"Provide and maintain our money management services"),l(),c(55,"li"),d(56,"Process your transactions and financial data"),l(),c(57,"li"),d(58,"Generate reports and insights about your finances"),l(),c(59,"li"),d(60,"Improve our application and user experience"),l(),c(61,"li"),d(62,"Send important updates and notifications"),l(),c(63,"li"),d(64,"Provide customer support and respond to inquiries"),l(),c(65,"li"),d(66,"Ensure security and prevent fraud"),l()()(),c(67,"section",12)(68,"h2",13),d(69,"Data Storage and Security"),l(),c(70,"p",14),d(71," We implement industry-standard security measures to protect your personal and financial information: "),l(),c(72,"ul",17)(73,"li"),d(74,"End-to-end encryption for sensitive data"),l(),c(75,"li"),d(76,"Secure cloud storage with regular backups"),l(),c(77,"li"),d(78,"Multi-factor authentication for account access"),l(),c(79,"li"),d(80,"Regular security audits and updates"),l(),c(81,"li"),d(82,"Limited access to personal data by authorized personnel only"),l()(),c(83,"p",15),d(84," Your data is stored securely and we never share your financial information with third parties without your explicit consent. "),l()(),c(85,"section",12)(86,"h2",13),d(87,"Data Sharing"),l(),c(88,"p",14),d(89," We do not sell, trade, or rent your personal information to third parties. We may share your information only in the following circumstances: "),l(),c(90,"ul",18)(91,"li"),d(92,"With your explicit consent"),l(),c(93,"li"),d(94,"To comply with legal obligations"),l(),c(95,"li"),d(96,"To protect our rights and prevent fraud"),l(),c(97,"li"),d(98,"With trusted service providers who assist in app operations (under strict confidentiality agreements)"),l()()(),c(99,"section",12)(100,"h2",13),d(101,"Your Rights"),l(),c(102,"p",14),d(103," You have the following rights regarding your personal information: "),l(),c(104,"ul",18)(105,"li")(106,"strong"),d(107,"Access:"),l(),d(108," Request a copy of your personal data"),l(),c(109,"li")(110,"strong"),d(111,"Correction:"),l(),d(112," Update or correct inaccurate information"),l(),c(113,"li")(114,"strong"),d(115,"Deletion:"),l(),d(116," Request deletion of your account and data"),l(),c(117,"li")(118,"strong"),d(119,"Portability:"),l(),d(120," Export your data in a standard format"),l(),c(121,"li")(122,"strong"),d(123,"Opt-out:"),l(),d(124," Unsubscribe from marketing communications"),l()()(),c(125,"section",12)(126,"h2",13),d(127,"Cookies and Tracking"),l(),c(128,"p",14),d(129," We use cookies and similar technologies to: "),l(),c(130,"ul",17)(131,"li"),d(132,"Remember your preferences and settings"),l(),c(133,"li"),d(134,"Analyze app usage and performance"),l(),c(135,"li"),d(136,"Provide personalized features"),l(),c(137,"li"),d(138,"Ensure security and prevent fraud"),l()(),c(139,"p",15),d(140," You can control cookie settings through your browser preferences. "),l()(),c(141,"section",12)(142,"h2",13),d(143,"Children's Privacy"),l(),c(144,"p",15),d(145," Our application is not intended for children under 13 years of age. We do not knowingly collect personal information from children under 13. If you are a parent or guardian and believe your child has provided us with personal information, please contact us immediately. "),l()(),c(146,"section",12)(147,"h2",13),d(148,"Changes to This Privacy Policy"),l(),c(149,"p",14),d(150," We may update this Privacy Policy from time to time. We will notify you of any changes by: "),l(),c(151,"ul",17)(152,"li"),d(153,"Posting the new Privacy Policy on this page"),l(),c(154,"li"),d(155,"Sending you an email notification"),l(),c(156,"li"),d(157,"Displaying a notice in the application"),l()(),c(158,"p",15),d(159," Your continued use of the application after any changes constitutes acceptance of the updated Privacy Policy. "),l()(),c(160,"section",12)(161,"h2",13),d(162,"Contact Us"),l(),c(163,"p",14),d(164," If you have any questions about this Privacy Policy or our data practices, please contact us: "),l(),c(165,"div",19)(166,"div",20)(167,"p")(168,"strong"),d(169,"Email:"),l(),d(170," Prashiln79@gmail.com"),l(),c(171,"p")(172,"strong"),d(173,"Address:"),l(),d(174," Goa, India"),l(),c(175,"p")(176,"strong"),d(177,"Response Time:"),l(),d(178," We aim to respond to all privacy-related inquiries within 48 hours."),l()()()(),c(179,"div",21)(180,"p",22),d(181),l()()()()()),r&2&&(p(14),oe(" Last updated: ",a.lastUpdated," "),p(167),oe(" This Privacy Policy is effective as of ",a.lastUpdated," and will remain in effect except with respect to any changes in its provisions in the future. "))},dependencies:[at],styles:[".privacy-policy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.privacy-policy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9}.privacy-policy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}.privacy-policy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}button[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}button[_ngcontent-%COMP%]:active{transform:translateY(0)}@media print{.bg-gray-50[_ngcontent-%COMP%]{background-color:#fff!important}.shadow-sm[_ngcontent-%COMP%]{box-shadow:none!important}button[_ngcontent-%COMP%]{display:none!important}}"]});let e=n;return e})();var Z2=(()=>{let n=class n{constructor(){this.lastUpdated="December 2024"}navigateBack(){window.history.back()}};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=Ve({type:n,selectors:[["app-terms-conditions"]],decls:224,vars:2,consts:[[1,"min-h-screen","bg-gray-50"],[1,"bg-white","shadow-sm","border-b"],[1,"container","mx-auto","px-4","py-4"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"p-2","rounded-lg","hover:bg-gray-100","transition-colors","duration-200",3,"click"],[1,"w-8","h-8","rounded-lg","flex","items-center","justify-center","bg-gradient-to-r","from-primary","to-primary-600"],["src","assets/icon/app-icon/icon-192x192.png","alt","Money Manager",1,"w-6","h-6"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"container","mx-auto","px-4","py-8","overflow-y-auto","h-screen"],[1,"max-w-4xl","mx-auto","bg-white","rounded-xl","shadow-sm","p-8"],[1,"mb-8"],[1,"text-2xl","font-bold","text-gray-900","mb-4"],[1,"text-gray-700","leading-relaxed","mb-4"],[1,"text-gray-700","leading-relaxed"],[1,"list-disc","list-inside","text-gray-700","mb-4","space-y-2"],[1,"text-lg","font-semibold","text-gray-800","mb-3"],[1,"bg-gray-50","rounded-lg","p-4"],[1,"space-y-2","text-gray-700"],[1,"border-t","pt-6","mt-8"],[1,"text-sm","text-gray-500","text-center"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),N("click",function(){return a.navigateBack()}),c(6,"mat-icon"),d(7,"arrow_back"),l()(),c(8,"div",4)(9,"div",6),se(10,"img",7),l(),c(11,"h1",8),d(12,"Terms & Conditions"),l()()(),c(13,"div",9),d(14),l()()()(),c(15,"div",10)(16,"div",11)(17,"section",12)(18,"h2",13),d(19,"Introduction"),l(),c(20,"p",14),d(21,' Welcome to Money Manager. These Terms and Conditions ("Terms") govern your use of our money management application and services. By accessing or using our application, you agree to be bound by these Terms. '),l(),c(22,"p",15),d(23," If you do not agree with any part of these Terms, you may not access or use our application. "),l()(),c(24,"section",12)(25,"h2",13),d(26,"Acceptance of Terms"),l(),c(27,"p",14),d(28," By creating an account, downloading, installing, or using the Money Manager application, you acknowledge that you have read, understood, and agree to be bound by these Terms and Conditions. "),l(),c(29,"p",15),d(30," These Terms constitute a legally binding agreement between you and Money Manager regarding your use of our services. "),l()(),c(31,"section",12)(32,"h2",13),d(33,"Description of Service"),l(),c(34,"p",14),d(35," Money Manager is a personal finance management application that allows users to: "),l(),c(36,"ul",16)(37,"li"),d(38,"Track income and expenses"),l(),c(39,"li"),d(40,"Manage multiple accounts and budgets"),l(),c(41,"li"),d(42,"Set financial goals and monitor progress"),l(),c(43,"li"),d(44,"Generate financial reports and insights"),l(),c(45,"li"),d(46,"Categorize transactions"),l(),c(47,"li"),d(48,"Import and export financial data"),l()(),c(49,"p",15),d(50," We reserve the right to modify, suspend, or discontinue any part of our service at any time with reasonable notice. "),l()(),c(51,"section",12)(52,"h2",13),d(53,"User Accounts"),l(),c(54,"h3",17),d(55,"Account Creation"),l(),c(56,"p",14),d(57," To use our services, you must create an account by providing accurate, current, and complete information. You are responsible for maintaining the confidentiality of your account credentials. "),l(),c(58,"h3",17),d(59,"Account Responsibilities"),l(),c(60,"ul",16)(61,"li"),d(62,"You are responsible for all activities that occur under your account"),l(),c(63,"li"),d(64,"You must notify us immediately of any unauthorized use of your account"),l(),c(65,"li"),d(66,"You must be at least 18 years old to create an account"),l(),c(67,"li"),d(68,"You may not share your account credentials with others"),l(),c(69,"li"),d(70,"You are responsible for maintaining the security of your device"),l()()(),c(71,"section",12)(72,"h2",13),d(73,"Acceptable Use"),l(),c(74,"p",14),d(75," You agree to use our application only for lawful purposes and in accordance with these Terms. You agree not to: "),l(),c(76,"ul",16)(77,"li"),d(78,"Use the service for any illegal or unauthorized purpose"),l(),c(79,"li"),d(80,"Attempt to gain unauthorized access to our systems or other users' accounts"),l(),c(81,"li"),d(82,"Interfere with or disrupt the service or servers"),l(),c(83,"li"),d(84,"Upload or transmit viruses, malware, or other harmful code"),l(),c(85,"li"),d(86,"Violate any applicable laws or regulations"),l(),c(87,"li"),d(88,"Use the service to store or transmit illegal content"),l(),c(89,"li"),d(90,"Reverse engineer, decompile, or disassemble the application"),l()()(),c(91,"section",12)(92,"h2",13),d(93,"Financial Information"),l(),c(94,"h3",17),d(95,"Data Accuracy"),l(),c(96,"p",14),d(97," You are responsible for the accuracy and completeness of all financial information you enter into the application. We are not responsible for any errors, omissions, or inaccuracies in your financial data. "),l(),c(98,"h3",17),d(99,"No Financial Advice"),l(),c(100,"p",14),d(101," Money Manager is a financial tracking tool and does not provide financial advice, investment recommendations, or tax advice. You should consult with qualified professionals for financial, investment, or tax advice. "),l(),c(102,"h3",17),d(103,"Third-Party Services"),l(),c(104,"p",15),d(105," Our application may integrate with third-party financial institutions or services. We are not responsible for the accuracy, availability, or security of these third-party services. "),l()(),c(106,"section",12)(107,"h2",13),d(108,"Privacy and Data Protection"),l(),c(109,"p",14),d(110," Your privacy is important to us. Our collection and use of your personal information is governed by our Privacy Policy, which is incorporated into these Terms by reference. "),l(),c(111,"p",15),d(112," By using our service, you consent to the collection and use of your information as described in our Privacy Policy. "),l()(),c(113,"section",12)(114,"h2",13),d(115,"Subscription and Payment"),l(),c(116,"h3",17),d(117,"Free and Premium Plans"),l(),c(118,"p",14),d(119," We offer both free and premium subscription plans. Premium features require a paid subscription. Subscription fees are billed in advance and are non-refundable except as required by law. "),l(),c(120,"h3",17),d(121,"Payment Terms"),l(),c(122,"ul",16)(123,"li"),d(124,"All fees are exclusive of applicable taxes"),l(),c(125,"li"),d(126,"Subscriptions automatically renew unless cancelled"),l(),c(127,"li"),d(128,"You may cancel your subscription at any time"),l(),c(129,"li"),d(130,"No refunds for partial months or unused periods"),l(),c(131,"li"),d(132,"We may change subscription fees with 30 days' notice"),l()()(),c(133,"section",12)(134,"h2",13),d(135,"Intellectual Property"),l(),c(136,"p",14),d(137," The Money Manager application, including its content, features, and functionality, is owned by us and is protected by copyright, trademark, and other intellectual property laws. "),l(),c(138,"p",14),d(139," You may not copy, modify, distribute, sell, or lease any part of our application without our written permission. "),l(),c(140,"p",15),d(141," You retain ownership of your financial data and content, but grant us a license to use it to provide our services. "),l()(),c(142,"section",12)(143,"h2",13),d(144,"Limitation of Liability"),l(),c(145,"p",14),d(146," To the maximum extent permitted by law, Money Manager shall not be liable for any indirect, incidental, special, consequential, or punitive damages, including but not limited to: "),l(),c(147,"ul",16)(148,"li"),d(149,"Loss of profits, data, or use"),l(),c(150,"li"),d(151,"Business interruption"),l(),c(152,"li"),d(153,"Financial losses"),l(),c(154,"li"),d(155,"Security breaches"),l(),c(156,"li"),d(157,"Service interruptions"),l()(),c(158,"p",15),d(159," Our total liability shall not exceed the amount you paid for our services in the 12 months preceding the claim. "),l()(),c(160,"section",12)(161,"h2",13),d(162,"Disclaimers"),l(),c(163,"p",14),d(164,' THE SERVICE IS PROVIDED "AS IS" AND "AS AVAILABLE" WITHOUT WARRANTIES OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO: '),l(),c(165,"ul",16)(166,"li"),d(167,"Warranties of merchantability or fitness for a particular purpose"),l(),c(168,"li"),d(169,"Warranties that the service will be uninterrupted or error-free"),l(),c(170,"li"),d(171,"Warranties regarding the accuracy or reliability of financial data"),l(),c(172,"li"),d(173,"Warranties that defects will be corrected"),l()()(),c(174,"section",12)(175,"h2",13),d(176,"Termination"),l(),c(177,"p",14),d(178," We may terminate or suspend your account and access to our services at any time, with or without cause, with or without notice. "),l(),c(179,"p",14),d(180," Upon termination, your right to use the service will cease immediately. We may delete your account and data, though we will provide reasonable notice before permanent deletion. "),l(),c(181,"p",15),d(182," You may terminate your account at any time by contacting us or using the account deletion feature in the application. "),l()(),c(183,"section",12)(184,"h2",13),d(185,"Governing Law"),l(),c(186,"p",15),d(187," These Terms shall be governed by and construed in accordance with the laws of India. Any disputes arising from these Terms or your use of our service shall be resolved in the courts of Goa, India. "),l()(),c(188,"section",12)(189,"h2",13),d(190,"Changes to These Terms"),l(),c(191,"p",14),d(192," We reserve the right to modify these Terms at any time. We will notify you of any changes by: "),l(),c(193,"ul",16)(194,"li"),d(195,"Posting the updated Terms in the application"),l(),c(196,"li"),d(197,"Sending you an email notification"),l(),c(198,"li"),d(199,"Displaying a notice when you next access the service"),l()(),c(200,"p",15),d(201," Your continued use of the service after any changes constitutes acceptance of the updated Terms. "),l()(),c(202,"section",12)(203,"h2",13),d(204,"Contact Us"),l(),c(205,"p",14),d(206," If you have any questions about these Terms and Conditions, please contact us: "),l(),c(207,"div",18)(208,"div",19)(209,"p")(210,"strong"),d(211,"Email:"),l(),d(212," Prashiln79@gmail.com"),l(),c(213,"p")(214,"strong"),d(215,"Address:"),l(),d(216," Goa, India"),l(),c(217,"p")(218,"strong"),d(219,"Response Time:"),l(),d(220," We aim to respond to all inquiries within 48 hours."),l()()()(),c(221,"div",20)(222,"p",21),d(223),l()()()()()),r&2&&(p(14),oe(" Last updated: ",a.lastUpdated," "),p(209),oe(" These Terms and Conditions are effective as of ",a.lastUpdated," and will remain in effect except with respect to any changes in its provisions in the future. "))},dependencies:[at],styles:["[_nghost-%COMP%]{display:block;height:100vh;overflow-y:auto}[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.dark[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#374151}.dark[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#6b7280}.dark[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.max-w-4xl[_ngcontent-%COMP%]{margin-left:.5rem;margin-right:.5rem}}"]});let e=n;return e})();var J2=(()=>{let n=class n{constructor(t,r){this.commonSyncService=t,this.ssrService=r}retryConnection(){this.commonSyncService.isCurrentlyOnline()?this.ssrService.isClientSide()&&(window.location.href="/dashboard"):alert("Still offline. Please check your internet connection.")}openOfflineData(){this.ssrService.isClientSide()&&(window.location.href="/dashboard")}};n.\u0275fac=function(r){return new(r||n)(q(Rr),q(Pr))},n.\u0275cmp=Ve({type:n,selectors:[["app-offline-page"]],decls:37,vars:0,consts:[[1,"min-h-screen","bg-gray-50","flex","items-center","justify-center","px-4"],[1,"max-w-md","w-full","text-center"],[1,"mb-8"],[1,"mx-auto","w-24","h-24","bg-yellow-100","rounded-full","flex","items-center","justify-center"],[1,"text-4xl","text-yellow-600"],[1,"text-2xl","font-bold","text-gray-900","mb-4"],[1,"text-gray-600","mb-8"],[1,"bg-white","rounded-lg","p-4","mb-6","shadow-sm","border"],[1,"flex","items-center","justify-between"],[1,"text-sm","text-gray-600"],[1,"text-sm","font-medium","text-yellow-600"],[1,"space-y-3"],["mat-raised-button","","color","primary",1,"w-full",3,"click"],[1,"mr-2"],["mat-stroked-button","",1,"w-full",3,"click"],[1,"mt-8","p-4","bg-blue-50","rounded-lg"],[1,"text-sm","font-medium","text-blue-900","mb-2"],[1,"text-xs","text-blue-800","space-y-1"]],template:function(r,a){r&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-icon",4),d(5,"wifi_off"),l()()(),c(6,"h1",5),d(7," You're Offline "),l(),c(8,"p",6),d(9," It looks like you don't have an internet connection right now. Don't worry - your data is saved locally and will sync when you're back online. "),l(),c(10,"div",7)(11,"div",8)(12,"span",9),d(13,"Connection Status:"),l(),c(14,"span",10),d(15,"Offline"),l()()(),c(16,"div",11)(17,"button",12),N("click",function(){return a.retryConnection()}),c(18,"mat-icon",13),d(19,"refresh"),l(),d(20," Try Again "),l(),c(21,"button",14),N("click",function(){return a.openOfflineData()}),c(22,"mat-icon",13),d(23,"storage"),l(),d(24," View Offline Data "),l()(),c(25,"div",15)(26,"h3",16),d(27,"Offline Tips:"),l(),c(28,"ul",17)(29,"li"),d(30,"\u2022 Your transactions are saved locally"),l(),c(31,"li"),d(32,"\u2022 Changes will sync when connection is restored"),l(),c(33,"li"),d(34,"\u2022 Check your internet connection"),l(),c(35,"li"),d(36,"\u2022 Try refreshing the page"),l()()()()())},dependencies:[Ht,at],styles:["[_nghost-%COMP%]{display:block}"]});let e=n;return e})();var Sj=[{path:"shell",component:X2},{path:"landing",component:Kb},{path:"privacy-policy",component:K2},{path:"terms-conditions",component:Z2},{path:"offline",component:J2},{path:"sign-in",component:ug},{path:"sign-up",component:ug},{path:"register",component:ex},{path:"dashboard",component:v_,canActivate:[sg],data:{requireEmailVerification:!0,requireActiveSession:!0},children:[{path:"",component:Jf},{path:"home",component:Jf},{path:"accounts",component:Oc,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"category",component:Ec,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"reports",component:um,data:{roles:["premium","admin"],requireEmailVerification:!0}},{path:"transactions",component:fm,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"tax",component:mm,data:{roles:["premium","admin"],requireEmailVerification:!0}},{path:"subscription",component:Jb,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"goals",component:t2,data:{roles:["premium","admin"],requireEmailVerification:!0}},{path:"splitwise",loadChildren:()=>import("./chunk-IXZCXVE4.js").then(e=>e.SplitwiseModule),data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"google-sheets",component:i2,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"budgets",component:s2,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"notes",component:gm,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"import",component:Xc,data:{roles:["premium","admin"],requireEmailVerification:!0}},{path:"profile",component:l2,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"notifications",component:H2,data:{roles:["free","premium","admin"],requireEmailVerification:!0}},{path:"feedback",component:q2,data:{roles:["free","premium","admin"],requireEmailVerification:!0}}]},{path:"admin",loadChildren:()=>import("./chunk-4UMF6GCF.js").then(e=>e.AdminModule),canActivate:[sg,wx],data:{requireEmailVerification:!0,requireActiveSession:!0,roles:["admin"]}},{path:"",redirectTo:"/dashboard",pathMatch:"full"}],Q2=(()=>{let n=class n{};n.\u0275fac=function(r){return new(r||n)},n.\u0275mod=Cr({type:n}),n.\u0275inj=_r({imports:[ul.forRoot(Sj,{useHash:!0}),ul]});let e=n;return e})();var Mm=(()=>{let n=class n{constructor(t,r,a,o,s){this.location=t,this.router=r,this.platform=a,this.ngZone=o,this.platformId=s,this.navigationStateSubject=new mn({canGoBack:!1,currentRoute:"",previousRoute:"",navigationStack:[],isStandalone:!1,isMobile:!1}),this.destroy$=new vn,this.navigationStack=[],this.maxStackSize=50,this.navigationState$=this.navigationStateSubject.asObservable(),this.canGoBack$=this.navigationState$.pipe(Xi(u=>u.canGoBack),rt(u=>u.canGoBack)),fo(this.platformId)||this.initializePwaNavigation()}initializePwaNavigation(){let t=this.isStandalonePwa(),r=this.isMobileDevice();this.navigationStack=[],this.router.events.pipe(Xi(o=>o instanceof B0),Qt(this.destroy$)).subscribe(o=>{this.ngZone.run(()=>{this.handleNavigationEnd(o)})}),this.router.events.pipe(Xi(o=>o instanceof i1),Qt(this.destroy$)).subscribe(o=>{this.ngZone.run(()=>{this.handleNavigationStart(o)})});let a=()=>{this.ngZone.run(()=>{this.handlePopState()})};typeof window<"u"&&(window.addEventListener("popstate",a),this.destroy$.subscribe(()=>{window.removeEventListener("popstate",a)})),r&&this.setupHardwareBackButton(),this.setupKeyboardNavigation(),this.updateNavigationState({isStandalone:t,isMobile:r,currentRoute:this.router.url})}isStandalonePwa(){return fo(this.platformId)?!1:window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}isMobileDevice(){return fo(this.platformId)?!1:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}handleNavigationStart(t){t.url!==this.navigationStateSubject.value.currentRoute&&this.addToNavigationStack(this.navigationStateSubject.value.currentRoute)}handleNavigationEnd(t){let a=this.navigationStateSubject.value.currentRoute;this.updateNavigationState({currentRoute:t.url,previousRoute:a,canGoBack:this.navigationStack.length>0||this.canNavigateBack()})}handlePopState(){let t=this.router.url,r=this.navigationStateSubject.value;t!==r.currentRoute&&this.updateNavigationState({currentRoute:t,previousRoute:r.currentRoute,canGoBack:this.navigationStack.length>0||this.canNavigateBack()})}setupHardwareBackButton(){if(this.platform.ANDROID){let t=r=>{r.preventDefault(),this.ngZone.run(()=>{this.handleHardwareBackButton()})};document.addEventListener("backbutton",t,!1),this.destroy$.subscribe(()=>{document.removeEventListener("backbutton",t)})}this.platform.IOS&&this.setupIosBackGesture()}setupIosBackGesture(){let t=0,r=0,a=50,o=u=>{t=u.touches[0].clientX,r=u.touches[0].clientY},s=u=>{let m=u.changedTouches[0].clientX,f=u.changedTouches[0].clientY,h=t-m,_=Math.abs(r-f);h>a&&_<a&&t<50&&this.ngZone.run(()=>{this.handleHardwareBackButton()})};document.addEventListener("touchstart",o,{passive:!0}),document.addEventListener("touchend",s,{passive:!0}),this.destroy$.subscribe(()=>{document.removeEventListener("touchstart",o),document.removeEventListener("touchend",s)})}setupKeyboardNavigation(){let t=r=>{r.altKey&&r.key==="ArrowLeft"&&(r.preventDefault(),this.ngZone.run(()=>{this.goBack()})),r.key==="Escape"&&this.ngZone.run(()=>{this.handleEscapeKey()})};document.addEventListener("keydown",t),this.destroy$.subscribe(()=>{document.removeEventListener("keydown",t)})}handleHardwareBackButton(){let t=this.navigationStateSubject.value;if(this.isInModal()){this.closeModal();return}t.canGoBack?this.goBack():this.showExitConfirmation()}handleEscapeKey(){this.isInModal()&&this.closeModal()}isInModal(){return document.querySelectorAll('.modal, .dialog, [role="dialog"]').length>0}closeModal(){let t=document.querySelectorAll('.modal, .dialog, [role="dialog"]');if(t.length>0){let a=t[t.length-1].querySelector('[data-dismiss="modal"], .close, .modal-close');a&&a.click()}}showExitConfirmation(){this.navigationStateSubject.value.isStandalone&&confirm("Do you want to exit the app?")&&this.exitApp()}exitApp(){this.navigationStateSubject.value.isStandalone&&window.close()}addToNavigationStack(t){t&&t!=="/"&&(this.navigationStack.push(t),this.navigationStack.length>this.maxStackSize&&this.navigationStack.shift())}canNavigateBack(){return this.navigationStack.length>0||window.history.length>1}goBack(){let t=this.navigationStateSubject.value;if(this.navigationStack.length>0){let r=this.navigationStack.pop();if(r){this.router.navigateByUrl(r);return}}window.history.length>1?this.location.back():this.router.navigate(["/dashboard"])}goForward(){this.location.forward()}navigateTo(t){this.router.navigateByUrl(t)}clearNavigationStack(){this.navigationStack=[],this.updateNavigationState({canGoBack:!1,navigationStack:[]})}getNavigationStack(){return[...this.navigationStack]}isStandaloneMode(){return this.navigationStateSubject.value.isStandalone}isMobileMode(){return this.navigationStateSubject.value.isMobile}updateNavigationState(t){let r=this.navigationStateSubject.value,a=ae(ae({},r),t);t.navigationStack&&(this.navigationStack=t.navigationStack),this.navigationStateSubject.next(a)}destroy(){this.destroy$.next(),this.destroy$.complete(),this.navigationStack=[],this.navigationStateSubject.next({canGoBack:!1,currentRoute:"",previousRoute:"",navigationStack:[],isStandalone:!1,isMobile:!1})}};n.\u0275fac=function(r){return new(r||n)(De(F0),De(Kt),De(X1),De(vr),De(O0))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();function Pj(e,n){e&1&&(c(0,"div",1)(1,"div",2),se(2,"div",3),c(3,"span",4),d(4,"Offline"),l()()()),e&2&&w("@slideDown",void 0)}function Oj(e,n){e&1&&(c(0,"div",1)(1,"div",5),se(2,"div",6),c(3,"span",7),d(4,"Connected"),l()()()),e&2&&w("@slideDown",void 0)}var ey=(()=>{let n=class n{constructor(t,r){this.commonSyncService=t,this.notificationService=r,this.isOnline=!0,this.showOnlineBanner=!1,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.commonSyncService.networkStatus$.subscribe(t=>{let r=this.isOnline;this.isOnline=t.online,this.isOnline||console.log("You are offline. Please check your internet connection."),!r&&this.isOnline&&(this.showOnlineBanner=!0,console.log("Connection restored. Syncing data..."),setTimeout(()=>{this.showOnlineBanner=!1},Dt.NOTIFICATIONS.AUTO_HIDE_DELAY))}))}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}dismissOfflineBanner(){}dismissOnlineBanner(){this.showOnlineBanner=!1}};n.\u0275fac=function(r){return new(r||n)(q(Rr),q(ht))},n.\u0275cmp=Ve({type:n,selectors:[["app-offline-indicator"]],decls:2,vars:2,consts:[["class","fixed top-3 left-12 z-50",4,"ngIf"],[1,"fixed","top-3","left-12","z-50"],[1,"flex","items-center","space-x-2","bg-gray-800","bg-opacity-50","rounded-full","px-3","py-1","shadow-lg"],[1,"w-2","h-2","bg-red-500","rounded-full"],[1,"text-white","text-xm","font-medium"],[1,"flex","items-center","space-x-2","bg-green-500","bg-opacity-90","rounded-full","px-3","py-1","shadow-lg"],[1,"w-2","h-2","bg-white","rounded-full"],[1,"text-white","text-sm","font-medium"]],template:function(r,a){r&1&&X(0,Pj,5,1,"div",0)(1,Oj,5,1,"div",0),r&2&&(w("ngIf",!a.isOnline),p(),w("ngIf",a.showOnlineBanner))},dependencies:[ct],styles:["[_nghost-%COMP%]{display:block}.offline-banner[_ngcontent-%COMP%]{transition:all .3s ease}.offline-banner[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026}.online-banner[_ngcontent-%COMP%]{transition:all .3s ease}.online-banner[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026}.connection-indicator[_ngcontent-%COMP%]{transition:all .2s ease}.connection-indicator[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.close-button[_ngcontent-%COMP%]{transition:all .2s ease}.close-button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}"],data:{animation:[wd("slideDown",[uc("void",dc({transform:"translateY(-100%)",opacity:0})),uc("*",dc({transform:"translateY(0)",opacity:1})),mc("void => *",[lc("0.3s ease-out")]),mc("* => void",[lc("0.2s ease-in")])])]}});let e=n;return e})();var ty=(()=>{let n=class n{constructor(t){this.swUpdate=t,this.updateInfoSubject=new mn({available:!1,currentVersion:"",newVersion:"",updateReady:!1}),this.updateInfo$=this.updateInfoSubject.asObservable(),this.initializeServiceWorker()}initializeServiceWorker(){if(this.swUpdate.isEnabled){this.checkForUpdates(),this.swUpdate.versionUpdates.pipe(Xi(r=>r.type==="VERSION_READY")).subscribe(r=>{console.log("New version ready:",r),this.handleVersionReady(r)}),this.swUpdate.unrecoverable.subscribe(r=>{console.error("Unrecoverable service worker error:",r),this.handleUnrecoverableError(r)});let t=Dt.PWA.UPDATE_CHECK_INTERVAL;setInterval(()=>{this.checkForUpdates()},t),document.addEventListener("visibilitychange",()=>{document.hidden||this.checkForUpdates()})}}checkForUpdates(){this.swUpdate.checkForUpdate().then(()=>{console.log("Service worker update check completed")}).catch(t=>{console.error("Service worker update check failed:",t)})}handleVersionReady(t){let r={available:!0,currentVersion:this.getVersionFromAppData(t.currentVersion.appData)||"unknown",newVersion:this.getVersionFromAppData(t.latestVersion.appData)||"unknown",updateReady:!0};this.updateInfoSubject.next(r),this.activateUpdateSilently()}getVersionFromAppData(t){if(t&&typeof t=="object")return t.version||t.version}handleUnrecoverableError(t){window.location.reload()}activateUpdateSilently(){return this.swUpdate.activateUpdate().then(()=>(console.log("Service worker update activated silently"),this.updateInfoSubject.next({available:!1,currentVersion:"",newVersion:"",updateReady:!1}),window.location.reload(),!0)).catch(t=>(console.error("Failed to activate service worker update:",t),!1))}activateUpdate(){return this.activateUpdateSilently()}checkForUpdate(){return this.swUpdate.checkForUpdate().then(t=>(console.log(t?"Update available":"No update available"),t)).catch(t=>(console.error("Update check failed:",t),!1))}getCurrentVersion(){return this.updateInfoSubject.value.currentVersion}isUpdateAvailable(){return this.updateInfoSubject.value.available}isUpdateReady(){return this.updateInfoSubject.value.updateReady}handleNavigationEvent(t){t&&t.type==="NAVIGATION"&&console.log("Navigation event received:",t)}registerCustomHandlers(){"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",t=>{if(t.data&&t.data.type)switch(t.data.type){case"NAVIGATION":this.handleNavigationEvent(t.data);break;case"CACHE_UPDATED":console.log("Cache updated:",t.data);break;case"OFFLINE_MODE":console.log("Offline mode activated");break;default:console.log("Unknown service worker message:",t.data)}})}sendMessageToSw(t){"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage(t)}handleInstallPrompt(){console.log("App ready for installation")}isAppInstalled(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}handleVisibilityChange(){document.hidden?(console.log("App went to background"),this.saveAppState()):(console.log("App came to foreground"),this.checkForUpdates())}saveAppState(){let t={timestamp:Date.now(),url:window.location.href,scrollPosition:window.scrollY};try{localStorage.setItem("app-background-state",JSON.stringify(t))}catch(r){console.warn("Failed to save app state:",r)}}};n.\u0275fac=function(r){return new(r||n)(De(ux))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();function Tj(e,n){if(e&1){let i=be();c(0,"div",1)(1,"div",2)(2,"div",3),yi(),c(3,"svg",4),se(4,"path",5)(5,"path",6)(6,"path",7),l()(),Yr(),c(7,"div",8)(8,"h3"),d(9),l(),c(10,"p"),d(11,"Add to your home screen for quick access and offline functionality"),l()(),c(12,"div",9)(13,"button",10),N("click",function(){G(i);let r=S();return H(r.installApp())}),d(14," Install App "),l(),c(15,"button",11),N("click",function(){G(i);let r=S();return H(r.dismissPrompt())}),d(16," Not Now "),l()(),c(17,"button",12),N("click",function(){G(i);let r=S();return H(r.dismissPrompt())}),yi(),c(18,"svg",13),se(19,"path",14),l()()()()}if(e&2){let i=S();p(9),oe("Install ",i.APP_CONFIG.APP_NAME,""),p(8),ga("aria-label","Close install prompt")}}var ny=(()=>{let n=class n{constructor(t,r){this.pwaSwService=t,this.ssrService=r,this.installClicked=new $n,this.dismissClicked=new $n,this.APP_CONFIG=Dt,this.showInstallPrompt=!1,this.destroy$=new vn}ngOnInit(){this.setupInstallPrompt()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setupInstallPrompt(){this.ssrService.isClientSide()&&(window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),this.deferredPrompt=t;let r=localStorage.getItem("pwa-install-dismissed"),a=localStorage.getItem("pwa-install-dismissed-time"),o=!0;if(r&&a){let s=Date.now(),u=parseInt(a,10);o=(s-u)/(1e3*60*60*24)>=Dt.install_prompt_dismissed_days}o&&!this.pwaSwService.isAppInstalled()?(this.showInstallPrompt=!0,console.log("Install prompt ready and showing")):console.log("Install prompt ready but not showing (either dismissed or already installed)")}),window.addEventListener("appinstalled",()=>{this.showInstallPrompt=!1,this.deferredPrompt=null,console.log("App installed successfully")}),this.pwaSwService.isAppInstalled()&&(this.showInstallPrompt=!1))}installApp(){return ue(this,null,function*(){if(this.deferredPrompt){this.installClicked.emit(),this.deferredPrompt.prompt();let{outcome:t}=yield this.deferredPrompt.userChoice;t==="accepted"?(console.log("User accepted the install prompt"),this.showInstallPrompt=!1):(console.log("User dismissed the install prompt"),this.dismissPrompt()),this.deferredPrompt=null}})}dismissPrompt(){this.dismissClicked.emit(),this.showInstallPrompt=!1,localStorage.setItem("pwa-install-dismissed","true"),localStorage.setItem("pwa-install-dismissed-time",Date.now().toString())}};n.\u0275fac=function(r){return new(r||n)(q(ty),q(Pr))},n.\u0275cmp=Ve({type:n,selectors:[["app-pwa-install-prompt"]],outputs:{installClicked:"installClicked",dismissClicked:"dismissClicked"},decls:1,vars:1,consts:[["class","pwa-install-prompt",4,"ngIf"],[1,"pwa-install-prompt"],[1,"install-content"],[1,"install-icon"],["width","48","height","48","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M12 2L2 7L12 12L22 7L12 2Z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M2 17L12 22L22 17","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M2 12L12 17L22 12","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"install-text"],[1,"install-actions"],["type","button",1,"install-btn","primary",3,"click"],["type","button",1,"install-btn","secondary",3,"click"],["type","button",1,"close-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M18 6L6 18M6 6L18 18","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"]],template:function(r,a){r&1&&X(0,Tj,20,2,"div",0),r&2&&w("ngIf",a.showInstallPrompt)},dependencies:[ct],styles:[".pwa-install-prompt[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:20px;right:20px;z-index:1000;animation:_ngcontent-%COMP%_slideUp .3s ease-out}.install-content[_ngcontent-%COMP%]{background:var(--surface-color, #ffffff);border:1px solid var(--border-color, #e2e8f0);border-radius:16px;padding:20px;box-shadow:0 10px 25px #0000001a;position:relative;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.install-icon[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:16px;color:var(--primary-color, #3b82f6)}.install-text[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.install-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:var(--text-color, #1e293b);margin:0 0 8px}.install-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted, #64748b);margin:0;line-height:1.5}.install-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.install-btn[_ngcontent-%COMP%]{padding:12px 24px;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;min-width:100px}.install-btn.primary[_ngcontent-%COMP%]{background:var(--primary-color, #3b82f6);color:#fff}.install-btn.primary[_ngcontent-%COMP%]:hover{background:var(--primary-color-dark, #2563eb);transform:translateY(-1px)}.install-btn.secondary[_ngcontent-%COMP%]{background:var(--surface-color, #f8fafc);color:var(--text-color, #1e293b);border:1px solid var(--border-color, #e2e8f0)}.install-btn.secondary[_ngcontent-%COMP%]:hover{background:var(--surface-hover-color, #f1f5f9)}.close-btn[_ngcontent-%COMP%]{position:absolute;top:12px;right:12px;width:32px;height:32px;border:none;border-radius:50%;background:var(--surface-color, #f8fafc);color:var(--text-muted, #64748b);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.close-btn[_ngcontent-%COMP%]:hover{background:var(--surface-hover-color, #f1f5f9);color:var(--text-color, #1e293b)}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(100%);opacity:0}to{transform:translateY(0);opacity:1}}@media (max-width: 768px){.pwa-install-prompt[_ngcontent-%COMP%]{bottom:16px;left:16px;right:16px}.install-content[_ngcontent-%COMP%]{padding:16px}.install-actions[_ngcontent-%COMP%]{flex-direction:column}.install-btn[_ngcontent-%COMP%]{width:100%}}@media (max-width: 480px){.pwa-install-prompt[_ngcontent-%COMP%]{bottom:12px;left:12px;right:12px}.install-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px}.install-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}}@media (prefers-color-scheme: dark){.install-content[_ngcontent-%COMP%]{background:#0f172af2;border-color:#334155}.install-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#f1f5f9}.install-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#94a3b8}.install-btn.secondary[_ngcontent-%COMP%]{background:#1e293b;color:#f1f5f9;border-color:#334155}.install-btn.secondary[_ngcontent-%COMP%]:hover{background:#334155}.close-btn[_ngcontent-%COMP%]{background:#1e293b;color:#94a3b8}.close-btn[_ngcontent-%COMP%]:hover{background:#334155;color:#f1f5f9}}"]});let e=n;return e})();var iy=(()=>{let n=class n{constructor(t,r,a,o,s,u){this.location=t,this.loaderService=r,this.pwaNavigationService=a,this.commonSyncService=o,this.ssrService=s,this.firebaseMessagingService=u,this.title=Dt.APP_NAME,this.isOnline=!1,this.destroy$=new vn,this.navigationState={canGoBack:!1,currentRoute:"",previousRoute:"",navigationStack:[],isStandalone:!1,isMobile:!1}}ngOnInit(){this.ssrService.isClientSide()&&(this.isOnline=navigator.onLine),this.initializePwaFeatures(),this.setupEventListeners(),this.firebaseMessagingService.listenForMessages()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.pwaNavigationService.destroy()}initializePwaFeatures(){this.pwaNavigationService.navigationState$.pipe(Qt(this.destroy$)).subscribe(t=>{this.navigationState=t}),this.commonSyncService.isOnline$.pipe(Qt(this.destroy$)).subscribe(t=>{this.isOnline=t})}setupEventListeners(){this.ssrService.isClientSide()&&(window.addEventListener("online",()=>this.isOnline=!0),window.addEventListener("offline",()=>this.isOnline=!1),window.addEventListener("beforeunload",t=>{this.navigationState.isStandalone&&this.saveAppState()}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this.handleAppBackground():document.visibilityState==="visible"&&this.handleAppForeground()}))}saveAppState(){let t={currentRoute:this.navigationState.currentRoute,navigationStack:this.navigationState.navigationStack,timestamp:Date.now()};try{localStorage.setItem("app-state",JSON.stringify(t))}catch(r){console.warn("Failed to save app state:",r)}}handleAppBackground(){this.saveAppState(),this.loaderService.hide()}handleAppForeground(){this.isOnline&&this.refreshDataIfNeeded()}refreshDataIfNeeded(){let t=localStorage.getItem("last-data-refresh"),r=Date.now(),a=Dt.OFFLINE.SYNC_INTERVAL;(!t||r-parseInt(t)>a)&&localStorage.setItem("last-data-refresh",r.toString())}goBack(){this.pwaNavigationService.goBack()}goForward(){this.pwaNavigationService.goForward()}handlePwaAction(t){if(this.ssrService.isClientSide())switch(t){case"back":this.goBack();break;case"forward":this.goForward();break;case"home":this.pwaNavigationService.navigateTo("/dashboard");break;case"refresh":window.location.reload();break;default:console.warn("Unknown PWA action:",t)}}onInstallClicked(){console.log("PWA install clicked")}onDismissClicked(){console.log("PWA install dismissed")}};n.\u0275fac=function(r){return new(r||n)(q(F0),q(fc),q(Mm),q(Rr),q(Pr),q(ym))},n.\u0275cmp=Ve({type:n,selectors:[["app-root"]],decls:5,vars:0,consts:[[3,"installClicked","dismissClicked"]],template:function(r,a){r&1&&(se(0,"app-offline-indicator"),c(1,"app-pwa-install-prompt",0),N("installClicked",function(){return a.onInstallClicked()})("dismissClicked",function(){return a.onDismissClicked()}),l(),c(2,"div"),se(3,"app-loader")(4,"router-outlet"),l())},dependencies:[L0,$x,ey,ny],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.content[_ngcontent-%COMP%]{padding:16px}.offline-banner[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;background:red;color:#fff;text-align:center;padding:5px}"]});let e=n;return e})();var Aj="@",Dj=(()=>{let n=class n{constructor(t,r,a,o,s){this.doc=t,this.delegate=r,this.zone=a,this.animationType=o,this.moduleImpl=s,this._rendererFactoryPromise=null,this.scheduler=Wr(Yh,{optional:!0})}ngOnDestroy(){var t;(t=this._engine)==null||t.flush()}loadImpl(){var r;return((r=this.moduleImpl)!=null?r:import("./chunk-F4GVV6V5.js").then(a=>a)).catch(a=>{throw new Lh(5300,!1)}).then(({\u0275createEngine:a,\u0275AnimationRendererFactory:o})=>{this._engine=a(this.animationType,this.doc);let s=new o(this.delegate,this._engine,this.zone);return this.delegate=s,s})}createRenderer(t,r){var s,u;let a=this.delegate.createRenderer(t,r);if(a.\u0275type===0)return a;typeof a.throwOnSyntheticProps=="boolean"&&(a.throwOnSyntheticProps=!1);let o=new yp(a);return(s=r==null?void 0:r.data)!=null&&s.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),(u=this._rendererFactoryPromise)==null||u.then(m=>{var h;let f=m.createRenderer(t,r);o.use(f),(h=this.scheduler)==null||h.notify(9)}).catch(m=>{o.use(a)}),o}begin(){var t,r;(r=(t=this.delegate).begin)==null||r.call(t)}end(){var t,r;(r=(t=this.delegate).end)==null||r.call(t)}whenRenderingDone(){var t,r,a;return(a=(r=(t=this.delegate).whenRenderingDone)==null?void 0:r.call(t))!=null?a:Promise.resolve()}};n.\u0275fac=function(r){Wh()},n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})(),yp=class{constructor(n){this.delegate=n,this.replay=[],this.\u0275type=1}use(n){if(this.delegate=n,this.replay!==null){for(let i of this.replay)i(n);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(n,i){return this.delegate.createElement(n,i)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}get destroyNode(){return this.delegate.destroyNode}appendChild(n,i){this.delegate.appendChild(n,i)}insertBefore(n,i,t,r){this.delegate.insertBefore(n,i,t,r)}removeChild(n,i,t){this.delegate.removeChild(n,i,t)}selectRootElement(n,i){return this.delegate.selectRootElement(n,i)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,i,t,r){this.delegate.setAttribute(n,i,t,r)}removeAttribute(n,i,t){this.delegate.removeAttribute(n,i,t)}addClass(n,i){this.delegate.addClass(n,i)}removeClass(n,i){this.delegate.removeClass(n,i)}setStyle(n,i,t,r){this.delegate.setStyle(n,i,t,r)}removeStyle(n,i,t){this.delegate.removeStyle(n,i,t)}setProperty(n,i,t){this.shouldReplay(i)&&this.replay.push(r=>r.setProperty(n,i,t)),this.delegate.setProperty(n,i,t)}setValue(n,i){this.delegate.setValue(n,i)}listen(n,i,t){return this.shouldReplay(i)&&this.replay.push(r=>r.listen(n,i,t)),this.delegate.listen(n,i,t)}shouldReplay(n){return this.replay!==null&&n.startsWith(Aj)}};function ry(e="animations"){return Jm("NgAsyncAnimations"),zs([{provide:T0,useFactory:(n,i,t)=>new Dj(n,i,t,e),deps:[D0,R0,vr]},{provide:ll,useValue:e==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Fj=(()=>{let n=class n extends Vd{constructor(t,r,a){super(t,r,a)}ngOnDestroy(){this.flush()}};n.\u0275fac=function(r){return new(r||n)(De(D0),De(_l),De(Ld))},n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})();function Rj(){return new Xx}function Nj(e,n,i){return new Zx(e,n,i)}var oy=[{provide:Ld,useFactory:Rj},{provide:Vd,useClass:Fj},{provide:T0,useFactory:Nj,deps:[R0,Vd,vr]}],ay=[{provide:_l,useFactory:()=>new Kx},{provide:ll,useValue:"BrowserAnimations"},...oy],Bj=[{provide:_l,useClass:qx},{provide:ll,useValue:"NoopAnimations"},...oy],sy=(()=>{let n=class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?Bj:ay}}};n.\u0275fac=function(r){return new(r||n)},n.\u0275mod=Cr({type:n}),n.\u0275inj=_r({providers:ay,imports:[N0]});let e=n;return e})();var Lj=Tr(cy(),1),ly=(()=>{let n=class n{constructor(){this._papa=Lj}parse(t,r){return this._papa.parse(t,r)}unparse(t,r){return this._papa.unparse(t,r)}setLocalChunkSize(t){this._papa.LocalChunkSize=t}setRemoteChunkSize(t){this._papa.RemoteChunkSize=t}setDefaultDelimiter(t){this._papa.DefaultDelimiter=t}get badDelimiters(){return this._papa.BAD_DELIMITERS}get recordSeparator(){return this._papa.RECORD_SEP}get unitSeparator(){return this._papa.UNIT_SEP}get workersSupported(){return this._papa.WORKERS_SUPPORTED}};n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var dy=(()=>{let n=class n{constructor(t,r){this.matIconRegistry=t,this.domSanitizer=r,this.matIconRegistry.addSvgIconSet(this.domSanitizer.bypassSecurityTrustResourceUrl("assets/icon/system-uicons.svg")),this.matIconRegistry.addSvgIcon("test",this.domSanitizer.bypassSecurityTrustResourceUrl("assets/icon/test.svg")),this.matIconRegistry.addSvgIcon("add-txn",this.domSanitizer.bypassSecurityTrustResourceUrl("assets/icon/add-txn.svg"))}};n.\u0275fac=function(r){return new(r||n)(De(Q1),De(t1))},n.\u0275mod=Cr({type:n}),n.\u0275inj=_r({});let e=n;return e})();var d0="PERFORM_ACTION",zj="REFRESH",hy="RESET",xy="ROLLBACK",_y="COMMIT",Cy="SWEEP",vy="TOGGLE_ACTION",Wj="SET_ACTIONS_ACTIVE",by="JUMP_TO_STATE",yy="JUMP_TO_ACTION",Bp="IMPORT_STATE",My="LOCK_CHANGES",wy="PAUSE_RECORDING",Zc=class{constructor(n,i){if(this.action=n,this.timestamp=i,this.type=d0,typeof n.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?')}},Sp=class{constructor(){this.type=zj}},Pp=class{constructor(n){this.timestamp=n,this.type=hy}},Op=class{constructor(n){this.timestamp=n,this.type=xy}},kp=class{constructor(n){this.timestamp=n,this.type=_y}},Ep=class{constructor(){this.type=Cy}},Tp=class{constructor(n){this.id=n,this.type=vy}};var Ip=class{constructor(n){this.index=n,this.type=by}},Ap=class{constructor(n){this.actionId=n,this.type=yy}},Dp=class{constructor(n){this.nextLiftedState=n,this.type=Bp}},Fp=class{constructor(n){this.status=n,this.type=My}},Rp=class{constructor(n){this.status=n,this.type=wy}};var Om=new Xa("@ngrx/store-devtools Options"),uy=new Xa("@ngrx/store-devtools Initial Config");function Sy(){return null}var Yj="NgRx Store DevTools";function $j(e){let n={maxAge:!1,monitor:Sy,actionSanitizer:void 0,stateSanitizer:void 0,name:Yj,serialize:!1,logOnly:!1,autoPause:!1,trace:!1,traceLimit:75,features:{pause:!0,lock:!0,persist:!0,export:!0,import:"custom",jump:!0,skip:!0,reorder:!0,dispatch:!0,test:!0},connectInZone:!1},i=typeof e=="function"?e():e,t=i.logOnly?{pause:!0,export:!0,test:!0}:!1,r=i.features||t||n.features;r.import===!0&&(r.import="custom");let a=Object.assign({},n,{features:r},i);if(a.maxAge&&a.maxAge<2)throw new Error(`Devtools 'maxAge' cannot be less than 2, got ${a.maxAge}`);return a}function my(e,n){return e.filter(i=>n.indexOf(i)<0)}function Py(e){let{computedStates:n,currentStateIndex:i}=e;if(i>=n.length){let{state:r}=n[n.length-1];return r}let{state:t}=n[i];return t}function l0(e){return new Zc(e,+Date.now())}function Gj(e,n){return Object.keys(n).reduce((i,t)=>{let r=Number(t);return i[r]=Oy(e,n[r],r),i},{})}function Oy(e,n,i){return le(ae({},n),{action:e(n.action,i)})}function Hj(e,n){return n.map((i,t)=>({state:ky(e,i.state,t),error:i.error}))}function ky(e,n,i){return e(n,i)}function Ey(e){return e.predicate||e.actionsSafelist||e.actionsBlocklist}function qj(e,n,i,t){let r=[],a={},o=[];return e.stagedActionIds.forEach((s,u)=>{let m=e.actionsById[s];m&&(u&&Lp(e.computedStates[u],m,n,i,t)||(a[s]=m,r.push(s),o.push(e.computedStates[u])))}),le(ae({},e),{stagedActionIds:r,actionsById:a,computedStates:o})}function Lp(e,n,i,t,r){let a=i&&!i(e,n.action),o=t&&!n.action.type.match(t.map(u=>gy(u)).join("|")),s=r&&n.action.type.match(r.map(u=>gy(u)).join("|"));return a||o||s}function gy(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ty(e){return{ngZone:e?Wr(vr):null,connectInZone:e}}var km=(()=>{let n=class n extends U0{};n.\u0275fac=(()=>{let t;return function(a){return(t||(t=Vh(n)))(a||n)}})(),n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})(),wm={START:"START",DISPATCH:"DISPATCH",STOP:"STOP",ACTION:"ACTION"},Np=new Xa("@ngrx/store-devtools Redux Devtools Extension"),Iy=(()=>{let n=class n{constructor(t,r,a){this.config=r,this.dispatcher=a,this.zoneConfig=Ty(this.config.connectInZone),this.devtoolsExtension=t,this.createActionStreams()}notify(t,r){if(this.devtoolsExtension)if(t.type===d0){if(r.isLocked||r.isPaused)return;let a=Py(r);if(Ey(this.config)&&Lp(a,t,this.config.predicate,this.config.actionsSafelist,this.config.actionsBlocklist))return;let o=this.config.stateSanitizer?ky(this.config.stateSanitizer,a,r.currentStateIndex):a,s=this.config.actionSanitizer?Oy(this.config.actionSanitizer,t,r.nextActionId):t;this.sendToReduxDevtools(()=>this.extensionConnection.send(s,o))}else{let a=le(ae({},r),{stagedActionIds:r.stagedActionIds,actionsById:this.config.actionSanitizer?Gj(this.config.actionSanitizer,r.actionsById):r.actionsById,computedStates:this.config.stateSanitizer?Hj(this.config.stateSanitizer,r.computedStates):r.computedStates});this.sendToReduxDevtools(()=>this.devtoolsExtension.send(null,a,this.getExtensionConfig(this.config)))}}createChangesObservable(){return this.devtoolsExtension?new qt(t=>{let r=this.zoneConfig.connectInZone?this.zoneConfig.ngZone.runOutsideAngular(()=>this.devtoolsExtension.connect(this.getExtensionConfig(this.config))):this.devtoolsExtension.connect(this.getExtensionConfig(this.config));return this.extensionConnection=r,r.init(),r.subscribe(a=>t.next(a)),r.unsubscribe}):Oh}createActionStreams(){let t=this.createChangesObservable().pipe(Fh()),r=t.pipe(Xi(f=>f.type===wm.START)),a=t.pipe(Xi(f=>f.type===wm.STOP)),o=t.pipe(Xi(f=>f.type===wm.DISPATCH),rt(f=>this.unwrapAction(f.payload)),Ih(f=>f.type===Bp?this.dispatcher.pipe(Xi(h=>h.type===eg),Eh(1e3),cl(1e3),rt(()=>f),_t(()=>lt(f)),qa(1)):lt(f))),u=t.pipe(Xi(f=>f.type===wm.ACTION),rt(f=>this.unwrapAction(f.payload))).pipe(Qt(a)),m=o.pipe(Qt(a));this.start$=r.pipe(Qt(a)),this.actions$=this.start$.pipe(zr(()=>u)),this.liftedActions$=this.start$.pipe(zr(()=>m))}unwrapAction(t){return typeof t=="string"?(0,eval)(`(${t})`):t}getExtensionConfig(t){var a,o,s;let r={name:t.name,features:t.features,serialize:t.serialize,autoPause:(a=t.autoPause)!=null?a:!1,trace:(o=t.trace)!=null?o:!1,traceLimit:(s=t.traceLimit)!=null?s:75};return t.maxAge!==!1&&(r.maxAge=t.maxAge),r}sendToReduxDevtools(t){try{t()}catch(r){console.warn("@ngrx/store-devtools: something went wrong inside the redux devtools",r)}}};n.\u0275fac=function(r){return new(r||n)(De(Np),De(Om),De(km))},n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})(),Pm={type:Qm},Xj="@ngrx/store-devtools/recompute",Kj={type:Xj};function Ay(e,n,i,t,r){if(t)return{state:i,error:"Interrupted by an error up the chain"};let a=i,o;try{a=e(i,n)}catch(s){o=s.toString(),r.handleError(s)}return{state:a,error:o}}function Sm(e,n,i,t,r,a,o,s,u){if(n>=e.length&&e.length===a.length)return e;let m=e.slice(0,n),f=a.length-(u?1:0);for(let h=n;h<f;h++){let _=a[h],y=r[_].action,v=m[h-1],C=v?v.state:t,P=v?v.error:void 0,T=o.indexOf(_)>-1?v:Ay(i,y,C,P,s);m.push(T)}return u&&m.push(e[e.length-1]),m}function Zj(e,n){return{monitorState:n(void 0,{}),nextActionId:1,actionsById:{0:l0(Pm)},stagedActionIds:[0],skippedActionIds:[],committedState:e,currentStateIndex:0,computedStates:[],isLocked:!1,isPaused:!1}}function Jj(e,n,i,t,r={}){return a=>(o,s)=>{let{monitorState:u,actionsById:m,nextActionId:f,stagedActionIds:h,skippedActionIds:_,committedState:y,currentStateIndex:v,computedStates:C,isLocked:P,isPaused:D}=o||n;o||(m=Object.create(m));function T(ee){let k=ee,O=h.slice(1,k+1);for(let R=0;R<O.length;R++)if(C[R+1].error){k=R,O=h.slice(1,k+1);break}else delete m[O[R]];_=_.filter(R=>O.indexOf(R)===-1),h=[0,...h.slice(k+1)],y=C[k].state,C=C.slice(k),v=v>k?v-k:0}function I(){m={0:l0(Pm)},f=1,h=[0],_=[],y=C[v].state,v=0,C=[]}let K=0;switch(s.type){case My:{P=s.status,K=1/0;break}case wy:{D=s.status,D?(h=[...h,f],m[f]=new Zc({type:"@ngrx/devtools/pause"},+Date.now()),f++,K=h.length-1,C=C.concat(C[C.length-1]),v===h.length-2&&v++,K=1/0):I();break}case hy:{m={0:l0(Pm)},f=1,h=[0],_=[],y=e,v=0,C=[];break}case _y:{I();break}case xy:{m={0:l0(Pm)},f=1,h=[0],_=[],v=0,C=[];break}case vy:{let{id:ee}=s;_.indexOf(ee)===-1?_=[ee,..._]:_=_.filter(O=>O!==ee),K=h.indexOf(ee);break}case Wj:{let{start:ee,end:k,active:O}=s,R=[];for(let U=ee;U<k;U++)R.push(U);O?_=my(_,R):_=[..._,...R],K=h.indexOf(ee);break}case by:{v=s.index,K=1/0;break}case yy:{let ee=h.indexOf(s.actionId);ee!==-1&&(v=ee),K=1/0;break}case Cy:{h=my(h,_),_=[],v=Math.min(v,h.length-1);break}case d0:{if(P)return o||n;if(D||o&&Lp(o.computedStates[v],s,r.predicate,r.actionsSafelist,r.actionsBlocklist)){let k=C[C.length-1];C=[...C.slice(0,-1),Ay(a,s.action,k.state,k.error,i)],K=1/0;break}r.maxAge&&h.length===r.maxAge&&T(1),v===h.length-1&&v++;let ee=f++;m[ee]=s,h=[...h,ee],K=h.length-1;break}case Bp:{({monitorState:u,actionsById:m,nextActionId:f,stagedActionIds:h,skippedActionIds:_,committedState:y,currentStateIndex:v,computedStates:C,isLocked:P,isPaused:D}=s.nextLiftedState);break}case Qm:{K=0,r.maxAge&&h.length>r.maxAge&&(C=Sm(C,K,a,y,m,h,_,i,D),T(h.length-r.maxAge),K=1/0);break}case eg:{if(C.filter(k=>k.error).length>0)K=0,r.maxAge&&h.length>r.maxAge&&(C=Sm(C,K,a,y,m,h,_,i,D),T(h.length-r.maxAge),K=1/0);else{if(!D&&!P){v===h.length-1&&v++;let k=f++;m[k]=new Zc(s,+Date.now()),h=[...h,k],K=h.length-1,C=Sm(C,K,a,y,m,h,_,i,D)}C=C.map(k=>le(ae({},k),{state:a(k.state,Kj)})),v=h.length-1,r.maxAge&&h.length>r.maxAge&&T(h.length-r.maxAge),K=1/0}break}default:{K=1/0;break}}return C=Sm(C,K,a,y,m,h,_,i,D),u=t(u,s),{monitorState:u,actionsById:m,nextActionId:f,stagedActionIds:h,skippedActionIds:_,committedState:y,currentStateIndex:v,computedStates:C,isLocked:P,isPaused:D}}}var fy=(()=>{let n=class n{constructor(t,r,a,o,s,u,m,f){let h=Zj(m,f.monitor),_=Jj(m,h,u,f.monitor,f),y=Xm(Xm(r.asObservable().pipe(Rh(1)),o.actions$).pipe(rt(l0)),t,o.liftedActions$).pipe(kh(Ph)),v=a.pipe(rt(_)),C=Ty(f.connectInZone),P=new sl(1);this.liftedStateSubscription=y.pipe(Bh(v),py(C),Dh(({state:I},[K,ee])=>{let k=ee(I,K);return K.type!==d0&&Ey(f)&&(k=qj(k,f.predicate,f.actionsSafelist,f.actionsBlocklist)),o.notify(K,k),{state:k,action:K}},{state:h,action:null})).subscribe(({state:I,action:K})=>{if(P.next(I),K.type===d0){let ee=K.action;s.next(ee)}}),this.extensionStartSubscription=o.start$.pipe(py(C)).subscribe(()=>{this.refresh()});let D=P.asObservable(),T=D.pipe(rt(Py));Object.defineProperty(T,"state",{value:l1(T,{manualCleanup:!0,requireSync:!0})}),this.dispatcher=t,this.liftedState=D,this.state=T}ngOnDestroy(){this.liftedStateSubscription.unsubscribe(),this.extensionStartSubscription.unsubscribe()}dispatch(t){this.dispatcher.next(t)}next(t){this.dispatcher.next(t)}error(t){}complete(){}performAction(t){this.dispatch(new Zc(t,+Date.now()))}refresh(){this.dispatch(new Sp)}reset(){this.dispatch(new Pp(+Date.now()))}rollback(){this.dispatch(new Op(+Date.now()))}commit(){this.dispatch(new kp(+Date.now()))}sweep(){this.dispatch(new Ep)}toggleAction(t){this.dispatch(new Tp(t))}jumpToAction(t){this.dispatch(new Ap(t))}jumpToState(t){this.dispatch(new Ip(t))}importState(t){this.dispatch(new Dp(t))}lockChanges(t){this.dispatch(new Fp(t))}pauseRecording(t){this.dispatch(new Rp(t))}};n.\u0275fac=function(r){return new(r||n)(De(km),De(U0),De(u1),De(Iy),De(g1),De(jh),De(d1),De(Om))},n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})();function py({ngZone:e,connectInZone:n}){return i=>n?new qt(t=>i.subscribe({next:r=>e.run(()=>t.next(r)),error:r=>e.run(()=>t.error(r)),complete:()=>e.run(()=>t.complete())})):i}var Qj=new Xa("@ngrx/store-devtools Is Devtools Extension or Monitor Present");function ez(e,n){return!!e||n.monitor!==Sy}function tz(){let e="__REDUX_DEVTOOLS_EXTENSION__";return typeof window=="object"&&typeof window[e]<"u"?window[e]:null}function nz(e={}){return zs([Iy,km,fy,{provide:uy,useValue:e},{provide:Qj,deps:[Np,Om],useFactory:ez},{provide:Np,useFactory:tz},{provide:Om,deps:[uy],useFactory:$j},{provide:f1,deps:[fy],useFactory:iz},{provide:m1,useExisting:km}])}function iz(e){return e.state}var Dy=(()=>{let n=class n{static instrument(t={}){return{ngModule:n,providers:[nz(t)]}}};n.\u0275fac=function(r){return new(r||n)},n.\u0275mod=Cr({type:n}),n.\u0275inj=_r({});let e=n;return e})();var Vp={entities:{},ids:[],loading:!1,error:null,selectedTransactionId:null};var Fy=Gr(Vp,Te(ri,e=>le(ae({},e),{loading:!0,error:null})),Te(md,(e,{transactions:n})=>{let i=n.reduce((r,a)=>(a.id&&(r[a.id]=a),r),{}),t=n.map(r=>r.id).filter(r=>r);return le(ae({},e),{entities:i,ids:t,loading:!1,error:null})}),Te(gd,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(ho,e=>le(ae({},e),{loading:!0,error:null})),Te(ic,(e,{transaction:n})=>n.id?le(ae({},e),{entities:le(ae({},e.entities),{[n.id]:n}),ids:[...e.ids,n.id],loading:!1,error:null}):e),Te(fd,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(xo,e=>le(ae({},e),{loading:!0,error:null})),Te(rc,(e,{transaction:n})=>n.id?le(ae({},e),{entities:le(ae({},e.entities),{[n.id]:n}),loading:!1,error:null}):e),Te(pd,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(ac,e=>le(ae({},e),{loading:!0,error:null})),Te(_o,(e,{transactionId:n})=>{let r=e.entities,{[n]:i}=r,t=Us(r,[Vs(n)]);return le(ae({},e),{entities:t,ids:e.ids.filter(a=>a!==n),loading:!1,error:null})}),Te(hd,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(xd,e=>le(ae({},e),{loading:!0,error:null})),Te(_d,(e,{transaction:n})=>n.id?le(ae({},e),{entities:le(ae({},e.entities),{[n.id]:n}),ids:e.ids.includes(n.id)?e.ids:[...e.ids,n.id],selectedTransactionId:n.id,loading:!1,error:null}):e),Te(gl,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(w1,()=>Vp));var Up={entities:{},ids:[],loading:!1,error:null};var Ry=Gr(Up,Te(mr,e=>le(ae({},e),{loading:!0,error:null})),Te(rd,(e,{categories:n})=>{let i=n.reduce((r,a)=>(a.id&&(r[a.id]=a),r),{}),t=n.map(r=>r.id).filter(r=>r);return le(ae({},e),{entities:i,ids:t,loading:!1,error:null})}),Te(ad,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(tc,e=>le(ae({},e),{loading:!0,error:null})),Te(v1,(e,{category:n})=>n.id?le(ae({},e),{entities:le(ae({},e.entities),{[n.id]:n}),ids:[...e.ids,n.id],loading:!1,error:null}):e),Te(od,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(ba,e=>le(ae({},e),{loading:!0,error:null})),Te(b1,(e,{category:n})=>n.id?le(ae({},e),{entities:le(ae({},e.entities),{[n.id]:n}),loading:!1,error:null}):e),Te(sd,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(nc,e=>le(ae({},e),{loading:!0,error:null})),Te(cd,(e,{categoryId:n})=>{let r=e.entities,{[n]:i}=r,t=Us(r,[Vs(n)]);return le(ae({},e),{entities:t,ids:e.ids.filter(a=>a!==n),loading:!1,error:null})}),Te(ld,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(dd,e=>le(ae({},e),{loading:!0,error:null})),Te(y1,(e,{categoryId:n})=>{let i=e.entities[n];return i?le(ae({},e),{entities:le(ae({},e.entities),{[n]:le(ae({},i),{parentCategoryId:void 0,isSubCategory:!1})}),loading:!1,error:null}):e}),Te(ud,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(M1,()=>Up));var jp={entities:{},ids:[],loading:!1,error:null,selectedAccountId:null};var Ny=Gr(jp,Te(Mr,e=>le(ae({},e),{loading:!0,error:null})),Te(j0,(e,{accounts:n})=>{let i=n.reduce((r,a)=>(r[a.accountId]=a,r),{}),t=n.map(r=>r.accountId);return le(ae({},e),{entities:i,ids:t,loading:!1,error:null})}),Te(z0,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(W0,e=>le(ae({},e),{loading:!0,error:null})),Te(h1,(e,{account:n})=>le(ae({},e),{entities:le(ae({},e.entities),{[n.accountId]:n}),ids:[...e.ids,n.accountId],loading:!1,error:null})),Te(Y0,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te($0,e=>le(ae({},e),{loading:!0,error:null})),Te(x1,(e,{account:n})=>le(ae({},e),{entities:le(ae({},e.entities),{[n.accountId]:n}),loading:!1,error:null})),Te(G0,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(ec,e=>le(ae({},e),{loading:!0,error:null})),Te(H0,(e,{accountId:n})=>{let r=e.entities,{[n]:i}=r,t=Us(r,[Vs(n)]);return le(ae({},e),{entities:t,ids:e.ids.filter(a=>a!==n),loading:!1,error:null})}),Te(q0,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(X0,e=>le(ae({},e),{loading:!0,error:null})),Te(K0,(e,{account:n})=>le(ae({},e),{entities:le(ae({},e.entities),{[n.accountId]:n}),ids:e.ids.includes(n.accountId)?e.ids:[...e.ids,n.accountId],selectedAccountId:n.accountId,loading:!1,error:null})),Te(ml,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(po,e=>le(ae({},e),{loading:!0,error:null})),Te(Z0,(e,{accountId:n,newBalance:i})=>{let t=e.entities[n];return t?le(ae({},e),{entities:le(ae({},e.entities),{[n]:le(ae({},t),{balance:i,updatedAt:new Date})}),loading:!1,error:null}):e}),Te(J0,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(Q0,e=>le(ae({},e),{loading:!0,error:null})),Te(ed,e=>le(ae({},e),{loading:!1,error:null})),Te(td,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(nd,e=>le(ae({},e),{loading:!0,error:null})),Te(_1,e=>le(ae({},e),{loading:!1,error:null})),Te(id,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(C1,()=>jp));var By={budgets:[],loading:!1,error:null};var Ly=Gr(By,Te(Oa,e=>le(ae({},e),{loading:!0,error:null})),Te(Ud,(e,{budgets:n})=>le(ae({},e),{budgets:n,loading:!1,error:null})),Te(jd,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(pc,e=>le(ae({},e),{loading:!0,error:null})),Te(zd,(e,{budget:n})=>le(ae({},e),{budgets:[...e.budgets,n],loading:!1,error:null})),Te(Wd,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(Yd,e=>le(ae({},e),{loading:!0,error:null})),Te($d,(e,{budget:n})=>le(ae({},e),{budgets:e.budgets.map(i=>i.budgetId===n.budgetId?n:i),loading:!1,error:null})),Te(Gd,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(hc,e=>le(ae({},e),{loading:!0,error:null})),Te(Hd,(e,{budgetId:n})=>le(ae({},e),{budgets:e.budgets.filter(i=>i.budgetId!==n),loading:!1,error:null})),Te(qd,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(xc,e=>le(ae({},e),{loading:!0,error:null})),Te(Xd,(e,{budget:n})=>le(ae({},e),{budgets:e.budgets.map(i=>i.budgetId===n.budgetId?n:i),loading:!1,error:null})),Te(Kd,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})));var Vy={goals:[],loading:!1,error:null};var Uy=Gr(Vy,Te(ka,e=>le(ae({},e),{loading:!0,error:null})),Te(Zd,(e,{goals:n})=>le(ae({},e),{goals:n,loading:!1,error:null})),Te(Jd,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(_c,e=>le(ae({},e),{loading:!0,error:null})),Te(Qd,(e,{goal:n})=>le(ae({},e),{goals:[...e.goals,n],loading:!1,error:null})),Te(eu,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(tu,e=>le(ae({},e),{loading:!0,error:null})),Te(nu,(e,{goal:n})=>le(ae({},e),{goals:e.goals.map(i=>i.goalId===n.goalId?n:i),loading:!1,error:null})),Te(iu,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(Cc,e=>le(ae({},e),{loading:!0,error:null})),Te(ru,(e,{goalId:n})=>le(ae({},e),{goals:e.goals.filter(i=>i.goalId!==n),loading:!1,error:null})),Te(au,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(vc,e=>le(ae({},e),{loading:!0,error:null})),Te(ou,(e,{goal:n})=>le(ae({},e),{goals:e.goals.map(i=>i.goalId===n.goalId?n:i),loading:!1,error:null})),Te(su,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})));var jy={profile:null,loading:!1,error:null};var zy=Gr(jy,Te(Ea,e=>le(ae({},e),{loading:!0,error:null})),Te(cu,(e,{profile:n})=>le(ae({},e),{profile:n,loading:!1,error:null})),Te(lu,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(bc,e=>le(ae({},e),{loading:!0,error:null})),Te(du,(e,{profile:n})=>le(ae({},e),{profile:n,loading:!1,error:null})),Te(uu,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(mu,e=>le(ae({},e),{loading:!0,error:null})),Te(gu,(e,{profile:n})=>le(ae({},e),{profile:n,loading:!1,error:null})),Te(fu,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(pu,e=>le(ae({},e),{loading:!0,error:null})),Te(hu,e=>le(ae({},e),{profile:null,loading:!1,error:null})),Te(xu,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})),Te(_u,e=>le(ae({},e),{loading:!0,error:null})),Te(Cu,(e,{profile:n})=>le(ae({},e),{profile:n,loading:!1,error:null})),Te(vu,(e,{error:n})=>le(ae({},e),{loading:!1,error:n})));var Wy=(()=>{let n=class n{constructor(t,r){this.actions$=t,this.transactionsService=r,this.loadTransactions$=Wt(()=>this.actions$.pipe(Yt(ri),Bt(({userId:a})=>this.transactionsService.getTransactions(a).pipe(rt(o=>md({transactions:o})),_t(o=>lt(gd({error:o}))))))),this.createTransaction$=Wt(()=>this.actions$.pipe(Yt(ho),Bt(({userId:a,transaction:o})=>this.transactionsService.createTransaction(a,o).pipe(rt(()=>ri({userId:a})),_t(s=>lt(fd({error:s}))))))),this.updateTransaction$=Wt(()=>this.actions$.pipe(Yt(xo),Bt(({userId:a,transactionId:o,transaction:s})=>this.transactionsService.updateTransaction(a,o,s).pipe(rt(()=>ri({userId:a})),_t(u=>lt(pd({error:u}))))))),this.deleteTransaction$=Wt(()=>this.actions$.pipe(Yt(ac),Bt(({userId:a,transactionId:o})=>this.transactionsService.deleteTransaction(a,o).pipe(rt(()=>_o({transactionId:o})),_t(s=>lt(hd({error:s}))))))),this.getTransaction$=Wt(()=>this.actions$.pipe(Yt(xd),Bt(({userId:a,transactionId:o})=>this.transactionsService.getTransaction(a,o).pipe(rt(s=>s?_d({transaction:s}):gl({error:"Transaction not found"})),_t(s=>lt(gl({error:s})))))))}};n.\u0275fac=function(r){return new(r||n)(De(Qr),De(Ao))},n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})();var Yy=(()=>{let n=class n{constructor(t,r){this.actions$=t,this.categoryService=r,this.loadCategories$=Wt(()=>this.actions$.pipe(Yt(mr),Bt(({userId:a})=>this.categoryService.getCategories(a).pipe(rt(o=>rd({categories:o})),_t(o=>lt(ad({error:o}))))))),this.createCategory$=Wt(()=>this.actions$.pipe(Yt(tc),Bt(({userId:a,name:o,categoryType:s,icon:u,color:m})=>this.categoryService.createCategory(a,o,s,u,m).pipe(rt(()=>mr({userId:a})),_t(f=>lt(od({error:f}))))))),this.updateCategory$=Wt(()=>this.actions$.pipe(Yt(ba),Bt(({userId:a,categoryId:o,name:s,categoryType:u,icon:m,color:f,budgetData:h,parentCategoryId:_,isSubCategory:y})=>this.categoryService.updateCategory(a,o,s,u,m,f,h,_,y).pipe(rt(()=>mr({userId:a})),_t(v=>lt(sd({error:v}))))))),this.deleteCategory$=Wt(()=>this.actions$.pipe(Yt(nc),Bt(({userId:a,categoryId:o})=>this.categoryService.deleteCategory(a,o).pipe(rt(()=>cd({categoryId:o})),_t(s=>lt(ld({error:s}))))))),this.removeFromParentCategory$=Wt(()=>this.actions$.pipe(Yt(dd),Bt(({userId:a,categoryId:o})=>this.categoryService.removeFromParentCategory(a,o).pipe(rt(()=>mr({userId:a})),_t(s=>lt(ud({error:s})))))))}};n.\u0275fac=function(r){return new(r||n)(De(Qr),De(Do))},n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})();var $y=(()=>{let n=class n{constructor(t,r){this.actions$=t,this.accountsService=r,this.loadAccounts$=Wt(()=>this.actions$.pipe(Yt(Mr),Bt(({userId:a})=>this.accountsService.getAccounts(a).pipe(rt(o=>j0({accounts:o})),_t(o=>lt(z0({error:o}))))))),this.createAccount$=Wt(()=>this.actions$.pipe(Yt(W0),Bt(({userId:a,accountData:o})=>this.accountsService.createAccount(a,o).pipe(rt(s=>Mr({userId:a})),_t(s=>lt(Y0({error:s}))))))),this.updateAccount$=Wt(()=>this.actions$.pipe(Yt($0),Bt(({userId:a,accountId:o,accountData:s})=>this.accountsService.updateAccount(a,o,s).pipe(rt(()=>Mr({userId:a})),_t(u=>lt(G0({error:u}))))))),this.deleteAccount$=Wt(()=>this.actions$.pipe(Yt(ec),Bt(({userId:a,accountId:o})=>this.accountsService.deleteAccount(a,o).pipe(rt(()=>H0({accountId:o})),_t(s=>lt(q0({error:s}))))))),this.getAccount$=Wt(()=>this.actions$.pipe(Yt(X0),Bt(({userId:a,accountId:o})=>this.accountsService.getAccount(a,o).pipe(rt(s=>s?K0({account:s}):ml({error:"Account not found"})),_t(s=>lt(ml({error:s}))))))),this.updateAccountBalanceForTransaction$=Wt(()=>this.actions$.pipe(Yt(po),Bt(({userId:a,accountId:o,transactionType:s,oldTransaction:u,newTransaction:m})=>this.accountsService.updateAccountBalanceForTransaction(a,o,s,u,m).pipe(rt(f=>Z0({accountId:o,newBalance:f})),_t(f=>lt(J0({error:f}))))))),this.updateAccountBalanceForTransactions$=Wt(()=>this.actions$.pipe(Yt(Q0),Bt(({userId:a,transactions:o})=>this.accountsService.updateAccountBalanceForTransactions(a,o).pipe(rt(()=>ed()),_t(s=>lt(td({error:s}))))))),this.updateAccountBalanceForAccountTransfer$=Wt(()=>this.actions$.pipe(Yt(nd),Bt(({userId:a,oldAccountId:o,newAccountId:s,transaction:u})=>this.accountsService.updateAccountBalanceForAccountTransfer(a,o,s,u).pipe(rt(()=>Mr({userId:a})),_t(m=>lt(id({error:m})))))))}};n.\u0275fac=function(r){return new(r||n)(De(Qr),De(yc))},n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})();var Gy=(()=>{let n=class n{constructor(t,r,a){this.firestore=t,this.auth=r,this.dateService=a}createBudget(t,r){return ue(this,null,function*(){let a=Et(this.firestore,`users/${t}/budgets/${r.budgetId}`);yield wr(a,le(ae({},r),{startDate:this.dateService.toTimestamp(r.startDate),endDate:this.dateService.toTimestamp(r.endDate),spent:0}))})}getBudgets(t){let r=Fr(this.firestore,`users/${t}/budgets`);return new qt(a=>{ya(r).then(o=>{let s=[];o.forEach(u=>{s.push(u.data())}),a.next(s)})})}getBudget(t,r){return ue(this,null,function*(){let a=Et(this.firestore,`users/${t}/budgets/${r}`),o=yield ai(a);if(o.exists())return o.data()})}updateBudget(t,r,a){return ue(this,null,function*(){let o=Et(this.firestore,`users/${t}/budgets/${r}`);yield kn(o,a)})}deleteBudget(t,r){return ue(this,null,function*(){let a=Et(this.firestore,`users/${t}/budgets/${r}`);yield Di(a)})}updateSpent(t,r,a){return ue(this,null,function*(){var u;let o=Et(this.firestore,`users/${t}/budgets/${r}`),s=yield ai(o);if(s.exists()){let f=(((u=s.data())==null?void 0:u.spent)||0)+a;yield kn(o,{spent:f})}})}};n.\u0275fac=function(r){return new(r||n)(De(Ki),De(pt),De(At))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var Hy=(()=>{let n=class n{constructor(t,r){this.actions$=t,this.budgetsService=r,this.loadBudgets$=Wt(()=>this.actions$.pipe(Yt(Oa),Bt(({userId:a})=>this.budgetsService.getBudgets(a).pipe(rt(o=>Ud({budgets:o})),_t(o=>lt(jd({error:o}))))))),this.createBudget$=Wt(()=>this.actions$.pipe(Yt(pc),Bt(({userId:a,budget:o})=>On(this.budgetsService.createBudget(a,o)).pipe(rt(()=>zd({budget:o})),_t(s=>lt(Wd({error:s}))))))),this.updateBudget$=Wt(()=>this.actions$.pipe(Yt(Yd),Bt(({userId:a,budgetId:o,budget:s})=>On(this.budgetsService.updateBudget(a,o,s)).pipe(rt(()=>$d({budget:le(ae({},s),{budgetId:o})})),_t(u=>lt(Gd({error:u}))))))),this.deleteBudget$=Wt(()=>this.actions$.pipe(Yt(hc),Bt(({userId:a,budgetId:o})=>On(this.budgetsService.deleteBudget(a,o)).pipe(rt(()=>Hd({budgetId:o})),_t(s=>lt(qd({error:s}))))))),this.updateSpent$=Wt(()=>this.actions$.pipe(Yt(xc),Bt(({userId:a,budgetId:o,amount:s})=>On(this.budgetsService.updateSpent(a,o,s)).pipe(rt(()=>Xd({budget:{budgetId:o,spent:s}})),_t(u=>lt(Kd({error:u})))))))}};n.\u0275fac=function(r){return new(r||n)(De(Qr),De(Gy))},n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})();var qy=(()=>{let n=class n{constructor(t,r,a){this.firestore=t,this.auth=r,this.dateService=a}createGoal(t,r){return ue(this,null,function*(){let a=Et(this.firestore,`users/${t}/goals/${r.goalId}`);yield wr(a,le(ae({},r),{deadline:this.dateService.toTimestamp(r.deadline),currentAmount:0}))})}getGoals(t){let r=Fr(this.firestore,`users/${t}/goals`);return new qt(a=>{ya(r).then(o=>{let s=[];o.forEach(u=>{s.push(u.data())}),a.next(s)})})}getGoal(t,r){return ue(this,null,function*(){let a=Et(this.firestore,`users/${t}/goals/${r}`),o=yield ai(a);if(o.exists())return o.data()})}updateGoal(t,r,a){return ue(this,null,function*(){let o=Et(this.firestore,`users/${t}/goals/${r}`);yield kn(o,a)})}deleteGoal(t,r){return ue(this,null,function*(){let a=Et(this.firestore,`users/${t}/goals/${r}`);yield Di(a)})}updateCurrentAmount(t,r,a){return ue(this,null,function*(){var u;let o=Et(this.firestore,`users/${t}/goals/${r}`),s=yield ai(o);if(s.exists()){let f=(((u=s.data())==null?void 0:u.currentAmount)||0)+a;yield kn(o,{currentAmount:f})}})}};n.\u0275fac=function(r){return new(r||n)(De(Ki),De(pt),De(At))},n.\u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var Xy=(()=>{let n=class n{constructor(t,r){this.actions$=t,this.goalsService=r,this.loadGoals$=Wt(()=>this.actions$.pipe(Yt(ka),Bt(({userId:a})=>this.goalsService.getGoals(a).pipe(rt(o=>Zd({goals:o})),_t(o=>lt(Jd({error:o}))))))),this.createGoal$=Wt(()=>this.actions$.pipe(Yt(_c),Bt(({userId:a,goal:o})=>On(this.goalsService.createGoal(a,o)).pipe(rt(()=>Qd({goal:o})),_t(s=>lt(eu({error:s}))))))),this.updateGoal$=Wt(()=>this.actions$.pipe(Yt(tu),Bt(({userId:a,goalId:o,goal:s})=>On(this.goalsService.updateGoal(a,o,s)).pipe(rt(()=>nu({goal:le(ae({},s),{goalId:o})})),_t(u=>lt(iu({error:u}))))))),this.deleteGoal$=Wt(()=>this.actions$.pipe(Yt(Cc),Bt(({userId:a,goalId:o})=>On(this.goalsService.deleteGoal(a,o)).pipe(rt(()=>ru({goalId:o})),_t(s=>lt(au({error:s}))))))),this.updateCurrentAmount$=Wt(()=>this.actions$.pipe(Yt(vc),Bt(({userId:a,goalId:o,amount:s})=>On(this.goalsService.updateCurrentAmount(a,o,s)).pipe(rt(()=>ou({goal:{goalId:o,currentAmount:s}})),_t(u=>lt(su({error:u})))))))}};n.\u0275fac=function(r){return new(r||n)(De(Qr),De(qy))},n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})();var Ky=(()=>{let n=class n{constructor(t,r){this.actions$=t,this.userService=r,this.loadProfile$=Wt(()=>this.actions$.pipe(Yt(Ea),Bt(({userId:a})=>On(this.userService.getCurrentUser()).pipe(rt(o=>{if(o)return cu({profile:o});throw new Error("Profile not found")}),_t(o=>lt(lu({error:o}))))))),this.updateProfile$=Wt(()=>this.actions$.pipe(Yt(bc),Bt(({userId:a,profile:o})=>On(this.userService.createOrUpdateUser(o)).pipe(rt(()=>du({profile:o})),_t(s=>lt(uu({error:s}))))))),this.createProfile$=Wt(()=>this.actions$.pipe(Yt(mu),Bt(({userId:a,profile:o})=>On(this.userService.createOrUpdateUser(o)).pipe(rt(()=>gu({profile:o})),_t(s=>lt(fu({error:s}))))))),this.deleteProfile$=Wt(()=>this.actions$.pipe(Yt(pu),Bt(({userId:a})=>On(this.userService.signOut()).pipe(rt(()=>hu()),_t(o=>lt(xu({error:o}))))))),this.updatePreferences$=Wt(()=>this.actions$.pipe(Yt(_u),Bt(({userId:a,preferences:o})=>On(this.userService.getCurrentUser()).pipe(Bt(s=>{if(s){let u=le(ae({},s),{preferences:o});return On(this.userService.createOrUpdateUser(u))}else throw new Error("User not found")}),rt(()=>Cu({profile:{preferences:o}})),_t(s=>lt(vu({error:s})))))))}};n.\u0275fac=function(r){return new(r||n)(De(Qr),De(gi))},n.\u0275prov=dt({token:n,factory:n.\u0275fac});let e=n;return e})();var Zy=(()=>{let n=class n{};n.\u0275fac=function(r){return new(r||n)},n.\u0275mod=Cr({type:n}),n.\u0275inj=_r({imports:[p1.forRoot({transactions:Fy,categories:Ry,accounts:Ny,budgets:Ly,goals:Uy,profile:zy}),Yx.forRoot([Wy,Yy,$y,Hy,Xy,Ky]),Dy.instrument({maxAge:25,logOnly:oi.production})]});let e=n;return e})();function Jy(e,n){let i=Wr(Kt),t=Wr(gi),r=Wr(ht),a=oz(e),o=sz(a,t);return n(o).pipe(Ah(1),_t(s=>cz(s,e,i,t,r)))}function oz(e){let n={"X-Content-Type-Options":"nosniff","X-Frame-Options":"DENY","X-XSS-Protection":"1; mode=block","Referrer-Policy":"strict-origin-when-cross-origin","Permissions-Policy":"geolocation=(), microphone=(), camera=()","Strict-Transport-Security":"max-age=31536000; includeSubDomains","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"};return e.clone({setHeaders:n})}function sz(e,n){let i=n.userAuth$.value;return i&&i.uid?e.clone({setHeaders:{Authorization:`Bearer ${i.uid}`}}):e}function cz(e,n,i,t,r){switch(console.error("Security interceptor error:",e),e.status){case 401:lz(i,t,r);break;case 403:dz(r);break;case 429:uz(r);break;case 500:mz(r);break;default:gz(e,r)}return es(()=>e)}function lz(e,n,i){var t;console.warn("Unauthorized request detected"),m0("UNAUTHORIZED_REQUEST",{url:((t=window==null?void 0:window.location)==null?void 0:t.href)||"",timestamp:new Date().toISOString()}),n.forceLogout("Unauthorized request detected"),i.error("Session expired. Please log in again."),e.navigate(["/landing"],{queryParams:{error:"unauthorized",redirect:e.url}})}function dz(e){var n;console.warn("Forbidden request detected"),m0("FORBIDDEN_REQUEST",{url:((n=window==null?void 0:window.location)==null?void 0:n.href)||"",timestamp:new Date().toISOString()}),e.error("Access denied. You do not have permission to perform this action.")}function uz(e){var n;console.warn("Rate limit exceeded"),m0("RATE_LIMIT_EXCEEDED",{url:((n=window==null?void 0:window.location)==null?void 0:n.href)||"",timestamp:new Date().toISOString()}),e.warning("Too many requests. Please wait a moment before trying again.")}function mz(e){var n;console.error("Server error detected"),m0("SERVER_ERROR",{url:((n=window==null?void 0:window.location)==null?void 0:n.href)||"",timestamp:new Date().toISOString()}),e.error("Server error. Please try again later.")}function gz(e,n){var i;console.error("Generic HTTP error:",e),m0("HTTP_ERROR",{status:e.status,statusText:e.statusText,url:e.url||((i=window==null?void 0:window.location)==null?void 0:i.href)||"",timestamp:new Date().toISOString()}),e.status>=500?n.error("Server error. Please try again later."):e.status>=400&&n.error("Request failed. Please check your input and try again.")}function m0(e,n){var t;let i={type:e,data:n,userAgent:navigator.userAgent,timestamp:new Date().toISOString(),url:((t=window==null?void 0:window.location)==null?void 0:t.href)||""};console.log("Security Event:",i)}var Qy=(()=>{let n=class n{};n.\u0275fac=function(r){return new(r||n)},n.\u0275mod=Cr({type:n,bootstrap:[iy]}),n.\u0275inj=_r({providers:[ry(),Jh(Qh([Jy])),ly,n1(),Rr,N1(()=>B1(oi.firebaseConfig)),V1(()=>{let t=U1();return t.setPersistence(L1).then(()=>console.log("\u2705 Auth persistence enabled")).catch(r=>console.warn("\u26A0\uFE0F Auth persistence error:",r.message)),t}),j1(()=>{let t=W1();return z1(t).then(()=>{console.log("\u2705 Firestore offline persistence enabled")}).catch(r=>{r.code==="failed-precondition"?console.warn("\u26A0\uFE0F Multiple tabs detected. Persistence disabled to avoid conflicts."):r.code==="unimplemented"&&console.warn("\u26A0\uFE0F IndexedDB persistence not supported. Falling back to cache.")}),t}),$2(()=>{let t=Kc();return console.log("\u2705 Firebase Cloud Messaging initialized"),t})],imports:[N0,Q2,sy,Gx,dy,O_.forRoot({echarts:()=>import("./chunk-BDRRPAEY.js")}),Zy,Hx,mx.register("ngsw-worker.js",{enabled:!Xh(),registrationStrategy:"registerImmediately",scope:"./"}),ul]});let e=n;return e})();$h(Pu,function(){return[$r,ct,bn,Ma,at,ko,Eo,Eu]},function(){return[yr,Vn,Wi]});function fz(){if(typeof window>"u")return;let e;window.addEventListener("beforeinstallprompt",n=>{n.preventDefault(),e=n,console.log("PWA install prompt ready")}),window.addEventListener("appinstalled",()=>{console.log("PWA installed successfully"),e=null}),window.addEventListener("popstate",n=>{console.log("Navigation event:",n)}),document.addEventListener("visibilitychange",()=>{document.hidden?console.log("App went to background"):console.log("App came to foreground")}),window.addEventListener("beforeunload",n=>{let i={timestamp:Date.now(),url:window.location.href,scrollPosition:window.scrollY};try{localStorage.setItem("app-state",JSON.stringify(i))}catch(t){console.warn("Failed to save app state:",t)}})}function pz(){if(typeof window>"u")return;if(typeof navigator<"u"&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){let n=new Date,i=Math.ceil(n.getDate()/7),t=n.getMonth()+1,a=`${n.getFullYear()}-${t.toString().padStart(2,"0")}-W${i}`,o=localStorage.getItem("app-version");o&&o!==a?(console.log("App version changed on mobile, performing smart cache update"),hz(o,a)):localStorage.setItem("app-version",a)}}function hz(e,n){return ue(this,null,function*(){if(!(typeof window>"u"))try{console.log(`Performing smart cache update from ${e} to ${n}`);let i=xz();yield Cz(),_z(i),localStorage.setItem("app-version",n),console.log("Smart cache update completed successfully")}catch(i){console.error("Smart cache update failed:",i)}})}function xz(){if(typeof window>"u")return{};let e={};return localStorage.getItem("firebase:authUser:")&&Object.keys(localStorage).filter(t=>t.startsWith("firebase:authUser:")||t.startsWith("firebase:persistence:")).forEach(t=>{e[t]=localStorage.getItem(t)}),["theme","language","user-settings"].forEach(i=>{let t=localStorage.getItem(i);t&&(e[i]=t)}),e}function _z(e){typeof window>"u"||Object.keys(e).forEach(n=>{localStorage.setItem(n,e[n])})}function Cz(){return ue(this,null,function*(){if(!(typeof window>"u"))try{if("caches"in window){let i=(yield caches.keys()).filter(t=>!t.includes("firebase")&&!t.includes("auth")&&!t.includes("user"));yield Promise.all(i.map(t=>caches.delete(t)))}Object.keys(localStorage).filter(n=>!n.startsWith("firebase:")&&!n.startsWith("user")&&!n.startsWith("theme")&&!n.startsWith("language")&&n!=="app-version").forEach(n=>localStorage.removeItem(n)),console.log("Application caches cleared successfully")}catch(e){throw console.error("Failed to clear application caches:",e),e}})}fz();pz();e1().bootstrapModule(Qy,{ngZoneEventCoalescing:!0}).catch(e=>console.error(e));
